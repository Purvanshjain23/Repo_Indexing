     H/TITLE EDT Order Header      E2  Edit record(2 screens)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME) TGTRLS(*PRV)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit record(2 screens)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISABANS
     H* Date          : 04/24/25  Time  : 03:37:56
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMGFE2R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Order Header      E2  Edit record(2 screens)
      *
     FOPBFCPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPEXREL1IF  E           K        DISK
      * RTV : Order Types               Retrieval index
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country Master            Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer Master           Active Only
      *
     FCAEOREL2IF  E           K        DISK
      * RTV : Company Customer          Active Records         N
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBGWKLJIF  E           K        DISK
      * RSQ : Order Detail              Co/Ord/Seqs/not Canc/Cnf
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FCAEOREL5IF  E           K        DISK
      * RSQ : Company Customer          Customer
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FPDJEREL4IF  E           K        DISK
      * RSQ : Sales Route               Salesprsn/Route;Active
      *
     FCAALREL1IF  E           K        DISK
      * RTV : Manager Level             Retrieval index       NV
      *
     FOPBFCPHFIF  E           K        DISK
      * RSQ : Order Header TRG          Ship To cust/PO,not cncl
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAACREL2IF  E           K        DISK
      * RTV : State Master              Active only
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FCAAOREL2IF  E           K        DISK
      * RTV : Terms Master              Retrieve Active Records
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier Info              Active records
      *
     FOPCXREL2IF  E           K        DISK
      * RTV : OP Reason Codes           Active Records Only
      *
     FCADSREL1IF  E           K        DISK
      * RTV : Enterprise Master         Retrieval index       NV
      *
     FCAALREL3IF  E           K        DISK
      * RTV : Manager Level             Active Only
      *
     FPDIFREL2IF  E           K        DISK
      * RTV : VP Level Master           Active Only
      *
     FPDJHREL1IF  E           K        DISK
      * RTV : Internal Reason           Retrieval index
      *
     FOPEZREL1IF  E           K        DISK
      * RTV : Event Types               Retrieval index       NV
      *
     FPDMKCPL1IF  E           K        DISK
      * RTV : AR Claim Header           Retrieval index
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : User Entry Control        Retrieval index       NV
      *
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPEYCPL0IF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   2 002  5 0A
     E                    W0END   2 002  5 0A
     E                    W0NAM   2 002 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 077  5 0A
     E                    W1END   7 077  5 0A
     E                    W1NAM   7 077 10
      * DETAIL 2 Screen: Field position and name array
     E                    W2BEG   2 002  5 0A
     E                    W2END   2 002  5 0A
     E                    W2NAM   2 002 10
      * Long constants
     E                    @CN#    1  42  6   @CN    25
     E                    YDOW        7  1               *Days of week
      * Screen one error indicator store
     E                    @I1       100  1
      * Screen two error indicator store
     E                    @I2       100  1
     I@BGWKKK
      * Order Detail              Co/Ord/Seqs/not Canc/Cnf
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WBAIC3
     I              EOBKC7                          WBBKC7
     I              EOAQCD                          WBAQCD
     I              EOR4CD                          WBR4CD
     I              EOBYNA                          WBBYNA
     I              EOB6NA                          WBB6NA
     I              EOBZNA                          WBBZNA
     I              EOLLST                          WBLLST
     I              EOPPST                          WBPPST
     I              EOR5NB                          WBR5NB
     I              EOR6NB                          WBR6NB
     I              EOQGST                          WBQGST
     I              EOBOCD                          WBBOCD
     I              EOTBNB                          WBTBNB
     I              EOMTCU                          WBMTCU
     I              EOW2NB                          WBW2NB
     I              EORPCD                          WBRPCD
     I              EOAJCD                          WBAJCD
     I              EOX9ST                          WBX9ST
     I              EOT9CD                          WBT9CD
     I              EOUBCD                          WBUBCD
     I              EOISTX                          WBISTX
     I              EOLQCD                          WBLQCD
     I              EONJNA                          WBNJNA
     I              EOI0TX                          WBI0TX
     I              EONKNA                          WBNKNA
     I              EOI1TX                          WBI1TX
     I              EOVLST                          WBVLST
     I              EORLST                          WBRLST
     I              EOMMTX                          WBMMTX
     I              EOOHNA                          WBOHNA
     I              EOQ6ST                          WBQ6ST
     I              EOQ8ST                          WBQ8ST
     I              EORBST                          WBRBST
     I              EOREST                          WBREST
     I              EOUVST                          WBUVST
     I              EOUWST                          WBUWST
     I              EOUXST                          WBUXST
     I              EOVSST                          WBVSST
     I              EOAATM                          WBAATM
     I              EOAYNA                          WBAYNA
     I              EOA0NA                          WBA0NA
     I              EOAXDT                          WBAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
     I              ADQDSC                          WCQDSC
      *
     I@EOREIQ
      * Company Customer          Customer
      * Renamed input format fields
     I              EOAIC3                          WDAIC3
     I              EOBKC7                          WDBKC7
     I              EOAQCD                          WDAQCD
     I              EOR4CD                          WDR4CD
     I              EOBYNA                          WDBYNA
     I              EOB6NA                          WDB6NA
     I              EOBZNA                          WDBZNA
     I              EOLLST                          WDLLST
     I              EOPPST                          WDPPST
     I              EOR5NB                          WDR5NB
     I              EOR6NB                          WDR6NB
     I              EOQGST                          WDQGST
     I              EOBOCD                          WDBOCD
     I              EOTBNB                          WDTBNB
     I              EOMTCU                          WDMTCU
     I              EOW2NB                          WDW2NB
     I              EORPCD                          WDRPCD
     I              EOAJCD                          WDAJCD
     I              EOX9ST                          WDX9ST
     I              EOT9CD                          WDT9CD
     I              EOUBCD                          WDUBCD
     I              EOISTX                          WDISTX
     I              EOLQCD                          WDLQCD
     I              EONJNA                          WDNJNA
     I              EOI0TX                          WDI0TX
     I              EONKNA                          WDNKNA
     I              EOI1TX                          WDI1TX
     I              EOVLST                          WDVLST
     I              EORLST                          WDRLST
     I              EOMMTX                          WDMMTX
     I              EOOHNA                          WDOHNA
     I              EOQ6ST                          WDQ6ST
     I              EOQ8ST                          WDQ8ST
     I              EORBST                          WDRBST
     I              EOREST                          WDREST
     I              EOUVST                          WDUVST
     I              EOUWST                          WDUWST
     I              EOUXST                          WDUXST
     I              EOVSST                          WDVSST
     I              EOAATM                          WDAATM
     I              EOAYNA                          WDAYNA
     I              EOA0NA                          WDA0NA
     I              EOAXDT                          WDAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                          WEJNCD
     I              EXJVNA                          WEJVNA
     I              EXOAST                          WEOAST
     I              EXOBST                          WEOBST
     I              EXOEST                          WEOEST
     I              EXOFST                          WEOFST
     I              EXVBST                          WEVBST
     I              EXPYST                          WEPYST
     I              EXX8ST                          WEX8ST
     I              EXISTX                          WEISTX
     I              EXUVST                          WEUVST
     I              EXUWST                          WEUWST
     I              EXUXST                          WEUXST
     I              EXVSST                          WEVSST
     I              EXAATM                          WEAATM
     I              EXAYNA                          WEAYNA
     I              EXA0NA                          WEA0NA
     I              EXAXDT                          WEAXDT
      *
     I@BBREE9
      * Customer Master           Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WFBKC7
     I              BBAYTX                          WFAYTX
     I              BBACNA                          WFACNA
     I              BBADNA                          WFADNA
     I              BBAENA                          WFAENA
     I              BBAJNA                          WFAJNA
     I              BBBGCD                          WFBGCD
     I              BBG5CD                          WFG5CD
     I              BBBTTX                          WFBTTX
     I              BBBVTX                          WFBVTX
     I              BBBWTX                          WFBWTX
     I              BBABTX                          WFABTX
     I              BBA2NA                          WFA2NA
     I              BBCBST                          WFCBST
     I              BBB0NA                          WFB0NA
     I              BBP3NB                          WFP3NB
     I              BBAXNA                          WFAXNA
     I              BBI6DT                          WFI6DT
     I              BBAYDT                          WFAYDT
     I              BBANC7                          WFANC7
     I              BBBTC7                          WFBTC7
     I              BBK6ST                          WFK6ST
     I              BBUZST                          WFUZST
     I              BBKXCD                          WFKXCD
     I              BBLTCD                          WFLTCD
     I              BBQNST                          WFQNST
     I              BBS2NB                          WFS2NB
     I              BBVHVA                          WFVHVA
     I              BBI7DT                          WFI7DT
     I              BBRJST                          WFRJST
     I              BBRKST                          WFRKST
     I              BBQWST                          WFQWST
     I              BBQXST                          WFQXST
     I              BBQYST                          WFQYST
     I              BBUNCS                          WFUNCS
     I              BBUVST                          WFUVST
     I              BBUWST                          WFUWST
     I              BBUXST                          WFUXST
     I              BBVSST                          WFVSST
     I              BBAATM                          WFAATM
     I              BBAYNA                          WFAYNA
     I              BBA0NA                          WFA0NA
     I              BBAXDT                          WFAXDT
      *
     I@ABREUA
      * Company Name and Address  Active records
      * Renamed input format fields
     I              ABAIC3                          WGAIC3
     I              ABADTX                          WGADTX
     I              ABACNA                          WGACNA
     I              ABADNA                          WGADNA
     I              ABAENA                          WGAENA
     I              ABAJNA                          WGAJNA
     I              ABBTTX                          WGBTTX
     I              ABBVTX                          WGBVTX
     I              ABBWTX                          WGBWTX
     I              ABA2NA                          WGA2NA
     I              ABABTX                          WGABTX
     I              ABBGCD                          WGBGCD
     I              ABKXCD                          WGKXCD
     I              ABUVST                          WGUVST
     I              ABUWST                          WGUWST
     I              ABUXST                          WGUXST
     I              ABVSST                          WGVSST
     I              ABAATM                          WGAATM
     I              ABAYNA                          WGAYNA
     I              ABA0NA                          WGA0NA
     I              ABAXDT                          WGAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WJRMNB
     I              FJAIC3                          WJAIC3
     I              FJAODT                          WJAODT
     I              FJPJST                          WJPJST
     I              FJPKST                          WJPKST
     I              FJRNNB                          WJRNNB
     I              FJDMTX                          WJDMTX
     I              FJDNTX                          WJDNTX
     I              FJDOTX                          WJDOTX
     I              FJWTTX                          WJWTTX
     I              FJWUTX                          WJWUTX
     I              FJRPNB                          WJRPNB
     I              FJFLAM                          WJFLAM
     I              FJXQST                          WJXQST
     I              FJRRNB                          WJRRNB
     I              FJDXTX                          WJDXTX
     I              FJDYTX                          WJDYTX
     I              FJSBNB                          WJSBNB
     I              FJBZNA                          WJBZNA
     I              FJRONB                          WJRONB
     I              FJSQNB                          WJSQNB
     I              FJR1NB                          WJR1NB
     I              FJVCST                          WJVCST
     I              FJVDST                          WJVDST
     I              FJSDNB                          WJSDNB
     I              FJPAOU                          WJPAOU
     I              FJDGWG                          WJDGWG
     I              FJSXNB                          WJSXNB
     I              FJHADT                          WJHADT
     I              FJAART                          WJAART
     I              FJDHWG                          WJDHWG
     I              FJDIWG                          WJDIWG
     I              FJAQDT                          WJAQDT
     I              FJS6NB                          WJS6NB
     I              FJT4NB                          WJT4NB
     I              FJPRTM                          WJPRTM
     I              FJNPSV                          WJNPSV
     I              FJJ8TX                          WJJ8TX
     I              FJTLMI                          WJTLMI
     I              FJJ9TX                          WJJ9TX
     I              FJQ2CD                          WJQ2CD
     I              FJVPCD                          WJVPCD
     I              FJDBCD                          WJDBCD
     I              FJGRWE                          WJGRWE
     I              FJXCCD                          WJXCCD
     I              FJU2ST                          WJU2ST
     I              FJF9DT                          WJF9DT
     I              FJONTM                          WJONTM
     I              FJJ4DT                          WJJ4DT
     I              FJTRTM                          WJTRTM
     I              FJJ5DT                          WJJ5DT
     I              FJSPTM                          WJSPTM
     I              FJJ6DT                          WJJ6DT
     I              FJLFTM                          WJLFTM
     I              FJJ7DT                          WJJ7DT
     I              FJBOTM                          WJBOTM
     I              FJJ8DT                          WJJ8DT
     I              FJBLTM                          WJBLTM
     I              FJKIDT                          WJKIDT
     I              FJASTM                          WJASTM
     I              FJKADT                          WJKADT
     I              FJAJCM                          WJAJCM
     I              FJXACD                          WJXACD
     I              FJOANA                          WJOANA
     I              FJK4TX                          WJK4TX
     I              FJVOAG                          WJVOAG
     I              FJKBDT                          WJKBDT
     I              FJNBBO                          WJNBBO
     I              FJW4CD                          WJW4CD
     I              FJEFDT                          WJEFDT
     I              FJCNTN                          WJCNTN
     I              FJKCDT                          WJKCDT
     I              FJTMIN                          WJTMIN
     I              FJKDDT                          WJKDDT
     I              FJVMNB                          WJVMNB
     I              FJOCFR                          WJOCFR
     I              FJKJDT                          WJKJDT
     I              FJATTM                          WJATTM
     I              FJOTRS                          WJOTRS
     I              FJRNST                          WJRNST
     I              FJBRBK                          WJBRBK
     I              FJEIDT                          WJEIDT
     I              FJRMST                          WJRMST
     I              FJAJCD                          WJAJCD
     I              FJKKDT                          WJKKDT
     I              FJAVTM                          WJAVTM
     I              FJKZDT                          WJKZDT
     I              FJAXTM                          WJAXTM
     I              FJLHOS                          WJLHOS
     I              FJLHOR                          WJLHOR
     I              FJWNTX                          WJWNTX
     I              FJOITX                          WJOITX
     I              FJOJTX                          WJOJTX
     I              FJLLDT                          WJLLDT
     I              FJLSHG                          WJLSHG
     I              FJYPST                          WJYPST
     I              FJK0DT                          WJK0DT
     I              FJAYTM                          WJAYTM
     I              FJKNNX                          WJKNNX
     I              FJICWG                          WJICWG
     I              FJIDWG                          WJIDWG
     I              FJH9SX                          WJH9SX
     I              FJWOTX                          WJWOTX
     I              FJK1DT                          WJK1DT
     I              FJAZTM                          WJAZTM
     I              FJK2DT                          WJK2DT
     I              FJA0TM                          WJA0TM
     I              FJROST                          WJROST
     I              FJRPST                          WJRPST
     I              FJRQST                          WJRQST
     I              FJRRST                          WJRRST
     I              FJZBVA                          WJZBVA
     I              FJWPTX                          WJWPTX
     I              FJWQTX                          WJWQTX
     I              FJWRTX                          WJWRTX
     I              FJWSTX                          WJWSTX
     I              FJRVSX                          WJRVSX
     I              FJRUSX                          WJRUSX
     I              FJRWSX                          WJRWSX
     I              FJRXSX                          WJRXSX
     I              FJRYSX                          WJRYSX
     I              FJRZSX                          WJRZSX
     I              FJR0SX                          WJR0SX
     I              FJR1SX                          WJR1SX
     I              FJR2SX                          WJR2SX
     I              FJR3SX                          WJR3SX
     I              FJR4SX                          WJR4SX
     I              FJPYDT                          WJPYDT
     I              FJCKTM                          WJCKTM
     I              FJPZDT                          WJPZDT
     I              FJCLTM                          WJCLTM
     I              FJP0DT                          WJP0DT
     I              FJCMTM                          WJCMTM
     I              FJP1DT                          WJP1DT
     I              FJCNTM                          WJCNTM
     I              FJP2DT                          WJP2DT
     I              FJCOTM                          WJCOTM
     I              FJP3DT                          WJP3DT
     I              FJCQTM                          WJCQTM
     I              FJUVST                          WJUVST
     I              FJUWST                          WJUWST
     I              FJUXST                          WJUXST
     I              FJAATM                          WJAATM
     I              FJAYNA                          WJAYNA
     I              FJA0NA                          WJA0NA
     I              FJAXDT                          WJAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WKRMNB
     I              FLRUNB                          WKRUNB
     I              FLRVNB                          WKRVNB
     I              FLDQTX                          WKDQTX
     I              FLRWNB                          WKRWNB
     I              FLRXNB                          WKRXNB
     I              FLSQNB                          WKSQNB
     I              FLT0NB                          WKT0NB
     I              FLT1NB                          WKT1NB
     I              FLR1NB                          WKR1NB
     I              FLAIC3                          WKAIC3
     I              FLC4NB                          WKC4NB
     I              FLVCST                          WKVCST
     I              FLKEDT                          WKKEDT
     I              FLSXNB                          WKSXNB
     I              FLKFDT                          WKKFDT
     I              FLACTM                          WKACTM
     I              FLK5TX                          WKK5TX
     I              FLW5CD                          WKW5CD
     I              FLEJDT                          WKEJDT
     I              FLAGTM                          WKAGTM
     I              FLKJDT                          WKKJDT
     I              FLATTM                          WKATTM
     I              FLHDDT                          WKHDDT
     I              FLAUTM                          WKAUTM
     I              FLKKDT                          WKKKDT
     I              FLAVTM                          WKAVTM
     I              FLZ4NB                          WKZ4NB
     I              FLY7ST                          WKY7ST
     I              FLY2ST                          WKY2ST
     I              FLWHTX                          WKWHTX
     I              FLWITX                          WKWITX
     I              FLWJTX                          WKWJTX
     I              FLWKTX                          WKWKTX
     I              FLWLTX                          WKWLTX
     I              FLN7DT                          WKN7DT
     I              FLN8DT                          WKN8DT
     I              FLN9DT                          WKN9DT
     I              FLB3TM                          WKB3TM
     I              FLB4TM                          WKB4TM
     I              FLB5TM                          WKB5TM
     I              FLIASX                          WKIASX
     I              FLIBSX                          WKIBSX
     I              FLICSX                          WKICSX
     I              FLWVTX                          WKWVTX
     I              FLWWTX                          WKWWTX
     I              FLWXTX                          WKWXTX
     I              FLUVST                          WKUVST
     I              FLUWST                          WKUWST
     I              FLUXST                          WKUXST
     I              FLAATM                          WKAATM
     I              FLAYNA                          WKAYNA
     I              FLA0NA                          WKA0NA
     I              FLAXDT                          WKAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WLRMNB
     I              FLRUNB                          WLRUNB
     I              FLRVNB                          WLRVNB
     I              FLDQTX                          WLDQTX
     I              FLRWNB                          WLRWNB
     I              FLRXNB                          WLRXNB
     I              FLSQNB                          WLSQNB
     I              FLT0NB                          WLT0NB
     I              FLT1NB                          WLT1NB
     I              FLR1NB                          WLR1NB
     I              FLAIC3                          WLAIC3
     I              FLC4NB                          WLC4NB
     I              FLVCST                          WLVCST
     I              FLKEDT                          WLKEDT
     I              FLSXNB                          WLSXNB
     I              FLKFDT                          WLKFDT
     I              FLACTM                          WLACTM
     I              FLK5TX                          WLK5TX
     I              FLW5CD                          WLW5CD
     I              FLEJDT                          WLEJDT
     I              FLAGTM                          WLAGTM
     I              FLKJDT                          WLKJDT
     I              FLATTM                          WLATTM
     I              FLHDDT                          WLHDDT
     I              FLAUTM                          WLAUTM
     I              FLKKDT                          WLKKDT
     I              FLAVTM                          WLAVTM
     I              FLZ4NB                          WLZ4NB
     I              FLY7ST                          WLY7ST
     I              FLY2ST                          WLY2ST
     I              FLWHTX                          WLWHTX
     I              FLWITX                          WLWITX
     I              FLWJTX                          WLWJTX
     I              FLWKTX                          WLWKTX
     I              FLWLTX                          WLWLTX
     I              FLN7DT                          WLN7DT
     I              FLN8DT                          WLN8DT
     I              FLN9DT                          WLN9DT
     I              FLB3TM                          WLB3TM
     I              FLB4TM                          WLB4TM
     I              FLB5TM                          WLB5TM
     I              FLIASX                          WLIASX
     I              FLIBSX                          WLIBSX
     I              FLICSX                          WLICSX
     I              FLWVTX                          WLWVTX
     I              FLWWTX                          WLWWTX
     I              FLWXTX                          WLWXTX
     I              FLUVST                          WLUVST
     I              FLUWST                          WLUWST
     I              FLUXST                          WLUXST
     I              FLAATM                          WLAATM
     I              FLAYNA                          WLAYNA
     I              FLA0NA                          WLA0NA
     I              FLAXDT                          WLAXDT
      *
     I@JEREZ3
      * Sales Route               Salesprsn/Route;Active
      * Renamed input format fields
     I              JER4CD                          WMR4CD
     I              JEMZNA                          WMMZNA
     I              JEBCCD                          WMBCCD
     I              JEBFCD                          WMBFCD
     I              JEQ4CD                          WMQ4CD
     I              JEWOST                          WMWOST
     I              JER8CD                          WMR8CD
     I              JEUVST                          WMUVST
     I              JEUWST                          WMUWST
     I              JEUXST                          WMUXST
     I              JEVSST                          WMVSST
     I              JEAATM                          WMAATM
     I              JEAYNA                          WMAYNA
     I              JEA0NA                          WMA0NA
     I              JEAXDT                          WMAXDT
      *
     I@BFCPCQ
      * Order Header TRG          Ship To cust/PO,not cncl
      * Renamed input format fields
     I              BEAIC3                          WOAIC3
     I              BEC4NB                          WOC4NB
     I              BEJNCD                          WOJNCD
     I              BEANC7                          WOANC7
     I              BEBKC7                          WOBKC7
     I              BEBRTX                          WOBRTX
     I              BEHMNA                          WOHMNA
     I              BEHONA                          WOHONA
     I              BEHPNA                          WOHPNA
     I              BEHNNA                          WOHNNA
     I              BEDBCD                          WODBCD
     I              BECKTX                          WOCKTX
     I              BEB0C7                          WOB0C7
     I              BEAETX                          WOAETX
     I              BEB1NA                          WOB1NA
     I              BEB3NA                          WOB3NA
     I              BEB4NA                          WOB4NA
     I              BEB2NA                          WOB2NA
     I              BEBHCD                          WOBHCD
     I              BEC8TX                          WOC8TX
     I              BEBCNA                          WOBCNA
     I              BEA0DT                          WOA0DT
     I              BEA5DT                          WOA5DT
     I              BEGNDT                          WOGNDT
     I              BEACDT                          WOACDT
     I              BEAQCD                          WOAQCD
     I              BEB6NA                          WOB6NA
     I              BEBYNA                          WOBYNA
     I              BEBZNA                          WOBZNA
     I              BEGTST                          WOGTST
     I              BEGVST                          WOGVST
     I              BEGUST                          WOGUST
     I              BEQFST                          WOQFST
     I              BECQCD                          WOCQCD
     I              BEGJST                          WOGJST
     I              BEGWST                          WOGWST
     I              BEGXST                          WOGXST
     I              BEGYST                          WOGYST
     I              BEAODT                          WOAODT
     I              BEAIVN                          WOAIVN
     I              BECXDT                          WOCXDT
     I              BEJZVA                          WOJZVA
     I              BEA1WG                          WOA1WG
     I              BEXIST                          WOXIST
     I              BEXJST                          WOXJST
     I              BEXKST                          WOXKST
     I              BEEIDT                          WOEIDT
     I              BEAFTM                          WOAFTM
     I              BEE8CD                          WOE8CD
     I              BEE9CD                          WOE9CD
     I              BERMNB                          WORMNB
     I              BETBNB                          WOTBNB
     I              BER1NB                          WOR1NB
     I              BEPJST                          WOPJST
     I              BEU0ST                          WOU0ST
     I              BEU1ST                          WOU1ST
     I              BEQ2CD                          WOQ2CD
     I              BEU2ST                          WOU2ST
     I              BEVEST                          WOVEST
     I              BEVFST                          WOVFST
     I              BEVGST                          WOVGST
     I              BERPCD                          WORPCD
     I              BERNNB                          WORNNB
     I              BEVDST                          WOVDST
     I              BEATIN                          WOATIN
     I              BEU4ST                          WOU4ST
     I              BEU5ST                          WOU5ST
     I              BERSRN                          WORSRN
     I              BEMHNA                          WOMHNA
     I              BEMINA                          WOMINA
     I              BEWBST                          WOWBST
     I              BER4CD                          WOR4CD
     I              BEBFCD                          WOBFCD
     I              BEQ4CD                          WOQ4CD
     I              BET3NB                          WOT3NB
     I              BESICD                          WOSICD
     I              BECONB                          WOCONB
     I              BECEST                          WOCEST
     I              BEAWDT                          WOAWDT
     I              BEJPCD                          WOJPCD
     I              BEXUST                          WOXUST
     I              BEZ1ST                          WOZ1ST
     I              BEVRVA                          WOVRVA
     I              BEOBST                          WOOBST
     I              BEBCST                          WOBCST
     I              BEBDST                          WOBDST
     I              BEB7VL                          WOB7VL
     I              BEGASX                          WOGASX
     I              BEGBSX                          WOGBSX
     I              BEGCSX                          WOGCSX
     I              BEGDSX                          WOGDSX
     I              BEFNSX                          WOFNSX
     I              BEFOSX                          WOFOSX
     I              BEFPSX                          WOFPSX
     I              BEFQSX                          WOFQSX
     I              BEFRSX                          WOFRSX
     I              BEFSSX                          WOFSSX
     I              BEFTSX                          WOFTSX
     I              BEFUSX                          WOFUSX
     I              BEFVSX                          WOFVSX
     I              BEFWSX                          WOFWSX
     I              BEFXSX                          WOFXSX
     I              BEFYSX                          WOFYSX
     I              BENODT                          WONODT
     I              BENPDT                          WONPDT
     I              BENQDT                          WONQDT
     I              BENRDT                          WONRDT
     I              BENSDT                          WONSDT
     I              BEBPTM                          WOBPTM
     I              BEBQTM                          WOBQTM
     I              BEBRTM                          WOBRTM
     I              BEBSTM                          WOBSTM
     I              BEBTTM                          WOBTTM
     I              BEH0NX                          WOH0NX
     I              BEH1NX                          WOH1NX
     I              BEH2NX                          WOH2NX
     I              BEH3NX                          WOH3NX
     I              BEH4NX                          WOH4NX
     I              BEC0C7                          WOC0C7
     I              BEUVST                          WOUVST
     I              BEUWST                          WOUWST
     I              BEUXST                          WOUXST
     I              BEAATM                          WOAATM
     I              BEAYNA                          WOAYNA
     I              BEA0NA                          WOA0NA
     I              BEAXDT                          WOAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WRAIC3
     I              OMC4NB                          WRC4NB
     I              OMDPNB                          WRDPNB
     I              OMUENB                          WRUENB
     I              OMHGCD                          WRHGCD
     I              OMAJCD                          WRAJCD
     I              OMBKC7                          WRBKC7
     I              OMCFC7                          WRCFC7
     I              OMGMST                          WRGMST
     I              OMGNST                          WRGNST
     I              OMMAVA                          WRMAVA
     I              OMKDVA                          WRKDVA
     I              OML8VA                          WRL8VA
     I              OML9VA                          WRL9VA
     I              OMGTST                          WRGTST
     I              OMGVST                          WRGVST
     I              OMGUST                          WRGUST
     I              OMQFST                          WRQFST
     I              OMAYVA                          WRAYVA
     I              OMEXDT                          WREXDT
     I              OMLQCD                          WRLQCD
     I              OMRDCD                          WRRDCD
     I              OMQ7CD                          WRQ7CD
     I              OMBZPR                          WRBZPR
     I              OML6NB                          WRL6NB
     I              OMU1ST                          WRU1ST
     I              OMGIDT                          WRGIDT
     I              OMCRCD                          WRCRCD
     I              OMAGCD                          WRAGCD
     I              OMRZST                          WRRZST
     I              OMR0ST                          WRR0ST
     I              OMR1ST                          WRR1ST
     I              OMG7NA                          WRG7NA
     I              OMG8NA                          WRG8NA
     I              OMRPCD                          WRRPCD
     I              OMVEST                          WRVEST
     I              OMVGST                          WRVGST
     I              OMAVST                          WRAVST
     I              OMU0ST                          WRU0ST
     I              OMRFCD                          WRRFCD
     I              OMFZST                          WRFZST
     I              OMR1NB                          WRR1NB
     I              OMAVQT                          WRAVQT
     I              OMD0WG                          WRD0WG
     I              OMCCQT                          WRCCQT
     I              OMAUWG                          WRAUWG
     I              OMCBQT                          WRCBQT
     I              OMATWG                          WRATWG
     I              OMAQCS                          WRAQCS
     I              OMAGCS                          WRAGCS
     I              OMAKPR                          WRAKPR
     I              OMALPR                          WRALPR
     I              OMAUPR                          WRAUPR
     I              OMAVWG                          WRAVWG
     I              OMA4WG                          WRA4WG
     I              OMA5DT                          WRA5DT
     I              OMAODT                          WRAODT
     I              OMGNDT                          WRGNDT
     I              OMAMST                          WRAMST
     I              OMANST                          WRANST
     I              OMVAST                          WRVAST
     I              OMRGNB                          WRRGNB
     I              OMRHNB                          WRRHNB
     I              OMRINB                          WRRINB
     I              OMRBCD                          WRRBCD
     I              OMHICD                          WRHICD
     I              OMRNCD                          WRRNCD
     I              OMROCD                          WRROCD
     I              OMCXDT                          WRCXDT
     I              OMAJVN                          WRAJVN
     I              OMKXCD                          WRKXCD
     I              OMJPCD                          WRJPCD
     I              OMCQCD                          WRCQCD
     I              OMR4CD                          WRR4CD
     I              OMZ1ST                          WRZ1ST
     I              OMZ3ST                          WRZ3ST
     I              OMZ4ST                          WRZ4ST
     I              OMDUPR                          WRDUPR
     I              OMB6VL                          WRB6VL
     I              OMA1AA                          WRA1AA
     I              OMFZSX                          WRFZSX
     I              OMF0SX                          WRF0SX
     I              OMF1SX                          WRF1SX
     I              OMF2SX                          WRF2SX
     I              OMF3SX                          WRF3SX
     I              OMF4SX                          WRF4SX
     I              OMF5SX                          WRF5SX
     I              OMF6SX                          WRF6SX
     I              OMF7SX                          WRF7SX
     I              OMNTDT                          WRNTDT
     I              OMNUDT                          WRNUDT
     I              OMNVDT                          WRNVDT
     I              OMNWDT                          WRNWDT
     I              OMNXDT                          WRNXDT
     I              OMBUTM                          WRBUTM
     I              OMBVTM                          WRBVTM
     I              OMBWTM                          WRBWTM
     I              OMBXTM                          WRBXTM
     I              OMBYTM                          WRBYTM
     I              OMH5NX                          WRH5NX
     I              OMH6NX                          WRH6NX
     I              OMH7NX                          WRH7NX
     I              OMH8NX                          WRH8NX
     I              OMH9NX                          WRH9NX
     I              OMDVPR                          WRDVPR
     I              OMDWPR                          WRDWPR
     I              OMDXPR                          WRDXPR
     I              OMDYPR                          WRDYPR
     I              OMDZPR                          WRDZPR
     I              OMGSPR                          WRGSPR
     I              OMGTPR                          WRGTPR
     I              OMGUPR                          WRGUPR
     I              OMHOST                          WRHOST
     I              OMHPST                          WRHPST
     I              OMIOST                          WRIOST
     I              OMPEWG                          WRPEWG
     I              OMRINY                          WRRINY
     I              OMTIDT                          WRTIDT
     I              OMTJDT                          WRTJDT
     I              OMH2ST                          WRH2ST
     I              OMH0ST                          WRH0ST
     I              OMH1ST                          WRH1ST
     I              OMTKDT                          WRTKDT
     I              OMTLDT                          WRTLDT
     I              OMTMDT                          WRTMDT
     I              OMUVST                          WRUVST
     I              OMUWST                          WRUWST
     I              OMUXST                          WRUXST
     I              OMAATM                          WRAATM
     I              OMAYNA                          WRAYNA
     I              OMA0NA                          WRA0NA
     I              OMAXDT                          WRAXDT
      *
     I@ALREVE
      * Manager Level             Active Only
      * Renamed input format fields
     I              ALBFCD                          WSBFCD
     I              ALAUNA                          WSAUNA
     I              ALQ4CD                          WSQ4CD
     I              ALUVST                          WSUVST
     I              ALUWST                          WSUWST
     I              ALUXST                          WSUXST
     I              ALVSST                          WSVSST
     I              ALAATM                          WSAATM
     I              ALAYNA                          WSAYNA
     I              ALA0NA                          WSA0NA
     I              ALAXDT                          WSAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WTAIC3
     I              OMC4NB                          WTC4NB
     I              OMDPNB                          WTDPNB
     I              OMUENB                          WTUENB
     I              OMHGCD                          WTHGCD
     I              OMAJCD                          WTAJCD
     I              OMBKC7                          WTBKC7
     I              OMCFC7                          WTCFC7
     I              OMGMST                          WTGMST
     I              OMGNST                          WTGNST
     I              OMMAVA                          WTMAVA
     I              OMKDVA                          WTKDVA
     I              OML8VA                          WTL8VA
     I              OML9VA                          WTL9VA
     I              OMGTST                          WTGTST
     I              OMGVST                          WTGVST
     I              OMGUST                          WTGUST
     I              OMQFST                          WTQFST
     I              OMAYVA                          WTAYVA
     I              OMEXDT                          WTEXDT
     I              OMLQCD                          WTLQCD
     I              OMRDCD                          WTRDCD
     I              OMQ7CD                          WTQ7CD
     I              OMBZPR                          WTBZPR
     I              OML6NB                          WTL6NB
     I              OMU1ST                          WTU1ST
     I              OMGIDT                          WTGIDT
     I              OMCRCD                          WTCRCD
     I              OMAGCD                          WTAGCD
     I              OMRZST                          WTRZST
     I              OMR0ST                          WTR0ST
     I              OMR1ST                          WTR1ST
     I              OMG7NA                          WTG7NA
     I              OMG8NA                          WTG8NA
     I              OMRPCD                          WTRPCD
     I              OMVEST                          WTVEST
     I              OMVGST                          WTVGST
     I              OMAVST                          WTAVST
     I              OMU0ST                          WTU0ST
     I              OMRFCD                          WTRFCD
     I              OMFZST                          WTFZST
     I              OMR1NB                          WTR1NB
     I              OMAVQT                          WTAVQT
     I              OMD0WG                          WTD0WG
     I              OMCCQT                          WTCCQT
     I              OMAUWG                          WTAUWG
     I              OMCBQT                          WTCBQT
     I              OMATWG                          WTATWG
     I              OMAQCS                          WTAQCS
     I              OMAGCS                          WTAGCS
     I              OMAKPR                          WTAKPR
     I              OMALPR                          WTALPR
     I              OMAUPR                          WTAUPR
     I              OMAVWG                          WTAVWG
     I              OMA4WG                          WTA4WG
     I              OMA5DT                          WTA5DT
     I              OMAODT                          WTAODT
     I              OMGNDT                          WTGNDT
     I              OMAMST                          WTAMST
     I              OMANST                          WTANST
     I              OMVAST                          WTVAST
     I              OMRGNB                          WTRGNB
     I              OMRHNB                          WTRHNB
     I              OMRINB                          WTRINB
     I              OMRBCD                          WTRBCD
     I              OMHICD                          WTHICD
     I              OMRNCD                          WTRNCD
     I              OMROCD                          WTROCD
     I              OMCXDT                          WTCXDT
     I              OMAJVN                          WTAJVN
     I              OMKXCD                          WTKXCD
     I              OMJPCD                          WTJPCD
     I              OMCQCD                          WTCQCD
     I              OMR4CD                          WTR4CD
     I              OMZ1ST                          WTZ1ST
     I              OMZ3ST                          WTZ3ST
     I              OMZ4ST                          WTZ4ST
     I              OMDUPR                          WTDUPR
     I              OMB6VL                          WTB6VL
     I              OMA1AA                          WTA1AA
     I              OMFZSX                          WTFZSX
     I              OMF0SX                          WTF0SX
     I              OMF1SX                          WTF1SX
     I              OMF2SX                          WTF2SX
     I              OMF3SX                          WTF3SX
     I              OMF4SX                          WTF4SX
     I              OMF5SX                          WTF5SX
     I              OMF6SX                          WTF6SX
     I              OMF7SX                          WTF7SX
     I              OMNTDT                          WTNTDT
     I              OMNUDT                          WTNUDT
     I              OMNVDT                          WTNVDT
     I              OMNWDT                          WTNWDT
     I              OMNXDT                          WTNXDT
     I              OMBUTM                          WTBUTM
     I              OMBVTM                          WTBVTM
     I              OMBWTM                          WTBWTM
     I              OMBXTM                          WTBXTM
     I              OMBYTM                          WTBYTM
     I              OMH5NX                          WTH5NX
     I              OMH6NX                          WTH6NX
     I              OMH7NX                          WTH7NX
     I              OMH8NX                          WTH8NX
     I              OMH9NX                          WTH9NX
     I              OMDVPR                          WTDVPR
     I              OMDWPR                          WTDWPR
     I              OMDXPR                          WTDXPR
     I              OMDYPR                          WTDYPR
     I              OMDZPR                          WTDZPR
     I              OMGSPR                          WTGSPR
     I              OMGTPR                          WTGTPR
     I              OMGUPR                          WTGUPR
     I              OMHOST                          WTHOST
     I              OMHPST                          WTHPST
     I              OMIOST                          WTIOST
     I              OMPEWG                          WTPEWG
     I              OMRINY                          WTRINY
     I              OMTIDT                          WTTIDT
     I              OMTJDT                          WTTJDT
     I              OMH2ST                          WTH2ST
     I              OMH0ST                          WTH0ST
     I              OMH1ST                          WTH1ST
     I              OMTKDT                          WTTKDT
     I              OMTLDT                          WTTLDT
     I              OMTMDT                          WTTMDT
     I              OMUVST                          WTUVST
     I              OMUWST                          WTUWST
     I              OMUXST                          WTUXST
     I              OMAATM                          WTAATM
     I              OMAYNA                          WTAYNA
     I              OMA0NA                          WTA0NA
     I              OMAXDT                          WTAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            779
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     I@@I1        DS
      * Screen one error indicator store
     I                                        1 100 @I1
     I                                       31  65 INSCR1
     I@@I2        DS
      * Screen two error indicator store
     I                                        1 100 @I2
     I                                       31  31 INSCR2
      * Outward parameters
     IPARC        DS                             44
      * KEY : Mileage Between Cities    ToCty/ToSt/FrmCty/FrmSt
      * I : RST To City
     I                                        1  20 PAXGCD
      * I : RST To State State Code
     I                                       21  22 PAXHCD
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      * Outward parameters
     IPBRC        DS                              6
      * KEY : Calendar Master           Retrieval index       NV
      * I : RST Company Number
     I                                    P   1   20PBAIC3
      * I : RST Post to G_L Date
     I                                    P   3   60PBBCDT
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPCRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PCAIC3
      * I :  Order Number
     I                                    P   3   60PCC4NB
      * I :  Order Type_Sales
     I                                        7   8 PCJNCD
      * I :  AR Customer Number
     I                                    P   9  120PCANC7
      * I :  Ship To Customer
     I                                    P  13  160PCBKC7
      * I :  Ship To Name
     I                                       17  46 PCBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PCHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PCHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PCHPNA
      * I :  Ship To City
     I                                      137 156 PCHNNA
      * I :  Ship To State Code
     I                                      157 158 PCDBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PCCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PCB0C7
      * I :  Bill to Name
     I                                      174 203 PCAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PCB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PCB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PCB4NA
      * I :  Bill to City
     I                                      294 313 PCB2NA
      * I :  Bill to State Code
     I                                      314 315 PCBHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PCC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PCBCNA
      * I :  Order Date
     I                                    P 342 3450PCA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PCA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PCGNDT
      * I :  Cancel Date
     I                                    P 354 3570PCACDT
      * I :  Terms Code
     I                                      358 359 PCAQCD
      * I :  Special Instructions
     I                                      360 399 PCB6NA
      * I :  Special Instructions 2
     I                                      400 439 PCBYNA
      * I :  Carrier Code
     I                                      440 442 PCBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PCGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PCGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PCGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PCQFST
      * I :  Reason Code
     I                                      447 449 PCCQCD
      * I :  Order in Use
     I                                      450 450 PCGJST
      * I :  Header Status
     I                                      451 451 PCGWST
      * I :  Header Status Last
     I                                      452 452 PCGXST
      * I :  Order Type Print Status
     I                                      453 453 PCGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PCAODT
      * I :  User Original Entry
     I                                      458 467 PCAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PCCXDT
      * I :  Order Value Total
     I                                    P 472 4772PCJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PCA1WG
      * I :  Credit Hold
     I                                      484 484 PCXIST
      * I :  Production Hold
     I                                      485 485 PCXJST
      * I :  New Customer Hold
     I                                      486 486 PCXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PCEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PCAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PCE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PCE9CD
      * I :  Load ID
     I                                    P 510 5130PCRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PCTBNB
      * I :  Rated Freight
     I                                    P 517 5222PCR1NB
      * I :  LTL Flag
     I                                      523 523 PCPJST
      * I :  Price Audit
     I                                      524 524 PCU0ST
      * I :  Price Status
     I                                      525 525 PCU1ST
      * I :  Shipping Method
     I                                      526 527 PCQ2CD
      * I :  Export Status
     I                                      528 528 PCU2ST
      * I :  Palletize
     I                                      529 529 PCVEST
      * I :  Shrink Wrap
     I                                      530 530 PCVFST
      * I :  Slip Sheet
     I                                      531 531 PCVGST
      * I :  Age Code
     I                                      532 532 PCRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PCRNNB
      * I :  Load Type
     I                                      536 536 PCVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PCATIN
      * I :  Load Plan Order
     I                                      541 541 PCU4ST
      * I :  Print Pick Slip
     I                                      542 542 PCU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PCRSRN
      * I :  Special Comment 1
     I                                      547 576 PCMHNA
      * I :  Special Comment 2
     I                                      577 606 PCMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PCWBST
      * I :  Sales Route Code
     I                                      608 610 PCR4CD
      * I :  Manager Level Code
     I                                      611 612 PCBFCD
      * I :  VP Level Code
     I                                      613 615 PCQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PCT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PCSICD
      * I :  Invoice Number
     I                                    P 623 6260PCCONB
      * I :  Invoice Suffix
     I                                      627 628 PCCEST
      * I :  Invoice Date
     I                                    P 629 6320PCAWDT
      * I :  Event Code
     I                                      633 634 PCJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PCXUST
      * I :  Modified Flag
     I                                      636 636 PCZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PCVRVA
      * I :  Billing Activity Type
     I                                      643 643 PCOBST
      * I :  Block Order Flag
     I                                      644 644 PCBCST
      * I :  Order Certification Flag
     I                                      645 645 PCBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PCB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PCGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PCGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PCGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PCGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PCFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PCFOSX
      * I :  Order Emailed
     I                                      658 658 PCFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PCFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PCFRSX
      * I :  Broker Order Status
     I                                      661 661 PCFSSX
      * I :  Air Freight Order
     I                                      662 662 PCFTSX
      * I :  Order Requires Review
     I                                      663 664 PCFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PCFVSX
      * I :  Export USDA Approved
     I                                      667 668 PCFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PCFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PCFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PCNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PCNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PCNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PCNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PCNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PCBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PCBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PCBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PCBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PCBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PCH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PCH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PCH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PCH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PCH4NX
      * I :  Claim Number
     I                                    P 745 7480PCC0C7
      * I :  EDI Status 1
     I                                      749 749 PCUVST
      * I :  EDI Status 2
     I                                      750 750 PCUWST
      * I :  EDI Status 3
     I                                      751 751 PCUXST
      * I :  Job Time
     I                                    P 752 7550PCAATM
      * I :  User Id
     I                                      756 765 PCAYNA
      * I :  Job Name
     I                                      766 775 PCA0NA
      * I :  Job Date
     I                                    P 776 7790PCAXDT
      *
      * Outward parameters
     IPDRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PDDXNB
      * I :  Load ID
     I                                    P  11  140PDRMNB
      * I :  Stop_Drop
     I                                    P  15  170PDRVNB
      * I :  Load Change Type
     I                                       18  23 PDRVST
      * I :  Department Control Code
     I                                       24  26 PDUJST
      * I :  Change Log Prior Value
     I                                       27  38 PDMNTX
      * I :  Change Log New Value
     I                                       39  50 PDMOTX
      * I :  User Id
     I                                       51  60 PDAYNA
      * I :  Job Name
     I                                       61  70 PDA0NA
      * I :  Carrier Code
     I                                       71  73 PDBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PDXMCD
      * I :  Company Number
     I                                    P  77  780PDAIC3
      * I :  Order Number
     I                                    P  79  820PDC4NB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WJRMNB
     I              FJAIC3                          WJAIC3
     I              FJAODT                          WJAODT
     I              FJPJST                          WJPJST
     I              FJPKST                          WJPKST
     I              FJRNNB                          WJRNNB
     I              FJDMTX                          WJDMTX
     I              FJDNTX                          WJDNTX
     I              FJDOTX                          WJDOTX
     I              FJWTTX                          WJWTTX
     I              FJWUTX                          WJWUTX
     I              FJRPNB                          WJRPNB
     I              FJFLAM                          WJFLAM
     I              FJXQST                          WJXQST
     I              FJRRNB                          WJRRNB
     I              FJDXTX                          WJDXTX
     I              FJDYTX                          WJDYTX
     I              FJSBNB                          WJSBNB
     I              FJBZNA                          WJBZNA
     I              FJRONB                          WJRONB
     I              FJSQNB                          WJSQNB
     I              FJR1NB                          WJR1NB
     I              FJVCST                          WJVCST
     I              FJVDST                          WJVDST
     I              FJSDNB                          WJSDNB
     I              FJPAOU                          WJPAOU
     I              FJDGWG                          WJDGWG
     I              FJSXNB                          WJSXNB
     I              FJHADT                          WJHADT
     I              FJAART                          WJAART
     I              FJDHWG                          WJDHWG
     I              FJDIWG                          WJDIWG
     I              FJAQDT                          WJAQDT
     I              FJS6NB                          WJS6NB
     I              FJT4NB                          WJT4NB
     I              FJPRTM                          WJPRTM
     I              FJNPSV                          WJNPSV
     I              FJJ8TX                          WJJ8TX
     I              FJTLMI                          WJTLMI
     I              FJJ9TX                          WJJ9TX
     I              FJQ2CD                          WJQ2CD
     I              FJVPCD                          WJVPCD
     I              FJDBCD                          WJDBCD
     I              FJGRWE                          WJGRWE
     I              FJXCCD                          WJXCCD
     I              FJU2ST                          WJU2ST
     I              FJF9DT                          WJF9DT
     I              FJONTM                          WJONTM
     I              FJJ4DT                          WJJ4DT
     I              FJTRTM                          WJTRTM
     I              FJJ5DT                          WJJ5DT
     I              FJSPTM                          WJSPTM
     I              FJJ6DT                          WJJ6DT
     I              FJLFTM                          WJLFTM
     I              FJJ7DT                          WJJ7DT
     I              FJBOTM                          WJBOTM
     I              FJJ8DT                          WJJ8DT
     I              FJBLTM                          WJBLTM
     I              FJKIDT                          WJKIDT
     I              FJASTM                          WJASTM
     I              FJKADT                          WJKADT
     I              FJAJCM                          WJAJCM
     I              FJXACD                          WJXACD
     I              FJOANA                          WJOANA
     I              FJK4TX                          WJK4TX
     I              FJVOAG                          WJVOAG
     I              FJKBDT                          WJKBDT
     I              FJNBBO                          WJNBBO
     I              FJW4CD                          WJW4CD
     I              FJEFDT                          WJEFDT
     I              FJCNTN                          WJCNTN
     I              FJKCDT                          WJKCDT
     I              FJTMIN                          WJTMIN
     I              FJKDDT                          WJKDDT
     I              FJVMNB                          WJVMNB
     I              FJOCFR                          WJOCFR
     I              FJKJDT                          WJKJDT
     I              FJATTM                          WJATTM
     I              FJOTRS                          WJOTRS
     I              FJRNST                          WJRNST
     I              FJBRBK                          WJBRBK
     I              FJEIDT                          WJEIDT
     I              FJRMST                          WJRMST
     I              FJAJCD                          WJAJCD
     I              FJKKDT                          WJKKDT
     I              FJAVTM                          WJAVTM
     I              FJKZDT                          WJKZDT
     I              FJAXTM                          WJAXTM
     I              FJLHOS                          WJLHOS
     I              FJLHOR                          WJLHOR
     I              FJWNTX                          WJWNTX
     I              FJOITX                          WJOITX
     I              FJOJTX                          WJOJTX
     I              FJLLDT                          WJLLDT
     I              FJLSHG                          WJLSHG
     I              FJYPST                          WJYPST
     I              FJK0DT                          WJK0DT
     I              FJAYTM                          WJAYTM
     I              FJKNNX                          WJKNNX
     I              FJICWG                          WJICWG
     I              FJIDWG                          WJIDWG
     I              FJH9SX                          WJH9SX
     I              FJWOTX                          WJWOTX
     I              FJK1DT                          WJK1DT
     I              FJAZTM                          WJAZTM
     I              FJK2DT                          WJK2DT
     I              FJA0TM                          WJA0TM
     I              FJROST                          WJROST
     I              FJRPST                          WJRPST
     I              FJRQST                          WJRQST
     I              FJRRST                          WJRRST
     I              FJZBVA                          WJZBVA
     I              FJWPTX                          WJWPTX
     I              FJWQTX                          WJWQTX
     I              FJWRTX                          WJWRTX
     I              FJWSTX                          WJWSTX
     I              FJRVSX                          WJRVSX
     I              FJRUSX                          WJRUSX
     I              FJRWSX                          WJRWSX
     I              FJRXSX                          WJRXSX
     I              FJRYSX                          WJRYSX
     I              FJRZSX                          WJRZSX
     I              FJR0SX                          WJR0SX
     I              FJR1SX                          WJR1SX
     I              FJR2SX                          WJR2SX
     I              FJR3SX                          WJR3SX
     I              FJR4SX                          WJR4SX
     I              FJPYDT                          WJPYDT
     I              FJCKTM                          WJCKTM
     I              FJPZDT                          WJPZDT
     I              FJCLTM                          WJCLTM
     I              FJP0DT                          WJP0DT
     I              FJCMTM                          WJCMTM
     I              FJP1DT                          WJP1DT
     I              FJCNTM                          WJCNTM
     I              FJP2DT                          WJP2DT
     I              FJCOTM                          WJCOTM
     I              FJP3DT                          WJP3DT
     I              FJCQTM                          WJCQTM
     I              FJUVST                          WJUVST
     I              FJUWST                          WJUWST
     I              FJUXST                          WJUXST
     I              FJAATM                          WJAATM
     I              FJAYNA                          WJAYNA
     I              FJA0NA                          WJA0NA
     I              FJAXDT                          WJAXDT
      *
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WKRMNB
     I              FLRUNB                          WKRUNB
     I              FLRVNB                          WKRVNB
     I              FLDQTX                          WKDQTX
     I              FLRWNB                          WKRWNB
     I              FLRXNB                          WKRXNB
     I              FLSQNB                          WKSQNB
     I              FLT0NB                          WKT0NB
     I              FLT1NB                          WKT1NB
     I              FLR1NB                          WKR1NB
     I              FLAIC3                          WKAIC3
     I              FLC4NB                          WKC4NB
     I              FLVCST                          WKVCST
     I              FLKEDT                          WKKEDT
     I              FLSXNB                          WKSXNB
     I              FLKFDT                          WKKFDT
     I              FLACTM                          WKACTM
     I              FLK5TX                          WKK5TX
     I              FLW5CD                          WKW5CD
     I              FLEJDT                          WKEJDT
     I              FLAGTM                          WKAGTM
     I              FLKJDT                          WKKJDT
     I              FLATTM                          WKATTM
     I              FLHDDT                          WKHDDT
     I              FLAUTM                          WKAUTM
     I              FLKKDT                          WKKKDT
     I              FLAVTM                          WKAVTM
     I              FLZ4NB                          WKZ4NB
     I              FLY7ST                          WKY7ST
     I              FLY2ST                          WKY2ST
     I              FLWHTX                          WKWHTX
     I              FLWITX                          WKWITX
     I              FLWJTX                          WKWJTX
     I              FLWKTX                          WKWKTX
     I              FLWLTX                          WKWLTX
     I              FLN7DT                          WKN7DT
     I              FLN8DT                          WKN8DT
     I              FLN9DT                          WKN9DT
     I              FLB3TM                          WKB3TM
     I              FLB4TM                          WKB4TM
     I              FLB5TM                          WKB5TM
     I              FLIASX                          WKIASX
     I              FLIBSX                          WKIBSX
     I              FLICSX                          WKICSX
     I              FLWVTX                          WKWVTX
     I              FLWWTX                          WKWWTX
     I              FLWXTX                          WKWXTX
     I              FLUVST                          WKUVST
     I              FLUWST                          WKUWST
     I              FLUXST                          WKUXST
     I              FLAATM                          WKAATM
     I              FLAYNA                          WKAYNA
     I              FLA0NA                          WKA0NA
     I              FLAXDT                          WKAXDT
      *
     IYBRDCS      DS                            793
      * Outward parameters
     IPERC        DS                              6
      * KEY : Calendar Master           Retrieval index       NV
      * I : RST Company Number
     I                                    P   1   20PEAIC3
      * I : RST Post to G_L Date
     I                                    P   3   60PEBCDT
      *
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      *
     IYCRDCS      DS                            779
     IYDRDCS      DS                            779
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WTAIC3
     I              OMC4NB                          WTC4NB
     I              OMDPNB                          WTDPNB
     I              OMUENB                          WTUENB
     I              OMHGCD                          WTHGCD
     I              OMAJCD                          WTAJCD
     I              OMBKC7                          WTBKC7
     I              OMCFC7                          WTCFC7
     I              OMGMST                          WTGMST
     I              OMGNST                          WTGNST
     I              OMMAVA                          WTMAVA
     I              OMKDVA                          WTKDVA
     I              OML8VA                          WTL8VA
     I              OML9VA                          WTL9VA
     I              OMGTST                          WTGTST
     I              OMGVST                          WTGVST
     I              OMGUST                          WTGUST
     I              OMQFST                          WTQFST
     I              OMAYVA                          WTAYVA
     I              OMEXDT                          WTEXDT
     I              OMLQCD                          WTLQCD
     I              OMRDCD                          WTRDCD
     I              OMQ7CD                          WTQ7CD
     I              OMBZPR                          WTBZPR
     I              OML6NB                          WTL6NB
     I              OMU1ST                          WTU1ST
     I              OMGIDT                          WTGIDT
     I              OMCRCD                          WTCRCD
     I              OMAGCD                          WTAGCD
     I              OMRZST                          WTRZST
     I              OMR0ST                          WTR0ST
     I              OMR1ST                          WTR1ST
     I              OMG7NA                          WTG7NA
     I              OMG8NA                          WTG8NA
     I              OMRPCD                          WTRPCD
     I              OMVEST                          WTVEST
     I              OMVGST                          WTVGST
     I              OMAVST                          WTAVST
     I              OMU0ST                          WTU0ST
     I              OMRFCD                          WTRFCD
     I              OMFZST                          WTFZST
     I              OMR1NB                          WTR1NB
     I              OMAVQT                          WTAVQT
     I              OMD0WG                          WTD0WG
     I              OMCCQT                          WTCCQT
     I              OMAUWG                          WTAUWG
     I              OMCBQT                          WTCBQT
     I              OMATWG                          WTATWG
     I              OMAQCS                          WTAQCS
     I              OMAGCS                          WTAGCS
     I              OMAKPR                          WTAKPR
     I              OMALPR                          WTALPR
     I              OMAUPR                          WTAUPR
     I              OMAVWG                          WTAVWG
     I              OMA4WG                          WTA4WG
     I              OMA5DT                          WTA5DT
     I              OMAODT                          WTAODT
     I              OMGNDT                          WTGNDT
     I              OMAMST                          WTAMST
     I              OMANST                          WTANST
     I              OMVAST                          WTVAST
     I              OMRGNB                          WTRGNB
     I              OMRHNB                          WTRHNB
     I              OMRINB                          WTRINB
     I              OMRBCD                          WTRBCD
     I              OMHICD                          WTHICD
     I              OMRNCD                          WTRNCD
     I              OMROCD                          WTROCD
     I              OMCXDT                          WTCXDT
     I              OMAJVN                          WTAJVN
     I              OMKXCD                          WTKXCD
     I              OMJPCD                          WTJPCD
     I              OMCQCD                          WTCQCD
     I              OMR4CD                          WTR4CD
     I              OMZ1ST                          WTZ1ST
     I              OMZ3ST                          WTZ3ST
     I              OMZ4ST                          WTZ4ST
     I              OMDUPR                          WTDUPR
     I              OMB6VL                          WTB6VL
     I              OMA1AA                          WTA1AA
     I              OMFZSX                          WTFZSX
     I              OMF0SX                          WTF0SX
     I              OMF1SX                          WTF1SX
     I              OMF2SX                          WTF2SX
     I              OMF3SX                          WTF3SX
     I              OMF4SX                          WTF4SX
     I              OMF5SX                          WTF5SX
     I              OMF6SX                          WTF6SX
     I              OMF7SX                          WTF7SX
     I              OMNTDT                          WTNTDT
     I              OMNUDT                          WTNUDT
     I              OMNVDT                          WTNVDT
     I              OMNWDT                          WTNWDT
     I              OMNXDT                          WTNXDT
     I              OMBUTM                          WTBUTM
     I              OMBVTM                          WTBVTM
     I              OMBWTM                          WTBWTM
     I              OMBXTM                          WTBXTM
     I              OMBYTM                          WTBYTM
     I              OMH5NX                          WTH5NX
     I              OMH6NX                          WTH6NX
     I              OMH7NX                          WTH7NX
     I              OMH8NX                          WTH8NX
     I              OMH9NX                          WTH9NX
     I              OMDVPR                          WTDVPR
     I              OMDWPR                          WTDWPR
     I              OMDXPR                          WTDXPR
     I              OMDYPR                          WTDYPR
     I              OMDZPR                          WTDZPR
     I              OMGSPR                          WTGSPR
     I              OMGTPR                          WTGTPR
     I              OMGUPR                          WTGUPR
     I              OMHOST                          WTHOST
     I              OMHPST                          WTHPST
     I              OMIOST                          WTIOST
     I              OMPEWG                          WTPEWG
     I              OMRINY                          WTRINY
     I              OMTIDT                          WTTIDT
     I              OMTJDT                          WTTJDT
     I              OMH2ST                          WTH2ST
     I              OMH0ST                          WTH0ST
     I              OMH1ST                          WTH1ST
     I              OMTKDT                          WTTKDT
     I              OMTLDT                          WTTLDT
     I              OMTMDT                          WTTMDT
     I              OMUVST                          WTUVST
     I              OMUWST                          WTUWST
     I              OMUXST                          WTUXST
     I              OMAATM                          WTAATM
     I              OMAYNA                          WTAYNA
     I              OMA0NA                          WTA0NA
     I              OMAXDT                          WTAXDT
      *
     IYERDCS      DS                            525
     IYFRDCS      DS                            793
     IYGRDCS      DS                            793
     IYHRDCS      DS                            793
      * Outward parameters
     IPFRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PFRMNB
      *
     IYIRDCS      DS                            793
     IYJRDCS      DS                            793
     IYKRDCS      DS                            793
      * Outward parameters
     IPGRC        DS                              8
      * KEY : Shipping Instructions     Retrieval index
      * I : RST Company Number
     I                                    P   1   20PGAIC3
      * I : RST Order Number
     I                                    P   3   60PGC4NB
      * I :  Sequence Number
     I                                    P   7   80PGDXNB
      *
      * Outward parameters
     IPHRC        DS                              9
      * KEY : Customer Comment          Retrieval index
      * I : RST Ship To Customer
     I                                    P   1   40PHBKC7
      * I : MAP Comment Type
     I                                        5   6 PHI1SX
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * B : MAP Company Number
     I                                    P   1   20P1AIC3
      * B : MAP Order Number
     I                                    P   3   60P1C4NB
      * B : MAP Ship To Customer
     I                                    P   7  100P1BKC7
      * N : MAP Ship To Name
     I                                       11  40 P1BRTX
      * N :  Customer Purchase Order #
     I                                       41  55 P1BCNA
      * N :  Requested Delivery Date
     I                                    P  56  590P1EIDT
      * N :  Load ID
     I                                    P  60  630P1RMNB
      * N :  Shipping Method
     I                                       64  65 P1Q2CD
      * N :  Export Status
     I                                       66  66 P1U2ST
      * N :  Reefer Temperature
     I                                    P  67  692P1RNNB
      * N :  Trans Contol AS400_Plant
     I                                       70  70 P1XUST
      * N :  Shipping Temp Code C_F
     I                                       71  71 P1FRSX
      * N :  Air Freight Order
     I                                       72  72 P1FTSX
     IP2PARM      DS
      * FLD: *Arrays
      * B :  Next Program Name
     I                                        1  10 P2BYVN
      * B :  USR Change existing order
     I                                       11  11 P2G6ST
      * N :  Company Name
     I                                       12  41 P2APTX
      * N :  First Time Flag
     I                                       42  42 P2TAST
      * N :  Ship Method           USR
     I                                       43  44 P2G7SX
      * N :  Country Code          USR
     I                                       45  50 P2A5AA
      * N :  User Access
     I                                       51  51 P2OPSX
      * N :  Live with TPM
     I                                       52  52 P2O1ST
      * N :  MG Created Load
     I                                       53  53 P2RYSX
     IP3PARM      DS
      * FLD: Company Defaults Internal
      * N :  Shipping Method Dft
     I                                        1   2 P3Z9ST
      * N :  Load Type Dft
     I                                        3   3 P3CSST
      * N :  LTL Flag Dft
     I                                        4   4 P3Z8ST
      * N :  Export Status Dft
     I                                        5   5 P3CXST
      * N :  Shrink Wrap Dft
     I                                        6   6 P3SWST
      * N :  Departure Time DFT
     I                                    P   7   90P3XXTM
      * N :  Export Code Dft
     I                                       10  15 P3UECD
      * N :  Allow Mult Whse to Order
     I                                       16  16 P3HSST
      * N :  Allow Multi Export On Ord
     I                                       17  17 P3AMEO
      * N :  Slip Sheet Dft
     I                                       18  18 P3SSDF
      * N :  Palletize Dft
     I                                       19  19 P3PDFT
      * N :  Company Organization
     I                                       20  20 P3YJSX
     IP4PARM      DS
      * FLD: Order Types
      * N :  Processing Cycle Type
     I                                        1   1 P4OAST
      * N :  Billing Activity Type
     I                                        2   2 P4OBST
      * N :  Affect Inventory Default
     I                                        3   3 P4OEST
      * N :  Affect Sales Doll Default
     I                                        4   4 P4OFST
     IP5PARM      DS
      * FLD: Order Detail
      * B :  Warehouse Code
     I                                        1   3 P5AJCD
      * B :  Country Code
     I                                        4   9 P5KXCD
     IP6PARM      DS
      * FLD: *Arrays
      * N :  Default Printer
     I                                        1  10 P6MPNA
      * N :  Warehouse Type
     I                                       11  12 P6WPST
      * N :  Warehouse Location
     I                                       13  13 P6T0ST
      * N :  Outside Warehouse Flag
     I                                       14  14 P6X9ST
      * N :  Reefer Temperature Dft
     I                                    P  15  172P6STTP
      * N :  Temperature Code C_F
     I                                       18  18 P6MLSX
      * N :  OHE Intended for ExportCC
     I                                       19  24 P6LWAA
      * N :  USR Country Description
     I                                       25  54 P6KSTX
      * B :  Country Code 1 usr
     I                                       55  60 P6KIAA
      * N :  Status Flag 7  Y/N
     I                                       61  61 P6AKTX
      * N :  Status Flag 8  Y/N
     I                                       62  62 P6AFTX
      * N :  Status Flag 9  Y/N
     I                                       63  63 P6DFTX
      * N :  Status Flag 10 Y/N
     I                                       64  64 P6DGTX
      * N :  Transloader Carrier Code
     I                                       65  67 P6DYTX
      * N :  Initials
     I                                       68  70 P6A3T1
      * B :  Ship to Customer      USR
     I                                    P  71  740P6D0C7
     IP7PARM      DS
      * B :  STATUS
     I                                        1   1 P7ATUS
     IP8PARM      DS
      * N :  PFS Carlisle Active
     I                                        1   1 P8WUSX
     IP9PARM      DS
      * FLD: Salesperson
      * N :  Salesperson Code
     I                                        1   3 P9BCCD
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(ORDER-    1 256 #S0001
     I              '_ACK)               '
     I            DS
     I I            'SBMJOB     JOB(GETRE-    1 256 #S0002
     I              'ADY) JOBD(*USRPRF)  '
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Company Customer       NF'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'Company Customer       NF'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Order Cannot be Canc-Load'
      * Order Number
     I                                        1   7 ZA0001
      * Load ID
     I                                    P   8  110ZA0002
      * Message data for 'Ship to Customer Flag 'N''
      * Ship To Customer
     I                                        1   7 ZA0003
      * Message data for 'Customer not found'
      * Message data for 'Company must be a Plant'
      * @Numeric 3,0
     I                                    P   1   20ZA0004
      * Message data for 'Customer Master        NF'
      * Ship To Customer
     I                                        1   7 ZA0005
      * Message data for 'Salesperson not on route'
      * Salesperson Code
     I                                        1   3 ZA0006
      * Message data for 'Type Code Not Found'
      * Type Code
     I                                        1   2 ZA0007
      * Message data for 'Type Code Not Found'
      * Type Code
     I                                        1   2 ZA0008
      * Message data for 'Type Code Not Found'
      * Type Code
     I                                        1   2 ZA0009
      * Message data for 'Order type invalid'
      * Order Type Description
     I                                        1  30 ZA0010
      * Order Type_Sales
     I                                       31  32 ZA0011
      * Message data for 'Order Type Whse/Cust not'
      * Order Type_Sales
     I                                        1   2 ZA0012
      * Message data for 'Cust Whse/Order Type not'
      * Order Type_Sales
     I                                        1   2 ZA0013
      * Message data for 'P/O Number is a duplicate'
      * Customer Purchase Order #
     I                                        1  15 ZA0014
      * Message data for 'Country Inactive'
      * Country Code
     I                                        1   6 ZA0015
      * Message data for 'Country Code           NX'
      * Country Code
     I                                        1   6 ZA0016
      * Message data for 'OHE Intend for exp invald'
      * OHE Intended for ExportCC
     I                                        1   6 ZA0017
      * Message data for 'Country w/Intnd for Exprt'
      * Country Code
     I                                        1   6 ZA0018
      * Message data for 'Country Inactive'
      * Country Code
     I                                        1   6 ZA0019
      * Message data for 'Country Code           NX'
      * Country Code
     I                                        1   6 ZA0020
      * Message data for 'Export Code Required'
      * Country Code
     I                                        1   6 ZA0021
      * Message data for 'Req Shp Dt GT Sch Shp Dt'
      * Requested Ship Date USR
     I                                    P   1   40ZA0022
      * Message data for 'Date Must Be GE Job Date'
      * Date                  USR
     I                                    P   1   40ZA0023
      * Message data for 'Time Field GT 24 Hours'
      * Requested Delivery Time
     I                                    P   1   30ZA0024
      * Message data for 'Time cannot be negative'
      * Requested Delivery Time
     I                                    P   1   30ZA0025
      * Message data for 'Time Required'
      * @Time 4.0
     I                                    P   1   30ZA0026
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0027
      * Message data for 'Date Must Be GE Job Date'
      * Date                  USR
     I                                    P   1   40ZA0028
      * Message data for 'Date Must Be GE Job Date'
      * Date                  USR
     I                                    P   1   40ZA0029
      * Message data for 'Delivery Date < Ship Date'
      * Requested Delivery Date
     I                                    P   1   40ZA0030
      * Message data for 'Ship Date after Deliv Dt'
      * Scheduled Ship Date
     I                                    P   1   40ZA0031
      * Message data for 'Requested Ship Date can n'
      * Must Ship Date        USR
     I                                    P   1   40ZA0032
      * Message data for 'Req Deliv dt before ship'
      * Requested Ship Date USR
     I                                    P   1   40ZA0033
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0034
      * Message data for 'Warehouse Codes        NF'
      * Warehouse Code
     I                                        1   3 ZA0035
      * Message data for 'Warehouse must differ tr.'
      * Message data for 'Warehouse fr/to comp err'
      * Warehouse Code
     I                                        1   3 ZA0036
      * USR Warehouse Code
     I                                        4   6 ZA0037
      * Message data for 'Warehouse cant ship f/co'
      * Warehouse Code
     I                                        1   3 ZA0038
      * Company Number
     I                                        4   6 ZA0039
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0040
      * Message data for 'Warehouse Codes        NF'
      * Warehouse Code
     I                                        1   3 ZA0041
      * Message data for 'Warehouse must be ext'
      * Warehouse Code
     I                                        1   3 ZA0042
      * Message data for 'Warehouse must be ext'
      * Warehouse Code
     I                                        1   3 ZA0043
      * Message data for 'Warehouse type mismatch'
      * Message data for 'Warehouse cant ship f/co'
      * Warehouse Code
     I                                        1   3 ZA0044
      * Company Number
     I                                        4   6 ZA0045
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0046
      * Message data for 'Warehouse Codes        NF'
      * Warehouse Code
     I                                        1   3 ZA0047
      * Message data for 'Warehouse must be ext'
      * Warehouse Code
     I                                        1   3 ZA0048
      * Message data for 'Market cust req f/whs loc'
      * Warehouse Code
     I                                        1   3 ZA0049
      * Message data for 'Market cust/whse not val'
      * Warehouse Code
     I                                        1   3 ZA0050
      * Message data for 'Inv Cust for hpb sale'
      * Ship to Customer      USR
     I                                        1   7 ZA0051
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0052
      * Warehouse Code
     I                                       11  13 ZA0053
      * Message data for 'Order has line itms,cant'
      * Warehouse Code
     I                                        1   3 ZA0054
      * Message data for 'P.O. Required'
      * Customer Purchase Order #
     I                                        1  15 ZA0055
      * Message data for 'Transfer In Storage must'
      * Shipping Method
     I                                        1   2 ZA0056
      * Message data for 'Temperature must be <100'
      * Reefer Temperature
     I                                    P   1   32ZA0057
      * Message data for 'Spot Buy S/T/P Required'
      * Spot Buy  (Y/N)
     I                                        1   1 ZA0058
      * Message data for 'IC Item Balance Not Fnd E'
      * Warehouse Code
     I                                        1   3 ZA0059
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0060
      * Application Code
     I                                       11  16 ZA0061
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0062
      * Application Code
     I                                       11  16 ZA0063
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM P1AIC3    WP0001  30       Company Number
     C           P1C4NB    PARM P1C4NB    WP0002  70       Order Number
     C           P1BKC7    PARM P1BKC7    WP0003  70       Ship To Custome
     C           P2BYVN    PARM P2BYVN    WP0004 10        Next Program Na
     C           P2G6ST    PARM P2G6ST    WP0005  1        USR Change exis
     C           P5AJCD    PARM P5AJCD    WP0006  3        Warehouse Code
     C           P5KXCD    PARM P5KXCD    WP0007  6        Country Code
     C           P6KIAA    PARM P6KIAA    WP0008  6        Country Code 1
     C           P6D0C7    PARM P6D0C7    WP0009  70       Ship to Custome
     C           P7ATUS    PARM P7ATUS    WP0010  1        STATUS
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Set control to display first screen
     C                     Z-ADD1         W0SCR   30
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C  N09                EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1C4NB    OREQ *ZERO                      Order Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KRTV      CHAIN@BECPFK              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * Verify record existence against program mode
     C           W0PMD     IFNE 'ADD'
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     9931  *
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * 04/13/09 PKD E00329 Re-Org screen with new fields.
      * RTV Order Type Desc.   RT - Order Types  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1JNCD    WL0001    P      Order Type_Sale
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DJVNA    P      Order Type Desc
     C                     MOVEL*BLANK    #DS7NA           Shipping Method
      * Shipping Method Desc DRV
      * PAR.Shipping Method Desc DRV = Condition name of PAR.Shipping Met
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #1Q2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DS7NA    PARM           W0CNNM 25        Shipping Method
      *
      * RTV Desc, Status       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKXCD    WL0003    P      Country Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DDATX    P      Country Descrip
     C                     MOVELWL0005    YN0001    P      Record Status
      * ** Retrieve description for "Intended for Export" country E00157
      * RTV Desc, Status       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DLWAA    WL0003    P      Country Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DD6T1    P      Country Descrip
     C                     MOVELWL0005    YN0001    P      Record Status
      * Block Order Flag Description
      * CASE: DTL.Block Order Flag is Firm Order
     C           #1BCST    IFEQ 'F'                        *IF
     C                     MOVEL@CN,001   #DVLT1           Block Order Fla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,002   #DVLT1           Block Order Fla
     C                     END                             *FI
      * CLC Deadln Depart Dt  XF - Order Header TRG  * 
     C                     CALL 'POSCXFR'              90  CLC Deadln Depa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0001  30       Company Number
     C                     PARM #1C4NB    WQ0002  70       Order Number
     C                     PARM #1HNNA    WQ0003 20        City
     C                     PARM #1DBCD    WQ0004  2        State Code
     C                     PARM #1EIDT    WQ0005  70       Requested Deliv
     C                     PARM #1AFTM    WQ0006  40       Requested Deliv
     C           #DA0DZ    PARM *ZERO     WQ0007  70       Deadline Depart
     C           #DBUTM    PARM *ZERO     WQ0008  60       Deadline Depart
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POSCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
     C                     MOVEL'1'       @I1,34           *
     C                     END
      * ** Seaboard only, if no DDD/T, check for Mileage Betw Cities  E16
      * CASE: PAR.Company Organization is Seaboard
     C           P3YJSX    IFEQ 'S'                        *IF
      * Only check Mileage Betw Cities if no DDDate           E001625
      * CASE: DTL.Deadline Depart Date is not entered
     C           #DA0DZ    IFEQ *ZERO                      *IF
      * ** Validate "From" city/state
      * VAL MBC Exists-From CtyXF - Mileage Between Cities  * 
     C                     CALL 'PNX3XFR'              90  VAL MBC Exists-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HNNA    WQ0009 20        From City
     C                     PARM #1DBCD    WQ0010  2        From State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNX3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     END                             *FI
      * CASE: DTL.Warehouse Code is Not Blanks
     C           #DAJCD    IFNE *BLANK                     *IF
      * ** Validate "To" city/state
      * RTV Warehouse Address  RT - Warehouse  * 
     C                     EXSR SCRVGN
      * Val Mileage Existance  XF - Mileage Between Cities  * 
     C                     CLEARPARC
     C                     MOVELYL0001    PAXGCD    P      To City
     C                     MOVELYL0002    PAXHCD    P      To State State
      *
     C                     CALL 'PNX4XFR'              90  Val Mileage Exi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Mileage Be
     C           WUWXST    PARM *BLANK    WQ0011  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNX4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * USER: Initialize detail screen (existing record)
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
     C                     MOVEL'Y'       #1U4ST           Load Plan Order
     C                     MOVEL@CN,004   #DMTTX           Field Descripti
      * Save Load Plan Ready before order is updated          E004119
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVEL#1FVSX    YL0003           OH Load Plan Re
      * ** Save the Carrier, & other 1st time stuff
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
      * ** Save original carrier code to test for change  FT686 LJB 01/03
     C                     MOVEL#1BZNA    YL0004           Carrier Code Ch
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
      * 06/12/08 PKD Added parms to XF. Receiving into NLL.
      * RTV Co. Dflt Int All   XF - Company Defaults Internal  * 
     C                     CALL 'PDSTXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0012  30       Company Number
     C           P3Z9ST    PARM *BLANK    WQ0013  2        Shipping Method
     C           P3CSST    PARM *BLANK    WQ0014  1        Load Type Dft
     C           P3Z8ST    PARM *BLANK    WQ0015  1        LTL Flag Dft
     C           P3CXST    PARM *BLANK    WQ0016  1        Export Status D
     C           P3SWST    PARM *BLANK    WQ0017  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0018  40       Departure Time
     C           P3UECD    PARM *BLANK    WQ0019  6        Export Code Dft
     C           P3HSST    PARM *BLANK    WQ0020  1        Allow Mult Whse
     C           P3AMEO    PARM *BLANK    WQ0021  1        Allow Multi Exp
     C           P3SSDF    PARM *BLANK    WQ0022  1        Slip Sheet Dft
     C           P3PDFT    PARM *BLANK    WQ0023  1        Palletize Dft
     C                     PARM *BLANK    WQ0024  1        Plant Company S
     C                     PARM *BLANK    WQ0025  1        Company Organiz
     C                     PARM *BLANK    WQ0026  1        CDI Valuation G
     C                     PARM *BLANK    WQ0027  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0028  2        CDI Shipper
     C                     PARM *BLANK    WQ0029  2        CDI Produced by
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL@CN,005   #DVR01           Reference. . .
     C                     MOVELP5KXCD    #DKXCD           Country Code
      * 04/02/24 SP S302751-START
     C                     MOVELP6KIAA    #DKIAA           Country Code 1
     C                     Z-ADDP6D0C7    #DD0C7           Ship to Custome
      * 04/02/24 SP S302751-END
     C                     MOVELP6LWAA    #DLWAA           OHE Intended fo
     C                     Z-ADDP1AIC3    #DFKNB           USR Company Num
      * RTV Salesman Code      RT - Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELBER4CD    WL0006    P      Sales Route Cod
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    #DBCCD    P      Salesperson Cod
      * RTV Salesperson Name   RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBCCD    WL0008    P      Salesperson Cod
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    #DBCCD    P      Salesperson Cod
     C                     MOVELWL0009    #DALTX    P      Salesperson Nam
      * RTV 1st Warehouse/Ctl  RT - PD Order Detail  * 
     C                     EXSR SFRVGN
      * RTV Telephone Number   RT - Customer  * 
     C                     EXSR SHRVGN
      * RTV Cust Ordering Dflt2RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0010           Company Number
     C                     Z-ADDBEBKC7    WL0011           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    WUG0TX    P      Terms Code
     C                     MOVELWL0013    WUG0TX    P      Sales Route Cod
     C                     MOVELWL0014    WUG0TX    P      Special Instruc
     C                     MOVELWL0015    WUG0TX    P      Special Instruc
     C                     MOVELWL0016    YL0005    P      Carrier Code
     C                     MOVELWL0017    WUPPST    P      P_O Required Fl
     C                     Z-ADDWL0018    WUNFNN           Deliver after t
     C                     MOVELWL0019    WUBOCD    P      Type Code
     C                     Z-ADDWL0020    WUNFNN           Absorbed Freigh
     C                     Z-ADDWL0021    WUNFNN           Mileage To Cust
     C                     MOVELWL0022    WUCPCD    P      Warehouse Code
     C                     MOVELWL0023    P6X9ST    P      Outside Warehou
     C                     MOVELWL0024    WUG0TX    P      Customer Group
     C                     MOVELWL0025    WUG0TX    P      Customer Group
     C                     MOVELWL0026    YN0013    P      Ord Ent Default
      * ** Errors in Ord Detail pending from Export Ord Automation P01012
     C                     MOVELBEFUSX    #1FUSX           Order Requires
      * Errors exist in Ord Detail if "Order Requires Review" = "Y"
      * CASE: DTL.Order Requires Review is Yes
     C           #1FUSX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       P6DFTX           Status Flag 9
     C                     MOVELWUHFTX    #DHFTX           Explaination Te
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P6DFTX           Status Flag 9
     C                     END                             *FI
      * Populate warehouse code
      * CASE: DTL.Warehouse Code EQ WRK.BLANK
     C           #DAJCD    IFEQ WUGSTX                     *IF
      * Order:  From detail, passed (PAR), from Company/Customer, from Us
      * CASE: PAR.Warehouse Code EQ WRK.BLANK
     C           P5AJCD    IFEQ WUGSTX                     *IF
      * CASE: DB1.Billing Activity Type is Warehouse Transfer
     C           BEOBST    IFEQ '4'                        *IF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0027           Company Number
     C                     MOVEL'WHSEXFER'WL0028    P      Company Value C
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0029    #DAJCD    P      System Value Al
     C                     ELSE
      * CASE: WRK.USR Warehouse Code EQ WRK.BLANK
     C           WUCPCD    IFEQ WUGSTX                     *IF
     C                     MOVELWUAJCD    #DAJCD           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCPCD    #DAJCD           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP5AJCD    #DAJCD           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#DAJCD    #DCPCD           USR Warehouse C
     C                     MOVEL#DKXCD    #DUFCD           USR Export Code
     C                     Z-ADDBEA5DT    #DCZDT           USR Requested s
     C                     Z-ADDBEAODT    #DHODT           Scheduled Ship
      * ** Save the Shipping Method for testing later
     C                     MOVELBEQ2CD    P1Q2CD           Shipping Method
     C                     Z-ADDBERNNB    P1RNNB           Reefer Temperat
     C                     MOVELBEFRSX    P1FRSX           Shipping Temp C
     C                     Z-ADDBEEIDT    WUAYDZ           Requested Deliv
     C                     Z-ADDBEAFTM    WUAFTM           Requested Deliv
     C                     Z-ADDBEAFTM    #DT4TM           USR Time 4.0
     C                     Z-ADD#DT4TM    #1AFTM           Requested Deliv
      * RTV Ord Hdr Val/Wgt    rt - PD Order Detail  * 
     C                     EXSR SKRVGN
      * ** 11/16/2007 LJB FP1251 If collect, default carrier to BUY
      * CASE: DTL.Shipping Method is Collect Truck
     C           #1Q2CD    IFEQ 'CT'                       *IF
     C                     MOVEL'BUY'     #1BZNA           Carrier Code
     C                     ELSE
      * CASE: DTL.Shipping Method is Collect Rail
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C                     MOVEL'BUY'     #1BZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
      * Only allow update to Block Order Flag until order has been posted
      * CASE: DB1.Header Status is Entered
     C           BEGWST    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Block Order Flag is Firm Order
     C           BEBCST    IFEQ 'F'                        *IF
     C                     MOVEL'N'       WUTJST           USR Display 2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELBEBCST    YL0006           Block Order Fla
      * Set Email cust if blank
      * CASE: DTL.Email Cust On Order Ship is No
     C           #1FOSX    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Email Cust On Order Ship is Yes
     C           #1FOSX    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #1FOSX           Email Cust On O
     C                     END                             *FI
     C                     END                             *FI
      * ** Save Customer PO# and Load ID                          E00139
      * ** When Live w/TPM, Load ID will initially be zeros       E004119
     C                     MOVEL#1BCNA    P1BCNA           Customer Purcha
     C                     Z-ADD#1RMNB    P1RMNB           Load ID
      * **  PK0093
     C                     MOVEL#1U2ST    P1U2ST           Export Status
      * air freight
      * CASE: DTL.Air Freight Order is blank
     C           #1FTSX    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1FTSX           Air Freight Ord
     C                     END                             *FI
      * ** Unlock Req Delivery date/time & Req Ship date for Dailys
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0030  30       Company Number
     C                     PARM *BLANK    WQ0031  1        Plant Company S
     C           P3YJSX    PARM *BLANK    WQ0032  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Company Organization
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P3YJSX    IFEQ 'H'                        *IF
     C                     MOVEL@CN,006   #DYMTX           Text USR 8
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,007   #DYMTX           Text USR 8
     C                     END                             *FI
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
      * ** Lock SSD for Seaboard only                         E00447
      * CASE: DTL.Load ID is NE Blank
     C           #1RMNB    IFNE *ZERO                      *IF
      * RTV ld Accpt/Load Status - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBERMNB    WL0030           Load ID
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    YL0007    P      Load Status
     C                     MOVELWL0032    YL0008    P      Load Acceptance
     C                     MOVELWL0033    P2RYSX    P      MG Created Load
      * ** For HPB, Dailys, Block or Bulk - unlock            E00447
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Company Organization is Not Seaboard
      *   |- c2    : DTL.Load Type is Bulk
      *   |- c3    : DTL.Block Order Flag is Block Order
      *   '-
     C           P3YJSX    IFEQ 'D'                        *IF
     C           P3YJSX    OREQ 'H'
     C           #1VDST    OREQ 'B'                        *OR
     C           #1BCST    OREQ 'B'                        *OR
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If on a load that is Locked, shipped or invoiced, lock
      * ** scheduled ship date                                E00447
      * CASE: LCL.Load Status is Locked thru Invoiced
     C           YL0007    IFEQ 'I'                        *IF
     C           YL0007    OREQ 'L'
     C           YL0007    OREQ 'S'
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * E2625 RMC 6/27/13 added |Live with tpm=Y
     C                     MOVEL'L'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: LCL.Load Status is Entered,Combined,Unlock
     C           YL0007    IFEQ 'C'                        *IF
     C           YL0007    OREQ 'E'
     C           YL0007    OREQ 'U'
      * WRK.Date To               USR = JOB.*Job date + CON.1 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WUJFDT
     C                     ELSE
     C           XDINDT    SUB  1000000   WUJFDT
     C                     END
      * Lock if SSD is today or tomorrow             (SBD)    E00447
      * CASE: DTL.Scheduled Ship Date LE WRK.Date To               USR
     C           #1AODT    IFLE WUJFDT                     *IF
     C                     MOVEL'L'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If not on a load, unlock the dates                 E00447
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
      * ** RTV the delivery p.o. from OHE file, if one exists       FP130
      * **  AND HPB fields  9/14/2010 E914 &appt conf fields, intend for
      * RTV OHE for Ord Entry XF - Order Header Extension  * 
     C                     CALL 'PMDBXFR'              90  RTV OHE for Ord
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEAIC3    WQ0033  30       Company Number
     C                     PARM BEC4NB    WQ0034  70       Order Number
     C           #DHEVL    PARM *ZERO     WQ0035 112       OHE HPB RIN Equ
     C           #DHFVL    PARM *ZERO     WQ0036 112       OHE HPB RIN Pri
     C           #DC3TX    PARM *BLANK    WQ0037  4        OHE Spot Buy
     C           #DBOCD    PARM *BLANK    WQ0038  2        OHE Override Ty
     C           WULMT1    PARM WULMT1    WQ0039 38        Delivery P_O  N
     C           WULWAA    PARM *BLANK    WQ0040  6        OHE Intended fo
     C           #DV5T1    PARM *BLANK    WQ0041 10        OHE Appt Confir
     C           #DWBT1    PARM *BLANK    WQ0042 30        OHE Appt Confir
     C           YL0009    PARM *BLANK    WQ0043 50        Letter of Credi
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,51           *
     C                     MOVEL'1'       @I1,54           *
     C                     MOVEL'1'       @I1,55           *
     C                     MOVEL'1'       @I1,59           *
     C                     MOVEL'1'       @I1,61           *
     C                     END
      * W77844 DN 06/11/21-Convert Old Spot Buy Flag Value to New Val: S,
      * ** Spot buy = y / n/blank = invald    W77844 DN 06/11/21-New Spot
      * CASE: DTL.OHE Spot Buy is Spot
     C           #DC3TX    IFEQ 'S'                        *IF
     C                     MOVEL'S'       #DSPOT           Spot Buy  (Y/N)
      * DTL.Spot Buy Text USR = Condition name of DTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #DSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: DTL.OHE Spot Buy is Turn
     C           #DC3TX    IFEQ 'T'                        *IF
     C                     MOVEL'T'       #DSPOT           Spot Buy  (Y/N)
      * DTL.Spot Buy Text USR = Condition name of DTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #DSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: DTL.OHE Spot Buy is Promo
     C           #DC3TX    IFEQ 'P'                        *IF
     C                     MOVEL'P'       #DSPOT           Spot Buy  (Y/N)
      * DTL.Spot Buy Text USR = Condition name of DTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #DSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Company Organization is Seaboard
     C           P3YJSX    IFEQ 'S'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'T'       #DSPOT           Spot Buy  (Y/N)
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL'T'       #DC3TX           OHE Spot Buy
      * DTL.Spot Buy Text USR = Condition name of DTL.OHE Spot Buy
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1279264   Y2LSNO  70       List number
     C                     PARM #DC3TX    W0INVL 25        OHE Spot Buy
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Put OHE deliv po on screen, first time only           FP1303
      * CASE:
      *  - c1 AND c2 ANDc3
      *   |- c1    : DTL.USR 15 Text           USR is Blanks
      *   |- c2    : WRK.Delivery P.O. Number is Not Blank
      *   |- c3    : LCL.Delivery P.O. Number is Eq Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DNLTX    IFEQ *BLANK                     *IF
     C           WULMT1    IFNE *BLANK                     *IF
     C           YL0010    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWULMT1    #DNLTX           USR 15 Text
     C                     MOVEL*BLANK    YL0010           Delivery P_O  N
     C                     MOVEL#DNLTX    YL0010           Delivery P_O  N
     C                     END                             *FI
      * ** Put Intended for Export on screen from file 1st time only  E00
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.OHE Intended for ExportCC is Blank
      *   |- c2    : WRK.OHE Intended for ExportCC is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DLWAA    IFEQ *BLANK                     *IF
     C           WULWAA    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWULWAA    #DLWAA           OHE Intended fo
     C                     MOVELWULWAA    P6LWAA           OHE Intended fo
     C                     MOVEL#DLWAA    #DZ8CD           USR Country Cod
     C                     END                             *FI
      * ** Put Letter of Credit on screen, first time only    E004119
      * CASE:
      *  - c1 AND c3
      *   |- c1    : DTL.String 30 is Blank
      *   |- c3    : LCL.Letter of Credit Number is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DAKU1    IFEQ *BLANK                     *IF
     C           YL0009    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELYL0009    #DAKU1           String 30
     C                     END                             *FI
      * Set Appointments to non-display if HPB or Live w/TPM  E004119
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Company Organization is High Plains Biodiesel
      *   |- c2    : DB1.OH Load Plan Ready is Yes
      *   '-
     C           P3YJSX    IFEQ 'H'                        *IF
     C           BEFVSX    OREQ 'Y'                        *OR
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
     C                     MOVEL'Y'       P6DGTX           Status Flag 10
     C                     END                             *FI
      * RTV Desc, Status       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DLWAA    WL0003    P      Country Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DD6T1    P      Country Descrip
     C                     MOVELWL0005    YN0001    P      Record Status
      * 04/13/09 PKD E00329 Re-Org screen with new fields.
      * SET CURSOR
      * CASE: DTL.Ship To Customer is equal to zero
     C           #1BKC7    IFEQ *ZERO                      *IF
      * *Set Cursor: DTL.Ship To Customer  (*Override=*YES)
     C                     Z-ADD003       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: DTL.USR Company Number is Equal to zero
     C           #DFKNB    IFEQ *ZERO                      *IF
      * *Set Cursor: DTL.Ship To Customer  (*Override=*YES)
     C                     Z-ADD003       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.Requested Delivery Date  (*Override=*YES)
     C                     Z-ADD004       W0ROW1
     C                     Z-ADD113       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     END                             *FI
     C                     END                             *FI
      * RTV Order Type Desc.   RT - Order Types  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1JNCD    WL0001    P      Order Type_Sale
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DJVNA    P      Order Type Desc
     C                     MOVEL*BLANK    #DS7NA           Shipping Method
      * Shipping Method Desc DRV
      * PAR.Shipping Method Desc DRV = Condition name of PAR.Shipping Met
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #1Q2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DS7NA    PARM           W0CNNM 25        Shipping Method
      *
      * RTV Desc, Status       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKXCD    WL0003    P      Country Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DDATX    P      Country Descrip
     C                     MOVELWL0005    YN0001    P      Record Status
      * Block Order Flag Description
      * CASE: DTL.Block Order Flag is Firm Order
     C           #1BCST    IFEQ 'F'                        *IF
     C                     MOVEL@CN,001   #DVLT1           Block Order Fla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,002   #DVLT1           Block Order Fla
     C                     END                             *FI
      * Outside Warehouse
      * CASE: PAR.Outside Warehouse Flag is yes
     C           P6X9ST    IFEQ 'Y'                        *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0034           Company Number
     C                     Z-ADD#1BKC7    WL0035           Ship To Custome
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0036    #DWKCD    P      Warehouse Code
      * CASE: PAR.Company Organization is Not HPB
     C           P3YJSX    IFEQ 'D'                        *IF
     C           P3YJSX    OREQ 'S'
     C                     Z-ADD1         ZQ      50
     C           @CN,008   CAT  #DWKCD:ZQ #DO6NA    P      Warehouse Desc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0037    P      Warehouse Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    #DO6NA    P      Warehouse Descr
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0037    P      Warehouse Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    #DO6NA    P      Warehouse Descr
     C                     END                             *FI
      * Display YLW Warning msg if sched ship date wont be changed
      * CASE: DTL.Load ID is GT Zero
     C           #1RMNB    IFGT *ZERO                      *IF
      * Display YLW warning message
      * CASE: WRK.USR Output Only Status is yes
     C           WUE5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       P6AFTX           Status Flag 8
     C                     END                             *FI
     C                     END                             *FI
      * ** Use req delv dt/tm always   5/02/11  E01523   RMC
      * CASE: DTL.Requested Delivery Date is entered
     C           #1EIDT    IFNE *ZERO                      *IF
      * CLC Deadln Depart Dt  XF - Order Header TRG  * 
     C                     CALL 'POSCXFR'              90  CLC Deadln Depa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0044  30       Company Number
     C                     PARM #1C4NB    WQ0045  70       Order Number
     C                     PARM #1HNNA    WQ0046 20        City
     C                     PARM #1DBCD    WQ0047  2        State Code
     C                     PARM #1EIDT    WQ0048  70       Requested Deliv
     C                     PARM #1AFTM    WQ0049  40       Requested Deliv
     C           #DA0DZ    PARM *ZERO     WQ0050  70       Deadline Depart
     C           #DBUTM    PARM *ZERO     WQ0051  60       Deadline Depart
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POSCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
     C                     MOVEL'1'       @I1,34           *
     C                     END
      * Default for export if it cant be calc'd
      * CASE: DTL.Deadline Depart Date is not entered
     C           #DA0DZ    IFEQ *ZERO                      *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Export Status is yes
      *   |- c2    : DTL.Ship To State Code is International Accounts
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U2ST    IFEQ 'Y'                        *IF
     C           #1DBCD    IFEQ '.'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD#1AODT    #DA0DZ           Deadline Depart
     C                     Z-ADD80000     #DBUTM           Deadline Depart
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** For Seaboard only, validate Deadline Depart Date/Time   W288
      * CASE: PAR.Company Organization is Seaboard
     C           P3YJSX    IFEQ 'S'                        *IF
      * ** Retrieve the hours that Shipping is restricted from loading
      * ** (this is maintained by scheduling)                 W288
      * RTV Dock Unavail Range XF - Warehouse Control  * 
     C                     CALL 'PNNIXFR'              90  RTV Dock Unavai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DAJCD    WQ0052  3        Warehouse Code
     C           WUDPTM    PARM *ZERO     WQ0053  60       Dock Unavail St
     C           WUDQTM    PARM *ZERO     WQ0054  60       Dock Unavail En
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNNIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * ** Validate if hours are entered for a warehouse
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      *       skip - not an error if no record
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Dock Unavail Start Time is Zeros
      *   |- c2    : WRK.Dock Unavail End Time is Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDPTM    IFEQ *ZERO                      *IF
     C           WUDQTM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *       skip - not an error if times are zeros
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If RSD = DDD then enforce Restricted Time Range    W288
      * CASE: DTL.Requested Ship Date EQ DTL.Deadline Depart Date
     C           #1A5DT    IFEQ #DA0DZ                     *IF
      * ** Warning if DDT is during restriced hours             W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Deadline Depart Time LH GE WRK.Dock Unavail Star
      *   |- c2    : DTL.Deadline Depart Time LH LE WRK.Dock Unavail End
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DBUTM    IFGE WUDPTM                     *IF
     C           #DBUTM    IFLE WUDQTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWUO3TX    #DO3TX           Explaination 50
     C                     MOVEL'Y'       P6AKTX           Status Flag 7
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Warning if date changes put DDD/T in the past. Truck will not
      * ** time to load and leave. Send a warning message and unlock the
      * ** dates so they can be changed.                      W288
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0055 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0056 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Warning if DDD = Today & DDT is before system time   W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Deadline Depart Date EQ WRK.Current System Date
      *   |- c2    : DTL.Deadline Depart Time LH LE WRK.Current System Ti
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DA0DZ    IFEQ WUSDTE                     *IF
     C           #DBUTM    IFLE WUZHNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWUEFT1    #DO3TX           Explaination 50
     C                     MOVEL'Y'       P6AKTX           Status Flag 7
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
      * ** Test to see if Mileage Between Cities record exists E001625
     C                     MOVEL'Y'       WUFCSX           Status - Mileag
      * RTV Warehouse Address  XF - Warehouse  * 
     C                     CALL 'PNX5XFR'              90  RTV Warehouse A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DAJCD    WQ0057  3        Warehouse Code
     C           YL0011    PARM *BLANK    WQ0058 30        Warehouse Descr
     C           YL0012    PARM *BLANK    WQ0059 30        Address Line 1
     C           YL0013    PARM *BLANK    WQ0060 30        Address Line 2
     C           YL0014    PARM *BLANK    WQ0061 30        Address Line 3
     C           YL0001    PARM *BLANK    WQ0062 20        City
     C           YL0015    PARM *BLANK    WQ0063 11        Zip Postal Code
     C           YL0002    PARM *BLANK    WQ0064  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNX5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * RTV Miles Between      XF - Mileage Between Cities  * 
     C                     CALL 'PNYAXFR'              90  RTV Miles Betwe
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0065 20        From City
     C                     PARM YL0002    WQ0066  2        From State
     C                     PARM #1HNNA    WQ0067 20        To City
     C                     PARM #1DBCD    WQ0068  2        To State State
     C           YL0016    PARM *ZERO     WQ0069  50       Miles to next s
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNYAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** Scheduled Ship Date must be a valid date           E000589
      * CASE: DTL.Scheduled Ship Date is entered
     C           #1AODT    IFNE *ZERO                      *IF
      * ** Validate Scheduled Ship Date. If error, user cannot change
      * ** unless Requested Ship or Delivery dates are unlocked.    E0005
      * VAL Date               XF - Calendar  * 
     C                     CLEARPBRC
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1AODT    PBBCDT           Post to G_L Dat
      *
     C                     CALL 'PNO4XFR'              90  VAL Date
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Calendar M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Validate SSD                                          E000589
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     Z-ADD#DHODT    #1AODT           Scheduled Ship
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *
     C                     ELSE
      * If record already exists, error
     C           *IN90     IFEQ '0'
     C                     SETON                     9931  *
      * Send message 'Order Header TRG       EX'
     C                     MOVEL'USR0177' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
      * USER: Initialize detail screen (new record)
     C                     MOVEL@CN,004   #DMTTX           Field Descripti
     C                     MOVEL@CN,009   #DVR01           Reference. . .
      * Get Shipping Co dft for ship to    7/27/04
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Ship To Customer is not equal to zero
      *   |- c2    : DTL.USR Company Number is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BKC7    IFNE *ZERO                      *IF
     C           #DFKNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Company Number is not equal to zero
     C           P1AIC3    IFNE *ZERO                      *IF
     C                     Z-ADDP1AIC3    WUBQC3           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Shipping Co Dft    RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0040           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    WUBQC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
      * Multi-co processing
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Allow Multi-Company is yes
      *   |- c2    : PAR.Ship To Customer is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUI6ST    IFEQ 'Y'                        *IF
     C           P1BKC7    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PKTR01 RMC 07/21/04  Dont def. company if allow multi co is Y
      *  and ship to is blank    -- allow entry of co
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUBQC3    P1AIC3           Company Number
     C                     Z-ADDWUBQC3    #DFKNB           USR Company Num
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DFKNB    WL0041           Company Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    #DAPTX    P      Name
     C                     END                             *FI
     C                     MOVELWUJNCD    #1JNCD           Order Type_Sale
      * DTL = PAR By name
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1BKC7    #1BKC7           Ship To Custome
     C                     MOVELP2APTX    #DAPTX           Company Name
     C                     MOVELP1BRTX    #1BRTX           Ship To Name
     C                     Z-ADDP1EIDT    #1EIDT           Requested Deliv
     C                     MOVELP1BCNA    #1BCNA           Customer Purcha
     C                     MOVELP1Q2CD    #1Q2CD           Shipping Method
     C                     MOVELP9BCCD    #DBCCD           Salesperson Cod
     C                     MOVELP5AJCD    #DAJCD           Warehouse Code
     C                     Z-ADDP1RNNB    #1RNNB           Reefer Temperat
     C                     MOVELP1FRSX    #1FRSX           Shipping Temp C
     C                     MOVELP1U2ST    #1U2ST           Export Status
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     MOVELP5KXCD    #DKXCD           Country Code
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
     C                     MOVELP6LWAA    #DLWAA           OHE Intended fo
     C                     MOVELP1FTSX    #1FTSX           Air Freight Ord
     C                     MOVELP1XUST    #1XUST           Trans Contol AS
     C                     MOVELP4OBST    #1OBST           Billing Activit
     C                     MOVELP6KIAA    #DKIAA           Country Code 1
     C                     Z-ADDP6D0C7    #DD0C7           Ship to Custome
     C                     Z-ADD*ZERO     WUAADT           @Date - ATR
      * RTV Billing Type       RT - Order Types  * 
     C                     EXSR SQRVGN
      * Ship to and Bill to information
      * CASE: PAR.Ship To Customer NE WRK.ZERO
     C           P1BKC7    IFNE WUW0NB                     *IF
      * RTV Cust Addr, A/R,Loc RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0043           Ship To Custome
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    #1BRTX    P      Customer Name
     C                     MOVELWL0045    #1HMNA    P      Address Line 1
     C                     MOVELWL0046    #1HONA    P      Address Line 2
     C                     MOVELWL0047    #1HPNA    P      Address Line 3
     C                     MOVELWL0048    #1HNNA    P      City
     C                     MOVELWL0049    #1DBCD    P      State Code
     C                     MOVELWL0050    #1CKTX    P      Zip Postal Code
     C                     MOVELWL0051    #DV4T1    P      Alpha Search
     C                     Z-ADDWL0052    #1ANC7           AR Customer Num
     C                     MOVELWL0053    #1FOSX    P      Email When Orde
     C                     Z-ADD#1ANC7    #1B0C7           Bill to Custome
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ANC7    WL0054           Ship To Custome
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    #1AETX    P      Customer Name
     C                     MOVELWL0056    #1B1NA    P      Address Line 1
     C                     MOVELWL0057    #1B3NA    P      Address Line 2
     C                     MOVELWL0058    #1B4NA    P      Address Line 3
     C                     MOVELWL0059    #1B2NA    P      City
     C                     MOVELWL0060    #1BHCD    P      State Code
     C                     MOVELWL0061    #1C8TX    P      Zip Postal Code
     C                     END                             *FI
      * RTV Co. Dflt Int All,O XF - Company Defaults Internal  * 
     C                     CALL 'PMRMXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0070  30       Company Number
     C           P3Z9ST    PARM *BLANK    WQ0071  2        Shipping Method
     C           P3CSST    PARM *BLANK    WQ0072  1        Load Type Dft
     C           P3Z8ST    PARM *BLANK    WQ0073  1        LTL Flag Dft
     C           P3CXST    PARM *BLANK    WQ0074  1        Export Status D
     C           P3SWST    PARM *BLANK    WQ0075  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0076  40       Departure Time
     C           P3UECD    PARM *BLANK    WQ0077  6        Export Code Dft
     C           P3HSST    PARM *BLANK    WQ0078  1        Allow Mult Whse
     C           P3AMEO    PARM *BLANK    WQ0079  1        Allow Multi Exp
     C           P3SSDF    PARM *BLANK    WQ0080  1        Slip Sheet Dft
     C           P3PDFT    PARM *BLANK    WQ0081  1        Palletize Dft
     C           P3YJSX    PARM *BLANK    WQ0082  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Company/customer defaults
      * CASE: PAR.Ship To Customer NE WRK.ZERO
     C           P1BKC7    IFNE WUW0NB                     *IF
      * RTV Cust Ordering Dflt2RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0010           Company Number
     C                     Z-ADD#1BKC7    WL0011           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    #1AQCD    P      Terms Code
     C                     MOVELWL0013    YL0017    P      Sales Route Cod
     C                     MOVELWL0014    #1BYNA    P      Special Instruc
     C                     MOVELWL0015    #1B6NA    P      Special Instruc
     C                     MOVELWL0016    YL0005    P      Carrier Code
     C                     MOVELWL0017    WUPPST    P      P_O Required Fl
     C                     Z-ADDWL0018    #1AFTM           Deliver after t
     C                     MOVELWL0019    WUBOCD    P      Type Code
     C                     Z-ADDWL0020    #1TBNB           Absorbed Freigh
     C                     Z-ADDWL0021    WUNFNN           Mileage To Cust
     C                     MOVELWL0022    #DAJCD    P      Warehouse Code
     C                     MOVELWL0023    P6X9ST    P      Outside Warehou
     C                     MOVELWL0024    WUG0TX    P      Customer Group
     C                     MOVELWL0025    WUG0TX    P      Customer Group
     C                     MOVELWL0026    YL0018    P      Ord Ent Default
      * 06/16/10 PKD Default Sales Route
      * CASE: DTL.Sales Route Code is not entered
     C           #1R4CD    IFEQ *BLANK                     *IF
      * CASE: LCL.Ord Ent Default Sls Rte is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     MOVELYL0017    #1R4CD           Sales Route Cod
     C                     END                             *FI
     C                     END                             *FI
      * E2438 Default Type Code for HPB - not for Foods
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P3YJSX    IFEQ 'H'                        *IF
     C                     MOVELWUBOCD    #DBOCD           Type Code
     C                     END                             *FI
      * Validate Co/Cust exists
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL#DAJCD    WUCPCD           USR Warehouse C
      * CASE: LCL.Carrier Code is Buyer's Truck
     C           YL0005    IFEQ 'BUY'                      *IF
     C                     MOVEL'CT'      P3Z9ST           Shipping Method
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Company Customer       NF'
     C                     MOVEL'USR1007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO BEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * HPB: Type Code
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P3YJSX    IFEQ 'H'                        *IF
     C                     MOVEL@CN,006   #DYMTX           Text USR 8
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,007   #DYMTX           Text USR 8
     C                     END                             *FI
      * Billing Activity type reset for transfer
      * CASE: PAR.Outside Warehouse Flag is yes
     C           P6X9ST    IFEQ 'Y'                        *IF
     C                     MOVEL'4'       #1OBST           Billing Activit
     C                     END                             *FI
      * Populate warehouse code
      * CASE: DTL.Billing Activity Type is Warehouse Transfer
     C           #1OBST    IFEQ '4'                        *IF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0027           Company Number
     C                     MOVEL'WHSEXFER'WL0028    P      Company Value C
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0029    #DAJCD    P      System Value Al
     C                     ELSE
      * CASE: DTL.Warehouse Code EQ WRK.BLANK
     C           #DAJCD    IFEQ WUGSTX                     *IF
     C                     MOVELWUAJCD    #DAJCD           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
      * RTV Salesman Code      RT - Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1R4CD    WL0006    P      Sales Route Cod
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    #DBCCD    P      Salesperson Cod
      * RTV Salesperson Name   RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBCCD    WL0008    P      Salesperson Cod
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    #DBCCD    P      Salesperson Cod
     C                     MOVELWL0009    #DALTX    P      Salesperson Nam
      * E2438 Default Type Code for Sbd - from salesperson
      * CASE: PAR.Company Organization is Seaboard
     C           P3YJSX    IFEQ 'S'                        *IF
      * Rtv Dft Sales Channel  XF - Salesperson Electronic CM  * 
     C                     CALL 'PBHPXFR'              90  Rtv Dft Sales C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DBCCD    WQ0083  3        Salesperson Cod
     C           YL0019    PARM *BLANK    WQ0084  2        SEC Default Sal
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBHPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,44           *
     C                     END
     C                     MOVELYL0019    #DBOCD           Type Code
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0062    P      Warehouse Code
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    WUWPST    P      Warehouse Type
      * First time processing
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     MOVEL'E'       #1GWST           Header Status
      * FP1110 - RMC 01/14/08  Print Pick Slip - dft to NO for HPB
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P3YJSX    IFEQ 'H'                        *IF
     C                     MOVEL'N'       #1U5ST           Print Pick Slip
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #1U5ST           Print Pick Slip
     C                     END                             *FI
     C                     MOVEL'Y'       #1WBST           Affect Auto Acc
     C                     MOVEL'01'      #1JPCD           Event Code
     C                     MOVELP3PDFT    #1VEST           Palletize
     C                     MOVELP3SSDF    #1VGST           Slip Sheet
     C                     MOVELP3SWST    #1VFST           Shrink Wrap
     C                     MOVELP3Z9ST    #1Q2CD           Shipping Method
     C                     MOVELP3Z8ST    #1PJST           LTL Flag
     C                     MOVELP3UECD    #DKXCD           Country Code
      * Check Company/customer for Export Type Code
      * CASE: PAR.Ship To Customer NE WRK.ZERO
     C           P1BKC7    IFNE WUW0NB                     *IF
      * CASE: WRK.Type Code is Export
     C           WUBOCD    IFEQ 'EX'                       *IF
     C                     MOVEL'Y'       #1U2ST           Export Status
     C                     MOVELP2A5AA    #DKXCD           Country Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP3CXST    #1U2ST           Export Status
     C                     END                             *FI
     C                     END                             *FI
      * ** Save original carrier code to test for change  FT686 LJB 01/03
     C                     MOVEL#1BZNA    YL0004           Carrier Code Ch
     C                     MOVELP3CSST    #1VDST           Load Type
     C                     Z-ADD##JDT     #1EIDT           Requested Deliv
     C                     Z-ADD##JDT     #1AODT           Scheduled Ship
     C                     Z-ADD##JDT     #1A0DT           Order Date
     C                     Z-ADD##JDT     #1CXDT           Date of Origina
     C                     MOVEL##USR     #1AIVN           User Original E
      * RTV Shipping Temp      XF - Warehouse Type-Internal  * 
     C                     CALL 'PDSSXFR'              90  RTV Shipping Te
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUWPST    WQ0085  2        Warehouse Type
     C           #1RNNB    PARM *ZERO     WQ0086  52       Reefer Temperat
     C           #1FRSX    PARM *BLANK    WQ0087  1        Temperature Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,49           *
     C                     MOVEL'1'       @I1,50           *
     C                     END
      * Rtv Customer Air Frt  RT - Customer EXT  * 
     C                     EXSR SURVGN
      * Rtv Cust Shipping Tmp XF - Company Customer EXT  * 
     C                     CALL 'POPRXFR'              90  Rtv Cust Shippi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DFKNB    WQ0088  30       Company Number
     C                     PARM #1BKC7    WQ0089  70       Ship To Custome
     C           YL0020    PARM *ZERO     WQ0090  52       Cust Shipping T
     C           YL0021    PARM *BLANK    WQ0091  1        Cust Shipping T
     C           #1FXSX    PARM *BLANK    WQ0092  3        Ship To Warehou
     C                     PARM *ZERO     WQ0093  40       Item Age Days F
     C                     PARM *ZERO     WQ0094  40       Item Age Days F
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,53           *
     C                     END
      * Cust Shipping Temp
      * CASE: LCL.Cust Shipping Temp is Entered
     C           YL0020    IFNE *ZERO                      *IF
     C                     Z-ADDYL0020    #1RNNB           Reefer Temperat
     C                     MOVELYL0021    #1FRSX           Shipping Temp C
     C                     END                             *FI
     C                     Z-ADD#1RNNB    P1RNNB           Reefer Temperat
     C                     MOVEL#1FRSX    P1FRSX           Shipping Temp C
      * CASE: DTL.Block Order Flag is Block Order
     C           #1BCST    IFEQ 'B'                        *IF
     C                     MOVEL*BLANK    #1FVSX           OH Load Plan Re
     C                     MOVEL'N'       #1FVSX           OH Load Plan Re
     C                     END                             *FI
     C                     MOVEL#1FVSX    YL0003           OH Load Plan Re
      * Set Appointments to non-display if HPB or Live w/TPM  E004119
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Company Organization is High Plains Biodiesel
      *   |- c2    : PAR.PFS Carlisle Active is Yes
      *   '-
     C           P3YJSX    IFEQ 'H'                        *IF
     C           P8WUSX    OREQ 'Y'                        *OR
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * E4119 RMC 7/21/2016 dont display if ldp=Y
     C                     MOVEL'Y'       P6DGTX           Status Flag 10
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#1Q2CD    P1Q2CD           Shipping Method
     C                     MOVEL'F'       #1BCST           Block Order Fla
     C                     MOVEL'F'       YL0006           Block Order Fla
     C                     MOVEL'N'       #1BDST           Order Certifica
     C                     MOVEL'N'       #1FNSX           Transfer in Sto
     C                     MOVELP1FTSX    #1FTSX           Air Freight Ord
     C                     MOVEL'Y'       WUTJST           USR Display 2
      * HPB
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P3YJSX    IFEQ 'H'                        *IF
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : WRK.Company Number     041405 is HPB Biodiesel
      *   |- c2    : WRK.Company Number     041405 is St Joseph HPB Marke
      *   |- c3    : WRK.Company Number     041405 is Hugoton SE Marketin
      *   '-
     C           WUBQC3    IFEQ 369                        *IF
     C           WUBQC3    OREQ 374                        *OR
     C           WUBQC3    OREQ 376                        *OR
      * RMC 7/29/22 added for hugoton
     C                     Z-ADD1.5       #DHEVL           OHE HPB RIN Equ
     C                     END                             *FI
     C                     END                             *FI
      * update exception status used to get 1 time *ADD mode msg for dup.
     C                     MOVEL'N'       WUF6ST           Update Exceptio
      * SET CURSOR
      * CASE: DTL.Ship To Customer is equal to zero
     C           #1BKC7    IFEQ *ZERO                      *IF
      * *Set Cursor: DTL.Ship To Customer  (*Override=*YES)
     C                     Z-ADD003       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: DTL.USR Company Number is Equal to zero
     C           #DFKNB    IFEQ *ZERO                      *IF
      * *Set Cursor: DTL.Ship To Customer  (*Override=*YES)
     C                     Z-ADD003       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.Requested Delivery Date  (*Override=*YES)
     C                     Z-ADD004       W0ROW1
     C                     Z-ADD113       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     END                             *FI
     C                     END                             *FI
      * Set Email cust if blank
      * CASE: DTL.Email Cust On Order Ship is No
     C           #1FOSX    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Email Cust On Order Ship is Yes
     C           #1FOSX    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #1FOSX           Email Cust On O
     C                     END                             *FI
     C                     END                             *FI
      * *-------------------------------------------------------------*
      * * 08/16/00 PKP Default flag to N when creating a new order.
      * Export Doc go w/ Driver
      * CASE: DTL.Export Docs Go w/Driver is Blank
     C           #1FQSX    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1FQSX           Export Docs Go
     C                     END                             *FI
      * Outside Warehouse Flag
      * CASE: PAR.Outside Warehouse Flag is yes
     C           P6X9ST    IFEQ 'Y'                        *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0034           Company Number
     C                     Z-ADD#1BKC7    WL0035           Ship To Custome
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0036    #DWKCD    P      Warehouse Code
      * CASE: PAR.Company Organization is Not HPB
     C           P3YJSX    IFEQ 'D'                        *IF
     C           P3YJSX    OREQ 'S'
      * dont show for hpb - they use 1 cust for all transfers
     C                     Z-ADD1         ZQ      50
     C           @CN,008   CAT  #DWKCD:ZQ #DO6NA    P      Warehouse Desc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0037    P      Warehouse Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    #DO6NA    P      Warehouse Descr
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0037    P      Warehouse Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    #DO6NA    P      Warehouse Descr
     C                     END                             *FI
      * DEFAULT: Spot Buy
      * CASE: PAR.Company Organization is Seaboard
     C           P3YJSX    IFEQ 'S'                        *IF
      * RMC 8/15/14  Req for seaboard now  per sales/josh
     C                     ELSE
      * CASE: *OTHERWISE
      * W77844 DN 06/11/21-Convert 'N' to 'T'urn.
     C                     MOVEL'T'       #DSPOT           Spot Buy  (Y/N)
      * DTL.Spot Buy Text USR = Condition name of DTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #DSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     END                             *FI
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
     C                     MOVEL'Y'       #1U4ST           Load Plan Order
     C                     END
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     END
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Company Name and Address
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate key screen
      * R12926 DN 05/03/18-At Order level, use Absorbed Freight Rate from
      * RTV Cust Ordering Dflt2RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0010           Company Number
     C                     Z-ADD#1BKC7    WL0011           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    #1AQCD    P      Terms Code
     C                     MOVELWL0013    YL0017    P      Sales Route Cod
     C                     MOVELWL0014    #1BYNA    P      Special Instruc
     C                     MOVELWL0015    #1B6NA    P      Special Instruc
     C                     MOVELWL0016    YL0005    P      Carrier Code
     C                     MOVELWL0017    WUPPST    P      P_O Required Fl
     C                     Z-ADDWL0018    #1AFTM           Deliver after t
     C                     MOVELWL0019    WUBOCD    P      Type Code
     C                     Z-ADDWL0020    YN0016           Absorbed Freigh
     C                     Z-ADDWL0021    WUNFNN           Mileage To Cust
     C                     MOVELWL0022    #DAJCD    P      Warehouse Code
     C                     MOVELWL0023    P6X9ST    P      Outside Warehou
     C                     MOVELWL0024    WUG0TX    P      Customer Group
     C                     MOVELWL0025    WUG0TX    P      Customer Group
     C                     MOVELWL0026    YL0018    P      Ord Ent Default
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'Company Customer       NF'
     C                     MOVEL'USR1007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1AIC3    P1AIC3           Company Number
     C                     END                             *FI
     C                     END
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
     C           W0HLP     DOUEQ'N'
     C           W0ROL     ANDEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0SCR     IFEQ 1
      * Set error
     C                     MOVEAINSCR1    *IN,31
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
     C                     ELSE
     C           W0SCR     IFEQ 2
      * Set error
     C                     MOVEAINSCR2    *IN,31
     C                     MOVEL'2'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y2SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT3
     C                     EXFMT#RCDDTL2
      * Test cursor
     C                     EXSR Y8TST
     C                     END
     C                     END
      * Reset roll flag
     C                     MOVEL'N'       W0ROL   1
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Show next page of details
     C   27                EXSR CDNXSC
      * Show previous page of details
     C   28                EXSR CEPVSC
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      * Initialise error memories
     C                     MOVE *ZERO     INSCR1
     C                     MOVE *ZERO     INSCR2
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CDNXSC    BEGSR
      *================================================================
      * Display next screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C                     Z-ADD2         W0SCR
      *================================================================
     CSR         CDEXIT    ENDSR
      /EJECT
     CSR         CEPVSC    BEGSR
      *================================================================
      * Display previous screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C                     Z-ADD1         W0SCR
      *================================================================
     CSR         CEEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     MOVE *ZEROS    INSCR1
     C                     MOVE *ZEROS    INSCR2
     C                     EXSR DCVLDL
      * Display first screen in error
     C           INSCR1    IFNE *ZERO
     C                     Z-ADD1         W0SCR
     C                     ELSE
     C           INSCR2    IFNE *ZERO
     C                     Z-ADD2         W0SCR
     C                     END
     C                     END
      * QUIT if error:
     C           *IN99     CABEQ'1'       CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MFIZ#2
     C                     END
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,31
     C                     SETON                     99    *
     C                     END
      * Validate USR Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELVDFKNB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVDFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #DFKNB           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #DFKNB           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,32
     C                     SETON                     99    *
     C                     END
      * Validate Requested Delivery Date
      * External date
     C                     Z-ADDV1EIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1EIDT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,33
     C                     SETON                     99    *
     C                     END
      * Validate Requested Ship Date
      * External date
     C                     Z-ADDV1A5DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1A5DT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,35
     C                     SETON                     99    *
     C                     END
      * Validate Shipping Method
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1Q2CD'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Shipping Method
     C                     MOVEL#1Q2CD    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHQ2CD
     C                     SELEC
     C           W0INVL    WHEQ 'CR'                       CR
     C                     Z-ADD1         ZHQ2CD
     C           W0INVL    WHEQ 'CT'                       CT
     C                     Z-ADD2         ZHQ2CD
     C           W0INVL    WHEQ 'PR'                       PR
     C                     Z-ADD3         ZHQ2CD
     C           W0INVL    WHEQ 'PT'                       PT
     C                     Z-ADD4         ZHQ2CD
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD5         ZHQ2CD
     C                     ENDSL
     C                     EXFMTZGQ2CD
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHQ2CD    WHEQ 1
     C                     MOVEL'CR'      W0INVL           CR
     C           ZHQ2CD    WHEQ 2
     C                     MOVEL'CT'      W0INVL           CT
     C           ZHQ2CD    WHEQ 3
     C                     MOVEL'PR'      W0INVL           PR
     C           ZHQ2CD    WHEQ 4
     C                     MOVEL'PT'      W0INVL           PT
     C           ZHQ2CD    WHEQ 5
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1Q2CD
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,37
     C                     SETON                     99    *
     C                     END
      * Validate LTL Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1PJST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * LTL Flag
     C                     MOVEL#1PJST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHPJST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHPJST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHPJST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHPJST
     C                     ENDSL
     C                     EXFMTZGPJST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHPJST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHPJST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHPJST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1PJST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,40
     C                     SETON                     99    *
     C                     END
      * Validate Block Order Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1BCST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Block Order Flag
     C                     MOVEL#1BCST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHBCST
     C                     SELEC
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD1         ZHBCST
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD2         ZHBCST
     C                     ENDSL
     C                     EXFMTZGBCST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHBCST    WHEQ 1
     C                     MOVEL'B'       W0INVL           B
     C           ZHBCST    WHEQ 2
     C                     MOVEL'F'       W0INVL           F
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1BCST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,41
     C                     SETON                     99    *
     C                     END
      * Validate Claim Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1C0C7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1C0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1C0C7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1C0C7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,46
     C                     SETON                     99    *
     C                     END
      * Validate Transfer in Storage Ind
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1FNSX'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Transfer in Storage Ind
     C                     MOVEL#1FNSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHFNSX
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHFNSX
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHFNSX
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHFNSX
     C                     ENDSL
     C                     EXFMTZGFNSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHFNSX    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHFNSX    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHFNSX    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1FNSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,47
     C                     SETON                     99    *
     C                     END
      * Validate Order Date
      * External date
     C                     Z-ADDV1A0DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1A0DT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,48
     C                     SETON                     99    *
     C                     END
      * Validate Shipping Temp Code C_F
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1FRSX'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Shipping Temp Code C_F
     C                     MOVEL#1FRSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHFRSX
     C                     SELEC
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD1         ZHFRSX
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD2         ZHFRSX
     C                     ENDSL
     C                     EXFMTZGFRSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHFRSX    WHEQ 1
     C                     MOVEL'C'       W0INVL           C
     C           ZHFRSX    WHEQ 2
     C                     MOVEL'F'       W0INVL           F
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1FRSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,50
     C                     SETON                     99    *
     C                     END
      * Validate Spot Buy  (Y/N)
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DSPOT'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Spot Buy  (Y/N)
     C                     MOVEL#DSPOT    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHSPOT
     C                     SELEC
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD1         ZHSPOT
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD2         ZHSPOT
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD3         ZHSPOT
     C                     ENDSL
     C                     EXFMTZGSPOT
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHSPOT    WHEQ 1
     C                     MOVEL'S'       W0INVL           S
     C           ZHSPOT    WHEQ 2
     C                     MOVEL'T'       W0INVL           T
     C           ZHSPOT    WHEQ 3
     C                     MOVEL'P'       W0INVL           P
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DSPOT
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,52
     C                     SETON                     99    *
     C                     END
      * Validate Export Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1U2ST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Export Status
     C                     MOVEL#1U2ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHU2ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHU2ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHU2ST
     C                     ENDSL
     C                     EXFMTZGU2ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHU2ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHU2ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1U2ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,56
     C                     SETON                     99    *
     C                     END
      * Validate OH Appt Confirmation Dt
      * External date
     C                     Z-ADDV1NODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1NODT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,57
     C                     SETON                     99    *
     C                     END
      * Validate OH Appt Confirmation Tm
     C                     Z-ADD#1BRTM    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,58
     C                     SETON                     99    *
     C                     END
      * Validate Order Certification Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1BDST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Order Certification Flag
     C                     MOVEL#1BDST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHBDST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHBDST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHBDST
     C                     ENDSL
     C                     EXFMTZGBDST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHBDST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHBDST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1BDST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,62
     C                     SETON                     99    *
     C                     END
      * Validate Export Docs Go w_Driver
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1FQSX'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Export Docs Go w_Driver
     C                     MOVEL#1FQSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHFQSX
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHFQSX
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHFQSX
     C                     ENDSL
     C                     EXFMTZGFQSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHFQSX    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHFQSX    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1FQSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,63
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * Cancel Order
      * CASE: DTL.*CMD key is *Cancel
     C           *IN11     IFEQ '1'                        *IF
      * Edit for Cancel
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load is not zero check load Sts of E or C else cancel order
      * CASE: DTL.Load ID NE WRK.ZERO
     C           #1RMNB    IFNE WUW0NB                     *IF
      * RTV Load Status        RT - Load Header  * 
     C                     EXSR SVRVGN
      * If load status is U,L,S or I then can't cancel, else cancel order
      * CASE: WRK.Load Status is Unlocked thru Invoiced
     C           WUPKST    IFEQ 'I'                        *IF
     C           WUPKST    OREQ 'L'
     C           WUPKST    OREQ 'S'
     C           WUPKST    OREQ 'U'
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD#1RMNB    ZA0002           Load ID
      * Send message 'Order Cannot be Canc-Load'
     C                     MOVEL'USR2363' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Cancel Order that has been assigned to a load
      * CASE: DTL.*CMD key is *Cancel
     C           *IN11     IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVEL'N'       WUQ2ST           Status Flag 2
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'N'       WUFMST           Status Flag 4
     C                     MOVEL'N'       WUAJTX           Status Flag 5
     C                     MOVEL'N'       WUACTX           Status Flag 6
     C                     MOVEL'N'       WUAKTX           Status Flag 7
      * ** 03/12/13 slm add email on Acknowledgement by the Warehouse Dis
     C                     MOVEL'N'       WUAFTX           Status Flag 8
     C                     MOVEL'N'       WUDFTX           Status Flag 9
     C                     MOVEL#1FVSX    WUDITX           Status Flag 12
     C                     MOVEL'N'       WUDXSX           Display Flag 1
      * ** 03/12/13 slm add email on Acknowledgement by the Warehouse Dis
     C                     MOVEL*BLANK    WURJAA           Email to Wareho
      * ** 05/08/13 rmc C2586 TPM Frt Order Sts
      * 08/21/2017 DN T11489-Added Salesperson Code/Name to Parm.
      * 08/27/24 SP S312312-Start
      * SEL Confirm Prompt     PV - Order Header TRG  * 
     C                     CALL 'PDS0PVR'              90  SEL Confirm Pro
     C                     PARM *BLANK    W0RTN   7
     C           WUB8ST    PARM WUB8ST    WQ0098  1        Status - Y or N
     C                     PARM #1AIC3    WQ0099  30       Company Number
     C                     PARM #1C4NB    WQ0100  70       Order Number
     C                     PARM #1BKC7    WQ0101  70       Ship To Custome
     C                     PARM #1BCST    WQ0102  1        Block Order Fla
     C           #1FVSX    PARM #1FVSX    WQ0103  2        OH Load Plan Re
     C           WUDTSX    PARM WUDTSX    WQ0104  1        Print (Yes/No)
     C           WUQ2ST    PARM WUQ2ST    WQ0105  1        Status Flag 2
     C           WUQ3ST    PARM WUQ3ST    WQ0106  1        Status Flag 3
     C           WUFMST    PARM WUFMST    WQ0107  1        Status Flag 4
     C           WUAJTX    PARM WUAJTX    WQ0108  1        Status Flag 5
     C           WUACTX    PARM WUACTX    WQ0109  1        Status Flag 6
     C           WUAKTX    PARM WUAKTX    WQ0110  1        Status Flag 7
     C           WUAFTX    PARM WUAFTX    WQ0111  1        Status Flag 8
     C           WUDITX    PARM WUDITX    WQ0112  1        Status Flag 12
     C           WURJAA    PARM WURJAA    WQ0113  3        Email to Wareho
     C           WUVQSX    PARM WUVQSX    WQ0114  1        Email Selection
     C           P9BCCD    PARM P9BCCD    WQ0115  3        Salesperson Cod
     C           YL0022    PARM YL0022    WQ0116 30        Salesperson Nam
     C           YL0023    PARM YL0023    WQ0117  1        Email to Broker
     C           YL0024    PARM YL0024    WQ0118  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDS0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,41           *
     C                     END
      * 08/27/24 SP S312312-End
      * CASE: WRK.Status - Y or N is no
     C           WUB8ST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Remove load ID from canceled order
      * CHG Load ID            CH - PD Order Header  * 
     C                     EXSR SWCHRC
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
      * UPD Cancel Order       XF - PD Order Header  * 
     C                     CALL 'OPV9XFR'              90  UPD Cancel Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0119  30       Company Number
     C                     PARM #1C4NB    WQ0120  70       Order Number
     C                     PARM #1ANC7    WQ0121  70       AR Customer Num
     C                     PARM #1BKC7    WQ0122  70       Ship To Custome
     C                     PARM #1OBST    WQ0123  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPV9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     END
      * CASE: DTL.OH Load Plan Ready is Yes
     C           #1FVSX    IFEQ 'Y'                        *IF
      * Rtv Crt OH Trigger    XF - TMS Order Header Trigger  * 
     C                     CALL 'PBWVXFR'              90  Rtv Crt OH Trig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C4NB    WQ0124  70       Order Number
     C                     PARM #1AIC3    WQ0125  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'CANORD'  WURVST           Load Change Typ
     C                     MOVEL'X'       WUHSUS           Header Status U
      * NOTE:  Will only write log if order on load and load not in E sta
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVEL#1GWST    PDMNTX    P      Change Log Prio
     C                     MOVELWUHSUS    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * VAL Load ID on Orders  RT - PD Order Header  * 
     C                     EXSR SXRVGN
      * If no other orders on load then delete the load else change load
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * ** E-TRANS47 LJB 01/03/2008  Reverse FP1061 per Gary Martin. If a
      * ** Load ID is cancelled then the carrier needs to be notified.
      * ** Traffic will do this.
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'DELOAD'  WURVST           Load Change Typ
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELWUPKST    PDMNTX    P      Change Log Prio
     C                     MOVEL@CN,011   PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD*ZERO     PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * NOTE:  Will only write log if order on load and load not in E sta
      * DLT Load Header        DL - Load Header  * 
     C                     EXSR SYDLRC
      * DLT Load Detail       RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0064           Load ID
     C                     EXSR SZRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Sub Weight & Stop  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0067           Load ID
     C                     Z-ADD#1A1WG    WL0068           Order Weight To
     C                     EXSR TBRVGN
      * CHG Del Order Off load RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0069           Load ID
     C                     Z-ADD#1C4NB    WL0070           Order Number
     C                     EXSR TDRVGN
     C                     END                             *FI
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Cancel Order that has not yet been assigned to a load
      * CASE: DTL.*CMD key is *Cancel
     C           *IN11     IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVEL'N'       WUQ2ST           Status Flag 2
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'N'       WUFMST           Status Flag 4
     C                     MOVEL'N'       WUAJTX           Status Flag 5
     C                     MOVEL'N'       WUACTX           Status Flag 6
     C                     MOVEL'N'       WUAKTX           Status Flag 7
     C                     MOVEL'N'       WUAFTX           Status Flag 8
     C                     MOVEL'N'       WUDITX           Status Flag 12
      * 08/21/2017 DN T11489-Added Salesperson Code/Name to Parm.
      * 08/27/24 SP S312312-Start
      * SEL Confirm Prompt     PV - Order Header TRG  * 
     C                     CALL 'PDS0PVR'              90  SEL Confirm Pro
     C                     PARM *BLANK    W0RTN   7
     C           WUB8ST    PARM WUB8ST    WQ0126  1        Status - Y or N
     C                     PARM #1AIC3    WQ0127  30       Company Number
     C                     PARM #1C4NB    WQ0128  70       Order Number
     C                     PARM #1BKC7    WQ0129  70       Ship To Custome
     C                     PARM #1BCST    WQ0130  1        Block Order Fla
     C           #1FVSX    PARM #1FVSX    WQ0131  2        OH Load Plan Re
     C           WUDTSX    PARM WUDTSX    WQ0132  1        Print (Yes/No)
     C           WUQ2ST    PARM WUQ2ST    WQ0133  1        Status Flag 2
     C           WUQ3ST    PARM WUQ3ST    WQ0134  1        Status Flag 3
     C           WUFMST    PARM WUFMST    WQ0135  1        Status Flag 4
     C           WUAJTX    PARM WUAJTX    WQ0136  1        Status Flag 5
     C           WUACTX    PARM WUACTX    WQ0137  1        Status Flag 6
     C           WUAKTX    PARM WUAKTX    WQ0138  1        Status Flag 7
     C           WUAFTX    PARM WUAFTX    WQ0139  1        Status Flag 8
     C           WUDITX    PARM WUDITX    WQ0140  1        Status Flag 12
     C           WURJAA    PARM WURJAA    WQ0141  3        Email to Wareho
     C           WUVQSX    PARM WUVQSX    WQ0142  1        Email Selection
     C           P9BCCD    PARM P9BCCD    WQ0143  3        Salesperson Cod
     C           YL0022    PARM YL0022    WQ0144 30        Salesperson Nam
     C           YL0023    PARM YL0023    WQ0145  1        Email to Broker
     C           YL0024    PARM YL0024    WQ0146  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDS0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,41           *
     C                     END
      * 08/27/24 SP S312312-End
      * Write Load/Order change log
      * CASE: WRK.Status - Y or N is no
     C           WUB8ST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SLS'     WUUJST           Department Cont
     C                     MOVEL'CANORD'  WURVST           Load Change Typ
     C                     MOVEL'X'       WUHSUS           Header Status U
      * E2640 RMC Call Different Load Ord chg log
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0147  70       Load ID
     C                     PARM WURVST    WQ0148  6        Load Change Typ
     C                     PARM WUUJST    WQ0149  3        Department Cont
     C                     PARM #1GWST    WQ0150 12        Change Log Prio
     C                     PARM WUHSUS    WQ0151 12        Change Log New
     C                     PARM #1AIC3    WQ0152  30       Company Number
     C                     PARM #1C4NB    WQ0153  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * NOTE:  Will only write log if order on load and load not in E sta
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
      * UPD Cancel Order       XF - Order Header TRG  * 
     C                     CALL 'OPV9XFR'              90  UPD Cancel Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0154  30       Company Number
     C                     PARM #1C4NB    WQ0155  70       Order Number
     C                     PARM #1ANC7    WQ0156  70       AR Customer Num
     C                     PARM #1BKC7    WQ0157  70       Ship To Custome
     C                     PARM #1OBST    WQ0158  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPV9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     END
      * CASE: DTL.OH Load Plan Ready is Yes
     C           #1FVSX    IFEQ 'Y'                        *IF
      * Rtv Crt OH Trigger    XF - TMS Order Header Trigger  * 
     C                     CALL 'PBWVXFR'              90  Rtv Crt OH Trig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C4NB    WQ0159  70       Order Number
     C                     PARM #1AIC3    WQ0160  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Add error
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * RTV OE Hold/ShipTo FlagRT - Customer  * 
     C                     EXSR TERVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Order Entry Hold
      * CASE: WRK.Order Entry Hold is New Order Hold
     C           WUQNST    IFEQ 'Y'                        *IF
      * Send message 'Customer hold status'
     C                     MOVEL'USR1025' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Ship to Customer = N
      * CASE: WRK.Ship To Customer Flag is No Use as Ship to Cust
     C           WURJST    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Ship to Customer Flag 'N''
     C                     MOVEL'USR2482' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Customer not found'
     C                     MOVEL'USR0525' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Select company
      * CASE: Select on Company
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.USR Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'VDFKNB'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #DFKNB    PARM #DFKNB    WQ0161  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
     C                     END
     C                     END                             *FI
      * Select customer
      * CASE: Select on Ship to Customer
      *  - c1 AND c2 AND c3
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Ship To Customer
      *   |- c3    : PGM.*Program mode is *ADD
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'V1BKC7'                   *IF
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0162  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     END
      * Change to customer
      * CASE: DTL.Ship To Customer NE WRK.ZERO
     C           #1BKC7    IFNE WUW0NB                     *IF
     C                     Z-ADD#DFKNB    P1AIC3           Company Number
     C                     Z-ADD#1BKC7    P1BKC7           Ship To Custome
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     MOVEL@CN,012   P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
      * Select TYPE (HPB ONLY -- and SBD)
      * CASE: Select on Customer type
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Type Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#DBOCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Type Codes         SR - Type Codes  * 
     C                     CALL 'CABVSRR'              90  SEL Type Codes
     C                     PARM *BLANK    W0RTN   7
     C           #DBOCD    PARM #DBOCD    WQ0163  2        Type Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABVSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,55           *
     C                     END
     C                     END                             *FI
      * S028326 JM 08/22/24-Validate Company
      * CASE: *OTHERWISE
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DFKNB    WQ0164  30       Company Number
     C           YL0025    PARM *BLANK    WQ0165  1        Plant Company S
     C                     PARM *BLANK    WQ0166  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
     C                     END
      * CASE: LCL.Plant Company Sts is Plant Company
     C           YL0025    IFEQ 'P'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert USR Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #DFKNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#DFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0004           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Company must be a Plant'
     C                     MOVEL'USR3706' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Change to company number
      * CASE: DTL.USR Company Number NE PAR.Company Number
     C           #DFKNB    IFNE P1AIC3                     *IF
     C                     Z-ADD#DFKNB    P1AIC3           Company Number
     C                     Z-ADD#1BKC7    P1BKC7           Ship To Custome
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     MOVEL@CN,012   P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Change to customer
      * CASE: DTL.Ship To Customer NE PAR.Ship To Customer
     C           #1BKC7    IFNE P1BKC7                     *IF
      * Validate customer
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * VAL Check Exists       RT - Customer  * 
     C                     EXSR TFRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     Z-ADD#DFKNB    P1AIC3           Company Number
     C                     Z-ADD#1BKC7    P1BKC7           Ship To Custome
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     MOVEL@CN,012   P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0005           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Customer Master        NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL@CN,012   P2BYVN           Next Program Na
      * Selects - Warehouse, Salesperson, Country, Intended for Export
      * CASE: Select on Salesperson
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Salesperson Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#DBCCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Salesperson SR - Salesperson  * 
     C                     CALL 'CABYSRR'              90  SEL Active Sale
     C                     PARM *BLANK    W0RTN   7
     C           #DBCCD    PARM #DBCCD    WQ0167  3        Salesperson Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,44           *
     C                     END
     C                     ELSE
      * CASE: Select on Warehouse
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Warehouse Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#DAJCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
     C                     EXSR TGRVGN
      * CASE: LCL.Application WHS Restrict is no
     C           YL0026    IFEQ 'N'                        *IF
      * SEL ShipCo/Warehouse   SR - Warehouse  * 
     C                     CALL 'PPHQSRR'              90  SEL ShipCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #DAJCD    PARM #DAJCD    WQ0168  3        Warehouse Code
     C                     PARM #DFKNB    WQ0169  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPHQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     MOVEL'1'       @I1,32           *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Sel User Appl Whs     SR - User Application Whs  * 
     C                     CALL 'PNMMSRR'              90  Sel User Appl W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0170 10        User Profile Na
     C                     PARM 'O/P'     WQ0171  6        Application Cod
     C           #DAJCD    PARM #DAJCD    WQ0172  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: Select on Country (Export) Code
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#DKXCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DKXCD    PARM #DKXCD    WQ0173  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,60           *
     C                     END
     C                     ELSE
      * CASE: Select Intended for Export (to Country)  E00157
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.OHE Intended for ExportCC
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#DLWAA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DLWAA    PARM #DLWAA    WQ0174  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,64           *
     C                     END
     C                     MOVEL#DLWAA    P6LWAA           OHE Intended fo
     C                     ELSE
      * CASE: Select HPB Ship to warehouse
      *  - c1ANDc2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.HPB Ship to Warehouse
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#1FXSX'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL ShipCo/Whse/Loc    SR - Warehouse  * 
     C                     CALL 'PNNWSRR'              90  SEL ShipCo/Whse
     C                     PARM *BLANK    W0RTN   7
     C           #1FXSX    PARM #1FXSX    WQ0175  3        Warehouse Code
     C                     PARM 'E'       WQ0176  1        Warehouse Locat
     C                     PARM #DFKNB    WQ0177  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNNWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,53           *
     C                     MOVEL'1'       @I1,32           *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Sls Route by Slsp  RT - Sales Route  * 
     C                     EXSR THRVGN
      * Sales route required
      * CASE: DTL.Sales Route Code EQ WRK.BLANK
     C           #1R4CD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#DBCCD    ZA0006           Salesperson Cod
      * Send message 'Salesperson not on route'
     C                     MOVEL'USR2029' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,44           *
      *
     C                     END                             *FI
      * Validate Type code (HPB and SBD)
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Company Organization is High Plains Biodiesel
      *   |- c2    : PAR.Company Organization is Seaboard
      *   '-
     C           P3YJSX    IFEQ 'H'                        *IF
     C           P3YJSX    OREQ 'S'                        *OR
      * Validate Type code (HPB and SBD)
      * CASE: DTL.Type Code is Entered
     C           #DBOCD    IFNE *BLANK                     *IF
      * Val Type Codes         XF - Type Codes  * 
     C                     CALL 'PBAKXFR'              90  Val Type Codes
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DBOCD    WQ0178  2        Type Code
     C           WUH3TX    PARM WUH3TX    WQ0179  7        Return Code Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,55           *
     C                     END
      * CASE: WRK.Return Code Usr is *Record does not exist
     C           WUH3TX    IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     MOVEL#DBOCD    ZA0007           Type Code
      * Send message 'Type Code Not Found'
     C                     MOVEL'USR3388' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,55           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Default for HPB Only  & sbd
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P3YJSX    IFEQ 'H'                        *IF
     C                     MOVELWUBOCD    #DBOCD           Type Code
     C                     ELSE
      * CASE: PAR.Company Organization is Seaboard
     C           P3YJSX    IFEQ 'S'                        *IF
      * Rtv Dft Sales Channel  XF - Salesperson Electronic CM  * 
     C                     CALL 'PBHPXFR'              90  Rtv Dft Sales C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DBCCD    WQ0180  3        Salesperson Cod
     C           YL0019    PARM *BLANK    WQ0181  2        SEC Default Sal
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBHPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,44           *
     C                     END
     C                     MOVELYL0019    #DBOCD           Type Code
      * CASE: DTL.Type Code is EQ Blank
     C           #DBOCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DBOCD    ZA0008           Type Code
      * Send message 'Type Code Not Found'
     C                     MOVEL'USR3388' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,55           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DBOCD    ZA0009           Type Code
      * Send message 'Type Code Not Found'
     C                     MOVEL'USR3388' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,55           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VP Level
      * CASE: DTL.VP Level Code EQ WRK.BLANK
     C           #1Q4CD    IFEQ WUGSTX                     *IF
      * RTV Mgr Desc,VP Level  RT - Manager Level  * 
     C                     EXSR TIRVGN
     C                     END                             *FI
      * RTV Order Types        RT - OP Order Types  * 
     C                     EXSR TJRVGN
      * Validate Order type
      * CASE: DTL.Billing Activity Type is Credit or Debit Memo
     C           #1OBST    IFEQ '2'                        *IF
     C           #1OBST    OREQ '3'
      * Setup message data for message
     C                     MOVEL@CN,013   ZA0010           Order Type Desc
     C                     MOVEL#1JNCD    ZA0011           Order Type_Sale
      * Send message 'Order type invalid'
     C                     MOVEL'USR1895' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
      *
     C                     ELSE
      * CASE: DTL.Billing Activity Type is Warehouse Transfer
     C           #1OBST    IFEQ '4'                        *IF
      * CASE: PAR.Outside Warehouse Flag is Not Yes
     C           P6X9ST    IFEQ *BLANK                     *IF
     C           P6X9ST    OREQ 'N'
      * Setup message data for message
     C                     MOVEL#1JNCD    ZA0012           Order Type_Sale
      * Send message 'Order Type Whse/Cust not'
     C                     MOVEL'USR0610' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Billing Activity Type is Invoice
     C           #1OBST    IFEQ '1'                        *IF
      * CASE: PAR.Outside Warehouse Flag is yes
     C           P6X9ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1JNCD    ZA0013           Order Type_Sale
      * Send message 'Cust Whse/Order Type not'
     C                     MOVEL'USR2259' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Fill Warehouse Control
      * CASE: DTL.Warehouse Code NE WRK.BLANK
     C           #DAJCD    IFNE WUGSTX                     *IF
      * RTV WhsTyp/Ctrl/LdTyp RT - Warehouse  * 
     C                     EXSR TKRVGN
     C                     END                             *FI
      * Add mode processing
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * 6/20/13 RMC E2625 get tpm loc code too
      * RTV Cust Addr, A/R,Loc RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0043           Ship To Custome
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    #1BRTX    P      Customer Name
     C                     MOVELWL0045    #1HMNA    P      Address Line 1
     C                     MOVELWL0046    #1HONA    P      Address Line 2
     C                     MOVELWL0047    #1HPNA    P      Address Line 3
     C                     MOVELWL0048    #1HNNA    P      City
     C                     MOVELWL0049    #1DBCD    P      State Code
     C                     MOVELWL0050    #1CKTX    P      Zip Postal Code
     C                     MOVELWL0051    #DV4T1    P      Alpha Search
     C                     Z-ADDWL0052    #1ANC7           AR Customer Num
     C                     MOVELWL0053    #1FOSX    P      Email When Orde
     C                     Z-ADD#1ANC7    #1B0C7           Bill to Custome
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1B0C7    WL0054           Ship To Custome
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    #1AETX    P      Customer Name
     C                     MOVELWL0056    #1B1NA    P      Address Line 1
     C                     MOVELWL0057    #1B3NA    P      Address Line 2
     C                     MOVELWL0058    #1B4NA    P      Address Line 3
     C                     MOVELWL0059    #1B2NA    P      City
     C                     MOVELWL0060    #1BHCD    P      State Code
     C                     MOVELWL0061    #1C8TX    P      Zip Postal Code
      * Check for duplicate P.O #
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Customer Purchase Order # NE WRK.BLANK
      *   |- c2    : WRK.Update Exception Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BCNA    IFNE WUGSTX                     *IF
     C           WUF6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Co,Cust,PO         RT - Order Header TRG  * 
     C                     EXSR TLRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,014                    *IF
      * informational message was getting lost; get error message 1st tim
      *     allow update
      * Setup message data for message
     C                     MOVEL#1BCNA    ZA0014           Customer Purcha
      * Send message 'P/O Number is a duplicate'
     C                     MOVEL'USR2439' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,36           *
      *
     C                     MOVEL'Y'       WUF6ST           Update Exceptio
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate "Intended For Export" country code        E00157
      * CASE: DTL.OHE Intended for ExportCC is Entered
     C           #DLWAA    IFNE *BLANK                     *IF
      * DO2416 DN 03/24/22-Validate Country Exist & Active.
      * Val Country & Active   RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DLWAA    WL0071    P      Country Code
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0072    YL0027    P      Record Status
      * DO2416 DN 03/24/22-Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Throw Error Message if NOT Active.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0027    IFEQ 'A'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DLWAA    ZA0015           OHE Intended fo
      * Send message 'Country Inactive'
     C                     MOVEL'USR5198' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,64           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DLWAA    ZA0016           OHE Intended fo
      * Send message 'Country Code           NX'
     C                     MOVEL'USR2030' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,64           *
      *
     C                     END                             *FI
      * ** Cannot put Intended for Export country on an export E00157
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.Export Status is yes
      *   |- c2    : DTL.Country Code is Entered
      *   '-
     C           #1U2ST    IFEQ 'Y'                        *IF
     C           #DKXCD    ORNE *BLANK                     *OR
      * Setup message data for message
     C                     MOVEL#DLWAA    ZA0017           OHE Intended fo
      * Send message 'OHE Intend for exp invald'
     C                     MOVEL'USR4188' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,64           *
      *
     C                     END                             *FI
      * RTV Desc, Status       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DLWAA    WL0003    P      Country Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DD6T1    P      Country Descrip
     C                     MOVELWL0005    YN0001    P      Record Status
     C                     END                             *FI
      * Validate country code     (moved to before ship date tests)
      * CASE: DTL.Country Code NE WRK.BLANK
     C           #DKXCD    IFNE WUGSTX                     *IF
      * ** Error if "Intended for Export" is entered - one or the other
      * CASE: DTL.OHE Intended for ExportCC is Entered
     C           #DLWAA    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DLWAA    ZA0018           OHE Intended fo
      * Send message 'Country w/Intnd for Exprt'
     C                     MOVEL'USR4189' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,64           *
      *
     C                     END                             *FI
      * DO2416 DN 03/24/22-Validate Country Exist & Active.
      * Val Country & Active   RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKXCD    WL0071    P      Country Code
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0072    YL0027    P      Record Status
      * DO2416 DN 03/24/22-Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Throw Error Message if NOT Active.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0027    IFEQ 'A'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DKXCD    ZA0019           Country Code
      * Send message 'Country Inactive'
     C                     MOVEL'USR5198' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,60           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DKXCD    ZA0020           Country Code
      * Send message 'Country Code           NX'
     C                     MOVEL'USR2030' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,60           *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       #1U2ST           Export Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Error if export status = Y
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DKXCD    ZA0021           Country Code
      * Send message 'Export Code Required'
     C                     MOVEL'USR2034' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,60           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Date Tests:
      * ** Dates are handled differently for Dailys and HPB   E00447
      * Sched ship date = req ship date if order sts is "E"ntered
      * CASE: DTL.Header Status is Entered
     C           #1GWST    IFEQ 'E'                        *IF
     C                     Z-ADD#1A5DT    #1AODT           Scheduled Ship
     C                     END                             *FI
      * VAL:  Requested Ship Date
      * CASE: DTL.Requested Ship Date GT DTL.Scheduled Ship Date
     C           #1A5DT    IFGT #1AODT                     *IF
      * Setup message data for message
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0022
      * Send message 'Req Shp Dt GT Sch Shp Dt'
     C                     MOVEL'USR4780' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,35           *
      *
     C                     END                             *FI
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0182  30       Company Number
     C                     PARM *BLANK    WQ0183  1        Plant Company S
     C           P3YJSX    PARM *BLANK    WQ0184  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Requested Ship date change
      * CASE: DTL.Requested Ship Date NE DTL.USR Requested ship date s
     C           #1A5DT    IFNE #DCZDT                     *IF
     C                     MOVEL'N'       P6AKTX           Status Flag 7
     C                     MOVEL'N'       P6AFTX           Status Flag 8
      * Val Day Prior Ship    RT - Order Detail  * 
     C                     EXSR TNRVGN
      * Check Date method, date price
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Record Found USR is Record Found
      *   |- c2    : LCL.Display Flag is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0028    IFEQ 'Y'                        *IF
     C           YL0029    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Modify Market Price Date'
     C                     MOVEL'USR2964' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       YL0029           Display Flag
     C                     END                             *FI
      * Test dates 7 days out if on a load, else 1 day
      * CASE: DTL.Load ID is Blank
     C           #1RMNB    IFEQ *ZERO                      *IF
      * WRK.Date To               USR = JOB.*Job date + CON.1 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WUJFDT
     C                     ELSE
     C           XDINDT    SUB  1000000   WUJFDT
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * WRK.Date To               USR = JOB.*Job date + CON.7 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WUJFDT
     C                     ELSE
     C           XDINDT    SUB  1000000   WUJFDT
     C                     END
     C                     END                             *FI
      * Update SSD if within date range                       E00447
      * CASE: DTL.Scheduled Ship Date GT WRK.Date To               USR
     C           #1AODT    IFGT WUJFDT                     *IF
      * CASE: WRK.USR Output Only Status is Not Yes
     C           WUE5ST    IFEQ *BLANK                     *IF
     C           WUE5ST    OREQ 'N'
      * dont update sched ship date if mult orders on a load
     C                     Z-ADD#1A5DT    #1AODT           Scheduled Ship
     C                     END                             *FI
     C                     END                             *FI
      * Update SSD if Dailys or HPB           E00447
      * CASE:
      *  - c1 ORc2 ORc3
      *   |- c1    : PAR.Company Organization is Not Seaboard
      *   |- c2    : DTL.Load Type is Bulk
      *   |- c3    : DTL.Block Order Flag is Block Order
      *   '-
     C           P3YJSX    IFEQ 'D'                        *IF
     C           P3YJSX    OREQ 'H'
     C           #1VDST    OREQ 'B'                        *OR
     C           #1BCST    OREQ 'B'                        *OR
     C                     Z-ADD#1A5DT    #1AODT           Scheduled Ship
     C                     END                             *FI
     C                     END                             *FI
     C           #1AFTM    MULT 100       WUAPTM           Time
      * ** Requested Ship Date cannot be before today (test only if chang
      * CASE: DTL.Requested Ship Date NE DTL.USR Requested ship date s
     C           #1A5DT    IFNE #DCZDT                     *IF
      * CASE: DTL.Requested Ship Date LT JOB.*Job date
     C           #1A5DT    IFLT ##JDT                      *IF
      * Setup message data for message
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0023
      * Send message 'Date Must Be GE Job Date'
     C                     MOVEL'USR3927' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,35           *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
      * Edit Delivery Time
      * CASE: DTL.Requested Delivery Time is GT 24 Hour Day
     C           #1AFTM    IFGT 2400                       *IF
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0024           Requested Deliv
      * Send message 'Time Field GT 24 Hours'
     C                     MOVEL'USR1712' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,34           *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: DTL.Requested Delivery Time is LT 0
     C           #1AFTM    IFLT 0                          *IF
      * RMC 01/23/07 added err for time < 0 (& unlock field LJB 5/16/08)
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0025           Requested Deliv
      * Send message 'Time cannot be negative'
     C                     MOVEL'USR3682' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,34           *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: DTL.Requested Delivery Time is Zero
     C           #1AFTM    IFEQ *ZERO                      *IF
      * LJB 05/16/08 Time cannot be zeros  (& unlock field)
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0026           Requested Deliv
      * Send message 'Time Required'
     C                     MOVEL'USR2333' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,34           *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: *OTHERWISE
     C           #1AFTM    DIV  100       YRWF00           *Modulo work fi
     C                     MVR            WURDNB           USR Remainder
      * CASE: WRK.USR Remainder is GT 59 Minutes
     C           WURDNB    IFGT 59                         *IF
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0027           Requested Deliv
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,34           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate delivery date if it has changed or if it is new
      * CASE:
      *  - (c1 AND c2) OR c3
      *   |- c1    : DTL.Requested Delivery Date NE WRK.Requested Deliver
      *   |- c2    : WRK.Requested Delivery Dt is Entered
      *   |- c3    : WRK.Requested Delivery Dt is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1EIDT    IFNE WUAYDZ                     *IF
     C           WUAYDZ    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WUAYDZ    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Requested Delivery Date cannot be before today or now
      * CASE: DTL.Requested Delivery Date LT JOB.*Job date
     C           #1EIDT    IFLT ##JDT                      *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0028
      * Send message 'Date Must Be GE Job Date'
     C                     MOVEL'USR3927' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: DTL.Requested Delivery Date EQ JOB.*Job date
     C           #1EIDT    IFEQ ##JDT                      *IF
      * CASE: DTL.Shipping Method is Prepaid
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'
      * CASE: WRK.Time LE JOB.*Job time
     C           WUAPTM    IFLE ##JTM                      *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0029
      * Send message 'Date Must Be GE Job Date'
     C                     MOVEL'USR3927' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Delivery Date cannot be before Scheduled Ship Date      FP1251
      * CASE: DTL.Requested Delivery Date LT DTL.Scheduled Ship Date
     C           #1EIDT    IFLT #1AODT                     *IF
      * ** Do not allow the Delivery date to be before the Ship Date. Unl
      * ** the field if there is an error so it can be corrected.   FP125
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0030
      * Send message 'Delivery Date < Ship Date'
     C                     MOVEL'USR2063' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
      * ** Delivery Date cannot be before Requested Ship Date      E00147
      * CASE: DTL.Requested Delivery Date LT DTL.Requested Ship Date
     C           #1EIDT    IFLT #1A5DT                     *IF
      * Setup message data for message
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0031
      * Send message 'Ship Date after Deliv Dt'
     C                     MOVEL'USR3881' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,35           *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     MOVEL'N'       P6AKTX           Status Flag 7
     C                     MOVEL'N'       P6AFTX           Status Flag 8
     C                     END                             *FI
      * ** Scheduled Ship Date must be a valid date           E000589
      * CASE: DTL.Scheduled Ship Date is entered
     C           #1AODT    IFNE *ZERO                      *IF
      * ** Validate Scheduled Ship Date. If error, user cannot change
      * ** unless Requested Ship or Delivery dates are unlocked.    E0005
      * VAL Calendar           XF - Calendar  * 
     C                     CLEARPERC
     C                     Z-ADD#1AIC3    PEAIC3           Company Number
     C                     Z-ADD#1AODT    PEBCDT           Post to G_L Dat
      *
     C                     CALL 'PNO5XFR'              90  VAL Calendar
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Calendar M
     C           WUH3TX    PARM *BLANK    WQ0185  7        Return Code Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Validate SSD                                          E000589
      * CASE: WRK.Return Code Usr is Calendar not found
     C           WUH3TX    IFEQ @CN,015                    *IF
     C                     Z-ADD#DHODT    #1AODT           Scheduled Ship
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
      * ** Check Must Ship Date in order if Whse, SSD, or RSD changed
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      *        don't edit dates for buyers truck orders/loads
     C                     ELSE
      * CASE: Whse, SSD, RDD/RDT, RSD changed
      *  - c1 OR c2 OR c5 OR c6 OR c7
      *   |- c1    : DTL.Warehouse Code NE DTL.USR Warehouse Code
      *   |- c2    : DTL.Scheduled Ship Date NE DTL.Scheduled Ship Date U
      *   |- c5    : DTL.Requested Delivery Date NE WRK.Requested Deliver
      *   |- c6    : DTL.Requested Delivery Time NE DTL.USR Time 4.0
      *   |- c7    : DTL.Requested Ship Date NE DTL.USR Requested ship da
      *   '-
     C           #DAJCD    IFNE #DCPCD                     *IF
     C           #1AODT    ORNE #DHODT                     *OR
     C           #1EIDT    ORNE WUAYDZ                     *OR
     C           #1AFTM    ORNE #DT4TM                     *OR
     C           #1A5DT    ORNE #DCZDT                     *OR
      * ** Must Ship Date will be zeros and error if no Miles Between Cit
      * E01523 RMC 5/02/11 use req delv date and time always for ddt calc
     C                     Z-ADD#1EIDT    WUBQDT           USR Date - ATR
     C                     Z-ADD#1AFTM    WUHLNX           USR To Time 4.0
      * CLC Must Ship 4 Req DlvXF - Order Header TRG  * 
     C                     CALL 'PMUSXFR'              90  CLC Must Ship 4
     C                     PARM *BLANK    W0RTN   7
     C           WUB7SX    PARM *BLANK    WQ0186  3        Must Ship Error
     C                     PARM #1C4NB    WQ0187  70       Order Number
     C                     PARM #1A5DT    WQ0188  70       Requested Ship
     C                     PARM #1HNNA    WQ0189 20        Ship To City
     C                     PARM #1DBCD    WQ0190  2        Ship To State C
     C                     PARM #1AIC3    WQ0191  30       Company Number
     C                     PARM WUHLNX    WQ0192  40       Requested Deliv
     C                     PARM #1AODT    WQ0193  70       Scheduled Ship
     C                     PARM WUBQDT    WQ0194  70       Requested Deliv
     C           #DAJCD    PARM #DAJCD    WQ0195  3        Warehouse Code
     C           YL0030    PARM YL0030    WQ0196  70       Must Ship Date
     C           YL0031    PARM YL0031    WQ0197  60       Must Ship Time
     C                     PARM WUMPNB    WQ0198  70       USR Order Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMUSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,35           *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * flag to notify TRAFFIC if no Mileage Between Cities rec    E00162
      * CASE: WRK.Must Ship Error is Miles to Next=Zeros
     C           WUB7SX    IFEQ 'MTN'                      *IF
      * RMC Dont trigger an error msg!    2-06-2017
     C                     MOVEL*BLANK    WUB7SX           Must Ship Error
     C                     END                             *FI
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0199  30       Company Number
     C                     PARM *BLANK    WQ0200  1        Plant Company S
     C           P3YJSX    PARM *BLANK    WQ0201  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Process date order error for must ship
      * CASE:
      *  - c1 OR c2 OR (c4 AND c3)
      *   |- c1    : WRK.Must Ship Error is No Error
      *   |- c2    : PAR.Company Organization is Not Seaboard
      *   |- c4    : DTL.Country Code is Entered
      *   |- c3    : DTL.Country Code is Not USA
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB7SX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P3YJSX    IFEQ 'D'                        *IF
     C           P3YJSX    OREQ 'H'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #DKXCD    IFNE *BLANK                     *IF
     C           #DKXCD    IFNE 'USA'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *                do nothing
      *     if Dailys or High Plains Diesel or international account
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Load ID EQ WRK.ZERO
     C           #1RMNB    IFEQ WUW0NB                     *IF
      * ** Scheduled Ship Date must be a valid date           E000589
      * CASE: DTL.Scheduled Ship Date is entered
     C           #1AODT    IFNE *ZERO                      *IF
      * ** Validate Scheduled Ship Date. If error, user cannot change
      * ** unless Requested Ship or Delivery dates are unlocked.    E0005
      * VAL Calendar           XF - Calendar  * 
     C                     CLEARPERC
     C                     Z-ADD#1AIC3    PEAIC3           Company Number
     C                     Z-ADD#1AODT    PEBCDT           Post to G_L Dat
      *
     C                     CALL 'PNO5XFR'              90  VAL Calendar
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Calendar M
     C           WUH3TX    PARM *BLANK    WQ0202  7        Return Code Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Validate SSD                                          E000589
      * CASE: WRK.Return Code Usr is Calendar not found
     C           WUH3TX    IFEQ @CN,015                    *IF
     C                     Z-ADD#DHODT    #1AODT           Scheduled Ship
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
      * ** Don't prompt with an error message if *ADD mode    E00447
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * PMT Must Ship Dt Accpt IF - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1EIDT    WL0073           Requested Deliv
     C                     Z-ADD#1AFTM    WL0074           Requested Deliv
     C                     Z-ADDYL0030    WL0075           Must Ship Date
     C                     Z-ADDYL0031    WL0076           Must Ship Time
     C                     Z-ADD#1A5DT    WL0077           Requested Ship
     C                     MOVELP7ATUS    WL0078    P      STATUS
     C                     Z-ADD#1AODT    WL0079           Scheduled Ship
     C                     MOVELWUB7SX    WL0080    P      Must Ship Error
     C                     Z-ADD#1C4NB    WL0081           Order Number
     C                     EXSR TOINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0078    P7ATUS    P      STATUS
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If not yet assigned to a load, unlock so the date can be chang
      * PMT Must Ship Dt Accpt IF - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1EIDT    WL0073           Requested Deliv
     C                     Z-ADD#1AFTM    WL0074           Requested Deliv
     C                     Z-ADDYL0030    WL0075           Must Ship Date
     C                     Z-ADDYL0031    WL0076           Must Ship Time
     C                     Z-ADD#1A5DT    WL0077           Requested Ship
     C                     MOVELP7ATUS    WL0078    P      STATUS
     C                     Z-ADD#1AODT    WL0079           Scheduled Ship
     C                     MOVELWUB7SX    WL0080    P      Must Ship Error
     C                     Z-ADD#1C4NB    WL0081           Order Number
     C                     EXSR TOINFN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0078    P7ATUS    P      STATUS
     C                     END                             *FI
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Error if assigned to a load and has an invalid date
      * ** Unlock the date field so it can be changed       E00147 LJB 4/
      * RTV Stop Number       RT - Load Detail          TRG  * 
     C                     EXSR TPRVGN
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADDWURVNB    PDRVNB           Stop_Drop
     C                     MOVEL'DEADLN'  PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVEL*BLANK    PDMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * NOTE:  Will only write log if order on load and load not in E sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Delivery Date cannot be before Requested Ship Date      S00346
      * CASE: DTL.Requested Delivery Date LT DTL.Requested Ship Date
     C           #1EIDT    IFLT #1A5DT                     *IF
      * ** Do not allow the Delivery date to be before the Ship Date. Unl
      * ** the field if there is an error so it can be corrected.   FP125
      * Setup message data for message
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0033
      * Send message 'Req Deliv dt before ship'
     C                     MOVEL'USR3963' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,35           *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
      * ** For Seaboard only, validate Deadline Depart Date/Time   W288
      * CASE: PAR.Company Organization is Seaboard
     C           P3YJSX    IFEQ 'S'                        *IF
      * ** Retrieve the hours that Shipping is restricted from loading
      * ** (this is maintained by scheduling)                 W288
      * RTV Dock Unavail Range XF - Warehouse Control  * 
     C                     CALL 'PNNIXFR'              90  RTV Dock Unavai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DAJCD    WQ0211  3        Warehouse Code
     C           WUDPTM    PARM *ZERO     WQ0212  60       Dock Unavail St
     C           WUDQTM    PARM *ZERO     WQ0213  60       Dock Unavail En
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNNIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * ** Validate if hours are entered for a warehouse
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      *       skip - not an error if no record
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Dock Unavail Start Time is Zeros
      *   |- c2    : WRK.Dock Unavail End Time is Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDPTM    IFEQ *ZERO                      *IF
     C           WUDQTM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *       skip - not an error if times are zeros
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If RSD = DDD then enforce Restricted Time Range    W288
      * CASE: DTL.Requested Ship Date EQ DTL.Deadline Depart Date
     C           #1A5DT    IFEQ #DA0DZ                     *IF
      * ** Warning if DDT is during restriced hours             W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Deadline Depart Time LH GE WRK.Dock Unavail Star
      *   |- c2    : DTL.Deadline Depart Time LH LE WRK.Dock Unavail End
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DBUTM    IFGE WUDPTM                     *IF
     C           #DBUTM    IFLE WUDQTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWUO3TX    #DO3TX           Explaination 50
     C                     MOVEL'Y'       P6AKTX           Status Flag 7
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Warning if date changes put DDD/T in the past. Truck will not
      * ** time to load and leave. Send a warning message and unlock the
      * ** dates so they can be changed.                      W288
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0214 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0215 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Warning if DDD = Today & DDT is before system time   W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Deadline Depart Date EQ WRK.Current System Date
      *   |- c2    : DTL.Deadline Depart Time LH LE WRK.Current System Ti
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DA0DZ    IFEQ WUSDTE                     *IF
     C           #DBUTM    IFLE WUZHNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWUEFT1    #DO3TX           Explaination 50
     C                     MOVEL'Y'       P6AKTX           Status Flag 7
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
      * Validate warehouse code     / hpb ship to whse
      * CASE: DTL.Warehouse Code EQ WRK.BLANK
     C           #DAJCD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0034           Warehouse Code
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0082    P      Warehouse Code
     C                     EXSR TQRVGN
      * Error if warehouse not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0035           Warehouse Code
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Acct&Ship Co      RT - Warehouse  * 
     C                     EXSR TRRVGN
      * CASE: DTL.Billing Activity Type is Warehouse Transfer
     C           #1OBST    IFEQ '4'                        *IF
      * Screen warehouse (from) = warehouse in co/cust file (to)
      * CASE: DTL.Warehouse Code EQ WRK.USR Warehouse Code
     C           #DAJCD    IFEQ WUCPCD                     *IF
      * Setup message data for message
      * Send message 'Warehouse must differ tr.'
     C                     MOVEL'USR0433' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     END                             *FI
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR TSRVGN
      * Val Acctg Co on from whse on screen must = acctg Co on to whse on
      * CASE: WRK.Accounting Company NE WRK.Company Number Select
     C           WUBTC3    IFNE WUAOC3                     *IF
      * This validation added 08/01/07 RMC
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0036           Warehouse Code
     C                     MOVELWUCPCD    ZA0037           USR Warehouse C
      * Send message 'Warehouse fr/to comp err'
     C                     MOVEL'USR3772' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     END                             *FI
      * CASE: WRK.Shipping Company NE DTL.Company Number
     C           WUBWC3    IFNE #1AIC3                     *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0038           Warehouse Code
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0039           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0039           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Warehouse cant ship f/co'
     C                     MOVEL'USR3362' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     END                             *FI
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P3YJSX    IFEQ 'H'                        *IF
      * HPB Ship to whse - both must be external whses
      * CASE: DTL.HPB Ship to Warehouse is not entered
     C           #1FXSX    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FXSX    ZA0040           HPB Ship to War
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,53           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1FXSX    WL0082    P      Warehouse Code
     C                     EXSR TQRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     MOVEL#1FXSX    ZA0041           HPB Ship to War
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,53           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Warehouse Location RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DAJCD    WL0083    P      Warehouse Code
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    WUT0ST    P      Warehouse Locat
      * CASE: WRK.Warehouse Location is Internal (Plant)
     C           WUT0ST    IFEQ 'I'                        *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0042           Warehouse Code
      * Send message 'Warehouse must be ext'
     C                     MOVEL'USR4207' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     END                             *FI
      * RTV Warehouse Location RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1FXSX    WL0083    P      Warehouse Code
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    WUT0ST    P      Warehouse Locat
      * CASE: WRK.Warehouse Location is Internal (Plant)
     C           WUT0ST    IFEQ 'I'                        *IF
      * Setup message data for message
     C                     MOVEL#1FXSX    ZA0043           HPB Ship to War
      * Send message 'Warehouse must be ext'
     C                     MOVEL'USR4207' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,53           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * HPB Ship to whse - cant xfr from BL to not BL.   1/17.20
      * CASE: DTL.HPB Ship to Warehouse is not entered
     C           #1FXSX    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1FXSX    WL0062    P      Warehouse Code
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    YL0032    P      Warehouse Type
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Warehouse Type is Blended
      *   |- c2    : LCL.Warehouse Type is Fresh or Frozen
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUWPST    IFEQ 'BL'                       *IF
     C           YL0032    IFEQ 'FR'                       *IF
     C           YL0032    OREQ 'FZ'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Send message 'Warehouse type mismatch'
     C                     MOVEL'USR5162' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,53           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * PKTR01 Validate Whse with Shipping Co               7/27/04
      * CASE: WRK.Shipping Company NE DTL.Company Number
     C           WUBWC3    IFNE #1AIC3                     *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0044           Warehouse Code
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0045           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0045           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Warehouse cant ship f/co'
     C                     MOVEL'USR3362' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     END                             *FI
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P3YJSX    IFEQ 'H'                        *IF
      * HPB Only - FP1322 if ship co <> acctng co, then ship to whse is r
      * CASE: WRK.Shipping Company NE WRK.Accounting Company
     C           WUBWC3    IFNE WUBTC3                     *IF
      * Prevent shipping from hp1/hp2 directly to musket
      * CASE: WRK.Type Code is Marketing
     C           WUBOCD    IFEQ 'MK'                       *IF
      * hpb biodiesel cust will be a MK type
      * HPB Ship to whse
      * CASE: DTL.HPB Ship to Warehouse is not entered
     C           #1FXSX    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1FXSX    ZA0046           HPB Ship to War
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,53           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1FXSX    WL0082    P      Warehouse Code
     C                     EXSR TQRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     MOVEL#1FXSX    ZA0047           HPB Ship to War
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,53           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Warehouse Location RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1FXSX    WL0083    P      Warehouse Code
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    WUT0ST    P      Warehouse Locat
      * CASE: WRK.Warehouse Location is Internal (Plant)
     C           WUT0ST    IFEQ 'I'                        *IF
      * Setup message data for message
     C                     MOVEL#1FXSX    ZA0048           HPB Ship to War
      * Send message 'Warehouse must be ext'
     C                     MOVEL'USR4207' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,53           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0049           Warehouse Code
      * Send message 'Market cust req f/whs loc'
     C                     MOVEL'USR4246' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #1FXSX           HPB Ship to War
      * CASE: WRK.Type Code is Marketing
     C           WUBOCD    IFEQ 'MK'                       *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0050           Warehouse Code
      * Send message 'Market cust/whse not val'
     C                     MOVEL'USR4247' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv HPB Cust Fields   XF - Company Customer EXT  * 
     C                     CALL 'PNY1XFR'              90  Rtv HPB Cust Fi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0216  30       Company Number
     C                     PARM #1B0C7    WQ0217  70       Ship To Custome
     C           YL0033    PARM *BLANK    WQ0218 20        HPB Employer ID
     C           YL0034    PARM *BLANK    WQ0219  4        HPB ULSD Compan
     C           YL0035    PARM *BLANK    WQ0220  5        HPB ULSD Facili
     C           YL0036    PARM *BLANK    WQ0221  2        Type Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNY1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E01692 RMC dont allow biodiesel sale if ULSD# is blank
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.HPB ULSD Company # is Not Entered
      *   |- c2    : DTL.Type Code is Not NR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0034    IFEQ *BLANK                     *IF
     C           #DBOCD    IFNE 'NR'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 9/30/11 use dtl.type code alieu lcl.type code
      * Rtv HPB fields        RT - Warehouse  * 
     C                     EXSR TURVGN
      * see if its a biodiesel whse
      * CASE: LCL.WHS Req Meter Reading Shp is Yes
     C           YL0037    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1B0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0051           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0051           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Inv Cust for hpb sale'
     C                     MOVEL'USR4454' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Warehouse Access
      * CASE: DTL.Warehouse Code is Not Blanks
     C           #DAJCD    IFNE *BLANK                     *IF
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0222 10        User Profile Na
     C                     PARM 'O/P'     WQ0223  6        Application Cod
     C                     PARM #DAJCD    WQ0224  3        Warehouse Code
     C                     PARM *ZERO     WQ0225  70       Item Code
     C           YL0038    PARM *BLANK    WQ0226  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * CASE: LCL.Warehouse Access Sts USR is Access Denied
     C           YL0038    IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0052           *USER
     C                     MOVEL#DAJCD    ZA0053           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * R7574  RMC 10/18/16 Cant chg warehouse to a diff type if OD Exist
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : DTL.Warehouse Code NE DTL.USR Warehouse Code
      *   |- c2    : PAR.Company Organization is Seaboard
      *   |- c3    : PGM.*Program mode is *CHANGE
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DAJCD    IFNE #DCPCD                     *IF
     C           P3YJSX    IFEQ 'S'                        *IF
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Whse Type-2 whses  XF - Warehouse  * 
     C                     CALL 'PBQAXFR'              90  RTV Whse Type-2
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DAJCD    WQ0227  3        Warehouse Code
     C           YL0032    PARM *BLANK    WQ0228  2        Warehouse Type
     C                     PARM #DCPCD    WQ0229  3        USR Warehouse C
     C           YL0039    PARM *BLANK    WQ0230  2        Warehouse Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBQAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * CASE: LCL.Warehouse Type NE LCL.Warehouse Type USR
     C           YL0032    IFNE YL0039                     *IF
      * RTV Chk Detail Exists  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0085           Company Number
     C                     Z-ADD#1C4NB    WL0086           Order Number
     C                     EXSR TVRVGN
      * Msg 'Order has line items' R7574  JJH 10/19/16
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,014                    *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0054           Warehouse Code
      * Send message 'Order has line itms,cant'
     C                     MOVEL'USR4777' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate P.O requirement
      * CASE: P.O. Required, not entered
      *  - c1 AND c2
      *   |- c1    : WRK.P.O. Required Flag is yes
      *   |- c2    : DTL.Customer Purchase Order # EQ WRK.BLANK
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUPPST    IFEQ 'Y'                        *IF
     C           #1BCNA    IFEQ WUGSTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.Block Order Flag is Firm Order
     C           #1BCST    IFEQ 'F'                        *IF
      * Setup message data for message
     C                     MOVEL#1BCNA    ZA0055           Customer Purcha
      * Send message 'P.O. Required'
     C                     MOVEL'USR1243' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,36           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate absorbed freight rate
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.Shipping Method is Buyers Truck
      *   |- c2    : DTL.Shipping Method is Collect Rail
      *   '-
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
     C           #1Q2CD    OREQ 'CR'                       *OR
      * R12926 DN 05/04/18-Added c2-'Shipping Method is Collect Rail' to
      *   be consistent with PDSVE1R program.
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Absorbed Freight Rate is EQ Zeros
     C           #1TBNB    IFEQ *ZERO                      *IF
      * R12926 DN 05/04/18-If AFR is 0 must get it from Co Cust. Leave as
      * RTV Abs Freight Rate   RT - Company/Customer  * 
     C                     EXSR TWRVGN
     C                     END                             *FI
     C                     END                             *FI
      * Determine Carrier - If ship method is collect then carrier must b
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      * ** Change carrier to BUY if collect   FT686 LJB 01/03/2008
     C                     MOVEL'BUY'     #1BZNA           Carrier Code
     C                     END                             *FI
      * ** If Collect Truck or Rail then default carrier to "BUY"
      * CASE: PAR.Shipping Method is Collect
     C           P1Q2CD    IFEQ 'CR'                       *IF
     C           P1Q2CD    OREQ 'CT'
      * CASE: DTL.Shipping Method is Collect
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      * ** 11/16/2007 LJB FP1251 Carrier must be BUY if ship meth = colle
     C                     MOVEL'BUY'     #1BZNA           Carrier Code
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If Ship Method changed from Collect to Prepaid
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
      * ** If changed from Collect to Prepaid, blank out the carrier code
      * CASE: PAR.Shipping Method is Collect
     C           P1Q2CD    IFEQ 'CR'                       *IF
     C           P1Q2CD    OREQ 'CT'
      * CASE: DTL.Shipping Method is Prepaid
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'
      * ** If Ship Method changed from Collect to Prepaid   E00127 LJB 04
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
      * Edit for Transfer In Storage
      * CASE: DTL.Transfer in Storage Ind is Yes
     C           #1FNSX    IFEQ 'Y'                        *IF
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1Q2CD    ZA0056           Shipping Method
      * Send message 'Transfer In Storage must'
     C                     MOVEL'USR2866' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,37           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Company Organization is Not HPB
     C           P3YJSX    IFEQ 'D'                        *IF
     C           P3YJSX    OREQ 'S'
      * CASE:
      *  - c1ORc2
      *   |- c1    : DTL.Reefer Temperature is GE 100
      *   |- c2    : DTL.Reefer Temperature is LE 100-
      *   '-
     C           #1RNNB    IFGE 100                        *IF
     C           #1RNNB    ORLE -100                       *OR
      * Setup message data for message
     C                     Z-ADD#1RNNB    ZA0057           Reefer Temperat
      * Send message 'Temperature must be <100'
     C                     MOVEL'USR4960' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,49           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Export Status
      * CASE: PAR.Export Status is yes
     C           P1U2ST    IFEQ 'Y'                        *IF
      * CASE: DTL.Export Status is no
     C           #1U2ST    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    #DKXCD           Country Code
     C                     END                             *FI
     C                     END                             *FI
      * Export Docs Go w/Driver
      * CASE: DTL.Export Status is no
     C           #1U2ST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       #1FQSX           Export Docs Go
     C                     END                             *FI
      * W77844 DN 06/11/21-Convert Old Spot Buy Flag Value to New Val: S,
      * ** Spot buy = y or n, blank = err   W77844 DN 06/11/21-New Spot B
      * CASE: DTL.Spot Buy  (Y/N) is Spot
     C           #DSPOT    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL'S'       #DC3TX           OHE Spot Buy
      * DTL.Spot Buy Text USR = Condition name of DTL.OHE Spot Buy
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1279264   Y2LSNO  70       List number
     C                     PARM #DC3TX    W0INVL 25        OHE Spot Buy
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: DTL.Spot Buy  (Y/N) is Turn
     C           #DSPOT    IFEQ 'T'                        *IF
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL'T'       #DC3TX           OHE Spot Buy
      * DTL.Spot Buy Text USR = Condition name of DTL.OHE Spot Buy
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1279264   Y2LSNO  70       List number
     C                     PARM #DC3TX    W0INVL 25        OHE Spot Buy
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: DTL.Spot Buy  (Y/N) is Promo
     C           #DSPOT    IFEQ 'P'                        *IF
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL'P'       #DC3TX           OHE Spot Buy
      * DTL.Spot Buy Text USR = Condition name of DTL.OHE Spot Buy
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1279264   Y2LSNO  70       List number
     C                     PARM #DC3TX    W0INVL 25        OHE Spot Buy
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * E3323 now required
      * CASE: PAR.Company Organization is Seaboard
     C           P3YJSX    IFEQ 'S'                        *IF
      * Setup message data for message
     C                     MOVEL#DSPOT    ZA0058           Spot Buy  (Y/N)
      * Send message 'Spot Buy S/T/P Required'
     C                     MOVEL'USR4747' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,52           *
      *
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL*BLANK    #DQIU1           Spot Buy Text U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL'T'       #DC3TX           OHE Spot Buy
      * DTL.Spot Buy Text USR = Condition name of DTL.OHE Spot Buy
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1279264   Y2LSNO  70       List number
     C                     PARM #DC3TX    W0INVL 25        OHE Spot Buy
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Errors exist in Ord Detail if "Order Requires Review" = "Y"
      * CASE: DTL.Order Requires Review is Yes
     C           #1FUSX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       P6DFTX           Status Flag 9
     C                     MOVELWUHFTX    #DHFTX           Explaination Te
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P6DFTX           Status Flag 9
     C                     END                             *FI
      * Set Country Code and Export flg for Blank International State
      * CASE:
      *  - c1 AND c2 AND c3 AND NOTc4 AND c5 AND c6
      *   |- c1    : DTL.Shipping Method is Prepaid
      *   |- c2    : DTL.Country Code is Blank
      *   |- c3    : DTL.Export Status is no
      *   |- c4    : DTL.Ship To Zip_Postal Code is Blank
      *   |- c5    : DTL.Order Type_Sales is Regular Order
      *   |- c6    : DTL.Ship To State Code is International Accounts
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'
     C           #DKXCD    IFEQ *BLANK                     *IF
     C           #1U2ST    IFEQ 'N'                        *IF
     C           #1CKTX    IFEQ *BLANK                     *IF
     C                     ELSE
     C           #1JNCD    IFEQ 'OR'                       *IF
     C           #1DBCD    IFEQ '.'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4 AND c5)
      *   |- c1    : DTL.Country Code 1 usr is Not Entered
      *   |- c2    : DTL.Ship to Customer      USR is Not entered
      *   |- c3    : DTL.Country Code 1 usr is Entered
      *   |- c4    : DTL.Ship to Customer      USR is Entered
      *   |- c5    : DTL.Ship To Customer NE DTL.Ship to Customer      US
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DKIAA    IFEQ *BLANK                     *IF
     C           #DD0C7    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #DKIAA    IFNE *BLANK                     *IF
     C           #DD0C7    IFNE 0                          *IF
     C           #1BKC7    IFNE #DD0C7                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL#1CKTX    YL0040           Text USR 5
      * EUP Chk Numeric value - /UT User Programs  * 
     C                     CALL 'PVD8UPR'              90  EUP Chk Numeric
     C                     PARM YL0040    WQ0231 50        Text Usr 50
     C           YL0041    PARM *BLANK    WQ0232  1        Validation Pass
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVD8UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Proceed if Zipcode is not Numeric
      * CASE: LCL.Numeric Zip Code USR? is No
     C           YL0041    IFEQ 'N'                        *IF
      * RTV All fields         RT - Customer  * 
     C                     EXSR TXRVGN
      * CASE: DTL.Country Code 1 usr is Entered
     C           #DKIAA    IFNE *BLANK                     *IF
     C                     MOVEL#DKIAA    #DKXCD           Country Code
     C                     MOVEL'Y'       #1U2ST           Export Status
     C                     Z-ADD#1BKC7    #DD0C7           Ship to Custome
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Order Types
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,38
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer Master
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,31
     C                     SETON                     99    *
     C                     END
      * Check reference to State Master
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer Master
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to State Master
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     MOVEL'1'       @I1,48
     C                     SETON                     9931  *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     MOVEL'1'       @I1,35
     C                     SETON                     9931  *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to Terms Master
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to Carrier Info
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to OP Reason Codes
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     MOVEL'1'       @I1,33
     C                     SETON                     9931  *
     C                     END
      * Check reference to Enterprise Master
     C                     EXSR VQCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to Load Header
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Sales Route
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Manager Level
     C                     EXSR VTCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to VP Level Master
     C                     EXSR VUCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Order Header TRG
     C                     EXSR VVCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to Internal Reason
     C                     EXSR VWCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VXCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to Event Types
     C                     EXSR VYCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to AR Claim Header
     C                     EXSR VZCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,46
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
      * 04/13/09 PKD E00329 Re-Org screen with new fields.
      * RTV Order Type Desc.   RT - Order Types  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1JNCD    WL0001    P      Order Type_Sale
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DJVNA    P      Order Type Desc
     C                     MOVEL*BLANK    #DS7NA           Shipping Method
      * Shipping Method Desc DRV
      * PAR.Shipping Method Desc DRV = Condition name of PAR.Shipping Met
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #1Q2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DS7NA    PARM           W0CNNM 25        Shipping Method
      *
      * RTV Desc, Status       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKXCD    WL0003    P      Country Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DDATX    P      Country Descrip
     C                     MOVELWL0005    YN0001    P      Record Status
      * ** Retrieve description for "Intended for Export" country E00157
      * RTV Desc, Status       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DLWAA    WL0003    P      Country Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DD6T1    P      Country Descrip
     C                     MOVELWL0005    YN0001    P      Record Status
      * Block Order Flag Description
      * CASE: DTL.Block Order Flag is Firm Order
     C           #1BCST    IFEQ 'F'                        *IF
     C                     MOVEL@CN,001   #DVLT1           Block Order Fla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,002   #DVLT1           Block Order Fla
     C                     END                             *FI
      * CLC Deadln Depart Dt  XF - Order Header TRG  * 
     C                     CALL 'POSCXFR'              90  CLC Deadln Depa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0257  30       Company Number
     C                     PARM #1C4NB    WQ0258  70       Order Number
     C                     PARM #1HNNA    WQ0259 20        City
     C                     PARM #1DBCD    WQ0260  2        State Code
     C                     PARM #1EIDT    WQ0261  70       Requested Deliv
     C                     PARM #1AFTM    WQ0262  40       Requested Deliv
     C           #DA0DZ    PARM *ZERO     WQ0263  70       Deadline Depart
     C           #DBUTM    PARM *ZERO     WQ0264  60       Deadline Depart
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POSCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
     C                     MOVEL'1'       @I1,34           *
     C                     END
      * ** Seaboard only, if no DDD/T, check for Mileage Betw Cities  E16
      * CASE: PAR.Company Organization is Seaboard
     C           P3YJSX    IFEQ 'S'                        *IF
      * Only check Mileage Betw Cities if no DDDate           E001625
      * CASE: DTL.Deadline Depart Date is not entered
     C           #DA0DZ    IFEQ *ZERO                      *IF
      * ** Validate "From" city/state
      * VAL MBC Exists-From CtyXF - Mileage Between Cities  * 
     C                     CALL 'PNX3XFR'              90  VAL MBC Exists-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HNNA    WQ0265 20        From City
     C                     PARM #1DBCD    WQ0266  2        From State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNX3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     END                             *FI
      * CASE: DTL.Warehouse Code is Not Blanks
     C           #DAJCD    IFNE *BLANK                     *IF
      * ** Validate "To" city/state
      * RTV Warehouse Address  RT - Warehouse  * 
     C                     EXSR TYRVGN
      * Val Mileage Existance  XF - Mileage Between Cities  * 
     C                     CLEARPARC
     C                     MOVELYL0001    PAXGCD    P      To City
     C                     MOVELYL0002    PAXHCD    P      To State State
      *
     C                     CALL 'PNX4XFR'              90  Val Mileage Exi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Mileage Be
     C           WUWXST    PARM *BLANK    WQ0267  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNX4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * Change mode processing
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * Validate item balances exist if change warehouse
      * CASE: DTL.Warehouse Code NE DTL.USR Warehouse Code
     C           #DAJCD    IFNE #DCPCD                     *IF
      * VAL Itm Bals-Whs Chg   XF - OP Order Header  * 
     C                     CALL 'PDG3XFR'              90  VAL Itm Bals-Wh
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0268  30       Company Number
     C                     PARM #1C4NB    WQ0269  70       Order Number
     C                     PARM #DAJCD    WQ0270  3        Warehouse Code
     C           WUECST    PARM *BLANK    WQ0271  1        Error Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0059           Warehouse Code
      * Send message 'IC Item Balance Not Fnd E'
     C                     MOVEL'USR2261' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** If changed from Collect to Prepaid, blank out the carrier code
      * CASE: PAR.Shipping Method is Collect
     C           P1Q2CD    IFEQ 'CR'                       *IF
     C           P1Q2CD    OREQ 'CT'
      * CASE: DTL.Shipping Method is Prepaid
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'
      * ** If Ship Method changed from Collect to Prepaid   E00127 LJB 04
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
      * F16=Load Planning    E4119 RMC 5/23/2016 Remove Live with tpm che
      * CASE: DTL.*CMD key is *Work With Loads
     C           *IN16     IFEQ '1'                        *IF
      * RTV Chk Detail Exists  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0085           Company Number
     C                     Z-ADD#1C4NB    WL0086           Order Number
     C                     EXSR TVRVGN
      * Msg 'Order has no line items' E00180 RMC 7/08/08
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Send message 'Order has no line items!'
     C                     MOVEL'USR3962' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * call load plan pgm in command key section
     C                     END                             *FI
      * TMS checks
      * CASE: PAR.PFS Carlisle Active is Yes
     C           P8WUSX    IFEQ 'Y'                        *IF
      * CASE:
      *  - (c1ANDc2)
      *   |- c1    : LCL.PFS AccuSort Active is Yes
      *   |- c2    : DTL.Type Code is Export Seaboard Bookings
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0044    IFEQ 'Y'                        *IF
     C           #DBOCD    IFEQ 'ES'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * only ES Stay on the as400 when live with TMS domestic only
     C                     ELSE
      * CASE: *OTHERWISE
      * If TMS Is live with Domestic only, allow Export load ties
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Load Plan Order is no
     C           #1U4ST    IFEQ 'N'                        *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 10/16/08 PKD Added to default Y for Docs go with Driver if
      *              export and air frieght.
      * R13074 DN 06/15/18-Changed Validation to Set Export Docs Go w/Dri
      * export & air frt
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : DTL.Export Status is yes
      *   |- c2    : DTL.Air Freight Order is yes
      *   |- c3    : DTL.Country Code is Mexico
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1FTSX    IFEQ 'Y'                        *IF
     C           #DKXCD    OREQ 'MEX'                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       #1FQSX           Export Docs Go
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0009           Letter of Credi
     C                     MOVEL#DAKU1    YL0009           Letter of Credi
     C                     END
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * USR Company Number required
     C           #DFKNB    IFEQ *ZERO                      IF
     C           *IN78     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,32
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Requested Delivery Date required
     C           #1EIDT    IFEQ *ZERO                      IF
     C           *IN77     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,33
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Requested Delivery Time required
     C           #1AFTM    IFEQ *ZERO                      IF
     C           *IN77     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,34
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Requested Ship Date required
     C           #1A5DT    IFEQ *ZERO                      IF
     C           *IN77     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,35
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Shipping Method required
     C           #1Q2CD    IFEQ *BLANK                     IF
     C           *IN74     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,37
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Type_Sales required
     C           #1JNCD    IFEQ *BLANK                     IF
     C           *IN79     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,38
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * LTL Flag required
     C           #1PJST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,40
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Block Order Flag required
     C           #1BCST    IFEQ *BLANK                     IF
     C           *IN73     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,41
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Salesperson Code required
     C           #DBCCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,44
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Transfer in Storage Ind required
     C           #1FNSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,47
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Date required
     C           #1A0DT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,48
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Shipping Temp Code C_F required
     C           #1FRSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,50
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Export Status required
     C           #1U2ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,56
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Certification Flag required
     C           #1BDST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,62
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Export Docs Go w_Driver required
     C           #1FQSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,63
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * Increment # Orders YTD on Add - Create Events record
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     EXSR TZCRRC
     C                     END                             *FI
      * Dealloc/Allocate details and Load/Order Change Log if whse change
      * CASE: Warehouse change
      *  - c3 AND c1
      *   |- c3    : PGM.*Program mode is *CHANGE
      *   |- c1    : DTL.Warehouse Code NE DTL.USR Warehouse Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0PMD     IFEQ 'CHG'                      *IF
     C           #DAJCD    IFNE #DCPCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Perform Dellocate/Allocate using the original Requested Ship Date
      * Routine for Requested Ship Date will handle the date change.
      * UPD Dealloc/Allocate   XF - Order Header TRG  * 
     C                     CALL 'PDPJXFR'              90  UPD Dealloc/All
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0272  30       Company Number
     C                     PARM #1C4NB    WQ0273  70       Order Number
     C                     PARM *ZERO     WQ0274  30       Order Sequence
     C                     PARM *ZERO     WQ0275  30       Order Secondary
     C                     PARM #DAJCD    WQ0276  3        Warehouse Code
     C                     PARM #DCZDT    WQ0277  70       Deallocate Date
     C                     PARM #DCZDT    WQ0278  70       Allocate Date U
     C           WUG0TX    PARM WUG0TX    WQ0279  1        Production Hold
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
     C                     MOVEL'CHGWHS'  WURVST           Load Change Typ
      * ** Reverse FP1061 - Department control code MUST be Traffic
      * ** Do not change this per Gary Martin.     E-TRANS47 LJB 01/03/20
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVEL#DCPCD    PDMNTX    P      Change Log Prio
     C                     MOVEL#DAJCD    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * NOTE:  Will only write log if order on load and load not in E sta
     C                     MOVEL#DAJCD    #DCPCD           USR Warehouse C
     C                     END                             *FI
      * Reallocate if Requested Ship date/ or req delivery date changes (
      * CASE:
      *  - c1ORc2
      *   |- c1    : DTL.Requested Ship Date NE DTL.USR Requested ship da
      *   |- c2    : DTL.Requested Delivery Date NE WRK.Requested Deliver
      *   '-
     C           #1A5DT    IFNE #DCZDT                     *IF
     C           #1EIDT    ORNE WUAYDZ                     *OR
      * UPD Dealloc/Allocate   XF - Order Header TRG  * 
     C                     CALL 'PDPJXFR'              90  UPD Dealloc/All
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0280  30       Company Number
     C                     PARM #1C4NB    WQ0281  70       Order Number
     C                     PARM *ZERO     WQ0282  30       Order Sequence
     C                     PARM *ZERO     WQ0283  30       Order Secondary
     C                     PARM #DAJCD    WQ0284  3        Warehouse Code
     C                     PARM #DCZDT    WQ0285  70       Deallocate Date
     C                     PARM #1A5DT    WQ0286  70       Allocate Date U
     C           WUG0TX    PARM WUG0TX    WQ0287  1        Production Hold
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     MOVEL'1'       @I1,35           *
     C                     END
     C                     END                             *FI
      * *********
      * E00180 RMC 8/05/08 moved here so it will be done before F16 Load
      * CLC Tot Ord Val Ship   XF - PD Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0288  30       Company Number
     C                     PARM #1C4NB    WQ0289  70       Order Number
     C           #1JZVA    PARM #1JZVA    WQ0290 112       USR Order Value
     C           #1A1WG    PARM #1A1WG    WQ0291 112       USR Order Weigh
     C           WUG0TX    PARM WUG0TX    WQ0292  1        USR Production
     C           WUG0TX    PARM WUG0TX    WQ0293  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Order Value,Wgt    CH - PD Order Header  * 
     C                     EXSR NACHRC
      * RTV OD Error from Upl XF - Order Detail  * 
     C                     CALL 'PBACXFR'              90  RTV OD Error fr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0294  30       Company Number
     C                     PARM #1C4NB    WQ0295  70       Order Number
     C                     PARM *ZERO     WQ0296  40       Item Age Days
     C           YL0045    PARM *BLANK    WQ0297  3        Order Line Erro
     C           WUU1AS    PARM *BLANK    WQ0298  1        Status Flag 20
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Update error flag if no errors pending in Order Detail P001251
      * CASE: WRK.Status Flag 20 Y/N is No
     C           WUU1AS    IFEQ 'N'                        *IF
      * C2180 7/12/12 RMC do if it was YES, dont change all orders to sts
      * CASE: DTL.Order Requires Review is Yes
     C           #1FUSX    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    #1FUSX           Order Requires
      * CHG Ord Req's Rvw-JCO  CH - Order Header TRG  * 
     C                     EXSR NBCHRC
     C                     END                             *FI
     C                     END                             *FI
      * Update load with order's weight
      * CASE: DTL.Load ID NE WRK.ZERO
     C           #1RMNB    IFNE WUW0NB                     *IF
      * RTV UPD Ld Abs.Frt/Wgt XF - Order Header TRG  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0299  70       Load ID
     C           WURPNB    PARM WURPNB    WQ0300  70       Total Load Orde
     C           WURQNB    PARM WURQNB    WQ0301 112       Total Freight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *********
      * Update details with changed export code;del exp docs 7/06/09
      * CASE: Country code changed
      *  - c1 AND c2
      *   |- c1    : PGM.*Program mode is *CHANGE
      *   |- c2    : DTL.Country Code NE DTL.USR Export Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0PMD     IFEQ 'CHG'                      *IF
     C           #DKXCD    IFNE #DUFCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Export Code        RT - PD Order Detail  * 
     C                     EXSR NCRVGN
      * RMC S00854 07/06/09
      * New - del exp docs if they exist because theyre for the orig coun
      * CASE: DTL.USR Export Code is Entered
     C           #DUFCD    IFNE *BLANK                     *IF
      * Rtv & Dlt for CtryChg XF - Export Doc Order Hdr  * 
     C                     CALL 'PNKJXFR'              90  Rtv & Dlt for C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0302  30       Company Number
     C                     PARM #1C4NB    WQ0303  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Update OHE with changed Intended for Country code    9/09/09 E001
      * CASE: Intended for Export Country code changed
      *  - c1 AND c2
      *   |- c1    : PGM.*Program mode is *CHANGE
      *   |- c2    : DTL.OHE Intended for ExportCC NE DTL.USR Country Cod
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0PMD     IFEQ 'CHG'                      *IF
     C           #DLWAA    IFNE #DZ8CD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * VAL OHE exists for ord XF - Order Header Extension  * 
     C                     CALL 'PNLNXFR'              90  VAL OHE exists
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0304  30       Company Number
     C                     PARM #1C4NB    WQ0305  70       Order Number
     C           WUH3TX    PARM WUH3TX    WQ0306  7        Return Code Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNLNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Return Code Usr is *Record does not exist
     C           WUH3TX    IFEQ @CN,003                    *IF
      * CRT OHE w/no chg       XF - Order Header Extension  * 
     C                     CALL 'PNLLXFR'              90  Zzz OHE w/no ch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0307  30       Company Number
     C                     PARM #1C4NB    WQ0308  70       Order Number
     C                     PARM #1RMNB    WQ0309  70       Load ID
     C                     PARM *ZERO     WQ0310  50       Stop_Drop Seque
     C                     PARM *BLANK    WQ0311  3        Shipping Line
     C                     PARM *BLANK    WQ0312 20        Port Delv Termi
     C                     PARM *BLANK    WQ0313 25        OHE City
     C                     PARM *BLANK    WQ0314 30        OHE Vessel_Airl
     C                     PARM *BLANK    WQ0315 15        OHE Voyage_Flig
     C                     PARM *BLANK    WQ0316 15        OHE Booking Num
     C                     PARM *BLANK    WQ0317 20        OHE Discharge P
     C                     PARM *ZERO     WQ0318  70       OHE Sail_Flight
     C                     PARM *ZERO     WQ0319  70       OHE Port Cut Da
     C                     PARM *ZERO     WQ0320  70       OHE Arrival Dat
     C                     PARM *BLANK    WQ0321  3        OHE Late Delive
     C                     PARM 'O'       WQ0322  1        OHE Ship Status
     C                     PARM *BLANK    WQ0323 12        OHE Container N
     C                     PARM *BLANK    WQ0324 35        OHE Comment 1
     C                     PARM *BLANK    WQ0325 75        OHE Comment 2
     C                     PARM *ZERO     WQ0326 110       OHE Unused Numb
     C                     PARM *ZERO     WQ0327 110       OHE Unused Numb
     C                     PARM *ZERO     WQ0328 110       OHE Unused Numb
     C                     PARM *ZERO     WQ0329 110       OHE Unused Numb
     C                     PARM *ZERO     WQ0330 112       OHE HPB RIN Equ
     C                     PARM *ZERO     WQ0331 112       OHE HPB RIN Pri
     C                     PARM *ZERO     WQ0332 112       Transload Termi
     C                     PARM *ZERO     WQ0333  70       OHE Est Arrv at
     C                     PARM *ZERO     WQ0334  70       OHE Backhaul ET
     C                     PARM *ZERO     WQ0335  70       OHE Port_Pier P
     C                     PARM *ZERO     WQ0336  70       OHE Actual Ship
     C                     PARM YL0046    WQ0337  4        OHE Carrier SCA
     C                     PARM YL0047    WQ0338  4        OHE Spot Buy
     C                     PARM YL0048    WQ0339  4        OHE PO ACK Flag
     C                     PARM #DBOCD    WQ0340  2        OHE Override Ty
     C                     PARM YL0049    WQ0341  2        OHE Backhaul St
     C                     PARM YL0050    WQ0342  2        OHE Backhaul ET
     C                     PARM YL0051    WQ0343  3        OHE Load Haul T
     C                     PARM YL0052    WQ0344  3        OHE Backhaul Ca
     C                     PARM YL0053    WQ0345  3        OHE Bookings Co
     C                     PARM YL0054    WQ0346  5        OHE EDI Error R
     C                     PARM YL0055    WQ0347  5        OHE EDI Error R
     C                     PARM *ZERO     WQ0348  50       HPB COA Batch N
     C                     PARM *BLANK    WQ0349 38        Delivery P_O  N
     C                     PARM #DLWAA    WQ0350  6        OHE Intended fo
     C                     PARM YL0056    WQ0351  6        OHE EDI 943 Act
     C                     PARM YL0057    WQ0352  6        OHE EDI 944 Act
     C                     PARM YL0058    WQ0353  6        OHE EDI 940 Act
     C                     PARM YL0059    WQ0354  6        OHE EDI 945 Act
     C                     PARM YL0055    WQ0355  1        OHE EDI 856 Act
     C                     PARM YL0055    WQ0356  1        OHE EDI 824 Act
     C                     PARM *BLANK    WQ0357 10        OHE Transload S
     C                     PARM *BLANK    WQ0358 10        OHE Abs Rate Ov
     C                     PARM *BLANK    WQ0359 10        OHE Appt Confir
     C                     PARM *BLANK    WQ0360 15        OHE Backhaul Co
     C                     PARM *BLANK    WQ0361 15        OHE Backhaul Ch
     C                     PARM *BLANK    WQ0362 15        OHE Transload C
     C                     PARM *BLANK    WQ0363 30        OHE Pier Pass I
     C                     PARM *BLANK    WQ0364 30        OHE Carrier Nm
     C                     PARM *BLANK    WQ0365 30        OHE Appt Confir
     C                     PARM *BLANK    WQ0366 50        OHE Backhaul Co
     C                     PARM *BLANK    WQ0367 50        Letter of Credi
     C                     PARM *ZERO     WQ0368  30       OHE Backhaul Re
     C                     PARM *ZERO     WQ0369  30       LD Stop_Drop
     C                     PARM *ZERO     WQ0370  30       OHE Unused Numb
     C                     PARM *ZERO     WQ0371  52       OHE Pier Pass F
     C                     PARM *ZERO     WQ0372  52       OHE Port Check
     C                     PARM *ZERO     WQ0373  50       OHE Port Cut Ti
     C                     PARM *ZERO     WQ0374  60       OHE Backhaul Tr
     C                     PARM *ZERO     WQ0375  60       OHE Load Sched
     C                     PARM *ZERO     WQ0376  60       Original Appoin
     C                     PARM *ZERO     WQ0377  60       Original Appoin
     C                     PARM *ZERO     WQ0378  90       OHE PowerPro Lo
     C                     PARM *ZERO     WQ0379  90       OHE PowerPro Lo
     C                     PARM *ZERO     WQ0380  90       OHE Unused Nume
     C                     PARM *ZERO     WQ0381  96       OHE Orig ABS Fr
     C                     PARM YL0055    WQ0382 15        OHE Genset Numb
     C                     PARM YL0055    WQ0383  1        OHE Email BOL_S
     C                     PARM YL0055    WQ0384  1        OHE EDI Order A
     C                     PARM YL0055    WQ0385  2        OHE EDI 601 Act
     C                     PARM YL0055    WQ0386  2        OHE Unused Stat
     C                     PARM YL0055    WQ0387  5        OHE Unused Text
     C                     PARM YL0055    WQ0388  5        OHE Unused Text
     C                     PARM YL0055    WQ0389 15        OHE Customer Ve
     C                     PARM YL0055    WQ0390 15        OHE EDI 824 AES
     C                     PARM YL0055    WQ0391 30        OHE Unused Text
     C                     PARM *ZERO     WQ0392  70       OHE Unused Date
     C                     PARM *ZERO     WQ0393  70       OHE Unused Date
     C                     PARM #1UVST    WQ0394  1        EDI Status 1
     C                     PARM #1UWST    WQ0395  1        EDI Status 2
     C                     PARM #1UXST    WQ0396  1        EDI Status 3
     C                     PARM 'A'       WQ0397  1        Record Status
     C                     PARM #1AATM    WQ0398  60       Job Time
     C                     PARM #1AYNA    WQ0399 10        User Id
     C                     PARM #1A0NA    WQ0400 10        Job Name
     C                     PARM #1AXDT    WQ0401  70       Job Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNLLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,55           *
     C                     MOVEL'1'       @I1,64           *
     C                     END
     C                     MOVEL#DLWAA    #DZ8CD           USR Country Cod
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Intended for ExportXF - Order Header Extension  * 
     C                     CALL 'PNLKXFR'              90  CHG Intended fo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0402  30       Company Number
     C                     PARM #1C4NB    WQ0403  70       Order Number
     C                     PARM #DC3TX    WQ0404  4        OHE Spot Buy
     C                     PARM #DBOCD    WQ0405  2        OHE Override Ty
     C                     PARM #DLWAA    WQ0406  6        OHE Intended fo
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNLKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,55           *
     C                     MOVEL'1'       @I1,64           *
     C                     END
     C                     MOVEL#DLWAA    #DZ8CD           USR Country Cod
     C                     END                             *FI
     C                     END                             *FI
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * Update load header if shipping temperature changed
      * CASE: Ship Temp Changed and order on a load
      *  - (c1 OR c3 ) AND c2
      *   |- c1    : DTL.Reefer Temperature NE PAR.Reefer Temperature
      *   |- c3    : DTL.Shipping Temp Code C/F NE PAR.Shipping Temp Code
      *   |- c2    : DTL.Load ID NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1RNNB    IFNE P1RNNB                     *IF
     C           #1FRSX    ORNE P1FRSX                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1RMNB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Min Temp for Load RT - Order Header TRG  * 
     C                     EXSR NERVGN
      * CHG Shipping Temp      CH - Load Header  * 
     C                     EXSR NFCHRC
     C                     Z-ADD#1RNNB    P1RNNB           Reefer Temperat
     C                     MOVEL#1FRSX    P1FRSX           Shipping Temp C
     C                     END                             *FI
      * Update Load Header Shipping Method if Load ID is not blank
      * CASE: DTL.Load ID is Blank
     C           #1RMNB    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * ** If shipping method was Collect and now is Prepaid
      * CASE: PAR.Shipping Method is Buyers Truck
     C           P1Q2CD    IFEQ 'CR'                       *IF
     C           P1Q2CD    OREQ 'CT'
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
     C                     ELSE
      * CASE: *OTHERWISE
      * If shipping method changed to prepaid and carrier is blank
      * CASE: DTL.Carrier Code is not entered
     C           #1BZNA    IFEQ *BLANK                     *IF
      * ** E-TRANS47 - Report carrier changes to Traffic (do not change t
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'SHPMTH'  YL0061           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVELYL0061    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELP1Q2CD    PDMNTX    P      Change Log Prio
     C                     MOVEL#1Q2CD    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,37           *
     C                     END
      * ** This CHGOBJ writes the carrier change to the load order chg lo
      * ** Change the Shipping Method if Changed from CT to PT     FP1251
      * CHG Carrier/Broker     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0087           Load ID
     C                     MOVEL#1BZNA    WL0088    P      Carrier Code
     C                     MOVEL#1BZNA    WL0089    P      Carrier Broker
     C                     Z-ADD#1C4NB    WL0090           Order Number
     C                     MOVELWUUJST    WL0091    P      Department Cont
     C                     EXSR NGCHRC
      * CHG Ship Method        CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0092           Load ID
     C                     MOVEL#1Q2CD    WL0093    P      Shipping Method
     C                     EXSR NHCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Log entry if carrier code has changed
      * CASE: DTL.Carrier Code NE LCL.Carrier Code Chg Usr 1
     C           #1BZNA    IFNE YL0004                     *IF
      * ** Carrier code will be blanks after Live with TPM
      * ** E-TRANS47 - Report carrier changes to Traffic (do not change t
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'SHPMTH'  YL0061           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVELYL0061    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELP1Q2CD    PDMNTX    P      Change Log Prio
     C                     MOVEL#1Q2CD    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,37           *
     C                     END
      * ** This CHGOBJ writes the carrier change to the load order chg lo
      * ** Change the Shipping Method if Changed from CT to PT   FP1251
      * CHG Carrier/Broker     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0087           Load ID
     C                     MOVEL#1BZNA    WL0088    P      Carrier Code
     C                     MOVEL#1BZNA    WL0089    P      Carrier Broker
     C                     Z-ADD#1C4NB    WL0090           Order Number
     C                     MOVELWUUJST    WL0091    P      Department Cont
     C                     EXSR NGCHRC
      * CHG Ship Method        CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0092           Load ID
     C                     MOVEL#1Q2CD    WL0093    P      Shipping Method
     C                     EXSR NHCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If shipping method was prepaid and changed to collect
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      * ** FT686 - Report carrier changes to Traffic (do not change this)
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'SHPMTH'  YL0061           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVELYL0061    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELP1Q2CD    PDMNTX    P      Change Log Prio
     C                     MOVEL#1Q2CD    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,37           *
     C                     END
      * CHG Carrier/Broker     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0087           Load ID
     C                     MOVEL#1BZNA    WL0088    P      Carrier Code
     C                     MOVEL#1BZNA    WL0089    P      Carrier Broker
     C                     Z-ADD#1C4NB    WL0090           Order Number
     C                     MOVELWUUJST    WL0091    P      Department Cont
     C                     EXSR NGCHRC
      * ** Change the Shipping Method if Changed from PT to CT
      * CHG Ship Method        CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0092           Load ID
     C                     MOVEL#1Q2CD    WL0093    P      Shipping Method
     C                     EXSR NHCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Shipping Method NE DTL.Shipping Method
     C           P1Q2CD    IFNE #1Q2CD                     *IF
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'SHPMTH'  YL0061           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVELYL0061    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELP1Q2CD    PDMNTX    P      Change Log Prio
     C                     MOVEL#1Q2CD    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,37           *
     C                     END
      * ** Change the Shipping Method if Changed from PT to CT
      * CHG Ship Method        CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0092           Load ID
     C                     MOVEL#1Q2CD    WL0093    P      Shipping Method
     C                     EXSR NHCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If no Mileage Betw Cities rec, send an email to Traffic.  E1625
      * CASE: WRK.Status - Mileage is No
     C           WUFCSX    IFEQ 'N'                        *IF
      * Only email if Seaboard
      * CASE: PAR.Company Organization is Seaboard
     C           P3YJSX    IFEQ 'S'                        *IF
      * RTV Warehouse Address  XF - Warehouse  * 
     C                     CALL 'PNX5XFR'              90  RTV Warehouse A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DAJCD    WQ0407  3        Warehouse Code
     C                     PARM *BLANK    WQ0408 30        Warehouse Descr
     C                     PARM *BLANK    WQ0409 30        Address Line 1
     C                     PARM *BLANK    WQ0410 30        Address Line 2
     C                     PARM *BLANK    WQ0411 30        Address Line 3
     C           YL0063    PARM *BLANK    WQ0412 20        City
     C                     PARM *BLANK    WQ0413 11        Zip Postal Code
     C           YL0064    PARM *BLANK    WQ0414  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNX5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * CASE: Not an error if from/to same city/state
      *  - c1 AND c2
      *   |- c1    : DTL.Ship To City EQ LCL.From City
      *   |- c2    : DTL.Ship To State Code EQ LCL.From State
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HNNA    IFEQ YL0063                     *IF
     C           #1DBCD    IFEQ YL0064                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Dont snd msg if Live with TMSLDP
      * CASE: PAR.PFS Carlisle Active is No
     C           P8WUSX    IFEQ 'N'                        *IF
      * CLP Email if no MBC    CL - Mileage Between Cities  * 
     C                     CALL 'PNX2UPC'              90  Zzz Email if no
     C                     PARM YL0063    WQ0415 20        From City
     C                     PARM YL0064    WQ0416  2        From State
     C                     PARM #1HNNA    WQ0417 20        To City
     C                     PARM #1DBCD    WQ0418  2        To State State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNX2UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WUFCSX           Status - Mileag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update Load/Order Change Log if requested delivery date/time chan
      * CASE:
      *  - c1 AND (c2ORc3)
      *   |- c1    : PGM.*Program mode is *CHANGE
      *   |- c2    : DTL.Requested Delivery Date NE WRK.Requested Deliver
      *   |- c3    : DTL.Requested Delivery Time NE WRK.Requested Deliver
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1EIDT    IFNE WUAYDZ                     *IF
     C           #1AFTM    ORNE WUAFTM                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'RQSDLV'  WURVST           Load Change Typ
      * ** Reverse FP1061 - All date changes are to be reported to
      * ** Traffic per Gary Martin. Do Not Change this. E-TRANS47 LJB 01/
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUY8TX           Text USR 7
     C                     MOVELWUAYDZ    WUY8TX           Text USR 7
     C                     MOVEL*BLANK    WUZ7TX           Text USR 4
     C                     MOVELWUAFTM    WUZ7TX           Text USR 4
     C                     Z-ADD1         ZQ      50
     C           WUY8TX    CAT  WUZ7TX:ZQ WUMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    WUY8TX           Text USR 7
     C                     MOVEL#1EIDT    WUY8TX           Text USR 7
     C                     MOVEL*BLANK    WUZ7TX           Text USR 4
     C                     MOVEL#1AFTM    WUZ7TX           Text USR 4
     C                     Z-ADD1         ZQ      50
     C           WUY8TX    CAT  WUZ7TX:ZQ WUMOTX    P      Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELWUMNTX    PDMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * NOTE:  Will only write log if order on load and load not in E sta
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * Upd requested delivery date / Recalc deadline departure
      * CASE: DTL.Load ID is NE Blank
     C           #1RMNB    IFNE *ZERO                      *IF
      * CASE: WRK.Stop/Drop is Stop One
     C           WURVNB    IFEQ 1                          *IF
      * RTV Chg Carr Apt DtTm XF - Load Detail  * 
     C                     CALL 'PNMGXFR'              90  Zzz Chg Carr Ap
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0419  70       Load ID
     C                     PARM *ZERO     WQ0420  70       LD Carrier Appt
     C                     PARM *ZERO     WQ0421  60       LD Carrier Appt
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * UPD Rqs Deliv Date/1st XF - OM Load Detail  * 
     C                     CLEARPFRC
     C                     Z-ADD#1RMNB    PFRMNB           Load ID
      *
     C                     CALL 'PDFFXFR'              90  UPD Rqs Deliv D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Load Detai
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV ld Accpt/Load Status - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0030           Load ID
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    YL0007    P      Load Status
     C                     MOVELWL0032    YL0008    P      Load Acceptance
     C                     MOVELWL0033    P2RYSX    P      MG Created Load
      * ** Unaccept if accepted and date change    E00139
      * CASE:
      *  - c1ANDc3
      *   |- c1    : LCL.Load Acceptance Flag is Load Accepted
      *   |- c3    : PAR.MG Created Load is Not MG Created Load
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFEQ 'A'                        *IF
     C           P2RYSX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Load Acceptance Sw CH - Load Header  * 
     C                     EXSR NICHRC
     C                     END                             *FI
      * Recalc deadline departure since carrier appt may have changed 10/
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           P2RYSX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    WULONA           USR Load Id ALp
     C                     MOVEL#1RMNB    WULONA           USR Load Id ALp
      * CLC Depart Date f/web  XF - Load Header  * 
     C                     CALL 'PNMAXFR'              90  CLC Depart Date
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WULONA    WQ0422  7        USR Load Id ALp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1EIDT    WUAYDZ           Requested Deliv
     C                     Z-ADD#1AFTM    WUAFTM           Requested Deliv
     C                     END                             *FI
      * Upd Load/Order Change Log if Scheduled Ship Date changed  S00949
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Program mode is *CHANGE
      *   |- c2    : DTL.Scheduled Ship Date NE DTL.Scheduled Ship Date U
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0PMD     IFEQ 'CHG'                      *IF
     C           #1AODT    IFNE #DHODT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * Deallocation/Allocation handled with Requested Ship Date change.
     C                     MOVEL'SCHSHP'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUMNTX           Change Log Prio
     C                     MOVEL#DHODT    WUMNTX           Change Log Prio
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVEL#1AODT    WUMOTX           Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELWUMNTX    PDMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * Upd to Unaccepted if load has been accepted & Upd Sched Ship
      * CASE: DTL.Load ID is NE Blank
     C           #1RMNB    IFNE *ZERO                      *IF
      * RTV ld Accpt/Load Status - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0030           Load ID
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    YL0007    P      Load Status
     C                     MOVELWL0032    YL0008    P      Load Acceptance
     C                     MOVELWL0033    P2RYSX    P      MG Created Load
      * ** Unaccept if accepted and date change
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Load Acceptance Flag is Load Accepted
      *   |- c2    : PAR.MG Created Load is Not MG Created Load
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFEQ 'A'                        *IF
     C           P2RYSX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'U'       YL0008           Load Acceptance
     C                     END                             *FI
      * CHG Load Accep/SchShip CH - Load Header  * 
     C                     EXSR NJCHRC
     C                     END                             *FI
     C                     Z-ADD#1EIDT    WUAYDZ           Requested Deliv
     C                     END                             *FI
      * ** PO# changed & order is on a load                   E004119
      * CASE:
      *  - c1 AND c3
      *   |- c1    : DTL.Customer Purchase Order # NE PAR.Customer Purcha
      *   |- c3    : PAR.Load ID is NE Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BCNA    IFNE P1BCNA                     *IF
     C           P1RMNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Write the log record every time the PO# changes
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'PO#CHG'  YL0061           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVELYL0061    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELP1BCNA    PDMNTX    P      Change Log Prio
     C                     MOVEL#1BCNA    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,36           *
     C                     END
      * E4119 RMC 5/23/2016 Remove Live with tpm checks, add MG created l
      * RTV Load Acceptance Sw RT - Load Header  * 
     C                     EXSR NKRVGN
      * ** Change the load accept flag if it has already been accepted.
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Load Acceptance Flag is Load Accepted
      *   |- c2    : PAR.MG Created Load is Not MG Created Load
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFEQ 'A'                        *IF
     C           P2RYSX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Unaccept load if PO# changes on the order
      * CHG Load Acceptance Sw CH - Load Header  * 
     C                     EXSR NLCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1C4NB    P1C4NB           Order Number
     C                     MOVEL#1BCNA    P1BCNA           Customer Purcha
     C                     MOVEL#DAJCD    P5AJCD           Warehouse Code
     C                     MOVEL#DLWAA    P6LWAA           OHE Intended fo
     C                     MOVEL#DKXCD    P5KXCD           Country Code
     C                     MOVEL#DKIAA    P6KIAA           Country Code 1
     C                     Z-ADD#DD0C7    P6D0C7           Ship to Custome
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * F7=Dsp Appts        * remove:Disable if Live w/TPM   E004019
      * CASE: DTL.*CMD key is CF07
     C           *IN07     IFEQ '1'                        *IF
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * Dsp Customer Appt     DF - Customer Appointment  * 
     C                     CALL 'PNXMDFR'              90  Dsp Customer Ap
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0423  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNXMDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     END
     C                     END                             *FI
      * F13=Shipping Instructions
      * CASE: DTL.*CMD key is *Shipping Instructions
     C           *IN13     IFEQ '1'                        *IF
      * EDT Shipping Inst.     EF - PD Shipping Instructions  * 
     C                     CLEARPGRC
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
     C                     Z-ADD*ZERO     PGDXNB           Sequence Number
      *
     C                     CALL 'PDAEEFR'              90  EDT Shipping In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             KEY: Shipping I
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAEEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F16=Load Planning       remove:Disable if Live w/TPM   E0014019
      * CASE: DTL.*CMD key is *Work With Loads
     C           *IN16     IFEQ '1'                        *IF
      * RTV Chk Detail Exists  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0085           Company Number
     C                     Z-ADD#1C4NB    WL0086           Order Number
     C                     EXSR TVRVGN
      * Msg 'Order has no line items' E00180 RMC 7/08/08
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * error msg wont work here. its in the detail screen relations sect
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Add company# and order# to parms being passed    LJB 08/31/06
      * WW Loads Order Entry   DF - Load Header  * 
     C                     CALL 'PDFKDFR'              90  WW Loads Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0424  70       USR Load ID
     C                     PARM #1AIC3    WQ0425  30       Company Number
     C                     PARM #1C4NB    WQ0426  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFKDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * F19=Pick Comments
      * CASE: DTL.*CMD key is CF19
     C           *IN19     IFEQ '1'                        *IF
      * Edt Customer Comment  EF - Customer Comment  * 
     C                     CLEARPHRC
     C                     Z-ADD#1BKC7    PHBKC7           Ship To Custome
     C                     MOVEL'PI'      PHI1SX    P      Comment Type
      *
     C                     CALL 'POF9EFR'              90  Edt Customer Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PHRC             KEY: Customer C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POF9EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     END
     C                     END                             *FI
      * F17=Export Doc
      * CASE: DTL.*CMD key is CF17
     C           *IN17     IFEQ '1'                        *IF
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,016   P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Export document not allwd'
     C                     MOVEL'USR3026' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * F14=Header Comments
      * CASE: DTL.*CMD key is *Header Comments
     C           *IN14     IFEQ '1'                        *IF
      * EDT OP Order Comment   EF - OP Order Comment  * 
     C                     CALL 'PDAGEFR'              90  EDT OP Order Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0427  30       Company Number
     C                     PARM #1C4NB    WQ0428  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAGEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F15=More Header
      * CASE: DTL.*CMD key is *Order Header
     C           *IN15     IFEQ '1'                        *IF
     C                     MOVEL@CN,017   P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F18=Details
      * CASE: DTL.*CMD key is *Order Details
     C           *IN18     IFEQ '1'                        *IF
     C                     MOVEL@CN,018   P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F20=Post Order
      * CASE: DTL.*CMD key is *Post/Update Open Order
     C           *IN20     IFEQ '1'                        *IF
      * Post Order.
     C                     EXSR UCSUBR                     Post Order.
     C                     END                             *FI
     C           W0PMD     IFEQ 'ADD'
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
     C                     END
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * CRT Order Header&DlvPO XF - Order Header TRG  * 
     C                     CALL 'PMDIXFR'              90  CRT Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0500  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0501  70       Order Number
     C                     PARM #1JNCD    WQ0502  2        Order Type_Sale
     C                     PARM #1ANC7    WQ0503  70       AR Customer Num
     C                     PARM #1BKC7    WQ0504  70       Ship To Custome
     C                     PARM WUBTC7    WQ0505  70       Parent Customer
     C                     PARM #1BRTX    WQ0506 30        Ship To Name
     C                     PARM #1HMNA    WQ0507 30        Ship To Address
     C                     PARM #1HONA    WQ0508 30        Ship To Address
     C                     PARM #1HPNA    WQ0509 30        Ship To Address
     C                     PARM #1HNNA    WQ0510 20        Ship To City
     C                     PARM #1DBCD    WQ0511  2        Ship To State C
     C                     PARM #1CKTX    WQ0512 11        Ship To Zip_Pos
     C                     PARM #1B0C7    WQ0513  70       Bill to Custome
     C                     PARM #1AETX    WQ0514 30        Bill to Name
     C                     PARM #1B1NA    WQ0515 30        Bill to Address
     C                     PARM #1B3NA    WQ0516 30        Bill to Address
     C                     PARM #1B4NA    WQ0517 30        Bill to Address
     C                     PARM #1B2NA    WQ0518 20        Bill to City
     C                     PARM #1BHCD    WQ0519  2        Bill to State C
     C                     PARM #1C8TX    WQ0520 11        Bill to Zip_Pos
     C                     PARM #1BCNA    WQ0521 15        Customer Purcha
     C                     PARM #1A0DT    WQ0522  70       Order Date
     C                     PARM #1A5DT    WQ0523  70       Requested Ship
     C                     PARM #1GNDT    WQ0524  70       Actual Shipped
     C                     PARM *ZERO     WQ0525  70       Cancel Date
     C                     PARM #1AQCD    WQ0526  2        Terms Code
     C                     PARM #1B6NA    WQ0527 40        Special Instruc
     C                     PARM #1BYNA    WQ0528 40        Special Instruc
     C                     PARM #1BZNA    WQ0529  3        Carrier Code
     C                     PARM #1GTST    WQ0530  1        Comment Print A
     C                     PARM #1GVST    WQ0531  1        Comment Print I
     C                     PARM #1GUST    WQ0532  1        Comment Print P
     C                     PARM #1QFST    WQ0533  1        Comment Print S
     C                     PARM #1CQCD    WQ0534  3        Reason Code
     C                     PARM 'Y'       WQ0535  1        Order in Use
     C                     PARM #1GWST    WQ0536  1        Header Status
     C                     PARM #1GXST    WQ0537  1        Header Status L
     C                     PARM 'N'       WQ0538  1        Order Type Prin
     C                     PARM #1AODT    WQ0539  70       Scheduled Ship
     C                     PARM #1AIVN    WQ0540 10        User Original E
     C                     PARM #1CXDT    WQ0541  70       Date of Origina
     C                     PARM #1JZVA    WQ0542 112       Order Value Tot
     C                     PARM #1A1WG    WQ0543 112       Order Weight To
     C                     PARM 'N'       WQ0544  1        Credit Hold
     C                     PARM 'N'       WQ0545  1        Production Hold
     C                     PARM 'N'       WQ0546  1        New Customer Ho
     C                     PARM #1EIDT    WQ0547  70       Requested Deliv
     C                     PARM #1AFTM    WQ0548  40       Requested Deliv
     C                     PARM #1E8CD    WQ0549  4        Accounts Receiv
     C                     PARM #1E9CD    WQ0550 12        Accounts Receiv
     C                     PARM #1RMNB    WQ0551  70       Load ID
     C                     PARM #1TBNB    WQ0552  52       Absorbed Freigh
     C                     PARM #1R1NB    WQ0553 112       Rated Freight
     C                     PARM #1PJST    WQ0554  1        LTL Flag
     C                     PARM *BLANK    WQ0555  1        Price Audit
     C                     PARM 'U'       WQ0556  1        Price Status
     C                     PARM #1Q2CD    WQ0557  2        Shipping Method
     C                     PARM #1U2ST    WQ0558  1        Export Status
     C                     PARM #1VEST    WQ0559  1        Palletize
     C                     PARM #1VFST    WQ0560  1        Shrink Wrap
     C                     PARM #1VGST    WQ0561  1        Slip Sheet
     C                     PARM *BLANK    WQ0562  1        Age Code
     C                     PARM #1RNNB    WQ0563  52       Reefer Temperat
     C                     PARM #1VDST    WQ0564  1        Load Type
     C                     PARM #1ATIN    WQ0565  70       Attach to Invoi
     C                     PARM #1U4ST    WQ0566  1        Load Plan Order
     C                     PARM #1U5ST    WQ0567  1        Print Pick Slip
     C                     PARM #1RSRN    WQ0568  70       Resell Referenc
     C                     PARM #1MHNA    WQ0569 30        Special Comment
     C                     PARM #1MINA    WQ0570 30        Special Comment
     C                     PARM #1WBST    WQ0571  1        Affect Auto Acc
     C                     PARM #1R4CD    WQ0572  3        Sales Route Cod
     C                     PARM #1BFCD    WQ0573  2        Manager Level C
     C                     PARM #1Q4CD    WQ0574  3        VP Level Code
     C                     PARM #1T3NB    WQ0575  70       Attach to Order
     C                     PARM #1SICD    WQ0576  3        Reason for Pric
     C                     PARM #1CONB    WQ0577  70       Invoice Number
     C                     PARM #1CEST    WQ0578  2        Invoice Suffix
     C                     PARM #1AWDT    WQ0579  70       Invoice Date
     C                     PARM #1JPCD    WQ0580  2        Event Code
     C                     PARM #1XUST    WQ0581  1        Trans Contol AS
     C                     PARM #1Z1ST    WQ0582  1        Modified Flag
     C                     PARM #1VRVA    WQ0583 112       A_R order Value
     C                     PARM #1OBST    WQ0584  1        Billing Activit
     C                     PARM #1BCST    WQ0585  1        Block Order Fla
     C                     PARM #1BDST    WQ0586  1        Order Certifica
     C                     PARM #1B7VL    WQ0587 112       Invoice Order V
     C                     PARM #1GASX    WQ0588  1        Process Sts for
     C                     PARM #1GBSX    WQ0589  1        Order Conf Fax
     C                     PARM #1GCSX    WQ0590  1        Manifest Fax St
     C                     PARM #1GDSX    WQ0591  1        Invoice Fax Sts
     C                     PARM #1FNSX    WQ0592  1        Transfer in Sto
     C                     PARM #1FOSX    WQ0593  1        Email Cust On O
     C                     PARM #1FPSX    WQ0594  1        Order Emailed
     C                     PARM #1FQSX    WQ0595  1        Export Docs Go
     C                     PARM #1FRSX    WQ0596  1        Shipping Temp C
     C                     PARM #1FSSX    WQ0597  1        Broker Order St
     C                     PARM #1FTSX    WQ0598  1        Air Freight Ord
     C                     PARM #1FUSX    WQ0599  2        Order Requires
     C                     PARM #1FVSX    WQ0600  2        OH Load Plan Re
     C                     PARM #1FWSX    WQ0601  2        Export USDA App
     C                     PARM #1FXSX    WQ0602  3        HPB Ship to War
     C                     PARM #1FYSX    WQ0603  3        OH TF Exempt Co
     C                     PARM #1NODT    WQ0604  70       OH Appt Confirm
     C                     PARM #1NPDT    WQ0605  70       JPN Invoice Iss
     C                     PARM #1NQDT    WQ0606  70       Load Actual Shi
     C                     PARM #1NRDT    WQ0607  70       Load BOL Comple
     C                     PARM #1NSDT    WQ0608  70       Load Truck Depa
     C                     PARM #1BPTM    WQ0609  60       Maximum Gross W
     C                     PARM #1BQTM    WQ0610  60       Time of Origina
     C                     PARM #1BRTM    WQ0611  60       OH Appt Confirm
     C                     PARM #1BSTM    WQ0612  60       Load BOL Comple
     C                     PARM #1BTTM    WQ0613  60       Load Truck Depa
     C                     PARM #1H0NX    WQ0614 112       Act Frt Referen
     C                     PARM #1H1NX    WQ0615 112       Act Non_Ref Frt
     C                     PARM #1H2NX    WQ0616 112       OH Fuel Surchar
     C                     PARM #1H3NX    WQ0617 112       OH Total Non_Re
     C                     PARM #1H4NX    WQ0618 112       OH Total Ref Fr
     C                     PARM #1C0C7    WQ0619  70       Claim Number
     C                     PARM #1UVST    WQ0620  1        EDI Status 1
     C                     PARM #1UWST    WQ0621  1        EDI Status 2
     C                     PARM #1UXST    WQ0622  1        EDI Status 3
     C                     PARM #DHEVL    WQ0623 112       OHE HPB RIN Equ
     C                     PARM #DHFVL    WQ0624 112       OHE HPB RIN Pri
     C                     PARM #DC3TX    WQ0625  4        OHE Spot Buy
     C                     PARM #DBOCD    WQ0626  2        OHE Override Ty
     C           #DNLTX    PARM #DNLTX    WQ0627 38        Delivery P_O  N
     C                     PARM #DLWAA    WQ0628  6        OHE Intended fo
     C                     PARM *BLANK    WQ0629 10        OHE Abs Rate Ov
     C                     PARM #DV5T1    WQ0630 10        OHE Appt Confir
     C                     PARM #DWBT1    WQ0631 30        OHE Appt Confir
     C                     PARM YL0009    WQ0632 50        Letter of Credi
     C                     PARM WUCHST    WQ0633  1        Auto Order Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,36           *
     C                     MOVEL'1'       @I1,48           *
     C                     MOVEL'1'       @I1,35           *
     C                     MOVEL'1'       @I1,39           *
     C                     MOVEL'1'       @I1,42           *
     C                     MOVEL'1'       @I1,33           *
     C                     MOVEL'1'       @I1,34           *
     C                     MOVEL'1'       @I1,40           *
     C                     MOVEL'1'       @I1,37           *
     C                     MOVEL'1'       @I1,56           *
     C                     MOVEL'1'       @I1,49           *
     C                     MOVEL'1'       @I1,41           *
     C                     MOVEL'1'       @I1,62           *
     C                     MOVEL'1'       @I1,47           *
     C                     MOVEL'1'       @I1,63           *
     C                     MOVEL'1'       @I1,50           *
     C                     MOVEL'1'       @I1,53           *
     C                     MOVEL'1'       @I1,57           *
     C                     MOVEL'1'       @I1,58           *
     C                     MOVEL'1'       @I1,46           *
     C                     MOVEL'1'       @I1,51           *
     C                     MOVEL'1'       @I1,54           *
     C                     MOVEL'1'       @I1,55           *
     C                     MOVEL'1'       @I1,43           *
     C                     MOVEL'1'       @I1,64           *
     C                     MOVEL'1'       @I1,59           *
     C                     MOVEL'1'       @I1,61           *
     C                     END
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Order Header&DlvPO XF - Order Header TRG  * 
     C                     CALL 'PMDHXFR'              90  Chg Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0634  30       Company Number
     C                     PARM #1C4NB    WQ0635  70       Order Number
     C                     PARM #1JNCD    WQ0636  2        Order Type_Sale
     C                     PARM #1ANC7    WQ0637  70       AR Customer Num
     C                     PARM #1BKC7    WQ0638  70       Ship To Custome
     C                     PARM WUBTC7    WQ0639  70       Parent Customer
     C                     PARM #1BRTX    WQ0640 30        Ship To Name
     C                     PARM #1HMNA    WQ0641 30        Ship To Address
     C                     PARM #1HONA    WQ0642 30        Ship To Address
     C                     PARM #1HPNA    WQ0643 30        Ship To Address
     C                     PARM #1HNNA    WQ0644 20        Ship To City
     C                     PARM #1DBCD    WQ0645  2        Ship To State C
     C                     PARM #1CKTX    WQ0646 11        Ship To Zip_Pos
     C                     PARM #1B0C7    WQ0647  70       Bill to Custome
     C                     PARM #1AETX    WQ0648 30        Bill to Name
     C                     PARM #1B1NA    WQ0649 30        Bill to Address
     C                     PARM #1B3NA    WQ0650 30        Bill to Address
     C                     PARM #1B4NA    WQ0651 30        Bill to Address
     C                     PARM #1B2NA    WQ0652 20        Bill to City
     C                     PARM #1BHCD    WQ0653  2        Bill to State C
     C                     PARM #1C8TX    WQ0654 11        Bill to Zip_Pos
     C                     PARM #1BCNA    WQ0655 15        Customer Purcha
     C                     PARM #1A0DT    WQ0656  70       Order Date
     C                     PARM #1A5DT    WQ0657  70       Requested Ship
     C                     PARM #1GNDT    WQ0658  70       Actual Shipped
     C                     PARM #1ACDT    WQ0659  70       Cancel Date
     C                     PARM #1AQCD    WQ0660  2        Terms Code
     C                     PARM #1B6NA    WQ0661 40        Special Instruc
     C                     PARM #1BYNA    WQ0662 40        Special Instruc
     C                     PARM #1BZNA    WQ0663  3        Carrier Code
     C                     PARM #1GTST    WQ0664  1        Comment Print A
     C                     PARM #1GVST    WQ0665  1        Comment Print I
     C                     PARM #1GUST    WQ0666  1        Comment Print P
     C                     PARM #1QFST    WQ0667  1        Comment Print S
     C                     PARM #1CQCD    WQ0668  3        Reason Code
     C                     PARM #1GJST    WQ0669  1        Order in Use
     C                     PARM #1GWST    WQ0670  1        Header Status
     C                     PARM #1GXST    WQ0671  1        Header Status L
     C                     PARM #1GYST    WQ0672  1        Order Type Prin
     C                     PARM #1AODT    WQ0673  70       Scheduled Ship
     C                     PARM #1AIVN    WQ0674 10        User Original E
     C                     PARM #1CXDT    WQ0675  70       Date of Origina
     C                     PARM #1JZVA    WQ0676 112       Order Value Tot
     C                     PARM #1A1WG    WQ0677 112       Order Weight To
     C                     PARM #1XIST    WQ0678  1        Credit Hold
     C                     PARM #1XJST    WQ0679  1        Production Hold
     C                     PARM #1XKST    WQ0680  1        New Customer Ho
     C                     PARM #1EIDT    WQ0681  70       Requested Deliv
     C                     PARM #1AFTM    WQ0682  40       Requested Deliv
     C                     PARM #1E8CD    WQ0683  4        Accounts Receiv
     C                     PARM #1E9CD    WQ0684 12        Accounts Receiv
     C                     PARM #1RMNB    WQ0685  70       Load ID
     C                     PARM #1TBNB    WQ0686  52       Absorbed Freigh
     C                     PARM #1R1NB    WQ0687 112       Rated Freight
     C                     PARM #1PJST    WQ0688  1        LTL Flag
     C                     PARM #1U0ST    WQ0689  1        Price Audit
     C                     PARM #1U1ST    WQ0690  1        Price Status
     C                     PARM #1Q2CD    WQ0691  2        Shipping Method
     C                     PARM #1U2ST    WQ0692  1        Export Status
     C                     PARM #1VEST    WQ0693  1        Palletize
     C                     PARM #1VFST    WQ0694  1        Shrink Wrap
     C                     PARM #1VGST    WQ0695  1        Slip Sheet
     C                     PARM #1RPCD    WQ0696  1        Age Code
     C                     PARM #1RNNB    WQ0697  52       Reefer Temperat
     C                     PARM #1VDST    WQ0698  1        Load Type
     C                     PARM #1ATIN    WQ0699  70       Attach to Invoi
     C                     PARM #1U4ST    WQ0700  1        Load Plan Order
     C                     PARM #1U5ST    WQ0701  1        Print Pick Slip
     C                     PARM #1RSRN    WQ0702  70       Resell Referenc
     C                     PARM #1MHNA    WQ0703 30        Special Comment
     C                     PARM #1MINA    WQ0704 30        Special Comment
     C                     PARM #1WBST    WQ0705  1        Affect Auto Acc
     C                     PARM #1R4CD    WQ0706  3        Sales Route Cod
     C                     PARM #1BFCD    WQ0707  2        Manager Level C
     C                     PARM #1Q4CD    WQ0708  3        VP Level Code
     C                     PARM #1T3NB    WQ0709  70       Attach to Order
     C                     PARM #1SICD    WQ0710  3        Reason for Pric
     C                     PARM #1CONB    WQ0711  70       Invoice Number
     C                     PARM #1CEST    WQ0712  2        Invoice Suffix
     C                     PARM #1AWDT    WQ0713  70       Invoice Date
     C                     PARM #1JPCD    WQ0714  2        Event Code
     C                     PARM #1XUST    WQ0715  1        Trans Contol AS
     C                     PARM #1Z1ST    WQ0716  1        Modified Flag
     C                     PARM #1VRVA    WQ0717 112       A_R order Value
     C                     PARM #1OBST    WQ0718  1        Billing Activit
     C                     PARM #1BCST    WQ0719  1        Block Order Fla
     C                     PARM #1BDST    WQ0720  1        Order Certifica
     C                     PARM #1B7VL    WQ0721 112       Invoice Order V
     C                     PARM #1GASX    WQ0722  1        Process Sts for
     C                     PARM #1GBSX    WQ0723  1        Order Conf Fax
     C                     PARM #1GCSX    WQ0724  1        Manifest Fax St
     C                     PARM #1GDSX    WQ0725  1        Invoice Fax Sts
     C                     PARM #1FNSX    WQ0726  1        Transfer in Sto
     C                     PARM #1FOSX    WQ0727  1        Email Cust On O
     C                     PARM #1FPSX    WQ0728  1        Order Emailed
     C                     PARM #1FQSX    WQ0729  1        Export Docs Go
     C                     PARM #1FRSX    WQ0730  1        Shipping Temp C
     C                     PARM #1FSSX    WQ0731  1        Broker Order St
     C                     PARM #1FTSX    WQ0732  1        Air Freight Ord
     C                     PARM #1FUSX    WQ0733  2        Order Requires
     C                     PARM #1FVSX    WQ0734  2        OH Load Plan Re
     C                     PARM #1FWSX    WQ0735  2        Export USDA App
     C                     PARM #1FXSX    WQ0736  3        HPB Ship to War
     C                     PARM #1FYSX    WQ0737  3        OH TF Exempt Co
     C                     PARM #1NODT    WQ0738  70       OH Appt Confirm
     C                     PARM #1NPDT    WQ0739  70       JPN Invoice Iss
     C                     PARM #1NQDT    WQ0740  70       Load Actual Shi
     C                     PARM #1NRDT    WQ0741  70       Load BOL Comple
     C                     PARM #1NSDT    WQ0742  70       Load Truck Depa
     C                     PARM #1BPTM    WQ0743  60       Maximum Gross W
     C                     PARM #1BQTM    WQ0744  60       Time of Origina
     C                     PARM #1BRTM    WQ0745  60       OH Appt Confirm
     C                     PARM #1BSTM    WQ0746  60       Load BOL Comple
     C                     PARM #1BTTM    WQ0747  60       Load Truck Depa
     C                     PARM #1H0NX    WQ0748 112       Act Frt Referen
     C                     PARM #1H1NX    WQ0749 112       Act Non_Ref Frt
     C                     PARM #1H2NX    WQ0750 112       OH Fuel Surchar
     C                     PARM #1H3NX    WQ0751 112       OH Total Non_Re
     C                     PARM #1H4NX    WQ0752 112       OH Total Ref Fr
     C                     PARM #1C0C7    WQ0753  70       Claim Number
     C                     PARM #1UVST    WQ0754  1        EDI Status 1
     C                     PARM #1UWST    WQ0755  1        EDI Status 2
     C                     PARM #1UXST    WQ0756  1        EDI Status 3
     C                     PARM #DHEVL    WQ0757 112       OHE HPB RIN Equ
     C                     PARM #DHFVL    WQ0758 112       OHE HPB RIN Pri
     C                     PARM #DC3TX    WQ0759  4        OHE Spot Buy
     C                     PARM #DBOCD    WQ0760  2        OHE Override Ty
     C                     PARM #DNLTX    WQ0761 38        Delivery P_O  N
     C                     PARM #DLWAA    WQ0762  6        OHE Intended fo
     C                     PARM #DV5T1    WQ0763 10        OHE Appt Confir
     C                     PARM #DWBT1    WQ0764 30        OHE Appt Confir
     C                     PARM YL0009    WQ0765 50        Letter of Credi
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,36           *
     C                     MOVEL'1'       @I1,48           *
     C                     MOVEL'1'       @I1,35           *
     C                     MOVEL'1'       @I1,39           *
     C                     MOVEL'1'       @I1,42           *
     C                     MOVEL'1'       @I1,33           *
     C                     MOVEL'1'       @I1,34           *
     C                     MOVEL'1'       @I1,40           *
     C                     MOVEL'1'       @I1,37           *
     C                     MOVEL'1'       @I1,56           *
     C                     MOVEL'1'       @I1,49           *
     C                     MOVEL'1'       @I1,41           *
     C                     MOVEL'1'       @I1,62           *
     C                     MOVEL'1'       @I1,47           *
     C                     MOVEL'1'       @I1,63           *
     C                     MOVEL'1'       @I1,50           *
     C                     MOVEL'1'       @I1,53           *
     C                     MOVEL'1'       @I1,57           *
     C                     MOVEL'1'       @I1,58           *
     C                     MOVEL'1'       @I1,46           *
     C                     MOVEL'1'       @I1,51           *
     C                     MOVEL'1'       @I1,54           *
     C                     MOVEL'1'       @I1,55           *
     C                     MOVEL'1'       @I1,43           *
     C                     MOVEL'1'       @I1,64           *
     C                     MOVEL'1'       @I1,59           *
     C                     MOVEL'1'       @I1,61           *
     C                     END
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YKRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1AIC3    IFEQ *ZERO                      Company Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C           W0SCR     IFNE 1
     C                     MOVEL'0'       *IN79
     C                     MOVEL'0'       *IN78
     C                     MOVEL'0'       *IN77
     C                     MOVEL'0'       *IN76
     C                     MOVEL'0'       *IN75
     C                     MOVEL'0'       *IN74
     C                     MOVEL'0'       *IN73
     C                     MOVEL'0'       *IN72
     C                     MOVEL'0'       *IN71
     C                     MOVEL'0'       *IN70
     C                     MOVEL'0'       *IN68
     C                     MOVEL'0'       *IN69
     C                     MOVEL'0'       *IN66
     C                     MOVEL'0'       *IN67
     C                     END
     C           W0SCR     IFNE 2
     C                     END
     C           W0SCR     IFEQ 1
     C                     MOVEL'0'       *IN79
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUTIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUF4ST    IFEQ 'L'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           P6AFTX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           P6AKTX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #1FVSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           WUTJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           #1BCST    IFEQ 'B'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           WUE5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           P3YJSX    IFEQ 'D'                        *IF
     C           P3YJSX    OREQ 'H'
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN68
     C                     MOVEL'0'       *IN69
     C           P3YJSX    IFEQ 'D'                        *IF
     C           P3YJSX    OREQ 'S'
     C                     MOVEL'1'       *IN68
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL'0'       *IN66
     C                     MOVEL'0'       *IN67
     C           P3YJSX    IFEQ 'D'                        *IF
     C                     MOVEL'1'       *IN66
     C                     MOVEL'1'       *IN67
     C                     END                             *FI
     C                     ELSE
     C           W0SCR     IFEQ 2
     C                     END
     C                     END
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #DAPTX           Company Name
     C                     MOVEL*BLANK    #DV4T1           OHE Abs Rate Ov
     C                     MOVEL*BLANK    #DVR01           Reference. . .
     C                     MOVEL*BLANK    #DWKCD           To Warehouse Co
     C                     MOVEL*BLANK    #DHFTX           Explaination Te
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL*BLANK    #DZ8CD           USR Country Cod
     C                     Z-ADD*ZERO     #DLYDT           Must Ship Date
     C                     Z-ADD*ZERO     #DA5TM           Must Ship Time
     C                     Z-ADD*ZERO     #DT4TM           USR Time 4.0
     C                     Z-ADD*ZERO     #DCZDT           USR Requested s
     C                     Z-ADD*ZERO     #DHODT           Scheduled Ship
     C                     MOVEL*BLANK    #DCPCD           USR Warehouse C
     C                     MOVEL*BLANK    #1FSSX           Broker Order St
     C                     MOVEL*BLANK    #DC4T1           Broker Name
     C                     Z-ADD*ZERO     #1ANC7           AR Customer Num
     C                     Z-ADD*ZERO     #1B7VL           Invoice Order V
     C                     MOVEL*BLANK    #1GASX           Process Sts for
     C                     MOVEL*BLANK    #1GBSX           Order Conf Fax
     C                     MOVEL*BLANK    #1GCSX           Manifest Fax St
     C                     MOVEL*BLANK    #1GDSX           Invoice Fax Sts
     C                     MOVEL*BLANK    #1FOSX           Email Cust On O
     C                     MOVEL*BLANK    #1FPSX           Order Emailed
     C                     MOVEL*BLANK    #1FTSX           Air Freight Ord
     C                     MOVEL*BLANK    #1FWSX           Export USDA App
     C                     MOVEL*BLANK    #1FYSX           OH TF Exempt Co
     C                     Z-ADD*ZERO     #1NPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     #1NQDT           Load Actual Shi
     C                     Z-ADD*ZERO     #1NRDT           Load BOL Comple
     C                     Z-ADD*ZERO     #1NSDT           Load Truck Depa
     C                     Z-ADD*ZERO     #1BPTM           Maximum Gross W
     C                     Z-ADD*ZERO     #1BQTM           Time of Origina
     C                     Z-ADD*ZERO     #1BSTM           Load BOL Comple
     C                     Z-ADD*ZERO     #1BTTM           Load Truck Depa
     C                     Z-ADD*ZERO     #1H0NX           Act Frt Referen
     C                     Z-ADD*ZERO     #1H1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     #1H2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     #1H3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     #1H4NX           OH Total Ref Fr
     C                     MOVEL*BLANK    #DUFCD           USR Export Code
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     Z-ADD*ZERO     #1ACDT           Cancel Date
     C                     MOVEL*BLANK    #1AQCD           Terms Code
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #1GTST           Comment Print A
     C                     MOVEL*BLANK    #1GVST           Comment Print I
     C                     MOVEL*BLANK    #1GUST           Comment Print P
     C                     MOVEL*BLANK    #1QFST           Comment Print S
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1GJST           Order in Use
     C                     MOVEL*BLANK    #1GXST           Header Status L
     C                     MOVEL*BLANK    #1GYST           Order Type Prin
     C                     MOVEL*BLANK    #1AIVN           User Original E
     C                     Z-ADD*ZERO     #1CXDT           Date of Origina
     C                     MOVEL*BLANK    #1XKST           New Customer Ho
     C                     MOVEL*BLANK    #1E8CD           Accounts Receiv
     C                     MOVEL*BLANK    #1E9CD           Accounts Receiv
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1U0ST           Price Audit
     C                     MOVEL*BLANK    #1U1ST           Price Status
     C                     MOVEL*BLANK    #1VEST           Palletize
     C                     MOVEL*BLANK    #1VFST           Shrink Wrap
     C                     MOVEL*BLANK    #1VGST           Slip Sheet
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     Z-ADD*ZERO     #1ATIN           Attach to Invoi
     C                     MOVEL*BLANK    #1U4ST           Load Plan Order
     C                     MOVEL*BLANK    #1U5ST           Print Pick Slip
     C                     Z-ADD*ZERO     #1RSRN           Resell Referenc
     C                     MOVEL*BLANK    #1MHNA           Special Comment
     C                     MOVEL*BLANK    #1MINA           Special Comment
     C                     MOVEL*BLANK    #1WBST           Affect Auto Acc
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1BFCD           Manager Level C
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     Z-ADD*ZERO     #1T3NB           Attach to Order
     C                     MOVEL*BLANK    #1SICD           Reason for Pric
     C                     Z-ADD*ZERO     #1CONB           Invoice Number
     C                     MOVEL*BLANK    #1CEST           Invoice Suffix
     C                     Z-ADD*ZERO     #1AWDT           Invoice Date
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     MOVEL*BLANK    #1XUST           Trans Contol AS
     C                     MOVEL*BLANK    #1Z1ST           Modified Flag
     C                     Z-ADD*ZERO     #1VRVA           A_R order Value
     C                     MOVEL*BLANK    #1OBST           Billing Activit
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #DKIAA           Country Code 1
     C                     Z-ADD*ZERO     #DD0C7           Ship to Custome
     C                     Z-ADDP1BKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     Z-ADD*ZERO     #1B0C7           Bill to Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1B0C7
     C                     Z-ADD*ZERO     #DFKNB           USR Company Num
      * Clear external version also
     C                     MOVEL*BLANK    VDFKNB
     C                     MOVEL*BLANK    #1AETX           Bill to Name
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     Z-ADD*ZERO     #1AFTM           Requested Deliv
     C                     MOVEL*BLANK    #1HMNA           Ship To Address
     C                     MOVEL*BLANK    #1B1NA           Bill to Address
     C                     Z-ADD*ZERO     #1A5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1A5DT
     C                     MOVEL*BLANK    #1HONA           Ship To Address
     C                     MOVEL*BLANK    #1B3NA           Bill to Address
     C                     MOVEL*BLANK    #DMTTX           Field Descripti
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     MOVEL*BLANK    #1HPNA           Ship To Address
     C                     MOVEL*BLANK    #1B4NA           Bill to Address
     C                     Z-ADD*ZERO     #DA0DZ           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     VDA0DZ
     C                     Z-ADD*ZERO     #DBUTM           Deadline Depart
     C                     MOVEL*BLANK    #1HNNA           Ship To City
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     MOVEL*BLANK    #1CKTX           Ship To Zip_Pos
     C                     MOVEL*BLANK    #1B2NA           Bill to City
     C                     MOVEL*BLANK    #1BHCD           Bill to State C
     C                     MOVEL*BLANK    #1C8TX           Bill to Zip_Pos
     C                     MOVEL*BLANK    #DHETX           Explaination Te
     C                     MOVEL*BLANK    #DBVTX           Telephone Numbe
     C                     MOVEL*BLANK    #DO3TX           Explaination 50
     C                     MOVEL*BLANK    #1BCNA           Customer Purcha
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     MOVEL*BLANK    #DS7NA           Shipping Method
     C                     MOVEL*BLANK    #1JNCD           Order Type_Sale
     C                     MOVEL*BLANK    #DJVNA           Order Type Desc
     C                     MOVEL*BLANK    #1B6NA           Special Instruc
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     MOVEL*BLANK    #1BCST           Block Order Fla
     C                     MOVEL*BLANK    #DVLT1           Block Order Fla
     C                     MOVEL*BLANK    #1BYNA           Special Instruc
     C                     MOVEL*BLANK    #DNLTX           USR 15 Text
     C                     MOVEL*BLANK    #DBCCD           Salesperson Cod
     C                     MOVEL*BLANK    #DALTX           Salesperson Nam
     C                     MOVEL*BLANK    #DAJCD           Warehouse Code
     C                     MOVEL*BLANK    #DO6NA           Warehouse Desc
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     #1C0C7           Claim Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C0C7
     C                     MOVEL*BLANK    #1FNSX           Transfer in Sto
     C                     Z-ADD*ZERO     #1A0DT           Order Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1A0DT
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #1FRSX           Shipping Temp C
     C                     Z-ADD*ZERO     #DHEVL           OHE HPB RIN Equ
     C                     MOVEL*BLANK    #DSPOT           Spot Buy  (Y/N)
     C                     MOVEL*BLANK    #DQIU1           Spot Buy Text U
     C                     MOVEL*BLANK    #1FXSX           HPB Ship to War
     C                     Z-ADD*ZERO     #DHFVL           OHE HPB RIN Pri
     C                     MOVEL*BLANK    #DYMTX           Text USR 8
     C                     MOVEL*BLANK    #DBOCD           Type Code
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     Z-ADD*ZERO     #1NODT           OH Appt Confirm
      * Clear external version also
     C                     Z-ADD*ZERO     V1NODT
     C                     Z-ADD*ZERO     #1BRTM           OH Appt Confirm
     C                     MOVEL*BLANK    #DV5T1           OHE Appt Confir
     C                     MOVEL*BLANK    #DKXCD           Country Code
     C                     MOVEL*BLANK    #DDATX           Country Descrip
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     MOVEL*BLANK    #DWBT1           OHE Appt Confir
     C                     MOVEL*BLANK    #1BDST           Order Certifica
     C                     MOVEL*BLANK    #1FQSX           Export Docs Go
     C                     Z-ADD*ZERO     #DCDWG           USR Weight Accu
     C                     MOVEL*BLANK    #1GWST           Header Status
     C                     MOVEL*BLANK    #1FVSX           OH Load Plan Re
     C                     MOVEL*BLANK    #DLWAA           OHE Intended fo
     C                     MOVEL*BLANK    #DD6T1           Text USR 9
     C                     Z-ADD*ZERO     #1JZVA           Order Value Tot
     C                     MOVEL*BLANK    #1XIST           Credit Hold
     C                     MOVEL*BLANK    #1FUSX           Order Requires
     C                     MOVEL*BLANK    #DAKU1           String 30
     C                     Z-ADD*ZERO     #1A1WG           Order Weight To
     C                     MOVEL*BLANK    #1XJST           Production Hold
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BECPFK fields to screen
      *================================================================
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     Z-ADDBEANC7    #1ANC7           AR Customer Num
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non_Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non_Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A_R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip_Pos
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip_Pos
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEJNCD    #1JNCD           Order Type_Sale
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXJST    #1XJST           Production Hold
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
      * USER: Initialize key screen
      * CASE: WRK.Allow Multi-Company is no
     C           WUI6ST    IFEQ 'N'                        *IF
     C                     Z-ADDWUAIC3    #1AIC3           Company Number
     C                     ELSE
      * CASE: WRK.Allow Multi-Company is yes
     C           WUI6ST    IFEQ 'Y'                        *IF
      * CASE: KEY.Company Number is Equal to zero
     C           #1AIC3    IFEQ *ZERO                      *IF
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * CASE: KEY.Company Number is Equal to zero
     C           #1AIC3    IFEQ *ZERO                      *IF
     C                     Z-ADDWUAIC3    #1AIC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0041           Company Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    YL0065    P      Name
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MFIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     MOVEL*BLANK    #DS7NA           Shipping Method
     C                     MOVEL*BLANK    #DO6NA           Warehouse Desc
      *================================================================
     CSR         MFEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1B0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1B0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1B0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert USR Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #DFKNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#DFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VDFKNB           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDFKNB           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A5DT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Deadline Depart Date to display format
      * Convert date
     C           1000000   ADD  #DA0DZ    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDA0DZ
      * Convert Claim Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  #1A0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A0DT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert OH Appt Confirmation Dt to display format
      * Convert date
     C           1000000   ADD  #1NODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1NODT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * CHG Order Value,Wgt    CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0140  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0141  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0142  70       Ship To Custome
     C                     MOVEL*BLANK    WN0143 30        Ship To Name
     C                     MOVEL*BLANK    WN0144 30        Ship To Address
     C                     MOVEL*BLANK    WN0145 30        Ship To Address
     C                     MOVEL*BLANK    WN0146 30        Ship To Address
     C                     MOVEL*BLANK    WN0147 20        Ship To City
     C                     MOVEL*BLANK    WN0148  2        Ship To State C
     C                     MOVEL*BLANK    WN0149 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0150  70       Bill to Custome
     C                     MOVEL*BLANK    WN0151 30        Bill to Name
     C                     MOVEL*BLANK    WN0152 30        Bill to Address
     C                     MOVEL*BLANK    WN0153 30        Bill to Address
     C                     MOVEL*BLANK    WN0154 30        Bill to Address
     C                     MOVEL*BLANK    WN0155 20        Bill to City
     C                     MOVEL*BLANK    WN0156  2        Bill to State C
     C                     MOVEL*BLANK    WN0157 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0158 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0159  70       Order Date
     C                     Z-ADD*ZERO     WN0160  70       Requested Ship
     C                     Z-ADD*ZERO     WN0161  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0162  70       Cancel Date
     C                     MOVEL*BLANK    WN0163  2        Terms Code
     C                     MOVEL*BLANK    WN0164 40        Special Instruc
     C                     MOVEL*BLANK    WN0165 40        Special Instruc
     C                     MOVEL*BLANK    WN0166  3        Carrier Code
     C                     MOVEL*BLANK    WN0167  1        Comment Print A
     C                     MOVEL*BLANK    WN0168  1        Comment Print I
     C                     MOVEL*BLANK    WN0169  1        Comment Print P
     C                     MOVEL*BLANK    WN0170  1        Comment Print S
     C                     MOVEL*BLANK    WN0171  3        Reason Code
     C                     MOVEL*BLANK    WN0172  1        Order in Use
     C                     MOVEL*BLANK    WN0173  1        Header Status
     C                     MOVEL*BLANK    WN0174  1        Header Status L
     C                     MOVEL*BLANK    WN0175  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0176  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0177 10        User Original E
     C                     Z-ADD*ZERO     WN0178  70       Date of Origina
     C                     MOVEL*BLANK    WN0179  1        Credit Hold
     C                     MOVEL*BLANK    WN0180  1        Production Hold
     C                     MOVEL*BLANK    WN0181  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0182  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0183  40       Requested Deliv
     C                     MOVEL*BLANK    WN0184  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0185 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0186  70       Load ID
     C                     Z-ADD*ZERO     WN0187  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0188 112       Rated Freight
     C                     MOVEL*BLANK    WN0189  1        LTL Flag
     C                     MOVEL*BLANK    WN0190  1        Price Audit
     C                     MOVEL*BLANK    WN0191  1        Price Status
     C                     MOVEL*BLANK    WN0192  2        Shipping Method
     C                     MOVEL*BLANK    WN0193  1        Export Status
     C                     MOVEL*BLANK    WN0194  1        Palletize
     C                     MOVEL*BLANK    WN0195  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0196  1        Slip Sheet
     C                     MOVEL*BLANK    WN0197  1        Age Code
     C                     Z-ADD*ZERO     WN0198  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0199  1        Load Type
     C                     Z-ADD*ZERO     WN0200  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0201  1        Load Plan Order
     C                     MOVEL*BLANK    WN0202  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0203  70       Resell Referenc
     C                     MOVEL*BLANK    WN0204 30        Special Comment
     C                     MOVEL*BLANK    WN0205 30        Special Comment
     C                     MOVEL*BLANK    WN0206  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0207  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0208  2        Manager Level C
     C                     MOVEL*BLANK    WN0209  3        VP Level Code
     C                     Z-ADD*ZERO     WN0210  70       Attach to Order
     C                     MOVEL*BLANK    WN0211  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0212  70       Invoice Number
     C                     MOVEL*BLANK    WN0213  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0214  70       Invoice Date
     C                     MOVEL*BLANK    WN0215  2        Event Code
     C                     MOVEL*BLANK    WN0216  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0217  1        Modified Flag
     C                     Z-ADD*ZERO     WN0218 112       A_R order Value
     C                     MOVEL*BLANK    WN0219  1        Billing Activit
     C                     MOVEL*BLANK    WN0220  1        Block Order Fla
     C                     MOVEL*BLANK    WN0221  1        Order Certifica
     C                     Z-ADD*ZERO     WN0222 112       Invoice Order V
     C                     MOVEL*BLANK    WN0223  1        Process Sts for
     C                     MOVEL*BLANK    WN0224  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0225  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0226  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0227  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0228  1        Email Cust On O
     C                     MOVEL*BLANK    WN0229  1        Order Emailed
     C                     MOVEL*BLANK    WN0230  1        Export Docs Go
     C                     MOVEL*BLANK    WN0231  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0232  1        Broker Order St
     C                     MOVEL*BLANK    WN0233  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0234  2        Order Requires
     C                     MOVEL*BLANK    WN0235  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0236  2        Export USDA App
     C                     MOVEL*BLANK    WN0237  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0238  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0239  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0240  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0241  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0242  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0243  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0244  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0245  60       Time of Origina
     C                     Z-ADD*ZERO     WN0246  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0247  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0248  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0249 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0250 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0251 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0252 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0253 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0254  70       Claim Number
     C                     MOVEL*BLANK    WN0255  1        EDI Status 1
     C                     MOVEL*BLANK    WN0256  1        EDI Status 2
     C                     MOVEL*BLANK    WN0257  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0258  60       Job Time
     C                     MOVEL*BLANK    WN0259 10        User Id
     C                     MOVEL*BLANK    WN0260 10        Job Name
     C                     Z-ADD*ZERO     WN0261  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      *
     C           KLCHNA    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHNA    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD#1JZVA    BEJZVA           Order Value Tot
     C                     Z-ADD#1A1WG    BEA1WG           Order Weight To
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##PGM     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPCRC
     C                     Z-ADDBEAIC3    PCAIC3           Company Number
     C                     Z-ADDBEC4NB    PCC4NB           Order Number
     C                     MOVELBEJNCD    PCJNCD    P      Order Type_Sale
     C                     Z-ADDBEANC7    PCANC7           AR Customer Num
     C                     Z-ADDBEBKC7    PCBKC7           Ship To Custome
     C                     MOVELBEBRTX    PCBRTX    P      Ship To Name
     C                     MOVELBEHMNA    PCHMNA    P      Ship To Address
     C                     MOVELBEHONA    PCHONA    P      Ship To Address
     C                     MOVELBEHPNA    PCHPNA    P      Ship To Address
     C                     MOVELBEHNNA    PCHNNA    P      Ship To City
     C                     MOVELBEDBCD    PCDBCD    P      Ship To State C
     C                     MOVELBECKTX    PCCKTX    P      Ship To Zip_Pos
     C                     Z-ADDBEB0C7    PCB0C7           Bill to Custome
     C                     MOVELBEAETX    PCAETX    P      Bill to Name
     C                     MOVELBEB1NA    PCB1NA    P      Bill to Address
     C                     MOVELBEB3NA    PCB3NA    P      Bill to Address
     C                     MOVELBEB4NA    PCB4NA    P      Bill to Address
     C                     MOVELBEB2NA    PCB2NA    P      Bill to City
     C                     MOVELBEBHCD    PCBHCD    P      Bill to State C
     C                     MOVELBEC8TX    PCC8TX    P      Bill to Zip_Pos
     C                     MOVELBEBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDBEA0DT    PCA0DT           Order Date
     C                     Z-ADDBEA5DT    PCA5DT           Requested Ship
     C                     Z-ADDBEGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDBEACDT    PCACDT           Cancel Date
     C                     MOVELBEAQCD    PCAQCD    P      Terms Code
     C                     MOVELBEB6NA    PCB6NA    P      Special Instruc
     C                     MOVELBEBYNA    PCBYNA    P      Special Instruc
     C                     MOVELBEBZNA    PCBZNA    P      Carrier Code
     C                     MOVELBEGTST    PCGTST    P      Comment Print A
     C                     MOVELBEGVST    PCGVST    P      Comment Print I
     C                     MOVELBEGUST    PCGUST    P      Comment Print P
     C                     MOVELBEQFST    PCQFST    P      Comment Print S
     C                     MOVELBECQCD    PCCQCD    P      Reason Code
     C                     MOVELBEGJST    PCGJST    P      Order in Use
     C                     MOVELBEGWST    PCGWST    P      Header Status
     C                     MOVELBEGXST    PCGXST    P      Header Status L
     C                     MOVELBEGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDBEAODT    PCAODT           Scheduled Ship
     C                     MOVELBEAIVN    PCAIVN    P      User Original E
     C                     Z-ADDBECXDT    PCCXDT           Date of Origina
     C                     Z-ADDBEJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    PCA1WG           Order Weight To
     C                     MOVELBEXIST    PCXIST    P      Credit Hold
     C                     MOVELBEXJST    PCXJST    P      Production Hold
     C                     MOVELBEXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDBEEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    PCAFTM           Requested Deliv
     C                     MOVELBEE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELBEE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDBERMNB    PCRMNB           Load ID
     C                     Z-ADDBETBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    PCR1NB           Rated Freight
     C                     MOVELBEPJST    PCPJST    P      LTL Flag
     C                     MOVELBEU0ST    PCU0ST    P      Price Audit
     C                     MOVELBEU1ST    PCU1ST    P      Price Status
     C                     MOVELBEQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELBEU2ST    PCU2ST    P      Export Status
     C                     MOVELBEVEST    PCVEST    P      Palletize
     C                     MOVELBEVFST    PCVFST    P      Shrink Wrap
     C                     MOVELBEVGST    PCVGST    P      Slip Sheet
     C                     MOVELBERPCD    PCRPCD    P      Age Code
     C                     Z-ADDBERNNB    PCRNNB           Reefer Temperat
     C                     MOVELBEVDST    PCVDST    P      Load Type
     C                     Z-ADDBEATIN    PCATIN           Attach to Invoi
     C                     MOVELBEU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELBEU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDBERSRN    PCRSRN           Resell Referenc
     C                     MOVELBEMHNA    PCMHNA    P      Special Comment
     C                     MOVELBEMINA    PCMINA    P      Special Comment
     C                     MOVELBEWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELBER4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELBEBFCD    PCBFCD    P      Manager Level C
     C                     MOVELBEQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDBET3NB    PCT3NB           Attach to Order
     C                     MOVELBESICD    PCSICD    P      Reason for Pric
     C                     Z-ADDBECONB    PCCONB           Invoice Number
     C                     MOVELBECEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDBEAWDT    PCAWDT           Invoice Date
     C                     MOVELBEJPCD    PCJPCD    P      Event Code
     C                     MOVELBEXUST    PCXUST    P      Trans Contol AS
     C                     MOVELBEZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDBEVRVA    PCVRVA           A_R order Value
     C                     MOVELBEOBST    PCOBST    P      Billing Activit
     C                     MOVELBEBCST    PCBCST    P      Block Order Fla
     C                     MOVELBEBDST    PCBDST    P      Order Certifica
     C                     Z-ADDBEB7VL    PCB7VL           Invoice Order V
     C                     MOVELBEGASX    PCGASX    P      Process Sts for
     C                     MOVELBEGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELBEGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELBEGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELBEFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELBEFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELBEFPSX    PCFPSX    P      Order Emailed
     C                     MOVELBEFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELBEFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELBEFSSX    PCFSSX    P      Broker Order St
     C                     MOVELBEFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELBEFUSX    PCFUSX    P      Order Requires
     C                     MOVELBEFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELBEFWSX    PCFWSX    P      Export USDA App
     C                     MOVELBEFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELBEFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDBENODT    PCNODT           OH Appt Confirm
     C                     Z-ADDBENPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDBENRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDBENSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    PCBQTM           Time of Origina
     C                     Z-ADDBEBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    PCH1NX           Act Non_Ref Frt
     C                     Z-ADDBEH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    PCH3NX           OH Total Non_Re
     C                     Z-ADDBEH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    PCC0C7           Claim Number
     C                     MOVELBEUVST    PCUVST    P      EDI Status 1
     C                     MOVELBEUWST    PCUWST    P      EDI Status 2
     C                     MOVELBEUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDBEAATM    PCAATM           Job Time
     C                     MOVELBEAYNA    PCAYNA    P      User Id
     C                     MOVELBEA0NA    PCA0NA    P      Job Name
     C                     Z-ADDBEAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBCHRC    BEGSR
      *================================================================
      * CHG Ord Req's Rvw-JCO  CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0262  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0263  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0264  70       Ship To Custome
     C                     MOVEL*BLANK    WN0265 30        Ship To Name
     C                     MOVEL*BLANK    WN0266 30        Ship To Address
     C                     MOVEL*BLANK    WN0267 30        Ship To Address
     C                     MOVEL*BLANK    WN0268 30        Ship To Address
     C                     MOVEL*BLANK    WN0269 20        Ship To City
     C                     MOVEL*BLANK    WN0270  2        Ship To State C
     C                     MOVEL*BLANK    WN0271 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0272  70       Bill to Custome
     C                     MOVEL*BLANK    WN0273 30        Bill to Name
     C                     MOVEL*BLANK    WN0274 30        Bill to Address
     C                     MOVEL*BLANK    WN0275 30        Bill to Address
     C                     MOVEL*BLANK    WN0276 30        Bill to Address
     C                     MOVEL*BLANK    WN0277 20        Bill to City
     C                     MOVEL*BLANK    WN0278  2        Bill to State C
     C                     MOVEL*BLANK    WN0279 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0280 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0281  70       Order Date
     C                     Z-ADD*ZERO     WN0282  70       Requested Ship
     C                     Z-ADD*ZERO     WN0283  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0284  70       Cancel Date
     C                     MOVEL*BLANK    WN0285  2        Terms Code
     C                     MOVEL*BLANK    WN0286 40        Special Instruc
     C                     MOVEL*BLANK    WN0287 40        Special Instruc
     C                     MOVEL*BLANK    WN0288  3        Carrier Code
     C                     MOVEL*BLANK    WN0289  1        Comment Print A
     C                     MOVEL*BLANK    WN0290  1        Comment Print I
     C                     MOVEL*BLANK    WN0291  1        Comment Print P
     C                     MOVEL*BLANK    WN0292  1        Comment Print S
     C                     MOVEL*BLANK    WN0293  3        Reason Code
     C                     MOVEL*BLANK    WN0294  1        Order in Use
     C                     MOVEL*BLANK    WN0295  1        Header Status
     C                     MOVEL*BLANK    WN0296  1        Header Status L
     C                     MOVEL*BLANK    WN0297  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0298  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0299 10        User Original E
     C                     Z-ADD*ZERO     WN0300  70       Date of Origina
     C                     Z-ADD*ZERO     WN0301 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0302 112       Order Weight To
     C                     MOVEL*BLANK    WN0303  1        Credit Hold
     C                     MOVEL*BLANK    WN0304  1        Production Hold
     C                     MOVEL*BLANK    WN0305  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0306  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0307  40       Requested Deliv
     C                     MOVEL*BLANK    WN0308  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0309 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0310  70       Load ID
     C                     Z-ADD*ZERO     WN0311  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0312 112       Rated Freight
     C                     MOVEL*BLANK    WN0313  1        LTL Flag
     C                     MOVEL*BLANK    WN0314  1        Price Audit
     C                     MOVEL*BLANK    WN0315  1        Price Status
     C                     MOVEL*BLANK    WN0316  2        Shipping Method
     C                     MOVEL*BLANK    WN0317  1        Export Status
     C                     MOVEL*BLANK    WN0318  1        Palletize
     C                     MOVEL*BLANK    WN0319  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0320  1        Slip Sheet
     C                     MOVEL*BLANK    WN0321  1        Age Code
     C                     Z-ADD*ZERO     WN0322  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0323  1        Load Type
     C                     Z-ADD*ZERO     WN0324  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0325  1        Load Plan Order
     C                     MOVEL*BLANK    WN0326  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0327  70       Resell Referenc
     C                     MOVEL*BLANK    WN0328 30        Special Comment
     C                     MOVEL*BLANK    WN0329 30        Special Comment
     C                     MOVEL*BLANK    WN0330  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0331  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0332  2        Manager Level C
     C                     MOVEL*BLANK    WN0333  3        VP Level Code
     C                     Z-ADD*ZERO     WN0334  70       Attach to Order
     C                     MOVEL*BLANK    WN0335  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0336  70       Invoice Number
     C                     MOVEL*BLANK    WN0337  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0338  70       Invoice Date
     C                     MOVEL*BLANK    WN0339  2        Event Code
     C                     MOVEL*BLANK    WN0340  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0341  1        Modified Flag
     C                     Z-ADD*ZERO     WN0342 112       A_R order Value
     C                     MOVEL*BLANK    WN0343  1        Billing Activit
     C                     MOVEL*BLANK    WN0344  1        Block Order Fla
     C                     MOVEL*BLANK    WN0345  1        Order Certifica
     C                     Z-ADD*ZERO     WN0346 112       Invoice Order V
     C                     MOVEL*BLANK    WN0347  1        Process Sts for
     C                     MOVEL*BLANK    WN0348  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0349  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0350  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0351  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0352  1        Email Cust On O
     C                     MOVEL*BLANK    WN0353  1        Order Emailed
     C                     MOVEL*BLANK    WN0354  1        Export Docs Go
     C                     MOVEL*BLANK    WN0355  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0356  1        Broker Order St
     C                     MOVEL*BLANK    WN0357  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0358  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0359  2        Export USDA App
     C                     MOVEL*BLANK    WN0360  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0361  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0362  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0363  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0364  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0365  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0366  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0367  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0368  60       Time of Origina
     C                     Z-ADD*ZERO     WN0369  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0370  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0371  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0372 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0373 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0374 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0375 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0376 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0377  70       Claim Number
     C                     MOVEL*BLANK    WN0378  1        EDI Status 1
     C                     MOVEL*BLANK    WN0379  1        EDI Status 2
     C                     MOVEL*BLANK    WN0380  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0381  60       Job Time
     C                     MOVEL*BLANK    WN0382 10        User Id
     C                     MOVEL*BLANK    WN0383 10        Job Name
     C                     Z-ADD*ZERO     WN0384  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      *
     C           KLCHNB    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHNB    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YDRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL#1FUSX    BEFUSX    P      Order Requires
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * ** Chg line status to Entered when errors so Order will be review
     C                     MOVEL'E'       BEGWST           Header Status
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * CHG Export Code        RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQNC01           Company Number
     C           *LIKE     DEFN WAC4NB    WQNC02           Order Number
      * Define keylist
     C           KPSNC     KLIST
     C                     KFLD           WQNC01           Company Number
     C                     KFLD           WQNC02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC01           Company Number
     C                     KFLD           WQNC02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQNC01           Company Number
     C                     Z-ADD#1C4NB    WQNC02           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
      * Establish starting position
     C           KPSNC     SETLL@BGWKKK                    *
     C           KRSNC     READE@BGWKKK                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Export Code        CH - PD Order Detail  * 
     C                     EXSR NDCHRC
     C           KRSNC     READE@BGWKKK                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDCHRC    BEGSR
      *================================================================
      * CHG Export Code        CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0385  70       Item Code
     C                     MOVEL*BLANK    WN0386  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0387  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0388  70       Order Group Cod
     C                     MOVEL*BLANK    WN0389  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0390  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0391 112       Billing Detail
     C                     Z-ADD*ZERO     WN0392 112       Billing Detail
     C                     Z-ADD*ZERO     WN0393 112       Billing Detail
     C                     Z-ADD*ZERO     WN0394 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0395  1        Comment Print A
     C                     MOVEL*BLANK    WN0396  1        Comment Print I
     C                     MOVEL*BLANK    WN0397  1        Comment Print P
     C                     MOVEL*BLANK    WN0398  1        Comment Print S
     C                     Z-ADD*ZERO     WN0399 112       Extended Amount
     C                     Z-ADD*ZERO     WN0400  70       Market Pricing
     C                     MOVEL*BLANK    WN0401  3        Commodity Marke
     C                     MOVEL*BLANK    WN0402  3        Date Method Cod
     C                     MOVEL*BLANK    WN0403  3        Price Method Co
     C                     Z-ADD*ZERO     WN0404 114       Price Overage O
     C                     Z-ADD*ZERO     WN0405  70       Contract Number
     C                     MOVEL*BLANK    WN0406  1        Price Status
     C                     Z-ADD*ZERO     WN0407  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0408  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0409  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0410  1        Work Confirm St
     C                     MOVEL*BLANK    WN0411  1        Work Over_Short
     C                     MOVEL*BLANK    WN0412  1        OD Production P
     C                     MOVEL*BLANK    WN0413 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0414 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0415  1        Age Code
     C                     MOVEL*BLANK    WN0416  1        Palletize
     C                     MOVEL*BLANK    WN0417  1        Slip Sheet
     C                     MOVEL*BLANK    WN0418  1        Catch Weight St
     C                     MOVEL*BLANK    WN0419  1        Price Audit
     C                     MOVEL*BLANK    WN0420  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0421  1        Production Date
     C                     Z-ADD*ZERO     WN0422 112       Rated Freight
     C                     Z-ADD*ZERO     WN0423 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0424 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0425 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0426 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0427 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0428 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0429 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0430 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0431 114       Unit Price
     C                     Z-ADD*ZERO     WN0432 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0433 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0434 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0435 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0436  70       Requested Ship
     C                     Z-ADD*ZERO     WN0437  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0438  70       Actual Shipped
     C                     MOVEL*BLANK    WN0439  1        Affect Inventor
     C                     MOVEL*BLANK    WN0440  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0441  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0442  30       Item Structure
     C                     Z-ADD*ZERO     WN0443  30       Item Structure
     C                     Z-ADD*ZERO     WN0444  30       Item Structure
     C                     MOVEL*BLANK    WN0445  2        Item Level
     C                     MOVEL*BLANK    WN0446  2        Quality Level
     C                     MOVEL*BLANK    WN0447  2        Pricing Product
     C                     MOVEL*BLANK    WN0448  2        Season Product
     C                     Z-ADD*ZERO     WN0449  70       Date of Origina
     C                     MOVEL*BLANK    WN0450 10        User Profile Na
     C                     MOVEL*BLANK    WN0451  2        Event Code
     C                     MOVEL*BLANK    WN0452  3        Reason Code
     C                     MOVEL*BLANK    WN0453  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0454  1        Modified Flag
     C                     MOVEL*BLANK    WN0455  1        Substituted Fla
     C                     MOVEL*BLANK    WN0456  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0457 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0458 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0459  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0460  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0461  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0462  1        Affect Commissi
     C                     MOVEL*BLANK    WN0463  1        Affect Pricing
     C                     MOVEL*BLANK    WN0464  1        Released by Use
     C                     MOVEL*BLANK    WN0465  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0466  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0467  3        Production Ware
     C                     MOVEL*BLANK    WN0468  3        OD Price Type
     C                     Z-ADD*ZERO     WN0469  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0470  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0471  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0472  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0473  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0474  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0475  60       Price Code
     C                     Z-ADD*ZERO     WN0476  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0477  60       Substitution Li
     C                     Z-ADD*ZERO     WN0478  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0479 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0480 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0481 112       OD Item Target
     C                     Z-ADD*ZERO     WN0482 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0483 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0484 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0485 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0486 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0487 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0488 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0489 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0490 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0491 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0492  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0493  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0494  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0495 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0496  40       Item Age Days
     C                     Z-ADD*ZERO     WN0497  70       Production Ovr
     C                     Z-ADD*ZERO     WN0498  70       Production Ovr
     C                     MOVEL*BLANK    WN0499  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0500  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0501  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0502  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0503  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0504  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0505  1        EDI Status 1
     C                     MOVEL*BLANK    WN0506  1        EDI Status 2
     C                     MOVEL*BLANK    WN0507  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0508  60       Job Time
     C                     MOVEL*BLANK    WN0509 10        User Id
     C                     MOVEL*BLANK    WN0510 10        Job Name
     C                     Z-ADD*ZERO     WN0511  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWAAIC3    WTAIC3           Company Number
     C                     Z-ADDWAC4NB    WTC4NB           Order Number
     C                     Z-ADDWADPNB    WTDPNB           Order Sequence
     C                     Z-ADDWAUENB    WTUENB           Order Secondary
      *
     C           KLCHND    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTC4NB           Order Number
     C                     KFLD           WTDPNB           Order Sequence
     C                     KFLD           WTUENB           Order Secondary
     C           KLCHND    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YERDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#DKXCD    WTKXCD    P      Country Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##JOB     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * Rtv Min Temp for Load RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     Z-ADD-99       WUPCNX           USR Temperature
     C                     MOVELWUOTTX    WUFRSX           Shipping Temp C
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQNE02           Load ID
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WQNE02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQNE02           Load ID
      * Establish starting position
     C           KRSNE     SETLL@BFCPD9                    *
     C           KRSNE     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * **** new 7/19/02
      * If db1 doesnt match par, convert db1 temp to par temp C or F
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Shipping Temp Code C/F NE WRK.Blank for 4
      *   |- c2    : PAR.Shipping Temp Code C/F NE DB1.Shipping Temp Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUFRSX    IFNE WUOTTX                     *IF
     C           WUFRSX    IFNE WIFRSX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Shipping Temp Code C/F is Celsius
     C           WUFRSX    IFEQ 'C'                        *IF
      * Convert DB1 to Celsius
      * Compute Cels from Fahr
      * LCL.USR Temperature 3.1 =
      *    *COMPUTE (((x1 - x2) * x3) / x4)
      * x1    : DB1.Reefer Temperature
      * -     : PGM.*Synon (17,7) work field
      * x2    : CON.32
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.5
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.9
     C           WIRNNB    SUB  32        W0WD02           *Synon (17,7) w
     C           W0WD02    MULT 5         W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  9         W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0060           USR Temperature
     C                     ELSE
      * CASE: *OTHERWISE
      * Convert DB1 to Fahr
      * Compute Fahr from Cels
      * LCL.USR Temperature 3.1 =
      *    *COMPUTE (((x1 * x3) / x4) + x2)
      * x1    : DB1.Reefer Temperature
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.9
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.5
      * +     : PGM.*Synon (17,7) work field
      * x2    : CON.32
     C           WIRNNB    MULT 9         W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  5         W0WD01    H      *Synon (17,7) w
     C           W0WD01    ADD  32        W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0060           USR Temperature
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWIRNNB    YL0060           USR Temperature
     C                     END                             *FI
      * CASE: LCL.USR Temperature 3.1 GT PAR.USR Temperature 3.1
     C           YL0060    IFGT WUPCNX                     *IF
     C                     Z-ADDWIRNNB    WUPCNX           USR Temperature
     C                     MOVELWIFRSX    WUFRSX           Shipping Temp C
     C                     END                             *FI
     C           KRSNE     READE@BFCPD9                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Temperature 3.1 is Low
     C           WUPCNX    IFEQ -99                        *IF
     C                     Z-ADD*ZERO     WUPCNX           USR Temperature
     C                     END                             *FI
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFCHRC    BEGSR
      *================================================================
      * CHG Shipping Temp      CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0512  30       Company Number
     C                     Z-ADD*ZERO     WN0513  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0514  1        LTL Flag
     C                     MOVEL*BLANK    WN0515  1        Load Status
     C                     MOVEL*BLANK    WN0516 15        Seal 1
     C                     MOVEL*BLANK    WN0517 15        Seal 2
     C                     MOVEL*BLANK    WN0518 15        Seal 3
     C                     MOVEL*BLANK    WN0519 15        Seal 4
     C                     MOVEL*BLANK    WN0520 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0521  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0522 112       Flat Amount
     C                     MOVEL*BLANK    WN0523  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0524  50       Total Stops
     C                     MOVEL*BLANK    WN0525 20        Trailer Id
     C                     MOVEL*BLANK    WN0526  3        Transloader Car
     C                     Z-ADD*ZERO     WN0527  40       BOL Time
     C                     MOVEL*BLANK    WN0528  3        Carrier Code
     C                     MOVEL*BLANK    WN0529  7        Truck Size
     C                     Z-ADD*ZERO     WN0530  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0531 112       Rated Freight
     C                     MOVEL*BLANK    WN0532  1        Ship Status
     C                     MOVEL*BLANK    WN0533  1        Load Type
     C                     Z-ADD*ZERO     WN0534  50       Number Pallets
     C                     Z-ADD*ZERO     WN0535  50       Number Pallets
     C                     Z-ADD*ZERO     WN0536 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0537  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0538  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0539  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0540 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0541 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0542  70       Actual Departur
     C                     Z-ADD*ZERO     WN0543  40       Departure Time
     C                     Z-ADD*ZERO     WN0544  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0545  52       Product Tempera
     C                     Z-ADD*ZERO     WN0546  50       Number Spacers
     C                     MOVEL*BLANK    WN0547 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0548  70       Total Load Mile
     C                     MOVEL*BLANK    WN0549 12        Recorder ID
     C                     MOVEL*BLANK    WN0550  2        Shipping Method
     C                     MOVEL*BLANK    WN0551  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0552  2        Ship To State C
     C                     Z-ADD*ZERO     WN0553  70       Gross Weight
     C                     MOVEL*BLANK    WN0554  3        Carrier Broker
     C                     MOVEL*BLANK    WN0555  1        Export Status
     C                     Z-ADD*ZERO     WN0556  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0557  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0558  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0559  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0560  70       Spotted Date
     C                     Z-ADD*ZERO     WN0561  60       Spotted Time
     C                     Z-ADD*ZERO     WN0562  70       Load Finished D
     C                     Z-ADD*ZERO     WN0563  60       Load Finished T
     C                     Z-ADD*ZERO     WN0564  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0565  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0566  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0567  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0568  70       Truck Departure
     C                     Z-ADD*ZERO     WN0569  60       Truck Departure
     C                     Z-ADD*ZERO     WN0570  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0571  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0572  3        Shipping Line
     C                     MOVEL*BLANK    WN0573 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0574 30        Vessel Name
     C                     Z-ADD*ZERO     WN0575  50       Voyage
     C                     Z-ADD*ZERO     WN0576  70       Sail Date
     C                     MOVEL*BLANK    WN0577 12        Booking Number
     C                     MOVEL*BLANK    WN0578 20        Discharge Port
     C                     Z-ADD*ZERO     WN0579  70       Arrival Date
     C                     MOVEL*BLANK    WN0580 12        Container Numbe
     C                     Z-ADD*ZERO     WN0581  70       Date In
     C                     Z-ADD*ZERO     WN0582  60       Time In
     C                     Z-ADD*ZERO     WN0583  70       Date Out
     C                     Z-ADD*ZERO     WN0584  60       Time Out
     C                     Z-ADD*ZERO     WN0585 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0586  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0587  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0588  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0589  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0590  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0591  70       Requested Deliv
     C                     MOVEL*BLANK    WN0592  1        Load Acceptance
     C                     MOVEL*BLANK    WN0593  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0594  70       On Yard Date
     C                     Z-ADD*ZERO     WN0595  60       On Yard Time
     C                     Z-ADD*ZERO     WN0596  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0597  60       Deadline Depart
     C                     MOVEL*BLANK    WN0598  1        Load Held Over
     C                     MOVEL*BLANK    WN0599  1        Load Held Over
     C                     MOVEL*BLANK    WN0600 15        Load Held Over
     C                     MOVEL*BLANK    WN0601 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0602 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0603  70       Express Mail Da
     C                     MOVEL*BLANK    WN0604  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0605  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0606  70       Product Complet
     C                     Z-ADD*ZERO     WN0607  60       Product Complet
     C                     Z-ADD*ZERO     WN0608  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0609  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0610  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0611  1        Load Confirmed
     C                     MOVEL*BLANK    WN0612 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0613  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0614  60       Load Door 1
     C                     Z-ADD*ZERO     WN0615  70       Override Total
     C                     Z-ADD*ZERO     WN0616  60       Load Door 2
     C                     MOVEL*BLANK    WN0617  1        Partial Load
     C                     MOVEL*BLANK    WN0618  1        Load Confirmati
     C                     MOVEL*BLANK    WN0619  1        Export Load USD
     C                     MOVEL*BLANK    WN0620  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0621 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0622 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0623 15        Late Billing Em
     C                     MOVEL*BLANK    WN0624 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0625  1        Multi Company L
     C                     MOVEL*BLANK    WN0626  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0627  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0628  1        LH Power Only L
     C                     MOVEL*BLANK    WN0629  1        MG Created Load
     C                     MOVEL*BLANK    WN0630  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0631  2        Load U_M
     C                     MOVEL*BLANK    WN0632  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0633  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0634  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0635  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0636  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0637  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0638  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0639  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0640  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0641  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0642  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0643  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0644  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0645  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0646  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0647  60       LH Unused Time
     C                     MOVEL*BLANK    WN0648  1        EDI Status 1
     C                     MOVEL*BLANK    WN0649  1        EDI Status 2
     C                     MOVEL*BLANK    WN0650  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0651  60       Job Time
     C                     MOVEL*BLANK    WN0652 10        User Id
     C                     MOVEL*BLANK    WN0653 10        Job Name
     C                     Z-ADD*ZERO     WN0654  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WJRMNB           Load ID
      *
     C           KLCHNF    KLIST
     C                     KFLD           WJRMNB           Load ID
     C           KLCHNF    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YFRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWUPCNX    WJRNNB           Reefer Temperat
     C                     MOVELWUFRSX    WJWRTX    P      Shipping Temp C
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGCHRC    BEGSR
      *================================================================
      * CHG Carrier/Broker     CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0655  30       Company Number
     C                     Z-ADD*ZERO     WN0656  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0657  1        LTL Flag
     C                     MOVEL*BLANK    WN0658  1        Load Status
     C                     Z-ADD*ZERO     WN0659  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0660 15        Seal 1
     C                     MOVEL*BLANK    WN0661 15        Seal 2
     C                     MOVEL*BLANK    WN0662 15        Seal 3
     C                     MOVEL*BLANK    WN0663 15        Seal 4
     C                     MOVEL*BLANK    WN0664 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0665  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0666 112       Flat Amount
     C                     MOVEL*BLANK    WN0667  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0668  50       Total Stops
     C                     MOVEL*BLANK    WN0669 20        Trailer Id
     C                     MOVEL*BLANK    WN0670  3        Transloader Car
     C                     Z-ADD*ZERO     WN0671  40       BOL Time
     C                     MOVEL*BLANK    WN0672  7        Truck Size
     C                     Z-ADD*ZERO     WN0673  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0674 112       Rated Freight
     C                     MOVEL*BLANK    WN0675  1        Ship Status
     C                     MOVEL*BLANK    WN0676  1        Load Type
     C                     Z-ADD*ZERO     WN0677  50       Number Pallets
     C                     Z-ADD*ZERO     WN0678  50       Number Pallets
     C                     Z-ADD*ZERO     WN0679 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0680  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0681  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0682  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0683 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0684 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0685  70       Actual Departur
     C                     Z-ADD*ZERO     WN0686  40       Departure Time
     C                     Z-ADD*ZERO     WN0687  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0688  52       Product Tempera
     C                     Z-ADD*ZERO     WN0689  50       Number Spacers
     C                     MOVEL*BLANK    WN0690 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0691  70       Total Load Mile
     C                     MOVEL*BLANK    WN0692 12        Recorder ID
     C                     MOVEL*BLANK    WN0693  2        Shipping Method
     C                     MOVEL*BLANK    WN0694  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0695  2        Ship To State C
     C                     Z-ADD*ZERO     WN0696  70       Gross Weight
     C                     MOVEL*BLANK    WN0697  1        Export Status
     C                     Z-ADD*ZERO     WN0698  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0699  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0700  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0701  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0702  70       Spotted Date
     C                     Z-ADD*ZERO     WN0703  60       Spotted Time
     C                     Z-ADD*ZERO     WN0704  70       Load Finished D
     C                     Z-ADD*ZERO     WN0705  60       Load Finished T
     C                     Z-ADD*ZERO     WN0706  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0707  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0708  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0709  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0710  70       Truck Departure
     C                     Z-ADD*ZERO     WN0711  60       Truck Departure
     C                     Z-ADD*ZERO     WN0712  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0713  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0714  3        Shipping Line
     C                     MOVEL*BLANK    WN0715 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0716 30        Vessel Name
     C                     Z-ADD*ZERO     WN0717  50       Voyage
     C                     Z-ADD*ZERO     WN0718  70       Sail Date
     C                     MOVEL*BLANK    WN0719 12        Booking Number
     C                     MOVEL*BLANK    WN0720 20        Discharge Port
     C                     Z-ADD*ZERO     WN0721  70       Arrival Date
     C                     MOVEL*BLANK    WN0722 12        Container Numbe
     C                     Z-ADD*ZERO     WN0723  70       Date In
     C                     Z-ADD*ZERO     WN0724  60       Time In
     C                     Z-ADD*ZERO     WN0725  70       Date Out
     C                     Z-ADD*ZERO     WN0726  60       Time Out
     C                     Z-ADD*ZERO     WN0727 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0728  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0729  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0730  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0731  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0732  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0733  70       Requested Deliv
     C                     MOVEL*BLANK    WN0734  1        Load Acceptance
     C                     MOVEL*BLANK    WN0735  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0736  70       On Yard Date
     C                     Z-ADD*ZERO     WN0737  60       On Yard Time
     C                     Z-ADD*ZERO     WN0738  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0739  60       Deadline Depart
     C                     MOVEL*BLANK    WN0740  1        Load Held Over
     C                     MOVEL*BLANK    WN0741  1        Load Held Over
     C                     MOVEL*BLANK    WN0742 15        Load Held Over
     C                     MOVEL*BLANK    WN0743 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0744 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0745  70       Express Mail Da
     C                     MOVEL*BLANK    WN0746  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0747  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0748  70       Product Complet
     C                     Z-ADD*ZERO     WN0749  60       Product Complet
     C                     Z-ADD*ZERO     WN0750  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0751  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0752  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0753  1        Load Confirmed
     C                     MOVEL*BLANK    WN0754 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0755  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0756  60       Load Door 1
     C                     Z-ADD*ZERO     WN0757  70       Override Total
     C                     Z-ADD*ZERO     WN0758  60       Load Door 2
     C                     MOVEL*BLANK    WN0759  1        Partial Load
     C                     MOVEL*BLANK    WN0760  1        Load Confirmati
     C                     MOVEL*BLANK    WN0761  1        Export Load USD
     C                     MOVEL*BLANK    WN0762  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0763 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0764 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0765 15        Late Billing Em
     C                     MOVEL*BLANK    WN0766 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0767 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0768  1        Multi Company L
     C                     MOVEL*BLANK    WN0769  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0770  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0771  1        LH Power Only L
     C                     MOVEL*BLANK    WN0772  1        MG Created Load
     C                     MOVEL*BLANK    WN0773  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0774  2        Load U_M
     C                     MOVEL*BLANK    WN0775  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0776  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0777  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0778  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0779  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0780  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0781  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0782  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0783  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0784  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0785  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0786  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0787  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0788  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0789  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0790  60       LH Unused Time
     C                     MOVEL*BLANK    WN0791  1        EDI Status 1
     C                     MOVEL*BLANK    WN0792  1        EDI Status 2
     C                     MOVEL*BLANK    WN0793  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0794  60       Job Time
     C                     MOVEL*BLANK    WN0795 10        User Id
     C                     MOVEL*BLANK    WN0796 10        Job Name
     C                     Z-ADD*ZERO     WN0797  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0087    WJRMNB           Load ID
      *
     C           KLCHNG    KLIST
     C                     KFLD           WJRMNB           Load ID
     C           KLCHNG    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YGRDCS
      * USER: Processing after Data read
      * Save copy of fields written to Load Order Change Log
      * CASE: *OTHERWISE
     C                     MOVELWJBZNA    YL0062           Carrier Code
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0088    WJBZNA    P      Carrier Code
     C                     MOVELWL0089    WJXCCD    P      Carrier Broker
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Check for carrier change for Load Order Header Change Log
      * CASE: *OTHERWISE
      * 09/18/2014 change to put *USER into user instead of *JOB
      * 10/17/2007 change to put in the job user and job program name
      * Carrier Code
      * CASE: PAR.Carrier Code NE LCL.Carrier Code
     C           WL0088    IFNE YL0062                     *IF
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADDWJRMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop_Drop
     C                     MOVEL'CARCHG'  PDRVST    P      Load Change Typ
     C                     MOVELWL0091    PDUJST    P      Department Cont
     C                     MOVELYL0062    PDMNTX    P      Change Log Prio
     C                     MOVELWL0088    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVELWJBZNA    PDBZNA    P      Carrier Code
     C                     Z-ADDWJAIC3    PDAIC3           Company Number
     C                     Z-ADDWL0090    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHCHRC    BEGSR
      *================================================================
      * CHG Ship Method        CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0798  30       Company Number
     C                     Z-ADD*ZERO     WN0799  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0800  1        LTL Flag
     C                     MOVEL*BLANK    WN0801  1        Load Status
     C                     Z-ADD*ZERO     WN0802  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0803 15        Seal 1
     C                     MOVEL*BLANK    WN0804 15        Seal 2
     C                     MOVEL*BLANK    WN0805 15        Seal 3
     C                     MOVEL*BLANK    WN0806 15        Seal 4
     C                     MOVEL*BLANK    WN0807 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0808  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0809 112       Flat Amount
     C                     MOVEL*BLANK    WN0810  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0811  50       Total Stops
     C                     MOVEL*BLANK    WN0812 20        Trailer Id
     C                     MOVEL*BLANK    WN0813  3        Transloader Car
     C                     Z-ADD*ZERO     WN0814  40       BOL Time
     C                     MOVEL*BLANK    WN0815  3        Carrier Code
     C                     MOVEL*BLANK    WN0816  7        Truck Size
     C                     Z-ADD*ZERO     WN0817  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0818 112       Rated Freight
     C                     MOVEL*BLANK    WN0819  1        Ship Status
     C                     MOVEL*BLANK    WN0820  1        Load Type
     C                     Z-ADD*ZERO     WN0821  50       Number Pallets
     C                     Z-ADD*ZERO     WN0822  50       Number Pallets
     C                     Z-ADD*ZERO     WN0823 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0824  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0825  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0826  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0827 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0828 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0829  70       Actual Departur
     C                     Z-ADD*ZERO     WN0830  40       Departure Time
     C                     Z-ADD*ZERO     WN0831  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0832  52       Product Tempera
     C                     Z-ADD*ZERO     WN0833  50       Number Spacers
     C                     MOVEL*BLANK    WN0834 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0835  70       Total Load Mile
     C                     MOVEL*BLANK    WN0836 12        Recorder ID
     C                     MOVEL*BLANK    WN0837  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0838  2        Ship To State C
     C                     Z-ADD*ZERO     WN0839  70       Gross Weight
     C                     MOVEL*BLANK    WN0840  3        Carrier Broker
     C                     MOVEL*BLANK    WN0841  1        Export Status
     C                     Z-ADD*ZERO     WN0842  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0843  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0844  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0845  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0846  70       Spotted Date
     C                     Z-ADD*ZERO     WN0847  60       Spotted Time
     C                     Z-ADD*ZERO     WN0848  70       Load Finished D
     C                     Z-ADD*ZERO     WN0849  60       Load Finished T
     C                     Z-ADD*ZERO     WN0850  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0851  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0852  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0853  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0854  70       Truck Departure
     C                     Z-ADD*ZERO     WN0855  60       Truck Departure
     C                     Z-ADD*ZERO     WN0856  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0857  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0858  3        Shipping Line
     C                     MOVEL*BLANK    WN0859 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0860 30        Vessel Name
     C                     Z-ADD*ZERO     WN0861  50       Voyage
     C                     Z-ADD*ZERO     WN0862  70       Sail Date
     C                     MOVEL*BLANK    WN0863 12        Booking Number
     C                     MOVEL*BLANK    WN0864 20        Discharge Port
     C                     Z-ADD*ZERO     WN0865  70       Arrival Date
     C                     MOVEL*BLANK    WN0866 12        Container Numbe
     C                     Z-ADD*ZERO     WN0867  70       Date In
     C                     Z-ADD*ZERO     WN0868  60       Time In
     C                     Z-ADD*ZERO     WN0869  70       Date Out
     C                     Z-ADD*ZERO     WN0870  60       Time Out
     C                     Z-ADD*ZERO     WN0871 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0872  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0873  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0874  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0875  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0876  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0877  70       Requested Deliv
     C                     MOVEL*BLANK    WN0878  1        Load Acceptance
     C                     MOVEL*BLANK    WN0879  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0880  70       On Yard Date
     C                     Z-ADD*ZERO     WN0881  60       On Yard Time
     C                     Z-ADD*ZERO     WN0882  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0883  60       Deadline Depart
     C                     MOVEL*BLANK    WN0884  1        Load Held Over
     C                     MOVEL*BLANK    WN0885  1        Load Held Over
     C                     MOVEL*BLANK    WN0886 15        Load Held Over
     C                     MOVEL*BLANK    WN0887 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0888 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0889  70       Express Mail Da
     C                     MOVEL*BLANK    WN0890  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0891  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0892  70       Product Complet
     C                     Z-ADD*ZERO     WN0893  60       Product Complet
     C                     Z-ADD*ZERO     WN0894  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0895  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0896  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0897  1        Load Confirmed
     C                     MOVEL*BLANK    WN0898 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0899  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0900  60       Load Door 1
     C                     Z-ADD*ZERO     WN0901  70       Override Total
     C                     Z-ADD*ZERO     WN0902  60       Load Door 2
     C                     MOVEL*BLANK    WN0903  1        Partial Load
     C                     MOVEL*BLANK    WN0904  1        Load Confirmati
     C                     MOVEL*BLANK    WN0905  1        Export Load USD
     C                     MOVEL*BLANK    WN0906  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0907 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0908 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0909 15        Late Billing Em
     C                     MOVEL*BLANK    WN0910 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0911 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0912  1        Multi Company L
     C                     MOVEL*BLANK    WN0913  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0914  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0915  1        LH Power Only L
     C                     MOVEL*BLANK    WN0916  1        MG Created Load
     C                     MOVEL*BLANK    WN0917  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0918  2        Load U_M
     C                     MOVEL*BLANK    WN0919  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0920  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0921  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0922  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0923  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0924  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0925  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0926  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0927  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0928  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0929  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0930  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0931  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0932  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0933  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0934  60       LH Unused Time
     C                     MOVEL*BLANK    WN0935  1        EDI Status 1
     C                     MOVEL*BLANK    WN0936  1        EDI Status 2
     C                     MOVEL*BLANK    WN0937  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0938  60       Job Time
     C                     MOVEL*BLANK    WN0939 10        User Id
     C                     MOVEL*BLANK    WN0940 10        Job Name
     C                     Z-ADD*ZERO     WN0941  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0092    WJRMNB           Load ID
      *
     C           KLCHNH    KLIST
     C                     KFLD           WJRMNB           Load ID
     C           KLCHNH    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YHRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0093    WJQ2CD    P      Shipping Method
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NICHRC    BEGSR
      *================================================================
      * CHG Load Acceptance Sw CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0942  30       Company Number
     C                     Z-ADD*ZERO     WN0943  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0944  1        LTL Flag
     C                     MOVEL*BLANK    WN0945  1        Load Status
     C                     Z-ADD*ZERO     WN0946  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0947 15        Seal 1
     C                     MOVEL*BLANK    WN0948 15        Seal 2
     C                     MOVEL*BLANK    WN0949 15        Seal 3
     C                     MOVEL*BLANK    WN0950 15        Seal 4
     C                     MOVEL*BLANK    WN0951 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0952  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0953 112       Flat Amount
     C                     MOVEL*BLANK    WN0954  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0955  50       Total Stops
     C                     MOVEL*BLANK    WN0956 20        Trailer Id
     C                     MOVEL*BLANK    WN0957  3        Transloader Car
     C                     Z-ADD*ZERO     WN0958  40       BOL Time
     C                     MOVEL*BLANK    WN0959  3        Carrier Code
     C                     MOVEL*BLANK    WN0960  7        Truck Size
     C                     Z-ADD*ZERO     WN0961  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0962 112       Rated Freight
     C                     MOVEL*BLANK    WN0963  1        Ship Status
     C                     MOVEL*BLANK    WN0964  1        Load Type
     C                     Z-ADD*ZERO     WN0965  50       Number Pallets
     C                     Z-ADD*ZERO     WN0966  50       Number Pallets
     C                     Z-ADD*ZERO     WN0967 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0968  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0969  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0970  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0971 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0972 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0973  70       Actual Departur
     C                     Z-ADD*ZERO     WN0974  40       Departure Time
     C                     Z-ADD*ZERO     WN0975  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0976  52       Product Tempera
     C                     Z-ADD*ZERO     WN0977  50       Number Spacers
     C                     MOVEL*BLANK    WN0978 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0979  70       Total Load Mile
     C                     MOVEL*BLANK    WN0980 12        Recorder ID
     C                     MOVEL*BLANK    WN0981  2        Shipping Method
     C                     MOVEL*BLANK    WN0982  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0983  2        Ship To State C
     C                     Z-ADD*ZERO     WN0984  70       Gross Weight
     C                     MOVEL*BLANK    WN0985  3        Carrier Broker
     C                     MOVEL*BLANK    WN0986  1        Export Status
     C                     Z-ADD*ZERO     WN0987  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0988  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0989  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0990  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0991  70       Spotted Date
     C                     Z-ADD*ZERO     WN0992  60       Spotted Time
     C                     Z-ADD*ZERO     WN0993  70       Load Finished D
     C                     Z-ADD*ZERO     WN0994  60       Load Finished T
     C                     Z-ADD*ZERO     WN0995  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0996  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0997  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0998  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0999  70       Truck Departure
     C                     Z-ADD*ZERO     WN1000  60       Truck Departure
     C                     Z-ADD*ZERO     WN1001  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1002  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1003  3        Shipping Line
     C                     MOVEL*BLANK    WN1004 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1005 30        Vessel Name
     C                     Z-ADD*ZERO     WN1006  50       Voyage
     C                     Z-ADD*ZERO     WN1007  70       Sail Date
     C                     MOVEL*BLANK    WN1008 12        Booking Number
     C                     MOVEL*BLANK    WN1009 20        Discharge Port
     C                     Z-ADD*ZERO     WN1010  70       Arrival Date
     C                     MOVEL*BLANK    WN1011 12        Container Numbe
     C                     Z-ADD*ZERO     WN1012  70       Date In
     C                     Z-ADD*ZERO     WN1013  60       Time In
     C                     Z-ADD*ZERO     WN1014  70       Date Out
     C                     Z-ADD*ZERO     WN1015  60       Time Out
     C                     Z-ADD*ZERO     WN1016 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1017  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1018  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1019  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1020  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1021  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1022  70       Requested Deliv
     C                     MOVEL*BLANK    WN1023  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1024  70       On Yard Date
     C                     Z-ADD*ZERO     WN1025  60       On Yard Time
     C                     Z-ADD*ZERO     WN1026  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1027  60       Deadline Depart
     C                     MOVEL*BLANK    WN1028  1        Load Held Over
     C                     MOVEL*BLANK    WN1029  1        Load Held Over
     C                     MOVEL*BLANK    WN1030 15        Load Held Over
     C                     MOVEL*BLANK    WN1031 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1032 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1033  70       Express Mail Da
     C                     MOVEL*BLANK    WN1034  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1035  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1036  70       Product Complet
     C                     Z-ADD*ZERO     WN1037  60       Product Complet
     C                     Z-ADD*ZERO     WN1038  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1039  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1040  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1041  1        Load Confirmed
     C                     MOVEL*BLANK    WN1042 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1043  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1044  60       Load Door 1
     C                     Z-ADD*ZERO     WN1045  70       Override Total
     C                     Z-ADD*ZERO     WN1046  60       Load Door 2
     C                     MOVEL*BLANK    WN1047  1        Partial Load
     C                     MOVEL*BLANK    WN1048  1        Load Confirmati
     C                     MOVEL*BLANK    WN1049  1        Export Load USD
     C                     MOVEL*BLANK    WN1050  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1051 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1052 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1053 15        Late Billing Em
     C                     MOVEL*BLANK    WN1054 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1055 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1056  1        Multi Company L
     C                     MOVEL*BLANK    WN1057  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1058  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1059  1        LH Power Only L
     C                     MOVEL*BLANK    WN1060  1        MG Created Load
     C                     MOVEL*BLANK    WN1061  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1062  2        Load U_M
     C                     MOVEL*BLANK    WN1063  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1064  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1065  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1066  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1067  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1068  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1069  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1070  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1071  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1072  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1073  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1074  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1075  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1076  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1077  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1078  60       LH Unused Time
     C                     MOVEL*BLANK    WN1079  1        EDI Status 1
     C                     MOVEL*BLANK    WN1080  1        EDI Status 2
     C                     MOVEL*BLANK    WN1081  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1082  60       Job Time
     C                     MOVEL*BLANK    WN1083 10        User Id
     C                     MOVEL*BLANK    WN1084 10        Job Name
     C                     Z-ADD*ZERO     WN1085  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WJRMNB           Load ID
      *
     C           KLCHNI    KLIST
     C                     KFLD           WJRMNB           Load ID
     C           KLCHNI    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YIRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WJRMST    P      Load Acceptance
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJCHRC    BEGSR
      *================================================================
      * CHG Load Accep/SchShip CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1086  30       Company Number
     C                     MOVEL*BLANK    WN1087  1        LTL Flag
     C                     MOVEL*BLANK    WN1088  1        Load Status
     C                     Z-ADD*ZERO     WN1089  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1090 15        Seal 1
     C                     MOVEL*BLANK    WN1091 15        Seal 2
     C                     MOVEL*BLANK    WN1092 15        Seal 3
     C                     MOVEL*BLANK    WN1093 15        Seal 4
     C                     MOVEL*BLANK    WN1094 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1095  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1096 112       Flat Amount
     C                     MOVEL*BLANK    WN1097  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1098  50       Total Stops
     C                     MOVEL*BLANK    WN1099 20        Trailer Id
     C                     MOVEL*BLANK    WN1100  3        Transloader Car
     C                     Z-ADD*ZERO     WN1101  40       BOL Time
     C                     MOVEL*BLANK    WN1102  3        Carrier Code
     C                     MOVEL*BLANK    WN1103  7        Truck Size
     C                     Z-ADD*ZERO     WN1104  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN1105 112       Rated Freight
     C                     MOVEL*BLANK    WN1106  1        Ship Status
     C                     MOVEL*BLANK    WN1107  1        Load Type
     C                     Z-ADD*ZERO     WN1108  50       Number Pallets
     C                     Z-ADD*ZERO     WN1109  50       Number Pallets
     C                     Z-ADD*ZERO     WN1110 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1111  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1112  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1113  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1114 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1115 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1116  70       Actual Departur
     C                     Z-ADD*ZERO     WN1117  40       Departure Time
     C                     Z-ADD*ZERO     WN1118  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1119  52       Product Tempera
     C                     Z-ADD*ZERO     WN1120  50       Number Spacers
     C                     MOVEL*BLANK    WN1121 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN1122  70       Total Load Mile
     C                     MOVEL*BLANK    WN1123 12        Recorder ID
     C                     MOVEL*BLANK    WN1124  2        Shipping Method
     C                     MOVEL*BLANK    WN1125  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1126  2        Ship To State C
     C                     Z-ADD*ZERO     WN1127  70       Gross Weight
     C                     MOVEL*BLANK    WN1128  3        Carrier Broker
     C                     MOVEL*BLANK    WN1129  1        Export Status
     C                     Z-ADD*ZERO     WN1130  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1131  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN1132  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1133  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1134  70       Spotted Date
     C                     Z-ADD*ZERO     WN1135  60       Spotted Time
     C                     Z-ADD*ZERO     WN1136  70       Load Finished D
     C                     Z-ADD*ZERO     WN1137  60       Load Finished T
     C                     Z-ADD*ZERO     WN1138  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1139  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1140  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1141  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1142  70       Truck Departure
     C                     Z-ADD*ZERO     WN1143  60       Truck Departure
     C                     Z-ADD*ZERO     WN1144  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1145  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1146  3        Shipping Line
     C                     MOVEL*BLANK    WN1147 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1148 30        Vessel Name
     C                     Z-ADD*ZERO     WN1149  50       Voyage
     C                     Z-ADD*ZERO     WN1150  70       Sail Date
     C                     MOVEL*BLANK    WN1151 12        Booking Number
     C                     MOVEL*BLANK    WN1152 20        Discharge Port
     C                     Z-ADD*ZERO     WN1153  70       Arrival Date
     C                     MOVEL*BLANK    WN1154 12        Container Numbe
     C                     Z-ADD*ZERO     WN1155  70       Date In
     C                     Z-ADD*ZERO     WN1156  60       Time In
     C                     Z-ADD*ZERO     WN1157  70       Date Out
     C                     Z-ADD*ZERO     WN1158  60       Time Out
     C                     Z-ADD*ZERO     WN1159 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1160  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1161  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1162  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1163  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1164  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1165  70       Requested Deliv
     C                     MOVEL*BLANK    WN1166  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1167  70       On Yard Date
     C                     Z-ADD*ZERO     WN1168  60       On Yard Time
     C                     Z-ADD*ZERO     WN1169  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1170  60       Deadline Depart
     C                     MOVEL*BLANK    WN1171  1        Load Held Over
     C                     MOVEL*BLANK    WN1172  1        Load Held Over
     C                     MOVEL*BLANK    WN1173 15        Load Held Over
     C                     MOVEL*BLANK    WN1174 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1175 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1176  70       Express Mail Da
     C                     MOVEL*BLANK    WN1177  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1178  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1179  70       Product Complet
     C                     Z-ADD*ZERO     WN1180  60       Product Complet
     C                     Z-ADD*ZERO     WN1181  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1182  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1183  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1184  1        Load Confirmed
     C                     MOVEL*BLANK    WN1185 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1186  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1187  60       Load Door 1
     C                     Z-ADD*ZERO     WN1188  70       Override Total
     C                     Z-ADD*ZERO     WN1189  60       Load Door 2
     C                     MOVEL*BLANK    WN1190  1        Partial Load
     C                     MOVEL*BLANK    WN1191  1        Load Confirmati
     C                     MOVEL*BLANK    WN1192  1        Export Load USD
     C                     MOVEL*BLANK    WN1193  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1194 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1195 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1196 15        Late Billing Em
     C                     MOVEL*BLANK    WN1197 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1198 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1199  1        Multi Company L
     C                     MOVEL*BLANK    WN1200  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1201  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1202  1        LH Power Only L
     C                     MOVEL*BLANK    WN1203  1        MG Created Load
     C                     MOVEL*BLANK    WN1204  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1205  2        Load U_M
     C                     MOVEL*BLANK    WN1206  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1207  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1208  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1209  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1210  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1211  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1212  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1213  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1214  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1215  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1216  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1217  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1218  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1219  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1220  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1221  60       LH Unused Time
     C                     MOVEL*BLANK    WN1222  1        EDI Status 1
     C                     MOVEL*BLANK    WN1223  1        EDI Status 2
     C                     MOVEL*BLANK    WN1224  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1225  60       Job Time
     C                     MOVEL*BLANK    WN1226 10        User Id
     C                     MOVEL*BLANK    WN1227 10        Job Name
     C                     Z-ADD*ZERO     WN1228  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WJRMNB           Load ID
      *
     C           KLCHNJ    KLIST
     C                     KFLD           WJRMNB           Load ID
     C           KLCHNJ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YJRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADD#1AODT    WJAODT           Scheduled Ship
     C                     MOVELYL0008    WJRMST    P      Load Acceptance
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * RTV Load Acceptance Sw RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           WHRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WHRMNB           Load ID
      * Establish starting position
     C           KRSNK     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           Load Acceptance
     C                     MOVEL*BLANK    P2RYSX           MG Created Load
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHRMST    YL0008           Load Acceptance
     C                     MOVELWHRYSX    P2RYSX           MG Created Load
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLCHRC    BEGSR
      *================================================================
      * CHG Load Acceptance Sw CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1229  30       Company Number
     C                     Z-ADD*ZERO     WN1230  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1231  1        LTL Flag
     C                     MOVEL*BLANK    WN1232  1        Load Status
     C                     Z-ADD*ZERO     WN1233  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1234 15        Seal 1
     C                     MOVEL*BLANK    WN1235 15        Seal 2
     C                     MOVEL*BLANK    WN1236 15        Seal 3
     C                     MOVEL*BLANK    WN1237 15        Seal 4
     C                     MOVEL*BLANK    WN1238 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1239  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1240 112       Flat Amount
     C                     MOVEL*BLANK    WN1241  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1242  50       Total Stops
     C                     MOVEL*BLANK    WN1243 20        Trailer Id
     C                     MOVEL*BLANK    WN1244  3        Transloader Car
     C                     Z-ADD*ZERO     WN1245  40       BOL Time
     C                     MOVEL*BLANK    WN1246  3        Carrier Code
     C                     MOVEL*BLANK    WN1247  7        Truck Size
     C                     Z-ADD*ZERO     WN1248  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN1249 112       Rated Freight
     C                     MOVEL*BLANK    WN1250  1        Ship Status
     C                     MOVEL*BLANK    WN1251  1        Load Type
     C                     Z-ADD*ZERO     WN1252  50       Number Pallets
     C                     Z-ADD*ZERO     WN1253  50       Number Pallets
     C                     Z-ADD*ZERO     WN1254 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1255  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1256  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1257  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1258 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1259 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1260  70       Actual Departur
     C                     Z-ADD*ZERO     WN1261  40       Departure Time
     C                     Z-ADD*ZERO     WN1262  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1263  52       Product Tempera
     C                     Z-ADD*ZERO     WN1264  50       Number Spacers
     C                     MOVEL*BLANK    WN1265 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN1266  70       Total Load Mile
     C                     MOVEL*BLANK    WN1267 12        Recorder ID
     C                     MOVEL*BLANK    WN1268  2        Shipping Method
     C                     MOVEL*BLANK    WN1269  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1270  2        Ship To State C
     C                     Z-ADD*ZERO     WN1271  70       Gross Weight
     C                     MOVEL*BLANK    WN1272  3        Carrier Broker
     C                     MOVEL*BLANK    WN1273  1        Export Status
     C                     Z-ADD*ZERO     WN1274  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1275  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN1276  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1277  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1278  70       Spotted Date
     C                     Z-ADD*ZERO     WN1279  60       Spotted Time
     C                     Z-ADD*ZERO     WN1280  70       Load Finished D
     C                     Z-ADD*ZERO     WN1281  60       Load Finished T
     C                     Z-ADD*ZERO     WN1282  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1283  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1284  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1285  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1286  70       Truck Departure
     C                     Z-ADD*ZERO     WN1287  60       Truck Departure
     C                     Z-ADD*ZERO     WN1288  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1289  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1290  3        Shipping Line
     C                     MOVEL*BLANK    WN1291 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1292 30        Vessel Name
     C                     Z-ADD*ZERO     WN1293  50       Voyage
     C                     Z-ADD*ZERO     WN1294  70       Sail Date
     C                     MOVEL*BLANK    WN1295 12        Booking Number
     C                     MOVEL*BLANK    WN1296 20        Discharge Port
     C                     Z-ADD*ZERO     WN1297  70       Arrival Date
     C                     MOVEL*BLANK    WN1298 12        Container Numbe
     C                     Z-ADD*ZERO     WN1299  70       Date In
     C                     Z-ADD*ZERO     WN1300  60       Time In
     C                     Z-ADD*ZERO     WN1301  70       Date Out
     C                     Z-ADD*ZERO     WN1302  60       Time Out
     C                     Z-ADD*ZERO     WN1303 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1304  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1305  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1306  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1307  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1308  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1309  70       Requested Deliv
     C                     MOVEL*BLANK    WN1310  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1311  70       On Yard Date
     C                     Z-ADD*ZERO     WN1312  60       On Yard Time
     C                     Z-ADD*ZERO     WN1313  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1314  60       Deadline Depart
     C                     MOVEL*BLANK    WN1315  1        Load Held Over
     C                     MOVEL*BLANK    WN1316  1        Load Held Over
     C                     MOVEL*BLANK    WN1317 15        Load Held Over
     C                     MOVEL*BLANK    WN1318 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1319 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1320  70       Express Mail Da
     C                     MOVEL*BLANK    WN1321  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1322  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1323  70       Product Complet
     C                     Z-ADD*ZERO     WN1324  60       Product Complet
     C                     Z-ADD*ZERO     WN1325  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1326  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1327  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1328  1        Load Confirmed
     C                     MOVEL*BLANK    WN1329 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1330  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1331  60       Load Door 1
     C                     Z-ADD*ZERO     WN1332  70       Override Total
     C                     Z-ADD*ZERO     WN1333  60       Load Door 2
     C                     MOVEL*BLANK    WN1334  1        Partial Load
     C                     MOVEL*BLANK    WN1335  1        Load Confirmati
     C                     MOVEL*BLANK    WN1336  1        Export Load USD
     C                     MOVEL*BLANK    WN1337  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1338 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1339 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1340 15        Late Billing Em
     C                     MOVEL*BLANK    WN1341 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1342 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1343  1        Multi Company L
     C                     MOVEL*BLANK    WN1344  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1345  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1346  1        LH Power Only L
     C                     MOVEL*BLANK    WN1347  1        MG Created Load
     C                     MOVEL*BLANK    WN1348  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1349  2        Load U_M
     C                     MOVEL*BLANK    WN1350  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1351  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1352  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1353  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1354  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1355  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1356  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1357  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1358  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1359  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1360  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1361  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1362  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1363  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1364  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1365  60       LH Unused Time
     C                     MOVEL*BLANK    WN1366  1        EDI Status 1
     C                     MOVEL*BLANK    WN1367  1        EDI Status 2
     C                     MOVEL*BLANK    WN1368  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1369  60       Job Time
     C                     MOVEL*BLANK    WN1370 10        User Id
     C                     MOVEL*BLANK    WN1371 10        Job Name
     C                     Z-ADD*ZERO     WN1372  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WJRMNB           Load ID
      *
     C           KLCHNL    KLIST
     C                     KFLD           WJRMNB           Load ID
     C           KLCHNL    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YKRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WJRMST    P      Load Acceptance
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * Val Order Hdr Exists   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSNM     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN1373    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSNN     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WUI6ST           Allow Multi_Com
     C                     MOVELDRMPNA    WUMPNA           Default Printer
     C                     MOVELDRBCCD    WUBCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0066           Company Number
     C                     MOVELDRBUVN    WN1374           User Code Model
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NORVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNO     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0094    DTAJVN           User Profile Na
     C                     MOVELWL0095    DTDNCD           Application Cod
      * Establish starting position
     C           KRSNO     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0096           Company Number
     C                     MOVELDTAJCD    WL0097           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNP01           Application Cod
      * Define keylist
     C           KRSNP     KLIST
     C                     KFLD           WQNP01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQNP01           Application Cod
     C                     MOVEL'OMS'     WQNP01           Application Cod
      * Establish starting position
     C           KRSNP     SETLL@DNRESF                    *
     C           KRSNP     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR NQRVGN
     C                     END                             *FI
     C           KRSNP     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNQ01           Application Cod
      * Define keylist
     C           KRSNQ     KLIST
     C                     KFLD           WQNQ01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQNQ01           Application Cod
      * Establish starting position
     C           KRSNQ     SETLL@DNRESF                    *
     C           KRSNQ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSNQ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * RTV Dflt Type for Co   RT - User Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           C0AJVN           User Profile Na
     C                     KFLD           C0DNCD           Application Cod
     C                     KFLD           C0AIC3           Company Number
      * Setup key
     C                     MOVEL##USR     C0AJVN           User Profile Na
     C                     MOVE *BLANK    C0DNCD           Application Cod
     C                     MOVEL'O/P'     C0DNCD           Application Cod
     C                     Z-ADDP1AIC3    C0AIC3           Company Number
      * Establish starting position
     C           KRSNR     CHAIN@C0REO4              90    *
      * Data record not found
     C   90                MOVEL'USR0527' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC0JNCD    WUJNCD           Order Type_Sale
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSRVGN    BEGSR
      *================================================================
      * RTV OP status          RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNS     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    ASAIC3           Company Number
      * Establish starting position
     C           KRSNS     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELASCHST    WUCHST           Auto Order Numb
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * RTV Next Order Number  RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADD*ZERO     ASAIC3           Company Number
      * Establish starting position
     C           KRSNT     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDASC5NB    P1C4NB           Next Order Numb
     C                     ENDIF
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Order Type Desc.   RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           EXJNCD           Order Type_Sale
      * Setup key
     C                     MOVELWL0001    EXJNCD           Order Type_Sale
      * Establish starting position
     C           KRSSA     CHAIN@EXREYP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1063' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Order Type Desc
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEXJVNA    WL0002           Order Type Desc
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Desc, Status       RT - Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVELWL0003    E5KXCD           Country Code
      * Establish starting position
     C           KRSSB     CHAIN@E5REB8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1158' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Country Descrip
     C                     MOVEL*BLANK    WL0005           Record Status
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELE5DATX    WL0004           Country Descrip
     C                     MOVELE5VSST    WL0005           Record Status
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Warehouse Address  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADAJNA    YL0001           City
     C                     MOVELADBGCD    YL0002           State Code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELWL0006    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSD     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Salesperson Cod
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEBCCD    WL0007           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVELWL0008    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSE     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           Salesperson Cod
     C                     MOVEL*BLANK    WL0009           Salesperson Nam
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPBCCD    WL0008           Salesperson Cod
     C                     MOVELAPALTX    WL0009           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSF01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSF01           Company Number
     C                     Z-ADDBEC4NB    WQSF02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSF     SETLL@BGWKAE                    *
     C           KRSSF     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAJCD           Warehouse Code
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SGRVGN
      * PAR = DB1 By name
     C                     MOVELOMAJCD    #DAJCD           Warehouse Code
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Telephone Number   RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDBEBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBVTX           Telephone Numbe
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBBVTX    #DBVTX           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Cust Ordering Dflt2RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0010    EOAIC3           Company Number
     C                     Z-ADDWL0011    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@EOREUB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0012           Terms Code
     C                     MOVEL*BLANK    WL0013           Sales Route Cod
     C                     MOVEL*BLANK    WL0014           Special Instruc
     C                     MOVEL*BLANK    WL0015           Special Instruc
     C                     MOVEL*BLANK    WL0016           Carrier Code
     C                     MOVEL*BLANK    WL0017           P_O Required Fl
     C                     Z-ADD*ZERO     WL0018           Deliver after t
     C                     MOVEL*BLANK    WL0019           Type Code
     C                     Z-ADD*ZERO     WL0020           Absorbed Freigh
     C                     Z-ADD*ZERO     WL0021           Mileage To Cust
     C                     MOVEL*BLANK    WL0022           Warehouse Code
     C                     MOVEL*BLANK    WL0023           Outside Warehou
     C                     MOVEL*BLANK    WL0024           Customer Group
     C                     MOVEL*BLANK    WL0025           Customer Group
     C                     MOVEL*BLANK    WL0026           Ord Ent Default
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOAQCD    WL0012           Terms Code
     C                     MOVELEOR4CD    WL0013           Sales Route Cod
     C                     MOVELEOBYNA    WL0014           Special Instruc
     C                     MOVELEOB6NA    WL0015           Special Instruc
     C                     MOVELEOBZNA    WL0016           Carrier Code
     C                     MOVELEOPPST    WL0017           P_O Required Fl
     C                     Z-ADDEOR5NB    WL0018           Deliver after t
     C                     MOVELEOBOCD    WL0019           Type Code
     C                     Z-ADDEOTBNB    WL0020           Absorbed Freigh
     C                     Z-ADDEOMTCU    WL0021           Mileage To Cust
     C                     MOVELEOAJCD    WL0022           Warehouse Code
     C                     MOVELEOX9ST    WL0023           Outside Warehou
     C                     MOVELEOT9CD    WL0024           Customer Group
     C                     MOVELEOUBCD    WL0025           Customer Group
     C                     MOVELEORBST    WL0026           Ord Ent Default
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0027    KMAIC3           Company Number
     C                     MOVELWL0028    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSJ     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    WL0029           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Ord Hdr Val/Wgt    rt - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSK02           Order Number
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSK01           Company Number
     C                     Z-ADD#1C4NB    WQSK02           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
      * Establish starting position
     C           KPSSK     SETLL@BGWKKK                    *
     C           KRSSK     READE@BGWKKK                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WAD0WG    #DCDWG           USR Order Weigh
     C           KRSSK     READE@BGWKKK                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV ld Accpt/Load Status - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0031           Load Status
     C                     MOVEL*BLANK    WL0032           Load Acceptance
     C                     MOVEL*BLANK    WL0033           MG Created Load
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJRMNB    WQSL02           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL02           Load ID
      * Setup key
     C                     Z-ADDWL0030    WQSL02           Load ID
      * Establish starting position
     C           KRSSL     SETLL@FJCPSB                    *
     C           KRSSL     READE@FJCPSB                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    WL0031           Load Status
     C                     MOVELFJRMST    WL0032           Load Acceptance
     C                     MOVELFJRYSX    WL0033           MG Created Load
     C           KRSSL     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0034    WBAIC3           Company Number
     C                     Z-ADDWL0035    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSM     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0036           Warehouse Code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAJCD    WL0036           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0037    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0038           Warehouse Descr
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWCF8NA    WL0038           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Shipping Co Dft    RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDBKC7    WQSO01           Ship To Custome
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Ship To Custome
      * Setup key
     C                     Z-ADDWL0040    WQSO01           Ship To Custome
      * Establish starting position
     C           KRSSO     SETLL@EOREIQ                    *
     C           KRSSO     READE@EOREIQ                  90*
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Default Shipping Co Sts is Yes
     C           WDQ8ST    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDWDAIC3    WL0039           Company Number
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSO     READE@EOREIQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0041    ABAIC3           Company Number
      * Establish starting position
     C           KRSSP     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0042           Name
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0042           Name
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WEJNCD           Order Type_Sale
      * Setup key
     C                     MOVEL#1JNCD    WEJNCD           Order Type_Sale
      * Establish starting position
     C           KRSSQ     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEOBST    #1OBST           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Cust Addr, A/R,Loc RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0043    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSSR     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAYTX    WL0044           Customer Name
     C                     MOVELWFACNA    WL0045           Address Line 1
     C                     MOVELWFADNA    WL0046           Address Line 2
     C                     MOVELWFAENA    WL0047           Address Line 3
     C                     MOVELWFAJNA    WL0048           City
     C                     MOVELWFBGCD    WL0049           State Code
     C                     MOVELWFBTTX    WL0050           Zip Postal Code
     C                     MOVELWFABTX    WL0051           Alpha Search
     C                     Z-ADDWFANC7    WL0052           AR Customer Num
     C                     MOVELWFQWST    WL0053           Email When Orde
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Cust Name/Addr     RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0054    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSSS     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAYTX    WL0055           Customer Name
     C                     MOVELWFACNA    WL0056           Address Line 1
     C                     MOVELWFADNA    WL0057           Address Line 2
     C                     MOVELWFAENA    WL0058           Address Line 3
     C                     MOVELWFAJNA    WL0059           City
     C                     MOVELWFBGCD    WL0060           State Code
     C                     MOVELWFBTTX    WL0061           Zip Postal Code
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0062    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSST     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0063           Warehouse Type
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0063           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Customer Air Frt  RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSU     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P1FTSX           Air Freight Ord
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNEP0SX    P1FTSX           Air Freight Ord
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WHRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WHRMNB           Load ID
      * Establish starting position
     C           KRSSV     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUPKST           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWHPKST    WUPKST           Load Status
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * CHG Load ID            CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0002  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Order in Use
     C                     MOVEL*BLANK    WN0034  1        Header Status
     C                     MOVEL*BLANK    WN0035  1        Header Status L
     C                     MOVEL*BLANK    WN0036  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     Z-ADD*ZERO     WN0040 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0041 112       Order Weight To
     C                     MOVEL*BLANK    WN0042  1        Credit Hold
     C                     MOVEL*BLANK    WN0043  1        Production Hold
     C                     MOVEL*BLANK    WN0044  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0045  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0046  40       Requested Deliv
     C                     MOVEL*BLANK    WN0047  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0048 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0049  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0050 112       Rated Freight
     C                     MOVEL*BLANK    WN0051  1        LTL Flag
     C                     MOVEL*BLANK    WN0052  1        Price Audit
     C                     MOVEL*BLANK    WN0053  1        Price Status
     C                     MOVEL*BLANK    WN0054  2        Shipping Method
     C                     MOVEL*BLANK    WN0055  1        Export Status
     C                     MOVEL*BLANK    WN0056  1        Palletize
     C                     MOVEL*BLANK    WN0057  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0058  1        Slip Sheet
     C                     MOVEL*BLANK    WN0059  1        Age Code
     C                     Z-ADD*ZERO     WN0060  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0061  1        Load Type
     C                     Z-ADD*ZERO     WN0062  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0063  1        Load Plan Order
     C                     MOVEL*BLANK    WN0064  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0065  70       Resell Referenc
     C                     MOVEL*BLANK    WN0066 30        Special Comment
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  2        Manager Level C
     C                     MOVEL*BLANK    WN0071  3        VP Level Code
     C                     Z-ADD*ZERO     WN0072  70       Attach to Order
     C                     MOVEL*BLANK    WN0073  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0074  70       Invoice Number
     C                     MOVEL*BLANK    WN0075  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0076  70       Invoice Date
     C                     MOVEL*BLANK    WN0077  2        Event Code
     C                     MOVEL*BLANK    WN0078  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0079  1        Modified Flag
     C                     Z-ADD*ZERO     WN0080 112       A_R order Value
     C                     MOVEL*BLANK    WN0081  1        Billing Activit
     C                     MOVEL*BLANK    WN0082  1        Block Order Fla
     C                     MOVEL*BLANK    WN0083  1        Order Certifica
     C                     Z-ADD*ZERO     WN0084 112       Invoice Order V
     C                     MOVEL*BLANK    WN0085  1        Process Sts for
     C                     MOVEL*BLANK    WN0086  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0087  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0088  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0089  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0090  1        Email Cust On O
     C                     MOVEL*BLANK    WN0091  1        Order Emailed
     C                     MOVEL*BLANK    WN0092  1        Export Docs Go
     C                     MOVEL*BLANK    WN0093  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0094  1        Broker Order St
     C                     MOVEL*BLANK    WN0095  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0096  2        Order Requires
     C                     MOVEL*BLANK    WN0097  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0098  2        Export USDA App
     C                     MOVEL*BLANK    WN0099  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0100  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0101  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0102  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0103  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0104  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0105  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0106  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0107  60       Time of Origina
     C                     Z-ADD*ZERO     WN0108  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0109  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0110  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0111 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0112 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0113 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0114 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0115 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0116  70       Claim Number
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      *
     C           KLCHSW    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHSW    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     BERMNB           Load ID
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##PGM     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDBEAIC3    PCAIC3           Company Number
     C                     Z-ADDBEC4NB    PCC4NB           Order Number
     C                     MOVELBEJNCD    PCJNCD    P      Order Type_Sale
     C                     Z-ADDBEANC7    PCANC7           AR Customer Num
     C                     Z-ADDBEBKC7    PCBKC7           Ship To Custome
     C                     MOVELBEBRTX    PCBRTX    P      Ship To Name
     C                     MOVELBEHMNA    PCHMNA    P      Ship To Address
     C                     MOVELBEHONA    PCHONA    P      Ship To Address
     C                     MOVELBEHPNA    PCHPNA    P      Ship To Address
     C                     MOVELBEHNNA    PCHNNA    P      Ship To City
     C                     MOVELBEDBCD    PCDBCD    P      Ship To State C
     C                     MOVELBECKTX    PCCKTX    P      Ship To Zip_Pos
     C                     Z-ADDBEB0C7    PCB0C7           Bill to Custome
     C                     MOVELBEAETX    PCAETX    P      Bill to Name
     C                     MOVELBEB1NA    PCB1NA    P      Bill to Address
     C                     MOVELBEB3NA    PCB3NA    P      Bill to Address
     C                     MOVELBEB4NA    PCB4NA    P      Bill to Address
     C                     MOVELBEB2NA    PCB2NA    P      Bill to City
     C                     MOVELBEBHCD    PCBHCD    P      Bill to State C
     C                     MOVELBEC8TX    PCC8TX    P      Bill to Zip_Pos
     C                     MOVELBEBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDBEA0DT    PCA0DT           Order Date
     C                     Z-ADDBEA5DT    PCA5DT           Requested Ship
     C                     Z-ADDBEGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDBEACDT    PCACDT           Cancel Date
     C                     MOVELBEAQCD    PCAQCD    P      Terms Code
     C                     MOVELBEB6NA    PCB6NA    P      Special Instruc
     C                     MOVELBEBYNA    PCBYNA    P      Special Instruc
     C                     MOVELBEBZNA    PCBZNA    P      Carrier Code
     C                     MOVELBEGTST    PCGTST    P      Comment Print A
     C                     MOVELBEGVST    PCGVST    P      Comment Print I
     C                     MOVELBEGUST    PCGUST    P      Comment Print P
     C                     MOVELBEQFST    PCQFST    P      Comment Print S
     C                     MOVELBECQCD    PCCQCD    P      Reason Code
     C                     MOVELBEGJST    PCGJST    P      Order in Use
     C                     MOVELBEGWST    PCGWST    P      Header Status
     C                     MOVELBEGXST    PCGXST    P      Header Status L
     C                     MOVELBEGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDBEAODT    PCAODT           Scheduled Ship
     C                     MOVELBEAIVN    PCAIVN    P      User Original E
     C                     Z-ADDBECXDT    PCCXDT           Date of Origina
     C                     Z-ADDBEJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    PCA1WG           Order Weight To
     C                     MOVELBEXIST    PCXIST    P      Credit Hold
     C                     MOVELBEXJST    PCXJST    P      Production Hold
     C                     MOVELBEXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDBEEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    PCAFTM           Requested Deliv
     C                     MOVELBEE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELBEE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDBERMNB    PCRMNB           Load ID
     C                     Z-ADDBETBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    PCR1NB           Rated Freight
     C                     MOVELBEPJST    PCPJST    P      LTL Flag
     C                     MOVELBEU0ST    PCU0ST    P      Price Audit
     C                     MOVELBEU1ST    PCU1ST    P      Price Status
     C                     MOVELBEQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELBEU2ST    PCU2ST    P      Export Status
     C                     MOVELBEVEST    PCVEST    P      Palletize
     C                     MOVELBEVFST    PCVFST    P      Shrink Wrap
     C                     MOVELBEVGST    PCVGST    P      Slip Sheet
     C                     MOVELBERPCD    PCRPCD    P      Age Code
     C                     Z-ADDBERNNB    PCRNNB           Reefer Temperat
     C                     MOVELBEVDST    PCVDST    P      Load Type
     C                     Z-ADDBEATIN    PCATIN           Attach to Invoi
     C                     MOVELBEU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELBEU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDBERSRN    PCRSRN           Resell Referenc
     C                     MOVELBEMHNA    PCMHNA    P      Special Comment
     C                     MOVELBEMINA    PCMINA    P      Special Comment
     C                     MOVELBEWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELBER4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELBEBFCD    PCBFCD    P      Manager Level C
     C                     MOVELBEQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDBET3NB    PCT3NB           Attach to Order
     C                     MOVELBESICD    PCSICD    P      Reason for Pric
     C                     Z-ADDBECONB    PCCONB           Invoice Number
     C                     MOVELBECEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDBEAWDT    PCAWDT           Invoice Date
     C                     MOVELBEJPCD    PCJPCD    P      Event Code
     C                     MOVELBEXUST    PCXUST    P      Trans Contol AS
     C                     MOVELBEZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDBEVRVA    PCVRVA           A_R order Value
     C                     MOVELBEOBST    PCOBST    P      Billing Activit
     C                     MOVELBEBCST    PCBCST    P      Block Order Fla
     C                     MOVELBEBDST    PCBDST    P      Order Certifica
     C                     Z-ADDBEB7VL    PCB7VL           Invoice Order V
     C                     MOVELBEGASX    PCGASX    P      Process Sts for
     C                     MOVELBEGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELBEGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELBEGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELBEFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELBEFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELBEFPSX    PCFPSX    P      Order Emailed
     C                     MOVELBEFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELBEFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELBEFSSX    PCFSSX    P      Broker Order St
     C                     MOVELBEFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELBEFUSX    PCFUSX    P      Order Requires
     C                     MOVELBEFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELBEFWSX    PCFWSX    P      Export USDA App
     C                     MOVELBEFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELBEFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDBENODT    PCNODT           OH Appt Confirm
     C                     Z-ADDBENPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDBENRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDBENSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    PCBQTM           Time of Origina
     C                     Z-ADDBEBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    PCH1NX           Act Non_Ref Frt
     C                     Z-ADDBEH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    PCH3NX           OH Total Non_Re
     C                     Z-ADDBEH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    PCC0C7           Claim Number
     C                     MOVELBEUVST    PCUVST    P      EDI Status 1
     C                     MOVELBEUWST    PCUWST    P      EDI Status 2
     C                     MOVELBEUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDBEAATM    PCAATM           Job Time
     C                     MOVELBEAYNA    PCAYNA    P      User Id
     C                     MOVELBEA0NA    PCA0NA    P      Job Name
     C                     Z-ADDBEAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * VAL Load ID on Orders  RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQSX02           Load ID
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSX02           Load ID
      * Establish starting position
     C           KRSSX     SETLL@BFCPD9                    *
     C           KRSSX     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYDLRC    BEGSR
      *================================================================
      * DLT Load Header        DL - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WJRMNB           Load ID
      *
     C           KLDLSY    KLIST
     C                     KFLD           WJRMNB           Load ID
     C           KLDLSY    CHAIN@FJCPBO              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FJCPBO                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * DLT Load Detail       RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSZ01           Load ID
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Load ID
      * Setup key
     C                     Z-ADDWL0064    WQSZ01           Load ID
      * Establish starting position
     C           KRSSZ     SETLL@FLCPBW                    *
     C           KRSSZ     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Load Detail        DL - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0064    WL0065           Load ID
     C                     Z-ADDFLRUNB    WL0066           Stop_Drop Seque
     C                     EXSR TADLRC
     C           KRSSZ     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TADLRC    BEGSR
      *================================================================
      * DLT Load Detail        DL - Load Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FLCPBM
     C                     Z-ADDWL0065    WKRMNB           Load ID
     C                     Z-ADDWL0066    WKRUNB           Stop_Drop Seque
      *
     C           KLDLTA    KLIST
     C                     KFLD           WKRMNB           Load ID
     C                     KFLD           WKRUNB           Stop_Drop Seque
     C           KLDLTA    CHAIN@FLCPBM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FLCPBM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * CHG Sub Weight & Stop  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0124  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0125  50       Total Stops
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WHRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0067    WHRMNB           Load ID
      * Establish starting position
     C           KRSTB     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHRPNB    SUB  WL0068    WN0124           Total Load Orde
     C           WHRRNB    SUB  1         WN0125           Total Stops
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WHWNTX' defaulted for 'Load Held Over Rsn Cmt'.
      * Field '(DB1) WHKNNX' defaulted for 'Pallets Loaded'.
      * Field '(DB1) WHICWG' defaulted for 'Avg Pallet Tare'.
      * Field '(DB1) WHIDWG' defaulted for 'Tot Pallet Tare'.
      * Field '(DB1) WHH9SX' defaulted for 'Load Confirmed Sts'.
      * Field '(DB1) WHWOTX' defaulted for 'Load Confirmed Contact'.
      * Field '(DB1) WHWPTX' defaulted for 'Hide on WW Load Sts'.
      * Field '(DB1) WHWQTX' defaulted for 'Late Billing Email Flag'.
      * Field '(DB1) WHWRTX' defaulted for 'Shipping Temp C_F txt'.
      * Field '(DB1) WHWSTX' defaulted for 'LH Held Over Rsn Cmt'.
      * Field '(DB1) WHRVSX' defaulted for 'Multi Company Load'.
      * Field '(DB1) WHRUSX' defaulted for 'Fax Sent to SSI Carrier'.
      * Field '(DB1) WHRWSX' defaulted for 'Schedule Pos Load Grade'.
      * Field '(DB1) WHRXSX' defaulted for 'LH Power Only Load'.
      * Field '(DB1) WHRYSX' defaulted for 'MG Created Load'.
      * Field '(DB1) WHRZSX' defaulted for 'LH Unused Sts 5'.
      * Field '(DB1) WHR0SX' defaulted for 'Load U_M'.
      * Field '(DB1) WHR1SX' defaulted for 'TPM Shipment Status'.
      * Field '(DB1) WHR2SX' defaulted for 'LH Unused Sts 8'.
      * Field '(DB1) WHR4SX' defaulted for 'LH Held Over Reason'.
      * Field '(DB1) WHPYDT' defaulted for 'LH Carrier Paid Dte'.
      * Field '(DB1) WHCKTM' defaulted for 'LH Carrier Paid Time'.
      * Field '(DB1) WHPZDT' defaulted for 'LH Last Combo Prod Date'.
      * Field '(DB1) WHCLTM' defaulted for 'LH Last Combo Prod Time'.
      * Field '(DB1) WHP0DT' defaulted for 'LPT Load Plan Start Dt'.
      * Field '(DB1) WHCMTM' defaulted for 'LPT Load Plan Start Tm'.
      * Field '(DB1) WHP1DT' defaulted for 'TPM Planned Ship Date'.
      * Field '(DB1) WHCNTM' defaulted for 'LH Unused Time 4'.
      * Field '(DB1) WHP2DT' defaulted for 'LH Unused Date 5'.
      * Field '(DB1) WHCOTM' defaulted for 'LH Unused Time 5'.
      * Field '(DB1) WHP3DT' defaulted for 'LH Unused Date 6'.
      * Field '(DB1) WHCQTM' defaulted for 'LH Unused Time 6'.
      * Field '(DB1) WHUVST' defaulted for 'EDI Status 1'.
      * Field '(DB1) WHUWST' defaulted for 'EDI Status 2'.
      * Field '(DB1) WHUXST' defaulted for 'EDI Status 3'.
      * CHG Load Header        CH - Load Header  * 
     C                     EXSR TCCHRC
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * CHG Load Header        CH - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0126 15        Seal 4
     C                     MOVEL*BLANK    WN0127 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0128  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0129  60       Job Time
     C                     MOVEL*BLANK    WN0130 10        User Id
     C                     MOVEL*BLANK    WN0131 10        Job Name
     C                     Z-ADD*ZERO     WN0132  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWHRMNB    WJRMNB           Load ID
      *
     C           KLCHTC    KLIST
     C                     KFLD           WJRMNB           Load ID
     C           KLCHTC    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWHAIC3    WJAIC3           Company Number
     C                     Z-ADDWHAODT    WJAODT           Scheduled Ship
     C                     MOVELWHPJST    WJPJST    P      LTL Flag
     C                     MOVELWHPKST    WJPKST    P      Load Status
     C                     Z-ADDWHRNNB    WJRNNB           Reefer Temperat
     C                     MOVELWHDMTX    WJDMTX    P      Seal 1
     C                     MOVELWHDNTX    WJDNTX    P      Seal 2
     C                     MOVELWHDOTX    WJDOTX    P      Seal 3
     C                     Z-ADDWN0124    WJRPNB           Total Load Orde
     C                     Z-ADDWHFLAM    WJFLAM           Flat Amount
     C                     MOVELWHXQST    WJXQST    P      Allocate Pounds
     C                     Z-ADDWN0125    WJRRNB           Total Stops
     C                     MOVELWHDXTX    WJDXTX    P      Trailer Id
     C                     MOVELWHDYTX    WJDYTX    P      Transloader Car
     C                     Z-ADDWHSBNB    WJSBNB           BOL Time
     C                     MOVELWHBZNA    WJBZNA    P      Carrier Code
     C                     MOVELWHRONB    WJRONB    P      Truck Size
     C                     Z-ADDWHSQNB    WJSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDWHR1NB    WJR1NB           Rated Freight
     C                     MOVELWHVCST    WJVCST    P      Ship Status
     C                     MOVELWHVDST    WJVDST    P      Load Type
     C                     Z-ADDWHSDNB    WJSDNB           Number Pallets
     C                     Z-ADDWHPAOU    WJPAOU           Number Pallets
     C                     Z-ADDWHDGWG    WJDGWG           Load Carrier Pa
     C                     Z-ADDWHSXNB    WJSXNB           Estimated Arriv
     C                     Z-ADDWHHADT    WJHADT           Actual Arrival
     C                     Z-ADDWHAART    WJAART           Actual Arrival
     C                     Z-ADDWHDHWG    WJDHWG           Trailer IN Weig
     C                     Z-ADDWHDIWG    WJDIWG           Trailer OUT Wei
     C                     Z-ADDWHAQDT    WJAQDT           Actual Departur
     C                     Z-ADDWHS6NB    WJS6NB           Departure Time
     C                     Z-ADDWHT4NB    WJT4NB           Schedule Sequen
     C                     Z-ADDWHPRTM    WJPRTM           Product Tempera
     C                     Z-ADDWHNPSV    WJNPSV           Number Spacers
     C                     MOVELWHJ8TX    WJJ8TX    P      Car_Veh_Initial
     C                     Z-ADDWHTLMI    WJTLMI           Total Load Mile
     C                     MOVELWHJ9TX    WJJ9TX    P      Recorder ID
     C                     MOVELWHQ2CD    WJQ2CD    P      Shipping Method
     C                     MOVELWHVPCD    WJVPCD    P      Ship From Wareh
     C                     MOVELWHDBCD    WJDBCD    P      Ship To State C
     C                     Z-ADDWHGRWE    WJGRWE           Gross Weight
     C                     MOVELWHXCCD    WJXCCD    P      Carrier Broker
     C                     MOVELWHU2ST    WJU2ST    P      Export Status
     C                     Z-ADDWHF9DT    WJF9DT           Actual Ship Dat
     C                     MOVELWHONTM    WJONTM    P      On Time_Y_N
     C                     Z-ADDWHJ4DT    WJJ4DT           Truck Ready Dat
     C                     Z-ADDWHTRTM    WJTRTM           Truck Ready Tim
     C                     Z-ADDWHJ5DT    WJJ5DT           Spotted Date
     C                     Z-ADDWHSPTM    WJSPTM           Spotted Time
     C                     Z-ADDWHJ6DT    WJJ6DT           Load Finished D
     C                     Z-ADDWHLFTM    WJLFTM           Load Finished T
     C                     Z-ADDWHJ7DT    WJJ7DT           BOL Complete Da
     C                     Z-ADDWHBOTM    WJBOTM           BOL Complete Ti
     C                     Z-ADDWHJ8DT    WJJ8DT           BOL Received Da
     C                     Z-ADDWHBLTM    WJBLTM           BOL Received Ti
     C                     Z-ADDWHKIDT    WJKIDT           Truck Departure
     C                     Z-ADDWHASTM    WJASTM           Truck Departure
     C                     Z-ADDWHKADT    WJKADT           Adjusted Depart
     C                     Z-ADDWHAJCM    WJAJCM           Adjusted Depart
     C                     MOVELWHXACD    WJXACD    P      Shipping Line
     C                     MOVELWHOANA    WJOANA    P      Port Delv Termi
     C                     MOVELWHK4TX    WJK4TX    P      Vessel Name
     C                     Z-ADDWHVOAG    WJVOAG           Voyage
     C                     Z-ADDWHKBDT    WJKBDT           Sail Date
     C                     MOVELWHNBBO    WJNBBO    P      Booking Number
     C                     MOVELWHW4CD    WJW4CD    P      Discharge Port
     C                     Z-ADDWHEFDT    WJEFDT           Arrival Date
     C                     MOVELWHCNTN    WJCNTN    P      Container Numbe
     C                     Z-ADDWHKCDT    WJKCDT           Date In
     C                     Z-ADDWHTMIN    WJTMIN           Time In
     C                     Z-ADDWHKDDT    WJKDDT           Date Out
     C                     Z-ADDWHVMNB    WJVMNB           Time Out
     C                     Z-ADDWHOCFR    WJOCFR           Load Total Frei
     C                     Z-ADDWHKJDT    WJKJDT           Scheduled Deliv
     C                     MOVELWHOTRS    WJOTRS    P      LH Unused Sts
     C                     MOVELWHRNST    WJRNST    P      LH Carrier Paym
     C                     Z-ADDWHBRBK    WJBRBK           Bring Back Mile
     C                     Z-ADDWHEIDT    WJEIDT           Requested Deliv
     C                     MOVELWHRMST    WJRMST    P      Load Acceptance
     C                     MOVELWHAJCD    WJAJCD    P      Warehouse Code
     C                     Z-ADDWHKKDT    WJKKDT           On Yard Date
     C                     Z-ADDWHAVTM    WJAVTM           On Yard Time
     C                     Z-ADDWHKZDT    WJKZDT           Deadline Depart
     C                     Z-ADDWHAXTM    WJAXTM           Deadline Depart
     C                     MOVELWHLHOS    WJLHOS    P      Load Held Over
     C                     MOVELWHLHOR    WJLHOR    P      Load Held Over
     C                     MOVELWHWNTX    WJWNTX    P      Load Held Over
     C                     MOVELWHOITX    WJOITX    P      Ocean BOL Numbe
     C                     MOVELWHOJTX    WJOJTX    P      Express Mail Nu
     C                     Z-ADDWHLLDT    WJLLDT           Express Mail Da
     C                     MOVELWHLSHG    WJLSHG    P      Load Shag Flag
     C                     MOVELWHYPST    WJYPST    P      Load Wash Flag
     C                     Z-ADDWHK0DT    WJK0DT           Product Complet
     C                     Z-ADDWHAYTM    WJAYTM           Product Complet
     C                     Z-ADDWHKNNX    WJKNNX           Pallets Loaded
     C                     Z-ADDWHICWG    WJICWG           Avg Pallet Tare
     C                     Z-ADDWHIDWG    WJIDWG           Tot Pallet Tare
     C                     MOVELWHH9SX    WJH9SX    P      Load Confirmed
     C                     MOVELWHWOTX    WJWOTX    P      Load Confirmed
     C                     Z-ADDWHK1DT    WJK1DT           Load Confirmati
     C                     Z-ADDWHAZTM    WJAZTM           Load Door 1
     C                     Z-ADDWHK2DT    WJK2DT           Override Total
     C                     Z-ADDWHA0TM    WJA0TM           Load Door 2
     C                     MOVELWHROST    WJROST    P      Partial Load
     C                     MOVELWHRPST    WJRPST    P      Load Confirmati
     C                     MOVELWHRQST    WJRQST    P      Export Load USD
     C                     MOVELWHRRST    WJRRST    P      Late Delivery E
     C                     Z-ADDWHZBVA    WJZBVA           Load Actual Fre
     C                     MOVELWHWPTX    WJWPTX    P      Hide on WW Load
     C                     MOVELWHWQTX    WJWQTX    P      Late Billing Em
     C                     MOVELWHWRTX    WJWRTX    P      Shipping Temp C
     C                     MOVELWHWSTX    WJWSTX    P      LH Held Over Rs
     C                     MOVELWHRVSX    WJRVSX    P      Multi Company L
     C                     MOVELWHRUSX    WJRUSX    P      Fax Sent to SSI
     C                     MOVELWHRWSX    WJRWSX    P      Schedule Pos Lo
     C                     MOVELWHRXSX    WJRXSX    P      LH Power Only L
     C                     MOVELWHRYSX    WJRYSX    P      MG Created Load
     C                     MOVELWHRZSX    WJRZSX    P      LH Unused Sts 5
     C                     MOVELWHR0SX    WJR0SX    P      Load U_M
     C                     MOVELWHR1SX    WJR1SX    P      TPM Shipment St
     C                     MOVELWHR2SX    WJR2SX    P      LH Unused Sts 8
     C                     MOVELWHR3SX    WJR3SX    P      LH On-Time Reas
     C                     MOVELWHR4SX    WJR4SX    P      LH Held Over Re
     C                     Z-ADDWHPYDT    WJPYDT           LH Carrier Paid
     C                     Z-ADDWHCKTM    WJCKTM           LH Carrier Paid
     C                     Z-ADDWHPZDT    WJPZDT           LH Last Combo P
     C                     Z-ADDWHCLTM    WJCLTM           LH Last Combo P
     C                     Z-ADDWHP0DT    WJP0DT           LPT Load Plan S
     C                     Z-ADDWHCMTM    WJCMTM           LPT Load Plan S
     C                     Z-ADDWHP1DT    WJP1DT           TPM Planned Shi
     C                     Z-ADDWHCNTM    WJCNTM           LH Unused Time
     C                     Z-ADDWHP2DT    WJP2DT           LH Unused Date
     C                     Z-ADDWHCOTM    WJCOTM           LH Unused Time
     C                     Z-ADDWHP3DT    WJP3DT           LH Unused Date
     C                     Z-ADDWHCQTM    WJCQTM           LH Unused Time
     C                     MOVELWHUVST    WJUVST    P      EDI Status 1
     C                     MOVELWHUWST    WJUWST    P      EDI Status 2
     C                     MOVELWHUXST    WJUXST    P      EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WJAATM' defaulted for 'Job Time'.
      * Field '(DB1) WJAYNA' defaulted for 'User Id'.
      * Field '(DB1) WJA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WJAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * CHG Del Order Off load RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLRMNB    WQTD02           Load ID
     C           *LIKE     DEFN WLC4NB    WQTD03           Order Number
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD02           Load ID
     C                     KFLD           WQTD03           Order Number
      * Setup key
     C                     Z-ADDWL0069    WQTD02           Load ID
     C                     Z-ADDWL0070    WQTD03           Order Number
      * Establish starting position
     C           KRSTD     SETLL@FLCPKF                    *
     C           KRSTD     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Load Detail        DL - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLRMNB    WL0065           Load ID
     C                     Z-ADDWLRUNB    WL0066           Stop_Drop Seque
     C                     EXSR TADLRC
     C           KRSTD     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV OE Hold/ShipTo FlagRT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSTE     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUQNST           Order Entry Hol
     C                     MOVEL*BLANK    WURJST           Ship To Custome
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFQNST    WUQNST           Order Entry Hol
     C                     MOVELWFRJST    WURJST           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * VAL Check Exists       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSTF     CHAIN@BBREWG              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTG     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0026           Application WHS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI7ST    YL0026           Application WHS
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Sls Route by Slsp  RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMBCCD    WQTH01           Salesperson Cod
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Salesperson Cod
      * Setup key
     C                     MOVEL#DBCCD    WQTH01           Salesperson Cod
      * Establish starting position
     C           KRSTH     SETLL@JEREZ3                    *
     C           KRSTH     READE@JEREZ3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1BFCD           Manager Level C
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMR4CD    #1R4CD           Sales Route Cod
     C                     MOVELWMBFCD    #1BFCD           Manager Level C
     C                     MOVELWMQ4CD    #1Q4CD           VP Level Code
     C           KRSTH     READE@JEREZ3                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Mgr Desc,VP Level  RT - Manager Level  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           ALBFCD           Manager Level C
      * Setup key
     C                     MOVEL#1BFCD    ALBFCD           Manager Level C
      * Establish starting position
     C           KRSTI     CHAIN@ALREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Description
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELALAUNA    WUG0TX           Description
     C                     MOVELALQ4CD    #1Q4CD           VP Level Code
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Order Types        RT - OP Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           EXJNCD           Order Type_Sale
      * Setup key
     C                     MOVEL#1JNCD    EXJNCD           Order Type_Sale
      * Establish starting position
     C           KRSTJ     CHAIN@EXREYP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1063' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Order Type Desc
     C                     MOVEL*BLANK    WUG0TX           Processing Cycl
     C                     MOVEL*BLANK    #1OBST           Billing Activit
     C                     MOVEL*BLANK    P4OEST           Affect Inventor
     C                     MOVEL*BLANK    WUG0TX           Affect Sales Do
     C                     MOVEL*BLANK    WUG0TX           Affect Sales Pn
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEXJVNA    WUG0TX           Order Type Desc
     C                     MOVELEXOAST    WUG0TX           Processing Cycl
     C                     MOVELEXOBST    #1OBST           Billing Activit
     C                     MOVELEXOEST    P4OEST           Affect Inventor
     C                     MOVELEXOFST    WUG0TX           Affect Sales Do
     C                     MOVELEXVBST    WUG0TX           Affect Sales Pn
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV WhsTyp/Ctrl/LdTyp RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSTK     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WUWPST           Warehouse Type
     C                     MOVEL*BLANK    #1XUST           Trans Contol AS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WUWPST           Warehouse Type
     C                     MOVELWCXUST    #1XUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV Co,Cust,PO         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOBKC7    WQTL01           Ship To Custome
     C           *LIKE     DEFN WOBCNA    WQTL02           Customer Purcha
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Ship To Custome
     C                     KFLD           WQTL02           Customer Purcha
      * Setup key
     C                     Z-ADD#1BKC7    WQTL01           Ship To Custome
     C                     MOVEL#1BCNA    WQTL02           Customer Purcha
      * Establish starting position
     C           KRSTL     SETLL@BFCPCQ                    *
     C           KRSTL     READE@BFCPCQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSTL     READE@BFCPCQ                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Val Country & Active   RT - Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0072           Record Status
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVELWL0071    E5KXCD           Country Code
      * Establish starting position
     C           KRSTM     CHAIN@E5REB8              90    *
      * Data record not found
     C   90                MOVEL'USR1158' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           E5VSST    IFEQ 'A'                        *IF
     C                     MOVELE5VSST    WL0072           Record Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'I'       WL0072           Record Status
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Val Day Prior Ship    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0028           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQTN01           Company Number
     C           *LIKE     DEFN WRC4NB    WQTN02           Order Number
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Company Number
     C                     KFLD           WQTN02           Order Number
      * Setup key
     C                     Z-ADD#DFKNB    WQTN01           Company Number
     C                     Z-ADD#1C4NB    WQTN02           Order Number
      * Establish starting position
     C           KRSTN     SETLL@BGWKL1                    *
     C           KRSTN     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Date Method Code is Day Prior Ship
     C           WRRDCD    IFEQ 'DPS'                      *IF
     C                     MOVEL'Y'       YL0028           Record Found US
     C                     GOTO TNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTN     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOINFN    BEGSR
      *================================================================
      * PMT Must Ship Dt Accpt IF - Order Header TRG  * 
      *================================================================
      * PMT Must Ship Dt Accpt IF
      * PMT Must Ship Dt Accpt PV - Order Header TRG  * 
     C                     CALL 'PDJFPVR'              90  PMT Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0073    WQ0203  70       Requested Deliv
     C                     PARM WL0075    WQ0204  70       Must Ship Date
     C                     PARM WL0077    WQ0205  70       Requested Ship
     C           WL0078    PARM WL0078    WQ0206  1        STATUS
     C                     PARM WL0076    WQ0207  60       Must Ship Time
     C                     PARM WL0074    WQ0208  40       Requested Deliv
     C                     PARM WL0080    WQ0209  3        Must Ship Error
     C                     PARM WL0081    WQ0210  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJFPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
     C                     MOVEL'1'       @I1,35           *
     C                     MOVEL'1'       @I1,34           *
     C                     END
      * CASE: PAR.STATUS is No
     C           WL0078    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Must Ship Date        USR to display format
      * Convert date
     C           1000000   ADD  WL0075    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0032
      * Send message 'Requested Ship Date can n'
     C                     MOVEL'USR2662' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * RTV Stop Number       RT - Load Detail          TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WURVNB           Stop_Drop
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTP01           Load ID
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTP01           Load ID
      * Establish starting position
     C           KRSTP     SETLL@FLCPBW                    *
     C           KRSTP     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WURVNB           Stop_Drop
     C                     Z-ADD*ZERO     WUNFNN           Appointment Con
     C                     Z-ADD*ZERO     WUNFNN           Appointment Con
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If order number is found, retrieve stop number
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           #1C4NB    IFEQ FLC4NB                     *IF
     C                     Z-ADDFLRVNB    WURVNB           Stop_Drop
      * PAR = DB1 By name
     C                     Z-ADDFLRVNB    WURVNB           Stop_Drop
     C                     Z-ADDFLKFDT    WUNFNN           Appointment Con
     C                     Z-ADDFLACTM    WUNFNN           Appointment Con
     C                     GOTO TPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTP     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0082    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv Acct&Ship Co      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTR     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WUBTC3           Accounting Comp
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBWC3    WUBWC3           Shipping Compan
     C                     Z-ADDADBTC3    WUBTC3           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWUCPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTS     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAOC3           Accounting Comp
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    WUAOC3           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * RTV Warehouse Location RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0083    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTT     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0084           Warehouse Locat
     C                     GOTO TTEXIT                     *QUIT
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADT0ST    WL0084           Warehouse Locat
     C                     GOTO TTEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Rtv HPB fields        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWUCPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTU     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0037           WHS Req Meter R
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADRTSX    YL0037           WHS Req Meter R
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * RTV Chk Detail Exists  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTV01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTV02           Order Number
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WQTV01           Company Number
     C                     KFLD           WQTV02           Order Number
      * Setup key
     C                     Z-ADDWL0085    WQTV01           Company Number
     C                     Z-ADDWL0086    WQTV02           Order Number
      * Establish starting position
     C           KRSTV     SETLL@BGWKAE                    *
     C           KRSTV     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSTV     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * RTV Abs Freight Rate   RT - Company/Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     Z-ADD#1BKC7    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSTW     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBTBNB    #1TBNB           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * RTV All fields         RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSTX     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFKXCD    #DKIAA           Country Code
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * RTV Warehouse Address  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTY     CHAIN@ADREAO              90    *
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADAJNA    YL0001           City
     C                     MOVELADBGCD    YL0002           State Code
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - OP Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0133  1        EDI Status 1
     C                     MOVEL*BLANK    WN0134  1        EDI Status 2
     C                     MOVEL*BLANK    WN0135  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0136  60       Job Time
     C                     MOVEL*BLANK    WN0137 10        User Id
     C                     MOVEL*BLANK    WN0138 10        Job Name
     C                     Z-ADD*ZERO     WN0139  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADD#1AIC3    EYAIC3           Company Number
     C                     Z-ADD#1C4NB    EYC4NB           Order Number
     C                     Z-ADD1         EYQ2NB           Event Number
     C                     MOVEL'01'      EYJPCD           Event Code
     C                     Z-ADD*ZERO     EYAUC3           Invoice_Memo Co
     C                     Z-ADD*ZERO     EYQ7NB           Invoice_Memo Nu
     C                     MOVEL*BLANK    EYOMST           Invoice_Memo Su
     C                     Z-ADD##JDT     EYD2DT           Event Date
     C                     MOVEL'Y'       EYONST           Activity Comple
     C                     MOVEL'N'       EYOOST           Activity Hold
     C                     MOVEL*BLANK    EYOPST           Post Cash Compl
     C                     Z-ADD*ZERO     EYAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     EYQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     EYQ9NB           Cross Event Ref
     C                     Z-ADD#1BKC7    EYBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     EYAATM           Job Time
     C                     MOVEL##USR     EYAYNA           User Id
     C                     MOVEL##JOB     EYA0NA           Job Name
     C                     Z-ADD##JDT     EYAXDT           Job Date
     C           KLCRTZ    KLIST
     C                     KFLD           EYAIC3           Company Number
     C                     KFLD           EYC4NB           Order Number
     C                     KFLD           EYQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRTZ    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * 06/28/2006 LJB TRF011
      * ** Added 3 char LH On-Time Reason Code as an input parm to
      * ** replace the 1 char On Time Reason parm
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * FP1061
      * TCJ 10/03/07 - Load Order Change Log created if Carrier Code or
      *                Scheduled Delivery Date changes
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Post Order.
      *================================================================
      * RTV Chk Detail Exists  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0085           Company Number
     C                     Z-ADD#1C4NB    WL0086           Order Number
     C                     EXSR TVRVGN
      * Msg 'Order has no line items'
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Send message 'Order has no line items'
     C                     MOVEL'USR2058' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * ** Review for Export Order Automation Upload Errors    P001251
      * CASE: DTL.Order Requires Review is Yes
     C           #1FUSX    IFEQ 'Y'                        *IF
      * EXC Order Req Rvw editsXF - Order Header TRG  * 
     C                     CALL 'PBBIXFR'              90  EXC Order Req R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0429  30       Company Number
     C                     PARM #1C4NB    WQ0430  70       Order Number
     C                     PARM #1BKC7    WQ0431  70       Ship To Custome
     C                     PARM #1A5DT    WQ0432  70       Requested Ship
     C                     PARM #1AODT    WQ0433  70       Scheduled Ship
     C                     PARM #1EIDT    WQ0434  70       Requested Deliv
     C                     PARM #1AFTM    WQ0435  40       Requested Deliv
     C                     PARM #1RMNB    WQ0436  70       Load ID
     C           #1FUSX    PARM #1FUSX    WQ0437  2        Order Requires
     C                     PARM #DAJCD    WQ0438  3        Warehouse Code
     C           WUH1ST    PARM WUH1ST    WQ0439  3        Order Line Erro
     C                     PARM #DA0DZ    WQ0440  70       Deadline Depart
     C                     PARM #DBUTM    WQ0441  60       Deadline Depart
     C                     PARM P3YJSX    WQ0442  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBBIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,35           *
     C                     MOVEL'1'       @I1,33           *
     C                     MOVEL'1'       @I1,34           *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * Msg: 'Exp Order Automation Upl errors still pending'    P001251
      * CASE: DTL.Order Requires Review is Yes
     C           #1FUSX    IFEQ 'Y'                        *IF
      * Send message 'Export Ord Auto Upl Error'
     C                     MOVEL'USR4472' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
     C                     MOVEL'N'       WUQ2ST           Status Flag 2
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'N'       WUFMST           Status Flag 4
     C                     MOVEL'Y'       WUAJTX           Status Flag 5
      * ** 12/01/08 LJB E00255 Default Fax to Cust parm
     C                     MOVEL'N'       WUAKTX           Status Flag 7
     C                     MOVEL'N'       WUAFTX           Status Flag 8
     C                     MOVEL'N'       WUDITX           Status Flag 12
      * E2176 SLM Feature to allow email of Acknowledgement
      * ** 05/08/13 RMC C2586 Email Reg, Fax OR Email Buyer, upd Ld Plan
     C                     MOVEL*BLANK    YL0003           OH Load Plan Re
      * 08/21/2017 DN T11489-Added Salesperson Code/Name to Parm.
      * 08/27/24 SP S312312-Start (Get field "Email to Broker Usr")
      * SEL Confirm Prompt     PV - Order Header TRG  * 
     C                     CALL 'PDS0PVR'              90  SEL Confirm Pro
     C                     PARM *BLANK    W0RTN   7
     C           WUB8ST    PARM WUB8ST    WQ0443  1        Status - Y or N
     C                     PARM #1AIC3    WQ0444  30       Company Number
     C                     PARM #1C4NB    WQ0445  70       Order Number
     C                     PARM #1BKC7    WQ0446  70       Ship To Custome
     C                     PARM #1BCST    WQ0447  1        Block Order Fla
     C           YL0003    PARM YL0003    WQ0448  2        OH Load Plan Re
     C           WUDTSX    PARM WUDTSX    WQ0449  1        Print (Yes/No)
     C           WUQ2ST    PARM WUQ2ST    WQ0450  1        Status Flag 2
     C           WUQ3ST    PARM WUQ3ST    WQ0451  1        Status Flag 3
     C           WUFMST    PARM WUFMST    WQ0452  1        Status Flag 4
     C           WUAJTX    PARM WUAJTX    WQ0453  1        Status Flag 5
     C           WUACTX    PARM WUACTX    WQ0454  1        Status Flag 6
     C           WUAKTX    PARM WUAKTX    WQ0455  1        Status Flag 7
     C           WUAFTX    PARM WUAFTX    WQ0456  1        Status Flag 8
     C           WUDITX    PARM WUDITX    WQ0457  1        Status Flag 12
     C           WURJAA    PARM WURJAA    WQ0458  3        Email to Wareho
     C           WUVQSX    PARM WUVQSX    WQ0459  1        Email Selection
     C           P9BCCD    PARM P9BCCD    WQ0460  3        Salesperson Cod
     C           YL0022    PARM YL0022    WQ0461 30        Salesperson Nam
     C           YL0023    PARM YL0023    WQ0462  1        Email to Broker
     C           YL0024    PARM YL0024    WQ0463  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDS0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,41           *
     C                     END
      * 08/27/24 SP S312312-End
      * Post ,Print Acknowledgement, and Get Rdy Rpt.
      * CASE: WRK.Status - Y or N is no
     C           WUB8ST    IFEQ 'N'                        *IF
     C                     MOVEL@CN,012   P2BYVN           Next Program Na
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
      * EDT Post Open Orders 2 XF - Order Header TRG  * 
     C                     CALL 'POI4XFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0464  30       Company Number
     C                     PARM #1C4NB    WQ0465  70       Order Number
     C                     PARM #1BKC7    WQ0466  70       Ship To Custome
     C           #1JZVA    PARM #1JZVA    WQ0467 112       Order Value Tot
     C           #1A1WG    PARM *ZERO     WQ0468 112       Order Weight To
     C                     PARM #DKXCD    WQ0469  6        USR Country Cod
     C                     PARM #DAJCD    WQ0470  3        USR Warehouse C
     C                     PARM 'OE'      WQ0471  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,60           *
     C                     MOVEL'1'       @I1,45           *
     C                     END
      * Print Acknowledgement if flag is yes from the confirm prompt
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : WRK.Print (Yes/No) USR is Yes
      *   |- c2    : WRK.Status Flag 8  Y/N is Yes
      *   |- c3    : LCL.Email to Salesperson Usr is Yes
      *   '-
     C           WUDTSX    IFEQ 'Y'                        *IF
     C           WUAFTX    OREQ 'Y'                        *OR
     C           YL0024    OREQ 'Y'                        *OR
     C                     MOVEL'N'       WUWUST           PRT Night Queue
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,019   WQ0472 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0473 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0474  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0475  4        PRT Save Output
     C           WUDYNB    PARM WUDYNB    WQ0476  20       PRT Number of C
     C           WUWUST    PARM WUWUST    WQ0477  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0478 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0479  6        Application Cod
     C                     PARM WUA7ST    WQ0480  1        Paper Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,020                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * dont print copy for sales
      * CASE: WRK.Print (Yes/No) USR is No
     C           WUDTSX    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    WUWRST           PRT Printer Dev
     C                     END                             *FI
      * SBMJOB: PRT Acknowledgements UP - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PDJWPCLP'#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#DFKNB    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1C4NB    #SPAK  309       Order Number 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1C4NB    #SPAK  309       Order Number 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Thru Date Pass
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Order Type_Sale
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUOTTX    #SSTR     P      Shipping Method
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'1'       #SSTR     P      Billing Activit
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'A'       #SSTR     P      Export Sales
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR Warehouse C
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 1
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 2
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 3
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 4
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 5
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 6
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 7
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 8
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 9
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'S'       #SSTR     P      USR Select/Omit
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWRST    #SSTR     P      PRT Printer Dev
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWSST    #SSTR     P      PRT Hold Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWTST    #SSTR     P      PRT Save Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUDYNB    #SPAK  309       System Value Nu
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'*JOBD'   #SSTR     P      PRT Night Queue
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 3
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUAFTX    #SSTR     P      Email To Whs
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWURJAA    #SSTR     P      Email to Wareho
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELYL0024    #SSTR     P      Email to Salesp
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PDJWPCLP'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Print Get Ready Report if flag is yes from the confirm prompt
      * CASE: WRK.Status Flag 5  Y/N is Yes
     C           WUAJTX    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUWUST           PRT Night Queue
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,021   WQ0481 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0482 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0483  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0484  4        PRT Save Output
     C           WUDYNB    PARM WUDYNB    WQ0485  20       PRT Number of C
     C           WUWUST    PARM WUWUST    WQ0486  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0487 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0488  6        Application Cod
     C                     PARM WUA7ST    WQ0489  1        Paper Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,020                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * SBMJOB: PRT Get Ready Report   UP - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0002    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PMH5UPC '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#DFKNB    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1C4NB    #SPAK  309       Order Number 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1C4NB    #SPAK  309       Order Number 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWRST    #SSTR     P      PRT Printer Dev
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWSST    #SSTR     P      PRT Hold Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWTST    #SSTR     P      PRT Save Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUDYNB    #SPAK  309       System Value Nu
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'*JOBD'   #SSTR     P      PRT Night Queue
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Department Code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 6         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PMH5UPC 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMH5UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * 08/27/24 SP S312312-Start (Add condition c5 Email to Broker Usr)
      * Fax Acknwlgmnt to buyer/fld/brkr/cust if flag=yes f/confirm pmt
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : WRK.Status Flag 2  Y/N is Yes
      *   |- c2    : WRK.Status Flag 3  Y/N is Yes
      *   |- c3    : WRK.Status Flag 4  Y/N is yes
      *   |- c4    : WRK.Status Flag 7  Y/N is Yes
      *   |- c5    : LCL.Email to Broker Usr is Yes
      *   '-
     C           WUQ2ST    IFEQ 'Y'                        *IF
     C           WUQ3ST    OREQ 'Y'                        *OR
     C           WUFMST    OREQ 'Y'                        *OR
     C           WUAKTX    OREQ 'Y'                        *OR
     C           YL0023    OREQ 'Y'                        *OR
      * ** Status Flag 2=Buyer Fax/email, Status Flag 3=Regional Sales Ma
      * ** Status Flag 4=Broker Fax-which is not used at this level
      * ** Status Flag 7=Customer Fax
      * 08/21/2017 DN T11489-Added Salesperson Code to Parm.
      * EXC Fax Acknwgmnt     XF - Order Header TRG  * 
     C                     CALL 'PPFDXFR'              90  EXC Fax Acknwgm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0490  30       Company Number
     C                     PARM #1C4NB    WQ0491  70       Order Number
     C                     PARM #1BKC7    WQ0492  70       Ship To Custome
     C                     PARM #1FXSX    WQ0493  3        HPB Ship to War
     C                     PARM P9BCCD    WQ0494  3        Salesperson Cod
     C                     PARM WUQ2ST    WQ0495  1        USR Update Flag
     C                     PARM WUQ3ST    WQ0496  1        USR Check Y/N S
     C                     PARM WUFMST    WQ0497  1        Status - Y or N
     C                     PARM WUAKTX    WQ0498  1        Status Flag 7
     C                     PARM YL0023    WQ0499  1        Email to Broker
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPFDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,53           *
     C                     END
     C                     END                             *FI
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** MODIFICATION HISTORY
      *================================================================
      * S020798 SR3020798 Shefali 04/15/25 Send Order confirmation Email
      *                                    Salesperson
      * - Get field "Email to Salesperson" from PDS0PVR and pass to PDJWP
      * S312312 SR3012312 Santosh 08/06/24 Send Order confirmation Email
      * - Get field "Email to Broker" from PDS0PVR and pass it to PPFDXFR
      * S028326 JM 08/22/24 - Validation added to stop new order creation
      *                     - with Zero Order Number.
      * S302751 Santosh 03/14/24 For International state account, Prepaid
      *       method & alphanumeric zip code set Code same as Shipto Coun
      *       it is blank. Also fields "Ship to Customer      USR" and "C
      *       de 1 usr" is added on screen and are hidden.
      * *****
      * W104274 RMC 07/29/22  hugoton SE plant.. added check for it for e
      * *****
      * DO2416 DN  03/24/22 - PHIS Continuation WI 500
      * - Validate Country Code is 'active'. If not active, throw error m
      *   Replaced 'RTV Chk if valid Cntry RT' function with
      *   'Val Country & Active   RT'.
      * *****
      * W77844 DN  06/11/21 - Changed screen field 'Spot Buy  (Y/N)' to
      *   have the following valid values: 'S'pot , 'T'urn, 'P'romo
      *   No longer will use LST 'Y/N Values'. Use LST
      *   'Valid Values for Spot Buy' instead.
      * - Convert field 'OHE Spot Buy' existing values from:
      *   '*YES' -> 'S'pot.
      *   '*NO'  -> 'T'urn.
      *   Will save future values as single value in: 'S', 'T', 'P'.
      * - Changed message text (USR4747) from 'Spot Buy Y/N required' to
      *   'Spot Buy S/T/P required.'.
      * *****
      * R16048 RMC 01/17/20 - HPB - validate ship to warehouse type match
      *  shipfrom warehouse. dont let txfr to/fr Blended to a not blended
      * *****
      * R15161 DN  08/06/19 - Export Load AS400 Updates
      * - DBF Change on Order Header Extsn (PMAMREP) File. Changed:
      *   OHE Voyage/Flight from 5.0 to 15A.
      *   OHE Booking Number from 12A to 15A.
      *   Added: OHE Genset Number 15A.
      * - Recompiled only due to calling PNLLXFR program parm changed for
      *   OHE file.
      * *****
      * ** 11/28/18   RMC E01714 REallocate if Req Delivery date changes
      * **   in Process Command Keys section
      * *****
      * R13074 DN  06/15/18 - FSIS Export Document from USDA
      * - This was to support WHD33039. Changed Export & Air Freight
      *   validation to set Export Docs Go w/Driver flag.
      * R12926 DN  05/03/18 - Absorbed Freight Rate Override
      * - Use Absorbed Freight Rate (AFR) on an Order for all Order
      *   processing. Do not get AFR from the Company Customer once it is
      *   on the Order.
      * - If AFR is 0 from the Order Header, get AFR from the Co Customer
      * - When creating a new Order, populate the OHE Orig ABS Freight Ra
      *   in the Order Hdr Extsn with the AFR from the detail screen.
      * - When in CHANGE mode & the ABS Freight Rate changes then update
      *   Orig ABS Freight Rate in the Order Hdr Extsn file. And if the
      *   Abs Freight Rate is changed to 0 then set Abs Rate Override Rsn
      *   to blank in the Order Hdr Extsn. Changed PMDHXFR.
      * *****
      * ** 10/12/17   RMC E011229 Check dup po sans company
      * 08/21/2017 DN  T11489 - Order Acknowledgement to Regional Manager
      * - Added 2 parms 'Salesperson Code & Name' to PDS0PVR which is the
      *   Regional Sales Manager.
      * - Added parm 'Salesperson Code' to PPFDXFR.
      * ** 06/08/2017 RMC R9064 - COMP/CUST CAN NOW BE inactive, so modif
      * ** 02/06/2017 RMC R7574 - dont set status - mileage to NO ever
      * ** 10/19/2016 JJH R7574 - Change logic to validate Order Detail
      *   exists.  Used in conjunction with changing Warehouse on Order.
      *   Add additional validation that will only occur in Change Mode.
      * *****
      * ** 08/17/2016 RMC R6965
      * ** New hpb plant
      * *****
      * E4119L 7/18/16 RMC if MG Created load: dont set load acceptance f
      *     if load plan ready=Y, output only the shipping method
      * E4119L 6/29/16 RMC check new pfs interface: TMSLDP to disable F16
      * E4119 5/23/16 RMC Remove live with tpm checks
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * ***** Description of information and status flags
     C                     EXSR UESUBR                     ***** Descripti
      * *****
      * * 03/16/2016 E005434  Blank out OHE TPM Location Code when callin
      *   the Create program
      * * 11/02/2015 E004119 Put "Load Plan Ready" back on the
      *   Confirm Prompt popup. Make Load Planning output only
      *   include Letter of Credit, Cindy frequently has it available
      *   when entering LOC orders
      * * 04/08/2015 LJB E004119   After Live w/TPM, disable F16=Load Pla
      *   set Load Plan Order=N. Don't validate Load ID. Also disable F7,
      *   and F19 if live w/TPM or if Load ID <> zeros
      * *****
      * !03/25/2015  c4026 RMC fix mileage between cities issues: Cvt to
      *  11/24/2014  E3641 RMC dont allow warehouse chg from a fr<->Fz if
      *   are OD lines because that will cause the items to not be valid
      *    warehouse     -- ** Commented for now 2/24/15
      *  08/15/2014  E3323 RMC req spot buy. dont dft to No unless not SB
      *  06/09/2014  P0196 RMC add spot buy to screen. dft ' ' = N
      *              from OHE unused sts renamed Spot Buy
      * *****
      *  06/04/2014  P0196 RMC Default 363 MSL to Print Pick Slip = N
      *  in Crt/Chg XFs
      * *****
      *  01/09/2014  E2625 RMC Undo tpm stuff
      * *****
      *  06/20/2013  E2625 RMC Get tpm loc from ship to, and upd OHE with
      *   Cant F7/F16 if Live with tpm=Y, condition fields on 'Sent to Tp
      * *****
      *  06/17/2013  E2640 RMC Call Different Load Ord chg log for Cancel
      * *****
      * ** 05/09/2013 RMC C2586 Upd tpm freight order sts in post routine
      * *****
      * ** 02/07/2013 RMC E2438 For SBD also Upd OHE Override type code
      * ** so they can change a customer type to something else per order
      *    default from salesperson sales channel
      * *****
      *  * 07/12/2012 RMC C2180 if order require review is NO update OH i
      *     YES... all orders with sts "A" were being change to "E" which
      *   potential erroneous sched ship date change to req ship date
      * *****
      * ** 01/12/2012 RMC E1814 HPB Validate ship from/to whses being ext
      * **            for Transfer orders billing activity=4
      * *****
      * ** 09/30/2011 RMC E1762 HPB Upd OHE Override type code
      * ** so they can change a RIN cust sale to NON RIN
      * *****
      * ** 09/20/2011 LJB P001251 Export Order Automation Upload
      * ** If "Order Requires Review" = "Y" then there are errors
      * ** pending in Order Detail from Export Order Automation upload
      * ** Check the Order Detail at the end of order processing. If ther
      * ** are none, reset the Order Requires Review flag = "  ".
      * ** Re-Test for errors in F20=Post routine             P001251
      * *****
      * ** 09/09/2011 RMC E01714
      * ** write chg log if req delv date OR time chgs
      * *****
      * ** 08/10/2011 RMC E01692
      * ** HPB Only - dont allow hpb whs if cust ULSD Company is blank
      * ** Whs req meter readings sts determines if whs has biodiesel or
      * *****
      * ** 07/07/2011 LJB E001625
      * ** Email TRAFFIC (esend profile) if no Mileage Between Cities rec
      * *****
      * ** 5/19/2011 RMC E01488
      * ** Display appt confirm dt/tm from OH and confirm#/Nm from ohe
      * ** Added F7=Dsp Appts
      * *****
      * ** 5/02/2011 RMC E01523
      * ** Use req delv dt/time for ddt calc always.
      * *****
      * ** 09/14/2010 RMC E914 HPB Only added RIN Equiv Value and RIN Pri
      * **   from Order Header Ext file
      * *****************************************************************
      * ** 03/26/2010 SLM FP1309
      * HIDE PROCESS OF AGE CODE
      * FP1309 Inventory Age  IF
      * FP1309 Inventory Age Code Description
      * *****************************************************************
      * ** 03/08/2010 LJB E000589
      * ** Validate Scheduled Ship Date. If error, user cannot change
      * ** unless Requested Ship or Delivery dates are unlocked.
      * *****
      * ** 01/26/2010 LJB W288  Post-install changes
      * ** Change the Restricted Time Range test to: If Requested Ship
      * ** Date = Deadline Departure Date then enforce the Restriced Hour
      * ** If Export with no State Code, use SSD and dflt time to 8:00
      * *****
      * ** 12/15/2009 RMC FP1322
      * ** For HPB Only -
      * ** Added Ship To warehouse for when they're shipping from hp1/hp2
      * ** an external 369 whse that makes the fuel owned by 369 HPB Biod
      * ** The fuel will be sold from there to an outside customer later.
      * *****
      * ** 12/02/2009 LJB W288
      * ** For Seaboard only (skip HPB and Daily's)
      * ** If shipping today, retrieve Shipping Restricted Hours from
      * ** Warehouse Control. Warning if DDT falls within Restriced
      * ** time range. Warning also if DDD/T falls before right now.
      * *****
      * **11/2009 PKD**
      * E00519 Access by WHS  IF
      * ---------- November 2009 PKD ----------
      * *****  WW Cust/Order Inq O.E.  *****
      * - Do not allow Transfer Co if Application WHS Restrict = Y.
      * ***** Edit Order Header ***** -TESTED 11/10/09
      * -  Added validation on Warehouse Code.  If Application WHS Restri
      * is Yes, then only the Warehouse Code for O/P Application Code
      * are allowed.  If the Application WHS Restrict is No, then the
      * User is allowed access to all Active Warehouses.
      * -  Changed the F4=Prompt to only display the Warehouses the
      * User has access to if the Application WHS Restrict is Yes.
      * ***** Edit Order Detail Lines & Copy Order Template ***** TESTED
      * -  Added validation for Item Code. For each application and
      * Warehouse, addtional access control is defined for TF Exempt Code
      * Users that are restricted by Warehouse, they may also be restrict
      * on the Items they are able to sell.
      * -  Added validation on Order TF Exempt Code.  If the Customer is
      * is Exempt, then they can only sell Exempt Product. (E00505)
      * ***** Edit Load Plan Order Entry *****
      * -  Added WHS Code to the Control Context and Record Context.
      * For Users that are Application WHS Restrict = Yes,
      * the CTL.Warehouse Code will be restricted to the
      * Warehouses that they have access to.
      * -  CTL.Warehouse Code will be required for Users with
      * Application Warehouse Controlled.
      * -  Added Delivery State Code (Sail Port State) to the screen.
      * It will default to the Ship To State Code.  It will be overriden
      * to the Sail Port State if the Shipping Line and Port Delivery
      * Terminal are entered in the Order Header Extent.
      * -  Added subfile select for WHS and Delv ST.
      * ***** Edit Load Plan *****
      * -  For Users that are Application WHS Restrict = Yes,
      * the CTL.Warehouse Code will be restricted to the
      * Warehouses that they have access to.
      * -  CTL.Warehouse Code will be required for Users with
      * Application Warehouse Controlled.
      * -  CTL.USR Load Type---Default from the CTL.USR Warehosue Code
      * for users that are Application WHS Restrict.
      * ***** Display Change Log/Accept Load (PDAOXFR) *****
      * -  Deletes will not be accepted by Application WHS Restricted
      * users because we do not know the Warehouse that was on the Load.
      * -  If Application WHS Restrict is Yes, then only select the load
      * for acceptance if at least one order on the load has a warehouse
      * where the user has access.
      * -  Reverse imaged Warehouse Code on the Display. The Users with
      * Application WHS Restrict of No will be able to see all Loads.
      * ***** Edit Load Plan *****
      * - Added Warehouse Code to the Control and Detail Context with
      * appropriate validations.
      * ***** Work With Load Confirmation *****
      * - Added Warehouse Code as a parameter from the Work With Load
      * Plan All screen for selection of the Loads to Display on the
      * screen.  Added selection for Warehouse Code if one passed in.
      * If the Load is not to be selected due to not matching the Whs,
      * a record is created for the load in the array (exception array).
      * - Added Warehouse Code to the Subfile.
      * ***** Order Status Report Prompt *****
      * - Added Warehouse Code restriction on the prompt.
      * ***** Work With Orders Price Audit/Maintenance *****
      * - Added Warehouse Code restriction.
      * ***** Work With Orders - Edit Ship Date  *****
      * - Added Warehouse Code restriction.
      * *****
      * ** 9/29/2009 LJB E00495
      * ** If order is on a load, rtv Carrier Date/Time and use in the
      * ** Deadline Departure Date/Time calcs. Also in the Must Ship calc
      * *****
      * ** 9/28/2009 LJB S00949
      * ** Add date error comment under DDD/T. Condition it non-display
      * ** Display in reverse image if Load SSD is not equal to Order SSD
      * ** Write Load/Order Log rec for SSD change
      * *****
      * ** 8/26/2009 LJB E00157
      * ** Add "Intended for Export" country code and validation
      * ** Add prompt for country code for "Intended for Export"
      * *****
      * ** 7/29/2009 LJB E00447
      * ** Allow changes to dates if a) not on a load,   b) on a load,
      * ** and not locked, shipped, or invoiced and c) current date is
      * **  at least 7 days prior to SSD
      * ** (Per Bo Bostic and Steve Burke)
      * *****
      * ** 7/29/2009 LJB E00139 (revisited)
      * ** If PO# changes, write log record. Unaccept if load is accepted
      * ** This way Traffic will need to re-accept and resend the
      * ** load confirmation. Also, allow changes to dates if not on a
      * *****
      * ** FP1303 LJB 01/15/09  RTV the delivery p.o. from OHE file
      * ** If Delivery P.O. has changed then update the OHE file
      * *****
      * ** 07/06/09 RMC S00584 If country code is changed, then
      * ** del exp docs if they exist because theyre for the orig country
      * ** 06/10/09 RMC FP1054 position cursor on req delv dt for block o
      * ** 12/01/2008 LJB E00255 - Added Fax Ack to customer in F20
      * ** 9/23/2008 SAZ E00178 - Added code to EDI the Acknowledgement t
      * ** 8/05/2008 RMC E00180 - in Command Key section, moved update
      * ** of Order Header outside of CASE stmts to make sure its done
      * ** before the F16.  Loads were getting planned and flagged as und
      * ** because the order header weight wasnt updated yet.
      * *****
      * ** 7/08/2008 RMC E00180 - dont allow F16 if ordered weight is -0-
      * ** need this because of the underweight load change log creation
      * *****
      * ** 6/25/2008 LJB FP1098
      * ** Retrieve Export Defaults from Co/Cust for existing record
      * ** update country code if type code is "EX"port for existing rec
      * *****
      * ** 6/05/2008 LJB E00139
      * ** Save PO# and Load ID.
      * *****
      * ** 05/16/2008 LJB
      * ** Time field cannot be zeros on an existing record. Unlock the
      * ** field and send error message.
      * *****
      * ** 04/28/2008 LJB E00147
      * ** Test dates to see if they have been changed. if not, don't
      * ** send error messages.
      * *****
      * ** 04/22/2008 LJB E00147
      * ** Requested Ship Date cannot be after Requested Delivery Date
      * *****
      * ** 04/04/2008 LJB E00127
      * ** If Ship Method changed from Collect to Prepaid, blank
      * ** out the carrier code
      * *****
      * ** 03/04/2008 LJB FP1251
      * ** If the Shipping Method changes in the order header and the
      * ** order is tied to a load, change the shipping method in
      * ** the Load Header as well.
      * *****
      * ** 02/21/2008 LJB FP1251
      * ** Add Requested Ship Date to the tests in the Must Ship Date
      * ** routine.
      * *****
      * ** 01/14/2008 RMC FP1100 HPB
      * ** If company org is "H"PB default Print Pick Slip to "N"o.
      * *****
      * ** 01/03/2008 LJB E-OMS23
      * ** Do not allow the Ship Date to be before the Delivery Date. Unl
      * ** the field if there is an error so it can be corrected.
      * *****
      * ** 01/03/2008 LJB E-TRANS47 (Reverse FP1061)
      * ** Change the department code back to Traffic (from Sales) if the
      * ** Shipping Method changes. This will notify traffic that the ori
      * ** shipping company needs to be notified of a delete.
      * *****
      * ** 12/14/2007 RMC FP1110 HPB
      * ** If order is on a HPB Batch, then Retire all the RINS when del
      * ** the order off of a load. they may exist if the order was shipp
      * *****
      * ** 11/16/2007 LJB FP1251
      * ** If shipping method is CR or CT, default carrier to "BUY"
      * ** and protect from change until shipping method is changed
      * ** If this changes the carrier then write a record to
      * ** the Load Order Change Log so Traffic sees the change
      * *****
      * ** 10/23/2007 LJB Support
      * ** Change the test on Requested Delivery date: Use WRK field to l
      * ** instead of Load ID *ne blanks, Unlock and allow change if
      * ** it is before the scheduled delivery date
      * *****
      * 8/01/07 RMC - for TR orders, Acct Co of whse on screen must eq
      *   the To Whse on the Transfer customer number
      * *****
      * 6/20/07 Added Get Ready Report JRB DLY0129 in > F20=Post Order
      * *****
      * ** 05/24/2007 RMC DLY029
      * ** Broker not in OH so dont validate here;take broker order sts o
      * *****
      * ** 05/21/2007 LJB DLY029
      * ** Change parms to Fax Acknowledgements to accommodate additional
      * ** parms required for new companies.
      * *****
      * PKTR01: Output air freight order sts from cust ext    08/09/06 RM
      * *****
      * workin: Add company# and order# to parms being passed  08/31/06 L
      *         to WW Loads Order Entry (F16)
      * *****
      * 01/23/07 Added error if Req Delv time < 0
      * *****
      * PK0519: Changes for Broker Order              10/20/03 RMC
      * *****
      * PKTR01: Changes for new Plant                 07/21/04 RMC
      * *****
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * ***** Description of information and status flags
      *================================================================
      * *****************************************************************
      * *****  Special note *****
      * ** Any changes that affect the movement of trucks needs to be
      * ** given the department control code of TRF (Transportation)
      * ** not SLS (Sales), and a Load Order Change Log record is to be w
      * **   a. All Date changes   b. Warehouse change   c. Shipping meth
      * **   d. any change that affects the movement of a truck (not cont
      * **   e. PO# change (load confirm needs to be resent)
      * ** This way Traffic will be notified that a change has been made
      * ** and they can notify the correct carriers (both the old and new
      * ***** Status Flags:
      * ** Print (Yes/No) USR=Print Acknowledgement,
      * ** Status Flag 2=Buyer Fax, Status Flag 3=Regional Sales Manager
      * ** Status Flag 4=Broker Fax-which is not used at this level
      * ** Status Flag 5=Print Get Ready Rpt, Status Flag 6=EDI Ack to Cu
      * ** Status Flag 7=Fax Ack to Customer
      * ** Status Flag 8=SSD error-Order <> Load
      * ** Status Flag 9=Errors Pending in Order Detail recs
      * ** Status Flag 10=Hide Appt Date/Time, contact, if Yes or not SBD
      * ** Status Flag 12=Load Plan Ready (send to MG)
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0095  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0096  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0097  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWG    KLIST
     C                     KFLD           WGAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WGAIC3
     C           KLVBWG    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Order Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Order Type_Sale
     C           YPMTFD    OREQ '#1JNCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JNCD' defaulted for 'Order Type_Sales'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1OBST' defaulted for 'Billing Activity Type'.
     C                     CALL 'PDG1SRR'              90  SEL By Billing
     C                     PARM *BLANK    W0RTN   7
     C           #1JNCD    PARM #1JNCD    WQ0233  2        Order Type_Sale
     C                     PARM #1OBST    WQ0234  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
     C                     END
      *
     C           #1JNCD    IFNE *BLANK                     Order Type_Sale
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JNCD    IFEQ *BLANK                     Order Type_Sale
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWE    KLIST
     C                     KFLD           WEJNCD           Order Type_Sale
      * Setup key
     C                     MOVEL#1JNCD    WEJNCD
     C           KLVCWE    CHAIN@EXRETY              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Order Types            NF'
     C                     MOVEL'USR1063' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1063' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Customer Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1ANC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ANC7' defaulted for 'AR Customer Number'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1ANC7    PARM #1ANC7    WQ0235  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ANC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ANC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1ANC7    BBBKC7
     C           KLVDBB    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Customer Master        NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to State Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1DBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1DBCD' defaulted for 'Ship To State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1DBCD    PARM #1DBCD    WQ0236  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1DBCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DBCD    IFEQ *BLANK                     State Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1DBCD    ACBGCD
     C           KLVEAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'State Master           NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Customer Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1B0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1B0C7' defaulted for 'Bill to Customer'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1B0C7    PARM #1B0C7    WQ0237  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1B0C7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1B0C7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1B0C7    BBBKC7
     C           KLVFBB    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Customer Master        NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to State Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BHCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1BHCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BHCD' defaulted for 'Bill to State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1BHCD    PARM #1BHCD    WQ0238  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BHCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BHCD    IFEQ *BLANK                     State Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1BHCD    ACBGCD
     C           KLVGAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'State Master           NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A0DT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A0DT    AFBCDT
     C           KLVHAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A5DT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A5DT    AFBCDT
     C           KLVIAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1GNDT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1GNDT    AFBCDT
     C           KLVJAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ACDT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1ACDT    AFBCDT
     C           KLVKAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Terms Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1AQCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Terms Code
     C           YPMTFD    OREQ '#1AQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1AQCD' defaulted for 'Terms Code'.
     C                     CALL 'PDDMSRR'              90  SEL Active Term
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0239  30       Company Number
     C           #1AQCD    PARM #1AQCD    WQ0240  2        Terms Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AQCD    IFNE *BLANK                     Terms Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VLEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AQCD    IFEQ *BLANK                     Terms Code
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLAO    KLIST
     C                     KFLD           AOAIC3           Company Number
     C                     KFLD           AOAQCD           Terms Code
      * Setup key
     C                     Z-ADD#1AIC3    AOAIC3
     C                     MOVEL#1AQCD    AOAQCD
     C           KLVLAO    CHAIN@AOREU1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Terms Master           NF'
     C                     MOVEL'USR0037' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0037' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Carrier Info
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BZNA    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1BZNA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0241  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BZNA    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BZNA    IFEQ *BLANK                     Carrier Code
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMFF    KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    FFBZNA
     C           KLVMFF    CHAIN@FFREUG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Carrier Info           NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to OP Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CQCD' defaulted for 'Reason Code'.
     C                     CALL 'OPTNSRR'              90  Zzz Order Reaso
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0242  3        Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPTNSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNCX    KLIST
     C                     KFLD           CXCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    CXCQCD
     C           KLVNCX    CHAIN@CXRET4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'OP Reason Codes        NF'
     C                     MOVEL'USR0504' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0504' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AODT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AODT    AFBCDT
     C           KLVOAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VOEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1EIDT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1EIDT    AFBCDT
     C           KLVPAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VPEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to Enterprise Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1E8CD    WK1X02  1
     C                     MOVEL#1E9CD    WK1X03  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Enterprise Code
     C           YPMTFD    OREQ '#1E8CD'
     C           WK1X03    OREQ '?'                        Enterprise Code
     C           YPMTFD    OREQ '#1E9CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1E8CD' defaulted for 'Accounts Receiv_Ent 1'.
      * Field '(DTL) #1E9CD' defaulted for 'Accounts Receiv_Ent 2'.
     C                     CALL 'CAXTSRR'              90  ZZZ Enterprise
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0243  30       Company Number
     C           #1E8CD    PARM #1E8CD    WQ0244  4        Enterprise Code
     C           #1E9CD    PARM #1E9CD    WQ0245 12        Enterprise Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAXTSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1E8CD    IFNE *BLANK                     Enterprise Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1E9CD    IFNE *BLANK                     Enterprise Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VQEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1E8CD    IFEQ *BLANK                     Enterprise Code
     C           #1E9CD    ANDEQ*BLANK                     Enterprise Code
     C                     GOTO VQEXIT
     C                     END
      *
     C           KLVQDS    KLIST
     C                     KFLD           DSAIC3           Company Number
     C                     KFLD           DSDQCD           Enterprise Code
     C                     KFLD           DSDRCD           Enterprise Code
      * Setup key
     C                     Z-ADD#1AIC3    DSAIC3
     C                     MOVEL#1E8CD    DSDQCD
     C                     MOVEL#1E9CD    DSDRCD
     C           KLVQDS    CHAIN@DSRETN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VQEXIT
     C                     END
      * Send message 'Enterprise Master      NF'
     C                     MOVEL'USR0765' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0765' W0RTN
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to Load Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #1RMNB    PARM #1RMNB    WQ0246  70       Load ID
     C           #1AIC3    PARM #1AIC3    WQ0247  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VREXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RMNB    IFEQ *ZERO                      Load ID
     C                     GOTO VREXIT
     C                     END
      *
     C           KLVRWH    KLIST
     C                     KFLD           WHRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WHRMNB
     C           KLVRWH    CHAIN@FJCPBN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VREXIT
     C                     END
      * Send message 'Load Header            NF'
     C                     MOVEL'USR1188' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1188' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Sales Route Cod
     C           YPMTFD    OREQ '#1R4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0248  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1R4CD    IFNE *BLANK                     Sales Route Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VSEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R4CD    IFEQ *BLANK                     Sales Route Cod
     C                     GOTO VSEXIT
     C                     END
      *
     C           KLVSJE    KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD
     C           KLVSJE    CHAIN@JEREWS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VSEXIT
     C                     END
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1800' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         VTCKRL    BEGSR
      *================================================================
      * Check reference to Manager Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BFCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Manager Level C
     C           YPMTFD    OREQ '#1BFCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BFCD' defaulted for 'Manager Level Code'.
     C                     CALL 'CABRSRR'              90  SEL Manager Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1BFCD    PARM #1BFCD    WQ0249  2        Manager Level C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BFCD    IFNE *BLANK                     Manager Level C
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VTEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BFCD    IFEQ *BLANK                     Manager Level C
     C                     GOTO VTEXIT
     C                     END
      *
     C           KLVTWS    KLIST
     C                     KFLD           WSBFCD           Manager Level C
      * Setup key
     C                     MOVEL#1BFCD    WSBFCD
     C           KLVTWS    CHAIN@ALREVE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VTEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VTEXIT
     C                     END
      * Send message 'Manager Level          NF'
     C                     MOVEL'USR0030' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0030' W0RTN
      *================================================================
     CSR         VTEXIT    ENDSR
      /EJECT
     CSR         VUCKRL    BEGSR
      *================================================================
      * Check reference to VP Level Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        VP Level Code
     C           YPMTFD    OREQ '#1Q4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1Q4CD' defaulted for 'VP Level Code'.
     C                     CALL 'PDE0SRR'              90  SEL VP Level Ac
     C                     PARM *BLANK    W0RTN   7
     C           #1Q4CD    PARM #1Q4CD    WQ0250  3        VP Level Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1Q4CD    IFNE *BLANK                     VP Level Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VUEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q4CD    IFEQ *BLANK                     VP Level Code
     C                     GOTO VUEXIT
     C                     END
      *
     C           KLVUIF    KLIST
     C                     KFLD           IFQ4CD           VP Level Code
      * Setup key
     C                     MOVEL#1Q4CD    IFQ4CD
     C           KLVUIF    CHAIN@IFREWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VUEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VUEXIT
     C                     END
      * Send message 'VP Level Master        NF'
     C                     MOVEL'USR1661' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1661' W0RTN
      *================================================================
     CSR         VUEXIT    ENDSR
      /EJECT
     CSR         VVCKRL    BEGSR
      *================================================================
      * Check reference to Order Header TRG
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           YPMTFD    OREQ '#1T3NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1T3NB' defaulted for 'Attach to Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0251  30       Company Number
     C           #1T3NB    PARM #1T3NB    WQ0252  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1T3NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VVEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1T3NB    IFEQ *ZERO                      Order Number
     C                     GOTO VVEXIT
     C                     END
      *
     C           KLVVBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1T3NB    BEC4NB
     C           KLVVBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VVEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VVEXIT
     C                     END
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' W0RTN
      *================================================================
     CSR         VVEXIT    ENDSR
      /EJECT
     CSR         VWCKRL    BEGSR
      *================================================================
      * Check reference to Internal Reason
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1SICD    IFEQ *BLANK                     Internal Reason
     C                     GOTO VWEXIT
     C                     END
      *
     C           KLVWJH    KLIST
     C                     KFLD           JHSGCD           Internal Reason
      * Setup key
     C                     MOVEL#1SICD    JHSGCD
     C           KLVWJH    CHAIN@JHREXO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VWEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VWEXIT
     C                     END
      * Send message 'Internal Reason        NF'
     C                     MOVEL'USR1835' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1835' W0RTN
      *================================================================
     CSR         VWEXIT    ENDSR
      /EJECT
     CSR         VXCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AWDT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VXEXIT
     C                     END
      *
     C           KLVXAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AWDT    AFBCDT
     C           KLVXAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VXEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VXEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VXEXIT    ENDSR
      /EJECT
     CSR         VYCKRL    BEGSR
      *================================================================
      * Check reference to Event Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Event Code
     C           YPMTFD    OREQ '#1JPCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JPCD' defaulted for 'Event Code'.
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #1JPCD    PARM #1JPCD    WQ0253  2        Event Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1JPCD    IFNE *BLANK                     Event Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VYEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JPCD    IFEQ *BLANK                     Event Code
     C                     GOTO VYEXIT
     C                     END
      *
     C           KLVYEZ    KLIST
     C                     KFLD           EZJPCD           Event Code
      * Setup key
     C                     MOVEL#1JPCD    EZJPCD
     C           KLVYEZ    CHAIN@EZREYT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VYEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VYEXIT
     C                     END
      * Send message 'Event Types            NF'
     C                     MOVEL'USR1076' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1076' W0RTN
      *================================================================
     CSR         VYEXIT    ENDSR
      /EJECT
     CSR         VZCKRL    BEGSR
      *================================================================
      * Check reference to AR Claim Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1C0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1C0C7' defaulted for 'Claim Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0042' defaulted for 'Claim Company Number'.
      * Field '(LCL) YL0043' defaulted for 'Claim Ship to Customer'.
     C                     CALL 'PMCSSRR'              90  Sel A/R Claim
     C                     PARM *BLANK    W0RTN   7
     C           #1C0C7    PARM #1C0C7    WQ0254  70       Claim Number
     C           YL0042    PARM YL0042    WQ0255  30       Claim Company N
     C           YL0043    PARM YL0043    WQ0256  70       Claim Ship to C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,46           *
     C                     END
      *
     C           #1C0C7    IFNE *ZERO                      Claim Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VZEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1C0C7    IFEQ *ZERO                      Claim Number
     C                     GOTO VZEXIT
     C                     END
      *
     C           KLVZMK    KLIST
     C                     KFLD           MKC0C7           Claim Number
      * Setup key
     C                     Z-ADD#1C0C7    MKC0C7
     C           KLVZMK    CHAIN@MKCPWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VZEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VZEXIT
     C                     END
      * Send message 'AR Claim Header        NF'
     C                     MOVEL'USR2729' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2729' W0RTN
      *================================================================
     CSR         VZEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XTCKTM    BEGSR
      *================================================================
      * Validate time format
      *================================================================
      * If time is zero, do not check
     C           XTTIM     CABEQ*ZERO     XTCKTE
     C                     MOVEL*BLANK    W0RTN   7
     C           YPMTFD    CABNE*BLANK    XTCKTE
      *
      * Check hours in range 0 to 23
      * Check minutes in range 0 to 59
      * Check seconds in range 0 to 59
     C           XTHH      IFLT *ZERO
     C           XTHH      ORGT 23
     C           XTNN      ORLT *ZERO
     C           XTNN      ORGT 59
     C           XTSS      ORLT *ZERO
     C           XTSS      ORGT 59
      * Send error message
      * Send message '*Invalid time'
     C                     MOVEL'Y2U0019' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0019' W0RTN
     C                     END
      *================================================================
     CSR         XTCKTE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR1    IFEQ '1'
     C           W0OVR1    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C                     Z-ADDW0ROW1    ZZCSRW
     C                     Z-ADDW0COL1    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y2SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y2EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL2'
      * DETAIL 2 Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW2END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW2BEG,F
     C                     MOVELW2NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0ROW1  30
     C                     Z-ADD0         W0COL1  30
     C                     MOVE '2'       W0OVR1  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE019
     C           ZHCSCL    ANDLE021
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE113
     C           ZHCSCL    ANDLE114
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN74     ANDEQ'0'
     C                     MOVEL'#1Q2CD'  YPMTFD           Shipping Method
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDGE020
     C           ZHCSCL    ANDLE021
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1JNCD'  YPMTFD           Order Type_Sale
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDEQ113
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1PJST'  YPMTFD           LTL Flag
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ020
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN73     ANDEQ'0'
     C                     MOVEL'#1BCST'  YPMTFD           Block Order Fla
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDGE020
     C           ZHCSCL    ANDLE026
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1C0C7'  YPMTFD           Claim Number
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ068
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1FNSX'  YPMTFD           Transfer in Sto
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDEQ076
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1FRSX'  YPMTFD           Shipping Temp C
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDEQ020
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DSPOT'  YPMTFD           Spot Buy  (Y/N)
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ022
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1U2ST'  YPMTFD           Export Status
     C                     END
      *
     C           ZHCSRW    IFEQ 021
     C           ZHCSCL    ANDEQ018
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1BDST'  YPMTFD           Order Certifica
     C                     END
      *
     C           ZHCSRW    IFEQ 021
     C           ZHCSCL    ANDEQ042
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1FQSX'  YPMTFD           Export Docs Go
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * Val Order Hdr Exists   RT - PD Order Header  * 
     C                     EXSR NMRVGN
      * Only allow F3 if order doesn't exist (no processing has been done
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO ZXEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     MOVEL'NOUPD'   P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO ZXEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1BRTX           Ship To Name
     C                     MOVEL*BLANK    P1BCNA           Customer Purcha
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     MOVEL*BLANK    P1Q2CD           Shipping Method
     C                     MOVEL*BLANK    P1U2ST           Export Status
     C                     Z-ADD*ZERO     P1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     MOVEL*BLANK    P1FRSX           Shipping Temp C
     C                     MOVEL*BLANK    P1FTSX           Air Freight Ord
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2APTX           Company Name
     C                     MOVEL*BLANK    P2TAST           First Time Flag
     C                     MOVEL*BLANK    P2G7SX           Ship Method
     C                     MOVEL*BLANK    P2A5AA           Country Code
     C                     MOVEL*BLANK    P2OPSX           User Access
     C                     MOVEL*BLANK    P2O1ST           Live with TPM
     C                     MOVEL*BLANK    P2RYSX           MG Created Load
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3Z9ST           Shipping Method
     C                     MOVEL*BLANK    P3CSST           Load Type Dft
     C                     MOVEL*BLANK    P3Z8ST           LTL Flag Dft
     C                     MOVEL*BLANK    P3CXST           Export Status D
     C                     MOVEL*BLANK    P3SWST           Shrink Wrap Dft
     C                     Z-ADD*ZERO     P3XXTM           Departure Time
     C                     MOVEL*BLANK    P3UECD           Export Code Dft
     C                     MOVEL*BLANK    P3HSST           Allow Mult Whse
     C                     MOVEL*BLANK    P3AMEO           Allow Multi Exp
     C                     MOVEL*BLANK    P3SSDF           Slip Sheet Dft
     C                     MOVEL*BLANK    P3PDFT           Palletize Dft
     C                     MOVEL*BLANK    P3YJSX           Company Organiz
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4OAST           Processing Cycl
     C                     MOVEL*BLANK    P4OBST           Billing Activit
     C                     MOVEL*BLANK    P4OEST           Affect Inventor
     C                     MOVEL*BLANK    P4OFST           Affect Sales Do
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6MPNA           Default Printer
     C                     MOVEL*BLANK    P6WPST           Warehouse Type
     C                     MOVEL*BLANK    P6T0ST           Warehouse Locat
     C                     MOVEL*BLANK    P6X9ST           Outside Warehou
     C                     Z-ADD*ZERO     P6STTP           Reefer Temperat
     C                     MOVEL*BLANK    P6MLSX           Temperature Cod
     C                     MOVEL*BLANK    P6LWAA           OHE Intended fo
     C                     MOVEL*BLANK    P6KSTX           USR Country Des
     C                     MOVEL*BLANK    P6AKTX           Status Flag 7
     C                     MOVEL*BLANK    P6AFTX           Status Flag 8
     C                     MOVEL*BLANK    P6DFTX           Status Flag 9
     C                     MOVEL*BLANK    P6DGTX           Status Flag 10
     C                     MOVEL*BLANK    P6DYTX           Transloader Car
     C                     MOVEL*BLANK    P6A3T1           Initials
      * Clear all neither parameters
     C                     MOVEL*BLANK    P8WUSX           PFS Carlisle Ac
      * Clear all neither parameters
     C                     MOVEL*BLANK    P9BCCD           Salesperson Cod
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field P_O Required Flag
     C                     MOVEL*BLANK    WUPPST  1
      * Define work field Type Code
     C                     MOVEL*BLANK    WUBOCD  2
      * Define work field USR Warehouse Code
     C                     MOVEL*BLANK    WUCPCD  3
      * Define work field Explaination Text 2
     C                     MOVEL*BLANK    WUHFTX 40
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Requested Delivery Dt
     C                     Z-ADD*ZERO     WUAYDZ  70
      * Define work field Requested Delivery Time
     C                     Z-ADD*ZERO     WUAFTM  40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Display 2
     C                     MOVEL*BLANK    WUTJST  1
      * Define work field Lock/Unlock
     C                     MOVEL*BLANK    WUF4ST  1
      * Define work field Date To               USR
     C                     Z-ADD*ZERO     WUJFDT  70
      * Define work field Delivery P_O  Number
     C                     MOVEL*BLANK    WULMT1 38
      * Define work field OHE Intended for ExportCC
     C                     MOVEL*BLANK    WULWAA  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBR5NB           Deliver after t
     C                     Z-ADD*ZERO     WBR6NB           Deliver before
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WBW2NB           Co_Cust Overage
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WCBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field USR Output Only Status
     C                     MOVEL*BLANK    WUE5ST  1
      * Define work field Dock Unavail Start Time
     C                     Z-ADD*ZERO     WUDPTM  60
      * Define work field Dock Unavail End Time
     C                     Z-ADD*ZERO     WUDQTM  60
      * Define work field Explaination 50
     C                     MOVEL*BLANK    WUO3TX 50
      * Define work field Current System Date
     C                     Z-ADD*ZERO     WUSDTE 155
      * Define work field Current System Time
     C                     Z-ADD*ZERO     WUZHNB 155
      * Define work field Note: Text Usr - 50
     C                     MOVEL*BLANK    WUEFT1 50
      * Define work field Status - Mileage
     C                     MOVEL*BLANK    WUFCSX  1
      * Define work field Company Number     041405
     C                     Z-ADD*ZERO     WUBQC3  30
      * Define work field Allow Multi_Company
     C                     MOVEL*BLANK    WUI6ST  1
      * Define work field USR Display 1
     C                     MOVEL*BLANK    WUTIST  1
      * Define work field Order Type_Sales
     C                     MOVEL*BLANK    WUJNCD  2
      * Define work field @Date - ATR
     C                     Z-ADD*ZERO     WUAADT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFP3NB           D_B Number
     C                     Z-ADD*ZERO     WFI6DT           Date of D_B Rat
     C                     Z-ADD*ZERO     WFAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WFANC7           AR Customer Num
     C                     Z-ADD*ZERO     WFBTC7           Parent Customer
     C                     Z-ADD*ZERO     WFS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WFVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WFI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Update Exception Status
     C                     MOVEL*BLANK    WUF6ST  1
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WHRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WHFLAM           Flat Amount
     C                     Z-ADD*ZERO     WHRRNB           Total Stops
     C                     Z-ADD*ZERO     WHSBNB           BOL Time
     C                     Z-ADD*ZERO     WHSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHSDNB           Number Pallets
     C                     Z-ADD*ZERO     WHPAOU           Number Pallets
     C                     Z-ADD*ZERO     WHDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WHSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WHHADT           Actual Arrival
     C                     Z-ADD*ZERO     WHAART           Actual Arrival
     C                     Z-ADD*ZERO     WHDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WHDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WHAQDT           Actual Departur
     C                     Z-ADD*ZERO     WHS6NB           Departure Time
     C                     Z-ADD*ZERO     WHT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WHPRTM           Product Tempera
     C                     Z-ADD*ZERO     WHNPSV           Number Spacers
     C                     Z-ADD*ZERO     WHTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WHGRWE           Gross Weight
     C                     Z-ADD*ZERO     WHF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WHJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WHTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WHJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WHSPTM           Spotted Time
     C                     Z-ADD*ZERO     WHJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WHLFTM           Load Finished T
     C                     Z-ADD*ZERO     WHJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WHBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WHJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WHBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WHKIDT           Truck Departure
     C                     Z-ADD*ZERO     WHASTM           Truck Departure
     C                     Z-ADD*ZERO     WHKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WHAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WHVOAG           Voyage
     C                     Z-ADD*ZERO     WHKBDT           Sail Date
     C                     Z-ADD*ZERO     WHEFDT           Arrival Date
     C                     Z-ADD*ZERO     WHKCDT           Date In
     C                     Z-ADD*ZERO     WHTMIN           Time In
     C                     Z-ADD*ZERO     WHKDDT           Date Out
     C                     Z-ADD*ZERO     WHVMNB           Time Out
     C                     Z-ADD*ZERO     WHOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WHKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WHATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WHBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WHEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WHKKDT           On Yard Date
     C                     Z-ADD*ZERO     WHAVTM           On Yard Time
     C                     Z-ADD*ZERO     WHKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WHAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WHLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WHK0DT           Product Complet
     C                     Z-ADD*ZERO     WHAYTM           Product Complet
     C                     Z-ADD*ZERO     WHKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WHICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WHIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WHK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WHAZTM           Load Door 1
     C                     Z-ADD*ZERO     WHK2DT           Override Total
     C                     Z-ADD*ZERO     WHA0TM           Load Door 2
     C                     Z-ADD*ZERO     WHZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WHPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WHCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WHPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WHCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WHP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WHCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WHP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WHCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WHP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WHCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WHP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WHCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Status Flag 2  Y/N
     C                     MOVEL*BLANK    WUQ2ST  1
      * Define work field Status Flag 3  Y/N
     C                     MOVEL*BLANK    WUQ3ST  1
      * Define work field Status Flag 4  Y/N
     C                     MOVEL*BLANK    WUFMST  1
      * Define work field Status Flag 5  Y/N
     C                     MOVEL*BLANK    WUAJTX  1
      * Define work field Status Flag 6  Y/N
     C                     MOVEL*BLANK    WUACTX  1
      * Define work field Status Flag 7  Y/N
     C                     MOVEL*BLANK    WUAKTX  1
      * Define work field Status Flag 8  Y/N
     C                     MOVEL*BLANK    WUAFTX  1
      * Define work field Status Flag 9  Y/N
     C                     MOVEL*BLANK    WUDFTX  1
      * Define work field Status Flag 12 Y/N
     C                     MOVEL*BLANK    WUDITX  1
      * Define work field Display Flag 1 USR
     C                     MOVEL*BLANK    WUDXSX  1
      * Define work field Email to Warehouse Code
     C                     MOVEL*BLANK    WURJAA  3
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Define work field Email Selection usr
     C                     MOVEL*BLANK    WUVQSX  1
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Header Status USR
     C                     MOVEL*BLANK    WUHSUS  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIANC7           AR Customer Num
     C                     Z-ADD*ZERO     WIBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WIB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WIA0DT           Order Date
     C                     Z-ADD*ZERO     WIA5DT           Requested Ship
     C                     Z-ADD*ZERO     WIGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WIACDT           Cancel Date
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WICXDT           Date of Origina
     C                     Z-ADD*ZERO     WIJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WIA1WG           Order Weight To
     C                     Z-ADD*ZERO     WIEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WIAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WITBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WIRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WIATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WIRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WIT3NB           Attach to Order
     C                     Z-ADD*ZERO     WICONB           Invoice Number
     C                     Z-ADD*ZERO     WIAWDT           Invoice Date
     C                     Z-ADD*ZERO     WIVRVA           A_R order Value
     C                     Z-ADD*ZERO     WIB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WINODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WINPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WINQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WINRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WINSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WIBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WIBQTM           Time of Origina
     C                     Z-ADD*ZERO     WIBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WIBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WIBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WIH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WIH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WIH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WIH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WIH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WIC0C7           Claim Number
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKRMNB           Load ID
     C                     Z-ADD*ZERO     WKRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WKRVNB           Stop_Drop
     C                     Z-ADD*ZERO     WKRWNB           Miles to next s
     C                     Z-ADD*ZERO     WKRXNB           Freight Charge
     C                     Z-ADD*ZERO     WKSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WKT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WKT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WKSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WKKFDT           Appointment Con
     C                     Z-ADD*ZERO     WKACTM           Appointment Con
     C                     Z-ADD*ZERO     WKEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WKAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WKKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WKATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WKHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WKAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WKKKDT           On Yard Date
     C                     Z-ADD*ZERO     WKAVTM           On Yard Time
     C                     Z-ADD*ZERO     WKZ4NB           MPC Number
     C                     Z-ADD*ZERO     WKN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WKN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WKN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WKB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WKB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WKB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Order Entry Hold
     C                     MOVEL*BLANK    WUQNST  1
      * Define work field Ship To Customer Flag
     C                     MOVEL*BLANK    WURJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Define work field Time
     C                     Z-ADD*ZERO     WUAPTM  60
      * Define work field USR Remainder
     C                     Z-ADD*ZERO     WURDNB  40
      * Define work field USR Date - ATR
     C                     Z-ADD*ZERO     WUBQDT  70
      * Define work field USR To Time 4.0
     C                     Z-ADD*ZERO     WUHLNX  40
      * Define work field Must Ship Error
     C                     MOVEL*BLANK    WUB7SX  3
      * Define work field USR Order Number
     C                     Z-ADD*ZERO     WUMPNB  70
      * Define work field Stop_Drop
     C                     Z-ADD*ZERO     WURVNB  50
      * Define work field Shipping Company
     C                     Z-ADD*ZERO     WUBWC3  30
      * Define work field Accounting Company
     C                     Z-ADD*ZERO     WUBTC3  30
      * Define work field Company Number Select
     C                     Z-ADD*ZERO     WUAOC3  30
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Clear all neither parameters
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     Z-ADD*ZERO     EYAATM           Job Time
     C                     Z-ADD*ZERO     EYAXDT           Job Date
      * Define work field Status Flag 20 Y/N
     C                     MOVEL*BLANK    WUU1AS  1
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Freight
     C                     Z-ADD*ZERO     WURQNB 112
      * Define work field Shipping Temp Code C_F
     C                     MOVEL*BLANK    WUFRSX  1
      * Define work field USR Temperature 3.1
     C                     Z-ADD*ZERO     WUPCNX  31
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Text USR 7
     C                     MOVEL*BLANK    WUY8TX  7
      * Define work field Text USR 4
     C                     MOVEL*BLANK    WUZ7TX  4
      * Define work field Change Log Prior Value
     C                     MOVEL*BLANK    WUMNTX 12
      * Define work field Change Log New Value
     C                     MOVEL*BLANK    WUMOTX 12
      * Define work field USR Load Id ALpha
     C                     MOVEL*BLANK    WULONA  7
      * Define work field Order Line Error Type
     C                     MOVEL*BLANK    WUH1ST  3
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Number of Copies
     C                     Z-ADD*ZERO     WUDYNB  20
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field Paper Type USR
     C                     MOVEL*BLANK    WUA7ST  1
      * Define work field Parent Customer
     C                     Z-ADD*ZERO     WUBTC7  70
      * Define work field Auto Order Numbering
     C                     MOVEL*BLANK    WUCHST  1
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Default Printer
     C                     MOVEL*BLANK    WUMPNA 10
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Explaination Text 1
     C                     MOVEL*BLANK    WUHETX 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRWF00  40       Requested Deliv
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local variables for subroutine SARVGN.
     C                     MOVEL*BLANK    WL0001  2
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0003  6
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005  1
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0006  3
     C                     MOVEL*BLANK    WL0007  3
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009 30
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  2
     C                     MOVEL*BLANK    WL0013  3
     C                     MOVEL*BLANK    WL0014 40
     C                     MOVEL*BLANK    WL0015 40
     C                     MOVEL*BLANK    WL0016  3
     C                     MOVEL*BLANK    WL0017  1
     C                     Z-ADD*ZERO     WL0018  40
     C                     MOVEL*BLANK    WL0019  2
     C                     Z-ADD*ZERO     WL0020  52
     C                     Z-ADD*ZERO     WL0021  92
     C                     MOVEL*BLANK    WL0022  3
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  3
     C                     MOVEL*BLANK    WL0025  3
     C                     MOVEL*BLANK    WL0026  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0027  30
     C                     MOVEL*BLANK    WL0028 10
     C                     MOVEL*BLANK    WL0029 40
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0030  70
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0034  30
     C                     Z-ADD*ZERO     WL0035  70
     C                     MOVEL*BLANK    WL0036  3
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0037  3
     C                     MOVEL*BLANK    WL0038 30
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0039  30
     C                     Z-ADD*ZERO     WL0040  70
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0041  30
     C                     MOVEL*BLANK    WL0042 30
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0043  70
     C                     MOVEL*BLANK    WL0044 30
     C                     MOVEL*BLANK    WL0045 30
     C                     MOVEL*BLANK    WL0046 30
     C                     MOVEL*BLANK    WL0047 30
     C                     MOVEL*BLANK    WL0048 20
     C                     MOVEL*BLANK    WL0049  2
     C                     MOVEL*BLANK    WL0050 11
     C                     MOVEL*BLANK    WL0051 25
     C                     Z-ADD*ZERO     WL0052  70
     C                     MOVEL*BLANK    WL0053  1
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055 30
     C                     MOVEL*BLANK    WL0056 30
     C                     MOVEL*BLANK    WL0057 30
     C                     MOVEL*BLANK    WL0058 30
     C                     MOVEL*BLANK    WL0059 20
     C                     MOVEL*BLANK    WL0060  2
     C                     MOVEL*BLANK    WL0061 11
      * Define local variables for subroutine STRVGN.
     C                     MOVEL*BLANK    WL0062  3
     C                     MOVEL*BLANK    WL0063  2
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0064  70
      * Define local variables for subroutine TADLRC.
     C                     Z-ADD*ZERO     WL0065  70
     C                     Z-ADD*ZERO     WL0066  50
      * Define local variables for subroutine TBRVGN.
     C                     Z-ADD*ZERO     WL0067  70
     C                     Z-ADD*ZERO     WL0068 112
      * Define local variables for subroutine TDRVGN.
     C                     Z-ADD*ZERO     WL0069  70
     C                     Z-ADD*ZERO     WL0070  70
      * Define local variables for subroutine TMRVGN.
     C                     MOVEL*BLANK    WL0071  6
     C                     MOVEL*BLANK    WL0072  1
      * Define local variables for subroutine TOINFN.
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  40
     C                     Z-ADD*ZERO     WL0075  70
     C                     Z-ADD*ZERO     WL0076  60
     C                     Z-ADD*ZERO     WL0077  70
     C                     MOVEL*BLANK    WL0078  1
     C                     Z-ADD*ZERO     WL0079  70
     C                     MOVEL*BLANK    WL0080  3
     C                     Z-ADD*ZERO     WL0081  70
      * Define local variables for subroutine TQRVGN.
     C                     MOVEL*BLANK    WL0082  3
      * Define local variables for subroutine TTRVGN.
     C                     MOVEL*BLANK    WL0083  3
     C                     MOVEL*BLANK    WL0084  1
      * Define local variables for subroutine TVRVGN.
     C                     Z-ADD*ZERO     WL0085  30
     C                     Z-ADD*ZERO     WL0086  70
      * Define local variables for subroutine NGCHRC.
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  3
     C                     MOVEL*BLANK    WL0089  3
     C                     Z-ADD*ZERO     WL0090  70
     C                     MOVEL*BLANK    WL0091  3
      * Define local variables for subroutine NHCHRC.
     C                     Z-ADD*ZERO     WL0092  70
     C                     MOVEL*BLANK    WL0093  2
      * Define local variables for subroutine NORVGN.
     C                     MOVEL*BLANK    WL0094 10
     C                     MOVEL*BLANK    WL0095  6
     C                     Z-ADD*ZERO     WL0096  30
     C                     MOVEL*BLANK    WL0097  3
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0005 30
      * Define local work field City
     C                     MOVEL*BLANK    YL0001 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0006 11
      * Define local work field State Code
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field OH Load Plan Ready
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Carrier Code Chg Usr 1
     C                     MOVEL*BLANK    YL0004  3
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field Company Organization
     C                     MOVEL*BLANK    YN0008  1
      * Define null work field CDI Valuation Grouping
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field CDI Unused Sts 3
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field CDI Shipper
     C                     MOVEL*BLANK    YN0011  2
      * Define null work field CDI Produced by co
     C                     MOVEL*BLANK    YN0012  2
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0005  3
      * Define null work field Ord Ent Default Sls Rte
     C                     MOVEL*BLANK    YN0013  1
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Load Acceptance Flag
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Letter of Credit Number
     C                     MOVEL*BLANK    YL0009 50
      * Define local work field Delivery P_O  Number
     C                     MOVEL*BLANK    YL0010 38
      * Define local work field Warehouse Description
     C                     MOVEL*BLANK    YL0011 30
      * Define local work field Address Line 1
     C                     MOVEL*BLANK    YL0012 30
      * Define local work field Address Line 2
     C                     MOVEL*BLANK    YL0013 30
      * Define local work field Address Line 3
     C                     MOVEL*BLANK    YL0014 30
      * Define local work field Zip Postal Code
     C                     MOVEL*BLANK    YL0015 11
      * Define local work field Miles to next stop
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0017  3
      * Define local work field Ord Ent Default Sls Rte
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field SEC Default Sales Channel
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field Cust Shipping Temp
     C                     Z-ADD*ZERO     YL0020  52
      * Define local work field Cust Shipping Temp C_F
     C                     MOVEL*BLANK    YL0021  1
      * Define null work field Item Age Days Fresh
     C                     Z-ADD*ZERO     YN0014  40
      * Define null work field Item Age Days Frozen
     C                     Z-ADD*ZERO     YN0015  40
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0016  52
      * Define local work field Salesperson Name
     C                     MOVEL*BLANK    YL0022 30
      * Define local work field Email to Broker Usr
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Email to Salesperson Usr
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Application WHS Restrict
     C                     MOVEL*BLANK    YL0026  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0017  2
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field Display Flag
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field Must Ship Date        USR
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field Must Ship Time        USR
     C                     Z-ADD*ZERO     YL0031  60
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0032  2
      * Define local work field HPB Employer ID #
     C                     MOVEL*BLANK    YL0033 20
      * Define local work field HPB ULSD Company #
     C                     MOVEL*BLANK    YL0034  4
      * Define local work field HPB ULSD Facility ID
     C                     MOVEL*BLANK    YL0035  5
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0036  2
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0018  3
      * Define null work field Warehouse Location
     C                     MOVEL*BLANK    YN0019  1
      * Define local work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field WHS/Item Access Sts USR
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field Warehouse Type USR
     C                     MOVEL*BLANK    YL0039  2
      * Define local work field Text USR 5
     C                     MOVEL*BLANK    YL0040  5
      * Define local work field Numeric Zip Code USR?
     C                     MOVEL*BLANK    YL0041  1
      * Define null work field Customer Name
     C                     MOVEL*BLANK    YN0020 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0021 20
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0022  2
      * Define null work field County Code
     C                     MOVEL*BLANK    YN0023  6
      * Define null work field Telephone Number FF
     C                     MOVEL*BLANK    YN0024 25
      * Define null work field Fax Number FF
     C                     MOVEL*BLANK    YN0025 25
      * Define null work field Alpha Search
     C                     MOVEL*BLANK    YN0026 25
      * Define null work field Federal Tax Id
     C                     MOVEL*BLANK    YN0027 20
      * Define null work field New Customer Status
     C                     MOVEL*BLANK    YN0028  1
      * Define null work field SIC Number
     C                     MOVEL*BLANK    YN0029  8
      * Define null work field D_B Number
     C                     Z-ADD*ZERO     YN0030  90
      * Define null work field D_B Rating
     C                     MOVEL*BLANK    YN0031  5
      * Define null work field Date of D_B Rating
     C                     Z-ADD*ZERO     YN0032  70
      * Define null work field Credit Line Expire Date
     C                     Z-ADD*ZERO     YN0033  70
      * Define null work field AR Customer Number
     C                     Z-ADD*ZERO     YN0034  70
      * Define null work field Parent Customer
     C                     Z-ADD*ZERO     YN0035  70
      * Define null work field Credit Check AR Customer
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field Credit Check Parent Cust
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field EDI Invoice Sts
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field Order Entry Hold
     C                     MOVEL*BLANK    YN0039  1
      * Define null work field Parent Credit Limit
     C                     Z-ADD*ZERO     YN0040 112
      * Define null work field AR Credit Limit
     C                     Z-ADD*ZERO     YN0041 112
      * Define null work field Order Entry Hold Date
     C                     Z-ADD*ZERO     YN0042  70
      * Define null work field Ship To Customer Flag
     C                     MOVEL*BLANK    YN0043  1
      * Define null work field Field vs In_House flag
     C                     MOVEL*BLANK    YN0044  1
      * Define null work field Email When Order Shipped
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Print Invoice Sts
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Item Reference Status
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Statement Print Frequency
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0049  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0050  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0051  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0052  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0053 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0054 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0055  70
      * Define local work field Claim Company Number
     C                     Z-ADD*ZERO     YL0042  30
      * Define local work field Claim Ship to Customer
     C                     Z-ADD*ZERO     YL0043  70
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0044  1
      * Define null work field Item Age Days
     C                     Z-ADD*ZERO     YN0056  40
      * Define local work field Order Line Error Type
     C                     MOVEL*BLANK    YL0045  3
      * Define local work field OHE Carrier SCAC Code
     C                     MOVEL*BLANK    YL0046  4
      * Define local work field OHE Spot Buy
     C                     MOVEL*BLANK    YL0047  4
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0048  4
      * Define local work field OHE Backhaul Status
     C                     MOVEL*BLANK    YL0049  2
      * Define local work field OHE Backhaul ETA AM_PM
     C                     MOVEL*BLANK    YL0050  2
      * Define local work field OHE Load Haul Type
     C                     MOVEL*BLANK    YL0051  3
      * Define local work field OHE Backhaul Carrier Code
     C                     MOVEL*BLANK    YL0052  3
      * Define local work field OHE Bookings Confirmed
     C                     MOVEL*BLANK    YL0053  3
      * Define local work field OHE EDI Error Reasons
     C                     MOVEL*BLANK    YL0054  5
      * Define local work field Blank 1 USR
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field OHE EDI 943 Action
     C                     MOVEL*BLANK    YL0056  6
      * Define local work field OHE EDI 944 Action
     C                     MOVEL*BLANK    YL0057  6
      * Define local work field OHE EDI 940 Action
     C                     MOVEL*BLANK    YL0058  6
      * Define local work field OHE EDI 945 Action
     C                     MOVEL*BLANK    YL0059  6
      * Define local work field USR Temperature 3.1
     C                     Z-ADD*ZERO     YL0060  31
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0061  6
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0062  3
      * Define local work field From City
     C                     MOVEL*BLANK    YL0063 20
      * Define local work field From State
     C                     MOVEL*BLANK    YL0064  2
      * Define local work field Company Name
     C                     MOVEL*BLANK    YL0065 30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0066  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0067  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Initialise error memories
     C                     MOVE *ZERO     @@I1
     C                     MOVE *ZERO     @@I2
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * ***  Note: Files have maxed out at 50. Use XF if adding a new fun
      * ***** MODIFICATION HISTORY
     C                     EXSR UDSUBR                     ***** MODIFICAT
      *
     C                     MOVEL*BLANK    WN1373 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN1373           User Profile Na
      *
     C                     MOVEL*BLANK    WN1374 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR NNRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN1373    ZA0060           User Profile Na
     C                     MOVEL'OMS'     ZA0061           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN1374    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1373    WL0094    P      User Profile Na
     C                     MOVEL'OMS'     WL0095    P      Application Cod
     C                     EXSR NORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0096    WUAIC3           Company Number
     C                     MOVELWL0097    YL0067    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1374    WL0094    P      User Profile Na
     C                     MOVEL'OMS'     WL0095    P      Application Cod
     C                     EXSR NORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0096    WUAIC3           Company Number
     C                     MOVELWL0097    YL0067    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0067    WUAJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN1373    ZA0062           User Profile Na
     C                     MOVEL'OMS'     ZA0063           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0066    IFNE 0                          *IF
     C                     Z-ADDYL0066    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0067    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           WUAJCD    PARM *BLANK    WQ0766  3        Warehouse Code
     C                     PARM YL0066    WQ0767  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR NPRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * PKTR01 Get default shipping co for customer
      * CASE: PAR.Ship To Customer is not equal to zero
     C           P1BKC7    IFNE *ZERO                      *IF
      * RTV Shipping Co Dft    RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0040           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    WUBQC3           Company Number
      * Set PAR company
      * CASE: PAR.Company Number EQ WRK.ZERO
     C           P1AIC3    IFEQ WUW0NB                     *IF
     C                     Z-ADDWUBQC3    P1AIC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
      * Use user's co if their multi-co = No
      * CASE: WRK.Allow Multi-Company is no
     C           WUI6ST    IFEQ 'N'                        *IF
     C                     Z-ADDWUAIC3    WUBQC3           Company Number
      * Set PAR company
      * CASE: PAR.Company Number EQ WRK.ZERO
     C           P1AIC3    IFEQ WUW0NB                     *IF
     C                     Z-ADDWUBQC3    P1AIC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       WUTIST           USR Display 1
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
      * RTV Dflt Type for Co   RT - User Entry Control  * 
     C                     EXSR NRRVGN
      * Auto order numbering for new order
      * CASE: PAR.Order Number EQ WRK.ZERO
     C           P1C4NB    IFEQ WUW0NB                     *IF
     C                     MOVEL'ADD'     W0PMD            *Program mode
      * CASE: WRK.Allow Multi-Company is yes
     C           WUI6ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     END                             *FI
      * RTV OP status          RT - Company Control  * 
     C                     EXSR NSRVGN
      * CASE: WRK.Auto Order Numbering? is yes
     C           WUCHST    IFEQ 'Y'                        *IF
      * PKTR01 - 7/21/04 Use company 000 for next order nbr
      *  (was using Par.Company Number)
      * RTV Next Order Number  RT - Company Control  * 
     C                     EXSR NTRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     END                             *FI
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'N'       WUE5ST           USR Output Only
     C                     MOVEL'Y'       YL0029           Display Flag
     C                     MOVEL'N'       P2OPSX           User Access
     C                     MOVEL'N'       P6DFTX           Status Flag 9
     C                     MOVEL'N'       P6AFTX           Status Flag 8
     C                     MOVEL'N'       P6DGTX           Status Flag 10
      * ** Display/NonDisplay Deadline Depart Date/Time warning  W288
     C                     MOVEL'N'       P6AKTX           Status Flag 7
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,022   CAT  @CN,023:ZQWUHETX    P      Explaination Te
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,024   CAT  @CN,025:ZQWUO3TX    P      Explaination 50
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,026   CAT  @CN,027:ZQWUEFT1    P      Note: Text Usr
     C                     Z-ADD1         ZQ      50
     C           @CN,028   CAT  @CN,029:ZQWUHFTX    P      Explaination Te
      * User access update?
      * CASE: JOB.*USER is All IS DEV/PRD & Prktest
     C           ##USR     IFEQ @CN,030                    *IF
     C           ##USR     OREQ @CN,031
     C           ##USR     OREQ @CN,032
     C           ##USR     OREQ @CN,033
     C           ##USR     OREQ @CN,034
     C           ##USR     OREQ @CN,035
     C           ##USR     OREQ @CN,036
     C           ##USR     OREQ @CN,037
     C           ##USR     OREQ @CN,038
     C           ##USR     OREQ @CN,039
     C           ##USR     OREQ @CN,040
     C           ##USR     OREQ @CN,041
     C           ##USR     OREQ @CN,042
     C                     MOVEL'U'       P2OPSX           User Access
     C                     END                             *FI
      * EXC Rtv Status        XF - PFS Interface  * 
     C                     CALL 'PBXNXFR'              90  EXC Rtv Status
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0768  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0769  6        PFS Interface C
     C           P8WUSX    PARM *BLANK    WQ0770  1        PFS Carlisle Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * EXC Rtv Status-AS     XF - PFS Interface  * 
     C                     CALL 'PBX2XFR'              90  EXC Rtv Status-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0771  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0772  6        PFS Interface C
     C           YL0044    PARM *BLANK    WQ0773  1        PFS AccuSort Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBX2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
0104301299
** W0END
0104501305
** W0NAM
V1AIC3    V1C4NB
** W1BEG
00791008390088101026010740113701148
01282013300139301538015860162601649
01794018420190501916020500207102074
02098021190212202138023160238602836
02929029340309203098031210318503348
03354033770344103604036100365203658
03697038600390804116041640417204207
04372043780442004454044680447804886
04931049650497304984051420515105187
05221053940541805443054780550505654
05663056990573405761059040595505990
** W1END
00797008450088301055011030114401152
01311013590140001567016150164101656
01823018710191201923020690207202084
02117021200213202177023400243502850
02930029470309303117031600318503348
03373034160345503606036290365403673
03702038660390804123041700417204218
04372043820442204465044750447904886
04937049700498004993051470515905193
05250053940541805454054780550605659
05671057110573405762059330596705990
** W1NAM
V1BKC7    V1B0C7    VDFKNB    #1BRTX    #1AETX    V1EIDT    #1AFTM
#1HMNA    #1B1NA    V1A5DT    #1HONA    #1B3NA    #DMTTX    V1AODT
#1HPNA    #1B4NA    VDA0DZ    #DBUTM    #1HNNA    #1DBCD    #1CKTX
#1B2NA    #1BHCD    #1C8TX    #DHETX    #DBVTX    #DO3TX    #1BCNA
#1Q2CD    #DS7NA    #1JNCD    #DJVNA    #1B6NA    #1PJST    #1BCST
#DVLT1    #1BYNA    #DNLTX    #DBCCD    #DALTX    #DAJCD    #DO6NA
#1TBNB    V1C0C7    #1FNSX    V1A0DT    #1RNNB    #1FRSX    #DHEVL
#DSPOT    #DQIU1    #1FXSX    #DHFVL    #DYMTX    #DBOCD    #1U2ST
V1C4NB    V1NODT    #1BRTM    #DV5T1    #DKXCD    #DDATX    #1RMNB
#DWBT1    #1BDST    #1FQSX    #DCDWG    #1GWST    #1FVSX    #DLWAA
#DD6T1    #1JZVA    #1XIST    #1FUSX    #DAKU1    #1A1WG    #1XJST
** DETAIL 2 Screen: Field position and name array
0105601312
** W2END
0105801318
** W2NAM
V1AIC3    V1C4NB
** @CN
00001 --- FIRM ORDER ----
00002 --- BLOCK ORDER ---
00003 Y2U0005
00004 Scheduled Ship
00005 Order Number . . . . :
00006 Type Cd:
00007 Sls Chn:
00008 To WHS:
00009 Order Type . . . . . :
00010 USR0752
00011 Deleted
00012 PMGFE2R
00013 Sales Orders
00014 Y2U0003
00015 USR0018
00016 POIRXFR
00017 PDSVE1R
00018 PDN9EFR
00019 Print Acknowledgement
00020 Y2U9999
00021 Print Get Ready Report
00022 Multi-Ord Ld-Call Sched f
00023 /sched ship chg
00024 WARN:Invalid DDTime-durin
00025 g Whse Restricted time
00026 WARN:Invld DDTime-must lo
00027 ad and ship before now
00028 Detail records have upld
00029 errors pending
00030 ALICEB
00031 ISALICEB
00032 PRKTEST
00033 ISPURVAP
00034 ISPPATE
00035 ISROSEM
00036 ISRCENT
00037 ISSMASO
00038 ISSUSANM
00039 ISLBUSE
00040 ISLARAB
00041 ISWGAUS
00042 ISELOUC
