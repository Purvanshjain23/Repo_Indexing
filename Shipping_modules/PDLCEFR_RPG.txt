     H/TITLE Edt Online Ld Schdlng EF  Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated
     H* - Key changes are not allowed
     H* - New records cannot be added
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/08/21  Time  : 13:44:24
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDLCEFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Edt Online Ld Schdlng EF  Edit file
      *
     FPDMHCPL3IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Load Schdlng Position     OCo/SSd/DDD/DDT/Ld/Itm/W
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDMHCPL8IF  E           K        DISK
      * RSQ : Load Schdlng Position     DB1 Date/Time
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FOMFJCPLFIF  E           K        DISK
      * RSQ : Load Header               Whse/SchdShpDt/Load
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPOA3REL2IF  E           K        DISK
      * RSQ : Load Slotting Sched Ctl   Co/Whse/Day  (D)
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDMHCPLCIF  E           K        DISK
      * RSQ : Load Schdlng Position     PCO/ShipDt/Ddln/Ld,2
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@MHCPYF
      * Load Schdlng Position     DB1 Date/Time
      * Renamed input format fields
     I              MHHGCD                          WAHGCD
     I              MHCQC3                          WACQC3
     I              MHLQAA                          WALQAA
     I              MHCUC3                          WACUC3
     I              MHLUAA                          WALUAA
     I              MHSPSQ                          WASPSQ
     I              MHBMSX                          WABMSX
     I              MHL7DT                          WAL7DT
     I              MHC4NB                          WAC4NB
     I              MHRMNB                          WARMNB
     I              MHAODT                          WAAODT
     I              MHJPCD                          WAJPCD
     I              MHKBQT                          WAKBQT
     I              MHKCQT                          WAKCQT
     I              MHKHQT                          WAKHQT
     I              MHKDQT                          WAKDQT
     I              MHKEQT                          WAKEQT
     I              MHKFQT                          WAKFQT
     I              MHH1QT                          WAH1QT
     I              MHKGQT                          WAKGQT
     I              MHKZDT                          WAKZDT
     I              MHAXTM                          WAAXTM
     I              MHBOSX                          WABOSX
     I              MHBPSX                          WABPSX
     I              MHBQSX                          WABQSX
     I              MHUNUS                          WAUNUS
     I              MHUNU2                          WAUNU2
     I              MHT4NB                          WAT4NB
     I              MHRVNB                          WARVNB
     I              MHBUST                          WABUST
     I              MHSTDT                          WASTDT
     I              MHN5NY                          WAN5NY
     I              MHRINY                          WARINY
     I              MHTIDT                          WATIDT
     I              MHTJDT                          WATJDT
     I              MHTNDT                          WATNDT
     I              MHTODT                          WATODT
     I              MHUVST                          WAUVST
     I              MHUWST                          WAUWST
     I              MHUXST                          WAUXST
     I              MHVSST                          WAVSST
     I              MHAATM                          WAAATM
     I              MHAYNA                          WAAYNA
     I              MHA0NA                          WAA0NA
     I              MHAXDT                          WAAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@MHCPCW
      * Load Schdlng Position     PCO/ShipDt/Ddln/Ld,2
      * Renamed input format fields
     I              MHHGCD                          WCHGCD
     I              MHCQC3                          WCCQC3
     I              MHLQAA                          WCLQAA
     I              MHCUC3                          WCCUC3
     I              MHLUAA                          WCLUAA
     I              MHSPSQ                          WCSPSQ
     I              MHBMSX                          WCBMSX
     I              MHL7DT                          WCL7DT
     I              MHC4NB                          WCC4NB
     I              MHRMNB                          WCRMNB
     I              MHAODT                          WCAODT
     I              MHJPCD                          WCJPCD
     I              MHKBQT                          WCKBQT
     I              MHKCQT                          WCKCQT
     I              MHKHQT                          WCKHQT
     I              MHKDQT                          WCKDQT
     I              MHKEQT                          WCKEQT
     I              MHKFQT                          WCKFQT
     I              MHH1QT                          WCH1QT
     I              MHKGQT                          WCKGQT
     I              MHKZDT                          WCKZDT
     I              MHAXTM                          WCAXTM
     I              MHBOSX                          WCBOSX
     I              MHBPSX                          WCBPSX
     I              MHBQSX                          WCBQSX
     I              MHUNUS                          WCUNUS
     I              MHUNU2                          WCUNU2
     I              MHT4NB                          WCT4NB
     I              MHRVNB                          WCRVNB
     I              MHBUST                          WCBUST
     I              MHSTDT                          WCSTDT
     I              MHN5NY                          WCN5NY
     I              MHRINY                          WCRINY
     I              MHTIDT                          WCTIDT
     I              MHTJDT                          WCTJDT
     I              MHTNDT                          WCTNDT
     I              MHTODT                          WCTODT
     I              MHUVST                          WCUVST
     I              MHUWST                          WCUWST
     I              MHUXST                          WCUXST
     I              MHVSST                          WCVSST
     I              MHAATM                          WCAATM
     I              MHAYNA                          WCAYNA
     I              MHA0NA                          WCA0NA
     I              MHAXDT                          WCAXDT
      *
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WFRMNB
     I              FLRUNB                          WFRUNB
     I              FLRVNB                          WFRVNB
     I              FLDQTX                          WFDQTX
     I              FLRWNB                          WFRWNB
     I              FLRXNB                          WFRXNB
     I              FLSQNB                          WFSQNB
     I              FLT0NB                          WFT0NB
     I              FLT1NB                          WFT1NB
     I              FLR1NB                          WFR1NB
     I              FLAIC3                          WFAIC3
     I              FLC4NB                          WFC4NB
     I              FLVCST                          WFVCST
     I              FLKEDT                          WFKEDT
     I              FLSXNB                          WFSXNB
     I              FLKFDT                          WFKFDT
     I              FLACTM                          WFACTM
     I              FLK5TX                          WFK5TX
     I              FLW5CD                          WFW5CD
     I              FLEJDT                          WFEJDT
     I              FLAGTM                          WFAGTM
     I              FLKJDT                          WFKJDT
     I              FLATTM                          WFATTM
     I              FLHDDT                          WFHDDT
     I              FLAUTM                          WFAUTM
     I              FLKKDT                          WFKKDT
     I              FLAVTM                          WFAVTM
     I              FLZ4NB                          WFZ4NB
     I              FLY7ST                          WFY7ST
     I              FLY2ST                          WFY2ST
     I              FLWHTX                          WFWHTX
     I              FLWITX                          WFWITX
     I              FLWJTX                          WFWJTX
     I              FLWKTX                          WFWKTX
     I              FLWLTX                          WFWLTX
     I              FLN7DT                          WFN7DT
     I              FLN8DT                          WFN8DT
     I              FLN9DT                          WFN9DT
     I              FLB3TM                          WFB3TM
     I              FLB4TM                          WFB4TM
     I              FLB5TM                          WFB5TM
     I              FLIASX                          WFIASX
     I              FLIBSX                          WFIBSX
     I              FLICSX                          WFICSX
     I              FLWVTX                          WFWVTX
     I              FLWWTX                          WFWWTX
     I              FLWXTX                          WFWXTX
     I              FLUVST                          WFUVST
     I              FLUWST                          WFUWST
     I              FLUXST                          WFUXST
     I              FLAATM                          WFAATM
     I              FLAYNA                          WFAYNA
     I              FLA0NA                          WFA0NA
     I              FLAXDT                          WFAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WGRMNB
     I              FJAIC3                          WGAIC3
     I              FJAODT                          WGAODT
     I              FJPJST                          WGPJST
     I              FJPKST                          WGPKST
     I              FJRNNB                          WGRNNB
     I              FJDMTX                          WGDMTX
     I              FJDNTX                          WGDNTX
     I              FJDOTX                          WGDOTX
     I              FJWTTX                          WGWTTX
     I              FJWUTX                          WGWUTX
     I              FJRPNB                          WGRPNB
     I              FJFLAM                          WGFLAM
     I              FJXQST                          WGXQST
     I              FJRRNB                          WGRRNB
     I              FJDXTX                          WGDXTX
     I              FJDYTX                          WGDYTX
     I              FJSBNB                          WGSBNB
     I              FJBZNA                          WGBZNA
     I              FJRONB                          WGRONB
     I              FJSQNB                          WGSQNB
     I              FJR1NB                          WGR1NB
     I              FJVCST                          WGVCST
     I              FJVDST                          WGVDST
     I              FJSDNB                          WGSDNB
     I              FJPAOU                          WGPAOU
     I              FJDGWG                          WGDGWG
     I              FJSXNB                          WGSXNB
     I              FJHADT                          WGHADT
     I              FJAART                          WGAART
     I              FJDHWG                          WGDHWG
     I              FJDIWG                          WGDIWG
     I              FJAQDT                          WGAQDT
     I              FJS6NB                          WGS6NB
     I              FJT4NB                          WGT4NB
     I              FJPRTM                          WGPRTM
     I              FJNPSV                          WGNPSV
     I              FJJ8TX                          WGJ8TX
     I              FJTLMI                          WGTLMI
     I              FJJ9TX                          WGJ9TX
     I              FJQ2CD                          WGQ2CD
     I              FJVPCD                          WGVPCD
     I              FJDBCD                          WGDBCD
     I              FJGRWE                          WGGRWE
     I              FJXCCD                          WGXCCD
     I              FJU2ST                          WGU2ST
     I              FJF9DT                          WGF9DT
     I              FJONTM                          WGONTM
     I              FJJ4DT                          WGJ4DT
     I              FJTRTM                          WGTRTM
     I              FJJ5DT                          WGJ5DT
     I              FJSPTM                          WGSPTM
     I              FJJ6DT                          WGJ6DT
     I              FJLFTM                          WGLFTM
     I              FJJ7DT                          WGJ7DT
     I              FJBOTM                          WGBOTM
     I              FJJ8DT                          WGJ8DT
     I              FJBLTM                          WGBLTM
     I              FJKIDT                          WGKIDT
     I              FJASTM                          WGASTM
     I              FJKADT                          WGKADT
     I              FJAJCM                          WGAJCM
     I              FJXACD                          WGXACD
     I              FJOANA                          WGOANA
     I              FJK4TX                          WGK4TX
     I              FJVOAG                          WGVOAG
     I              FJKBDT                          WGKBDT
     I              FJNBBO                          WGNBBO
     I              FJW4CD                          WGW4CD
     I              FJEFDT                          WGEFDT
     I              FJCNTN                          WGCNTN
     I              FJKCDT                          WGKCDT
     I              FJTMIN                          WGTMIN
     I              FJKDDT                          WGKDDT
     I              FJVMNB                          WGVMNB
     I              FJOCFR                          WGOCFR
     I              FJKJDT                          WGKJDT
     I              FJATTM                          WGATTM
     I              FJOTRS                          WGOTRS
     I              FJRNST                          WGRNST
     I              FJBRBK                          WGBRBK
     I              FJEIDT                          WGEIDT
     I              FJRMST                          WGRMST
     I              FJAJCD                          WGAJCD
     I              FJKKDT                          WGKKDT
     I              FJAVTM                          WGAVTM
     I              FJKZDT                          WGKZDT
     I              FJAXTM                          WGAXTM
     I              FJLHOS                          WGLHOS
     I              FJLHOR                          WGLHOR
     I              FJWNTX                          WGWNTX
     I              FJOITX                          WGOITX
     I              FJOJTX                          WGOJTX
     I              FJLLDT                          WGLLDT
     I              FJLSHG                          WGLSHG
     I              FJYPST                          WGYPST
     I              FJK0DT                          WGK0DT
     I              FJAYTM                          WGAYTM
     I              FJKNNX                          WGKNNX
     I              FJICWG                          WGICWG
     I              FJIDWG                          WGIDWG
     I              FJH9SX                          WGH9SX
     I              FJWOTX                          WGWOTX
     I              FJK1DT                          WGK1DT
     I              FJAZTM                          WGAZTM
     I              FJK2DT                          WGK2DT
     I              FJA0TM                          WGA0TM
     I              FJROST                          WGROST
     I              FJRPST                          WGRPST
     I              FJRQST                          WGRQST
     I              FJRRST                          WGRRST
     I              FJZBVA                          WGZBVA
     I              FJWPTX                          WGWPTX
     I              FJWQTX                          WGWQTX
     I              FJWRTX                          WGWRTX
     I              FJWSTX                          WGWSTX
     I              FJRVSX                          WGRVSX
     I              FJRUSX                          WGRUSX
     I              FJRWSX                          WGRWSX
     I              FJRXSX                          WGRXSX
     I              FJRYSX                          WGRYSX
     I              FJRZSX                          WGRZSX
     I              FJR0SX                          WGR0SX
     I              FJR1SX                          WGR1SX
     I              FJR2SX                          WGR2SX
     I              FJR3SX                          WGR3SX
     I              FJR4SX                          WGR4SX
     I              FJPYDT                          WGPYDT
     I              FJCKTM                          WGCKTM
     I              FJPZDT                          WGPZDT
     I              FJCLTM                          WGCLTM
     I              FJP0DT                          WGP0DT
     I              FJCMTM                          WGCMTM
     I              FJP1DT                          WGP1DT
     I              FJCNTM                          WGCNTM
     I              FJP2DT                          WGP2DT
     I              FJCOTM                          WGCOTM
     I              FJP3DT                          WGP3DT
     I              FJCQTM                          WGCQTM
     I              FJUVST                          WGUVST
     I              FJUWST                          WGUWST
     I              FJUXST                          WGUXST
     I              FJAATM                          WGAATM
     I              FJAYNA                          WGAYNA
     I              FJA0NA                          WGA0NA
     I              FJAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPDMHCPL0
      * UPD : Load Schdlng Position     Update index
      * Current/previous master file format fields for change control
      *
      * Outward parameters
     IPARC        DS                              8
      * KEY : Order Header TRG          Load Exports
      * I : RST Load ID
     I                                    P   1   40PARMNB
      *
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPBRC        DS                            146
      * RCD : Load Schdlng Position     OCo/SSd/DDD/DDT/Ld/Itm/W
      * B : RST LSP Order Company
     I                                    P  10  110PBCUC3
      * B : RST LSP Order Warehouse
     I                                       12  14 PBLUAA
      * I : MAP Thru Scheduled Ship Date
     I                                    P  20  230PBL7DT
      * I : RST Load ID
     I                                    P  28  310PBRMNB
      * I : RST Scheduled Ship Date
     I                                    P  32  350PBAODT
      * I : RST Deadline Departure Date
     I                                    P  70  730PBKZDT
      * I : RST Deadline Departure Time
     I                                    P  74  770PBAXTM
      * I : MAP Job Time
     I                                    P 119 1220PBAATM
      * I : MAP Job Date
     I                                    P 143 1460PBAXDT
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WGRMNB
     I              FJAIC3                          WGAIC3
     I              FJAODT                          WGAODT
     I              FJPJST                          WGPJST
     I              FJPKST                          WGPKST
     I              FJRNNB                          WGRNNB
     I              FJDMTX                          WGDMTX
     I              FJDNTX                          WGDNTX
     I              FJDOTX                          WGDOTX
     I              FJWTTX                          WGWTTX
     I              FJWUTX                          WGWUTX
     I              FJRPNB                          WGRPNB
     I              FJFLAM                          WGFLAM
     I              FJXQST                          WGXQST
     I              FJRRNB                          WGRRNB
     I              FJDXTX                          WGDXTX
     I              FJDYTX                          WGDYTX
     I              FJSBNB                          WGSBNB
     I              FJBZNA                          WGBZNA
     I              FJRONB                          WGRONB
     I              FJSQNB                          WGSQNB
     I              FJR1NB                          WGR1NB
     I              FJVCST                          WGVCST
     I              FJVDST                          WGVDST
     I              FJSDNB                          WGSDNB
     I              FJPAOU                          WGPAOU
     I              FJDGWG                          WGDGWG
     I              FJSXNB                          WGSXNB
     I              FJHADT                          WGHADT
     I              FJAART                          WGAART
     I              FJDHWG                          WGDHWG
     I              FJDIWG                          WGDIWG
     I              FJAQDT                          WGAQDT
     I              FJS6NB                          WGS6NB
     I              FJT4NB                          WGT4NB
     I              FJPRTM                          WGPRTM
     I              FJNPSV                          WGNPSV
     I              FJJ8TX                          WGJ8TX
     I              FJTLMI                          WGTLMI
     I              FJJ9TX                          WGJ9TX
     I              FJQ2CD                          WGQ2CD
     I              FJVPCD                          WGVPCD
     I              FJDBCD                          WGDBCD
     I              FJGRWE                          WGGRWE
     I              FJXCCD                          WGXCCD
     I              FJU2ST                          WGU2ST
     I              FJF9DT                          WGF9DT
     I              FJONTM                          WGONTM
     I              FJJ4DT                          WGJ4DT
     I              FJTRTM                          WGTRTM
     I              FJJ5DT                          WGJ5DT
     I              FJSPTM                          WGSPTM
     I              FJJ6DT                          WGJ6DT
     I              FJLFTM                          WGLFTM
     I              FJJ7DT                          WGJ7DT
     I              FJBOTM                          WGBOTM
     I              FJJ8DT                          WGJ8DT
     I              FJBLTM                          WGBLTM
     I              FJKIDT                          WGKIDT
     I              FJASTM                          WGASTM
     I              FJKADT                          WGKADT
     I              FJAJCM                          WGAJCM
     I              FJXACD                          WGXACD
     I              FJOANA                          WGOANA
     I              FJK4TX                          WGK4TX
     I              FJVOAG                          WGVOAG
     I              FJKBDT                          WGKBDT
     I              FJNBBO                          WGNBBO
     I              FJW4CD                          WGW4CD
     I              FJEFDT                          WGEFDT
     I              FJCNTN                          WGCNTN
     I              FJKCDT                          WGKCDT
     I              FJTMIN                          WGTMIN
     I              FJKDDT                          WGKDDT
     I              FJVMNB                          WGVMNB
     I              FJOCFR                          WGOCFR
     I              FJKJDT                          WGKJDT
     I              FJATTM                          WGATTM
     I              FJOTRS                          WGOTRS
     I              FJRNST                          WGRNST
     I              FJBRBK                          WGBRBK
     I              FJEIDT                          WGEIDT
     I              FJRMST                          WGRMST
     I              FJAJCD                          WGAJCD
     I              FJKKDT                          WGKKDT
     I              FJAVTM                          WGAVTM
     I              FJKZDT                          WGKZDT
     I              FJAXTM                          WGAXTM
     I              FJLHOS                          WGLHOS
     I              FJLHOR                          WGLHOR
     I              FJWNTX                          WGWNTX
     I              FJOITX                          WGOITX
     I              FJOJTX                          WGOJTX
     I              FJLLDT                          WGLLDT
     I              FJLSHG                          WGLSHG
     I              FJYPST                          WGYPST
     I              FJK0DT                          WGK0DT
     I              FJAYTM                          WGAYTM
     I              FJKNNX                          WGKNNX
     I              FJICWG                          WGICWG
     I              FJIDWG                          WGIDWG
     I              FJH9SX                          WGH9SX
     I              FJWOTX                          WGWOTX
     I              FJK1DT                          WGK1DT
     I              FJAZTM                          WGAZTM
     I              FJK2DT                          WGK2DT
     I              FJA0TM                          WGA0TM
     I              FJROST                          WGROST
     I              FJRPST                          WGRPST
     I              FJRQST                          WGRQST
     I              FJRRST                          WGRRST
     I              FJZBVA                          WGZBVA
     I              FJWPTX                          WGWPTX
     I              FJWQTX                          WGWQTX
     I              FJWRTX                          WGWRTX
     I              FJWSTX                          WGWSTX
     I              FJRVSX                          WGRVSX
     I              FJRUSX                          WGRUSX
     I              FJRWSX                          WGRWSX
     I              FJRXSX                          WGRXSX
     I              FJRYSX                          WGRYSX
     I              FJRZSX                          WGRZSX
     I              FJR0SX                          WGR0SX
     I              FJR1SX                          WGR1SX
     I              FJR2SX                          WGR2SX
     I              FJR3SX                          WGR3SX
     I              FJR4SX                          WGR4SX
     I              FJPYDT                          WGPYDT
     I              FJCKTM                          WGCKTM
     I              FJPZDT                          WGPZDT
     I              FJCLTM                          WGCLTM
     I              FJP0DT                          WGP0DT
     I              FJCMTM                          WGCMTM
     I              FJP1DT                          WGP1DT
     I              FJCNTM                          WGCNTM
     I              FJP2DT                          WGP2DT
     I              FJCOTM                          WGCOTM
     I              FJP3DT                          WGP3DT
     I              FJCQTM                          WGCQTM
     I              FJUVST                          WGUVST
     I              FJUWST                          WGUWST
     I              FJUXST                          WGUXST
     I              FJAATM                          WGAATM
     I              FJAYNA                          WGAYNA
     I              FJA0NA                          WGA0NA
     I              FJAXDT                          WGAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPCRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PCDXNB
      * I :  Load ID
     I                                    P  11  140PCRMNB
      * I :  Stop/Drop
     I                                    P  15  170PCRVNB
      * I :  Load Change Type
     I                                       18  23 PCRVST
      * I :  Department Control Code
     I                                       24  26 PCUJST
      * I :  Change Log Prior Value
     I                                       27  38 PCMNTX
      * I :  Change Log New Value
     I                                       39  50 PCMOTX
      * I :  User Id
     I                                       51  60 PCAYNA
      * I :  Job Name
     I                                       61  70 PCA0NA
      * I :  Carrier Code
     I                                       71  73 PCBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PCXMCD
      * I :  Company Number
     I                                    P  77  780PCAIC3
      * I :  Order Number
     I                                    P  79  820PCC4NB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N : MAP Application Code
     I                                        1   6 P1DNCD
      * N : MAP System Date Format
     I                                        7   9 P1B8NA
      * N : MAP User Profile Name
     I                                       10  19 P1AJVN
      * N : MAP Allow Multi-Company
     I                                       20  20 P1I6ST
      * N : MAP Default Printer
     I                                       21  30 P1MPNA
     IP2PARM      DS
      * N :  Default Load Sequence
     I                                        1   1 P2T4ST
     IP3PARM      DS
      * B :  Reprocess User View
     I                                        1   1 P3C8ST
     IP4PARM      DS
      * FLD: *Arrays
      * N : MAP LSP Prodution Warehouse
     I                                        1   3 P4LQAA
      * N : MAP LSP Accounting Co
     I                                    P   4   50P4CQC3
      * N : MAP LSP Order Company
     I                                    P   6   70P4CUC3
      * N : MAP LSP Order Warehouse
     I                                        8  10 P4LUAA
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'The Number of Loads...'
      * Box Load Limit        USR
     I                                    P   1   20ZA0001
      * Calc 3
     I                                    P   3   40ZA0002
      * Message data for 'The Number of Combo...'
      * Box Load Limit        USR
     I                                    P   1   20ZA0003
      * Calc 3
     I                                    P   3   40ZA0004
      * Message data for 'The Number of Export...'
      * Export Load Limit
     I                                    P   1   20ZA0005
      * Number of Copies
     I                                    P   3   40ZA0006
      * Message data for 'CD3 Non numeric data'
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0007
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0008
      * Message data for 'The Number of Loads...'
      * Box Load Limit        USR
     I                                    P   1   20ZA0009
      * Calc 3
     I                                    P   3   40ZA0010
      * Message data for 'The Number of Combo...'
      * Box Load Limit        USR
     I                                    P   1   20ZA0011
      * Calc 3
     I                                    P   3   40ZA0012
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0013
      * Application Code
     I                                       11  16 ZA0014
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0015
      * Application Code
     I                                       11  16 ZA0016
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P3C8ST    PARM P3C8ST    WP0001  1        Reprocess User
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SARVGN
     C                     Z-ADD*ZERO     WUAODT           Scheduled Ship
     C                     MOVELWUGSTX    WUBPSX           Load Grade
     C                     Z-ADD*ZERO     WUKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WUAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WURMNB           Load ID
      * OMS357
      * First time flag 2
      * CASE: WRK.First time flag 2     USR is Yes
     C           WUFTFG    IFEQ 'Y'                        *IF
      * RTV Newest Rcd         RT - Load Schdlng Position  * 
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0001    #CAATM           Job Time
     C                     Z-ADDWL0002    #CAXDT           Job Date
     C                     Z-ADDWL0003    YN0001           Thru Scheduled
     C                     Z-ADD##JDT     WUBQDT           USR Date - ATR
     C                     MOVEL'N'       WUFTFG           First time flag
     C                     MOVEL'INC'     #CVQCD           Include/Exclude
     C                     MOVEL'INC'     #CI0SX           Include/Exclude
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2LUAA    WL0004    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0001    P      Warehouse Type
      * Populate Load Limits and other first time functions
     C                     EXSR UASUBR                     Populate Load L
      * CASE: LCL.Warehouse Type is Fresh
     C           YL0001    IFEQ 'FR'                       *IF
      * ** RTV DOW data for sched ship date day number        E000233
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
     C                     EXSR SJRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD999       #CTQNB           Calc 3
     C                     Z-ADD999       #CBGNX           USR 3 Numeric
     C                     Z-ADD999       #CCOPY           Number of Copie
     C                     END                             *FI
      * Box Load Info Message
      * CASE: CTL.Box Load Limit        USR GT CTL.Calc 3
     C           #CBHNX    IFGT #CTQNB                     *IF
      * Setup message data for message
     C                     Z-ADD#CBHNX    ZA0001           Box Load Limit
     C                     Z-ADD#CTQNB    ZA0002           Calc 3
      * Send message 'The Number of Loads...'
     C                     MOVEL'USR2802' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Combo Load Info Message
      * CASE: CTL.Combo Load Limit GT CTL.USR 3 Numeric         USR
     C           #CBINX    IFGT #CBGNX                     *IF
      * Setup message data for message
     C                     Z-ADD#CBINX    ZA0003           Combo Load Limi
     C                     Z-ADD#CBGNX    ZA0004           USR 3 Numeric
      * Send message 'The Number of Combo...'
     C                     MOVEL'USR2803' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Export Load Info Message
      * CASE: CTL.Export Load Limit GT CTL.Number of Copies
     C           #CIUNX    IFGT #CCOPY                     *IF
      * Setup message data for message
     C                     Z-ADD#CIUNX    ZA0005           Export Load Lim
     C                     Z-ADD#CCOPY    ZA0006           Number of Copie
      * Send message 'The Number of Export...'
     C                     MOVEL'USR2863' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL#2LUAA    YL0013           LSP Order Wareh
     C                     MOVEL#CODCD    WUODCD           USR Unit of Mea
     C                     MOVEL#CTRTX    WUTRTX           usr txt-2
     C                     MOVEL#CBPSX    YL0014           Load Grade
     C                     END
      *................................................................
      * Position file
     C           *LIKE     DEFN #2CUC3    WZCUC3
     C                     MOVEL#2CUC3    WZCUC3           LSP Order Compa
     C           *LIKE     DEFN #2LUAA    WZLUAA
     C                     MOVEL#2LUAA    WZLUAA           LSP Order Wareh
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2KZDT    WZKZDT
     C                     MOVEL#2KZDT    WZKZDT           Deadline Depart
     C           *LIKE     DEFN #2AXTM    WZAXTM
     C                     MOVEL#2AXTM    WZAXTM           Deadline Depart
     C           KPOS      KLIST
     C                     KFLD           MHCUC3           LSP Order Compa
     C                     KFLD           MHAODT           Scheduled Ship
     C                     KFLD           MHKZDT           Deadline Depart
     C                     KFLD           MHAXTM           Deadline Depart
     C                     KFLD           MHRMNB           Load ID
     C                     KFLD           MHHGCD           Item Code
     C                     KFLD           MHLUAA           LSP Order Wareh
      * Setup key
     C                     Z-ADD#2CUC3    MHCUC3
     C                     Z-ADD#2AODT    MHAODT
     C                     Z-ADD#2KZDT    MHKZDT
     C                     Z-ADD#2AXTM    MHAXTM
     C                     Z-ADD#2RMNB    MHRMNB
     C                     Z-ADD#2HGCD    MHHGCD
     C                     MOVEL#2LUAA    MHLUAA
      * 82=EOF
     C           KPOS      SETLL@MHCPU1              82    *
      * 82=EOF
     C  N82                READ @MHCPU1                9182*
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@MHCPU1                  90*
     C  N82                READ @MHCPU1                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  3
     C                     MOVE *ALL'1'   WKIND1  3
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,43
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * Load SFL fields
     C                     EXSR MBFL#1
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * SEL:  Warehouse Code
      * CASE: CTL.LSP Order Warehouse NE DB1.LSP Order Warehouse
     C           #2LUAA    IFNE MHLUAA                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SEL:  Schedule Sequence Number                S16991 DN 11/04/20
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Schedule Sequence Number is GT Zero
      *   |- c2    : CTL.Schedule Sequence Number NE DB1.Schedule Sequenc
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CT4NB    IFGT *ZERO                      *IF
     C           #CT4NB    IFNE MHT4NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SEL:  If Multi Warehouse Load, only select Fresh Warehouse.
      * CASE: RCD.Multiple Warehouses is Multiple Warehouses f/Ld
     C           #1BQSX    IFEQ 'M'                        *IF
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1LUAA    WL0004    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0001    P      Warehouse Type
      * CASE: LCL.Warehouse Type is Frozen
     C           YL0001    IFEQ 'FZ'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Seq = 0 only      (F9 was pressed)   RMC 03/12/07 new Fkey
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0015    IFEQ 'Y'                        *IF
      * 01/12/16 JJH E4682 - Load Scheduling Position with Mercury Gate
      * 05/19/16 RMC E4119 - dont check live with tpm
      * RTV Schd Seq Nbr/ExportRT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0019           Load ID
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    #1T4NB           Schedule Sequen
     C                     MOVELWL0021    WUU2ST    P      Export Status
      * CASE: RCD.Schedule Sequence Number is GT Zero
     C           #1T4NB    IFGT *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  LOAD GRADE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.Load Grade NE DB1.Load Grade
      *   |- c2    : CTL.Load Grade is Not Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CBPSX    IFNE MHBPSX                     *IF
     C           #CBPSX    IFEQ 'C'                        *IF
     C           #CBPSX    OREQ 'L'
     C           #CBPSX    OREQ 'X'
     C           #CBPSX    OREQ 'A'
     C           #CBPSX    OREQ 'P'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Break in Key fields -- select record
      * CASE:
      *  - c1 OR c3 OR c4 OR c5
      *   |- c1    : DB1.Scheduled Ship Date NE WRK.Scheduled Ship Date
      *   |- c3    : DB1.Deadline Departure Date NE WRK.Deadline Departur
      *   |- c4    : DB1.Deadline Departure Time NE WRK.Deadline Departur
      *   |- c5    : DB1.Load ID NE WRK.Load ID
      *   '-
     C           MHAODT    IFNE WUAODT                     *IF
     C           MHKZDT    ORNE WUKZDT                     *OR
     C           MHAXTM    ORNE WUAXTM                     *OR
     C           MHRMNB    ORNE WURMNB                     *OR
      * SEL:  Load Id
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Load ID is GT Zero
      *   |- c2    : CTL.Load ID NE DB1.Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2RMNB    IFGT *ZERO                      *IF
     C           #2RMNB    IFNE MHRMNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Record Selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     Z-ADDMHAODT    WUAODT           Scheduled Ship
     C                     MOVELMHBPSX    WUBPSX           Load Grade
     C                     Z-ADDMHKZDT    WUKZDT           Deadline Depart
     C                     Z-ADDMHAXTM    WUAXTM           Deadline Depart
     C                     Z-ADDMHRMNB    WURMNB           Load ID
      * 01/14/16 JJH E4682 - Load Scheduling Position with Mercury Gate
      * 05/19/16 RMC E4119 - dont check live with tpm
      * RTV Schd Seq Nbr/ExportRT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0019           Load ID
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    #1T4NB           Schedule Sequen
     C                     MOVELWL0021    WUU2ST    P      Export Status
      * Export Status Text
      * CASE: WRK.Export Status is yes
     C           WUU2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'EX'      #RTRTX           usr txt-2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RTRTX           usr txt-2
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RTSNB           Calc 5
      * CASE: RCD.Load Grade is Actual Inventory only
     C           #1BPSX    IFEQ 'C'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Cant be filled     RT - Load Schdlng Position  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      * 05/11/04 SLM PKTR01 Multi-Company - remove Company RST or Pos
      * RTV UM/Whs Code        RT - Order Header TRG  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * 01/12/16 JJH E4682 - Load Scheduling Position
      * 05/19/16 RMC E4119 - dont check live with tpm
      * RTV Ld Acc/Sts/Wt/LPT RT - Load Header  * 
     C                     EXSR SNRVGN
      * 01/14/16 JJH E4682 - Load Scheduling Position
      * 05/19/16 RMC E4119 - dont check live with tpm
      * RTV Chk Ord on Hld-Pr/Cr - Load Detail  * 
     C                     EXSR SORVGN
      * SFL Fold/Drop  RPG 2  US - /UT User Source  * 
     C           MODE      IFEQ '0'
     C                     SETON                     89
     C                     ELSE
     C                     SETOF                     89
     C                     ENDIF
      * 01/14/16 JJH E4682 - Load Scheduling Position
      * 05/19/16 RMC E4119 - dont check live with tpm
      * Default Load Sequence
      * CASE: RCD.Schedule Sequence Number is Zero
     C           #1T4NB    IFEQ *ZERO                      *IF
      * RTV Warehouse for Orders - Load Detail  * 
     C                     EXSR SQRVGN
      * RTV Default Load Seq  RT - Warehouse  * 
     C                     EXSR SSRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Default Load Sequence is yes
      *   |- c2    : WRK.Default Load Sequence is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2T4ST    IFEQ 'Y'                        *IF
     C           WUT4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         #1T4NB           Schedule Sequen
     C                     END                             *FI
     C                     END                             *FI
      * Export
      * CASE: CTL.Include/Exclude Option is Include
     C           #CVQCD    IFEQ 'INC'                      *IF
      * SEL:  Export
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.usr txt-2             usr NE WRK.BLANK
      *   |- c2    : CTL.usr txt-2             usr NE RCD.usr txt-2
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CTRTX    IFNE WUGSTX                     *IF
     C           #CTRTX    IFNE #RTRTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Exclude
     C           #CVQCD    IFEQ 'EXC'                      *IF
      * CASE: CTL.usr txt-2             usr is Blank
     C           #CTRTX    IFEQ *BLANK                     *IF
      * CASE: RCD.usr txt-2             usr is NE Blank
     C           #RTRTX    IFNE *BLANK                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Unit of Measure
      * CASE: CTL.Include/Exclude Option 2 is Include
     C           #CI0SX    IFEQ 'INC'                      *IF
      * SEL:  Unit of Measure
      * CASE:
      *  - c1ORc2
      *   |- c1    : CTL.USR Unit of Measure EQ RCD.USR Unit of Measure
      *   |- c2    : CTL.USR Unit of Measure is *Blank
      *   '-
     C           #CODCD    IFEQ #RODCD                     *IF
     C           #CODCD    OREQ *BLANK                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Include/Exclude Option 2 is Exclude
     C           #CI0SX    IFEQ 'EXC'                      *IF
      * EXC:  Unit of Measure
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.USR Unit of Measure is Entered
      *   |- c2    : CTL.USR Unit of Measure EQ RCD.USR Unit of Measure
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CODCD    IFNE *BLANK                     *IF
     C           #CODCD    IFEQ #RODCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * 82=EOF
     C                     READ @MHCPU1                  82*
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Validate LPT Load Plan Start Tm
     C                     Z-ADD#CCMTM    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
      * Validate Load Grade
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CBPSX'  IFEQ YPMTFD
      * Load Grade
     C                     MOVEL#CBPSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFBPSX
     C                     SELEC
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD1         ZFBPSX
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD2         ZFBPSX
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD3         ZFBPSX
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD4         ZFBPSX
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD5         ZFBPSX
     C                     ENDSL
     C                     EXFMTZEBPSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFBPSX    WHEQ 1
     C                     MOVEL'A'       W0INVL           A
     C           ZFBPSX    WHEQ 2
     C                     MOVEL'C'       W0INVL           C
     C           ZFBPSX    WHEQ 3
     C                     MOVEL'P'       W0INVL           P
     C           ZFBPSX    WHEQ 4
     C                     MOVEL'X'       W0INVL           X
     C           ZFBPSX    WHEQ 5
     C                     MOVEL'L'       W0INVL           L
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CBPSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
      * Validate LSP Order Company and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2CUC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2CUC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2CUC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2CUC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Deadline Departure Date
      * External date
     C                     Z-ADDV2KZDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     Z-ADDXDINDT    #2KZDT
      * Validate Deadline Departure Time
     C                     Z-ADD#2AXTM    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9942  *
     C                     END
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
      * Change of position specified
     C           YPMTFD    IFEQ *BLANKS
     C           WZCUC3    CASNE#2CUC3    FBRQRL           LSP Order Compa
     C           WZLUAA    CASNE#2LUAA    FBRQRL           LSP Order Wareh
     C           WZRMNB    CASNE#2RMNB    FBRQRL           Load ID
     C           WZAODT    CASNE#2AODT    FBRQRL           Scheduled Ship
     C           WZKZDT    CASNE#2KZDT    FBRQRL           Deadline Depart
     C           WZAXTM    CASNE#2AXTM    FBRQRL           Deadline Depart
     C                     END
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile control
     C                     MOVEL'N'       P3C8ST           Reprocess User
      * F5=Dsp Slot Activity
      * CASE: CTL.*CMD key is CF05
     C           *IN05     IFEQ '1'                        *IF
      * Pmt Dsp Load Slot Act PV - Load Slotting Sched Activ  * 
     C                     CALL 'POJXPVR'              90  Pmt Dsp Load Sl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2CUC3    WQ0006  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POJXPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F7=INC/EXC Toggle (Export)
      * CASE: CTL.*CMD key is CF07
     C           *IN07     IFEQ '1'                        *IF
      * CASE: CTL.Include/Exclude Option is Include
     C           #CVQCD    IFEQ 'INC'                      *IF
     C                     MOVEL'EXC'     #CVQCD           Include/Exclude
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Exclude
     C           #CVQCD    IFEQ 'EXC'                      *IF
     C                     MOVEL'INC'     #CVQCD           Include/Exclude
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F8=INC/EXC Toggle (Unit of Measure)
      * CASE: CTL.*CMD key is CF08
     C           *IN08     IFEQ '1'                        *IF
      * CASE: CTL.Include/Exclude Option 2 is Include
     C           #CI0SX    IFEQ 'INC'                      *IF
     C                     MOVEL'EXC'     #CI0SX           Include/Exclude
     C                     ELSE
      * CASE: CTL.Include/Exclude Option 2 is Exclude
     C           #CI0SX    IFEQ 'EXC'                      *IF
     C                     MOVEL'INC'     #CI0SX           Include/Exclude
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F9 = Inc/Exc Seq = 0 only - new 03/12/07 RMC FP1090
      * CASE: CTL.*CMD key is CF09
     C           *IN09     IFEQ '1'                        *IF
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0015    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0015           Status Flag 1
     C                     ELSE
      * CASE: LCL.Status Flag 1  Y/N is No
     C           YL0015    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0015           Status Flag 1
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F10 - Refresh
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
     C                     MOVEL'Y'       P3C8ST           Reprocess User
     C                     MOVELWUGSTX    W0RTN            *Return code
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CHG: Warehouse Code
      * CASE: CTL.LSP Order Warehouse NE LCL.LSP Order Warehouse
     C           #2LUAA    IFNE YL0013                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * OMS357
      * CHG:  Scheduled Ship Date (if not zeros)
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Scheduled Ship Date NE WRK.USR Date - ATR
      *   |- c2    : CTL.Scheduled Ship Date is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AODT    IFNE WUBQDT                     *IF
     C           #2AODT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD#2AODT    WUBQDT           USR Date - ATR
     C                     Z-ADD#2AODT    #CL7DT           Thru Scheduled
      * RTV Day and Week No.   RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2CUC3    WL0006           Company Number
     C                     Z-ADD#CL7DT    WL0007           Post to G/L Dat
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    YL0002           Accounting Peri
     C                     MOVELWL0009    YL0003    P      Day of Week
     C                     Z-ADDWL0010    YL0004           Week Number
      * CTL.Day of the Week USR = Condition name of LCL.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM YL0003    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CULTX    PARM           W0CNNM 25        Day of the Week
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CHG:  Unit of Measure
      * CASE: CTL.USR Unit of Measure NE WRK.USR Unit of Measure
     C           #CODCD    IFNE WUODCD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CHG:  Export
      * CASE: CTL.usr txt-2             usr NE WRK.usr txt-2
     C           #CTRTX    IFNE WUTRTX                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CHG:  load grade
      * CASE: CTL.Load Grade NE LCL.Load Grade
     C           #CBPSX    IFNE YL0014                     *IF
     C                     MOVEL#CBPSX    YL0014           Load Grade
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CHG:  Schedule Sequence Number                S16991 DN 11/03/20
      * CASE: CTL.Schedule Sequence Number NE LCL.Schedule Sequence Numbe
     C           #CT4NB    IFNE YL0022                     *IF
     C                     Z-ADD#CT4NB    YL0022           Schedule Sequen
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * VAL: Scheduled Ship Date
      * CASE: CTL.Scheduled Ship Date is not entered
     C           #2AODT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0007
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
      * VAL: Warehouse Code
      * CASE: CTL.LSP Order Warehouse is Warehouse Code Blank
     C           #2LUAA    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#2LUAA    ZA0008           LSP Order Wareh
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * F11 - DSP Main Ord Inq by Ld DF
      * CASE: CTL.*CMD key is CF11
     C           *IN11     IFEQ '1'                        *IF
      * DSP Main Ord Inq by Ld DF - Order Header TRG  * 
     C                     CALL 'PDMCDFR'              90  DSP Main Ord In
     C                     PARM *BLANK    W0RTN   7
     C           #2CUC3    PARM #2CUC3    WQ0007  30       Company Number
     C           WUC4NB    PARM WUC4NB    WQ0008  70       Order Number
     C           WUJNCD    PARM WUJNCD    WQ0009  2        Order Type - Sa
     C           WUBKC7    PARM WUBKC7    WQ0010  70       Ship To Custome
     C           WUBRTX    PARM WUBRTX    WQ0011 30        Ship To Name
     C           WUBCNA    PARM WUBCNA    WQ0012 15        Customer Purcha
     C           WUA0DT    PARM WUA0DT    WQ0013  70       Order Date
     C           WUGWST    PARM WUGWST    WQ0014  1        Header Status
     C           #2RMNB    PARM #2RMNB    WQ0015  70       Load ID
     C           WUR4CD    PARM WUR4CD    WQ0016  3        Sales Route Cod
     C           WUJPCD    PARM WUJPCD    WQ0017  2        Event Code
     C           WUBNVN    PARM WUBNVN    WQ0018 10        USR Program nam
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMCDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     END
     C                     END                             *FI
      * F13= DspSeq  - new 03/12/07 RMC FP1090
      * CASE: CTL.*CMD key is CF13
     C           *IN13     IFEQ '1'                        *IF
      * Dsp Load Seq Zones    XF - Load Sequencing Zones  * 
     C                     CALL 'PMEVXFR'              90  Dsp Load Seq Zo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2CUC3    WQ0019  30       Company Number
     C                     PARM #2AODT    WQ0020  70       Scheduled Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMEVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993136*
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,43
      * No errors
     C                     SETOF                     98
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
      * Validate LPT Load Plan Start Tm
     C                     Z-ADD#RCMTM    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9845  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * Dsp Load Schdlng Dtl  DF - Load Schdlng Position  * 
     C                     CLEARPBRC
     C                     Z-ADD#1CUC3    PBCUC3           LSP Order Compa
     C                     MOVEL#1LUAA    PBLUAA    P      LSP Order Wareh
     C                     Z-ADD#1L7DT    PBL7DT           Thru Scheduled
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD#1AODT    PBAODT           Scheduled Ship
     C                     Z-ADD#1KZDT    PBKZDT           Deadline Depart
     C                     Z-ADD#1AXTM    PBAXTM           Deadline Depart
     C                     Z-ADD#1AATM    PBAATM           Job Time
     C                     Z-ADD#1AXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDLVDFR'              90  Dsp Load Schdln
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Schdl
      *
     C                     Z-ADDPBCUC3    #1CUC3           LSP Order Compa
     C                     MOVELPBLUAA    #1LUAA           LSP Order Wareh
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C                     MOVEL'N'       W0RSF
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     MOVEL*BLANK    #1SEL
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,43
     C                     SETOF                     98
      *
      * Process change request
     C                     EXSR EECHRQ
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Load Hdr Schd Seq IF
      * 05/19/16 RMC E4119 - dont chk live w/tpm
      * Rtv/Chg Sched Seq Nbr  RT - Load Header  * 
     C                     EXSR STRVGN
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,43
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
     C                     MOVEL'0'       *IN77
     C           #1BQSX    IFEQ 'M'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL*IN87     *IN76
     C                     MOVEL'0'       *IN75
     C           YL0033    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN76
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C                     MOVEL'0'       *IN78
     C           YL0033    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     Z-ADD*ZERO     #1RVNB           Stop/Drop
     C                     MOVEL*BLANK    #1BUST           LSP Order Aged
     C                     Z-ADD*ZERO     #1STDT           LSP Production
     C                     Z-ADD*ZERO     #1N5NY           Process Sequenc
     C                     Z-ADD*ZERO     #1RINY           Item Age Days
     C                     Z-ADD*ZERO     #1TIDT           Production Ovr
     C                     Z-ADD*ZERO     #1TJDT           Production Ovr
     C                     Z-ADD*ZERO     #1TNDT           Production AgeD
     C                     Z-ADD*ZERO     #1TODT           Production AgeD
     C                     MOVEL*BLANK    #1BMSX           Record Type
     C                     Z-ADD*ZERO     #RTSNB           Calc 5
     C                     Z-ADD*ZERO     #1HGCD           Item Code
     C                     Z-ADDP4CQC3    #1CQC3           LSP Accounting
     C                     MOVELP4LQAA    #1LQAA           LSP Prodution W
     C                     Z-ADDP4CUC3    #1CUC3           LSP Order Compa
     C                     MOVELP4LUAA    #1LUAA           LSP Order Wareh
     C                     Z-ADD*ZERO     #1SPSQ           Sequence
     C                     Z-ADD*ZERO     #1L7DT           Thru Scheduled
     C                     Z-ADD*ZERO     #1C4NB           Order Number
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     Z-ADD*ZERO     #1KBQT           Actual Inventor
     C                     Z-ADD*ZERO     #1KCQT           Picked Inventor
     C                     Z-ADD*ZERO     #1KHQT           Available Inven
     C                     Z-ADD*ZERO     #1KDQT           Actual Producti
     C                     Z-ADD*ZERO     #1KEQT           Scheduled Produ
     C                     Z-ADD*ZERO     #1KFQT           Available Produ
     C                     Z-ADD*ZERO     #1H1QT           Scheduled Quant
     C                     Z-ADD*ZERO     #1KGQT           Scheduling Posi
     C                     MOVEL*BLANK    #1BOSX           Order Grade
     C                     MOVEL*BLANK    #1BQSX           Multiple Wareho
     C                     MOVEL*BLANK    #1UNUS           SSI Download Fl
     C                     MOVEL*BLANK    #1UNU2           unused status 2
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     Z-ADD*ZERO     #1T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #RCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     MOVEL*BLANK    #1BPSX           Load Grade
     C                     MOVEL*BLANK    #RTRTX           usr txt-2
     C                     MOVEL*BLANK    #RPKST           Load Status
     C                     MOVEL*BLANK    #RODCD           USR Unit of Mea
     C                     Z-ADD*ZERO     #1KZDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     V1KZDT
     C                     Z-ADD*ZERO     #1AXTM           Deadline Depart
     C                     MOVEL*BLANK    #RRMST           Load Acceptance
     C                     MOVEL*BLANK    #RYOST           USR Record Stat
     C                     Z-ADD*ZERO     #RRPNB           Total Load Orde
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @MHCPU1 fields to subfile
      *================================================================
     C                     Z-ADDMHRVNB    #1RVNB           Stop/Drop
     C                     MOVELMHBUST    #1BUST           LSP Order Aged
     C                     Z-ADDMHSTDT    #1STDT           LSP Production
     C                     Z-ADDMHN5NY    #1N5NY           Process Sequenc
     C                     Z-ADDMHRINY    #1RINY           Item Age Days
     C                     Z-ADDMHTIDT    #1TIDT           Production Ovr
     C                     Z-ADDMHTJDT    #1TJDT           Production Ovr
     C                     Z-ADDMHTNDT    #1TNDT           Production AgeD
     C                     Z-ADDMHTODT    #1TODT           Production AgeD
     C                     MOVELMHBMSX    #1BMSX           Record Type
     C                     Z-ADDMHHGCD    #1HGCD           Item Code
     C                     Z-ADDMHCQC3    #1CQC3           LSP Accounting
     C                     MOVELMHLQAA    #1LQAA           LSP Prodution W
     C                     Z-ADDMHCUC3    #1CUC3           LSP Order Compa
     C                     MOVELMHLUAA    #1LUAA           LSP Order Wareh
     C                     Z-ADDMHSPSQ    #1SPSQ           Sequence
     C                     Z-ADDMHL7DT    #1L7DT           Thru Scheduled
     C                     Z-ADDMHC4NB    #1C4NB           Order Number
     C                     MOVELMHJPCD    #1JPCD           Event Code
     C                     Z-ADDMHKBQT    #1KBQT           Actual Inventor
     C                     Z-ADDMHKCQT    #1KCQT           Picked Inventor
     C                     Z-ADDMHKHQT    #1KHQT           Available Inven
     C                     Z-ADDMHKDQT    #1KDQT           Actual Producti
     C                     Z-ADDMHKEQT    #1KEQT           Scheduled Produ
     C                     Z-ADDMHKFQT    #1KFQT           Available Produ
     C                     Z-ADDMHH1QT    #1H1QT           Scheduled Quant
     C                     Z-ADDMHKGQT    #1KGQT           Scheduling Posi
     C                     MOVELMHBOSX    #1BOSX           Order Grade
     C                     MOVELMHBQSX    #1BQSX           Multiple Wareho
     C                     MOVELMHUNUS    #1UNUS           SSI Download Fl
     C                     MOVELMHUNU2    #1UNU2           unused status 2
     C                     MOVELMHUVST    #1UVST           EDI Status 1
     C                     MOVELMHUWST    #1UWST           EDI Status 2
     C                     MOVELMHUXST    #1UXST           EDI Status 3
     C                     MOVELMHVSST    #1VSST           Record Status
     C                     Z-ADDMHAATM    #1AATM           Job Time
     C                     MOVELMHAYNA    #1AYNA           User Id
     C                     MOVELMHA0NA    #1A0NA           Job Name
     C                     Z-ADDMHAXDT    #1AXDT           Job Date
     C                     Z-ADDMHRMNB    #1RMNB           Load ID
     C                     Z-ADDMHT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDMHAODT    #1AODT           Scheduled Ship
     C                     MOVELMHBPSX    #1BPSX           Load Grade
     C                     Z-ADDMHKZDT    #1KZDT           Deadline Depart
     C                     Z-ADDMHAXTM    #1AXTM           Deadline Depart
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP4LQAA    #PLQAA           LSP Prodution W
     C                     Z-ADDP4CQC3    #PCQC3           LSP Accounting
     C                     MOVELP1DNCD    #PDNCD           Application Cod
     C                     MOVELP1AJVN    #PAJVN           User Profile Na
     C                     MOVELP1I6ST    #PI6ST           Allow Multi-Com
     C                     MOVELP1B8NA    #PB8NA           System Date For
     C                     MOVELP1MPNA    #PMPNA           Default Printer
     C                     Z-ADD*ZERO     #2HGCD           Item Code
     C                     Z-ADD*ZERO     #CTSNB           Calc 5
     C                     Z-ADDP4CUC3    #2CUC3           LSP Order Compa
      * Clear external version also
     C                     MOVEL*BLANK    V2CUC3
     C                     MOVEL*BLANK    #CADTX           Name
     C                     MOVEL*BLANK    #CULTX           Day of the Week
     C                     Z-ADD*ZERO     #CL7DT           Thru Scheduled
      * Clear external version also
     C                     Z-ADD*ZERO     VCL7DT
     C                     Z-ADD*ZERO     #CBINX           Combo Load Limi
     C                     Z-ADD*ZERO     #CBGNX           USR 3 Numeric
     C                     Z-ADD*ZERO     #CAXDT           Job Date
      * Clear external version also
     C                     Z-ADD*ZERO     VCAXDT
     C                     Z-ADD*ZERO     #CAATM           Job Time
     C                     Z-ADD*ZERO     #CIUNX           Export Load Lim
     C                     Z-ADD*ZERO     #CCOPY           Number of Copie
     C                     MOVELP4LUAA    #2LUAA           LSP Order Wareh
     C                     Z-ADD*ZERO     #CBHNX           Box Load Limit
     C                     Z-ADD*ZERO     #CTQNB           Calc 3
     C                     MOVEL*BLANK    #CVQCD           Include/Exclude
     C                     MOVEL*BLANK    #CI0SX           Include/Exclude
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     Z-ADD*ZERO     #CT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #CCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     MOVEL*BLANK    #CBPSX           Load Grade
     C                     MOVEL*BLANK    #CTRTX           usr txt-2
     C                     MOVEL*BLANK    #CPKST           Load Status
     C                     MOVEL*BLANK    #CODCD           USR Unit of Mea
     C                     Z-ADD*ZERO     #2KZDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     V2KZDT
     C                     Z-ADD*ZERO     #2AXTM           Deadline Depart
     C                     MOVEL*BLANK    #CRMST           Load Acceptance
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Deadline Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1KZDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert LSP Order Company to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2CUC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2CUC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2CUC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2CUC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Thru Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #CL7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCL7DT
      * Convert Job Date to display format
      * Convert date
     C           1000000   ADD  #CAXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCAXDT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Deadline Departure Date to display format
      * Convert date
     C           1000000   ADD  #2KZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2KZDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#2CUC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CADTX           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #CADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Newest Rcd         RT - Load Schdlng Position  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *HIVAL    SETLL@MHCPYF                    *
     C                     READ @MHCPYF                  90*
      * Data record not found
     C   90                MOVEL'USR2706' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAATM    WL0001           Job Time
     C                     Z-ADDWAAXDT    WL0002           Job Date
     C                     Z-ADDWAL7DT    WL0003           Thru Scheduled
     C                     GOTO SBEXIT                     *QUIT
     C                     READ @MHCPYF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0004    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Warehouse Type
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0005           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Day and Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSD01           Company Number
     C           *LIKE     DEFN AFBCDT    WQSD02           Post to G/L Dat
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0006    WQSD01           Company Number
     C                     Z-ADDWL0007    WQSD02           Post to G/L Dat
      * Establish starting position
     C           KRSSD     SETLL@AFREYY                    *
     C           KRSSD     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDAFETNB    WL0008           Accounting Peri
     C                     MOVELAFA9ST    WL0009           Day of Week
     C                     Z-ADDAFEINB    WL0010           Week Number
     C           KRSSD     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Limit Loads f/Slot RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     #CIUNX           Export Load Lim
     C                     Z-ADD*ZERO     #CBINX           Combo Load Limi
     C                     Z-ADD*ZERO     #CBHNX           Box Load Limit
     C                     MOVEL'N'       WUYIST           Record Found -O
      * RTV Shipping Co        RT - Warehouse  * 
     C                     EXSR SFRVGN
      * ** Retrieve needed values from System Values file     E000233
      * Rtv Company Ctl Vals  XF - Company Values  * 
     C                     CALL 'PNOQXFR'              90  Rtv Company Ctl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0005    WQ0001  30       Company Number
     C           YL0006    PARM *ZERO     WQ0002  50       Box Load Min Bo
     C           YL0007    PARM *ZERO     WQ0003  70       Partial Load Ma
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * change log
     C                     EXSR UBSUBR                     change log
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJVPCD    WQSE02           Ship From Wareh
     C           *LIKE     DEFN FJAODT    WQSE03           Scheduled Ship
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE02           Ship From Wareh
     C                     KFLD           WQSE03           Scheduled Ship
      * Setup key
     C                     MOVEL#2LUAA    WQSE02           Ship From Wareh
     C                     Z-ADDWUBQDT    WQSE03           Scheduled Ship
      * Establish starting position
     C           KRSSE     SETLL@FJCPN3                    *
     C           KRSSE     READE@FJCPN3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC 9/11/13 E2709
      * Check for Mixed having box qty>BOXLOAD qty, if yes, then BX, else
      * Change Priority 3/14/01    RMC
      * Check for Mixed having a box qty > 60 to stay BX   6/12/01    RMC
      * Per Steve Burke - 6/27/01
      * Dont check just for Prepaid Trucks.  Collect and Prepaid trucks i
      * If Partial Load (<= 20000 lbs) dont count.
      * Priority :  Combo , Export, Box
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.Load Type is Regular
      *   |- c2    : DB1.Total Load Order Weight GT LCL.Partial Load Max
      *   |- c3    : DB1.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           FJVDST    IFEQ 'R'                        *IF
     C           FJRPNB    IFGT YL0007                     *IF
     C           FJQ2CD    IFEQ 'CT'                       *IF
     C           FJQ2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Update load found so this load wont be counted again in the calli
      * CASE: DB1.Load ID EQ PAR.Load ID
     C           FJRMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       WUYIST           Record Found -O
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0008           Boxes Total Qua
      * 05/11/04 SLM PKTR01 Multi-Company - Function chgd-remove Company
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
     C                     EXSR SGRVGN
      * CASE: LCL.U/M - Ordered is Combos
     C           YL0009    IFEQ 'CB'                       *IF
     C                     ADD  1         #CBINX           Combo Load Limi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELFJU2ST    YL0012           Export Status D
      * Count Load as Export if order whse = Ship-From-Whse & Export 8/3/
      * CASE: DB1.Export Status is yes
     C           FJU2ST    IFEQ 'Y'                        *IF
      * See if export order whse matches load Shipfrom whse  08/03/07 RMC
      * For example a load could be export sts=Y and ship from whse is GP
      * there are multiple orders, and the one that is export is out of C
      *  in that case, dont count the load as export- per Steve B and Jim
      * RTV ExpOrd Whse for LD XF - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDFJRMNB    PARMNB           Load ID
      *
     C                     CALL 'PMK2XFR'              90  RTV ExpOrd Whse
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Head
     C                     PARM FJVPCD    WQ0004  3        Ship From Wareh
     C           YL0012    PARM YL0012    WQ0005  1        Export Status D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMK2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: LCL.Export Status Dft is yes
     C           YL0012    IFEQ 'Y'                        *IF
     C                     ADD  1         #CIUNX           Export Load Lim
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         #CBHNX           Box Load Limit
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@FJCPN3                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#2LUAA    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0005           Shipping Compan
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBWC3    YL0005           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/13/04 SLM PKTR01 Multi-Company - Funt chg to rmv Co RST or Pos
     C                     MOVEL*BLANK    YL0009           USR Unit of Mea
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSG01           Load ID
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Load ID
     C                     KFLD           BEC4NB           Order Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQSG01           Load ID
     C                     Z-ADD*ZERO     BEC4NB           Order Number
      * Establish starting position
     C           KPSSG     SETLL@BFCPR0                    *
     C           KRSSG     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0011           Company Number
     C                     Z-ADDBEC4NB    WL0012           Order Number
     C                     Z-ADD1         WL0013           Order Sequence
     C                     MOVELYL0009    WL0014    P      USR Unit of Mea
     C                     Z-ADDYL0008    WL0015           Boxes Total Qua
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0009    P      USR Unit of Mea
     C                     Z-ADDWL0015    YL0008           Boxes Total Qua
     C           KRSSG     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * RMC E2709 added here so it wont need to be in every calling pgm
      * CASE: PAR.USR Unit of Measure is Mixed
     C           YL0009    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0016           Company Number
     C                     MOVEL'BOXLOAD' WL0017    P      Company Value C
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    YL0011           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0008    IFLT YL0011                     *IF
     C                     MOVEL'CB'      YL0009           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0009           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSH01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSH02           Order Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
      * Setup key
     C                     Z-ADDWL0011    WQSH01           Company Number
     C                     Z-ADDWL0012    WQSH02           Order Number
     C                     Z-ADDWL0013    OMDPNB           Order Sequence
      * Establish starting position
     C           KPSSH     SETLL@BGWKL1                    *
     C           KRSSH     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0014           USR Unit of Mea
     C                     Z-ADD*ZERO     WL0015           Boxes Total Qua
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SHEXIT                     *QUIT
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/08/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/08/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELOMAGCD    YL0010           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0010    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0010           U/M - Ordered
     C                     END                             *FI
      * Accumulate the Box Quantity for slotting consideration  6/12/01
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0010    IFEQ 'BX'                       *IF
     C                     ADD  OMAVQT    WL0015           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           WL0014    IFEQ *BLANK                     *IF
     C                     MOVELYL0010    WL0014           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0010    IFEQ WL0014                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WL0014           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0016    KMAIC3           Company Number
     C                     MOVELWL0017    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSI     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0018           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A3AIC3    WQSJ01           Company Number
     C           *LIKE     DEFN A3AJCD    WQSJ02           Warehouse Code
     C           *LIKE     DEFN A3A9ST    WQSJ03           Day of Week
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Warehouse Code
     C                     KFLD           WQSJ03           Day of Week
      * Setup key
     C                     Z-ADD#2CUC3    WQSJ01           Company Number
     C                     MOVEL#2LUAA    WQSJ02           Warehouse Code
     C                     MOVELYL0003    WQSJ03           Day of Week
      * Establish starting position
     C           KRSSJ     SETLL@A3REI3                    *
     C           KRSSJ     READE@A3REI3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3033' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CCOPY           Slot Limit for
     C                     Z-ADD*ZERO     #CBGNX           Slot Limit for
     C                     Z-ADD*ZERO     #CTQNB           Slot Limit for
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA3NVNX    #CCOPY           Slot Limit for
     C                     Z-ADDA3NWNX    #CBGNX           Slot Limit for
     C                     Z-ADDA3NXNX    #CTQNB           Slot Limit for
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@A3REI3                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Schd Seq Nbr/ExportRT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0019    WBRMNB           Load ID
      * Establish starting position
     C           KRSSK     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT                     *QUIT
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBT4NB    WL0020           Schedule Sequen
     C                     MOVELWBU2ST    WL0021           Export Status
     C                     GOTO SKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Cant be filled     RT - Load Schdlng Position  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCCUC3    WQSL01           LSP Order Compa
     C           *LIKE     DEFN WCAODT    WQSL02           Scheduled Ship
     C           *LIKE     DEFN WCKZDT    WQSL04           Deadline Depart
     C           *LIKE     DEFN WCAXTM    WQSL05           Deadline Depart
     C           *LIKE     DEFN WCRMNB    WQSL06           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           LSP Order Compa
     C                     KFLD           WQSL02           Scheduled Ship
     C                     KFLD           WQSL04           Deadline Depart
     C                     KFLD           WQSL05           Deadline Depart
     C                     KFLD           WQSL06           Load ID
      * Setup key
     C                     Z-ADD#1CUC3    WQSL01           LSP Order Compa
     C                     Z-ADD#1AODT    WQSL02           Scheduled Ship
     C                     Z-ADD#1KZDT    WQSL04           Deadline Depart
     C                     Z-ADD#1AXTM    WQSL05           Deadline Depart
     C                     Z-ADD#1RMNB    WQSL06           Load ID
      * Establish starting position
     C           KRSSL     SETLL@MHCPCW                    *
     C           KRSSL     READE@MHCPCW                  90*
      * Data record not found
     C   90                MOVEL'USR2706' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Order Grade is Cant be filled
     C           WCBOSX    IFEQ 'X'                        *IF
     C                     ADD  1         #RTSNB           Calc 5
     C                     END                             *FI
     C           KRSSL     READE@MHCPCW                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code        RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    #RODCD           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0016           Boxes Total Qua
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSM01           Load ID
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Load ID
     C                     KFLD           BEC4NB           Order Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSM01           Load ID
     C                     Z-ADD*ZERO     BEC4NB           Order Number
      * Establish starting position
     C           KPSSM     SETLL@BFCPR0                    *
     C           KRSSM     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SMEXIT                     *QUIT
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0011           Company Number
     C                     Z-ADDBEC4NB    WL0012           Order Number
     C                     Z-ADD1         WL0013           Order Sequence
     C                     MOVEL#RODCD    WL0014    P      USR Unit of Mea
     C                     Z-ADDYL0016    WL0015           Boxes Total Qua
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    #RODCD    P      USR Unit of Mea
     C                     Z-ADDWL0015    YL0016           Boxes Total Qua
      * If doing for one Order, because it isnt tied to a load yet
      * CASE: DB1.Load ID is Blank
     C           BERMNB    IFEQ 0                          *IF
      * CASE: PAR.USR Unit of Measure is Mixed
     C           #RODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0016           Company Number
     C                     MOVEL'BOXLOAD' WL0017    P      Company Value C
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    YL0017           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0016    IFLT YL0017                     *IF
     C                     MOVEL'CB'      #RODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      #RODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
      * orig code
     C           KRSSM     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Unit of Measure is Mixed
     C           #RODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0016           Company Number
     C                     MOVEL'BOXLOAD' WL0017    P      Company Value C
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    YL0017           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0016    IFLT YL0017                     *IF
     C                     MOVEL'CB'      #RODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      #RODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Ld Acc/Sts/Wt/LPT RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #RPKST           Load Status
     C                     Z-ADD*ZERO     #RRPNB           Total Load Orde
     C                     MOVEL*BLANK    #RRMST           Load Acceptance
     C                     Z-ADD*ZERO     #RCMTM           LPT Load Plan S
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSN02           Load ID
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSN02           Load ID
      * Establish starting position
     C           KRSSN     SETLL@FJCPSB                    *
     C           KRSSN     READE@FJCPSB                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDPKST    #RPKST           Load Status
     C                     Z-ADDWDRPNB    #RRPNB           Total Load Orde
     C                     MOVELWDRMST    #RRMST           Load Acceptance
     C                     Z-ADDWDCMTM    #RCMTM           LPT Load Plan S
     C           KRSSN     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Chk Ord on Hld-Pr/Cr - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       #RYOST           USR Flag 1
     C                     MOVEL'N'       YL0019           Credit Hold
     C                     MOVEL'N'       YL0018           Production Hold
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSO01           Load ID
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSO01           Load ID
      * Establish starting position
     C           KRSSO     SETLL@FLCPBW                    *
     C           KRSSO     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Hold/Status        RT - Order Header TRG  * 
     C                     EXSR SPRVGN
      * CASE: LCL.Production Hold is Yes
     C           YL0021    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0018           Production Hold
     C                     MOVEL'Y'       #RYOST           USR Flag 1
     C                     END                             *FI
      * CASE: LCL.Credit Hold is Yes
     C           YL0020    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0019           Credit Hold
     C                     MOVEL'Y'       #RYOST           USR Flag 1
     C                     END                             *FI
     C           KRSSO     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Hold/Status        RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WEAIC3           Company Number
     C                     Z-ADDFLC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSSP     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEJNCD    WUJNCD           Order Type - Sa
     C                     MOVELWEGWST    WUGWST           Header Status
     C                     MOVELWEGXST    WUGXST           Header Status L
     C                     MOVELWEXIST    YL0020           Credit Hold
     C                     MOVELWEXJST    YL0021           Production Hold
     C                     MOVELWEXKST    WUXKST           New Customer Ho
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Warehouse for Orders - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WULUAA           Warehouse Code
     C                     MOVEL*BLANK    P2T4ST           Default Load Se
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQSQ02           Load ID
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSQ02           Load ID
      * Establish starting position
     C           KRSSQ     SETLL@FLCPKF                    *
     C           KRSSQ     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHK for warehouse codes - Order Detail  * 
     C                     EXSR SRRVGN
     C                     MOVELWUAJCD    WULUAA           Warehouse Code
     C           KRSSQ     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * CHK for warehouse codes - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTMST           USR First Time
     C                     MOVEL*BLANK    WUAJCD           Warehouse Code
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSR01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSR02           Order Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WQSR01           Company Number
     C                     Z-ADDWFC4NB    WQSR02           Order Number
      * Establish starting position
     C           KRSSR     SETLL@BGWKL1                    *
     C           KRSSR     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.USR First Time is Yes
     C           WUTMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTMST           USR First Time
     C                     MOVELOMAJCD    WUAJCD           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Code EQ DB1.Warehouse Code
     C           WUAJCD    IFEQ OMAJCD                     *IF
     C                     MOVEL'Y'       P2T4ST           Default Load Se
     C                     MOVELOMAJCD    WUAJCD           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P2T4ST           Default Load Se
     C                     GOTO SREXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSR     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Default Load Seq  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WUT4ST           Default Load Se
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWULUAA    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSS     CHAIN@ADREAO              90    *
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADT4ST    WUT4ST           Default Load Se
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv/Chg Sched Seq Nbr  RT - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Status - Y or N
     C                     MOVEL*BLANK    WN0002  1        Load Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSST     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWBPKST    WN0002           Load Status
      * Set load sts to unlock when a seq nbr is entered.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Load Status is Entered or Combined
      *   |- c2    : PAR.Schedule Sequence Number NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBPKST    IFEQ 'E'                        *IF
     C           WBPKST    OREQ 'C'
     C           #1T4NB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'U'       WN0002           Load Status
     C                     END                             *FI
      * CHG Sched Seq Nbr      CH - Load Header  * 
     C                     EXSR SUCHRC
      * E2625 RMC 10/29/13 Crt chg log for ld plan start time change
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.LPT Load Plan Start Tm NE DB1.LPT Load Plan Star
      *   |- c2    : DB1.LPT Load Plan Start Tm is GT 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RCMTM    IFNE WBCMTM                     *IF
     C           WBCMTM    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    YL0031           Time  6A
     C                     MOVELWBCMTM    YL0031           Time  6A
     C                     MOVEL*BLANK    YL0032           Time Alpha usr
     C                     MOVEL#RCMTM    YL0032           Time Alpha usr
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADDWBRMNB    PCRMNB           Load ID
     C                     Z-ADD*ZERO     PCRVNB           Stop/Drop
     C                     MOVEL'LPTCHG'  PCRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PCUJST    P      Department Cont
     C                     MOVELYL0031    PCMNTX    P      Change Log Prio
     C                     MOVELYL0032    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVELWBBZNA    PCBZNA    P      Carrier Code
     C                     Z-ADDWBAIC3    PCAIC3           Company Number
     C                     Z-ADD*ZERO     PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG Sched Seq Nbr      CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0004  1        LTL Flag
     C                     Z-ADD*ZERO     WN0005  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0006 15        Seal 1
     C                     MOVEL*BLANK    WN0007 15        Seal 2
     C                     MOVEL*BLANK    WN0008 15        Seal 3
     C                     MOVEL*BLANK    WN0009 15        Seal 4
     C                     MOVEL*BLANK    WN0010 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0011  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0012 112       Flat Amount
     C                     MOVEL*BLANK    WN0013  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0014  50       Total Stops
     C                     MOVEL*BLANK    WN0015 20        Trailer Id
     C                     MOVEL*BLANK    WN0016  3        Transloader Car
     C                     Z-ADD*ZERO     WN0017  40       BOL Time
     C                     MOVEL*BLANK    WN0018  3        Carrier Code
     C                     MOVEL*BLANK    WN0019  7        Truck Size
     C                     Z-ADD*ZERO     WN0020  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0021 112       Rated Freight
     C                     MOVEL*BLANK    WN0022  1        Ship Status
     C                     MOVEL*BLANK    WN0023  1        Load Type
     C                     Z-ADD*ZERO     WN0024  50       Number Pallets
     C                     Z-ADD*ZERO     WN0025  50       Number Pallets
     C                     Z-ADD*ZERO     WN0026 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0027  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0028  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0029  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0030 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0031 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0032  70       Actual Departur
     C                     Z-ADD*ZERO     WN0033  40       Departure Time
     C                     Z-ADD*ZERO     WN0034  52       Product Tempera
     C                     Z-ADD*ZERO     WN0035  50       Number Spacers
     C                     MOVEL*BLANK    WN0036 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0037  70       Total Load Mile
     C                     MOVEL*BLANK    WN0038 12        Recorder ID
     C                     MOVEL*BLANK    WN0039  2        Shipping Method
     C                     MOVEL*BLANK    WN0040  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0041  2        Ship To State C
     C                     Z-ADD*ZERO     WN0042  70       Gross Weight
     C                     MOVEL*BLANK    WN0043  3        Carrier Broker
     C                     MOVEL*BLANK    WN0044  1        Export Status
     C                     Z-ADD*ZERO     WN0045  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0046  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0047  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0048  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0049  70       Spotted Date
     C                     Z-ADD*ZERO     WN0050  60       Spotted Time
     C                     Z-ADD*ZERO     WN0051  70       Load Finished D
     C                     Z-ADD*ZERO     WN0052  60       Load Finished T
     C                     Z-ADD*ZERO     WN0053  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0054  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0055  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0056  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0057  70       Truck Departure
     C                     Z-ADD*ZERO     WN0058  60       Truck Departure
     C                     Z-ADD*ZERO     WN0059  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0060  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0061  3        Shipping Line
     C                     MOVEL*BLANK    WN0062 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0063 30        Vessel Name
     C                     Z-ADD*ZERO     WN0064  50       Voyage
     C                     Z-ADD*ZERO     WN0065  70       Sail Date
     C                     MOVEL*BLANK    WN0066 12        Booking Number
     C                     MOVEL*BLANK    WN0067 20        Discharge Port
     C                     Z-ADD*ZERO     WN0068  70       Arrival Date
     C                     MOVEL*BLANK    WN0069 12        Container Numbe
     C                     Z-ADD*ZERO     WN0070  70       Date In
     C                     Z-ADD*ZERO     WN0071  60       Time In
     C                     Z-ADD*ZERO     WN0072  70       Date Out
     C                     Z-ADD*ZERO     WN0073  60       Time Out
     C                     Z-ADD*ZERO     WN0074 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0075  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0076  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0077  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0078  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0079  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0080  70       Requested Deliv
     C                     MOVEL*BLANK    WN0081  1        Load Acceptance
     C                     MOVEL*BLANK    WN0082  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0083  70       On Yard Date
     C                     Z-ADD*ZERO     WN0084  60       On Yard Time
     C                     Z-ADD*ZERO     WN0085  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0086  60       Deadline Depart
     C                     MOVEL*BLANK    WN0087  1        Load Held Over
     C                     MOVEL*BLANK    WN0088  1        Load Held Over
     C                     MOVEL*BLANK    WN0089 15        Load Held Over
     C                     MOVEL*BLANK    WN0090 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0091 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0092  70       Express Mail Da
     C                     MOVEL*BLANK    WN0093  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0094  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0095  70       Product Complet
     C                     Z-ADD*ZERO     WN0096  60       Product Complet
     C                     Z-ADD*ZERO     WN0097  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0098  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0099  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0100  1        Load Confirmed
     C                     MOVEL*BLANK    WN0101 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0102  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0103  60       Load Door 1
     C                     Z-ADD*ZERO     WN0104  70       Override Total
     C                     Z-ADD*ZERO     WN0105  60       Load Door 2
     C                     MOVEL*BLANK    WN0106  1        Partial Load
     C                     MOVEL*BLANK    WN0107  1        Load Confirmati
     C                     MOVEL*BLANK    WN0108  1        Export Load USD
     C                     MOVEL*BLANK    WN0109  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0110 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0111 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0112 15        Late Billing Em
     C                     MOVEL*BLANK    WN0113 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0114 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0115  1        Multi Company L
     C                     MOVEL*BLANK    WN0116  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0117  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0118  1        LH Power Only L
     C                     MOVEL*BLANK    WN0119  1        MG Created Load
     C                     MOVEL*BLANK    WN0120  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0121  2        Load U/M
     C                     MOVEL*BLANK    WN0122  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0123  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0124  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0125  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0126  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0127  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0128  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0129  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0130  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0131  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0132  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0133  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0134  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0135  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0136  60       LH Unused Time
     C                     MOVEL*BLANK    WN0137  1        EDI Status 1
     C                     MOVEL*BLANK    WN0138  1        EDI Status 2
     C                     MOVEL*BLANK    WN0139  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0140  60       Job Time
     C                     MOVEL*BLANK    WN0141 10        User Id
     C                     MOVEL*BLANK    WN0142 10        Job Name
     C                     Z-ADD*ZERO     WN0143  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWBRMNB    WGRMNB           Load ID
      *
     C           KLCHSU    KLIST
     C                     KFLD           WGRMNB           Load ID
     C           KLCHSU    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * USER: Processing after Data read
      * CASE: DB1.MG Created Load is Yes
     C           WGRYSX    IFEQ 'Y'                        *IF
      * S14625 03/11/19 DN-Initialize.
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0023           Create TMS Load
     C                     MOVELYL0025    YL0024           Load Change Typ
     C                     MOVELYL0025    YL0026           Load Change Typ
      * If Sched seq changes: Write TMS Load trigger  E4119 6.30.16
      * CASE: PAR.Schedule Sequence Number NE DB1.Schedule Sequence Numbe
     C           #1T4NB    IFNE WGT4NB                     *IF
      * CASE: PAR.Schedule Sequence Number NE DB1.Schedule Sequence Numbe
     C           #1T4NB    IFNE WGT4NB                     *IF
     C                     MOVEL'SCHSEQ'  YL0024           Load Change Typ
      * S14625 03/11/19 DN-Set Flag to Create TMS Load Trigger.
     C                     MOVEL'Y'       YL0023           Create TMS Load
     C                     END                             *FI
      * S14625 03/11/19 DN-Commented Out & Execute Below.
     C                     END                             *FI
      * S14625 03/11/19 DN-Crt TMS Load Trigger for Sched Seq and/or LPS
      * CASE: *OTHERWISE
      * CASE: PAR.LPT Load Plan Start Tm NE DB1.LPT Load Plan Start Tm
     C           #RCMTM    IFNE WGCMTM                     *IF
     C                     MOVEL'Y'       YL0023           Create TMS Load
      * Set for Both Sched Seq and/or LPS Time Change.
      * CASE: LCL.Load Change Type EQ LCL.Blank 6 USR
     C           YL0024    IFEQ YL0025                     *IF
     C                     MOVEL'LPTCHG'  YL0024           Load Change Typ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'LPTCHG'  YL0026           Load Change Typ
     C                     END                             *FI
     C                     END                             *FI
      * Create TMS Load Trigger.
      * CASE: LCL.Create TMS Load Trg USR is Yes
     C           YL0023    IFEQ 'Y'                        *IF
      * Exc Crt TMS Load Trg  XF - TMS Load Trigger  * 
     C                     CALL 'PBXOXFR'              90  Exc Crt TMS Loa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##JDT     WQ0021  70       Job Date
     C                     PARM ##JTM     WQ0022  60       Job Time
     C                     PARM WGRMNB    WQ0023  70       Load ID
     C                     PARM WBAIC3    WQ0024  30       TMS LH Load Str
     C                     PARM YL0027    WQ0025 35        TMS LH Field Ch
     C                     PARM 'A'       WQ0026  1        TMS Record Stat
     C                     PARM *ZERO     WQ0027  30       TMS Process Sta
     C                     PARM *BLANK    WQ0028  6        TMS Error Reaso
     C                     PARM *ZERO     WQ0029  80       TMS Change Date
     C                     PARM *ZERO     WQ0030  60       TMS Change time
     C                     PARM YL0024    WQ0031  6        Load Change Typ
     C                     PARM YL0026    WQ0032  6        Load Change Typ
     C                     PARM YL0028    WQ0033  6        Load Change Typ
     C                     PARM YL0029    WQ0034  6        Load Change Typ
     C                     PARM YL0030    WQ0035  6        Load Change Typ
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWBAIC3    WGAIC3           Company Number
     C                     MOVELWN0002    WGPKST    P      Load Status
     C                     Z-ADD#1T4NB    WGT4NB           Schedule Sequen
     C                     Z-ADD#RCMTM    WGCMTM           LPT Load Plan S
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0144    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSV     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P1MPNA           Default Printer
     C                     MOVELDRBCCD    WUBCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0034           Company Number
     C                     MOVELDRBUVN    WN0145           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0022    DTAJVN           User Profile Na
     C                     MOVELWL0023    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSW     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0024           Company Number
     C                     MOVELDTAJCD    WL0025           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSX01           Application Cod
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSX01           Application Cod
     C                     MOVEL'OMS'     WQSX01           Application Cod
      * Establish starting position
     C           KRSSX     SETLL@DNRESF                    *
     C           KRSSX     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SYRVGN
     C                     END                             *FI
     C           KRSSX     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSY01           Application Cod
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSY01           Application Cod
      * Establish starting position
     C           KRSSY     SETLL@DNRESF                    *
     C           KRSSY     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSY     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Populate Load Limits and other first time functions
      *================================================================
      * First time -- Load CTL fields
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
      * RTV Newest Rcd         RT - Load Schdlng Position  * 
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0001    WUAATM           Job Time
     C                     Z-ADDWL0002    WUAXDT           Job Date
     C                     Z-ADDWL0003    YN0001           Thru Scheduled
     C                     Z-ADDWUAXDT    #CAXDT           Job Date
     C                     Z-ADDWUAATM    #CAATM           Job Time
      * dflt scheduled ship date if zeros
      * CASE: CTL.Scheduled Ship Date is not entered
     C           #2AODT    IFEQ *ZERO                      *IF
     C                     Z-ADDWUBQDT    #2AODT           Scheduled Ship
     C                     END                             *FI
     C                     Z-ADD#2AODT    #CL7DT           Thru Scheduled
      * RTV Day and Week No.   RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2CUC3    WL0006           Company Number
     C                     Z-ADD#CL7DT    WL0007           Post to G/L Dat
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    YL0002           Accounting Peri
     C                     MOVELWL0009    YL0003    P      Day of Week
     C                     Z-ADDWL0010    YL0004           Week Number
      * CTL.Day of the Week USR = Condition name of LCL.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM YL0003    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CULTX    PARM           W0CNNM 25        Day of the Week
      *
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
      * RMC 4/03/01 Read the Load Hdr ... not the Ld Sched Pstn file
      * 01/12/16 JJH E4682 - Load Scheduling Position with Mercury Gate
      * 05/19/16 RMC E4682 - dont chk mg load stop , live with tpm
      * RTV Limit Loads f/Slot RT - Load Header  * 
     C                     EXSR SERVGN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * change log
      *================================================================
      * 02/03/2010 LJB E000233
      *    Retrieve needed values from System Values file
      * 08/03/07 RMC dly029 Count Load as Export if export order whse
      *    matches ShipFrom Whse on the load   -- per jim n, steve b
      * 05/11/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *    from Logical View
      * 05/17/04 RMC PKTR01 Multi-Company - Use Shipping Co from Whse
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XTCKTM    BEGSR
      *================================================================
      * Validate time format
      *================================================================
      * If time is zero, do not check
     C           XTTIM     CABEQ*ZERO     XTCKTE
     C                     MOVEL*BLANK    W0RTN   7
     C           YPMTFD    CABNE*BLANK    XTCKTE
      *
      * Check hours in range 0 to 23
      * Check minutes in range 0 to 59
      * Check seconds in range 0 to 59
     C           XTHH      IFLT *ZERO
     C           XTHH      ORGT 23
     C           XTNN      ORLT *ZERO
     C           XTNN      ORGT 59
     C           XTSS      ORLT *ZERO
     C           XTSS      ORGT 59
      * Send error message
      * Send message '*Invalid time'
     C                     MOVEL'Y2U0019' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0019' W0RTN
     C                     END
      *================================================================
     CSR         XTCKTE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD13        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDEQ042
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CBPSX'  YPMTFD           Load Grade
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
      * USER: Exit program processing
      * Box Load Info Message
      * CASE: CTL.Box Load Limit        USR GT CTL.Calc 3
     C           #CBHNX    IFGT #CTQNB                     *IF
     C                     MOVEL'Y'       WUB8SX           Error Flag
      * Setup message data for message
     C                     Z-ADD#CBHNX    ZA0009           Box Load Limit
     C                     Z-ADD#CTQNB    ZA0010           Calc 3
      * Send message 'The Number of Loads...'
     C                     MOVEL'USR2802' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Combo Load Info Message
      * CASE: CTL.Combo Load Limit GT CTL.USR 3 Numeric         USR
     C           #CBINX    IFGT #CBGNX                     *IF
      * Setup message data for message
     C                     Z-ADD#CBINX    ZA0011           Combo Load Limi
     C                     Z-ADD#CBGNX    ZA0012           USR 3 Numeric
      * Send message 'The Number of Combo...'
     C                     MOVEL'USR2803' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P2T4ST           Default Load Se
     C                     MOVEL*BLANK    P4LQAA           LSP Prodution W
     C                     Z-ADD*ZERO     P4CQC3           LSP Accounting
     C                     Z-ADD*ZERO     P4CUC3           LSP Order Compa
     C                     MOVEL*BLANK    P4LUAA           LSP Order Wareh
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Load Grade
     C                     MOVEL*BLANK    WUBPSX  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Deadline Departure Date
     C                     Z-ADD*ZERO     WUKZDT  70
      * Define work field Deadline Departure Time
     C                     Z-ADD*ZERO     WUAXTM  60
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Define work field First time flag 2     USR
     C                     MOVEL*BLANK    WUFTFG  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WACQC3           LSP Accounting
     C                     Z-ADD*ZERO     WACUC3           LSP Order Compa
     C                     Z-ADD*ZERO     WASPSQ           Sequence
     C                     Z-ADD*ZERO     WAL7DT           Thru Scheduled
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAKBQT           Actual Inventor
     C                     Z-ADD*ZERO     WAKCQT           Picked Inventor
     C                     Z-ADD*ZERO     WAKHQT           Available Inven
     C                     Z-ADD*ZERO     WAKDQT           Actual Producti
     C                     Z-ADD*ZERO     WAKEQT           Scheduled Produ
     C                     Z-ADD*ZERO     WAKFQT           Available Produ
     C                     Z-ADD*ZERO     WAH1QT           Scheduled Quant
     C                     Z-ADD*ZERO     WAKGQT           Scheduling Posi
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WARVNB           Stop/Drop
     C                     Z-ADD*ZERO     WASTDT           LSP Production
     C                     Z-ADD*ZERO     WAN5NY           Process Sequenc
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATNDT           Production AgeD
     C                     Z-ADD*ZERO     WATODT           Production AgeD
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Date - ATR
     C                     Z-ADD*ZERO     WUBQDT  70
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Job Time
     C                     Z-ADD*ZERO     WUAATM  60
      * Define work field Job Date
     C                     Z-ADD*ZERO     WUAXDT  70
      * Define work field Record Found -OrdDtlUSR
     C                     MOVEL*BLANK    WUYIST  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR Unit of Measure
     C                     MOVEL*BLANK    WUODCD  2
      * Define work field usr txt-2             usr
     C                     MOVEL*BLANK    WUTRTX  2
      * Define work field Export Status
     C                     MOVEL*BLANK    WUU2ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Order Type - Sales
     C                     MOVEL*BLANK    WUJNCD  2
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Define work field Header Status Last
     C                     MOVEL*BLANK    WUGXST  1
      * Define work field New Customer Hold
     C                     MOVEL*BLANK    WUXKST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A/R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WENPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WENQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WENRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WENSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           Time of Origina
     C                     Z-ADD*ZERO     WEBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WEBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WEBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WEH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WEH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WEH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WEH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WEH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field LSP Order Warehouse
     C                     MOVEL*BLANK    WULUAA  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WFRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WFRWNB           Miles to next s
     C                     Z-ADD*ZERO     WFRXNB           Freight Charge
     C                     Z-ADD*ZERO     WFSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WFT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WFT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WFSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WFKFDT           Appointment Con
     C                     Z-ADD*ZERO     WFACTM           Appointment Con
     C                     Z-ADD*ZERO     WFEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WFAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WFKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WFATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WFHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WFAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFKKDT           On Yard Date
     C                     Z-ADD*ZERO     WFAVTM           On Yard Time
     C                     Z-ADD*ZERO     WFZ4NB           MPC Number
     C                     Z-ADD*ZERO     WFN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WFN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WFN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WFB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WFB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WFB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field USR First Time
     C                     MOVEL*BLANK    WUTMST  1
      * Define work field Default Load Sequence
     C                     MOVEL*BLANK    WUT4ST  1
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Order Number
     C                     Z-ADD*ZERO     WUC4NB  70
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Customer Purchase Order #
     C                     MOVEL*BLANK    WUBCNA 15
      * Define work field Order Date
     C                     Z-ADD*ZERO     WUA0DT  70
      * Define work field Sales Route Code
     C                     MOVEL*BLANK    WUR4CD  3
      * Define work field Event Code
     C                     MOVEL*BLANK    WUJPCD  2
      * Define work field USR Program name
     C                     MOVEL*BLANK    WUBNVN 10
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  60
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  70
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0004  3
     C                     MOVEL*BLANK    WL0005  2
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  20
     C                     MOVEL*BLANK    WL0009  1
     C                     Z-ADD*ZERO     WL0010  20
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  30
     C                     MOVEL*BLANK    WL0014  2
     C                     Z-ADD*ZERO     WL0015 112
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0016  30
     C                     MOVEL*BLANK    WL0017 10
     C                     Z-ADD*ZERO     WL0018 155
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  50
     C                     MOVEL*BLANK    WL0021  1
      * Define local variables for subroutine SWRVGN.
     C                     MOVEL*BLANK    WL0022 10
     C                     MOVEL*BLANK    WL0023  6
     C                     Z-ADD*ZERO     WL0024  30
     C                     MOVEL*BLANK    WL0025  3
      * Define null work field Thru Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0001  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field Accounting Period Code
     C                     Z-ADD*ZERO     YL0002  20
      * Define local work field Day of Week
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Week Number
     C                     Z-ADD*ZERO     YL0004  20
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0006  50
      * Define local work field Partial Load Max Lbs USR
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0011  50
      * Define local work field Export Status Dft
     C                     MOVEL*BLANK    YL0012  1
      * Define null work field Weight Limit for Export
     C                     Z-ADD*ZERO     YN0002 110
      * Define null work field Weight Limit for Combo
     C                     Z-ADD*ZERO     YN0003 110
      * Define null work field Weight Limit for Box/Othr
     C                     Z-ADD*ZERO     YN0004 110
      * Define local work field LSP Order Warehouse
     C                     MOVEL*BLANK    YL0013  3
      * Define local work field Load Grade
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0016 112
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field Production Hold
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Credit Hold
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Credit Hold
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Production Hold
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YL0022  50
      * Define local work field Create TMS Load Trg USR
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0024  6
      * Define local work field Blank 6 USR
     C                     MOVEL*BLANK    YL0025  6
      * Define local work field Load Change Type 2
     C                     MOVEL*BLANK    YL0026  6
      * Define local work field TMS LH Field Chg Text
     C                     MOVEL*BLANK    YL0027 35
      * Define local work field Load Change Type 3
     C                     MOVEL*BLANK    YL0028  6
      * Define local work field Load Change Type 4
     C                     MOVEL*BLANK    YL0029  6
      * Define local work field Load Change Type 5
     C                     MOVEL*BLANK    YL0030  6
      * Define local work field Time  6A             USR
     C                     MOVEL*BLANK    YL0031  6
      * Define local work field Time Alpha usr 6
     C                     MOVEL*BLANK    YL0032  6
      * Define local work field Live with TPM
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0034  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0035  3
      * Define local work field First time flag 3
     C                     MOVEL*BLANK    YL0036  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD04        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * 02/19/16 JJH E4682 - Load Scheduling Position
     C                     MOVEL'N'       YL0015           Status Flag 1
     C                     Z-ADD5000      W0SLM            *Scan limit
      *
     C                     MOVEL*BLANK    WN0144 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0144           User Profile Na
      *
     C                     MOVEL*BLANK    WN0145 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SVRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0144    ZA0013           User Profile Na
     C                     MOVEL'OMS'     ZA0014           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0145    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0144    WL0022    P      User Profile Na
     C                     MOVEL'OMS'     WL0023    P      Application Cod
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0024    P4CUC3           Company Number
     C                     MOVELWL0025    YL0035    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0145    WL0022    P      User Profile Na
     C                     MOVEL'OMS'     WL0023    P      Application Cod
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0024    P4CUC3           Company Number
     C                     MOVELWL0025    YL0035    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0035    P4LUAA           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0144    ZA0015           User Profile Na
     C                     MOVEL'OMS'     ZA0016           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0034    IFNE 0                          *IF
     C                     Z-ADDYL0034    P4CUC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0035    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P4LUAA    PARM *BLANK    WQ0036  3        Warehouse Code
     C                     PARM YL0034    WQ0037  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SXRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'Y'       WUFTFG           First time flag
     C                     MOVEL'Y'       YL0036           First time flag
      * SFL Fold/Drop  RPG    US - /UT User Source  * 
     C                     Z-ADD8         ##SFPG
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 USR0752
00002 Y2U0005
