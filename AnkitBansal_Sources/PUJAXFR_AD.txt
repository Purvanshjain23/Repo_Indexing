// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUJAXFR
// ?Date: 14.08.2025 Time: 03:50:31
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?RMC T15042 5/24/19 Read OHE EDI 943 sts = T also for intransit
//?RMC R12773 Create workfile with all intransit items/prod dates for
//?  EDI 846 to add back to ON HAND for 3PL
//?   Intransit = EDI 943 SENT but EDI 944 not received from 3PL
EXECUTE FUNCTION(RTV EDI 943 Intrnst/ItmRT) TYPE(RTVOBJ) FILE(PMAMREP)          AC2158336;
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Rtv & Crt WF Intr EDI RT) TYPE(RTVOBJ) FILE(OPBGWKP)           AC2158354;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 {
  //?USER: Initialize routine

  //?Create workfile with items that are intransit to a 3PL :
  //?  EDI 943 SENT  but EDI 944 not Received
  //?USER: Process Data record

  CASE;

  // IF DB1.Detail Line Status is Cancelled
  IF DB1.Detail_Line_Status = 'X';

  // IF *OTHERWISE
  IF *OTHERWISE;

  CASE;

  // IF DB1.Quantity Shipped Total is Greater than zero
  IF DB1.Quantity_Shipped_Total > *ZERO;

  //?Get Transfer TO warehouse.
  EXECUTE FUNCTION(Rtv Default WHS/OutWhs RT) TYPE(RTVOBJ) FILE(CAEOREP)          AC1937488;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(LCL.Warehouse_Code_SavUsr);
  PARAMETER(NLL.Outside_Warehouse_Flag);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  EXECUTE FUNCTION(Rtv & Crt Intrans EDI RT) TYPE(RTVOBJ) FILE(OMFNCPP)           AC2158355;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(LCL.Warehouse_Code_SavUsr);
  {
   //?USER: Process Data record

   CASE;

   // IF DB1.Case Quantity is GT *ZERO
   IF DB1.Case_Quantity > *ZERO;

   EXECUTE FUNCTION(Rtv Crt/Chg Intrn EDI RT) TYPE(RTVOBJ) FILE(PUA7CPP)           AC2158356;
   PARAMETER(PAR.Warehouse_Code_SavUsr);
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Item_Code);
   PARAMETER(DB1.Production_Date);
   PARAMETER(DB1.Case_Weight);
   PARAMETER(DB1.Case_Quantity);
   {
    //?USER: Processing if Data record not found

    EXECUTE FUNCTION(Crt WF EDI Txfr Intran CR) TYPE(CRTOBJ) FILE(PUA7CPP)          AC2158350;
    PARAMETER(PAR.Warehouse_Code);
    PARAMETER(PAR.Company_Number);
    PARAMETER(PAR.Item_Code);
    PARAMETER(PAR.Production_Date);
    PARAMETER(PAR.Weight_Shipped_Total);
    PARAMETER(PAR.In_Transit_Qty);
    PARAMETER('A');
    PARAMETER(*ZERO);
    PARAMETER(*ZERO);
    PARAMETER(*BLANK);
    PARAMETER(*BLANK);
    PARAMETER(*ZERO);
    PARAMETER(*ZERO);
    PARAMETER(*BLANK);
    PARAMETER(*BLANK);
    {
     //?USER: Processing before Data update

     EXECUTE FUNCTION(Set Crt Date/Time      IF) TYPE(EXCINTFUN)                     AC1523477;
     PARAMETER(DB1.Record_Status);
     PARAMETER(DB1.Create_Date);
     PARAMETER(DB1.Create_Time);
     PARAMETER(DB1.Create_User);
     PARAMETER(DB1.Create_Program);
     PARAMETER(DB1.Change_Date);
     PARAMETER(DB1.Change_Time);
     PARAMETER(DB1.Change_User);
     PARAMETER(DB1.Change_Program);
     {
      //?Execute internal function

      //?*** Set RECORD STATUS field. ***
      // PAR.Record Status = CND.Active
      PAR.Record_Status = 'A';

      //?*** Set CREATE fields. ***
      // PAR.Create Date = JOB.*Job date
      PAR.Create_Date = JOB.*Job_date;

      // PAR.Create Time = JOB.*Job time
      PAR.Create_Time = JOB.*Job_time;

      // PAR.Create User = JOB.*USER
      PAR.Create_User = JOB.*USER;

      // PAR.Create Program = JOB.*PROGRAM
      PAR.Create_Program = JOB.*PROGRAM;

      //?*** Set CHANGE fields. ***
      // PAR.Change Date = CON.*ZERO
      PAR.Change_Date = *ZERO;

      // PAR.Change Time = CON.*ZERO
      PAR.Change_Time = *ZERO;

      // PAR.Change User = CON.*BLANK
      PAR.Change_User = *BLANK;

      // PAR.Change Program = CON.*BLANK
      PAR.Change_Program = *BLANK;

     }

    }

    //?USER: Process Data record

    // LCL.In Transit Qty = DB1.In Transit Qty + PAR.In Transit Qty
    LCL.In_Transit_Qty = DB1.In_Transit_Qty + PAR.In_Transit_Qty;

    // LCL.Weight Shipped Total = DB1.Weight Shipped Total + PAR.Weight Shipped Total
    LCL.Weight_Shipped_Total = DB1.Weight_Shipped_Total + PAR.Weight_Shipped_Total;

    EXECUTE FUNCTION(Chg WF EDI Txfr Intran CH) TYPE(CHGOBJ) FILE(PUA7CPP)          AC2158351;
    PARAMETER(DB1.Warehouse_Code);
    PARAMETER(DB1.Company_Number);
    PARAMETER(DB1.Item_Code);
    PARAMETER(DB1.Production_Date);
    PARAMETER(LCL.Weight_Shipped_Total);
    PARAMETER(LCL.In_Transit_Qty);
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Create_Date);
    PARAMETER(DB1.Create_Time);
    PARAMETER(DB1.Create_User);
    PARAMETER(DB1.Create_Program);
    PARAMETER(DB1.Change_Date);
    PARAMETER(DB1.Change_Time);
    PARAMETER(DB1.Change_User);
    PARAMETER(DB1.Change_Program);
    {
     //?USER: Processing before Data update

     EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
     PARAMETER(DB1.Change_Date);
     PARAMETER(DB1.Change_Time);
     PARAMETER(DB1.Change_User);
     PARAMETER(DB1.Change_Program);
     {
      //?Execute internal function

      // PAR.Change Date = JOB.*Job date
      PAR.Change_Date = JOB.*Job_date;

      // PAR.Change Time = JOB.*Job time
      PAR.Change_Time = JOB.*Job_time;

      // PAR.Change User = JOB.*USER
      PAR.Change_User = JOB.*USER;

      // PAR.Change Program = JOB.*PROGRAM
      PAR.Change_Program = JOB.*PROGRAM;

     }

    }

   }

   ENDIF;

  }

  ENDIF;

  ENDIF;

 }

}


