     H/TITLE Prt Purchase Order    PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 02/18/25  Time  : 10:41:54
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FECP004L1IF  E           K        DISK
      * RTV : EDI Purchase Order Header Retrieval index
      *
     FECP006L1IF  E           K        DISK
      * RTV : EDI Purchase Order Name   Retrieval index
      *
     FPDNEREL2IF  E           K        DISK
      * RSQ : Customer EXT              D&B/CustNbr
      *
     FCAEOREL3IF  E           K        DISK
      * RSQ : Company Customer          Customer/Company
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FPDNFREL1IF  E           K        DISK
      * RTV : Salesperson Electronic CM Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FECP005L1IF  E           K        DISK
      * RTV : EDI Purchase Order Detail Retrieval index
      *
     FPNGQREL2IF  E           K        DISK
      * RSQ : EDI Bill To Interchange   TradePartner/IntCode
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FPBBTREL1IF  E           K        DISK
      * RTV : Item Default Extension    Retrieval index
      *
     FPOBIREL1IF  E           K        DISK
      * RTV : Customer Item Reference   Retrieval index
      *
     FPOBIREL2IF  E           K        DISK
      * RSQ : Customer Item Reference   Ship to, CIR Resource
      *
     FECP005D1IF  E           K        DISK
      * RTV : EDI PO SAC/G72 Al/Chg DTL Retrieval index
      *
     FPBB0CPL1IF  E           K        DISK
      * RTV : EDI PO Notes Detail       Retrieval index
      *
     FECP004D1IF  E           K        DISK
      * RTV : EDI PO SAC/G72 AL/CHG HDR Retrieval index
      *
     FPBA9CPL1IF  E           K        DISK
      * RTV : EDI PO Notes              Retrieval index
      *
     FPON7PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Purchase Order    PF  Print file
      *
     E                    A1         07  1
     E                    A2         07  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WABKC7
     I              NEUFTX                          WAUFTX
     I              NEUGTX                          WAUGTX
     I              NEPFNA                          WAPFNA
     I              NEJ5NX                          WAJ5NX
     I              NEU5TX                          WAU5TX
     I              NEU6TX                          WAU6TX
     I              NEW0TX                          WAW0TX
     I              NEHSSX                          WAHSSX
     I              NEHUSX                          WAHUSX
     I              NEHVSX                          WAHVSX
     I              NEAAC8                          WAAAC8
     I              NEP0SX                          WAP0SX
     I              NEP1SX                          WAP1SX
     I              NEP2SX                          WAP2SX
     I              NEP3SX                          WAP3SX
     I              NEP4SX                          WAP4SX
     I              NEP5SX                          WAP5SX
     I              NEP6SX                          WAP6SX
     I              NEUVST                          WAUVST
     I              NEUWST                          WAUWST
     I              NEUXST                          WAUXST
     I              NEVSST                          WAVSST
     I              NEAATM                          WAAATM
     I              NEAYNA                          WAAYNA
     I              NEA0NA                          WAA0NA
     I              NEAXDT                          WAAXDT
      *
     I@BIRECZ
      * Customer Item Reference   Ship to, CIR Resource
      * Renamed input format fields
     I              BIBKC7                          WBBKC7
     I              BIHGCD                          WBHGCD
     I              BICOAA                          WBCOAA
     I              BICPAA                          WBCPAA
     I              BIPSNA                          WBPSNA
     I              BIPTNA                          WBPTNA
     I              BIPUNA                          WBPUNA
     I              BILBSX                          WBLBSX
     I              BILCSX                          WBLCSX
     I              BILDSX                          WBLDSX
     I              BILESX                          WBLESX
     I              BILFSX                          WBLFSX
     I              BIVSST                          WBVSST
     I              BIMJDT                          WBMJDT
     I              BIBETM                          WBBETM
     I              BICCVN                          WBCCVN
     I              BICDVN                          WBCDVN
     I              BIMKDT                          WBMKDT
     I              BIBFTM                          WBBFTM
     I              BICEVN                          WBCEVN
     I              BICFVN                          WBCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: EDI Purchase Order Header
      * I : RST ST02-TRANS SET CONTROL NU
     I                                    P   1   50P1TSCN
      * I :  G7601-QUANTITY ORDERED
     I                                    P   6  114P1D3VL
      * I :  G7603-WEIGHT ORDERED
     I                                    P  12  172P1D4VL
      * I :  G7608-ORDER AMOUNT
     I                                    P  18  232P1AMTX
     IP2PARM      DS
      * FLD: Salesperson Electronic CM
      * O :  Email Address
     I                                        1  50 P2UGTX
     IP3PARM      DS
      * O :  Ship To Name
     I                                        1  30 P3BRTX
     IP4PARM      DS
      * B :  Email PO Error
     I                                        1   1 P4EMPO
     IP5PARM      DS
      * O :  EDI Shipto Duns Number
     I                                        1  20 P5XOT1
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1TSCN    PARM           WP0001  90       ST02-TRANS SET
     C           P1D3VL    PARM           WP0002 114       G7601-QUANTITY
     C           P1D4VL    PARM           WP0003 112       G7603-WEIGHT OR
     C           P1AMTX    PARM           WP0004 112       G7608-ORDER AMO
     C                     PARM P2UGTX    WP0005 50        Email Address
     C                     PARM P3BRTX    WP0006 30        Ship To Name
     C           P4EMPO    PARM P4EMPO    WP0007  1        Email PO Error
     C                     PARM P5XOT1    WP0008 20        EDI Shipto Duns
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Purchase Order    PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE#IENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Purchase Order    PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BQTSCN    WQKA01           ST02-TRANS SET
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           ST02-TRANS SET
      * Setup key
     C                     Z-ADDP1TSCN    WQKA01           ST02-TRANS SET
      * Establish starting position
     C           KRSA      SETLL@P004LA                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $UD3VL           G7601-QUANTITY
     C                     Z-ADD*ZERO     $UD4VL           G7603-WEIGHT OR
     C                     Z-ADD*ZERO     $UAMTX           G7608-ORDER AMO
     C                     MOVEL*BLANK    $UB6NA           Special Instruc
     C                     MOVEL*BLANK    $UBYNA           Special Instruc
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBQTSCN    $CTSCN           ST02-TRANS SET
     C                     Z-ADDBQOSDT    $COSDT           G5002-ORDER DAT
     C                     MOVEL*BLANK    $CR4CD           Sales Route Cod
     C                     MOVEL*BLANK    $CMZNA           Sales Route Des
     C                     MOVELBQPONO    $CPONO           G5003-PURCHASE
     C                     Z-ADDBQDELV    $CDELV           G6202-DELIVERY
     C                     MOVELBQSHMT    $CSHMT           G6601-SHIPMENT
     C                     MOVEL*BLANK    $CHLTX           Condition Desc.
     C                     MOVELBQINRF    $CINRF           G6105-INQUIRY R
     C                     MOVELBQYDT1    $CYDT1           Delivery PO Num
     C                     MOVELBQCNUM    $CCNUM           G6104-COMM NUMB
     C                     Z-ADDBQT6DT    $CT6DT           G6202 Ship Date
     C                     MOVELBQPLEX    $CPLEX           G6603-PALLET EX
     C                     MOVEL*BLANK    $CHMTX           Condition Desc.
     C                     MOVELBQL3SX    $CL3SX           G5001-ORDER STA
     C                     MOVEL*BLANK    $CGUTX           Condition Name
     C                     MOVELBQOJAA    $COJAA           POH PO Purpose
     C                     MOVEL*BLANK    $CHOTX           Condition Desc.
     C                     MOVELBQLDOP    $CLDOP           G6604-UNIT LOAD
     C                     MOVEL*BLANK    $CHNTX           Condition Desc.
     C                     MOVEL*BLANK    $COQT1           EDI Billto Duns
     C                     MOVEL*BLANK    $CXOT1           EDI Shipto Duns
     C                     MOVEL*BLANK    $CAETX           Bill to Name
     C                     MOVEL*BLANK    $CBRTX           Ship To Name
     C                     MOVEL*BLANK    $CB1NA           Bill to Address
     C                     MOVEL*BLANK    $CHMNA           Ship To Address
     C                     MOVEL*BLANK    $CB3NA           Bill to Address
     C                     MOVEL*BLANK    $CHONA           Ship To Address
     C                     MOVEL*BLANK    $CB2NA           Bill to City
     C                     MOVEL*BLANK    $CBHCD           Bill to State C
     C                     MOVEL*BLANK    $CC8TX           Bill to Zip_Pos
     C                     MOVEL*BLANK    $CDCDE           N104-ID CODE
     C                     Z-ADD*ZERO     $CAJNB           Customer Number
     C                     MOVEL*BLANK    $CBATX           Vendor Name
     C                     MOVELBQGNTX    $CGNTX           SAC01-ALLOW OR
     C                     MOVELBQHUAA    $CHUAA           SAC02-SERV PROM
     C                     Z-ADDBQHUVL    $CHUVL           SAC05-$$ AMT OF
     C                     MOVELBQHVAA    $CHVAA           SAC12-ALLOW/CHG
     C                     MOVELBQX8T1    $CX8T1           SAC15-Descripti
     C                     MOVELBQJ2AA    $CJ2AA           DTM01-Ship Date
     C                     MOVEL*BLANK    $CPJNA           Remittance Addr
     C                     MOVEL*BLANK    $CHNNA           Ship To City
     C                     MOVEL*BLANK    $CPKNA           Remittance Addr
     C                     MOVEL*BLANK    $CDBCD           Ship To State C
     C                     MOVEL*BLANK    $CCKTX           Ship To Zip_Pos
     C                     MOVEL*BLANK    $CPMNA           Remittance City
     C                     MOVEL*BLANK    $CYNTX           Remittance Stat
     C                     MOVEL*BLANK    $CYOTX           Remittance Zip
     C                     MOVELBQDKAA    $CDKAA           G6101-CONTACT F
     C                     MOVELBQNAME    $CNAME           G6102-CONTACT N
     C                     MOVELBQCQLF    $CCQLF           G6103-COMM NUM
     C                     MOVELBQQLFX    $CQLFX           G6201-DATE QUAL
     C                     MOVELBQMTTY    $CMTTY           G6602-METHOD TY
     C                     MOVELBQROUT    $CROUT           G6605-ROUTING
     C                     MOVELBQFOBP    $CFOBP           G6606-FOB POINT
     C                     Z-ADDBQD3VL    $CD3VL           G7601-QUANTITY
     C                     MOVELBQUNIT    $CUNIT           G6802-BASIS FOR
     C                     Z-ADDBQD4VL    $CD4VL           G7603-WEIGHT OR
     C                     Z-ADDBQAMTX    $CAMTX           G7608-ORDER AMO
     C                     MOVELBQDSTS    $CDSTS           EDI RECORD STAT
     C                     MOVELBQSRAA    $CSRAA           Customer Ref ID
     C                     MOVELBQBRU1    $CBRU1           Customer Ref ID
     C                     MOVELBQSSAA    $CSSAA           Internal Ord ID
     C                     MOVELBQBSU1    $CBSU1           Internal Order
     C                     MOVELBQSTAA    $CSTAA           Buyer ID Qualif
     C                     MOVELBQBTU1    $CBTU1           Buyer Identific
     C                     MOVELBQSUAA    $CSUAA           Reference Vs Nb
     C                     MOVELBQBUU1    $CBUU1           Ref Version Nbr
     C                     MOVELBQSVAA    $CSVAA           Revision Nbr ID
     C                     MOVELBQBVU1    $CBVU1           Revision Nbr
     C                     MOVELBQSWAA    $CSWAA           Ref ID Qualifie
     C                     MOVELBQBWU1    $CBWU1           Reference 01
     C                     MOVELBQSXAA    $CSXAA           Ref ID Qualifie
     C                     MOVELBQBXU1    $CBXU1           OH Order Number
     C                     MOVELBQNLST    $CNLST           Don't Create Or
     C                     Z-ADDBQUFDT    $CUFDT           POH Date Stamp
     C                     MOVELBQJ5NX    $CJ5NX           EDI Trading Par
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Purchase Order    PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * CASE: DB1.G7601-QUANTITY ORDERED is Entered
     C           BQD3VL    IFNE *ZERO                      *IF
     C                     Z-ADD$CD3VL    $UD3VL           G7601-QUANTITY
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1D3VL    $UD3VL           G7601-QUANTITY
     C                     END                             *FI
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@P004LA                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     ELSE
      * Next record - Detect level breaks
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EOFA    IFEQ '1'
      * PRTOBJ calls before print of final totals format
      * Embedded PRTOBJ : PRT PO SAC/G72 Al/Chg PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * CUR = PAR By name
     C                     Z-ADDP1D3VL    $UD3VL           G7601-QUANTITY
     C                     Z-ADDP1D4VL    $UD4VL           G7603-WEIGHT OR
     C                     Z-ADDP1AMTX    $UAMTX           G7608-ORDER AMO
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 9
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           P1D3VL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P1D4VL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           P1AMTX    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      * Print format
     C                     WRITE$UFINTTL
     C                     END
      * PRTOBJ calls after print of final totals format
      * Embedded PRTOBJ : PRT BT Cust by DUNS   PO
     C                     EXSR UGSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT ST Cust by DUNS   PO
     C                     EXSR UHSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT EDI PO Notes      PO
     C                     EXSR UISUBR                     Embedded PRTOBJ
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Purchase Order    PO: Mainline
      *================================================================
      * Prt Purchase Order    PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN BRTSCN    WQKB01           ST02-TRANS SET
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           ST02-TRANS SET
      * Setup key
     C                     Z-ADD$CTSCN    WQKB01           ST02-TRANS SET
      * Establish starting position
     C           KRSB      SETLL@P005LE                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        ST02-TRANS SET
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBRTSCN    $DTSCN           ST02-TRANS SET
     C                     Z-ADDBRSEQX    $DSEQX           ITEM SEQUENCE N
     C                     MOVELBRLEST    $DLEST           POC02-Chg/Resp
     C                     MOVELBRUPCX    $DUPCX           G6804/P107 UPC/
     C                     MOVELBRPRID    $DPRID           G6806/P109 PROD
     C                     MOVEL*BLANK    $DLICD           UOM Pricing Dft
     C                     Z-ADD*ZERO     $DAWPC           Conversion Fact
     C                     MOVELBRDESC    $DDESC           G6901-ITEM DESC
     C                     Z-ADDBRD5VL    $DD5VL           G6801-QUANTITY
     C                     Z-ADDBRPRCX    $DPRCX           G6803-ITEM LIST
     C                     MOVELBROIAA    $DOIAA           POD Basis Unit
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBRTSCN    $ETSCN           ST02-TRANS SET
     C                     Z-ADDBRSEQX    $ESEQX           ITEM SEQUENCE N
     C                     MOVELBRLEST    $ELEST           POC02-Chg/Resp
     C                     MOVEL*BLANK    $EG5TX           Text 1 USR
     C                     Z-ADDBRS2NY    $ES2NY           POD Item Age Da
     C                     MOVELBRUPCX    $EUPCX           G6804/P107 UPC/
     C                     MOVELBRPRID    $EPRID           G6806/P109 PROD
     C                     MOVEL*BLANK    $ENLTX           USR 15 Text
     C                     MOVEL*BLANK    $ELICD           UOM Pricing Dft
     C                     Z-ADD*ZERO     $EAWPC           Conversion Fact
     C                     MOVELBRDESC    $EDESC           G6901-ITEM DESC
     C                     MOVELBRR2AA    $ER2AA           G6807/PO110 Pro
     C                     MOVELBRAOU1    $EAOU1           G6808/PO111 Pro
     C                     MOVELBRR4AA    $ER4AA           PO112 Prod ID Q
     C                     MOVELBRAQU1    $EAQU1           PO113 Prod ID
     C                     MOVELBRR3AA    $ER3AA           P106 UPC/GTIN Q
     C                     MOVELBRAPU1    $EAPU1           POD Unused GTIN
     C                     MOVELBRYCT1    $EYCT1           POD unused text
     C                     MOVELBRNKST    $ENKST           POD Added to an
     C                     Z-ADDBRUEDT    $EUEDT           POD unused date
     C                     Z-ADDBRMJVL    $EMJVL           POD SBD Item Nu
     C                     Z-ADDBRUINY    $EUINY           POD Pack Qty
     C                     MOVEL*BLANK    $EDSC4           USR Description
     C                     Z-ADDBRD5VL    $ED5VL           G6801-QUANTITY
     C                     MOVELBRUNIT    $EUNIT           G6802-BASIS FOR
     C                     Z-ADDBRPRCX    $EPRCX           G6803-ITEM LIST
     C                     MOVELBROIAA    $EOIAA           POD Basis Unit
     C                     MOVEL*BLANK    $EDTSX           Print (Yes/No)
     C                     MOVEL*BLANK    $ECUU1           IDE GTIN
     C                     MOVELBRPRQL    $EPRQL           G6805/P108 PROD
      * USER: Process before print of detail format
     C                     MOVELBRDESC    $EDSC4           USR Description
      * Rtv Ship To Name      RT - EDI Purchase Order Name  * 
     C                     EXSR SRRVGN
      * If Sysco/Dailys Sysco
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.EDI Trading Partner No. is SYSCO Dailys
      *   |- c2    : PAR.EDI Trading Partner No. is SYSCO Foods
      *   '-
     C           $CJ5NX    IFEQ @CN,004                    *IF
     C           $CJ5NX    OREQ 'SYSCO'                    *OR
      * E003964  slm 02242015 - DSYSCO OR SYSCO
      * Move the 10 char item to a 7 char item then convert it to numeric
      * use it to key to the Customer item reference file.
     C                     MOVELBRPRID    YL0029           Item Code Txt
      * *Right Justify - /UT Functions  * 
     C                     CALL 'PDULXFR'              90  *Right Justify
     C                     PARM *BLANK    W0RTN   7
     C           YL0029    PARM YL0029    WQ0001255        Right Justify -
     C                     PARM 7         WQ0002  30       Length
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDULXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0029    YL0030           Item Code Numbe
      * Validate that the item code exists.
      * Rtv Item Defaults      RT - Item Default  * 
     C                     EXSR SSRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Get the Ship To cust nbr by DUNS from the Customer EXT.
      * Rtv the Customer Item Ref record and update the UOM Base Prc
      * UPD CIR UMBPrc        XF - EDI Purchase Order Header  * 
     C                     CALL 'PBORXFR'              90  UPD CIR UMBPrc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0028    WQ0003 20        EDI Cust Duns N
     C                     PARM YL0030    WQ0004  70       Item Code
     C                     PARM BRAOU1    WQ0005 14        CIR Resource No
     C                     PARM BROIAA    WQ0006  2        CIR UM Base Pri
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBORXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0032    $ELICD           UOM Pricing Dft
     C                     END                             *FI
      * ***** VALIDATE GTIN *****
     C                     MOVEL*BLANK    $EDTSX           Print (Yes/No)
      * CASE: LCL.EDI BTI GTIN Required is Yes
     C           YL0026    IFEQ 'Y'                        *IF
      * Rtv GTIN              RT - Item Default Extension  * 
     C                     EXSR STRVGN
      * CASE: CUR.IDE GTIN is Blank
     C           $ECUU1    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,005   $ECUU1           IDE GTIN
     C                     MOVEL'Y'       $EDTSX           Print (Yes/No)
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CUR.G6804/P107 UPC/GTIN CODE NE CUR.IDE GTIN
     C           $EUPCX    IFNE $ECUU1                     *IF
     C                     MOVEL'Y'       $EDTSX           Print (Yes/No)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Resource nbr      PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT EDI PO SAC/G72    PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT EDI PO Notes DTL  PO
     C                     EXSR UESUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BRTSCN    WZB001           ST02-TRANS SET
     C                     Z-ADDBRTSCN    WZB001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@P005LE                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        ST02-TRANS SET
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        ST02-TRANS SET
     C                     ELSE
      * Next record - Detect level breaks
     C           BRTSCN    IFNE WZB001                     ST02-TRANS SET
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$OFINTTL
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Purchase Order    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQKC01           Ship To Custome
     C           *LIKE     DEFN WBCOAA    WQKC02           CIR Resource No
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Ship To Custome
     C                     KFLD           WQKC02           CIR Resource No
      * Setup key
     C                     Z-ADD$CAJNB    WQKC01           Ship To Custome
     C                     MOVEL$ENLTX    WQKC02           CIR Resource No
      * Establish starting position
     C           KRSC      SETLL@BIRECZ                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Ship To Custome
     C                     MOVEL'Y'       W0CL01  1        CIR Resource No
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBBKC7    $FBKC7           Ship To Custome
     C                     Z-ADDWBHGCD    $FHGCD           Item Code
     C                     MOVELWBCOAA    $FCOAA           CIR Resource No
     C                     MOVELWBCPAA    $FCPAA           CIR Item No
     C                     MOVELWBPSNA    $FPSNA           CIR Description
     C                     MOVELWBPTNA    $FPTNA           CIR Description
     C                     MOVELWBPUNA    $FPUNA           CIR Description
     C                     MOVELWBLBSX    $FLBSX           CIR Unused Stat
     C                     MOVELWBLCSX    $FLCSX           CIR Unused Stat
     C                     MOVELWBLDSX    $FLDSX           CIR Resource No
     C                     MOVELWBLESX    $FLESX           CIR UM Base Pri
     C                     MOVELWBLFSX    $FLFSX           CIR Unused Stat
     C                     MOVELWBVSST    $FVSST           Record Status
     C                     Z-ADDWBMJDT    $FMJDT           Create Date
     C                     Z-ADDWBBETM    $FBETM           Create Time
     C                     MOVELWBCCVN    $FCCVN           Create User
     C                     MOVELWBCDVN    $FCDVN           Create Program
     C                     Z-ADDWBMKDT    $FMKDT           Change Date
     C                     Z-ADDWBBFTM    $FBFTM           Change Time
     C                     MOVELWBCEVN    $FCEVN           Change User
     C                     MOVELWBCFVN    $FCFVN           Change Program
      * USER: Process before print of detail format
      * Rtv Item Descriptions  RT - Item Default  * 
     C                     EXSR SWRVGN
     C                     Z-ADDWBHGCD    $FHGCD           Item Code
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBBKC7    WZC001           Ship To Custome
     C                     Z-ADDWBBKC7    WZC001
     C           *LIKE     DEFN WBCOAA    WZC002           CIR Resource No
     C                     MOVELWBCOAA    WZC002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@BIRECZ                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Ship To Custome
     C                     MOVEL*BLANK    W0CL01  1        CIR Resource No
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Ship To Custome
     C                     MOVEL'Y'       W0CL01  1        CIR Resource No
     C                     ELSE
      * Next record - Detect level breaks
     C           WBBKC7    IFNE WZC001                     Ship To Custome
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WBCOAA    IFNE WZC002                     CIR Resource No
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * PRT EDI PO SAC/G72    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A7H9NY    WQKD01           EDI SURROGATE N
     C           *LIKE     DEFN A7SEQX    WQKD02           ITEM SEQUENCE N
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           EDI SURROGATE N
     C                     KFLD           WQKD02           ITEM SEQUENCE N
      * Setup key
     C                     Z-ADD$ETSCN    WQKD01           EDI SURROGATE N
     C                     Z-ADD$ESEQX    WQKD02           ITEM SEQUENCE N
      * Establish starting position
     C           KRSD      SETLL@A7CPQN                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        EDI SURROGATE N
     C                     MOVEL'Y'       W0DL01  1        ITEM SEQUENCE N
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA7H9NY    $HH9NY           EDI SURROGATE N
      * Load related totals format
     C                     Z-ADDA7H9NY    $LH9NY           EDI SURROGATE N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA7H9NY    $IH9NY           EDI SURROGATE N
     C                     Z-ADDA7SEQX    $ISEQX           ITEM SEQUENCE N
      * Load related totals format
     C                     Z-ADDA7H9NY    $KH9NY           EDI SURROGATE N
     C                     Z-ADDA7SEQX    $KSEQX           ITEM SEQUENCE N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA7H9NY    $JH9NY           EDI SURROGATE N
     C                     Z-ADDA7SEQX    $JSEQX           ITEM SEQUENCE N
     C                     Z-ADDA7YFNY    $JYFNY           Item Secondary
     C                     MOVELA7QVST    $JQVST           S1 Allow/Chg In
     C                     MOVELA7QHAA    $JQHAA           S2/G1 Allow/Chg
     C                     MOVELA7QIAA    $JQIAA           S3 Agency Quali
     C                     MOVELA7Z8T1    $JZ8T1           S4 Agency Servc
     C                     MOVELA7QKAA    $JQKAA           S6 Allow/Chrge
     C                     Z-ADDA7MTVL    $JMTVL           S8/G5 Rate
     C                     Z-ADDA7G6PC    $JG6PC           S7/G9 Percent
     C                     Z-ADDA7MQVL    $JMQVL           S5/G8 Amount
     C                     MOVELA7XHNY    $JXHNY           G3 Allow/Chg NB
     C                     Z-ADDA7C2C3    $JC2C3           S9/G7 Unit or B
     C                     Z-ADDA7MSVL    $JMSVL           S10/G6 Quantity
     C                     Z-ADDA7QXQT    $JQXQT           S11 Quantity
     C                     MOVELA7QEAA    $JQEAA           S12/G2 All/Chg
     C                     MOVELA7Z9T1    $JZ9T1           S13 Ref ID
     C                     MOVELA7Z9T2    $JZ9T2           S14/G11 Option
     C                     MOVELA7Z7T1    $JZ7T1           S15 Description
     C                     MOVELA7UINA    $JUINA           S16 Language Co
     C                     Z-ADDA7XINY    $JXINY           G4 Exception Nb
     C                     Z-ADDA7MUVL    $JMUVL           G10 Dollar Basi
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A7H9NY    WZD001           EDI SURROGATE N
     C                     Z-ADDA7H9NY    WZD001
     C           *LIKE     DEFN A7SEQX    WZD002           ITEM SEQUENCE N
     C                     Z-ADDA7SEQX    WZD002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@A7CPQN                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        EDI SURROGATE N
     C                     MOVEL*BLANK    W0DL01  1        ITEM SEQUENCE N
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        EDI SURROGATE N
     C                     MOVEL'Y'       W0DL01  1        ITEM SEQUENCE N
     C                     ELSE
      * Next record - Detect level breaks
     C           A7H9NY    IFNE WZD001                     EDI SURROGATE N
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           A7SEQX    IFNE WZD002                     ITEM SEQUENCE N
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$KKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$LKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
      * Mention hidden format
     C   99N99             WRITE$MFINTTL
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * PRT EDI PO Notes DTL  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN B0TSCN    WQKE01           ST02-TRANS SET
     C           *LIKE     DEFN B0SEQX    WQKE02           ITEM SEQUENCE N
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           ST02-TRANS SET
     C                     KFLD           WQKE02           ITEM SEQUENCE N
      * Setup key
     C                     Z-ADD$ETSCN    WQKE01           ST02-TRANS SET
     C                     Z-ADD$ESEQX    WQKE02           ITEM SEQUENCE N
      * Establish starting position
     C           KRSE      SETLL@B0CPUM                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        ST02-TRANS SET
     C                     MOVEL'Y'       W0EL01  1        ITEM SEQUENCE N
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP01  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDB0TSCN    $NTSCN           ST02-TRANS SET
     C                     Z-ADDB0SEQX    $NSEQX           ITEM SEQUENCE N
     C                     Z-ADDB0PSQ2    $NPSQ2           PO Secondary Se
     C                     MOVELB0R1AA    $NR1AA           Ref ID Qualifie
     C                     MOVELB0ANU1    $NANU1           Note
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN B0TSCN    WZE001           ST02-TRANS SET
     C                     Z-ADDB0TSCN    WZE001
     C           *LIKE     DEFN B0SEQX    WZE002           ITEM SEQUENCE N
     C                     Z-ADDB0SEQX    WZE002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@B0CPUM                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        ST02-TRANS SET
     C                     MOVEL*BLANK    W0EL01  1        ITEM SEQUENCE N
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        ST02-TRANS SET
     C                     MOVEL'Y'       W0EL01  1        ITEM SEQUENCE N
     C                     ELSE
      * Next record - Detect level breaks
     C           B0TSCN    IFNE WZE001                     ST02-TRANS SET
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C           B0SEQX    IFNE WZE002                     ITEM SEQUENCE N
     C           W0EL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL01
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP01
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         F0MAIN    BEGSR
      *================================================================
      * PRT PO SAC/G72 Al/Chg PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A8H9NY    WQKF01           EDI SURROGATE N
      * Define keylist
     C           KRSF      KLIST
     C                     KFLD           WQKF01           EDI SURROGATE N
      * Setup key
     C                     Z-ADDP1TSCN    WQKF01           EDI SURROGATE N
      * Establish starting position
     C           KRSF      SETLL@A8CPQQ                    *
      * Read first record with user selection
     C                     EXSR F3READ
     C           W0EOFF    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0FL1P  1        First page
     C                     MOVEL'Y'       W0FL00  1        EDI SURROGATE N
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      * Print report body
     C           W0EOFF    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR F1PHDR
      * Print report detail line
     C                     EXSR F2PDTL
      * Read next record with user selection
     C                     EXSR F3READ
      * Print totals
     C                     EXSR F4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         F0EXIT    ENDSR
      /EJECT
     CSR         F1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0FL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP1P  1
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA8H9NY    $QH9NY           EDI SURROGATE N
      * Load related totals format
     C                     Z-ADDA8H9NY    $SH9NY           EDI SURROGATE N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP00  1
     C                     END
      *
      *================================================================
     CSR         F1EXIT    ENDSR
      /EJECT
     CSR         F2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA8H9NY    $RH9NY           EDI SURROGATE N
     C                     Z-ADDA8UONY    $RUONY           ENT01-SEQUENCE
     C                     MOVELA8QHAA    $RQHAA           S2/G1 Allow/Chg
     C                     Z-ADDA8MTVL    $RMTVL           S8/G5 Rate
     C                     Z-ADDA8G6PC    $RG6PC           S7/G9 Percent
     C                     Z-ADDA8MQVL    $RMQVL           S5/G8 Amount
     C                     MOVELA8QEAA    $RQEAA           S12/G2 All/Chg
     C                     MOVELA8XHNY    $RXHNY           G3 Allow/Chg NB
     C                     MOVELA8QVST    $RQVST           S1 Allow/Chg In
     C                     MOVELA8QIAA    $RQIAA           S3 Agency Quali
     C                     MOVELA8Z8T1    $RZ8T1           S4 Agency Servc
     C                     MOVELA8QKAA    $RQKAA           S6 Allow/Chrge
     C                     Z-ADDA8C2C3    $RC2C3           S9/G7 Unit or B
     C                     Z-ADDA8MSVL    $RMSVL           S10/G6 Quantity
     C                     Z-ADDA8QXQT    $RQXQT           S11 Quantity
     C                     MOVELA8UHNA    $RUHNA           S15 Allow/Chg D
     C                     MOVELA8Z9T1    $RZ9T1           S13 Ref ID
     C                     MOVELA8Z9T2    $RZ9T2           S14/G11 Option
     C                     MOVELA8UINA    $RUINA           S16 Language Co
     C                     Z-ADDA8XINY    $RXINY           G4 Exception Nb
     C                     Z-ADDA8MUVL    $RMUVL           G10 Dollar Basi
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         F2EXIT    ENDSR
      /EJECT
     CSR         F3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A8H9NY    WZF001           EDI SURROGATE N
     C                     Z-ADDA8H9NY    WZF001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFF    OREQ '1'
     C           KRSF      READE@A8CPQQ                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFF  1
      * Quit if no record read
     C           W0EOFF    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0FL00  1        EDI SURROGATE N
     C           W0EOFF    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0FL00  1        EDI SURROGATE N
     C                     ELSE
      * Next record - Detect level breaks
     C           A8H9NY    IFNE WZF001                     EDI SURROGATE N
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL00
     C                     END
     C                     END
      *================================================================
     CSR         F3EXIT    ENDSR
      /EJECT
     CSR         F4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0FL00    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$SKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP00
     C                     END
      *
     C           W0EOFF    IFEQ '1'
      * Mention hidden format
     C   99N99             WRITE$TFINTTL
     C                     END
      *
      *================================================================
     CSR         F4EXIT    ENDSR
      /EJECT
     CSR         G0MAIN    BEGSR
      *================================================================
      * PRT BT Cust by DUNS   PO: Mainline
      *================================================================
      * PRT BT Cust by DUNS   PO: Initialise
     C                     EXSR ZGINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN NEU5TX    WQKG01           EDI Cust Duns N
      * Define keylist
     C           KRSG      KLIST
     C                     KFLD           WQKG01           EDI Cust Duns N
      * Setup key
     C                     MOVELYL0011    WQKG01           EDI Cust Duns N
      * Establish starting position
     C           KRSG      SETLL@NEREIW                    *
      * Read first record with user selection
     C                     EXSR G3READ
     C           W0EOFG    IFNE '0'                        IF
      * USER: Null report processing
     C                     MOVEL'Y'       WN0004           USR Display 1
      * CLC Set Null 1stPg PO1 US - /UT User Source  * 
     C                     MOVEL'Y'       W0BL1P
     C                     EXSR B1PHDR
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0GL1P  1        First page
     C                     MOVEL'Y'       W0GL00  1        EDI Cust Duns N
     C                     MOVEL'Y'       W0GL01  1        Ship To Custome
      * Set column headings flag
     C                     MOVE 'Y'       W0GCDT
      * Print report body
     C           W0EOFG    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR G1PHDR
      * Print report detail line
     C                     EXSR G2PDTL
      * Read next record with user selection
     C                     EXSR G3READ
      * Print totals
     C                     EXSR G4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         G0EXIT    ENDSR
      /EJECT
     CSR         G1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0GL1P    IFEQ 'Y'
      * Load key header format
     C                     MOVEL*BLANK    $VU5TX           EDI Cust Duns N
      * USER: Process before print of first page format
     C                     MOVELYL0011    $VU5TX           EDI Cust Duns N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP1P  1
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Load key header format
     C                     MOVELNEU5TX    $WU5TX           EDI Cust Duns N
     C                     Z-ADD*ZERO     $WB0C7           Bill to Custome
     C                     MOVEL*BLANK    $WAETX           Bill to Name
     C                     MOVEL*BLANK    $WB1NA           Bill to Address
     C                     MOVEL*BLANK    $WB2NA           Bill to City
     C                     MOVEL*BLANK    $WBHCD           Bill to State C
     C                     MOVEL*BLANK    $WC8TX           Bill to Zip_Pos
     C                     MOVELNEHVSX    $WHVSX           EDI Advanced Sh
     C                     Z-ADDNEAAC8    $WAAC8           Customer G_L Ve
     C                     MOVELNEVSST    $WVSST           Record Status
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP00  1
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP01  1
     C                     END
      *
      *================================================================
     CSR         G1EXIT    ENDSR
      /EJECT
     CSR         G2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELNEU5TX    $XU5TX           EDI Cust Duns N
     C                     Z-ADDNEBKC7    $XBKC7           Ship To Custome
     C                     MOVEL*BLANK    $XAETX           Bill to Name
     C                     MOVEL*BLANK    $XB1NA           Bill to Address
     C                     MOVEL*BLANK    $XB2NA           Bill to City
     C                     MOVEL*BLANK    $XBHCD           Bill to State C
     C                     MOVEL*BLANK    $XC8TX           Bill to Zip_Pos
     C                     MOVEL*BLANK    $XHPNA           Ship To Address
     C                     MOVELNEUFTX    $XUFTX           Internet Passwo
     C                     MOVELNEUGTX    $XUGTX           Email Address
     C                     MOVELNEPFNA    $XPFNA           Email User ID
     C                     MOVELNEJ5NX    $XJ5NX           EDI Trading Par
     C                     MOVELNEU6TX    $XU6TX           EDI Warehouse_S
     C                     MOVELNEW0TX    $XW0TX           State Tax ID
     C                     MOVELNEHSSX    $XHSSX           Cust Shipping T
     C                     MOVELNEHUSX    $XHUSX           One Invoice Per
     C                     MOVELNEHVSX    $XHVSX           EDI Advanced Sh
     C                     Z-ADDNEAAC8    $XAAC8           Customer G_L Ve
     C                     MOVELNEP0SX    $XP0SX           Air Freight Ord
     C                     MOVELNEP1SX    $XP1SX           Regional Mgr Fa
     C                     MOVELNEP2SX    $XP2SX           Employee_Co_Pac
     C                     MOVELNEP3SX    $XP3SX           Customer TF Exe
     C                     MOVELNEP4SX    $XP4SX           Customer Watch
     C                     MOVELNEP5SX    $XP5SX           Customer Sales
     C                     MOVELNEP6SX    $XP6SX           Customer Market
     C                     MOVELNEUVST    $XUVST           EDI Status 1
     C                     MOVELNEUWST    $XUWST           EDI Status 2
     C                     MOVELNEUXST    $XUXST           EDI Status 3
     C                     MOVELNEVSST    $XVSST           Record Status
     C                     Z-ADDNEAATM    $XAATM           Job Time
     C                     MOVELNEAYNA    $XAYNA           User Id
     C                     MOVELNEA0NA    $XA0NA           Job Name
     C                     Z-ADDNEAXDT    $XAXDT           Job Date
      * USER: Process before print of detail format
     C                     Z-ADDNEBKC7    $XBKC7           Ship To Custome
     C                     MOVELYL0011    $XU5TX           EDI Cust Duns N
      * RTV STNm,Add,A/R,STflgRT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDNEBKC7    WL0061           Ship To Custome
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0062    $XAETX    P      Customer Name
     C                     MOVELWL0063    $XB1NA    P      Address Line 1
     C                     MOVELWL0064    YL0037    P      Address Line 2
     C                     MOVELWL0065    YL0038    P      Address Line 3
     C                     MOVELWL0066    $XB2NA    P      City
     C                     MOVELWL0067    $XBHCD    P      State Code
     C                     MOVELWL0068    $XC8TX    P      Zip Postal Code
     C                     Z-ADDWL0069    YL0039           AR Customer Num
     C                     MOVELWL0070    YL0040    P      Country Code
     C                     MOVELWL0071    YL0041    P      Ship To Custome
     C                     MOVELWL0072    $XVSST    P      Record Status
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         G2EXIT    ENDSR
      /EJECT
     CSR         G3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN NEU5TX    WZG001           EDI Cust Duns N
     C                     MOVELNEU5TX    WZG001
     C           *LIKE     DEFN NEBKC7    WZG002           Ship To Custome
     C                     Z-ADDNEBKC7    WZG002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFG    OREQ '1'
     C           KRSG      READE@NEREIW                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFG  1
      * Quit if no record read
     C           W0EOFG    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.Record Status is Inactive
     C           NEVSST    IFEQ 'I'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV STNm,Add,A/R,STflgRT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDNEBKC7    WL0061           Ship To Custome
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0062    YN0051    P      Customer Name
     C                     MOVELWL0063    YN0052    P      Address Line 1
     C                     MOVELWL0064    YN0053    P      Address Line 2
     C                     MOVELWL0065    YN0054    P      Address Line 3
     C                     MOVELWL0066    YN0055    P      City
     C                     MOVELWL0067    YN0056    P      State Code
     C                     MOVELWL0068    YN0057    P      Zip Postal Code
     C                     Z-ADDWL0069    YL0039           AR Customer Num
     C                     MOVELWL0070    YN0058    P      Country Code
     C                     MOVELWL0071    YN0059    P      Ship To Custome
     C                     MOVELWL0072    YN0060    P      Record Status
      * Check to see if this is a Bill To customer.
      * CASE: DB1.Ship To Customer EQ LCL.A/R Customer Number
     C           NEBKC7    IFEQ YL0039                     *IF
      * R17040 DN 03/23/21-Also Check for Matching Trading Partner.
      * CASE: *OTHERWISE
      * Rtv Trading Partner   RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0039    WL0052           Ship To Custome
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0053    YL0043    P      EDI Trading Par
      * Match by Trading Partner for Bill To Customer.
      * CASE: PAR.EDI Trading Partner No. EQ LCL.EDI Trading Partner No.
     C           YL0021    IFEQ YL0043                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0GL00  1        EDI Cust Duns N
     C                     MOVEL*BLANK    W0GL01  1        Ship To Custome
     C           W0EOFG    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0GL00  1        EDI Cust Duns N
     C                     MOVEL'Y'       W0GL01  1        Ship To Custome
     C                     ELSE
      * Next record - Detect level breaks
     C           NEU5TX    IFNE WZG001                     EDI Cust Duns N
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL00
     C                     END
     C           NEBKC7    IFNE WZG002                     Ship To Custome
     C           W0GL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL01
     C                     END
     C                     END
      *================================================================
     CSR         G3EXIT    ENDSR
      /EJECT
     CSR         G4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0GL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP01
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP00
     C                     END
      *
     C           W0EOFG    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           YL0042    IFEQ 1                          *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$YFINTTL
      * USER: Process after print of final totals format
      * CASE: LCL.Usr Counter Dtl is GT 1
     C           YL0042    IFGT 1                          *IF
     C                     MOVEL'Y'       P4EMPO           Email PO Error
     C                     END                             *FI
     C                     END
      *
      *================================================================
     CSR         G4EXIT    ENDSR
      /EJECT
     CSR         H0MAIN    BEGSR
      *================================================================
      * PRT ST Cust by DUNS   PO: Mainline
      *================================================================
      * PRT ST Cust by DUNS   PO: Initialise
     C                     EXSR ZHINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN NEU5TX    WQKH01           EDI Cust Duns N
      * Define keylist
     C           KRSH      KLIST
     C                     KFLD           WQKH01           EDI Cust Duns N
      * Setup key
     C                     MOVELYL0010    WQKH01           EDI Cust Duns N
      * Establish starting position
     C           KRSH      SETLL@NEREIW                    *
      * Read first record with user selection
     C                     EXSR H3READ
     C           W0EOFH    IFNE '0'                        IF
      * USER: Null report processing
     C                     MOVEL'Y'       WN0005           USR Display 1
      * CLC Set Null 1stPg PO2 US - /UT User Source  * 
     C                     MOVEL'Y'       W0CL1P
     C                     EXSR C1PHDR
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0HL1P  1        First page
     C                     MOVEL'Y'       W0HL00  1        EDI Cust Duns N
     C                     MOVEL'Y'       W0HL01  1        Ship To Custome
      * Set column headings flag
     C                     MOVE 'Y'       W0HCDT
      * Print report body
     C           W0EOFH    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR H1PHDR
      * Print report detail line
     C                     EXSR H2PDTL
      * Read next record with user selection
     C                     EXSR H3READ
      * Print totals
     C                     EXSR H4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         H0EXIT    ENDSR
      /EJECT
     CSR         H1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0HL1P    IFEQ 'Y'
      * Load key header format
     C                     MOVEL*BLANK    $ZU5TX           EDI Cust Duns N
     C                     MOVEL*BLANK    $ZW6TX           Customer Name
      * USER: Process before print of first page format
     C                     MOVELYL0010    $ZU5TX           EDI Cust Duns N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP1P  1
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Load key header format
     C                     MOVELNEU5TX    #AU5TX           EDI Cust Duns N
     C                     Z-ADDNEBKC7    #ABKC7           Ship To Custome
     C                     MOVEL*BLANK    #ABRTX           Ship To Name
     C                     MOVEL*BLANK    #AHMNA           Ship To Address
     C                     MOVEL*BLANK    #AHNNA           Ship To City
     C                     MOVEL*BLANK    #ADBCD           Ship To State C
     C                     MOVEL*BLANK    #ACKTX           Ship To Zip_Pos
     C                     MOVELNEVSST    #AVSST           Record Status
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP00  1
     C                     END
      *
     C           W0HL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP01  1
     C                     END
      *
      *================================================================
     CSR         H1EXIT    ENDSR
      /EJECT
     CSR         H2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDNEBKC7    #BBKC7           Ship To Custome
     C                     MOVEL*BLANK    #BBRTX           Ship To Name
     C                     MOVEL*BLANK    #BHMNA           Ship To Address
     C                     MOVEL*BLANK    #BHNNA           Ship To City
     C                     MOVEL*BLANK    #BDBCD           Ship To State C
     C                     MOVEL*BLANK    #BCKTX           Ship To Zip_Pos
     C                     MOVELNEUFTX    #BUFTX           Internet Passwo
     C                     MOVELNEUGTX    #BUGTX           Email Address
     C                     MOVELNEPFNA    #BPFNA           Email User ID
     C                     MOVELNEJ5NX    #BJ5NX           EDI Trading Par
     C                     MOVELNEU5TX    #BU5TX           EDI Cust Duns N
     C                     MOVELNEU6TX    #BU6TX           EDI Warehouse_S
     C                     MOVELNEW0TX    #BW0TX           State Tax ID
     C                     MOVELNEHSSX    #BHSSX           Cust Shipping T
     C                     MOVELNEHUSX    #BHUSX           One Invoice Per
     C                     MOVELNEHVSX    #BHVSX           EDI Advanced Sh
     C                     Z-ADDNEAAC8    #BAAC8           Customer G_L Ve
     C                     MOVELNEP0SX    #BP0SX           Air Freight Ord
     C                     MOVELNEP1SX    #BP1SX           Regional Mgr Fa
     C                     MOVELNEP2SX    #BP2SX           Employee_Co_Pac
     C                     MOVELNEP3SX    #BP3SX           Customer TF Exe
     C                     MOVELNEP4SX    #BP4SX           Customer Watch
     C                     MOVELNEP5SX    #BP5SX           Customer Sales
     C                     MOVELNEP6SX    #BP6SX           Customer Market
     C                     MOVELNEUVST    #BUVST           EDI Status 1
     C                     MOVELNEUWST    #BUWST           EDI Status 2
     C                     MOVELNEUXST    #BUXST           EDI Status 3
     C                     MOVELNEVSST    #BVSST           Record Status
     C                     Z-ADDNEAATM    #BAATM           Job Time
     C                     MOVELNEAYNA    #BAYNA           User Id
     C                     MOVELNEA0NA    #BA0NA           Job Name
     C                     Z-ADDNEAXDT    #BAXDT           Job Date
      * USER: Process before print of detail format
     C                     Z-ADDNEBKC7    #BBKC7           Ship To Custome
     C                     MOVELYL0010    #BU5TX           EDI Cust Duns N
      * RTV STNm,Add,A/R,STflgRT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDNEBKC7    WL0061           Ship To Custome
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0062    #BBRTX    P      Customer Name
     C                     MOVELWL0063    #BHMNA    P      Address Line 1
     C                     MOVELWL0064    YL0044    P      Address Line 2
     C                     MOVELWL0065    YL0045    P      Address Line 3
     C                     MOVELWL0066    #BHNNA    P      City
     C                     MOVELWL0067    #BDBCD    P      State Code
     C                     MOVELWL0068    #BCKTX    P      Zip Postal Code
     C                     Z-ADDWL0069    YL0046           AR Customer Num
     C                     MOVELWL0070    YL0047    P      Country Code
     C                     MOVELWL0071    YL0048    P      Ship To Custome
     C                     MOVELWL0072    #BVSST    P      Record Status
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         H2EXIT    ENDSR
      /EJECT
     CSR         H3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN NEU5TX    WZH001           EDI Cust Duns N
     C                     MOVELNEU5TX    WZH001
     C           *LIKE     DEFN NEBKC7    WZH002           Ship To Custome
     C                     Z-ADDNEBKC7    WZH002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFH    OREQ '1'
     C           KRSH      READE@NEREIW                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFH  1
      * Quit if no record read
     C           W0EOFH    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * R17040 DN 03/23/21-New Logic: Match Also by Trading Partner.
      * CASE: DB1.Record Status is Inactive
     C           NEVSST    IFEQ 'I'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv ShpTo Info/AR Cst RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDNEBKC7    WL0040           Ship To Custome
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0041    YN0061    P      Customer Name
     C                     MOVELWL0042    YN0062    P      Address Line 1
     C                     MOVELWL0043    YN0063    P      Address Line 2
     C                     MOVELWL0044    YN0064    P      Address Line 3
     C                     MOVELWL0045    YN0065    P      City
     C                     MOVELWL0046    YN0066    P      State Code
     C                     MOVELWL0047    YN0067    P      Zip Postal Code
     C                     MOVELWL0048    YN0068    P      Telephone Numbe
     C                     Z-ADDWL0049    YL0046           AR Customer Num
     C                     MOVELWL0050    YN0069    P      Order Entry Hol
     C                     MOVELWL0051    YL0048    P      Ship To Custome
      * Must Be Use as Ship To Customer.
      * CASE: LCL.Ship To Customer Flag is Allow Use as Ship To Cust
     C           YL0048    IFEQ 'Y'                        *IF
      * Rtv Trading Partner   RT - Customer EXT  * Get TP for Bill To Cus
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0046    WL0052           Ship To Custome
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0053    YL0050    P      EDI Trading Par
      * Match by Trading Partner for Bill To Customer.
      * CASE: PAR.EDI Trading Partner No. EQ LCL.EDI Trading Partner No.
     C           YL0021    IFEQ YL0050                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0HL00  1        EDI Cust Duns N
     C                     MOVEL*BLANK    W0HL01  1        Ship To Custome
     C           W0EOFH    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0HL00  1        EDI Cust Duns N
     C                     MOVEL'Y'       W0HL01  1        Ship To Custome
     C                     ELSE
      * Next record - Detect level breaks
     C           NEU5TX    IFNE WZH001                     EDI Cust Duns N
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL00
     C                     END
     C           NEBKC7    IFNE WZH002                     Ship To Custome
     C           W0HL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL01
     C                     END
     C                     END
      *================================================================
     CSR         H3EXIT    ENDSR
      /EJECT
     CSR         H4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0HL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP01
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP00
     C                     END
      *
     C           W0EOFH    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           YL0049    IFEQ 1                          *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE#CFINTTL
      * USER: Process after print of final totals format
      * CASE: LCL.Usr Counter Dtl is GT 1
     C           YL0049    IFGT 1                          *IF
     C                     MOVEL'Y'       P4EMPO           Email PO Error
     C                     END                             *FI
     C                     END
      *
      *================================================================
     CSR         H4EXIT    ENDSR
      /EJECT
     CSR         I0MAIN    BEGSR
      *================================================================
      * PRT EDI PO Notes      PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A9H9NY    WQKI01           EDI SURROGATE N
      * Define keylist
     C           KRSI      KLIST
     C                     KFLD           WQKI01           EDI SURROGATE N
      * Setup key
     C                     Z-ADDP1TSCN    WQKI01           EDI SURROGATE N
      * Establish starting position
     C           KRSI      SETLL@A9CPQT                    *
      * Read first record with user selection
     C                     EXSR I3READ
     C           W0EOFI    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0IL1P  1        First page
     C                     MOVEL'Y'       W0IL00  1        EDI SURROGATE N
      * Set column headings flag
     C                     MOVE 'Y'       W0ICDT
      * Print report body
     C           W0EOFI    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR I1PHDR
      * Print report detail line
     C                     EXSR I2PDTL
      * Read next record with user selection
     C                     EXSR I3READ
      * Print totals
     C                     EXSR I4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         I0EXIT    ENDSR
      /EJECT
     CSR         I1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0IL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP1P  1
     C                     END
      *
     C           W0IL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA9H9NY    #EH9NY           EDI SURROGATE N
      * Load related totals format
     C                     Z-ADDA9H9NY    #GH9NY           EDI SURROGATE N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP00  1
     C                     END
      *
      *================================================================
     CSR         I1EXIT    ENDSR
      /EJECT
     CSR         I2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA9H9NY    #FH9NY           EDI SURROGATE N
     C                     Z-ADDA9YGNY    #FYGNY           Note Sequence 1
     C                     MOVELA9R1AA    #FR1AA           Ref ID Qualifie
     C                     MOVELA9ANU1    #FANU1           Note
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         I2EXIT    ENDSR
      /EJECT
     CSR         I3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A9H9NY    WZI001           EDI SURROGATE N
     C                     Z-ADDA9H9NY    WZI001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFI    OREQ '1'
     C           KRSI      READE@A9CPQT                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFI  1
      * Quit if no record read
     C           W0EOFI    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0IL00  1        EDI SURROGATE N
     C           W0EOFI    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0IL00  1        EDI SURROGATE N
     C                     ELSE
      * Next record - Detect level breaks
     C           A9H9NY    IFNE WZI001                     EDI SURROGATE N
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL00
     C                     END
     C                     END
      *================================================================
     CSR         I3EXIT    ENDSR
      /EJECT
     CSR         I4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0IL00    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE#GKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP00
     C                     END
      *
     C           W0EOFI    IFEQ '1'
      * Mention hidden format
     C   99N99             WRITE#HFINTTL
     C                     END
      *
      *================================================================
     CSR         I4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Purchase Order    PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Purchase Order    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$B1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Detail line. of Prt Purchase Order    PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CUR.Condition Name USR = Condition name of CUR.G5001-ORDER STATUS
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1638036   Y2LSNO  70       List number
     C                     PARM $CL3SX    W0INVL 25        G5001-ORDER STA
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CGUTX    PARM           W0CNNM 25        Condition Name
      *
      * CUR.Condition Desc. 4  USR = Condition name of CUR.POH PO Purpose
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2100095   Y2LSNO  70       List number
     C                     PARM $COJAA    W0INVL 25        POH PO Purpose
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CHOTX    PARM           W0CNNM 25        Condition Desc.
      *
      * Rtv Address Info      RT - EDI Purchase Order Name  * 
     C                     EXSR SARVGN
     C                     MOVELYL0001    $CDCDE           N104-ID CODE
     C                     MOVEL$CBRTX    P3BRTX           Ship To Name
      * Save the ship to and bill to DUNS from the actual PO sent.
     C                     MOVELYL0001    YL0010           EDI Shipto Duns
     C                     MOVELYL0001    $CXOT1           EDI Shipto Duns
      * Move ship to duns to outbound parm
     C                     MOVELYL0001    P5XOT1           EDI Shipto Duns
     C                     MOVEL$COQT1    YL0011           EDI Billto Duns
      * Shipping Method
      * CASE: CUR.G6601-SHIPMENT METHOD is Not Entered
     C           $CSHMT    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,002   $CHLTX           Condition Desc.
     C                     ELSE
      * CASE: *OTHERWISE
      * CUR.Condition Desc. 1  USR = Condition name of CUR.G6601-SHIPMENT
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1638026   Y2LSNO  70       List number
     C                     PARM $CSHMT    W0INVL 25        G6601-SHIPMENT
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
      * Pallets Exchange Code
      * CASE: CUR.G6603-PALLET EXCHANGE COD is Not Entered
     C           $CPLEX    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,002   $CHMTX           Condition Desc.
     C                     ELSE
      * CASE: *OTHERWISE
      * CUR.Condition Desc. 2  USR = Condition name of CUR.G6603-PALLET E
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1638030   Y2LSNO  70       List number
     C                     PARM $CPLEX    W0INVL 25        G6603-PALLET EX
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CHMTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
      * Unit Load Option
      * CASE: CUR.G6604-UNIT LOAD OPTION CO is Not Entered
     C           $CLDOP    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,002   $CHNTX           Condition Desc.
     C                     ELSE
      * CASE: *OTHERWISE
      * CUR.Condition Desc. 3  USR = Condition name of CUR.G6604-UNIT LOA
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1638032   Y2LSNO  70       List number
     C                     PARM $CLDOP    W0INVL 25        G6604-UNIT LOAD
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CHNTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
      * Get Sales Person email, ST cust nbr
      * 03/22/21 DN R17040-Changed to Check EDI Trading Partner # matches
      *    Passed in the EDI Trading Partner No. as parm.
      * Rtv Sales Rte-1st ShToRT - Customer EXT  * 
     C                     EXSR SKRVGN
      * 03/23/21 DN R17040-Save 'EDI Trading Partner No.' to LCL context.
     C                     MOVEL$CJ5NX    YL0021           EDI Trading Par
      * CASE: CUR.Ship To Address Line 1 is Blank
     C           $CHMNA    IFEQ *BLANK                     *IF
      * RTV Cust Add,Ct-A/R CstRT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAJNB    WL0027           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    $CBRTX    P      Customer Name
     C                     MOVELWL0029    $CHMNA    P      Address Line 1
     C                     MOVELWL0030    $CHONA    P      Address Line 2
     C                     MOVELWL0031    YN0024    P      Address Line 3
     C                     MOVELWL0032    $CHNNA    P      City
     C                     MOVELWL0033    $CDBCD    P      State Code
     C                     MOVELWL0034    $CCKTX    P      Zip Postal Code
     C                     Z-ADDWL0035    YL0022           AR Customer Num
     C                     MOVELWL0036    YN0025    P      Country Code
     C                     END                             *FI
      * CASE: CUR.Bill to Address Line 1 is Blank
     C           $CB1NA    IFEQ *BLANK                     *IF
      * RTV Customer A/R Cust  RT - Customer  * 
     C                     EXSR SNRVGN
      * RTV Cust Name/Addr     RT - Customer  * 
     C                     EXSR SORVGN
     C                     END                             *FI
      * If email not found, put zeros on end of DUNS to get the BT DUNS
      * CASE: LCL.Email Address is Blank
     C           YL0013    IFEQ *BLANK                     *IF
     C                     Z-ADD9         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00020
     C           ZQ        ORGT 00020
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0001:ZQ YL0023    P  90  CMS Duns
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0023    CAT  '0000':ZQ YL0001    P      EDI Cust Duns N
      * Rtv Sales Route       RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0001    WL0001    P      EDI Cust Duns N
     C                     MOVEL$CR4CD    WL0002    P      Sales Route Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $CR4CD    P      Sales Route Cod
     C                     MOVELWL0003    $CMZNA    P      Sales Route Des
     C                     Z-ADDWL0004    YL0024           Ship To Custome
     C                     MOVELWL0005    YN0026    P      Special Instruc
     C                     MOVELWL0006    YN0027    P      Special Instruc
     C                     MOVELWL0007    YL0012    P      Salesperson Nam
     C                     MOVELWL0008    P2UGTX    P      Email Address
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0013    P2UGTX           Email Address
     C                     END                             *FI
      * If BT Duns Blank, use ST cust and go get A/R cust then get BT DUN
      * CASE: LCL.EDI Billto Duns Number EQ WRK.BLANK
     C           YL0011    IFEQ WUGSTX                     *IF
      * CASE: CUR.Customer Number       NBR is not equal 0
     C           $CAJNB    IFNE *ZERO                      *IF
      * RTV Cust A/r,Sls Rte  RT - Customer  * 
     C                     EXSR SPRVGN
      * Rtv Bill To TP & DUNS RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0025    WL0037           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    YN0029    P      EDI Trading Par
     C                     MOVELWL0039    $COQT1    P      EDI Cust Duns N
     C                     MOVEL$COQT1    YL0011           EDI Billto Duns
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     MOVELWUGSTX    YL0011           EDI Billto Duns
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert G5002-ORDER DATE to display format
      * Convert date
     C           1000000   ADD  $COSDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCOSDT
      * Convert G6202-DELIVERY DATE to display format
      * Convert date
     C           1000000   ADD  $CDELV    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCDELV
      * Convert G6202 Ship Date to display format
      * Convert date
     C           1000000   ADD  $CT6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCT6DT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Purchase Order    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print ST02-TRANS SET CONTROL NU of Prt Purchase Order    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Convert fields to external form
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Detail line. of Prt Purchase Order    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL*BLANK    $ENLTX           USR 15 Text
     C                     MOVEL'blank'   $ENLTX           USR 15 Text
      * CUR.Text 1 USR = Condition name of DB1.POC02-Chg/Resp Type cde
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2025203   Y2LSNO  70       List number
     C                     PARM BRLEST    W0INVL 25        POC02-Chg/Resp
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $EG5TX    PARM           W0CNNM 25        Text 1 USR
      *
      * RMC 10/11/18 BELOW COPIED FROM PUD3DFR
     C                     MOVEL*BLANK    YL0033           CIR Resource No
      * G6805 check
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.G6805/P108 PROD ID QUAL is Vendor Product
      *   |- c2    : DB1.G6805/P108 PROD ID QUAL is Vendor Product 2
      *   |- c3    : DB1.G6805/P108 PROD ID QUAL is Manufacturer Part Num
      *   '-
     C           BRPRQL    IFEQ 'VP'                       *IF
     C           BRPRQL    OREQ 'VN'                       *OR
     C           BRPRQL    OREQ 'MG'                       *OR
     C                     MOVEL$EPRID    WUY8TX           Text USR 7
      * RTV Right Just  7 Alph US - /UT User Source  * 
     C                     MOVEAWUY8TX    A1
     C                     MOVEA*BLANKS   A2
     C                     MOVE 07        C1      20
     C                     MOVE 07        C2      20
     C           C1        DOWGT0
     C           A1,C1     IFNE ' '
     C                     MOVE A1,C1     A2,C2
     C           C2        SUB  1         C2
     C                     END
     C           C1        SUB  1         C1
     C                     END
     C                     MOVEAA2        WUZ3TX
     C                     MOVE WUZ3TX    YL0034           USR Item Code 7
     C                     Z-ADDYL0034    YL0030           Item Code Numbe
      * Rtv CIR Resource      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAJNB    WL0054           Ship To Custome
     C                     Z-ADDYL0030    WL0055           Item Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0056    YL0033    P      CIR Resource No
     C                     MOVEL*BLANK    $ENLTX           USR 15 Text
     C                     MOVELYL0033    $ENLTX           USR 15 Text
     C                     END                             *FI
      * G6807 check
      * CASE: LCL.CIR Resource No is Not Entered
     C           YL0033    IFEQ *BLANK                     *IF
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : DB1.G6807/PO110 Prod ID Qual is Vendor Product 1
      *   |- c2    : DB1.G6807/PO110 Prod ID Qual is Vendor Product 2
      *   |- c3    : DB1.G6807/PO110 Prod ID Qual is Manufacturer Part Nu
      *   '-
     C           BRR2AA    IFEQ 'VP'                       *IF
     C           BRR2AA    OREQ 'VN'                       *OR
     C           BRR2AA    OREQ 'MG'                       *OR
     C                     MOVELBRAOU1    WUY8TX           Text USR 7
      * RTV Right Just  7 Alph US - /UT User Source  * 
     C                     MOVEAWUY8TX    A1
     C                     MOVEA*BLANKS   A2
     C                     MOVE 07        C1      20
     C                     MOVE 07        C2      20
     C           C1        DOWGT0
     C           A1,C1     IFNE ' '
     C                     MOVE A1,C1     A2,C2
     C           C2        SUB  1         C2
     C                     END
     C           C1        SUB  1         C1
     C                     END
     C                     MOVEAA2        WUZ3TX
     C                     MOVE WUZ3TX    YL0034           USR Item Code 7
     C                     Z-ADDYL0034    YL0030           Item Code Numbe
      * Rtv CIR Resource      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAJNB    WL0054           Ship To Custome
     C                     Z-ADDYL0030    WL0055           Item Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0056    YL0033    P      CIR Resource No
     C                     MOVEL*BLANK    $ENLTX           USR 15 Text
     C                     MOVELYL0033    $ENLTX           USR 15 Text
     C                     END                             *FI
     C                     END                             *FI
      * GTIN = UK check
      * CASE: LCL.CIR Resource No is Not Entered
     C           YL0033    IFEQ *BLANK                     *IF
      * CASE: DB1.P106 UPC/GTIN QUAL is GTIN/UPC Code
     C           BRR3AA    IFEQ 'UK'                       *IF
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAJNB    WL0057           Ship To Custome
     C                     MOVELBRUPCX    WL0059    P      CIR Resource No
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0058    YL0035           Item Code
     C                     MOVELWL0060    YN0050    P      CIR UM Base Pri
      * CASE: LCL.Item Code is Entered
     C           YL0035    IFNE *ZERO                      *IF
     C                     MOVELBRUPCX    $ENLTX           USR 15 Text
     C                     MOVELBRUPCX    YL0033           CIR Resource No
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Catchall
      * CASE: LCL.CIR Resource No is Not Entered
     C           YL0033    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     YL0035           Item Code
      * CASE: DB1.G6806/P109 PRODUCT ID is Not Blank
     C           BRPRID    IFNE *BLANK                     *IF
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAJNB    WL0057           Ship To Custome
     C                     MOVELBRPRID    WL0059    P      CIR Resource No
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0058    YL0035           Item Code
     C                     MOVELWL0060    YN0050    P      CIR UM Base Pri
     C                     MOVEL*BLANK    $ENLTX           USR 15 Text
     C                     MOVELBRPRID    $ENLTX           USR 15 Text
     C                     END                             *FI
      * CASE: LCL.Item Code is Not Entered
     C           YL0035    IFEQ *ZERO                      *IF
      * CASE: DB1.G6808/PO111 Prod ID is Entered
     C           BRAOU1    IFNE *BLANK                     *IF
     C                     MOVELBRAOU1    $ENLTX           USR 15 Text
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $ENLTX           USR 15 Text
     C                     MOVELBRPRID    $ENLTX           USR 15 Text
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           $EDTSX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Purchase Order    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Ship To Customer of Prt Purchase Order    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print CIR Resource No of Prt Purchase Order    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Detail line. of Prt Purchase Order    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $FHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$FHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VFHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VFHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of PRT EDI PO SAC/G72    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$G1STPAG
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print EDI SURROGATE NUMBER of PRT EDI PO SAC/G72    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$HKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print ITEM SEQUENCE NUMBER of PRT EDI PO SAC/G72    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Print format
     C                     WRITE$IKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print Detail line. of PRT EDI PO SAC/G72    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$JCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$JDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of PRT EDI PO Notes DTL  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print ST02-TRANS SET CONTROL NU of PRT EDI PO Notes DTL  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print ITEM SEQUENCE NUMBER of PRT EDI PO Notes DTL  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP01
     C                     END                             FI
      * Print Detail line. of PRT EDI PO Notes DTL  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$NCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$NDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Print First Page Format of PRT PO SAC/G72 Al/Chg PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP1P    ANDEQ'P'
      * Print format
     C                     WRITE$P1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0FL1P
     C                     END                             FI
      * Print EDI SURROGATE NUMBER of PRT PO SAC/G72 Al/Chg PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$QKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0FP00
     C                     END                             FI
      * Print Detail line. of PRT PO SAC/G72 Al/Chg PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0FCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FPDT    ANDEQ'P'
      * Print column headings if required
     C           W0FCDT    IFEQ 'Y'
     C                     WRITE$RCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0FCDT
     C                     END                             FI
      * Print format
     C                     WRITE$RDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FPDT
     C                     END                             FI
      * Print First Page Format of PRT BT Cust by DUNS   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP1P    ANDEQ'P'
     C                     MOVEL'0'       *IN79
     C           WN0004    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$V1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0GL1P
     C                     END                             FI
      * Print EDI Cust Duns Number of PRT BT Cust by DUNS   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP00    ANDEQ'P'
      * Convert fields to external form
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $WB0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$WB0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VWB0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VWB0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$WKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0GCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GP00
     C                     END                             FI
      * Print Ship To Customer of PRT BT Cust by DUNS   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP01
     C                     END                             FI
      * Print Detail line. of PRT BT Cust by DUNS   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0GCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     ADD  1         YL0042           Usr Counter Dtl
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $XBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$XBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VXBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VXBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0GCDT    IFEQ 'Y'
     C                     WRITE$XCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0GCDT
     C                     END                             FI
      * Print format
     C                     WRITE$XDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GPDT
     C                     END                             FI
      * Print First Page Format of PRT ST Cust by DUNS   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP1P    ANDEQ'P'
     C                     MOVEL'0'       *IN79
     C           WN0005    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$Z1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0HP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0HL1P
     C                     END                             FI
      * Print EDI Cust Duns Number of PRT ST Cust by DUNS   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP00    ANDEQ'P'
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #ABKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#ABKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VABKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VABKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE#AKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0HCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0HP00
     C                     END                             FI
      * Print Ship To Customer of PRT ST Cust by DUNS   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP01
     C                     END                             FI
      * Print Detail line. of PRT ST Cust by DUNS   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0HCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     ADD  1         YL0049           Usr Counter Dtl
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #BBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#BBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0HCDT    IFEQ 'Y'
     C                     WRITE#BCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0HCDT
     C                     END                             FI
      * Print format
     C                     WRITE#BDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0HPDT
     C                     END                             FI
      * Print First Page Format of PRT EDI PO Notes      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP1P    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE#D1STPAG
      * Reset format print flag
     C                     MOVE *BLANK    W0IP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0IL1P
     C                     END                             FI
      * Print EDI SURROGATE NUMBER of PRT EDI PO Notes      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP00    ANDEQ'P'
      * Print format
     C                     WRITE#EKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ICDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0IP00
     C                     END                             FI
      * Print Detail line. of PRT EDI PO Notes      PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ICDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IPDT    ANDEQ'P'
      * Print column headings if required
     C           W0ICDT    IFEQ 'Y'
     C                     WRITE#FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ICDT
     C                     END                             FI
      * Print format
     C                     WRITE#FDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0IPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Purchase Order    PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Purchase Order    PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD11        W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Purchase Order    PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ST02-TRANS SET CONTROL NU of Prt Purchase Order    PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  7         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Purchase Order    PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD3         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Purchase Order    PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of Prt Purchase Order    PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * CIR Resource No of Prt Purchase Order    PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Purchase Order    PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT EDI PO SAC/G72    PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * EDI SURROGATE NUMBER of PRT EDI PO SAC/G72    PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ITEM SEQUENCE NUMBER of PRT EDI PO SAC/G72    PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT EDI PO SAC/G72    PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD1         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT EDI PO Notes DTL  PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ST02-TRANS SET CONTROL NU of PRT EDI PO Notes DTL  PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ITEM SEQUENCE NUMBER of PRT EDI PO Notes DTL  PO
     C           W0EP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT EDI PO Notes DTL  PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT PO SAC/G72 Al/Chg PO
     C           W0FP1P    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * EDI SURROGATE NUMBER of PRT PO SAC/G72 Al/Chg PO
     C           W0FP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT PO SAC/G72 Al/Chg PO
     C           W0FPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0FCDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT BT Cust by DUNS   PO
     C           W0GP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * EDI Cust Duns Number of PRT BT Cust by DUNS   PO
     C           W0GP00    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of PRT BT Cust by DUNS   PO
     C           W0GP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT BT Cust by DUNS   PO
     C           W0GPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0GCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT ST Cust by DUNS   PO
     C           W0HP1P    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * EDI Cust Duns Number of PRT ST Cust by DUNS   PO
     C           W0HP00    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of PRT ST Cust by DUNS   PO
     C           W0HP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT ST Cust by DUNS   PO
     C           W0HPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0HCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT EDI PO Notes      PO
     C           W0IP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * EDI SURROGATE NUMBER of PRT EDI PO Notes      PO
     C           W0IP00    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT EDI PO Notes      PO
     C           W0IPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ICDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Address Info      RT - EDI Purchase Order Name  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    $CBRTX           Ship To Name
     C                     MOVEL*BLANK    $CAETX           Bill to Name
     C                     MOVEL*BLANK    $CBATX           Vendor Name
     C                     MOVEL*BLANK    $CHMNA           Ship To Address
     C                     MOVEL*BLANK    $CB1NA           Bill to Address
     C                     MOVEL*BLANK    $CPJNA           Remittance Addr
     C                     MOVEL*BLANK    $CHONA           Ship To Address
     C                     MOVEL*BLANK    $CB3NA           Bill to Address
     C                     MOVEL*BLANK    $CPKNA           Remittance Addr
     C                     MOVEL*BLANK    $CB2NA           Bill to City
     C                     MOVEL*BLANK    $CBHCD           Bill to State C
     C                     MOVEL*BLANK    $CC8TX           Bill to Zip_Pos
     C                     MOVEL*BLANK    $CHNNA           Ship To City
     C                     MOVEL*BLANK    $CDBCD           Ship To State C
     C                     MOVEL*BLANK    $CCKTX           Ship To Zip_Pos
     C                     MOVEL*BLANK    $CPMNA           Remittance City
     C                     MOVEL*BLANK    $CYNTX           Remittance Stat
     C                     MOVEL*BLANK    $CYOTX           Remittance Zip
     C                     MOVEL*BLANK    YL0001           EDI Cust Duns N
     C                     MOVEL*BLANK    $COQT1           EDI Billto Duns
      * Declare restrictor key work fields
     C           *LIKE     DEFN BSTSCN    WQSA01           ST02-TRANS SET
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           ST02-TRANS SET
      * Setup key
     C                     Z-ADD$CTSCN    WQSA01           ST02-TRANS SET
      * Establish starting position
     C           KRSSA     SETLL@P006LC                    *
     C           KRSSA     READE@P006LC                  90*
      * Data record not found
     C   90                MOVEL'USR3107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 3/6/08 SAZ added this code for the BS  Bill to ship to
      * CASE: DB1.N101-NAME TYPE CODE is Bill To/Ship To
     C           BSTYPC    IFEQ 'BS'                       *IF
     C                     MOVELBSAMEX    $CAETX           Bill to Name
     C                     MOVELBSDD1X    $CB1NA           Bill to Address
     C                     MOVELBSDD2X    $CB3NA           Bill to Address
     C                     MOVELBSITYX    $CB2NA           Bill to City
     C                     MOVELBSTATE    $CBHCD           Bill to State C
     C                     MOVELBSIPXX    $CC8TX           Bill to Zip_Pos
     C                     MOVELBSDCDE    $COQT1           EDI Billto Duns
     C                     MOVELBSAMEX    $CBRTX           Ship To Name
     C                     MOVELBSDD1X    $CHMNA           Ship To Address
     C                     MOVELBSDD2X    $CHONA           Ship To Address
     C                     MOVELBSITYX    $CHNNA           Ship To City
     C                     MOVELBSTATE    $CDBCD           Ship To State C
     C                     MOVELBSIPXX    $CCKTX           Ship To Zip_Pos
     C                     MOVELBSDCDE    YL0001           EDI Cust Duns N
     C                     ELSE
      * CASE: DB1.N101-NAME TYPE CODE is Bill To
     C           BSTYPC    IFEQ 'BT'                       *IF
     C                     MOVELBSAMEX    $CAETX           Bill to Name
     C                     MOVELBSDD1X    $CB1NA           Bill to Address
     C                     MOVELBSDD2X    $CB3NA           Bill to Address
     C                     MOVELBSITYX    $CB2NA           Bill to City
     C                     MOVELBSTATE    $CBHCD           Bill to State C
     C                     MOVELBSIPXX    $CC8TX           Bill to Zip_Pos
      * If Identifier = ZZ, some customers send a Foodservice ID instead
      * of a DUNS.  So Blank the BT DUNS and retrieve it later.
      * CASE: DB1.N103-ID CODE QUALIFIER is ZZ
     C           BSDCDQ    IFEQ 'ZZ'                       *IF
     C                     MOVEL*BLANK    $COQT1           EDI Billto Duns
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELBSDCDE    $COQT1           EDI Billto Duns
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0001           EDI Cust Duns N
     C                     ELSE
      * CASE: DB1.N101-NAME TYPE CODE is Ship To
     C           BSTYPC    IFEQ 'ST'                       *IF
     C                     MOVELBSAMEX    $CBRTX           Ship To Name
     C                     MOVELBSDD1X    $CHMNA           Ship To Address
     C                     MOVELBSDD2X    $CHONA           Ship To Address
     C                     MOVELBSITYX    $CHNNA           Ship To City
     C                     MOVELBSTATE    $CDBCD           Ship To State C
     C                     MOVELBSIPXX    $CCKTX           Ship To Zip_Pos
     C                     MOVELBSDCDE    YL0001           EDI Cust Duns N
     C                     ELSE
      * CASE: DB1.N101-NAME TYPE CODE is WalMart Buyer
     C           BSTYPC    IFEQ 'BY'                       *IF
     C                     MOVELBSAMEX    $CBRTX           Ship To Name
     C                     MOVELBSDD1X    $CHMNA           Ship To Address
     C                     MOVELBSDD2X    $CHONA           Ship To Address
     C                     MOVELBSITYX    $CHNNA           Ship To City
     C                     MOVELBSTATE    $CDBCD           Ship To State C
     C                     MOVELBSIPXX    $CCKTX           Ship To Zip_Pos
     C                     MOVELBSDCDE    YL0001           EDI Cust Duns N
     C                     MOVELBSDCDE    YL0002           EDI Cust Duns N
      * Rtv Sales Route       RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0002    WL0001    P      EDI Cust Duns N
     C                     MOVELYL0003    WL0002    P      Sales Route Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0003    P      Sales Route Cod
     C                     MOVELWL0003    YN0001    P      Sales Route Des
     C                     Z-ADDWL0004    YL0004           Ship To Custome
     C                     MOVELWL0005    YN0002    P      Special Instruc
     C                     MOVELWL0006    YN0003    P      Special Instruc
     C                     MOVELWL0007    YN0004    P      Salesperson Nam
     C                     MOVELWL0008    YN0005    P      Email Address
      * Wal-Mart Buyer = Y, they do not have a BT record.
      * CASE: LCL.Ship To Customer is not equal to zero
     C           YL0004    IFNE 0                          *IF
      * RTV Cust Add,Ct-A/R CstRT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0027           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    YN0006    P      Customer Name
     C                     MOVELWL0029    YN0007    P      Address Line 1
     C                     MOVELWL0030    YN0008    P      Address Line 2
     C                     MOVELWL0031    YN0009    P      Address Line 3
     C                     MOVELWL0032    YN0010    P      City
     C                     MOVELWL0033    YN0011    P      State Code
     C                     MOVELWL0034    YN0012    P      Zip Postal Code
     C                     Z-ADDWL0035    YL0009           AR Customer Num
     C                     MOVELWL0036    YN0013    P      Country Code
      * Rtv Bill To TP & DUNS RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0009    WL0037           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    YN0014    P      EDI Trading Par
     C                     MOVELWL0039    $COQT1    P      EDI Cust Duns N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $COQT1           EDI Billto Duns
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.N101-NAME TYPE CODE is Vendor
     C           BSTYPC    IFEQ 'VN'                       *IF
     C                     MOVELBSAMEX    $CBATX           Vendor Name
     C                     MOVELBSDD1X    $CPJNA           Remittance Addr
     C                     MOVELBSDD2X    $CPKNA           Remittance Addr
     C                     MOVELBSITYX    $CPMNA           Remittance City
     C                     MOVELBSTATE    $CYNTX           Remittance Stat
     C                     MOVELBSIPXX    $CYOTX           Remittance Zip
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@P006LC                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Ship To Name is blanks
     C           $CBRTX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CBRTX           Ship To Name
     C                     MOVEL@CN,002   $CBRTX           Ship To Name
     C                     ELSE
      * CASE: PAR.Bill to Name is blanks
     C           $CAETX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CAETX           Bill to Name
     C                     MOVEL@CN,002   $CAETX           Bill to Name
     C                     ELSE
      * CASE: PAR.Vendor Name is blanks
     C           $CBATX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CBATX           Vendor Name
     C                     MOVEL@CN,002   $CBATX           Vendor Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Sales Route       RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN NEU5TX    WQSB01           EDI Cust Duns N
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           EDI Cust Duns N
      * Setup key
     C                     MOVELWL0001    WQSB01           EDI Cust Duns N
      * Establish starting position
     C           KRSSB     SETLL@NEREIW                    *
     C           KRSSB     READE@NEREIW                  90*
      * Data record not found
     C   90                MOVEL'USR2880' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDNEBKC7    WL0004           Ship To Custome
      * Rtv EDI Customer Info RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDNEBKC7    WL0009           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WL0002    P      Sales Route Cod
     C                     MOVELWL0011    WL0005    P      Special Instruc
     C                     MOVELWL0012    WL0006    P      Special Instruc
      * RTV SR Desc,person     RT - Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0002    WL0013    P      Sales Route Cod
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WL0003    P      Sales Route Des
     C                     MOVELWL0015    YL0005    P      Salesperson Cod
      * Rtv Email/EDI Sts 3    RT - Salesperson Electronic CM  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0016    P      Salesperson Cod
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    WL0008    P      Email Address
     C                     MOVELWL0018    YL0006    P      EDI Status 3
      * CASE: LCL.EDI Status 3 is Blank
     C           YL0006    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0001 10        User Code Model
      *
      * RTV default Company    IF
      * Rtv Profile Model     RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0019    P      User Profile Na
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    WN0001    P      User Code Model
      * CASE: PAR.User Code Model is equal to blank
     C           WN0001    IFEQ *BLANK                     *IF
      * RTV Appl. Default Co   RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0021    P      User Profile Na
     C                     MOVEL'P/S'     WL0022    P      Application Cod
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0007           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Default Co   RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0021    P      User Profile Na
     C                     MOVEL'P/S'     WL0022    P      Application Cod
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0007           Company Number
     C                     END                             *FI
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0007    WL0024           Company Number
     C                     MOVEL@CN,001   WL0025    P      Company Value C
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    YL0008    P      System Value Al
     C                     MOVEL*BLANK    WL0008           Email Address
     C                     MOVELYL0008    WL0008           Email Address
     C                     END                             *FI
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@NEREIW                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv EDI Customer Info RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           Sales Route Cod
     C                     MOVEL*BLANK    WL0011           Special Instruc
     C                     MOVEL*BLANK    WL0012           Special Instruc
      * Declare restrictor key work fields
     C           *LIKE     DEFN EOBKC7    WQSC01           Ship To Custome
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Ship To Custome
      * Setup key
     C                     Z-ADDWL0009    WQSC01           Ship To Custome
      * Establish starting position
     C           KRSSC     SETLL@EOREU0                    *
     C           KRSSC     READE@EOREU0                  90*
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOR4CD    WL0010           Sales Route Cod
     C                     MOVELEOBYNA    WL0011           Special Instruc
     C                     MOVELEOB6NA    WL0012           Special Instruc
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@EOREU0                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV SR Desc,person     RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELWL0013    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSD     CHAIN@JEREWF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0014           Sales Route Des
     C                     MOVEL*BLANK    WL0015           Salesperson Cod
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEMZNA    WL0014           Sales Route Des
     C                     MOVELJEBCCD    WL0015           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Email/EDI Sts 3    RT - Salesperson Electronic CM  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           NFBCCD           Salesperson Cod
      * Setup key
     C                     MOVELWL0016    NFBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSE     CHAIN@NFREAW              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2882' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0017           Email Address
     C                     MOVEL*BLANK    WL0018           EDI Status 3
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNFUGTX    WL0017           Email Address
     C                     MOVELNFUXST    WL0018           EDI Status 3
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0019    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSF     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0020           User Code Model
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRBUVN    WL0020           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Appl. Default Co   RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0021    DTAJVN           User Profile Na
     C                     MOVELWL0022    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSG     CHAIN@DTRETE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0767' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0023           Company Number
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0023           Company Number
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0024    KMAIC3           Company Number
     C                     MOVELWL0025    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSH     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    WL0026           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Cust Add,Ct-A/R CstRT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0027    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    WL0028           Customer Name
     C                     MOVELBBACNA    WL0029           Address Line 1
     C                     MOVELBBADNA    WL0030           Address Line 2
     C                     MOVELBBAENA    WL0031           Address Line 3
     C                     MOVELBBAJNA    WL0032           City
     C                     MOVELBBBGCD    WL0033           State Code
     C                     MOVELBBBTTX    WL0034           Zip Postal Code
     C                     Z-ADDBBANC7    WL0035           AR Customer Num
     C                     MOVELBBKXCD    WL0036           Country Code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Bill To TP & DUNS RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0037    WABKC7           Ship To Custome
      * Establish starting position
     C           KRSSJ     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0038           EDI Trading Par
     C                     MOVEL*BLANK    WL0039           EDI Cust Duns N
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAJ5NX    WL0038           EDI Trading Par
     C                     MOVELWAU5TX    WL0039           EDI Cust Duns N
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Sales Rte-1st ShToRT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN NEU5TX    WQSK01           EDI Cust Duns N
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           EDI Cust Duns N
      * Setup key
     C                     MOVELYL0001    WQSK01           EDI Cust Duns N
      * Establish starting position
     C           KRSSK     SETLL@NEREIW                    *
     C           KRSSK     READE@NEREIW                  90*
      * Data record not found
     C   90                MOVEL'USR2880' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * get 1st ship to cust for the duns               RMC 10/23/18
      * 03/22/21 DN R17040-Old Logic. Commented Out & Moved/Changed Below
      * ***NOTE: Any changes made here, should consider changes to
      *          'Rtv EDI ST by EDI Duns RT - Customer EXT',
      *          'PRT ST Cust by DUNS   PO - Customer EXT' &
      *          'PRT BT Cust by DUNS   PO - Customer EXT' functions as
      *          well. BOTH functions share the same Business Logic to ge
      *          the correct EDI Ship To Customer #. ***
      * 03/22/21 DN R17040-New Logic: Get 1st Active STC# by DUNS#/Trade
      * CASE: DB1.Record Status is Active
     C           NEVSST    IFEQ 'A'                        *IF
      * Rtv ShpTo Info/AR Cst RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDNEBKC7    WL0040           Ship To Custome
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0041    YN0015    P      Customer Name
     C                     MOVELWL0042    YN0016    P      Address Line 1
     C                     MOVELWL0043    YN0017    P      Address Line 2
     C                     MOVELWL0044    YN0018    P      Address Line 3
     C                     MOVELWL0045    YN0019    P      City
     C                     MOVELWL0046    YN0020    P      State Code
     C                     MOVELWL0047    YN0021    P      Zip Postal Code
     C                     MOVELWL0048    YN0022    P      Telephone Numbe
     C                     Z-ADDWL0049    YL0014           AR Customer Num
     C                     MOVELWL0050    YN0023    P      Order Entry Hol
     C                     MOVELWL0051    YL0015    P      Ship To Custome
      * Must Be Use as Ship To Customer.
      * CASE: LCL.Ship To Customer Flag is Allow Use as Ship To Cust
     C           YL0015    IFEQ 'Y'                        *IF
      * Rtv Trading Partner   RT - Customer EXT  * Get TP for Bill To Cus
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0014    WL0052           Ship To Custome
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0053    YL0016    P      EDI Trading Par
      * Match by Trading Partner for Bill To Customer.
      * CASE: PAR.EDI Trading Partner No. EQ LCL.EDI Trading Partner No.
     C           $CJ5NX    IFEQ YL0016                     *IF
     C                     Z-ADDNEBKC7    $CAJNB           Ship To Custome
      * Rtv EDI Customer Info RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDNEBKC7    WL0009           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    $CR4CD    P      Sales Route Cod
     C                     MOVELWL0011    $UBYNA    P      Special Instruc
     C                     MOVELWL0012    $UB6NA    P      Special Instruc
      * RTV SR Desc,person     RT - Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CR4CD    WL0013    P      Sales Route Cod
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    $CMZNA    P      Sales Route Des
     C                     MOVELWL0015    YL0017    P      Salesperson Cod
      * Rtv Email/EDI Sts 3    RT - Salesperson Electronic CM  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0017    WL0016    P      Salesperson Cod
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YL0013    P      Email Address
     C                     MOVELWL0018    YL0018    P      EDI Status 3
      * CASE: LCL.EDI Status 3 is Blank
     C           YL0018    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * RTV default Company    IF
      * Rtv Profile Model     RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0019    P      User Profile Na
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    WN0002    P      User Code Model
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Default Co   RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0021    P      User Profile Na
     C                     MOVEL'P/S'     WL0022    P      Application Cod
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0019           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Default Co   RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0021    P      User Profile Na
     C                     MOVEL'P/S'     WL0022    P      Application Cod
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0019           Company Number
     C                     END                             *FI
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0019    WL0024           Company Number
     C                     MOVEL@CN,001   WL0025    P      Company Value C
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    YL0020    P      System Value Al
     C                     MOVEL*BLANK    YL0013           Email Address
     C                     MOVELYL0020    YL0013           Email Address
     C                     END                             *FI
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSK     READE@NEREIW                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv ShpTo Info/AR Cst RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0040    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSL     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    WL0041           Customer Name
     C                     MOVELBBACNA    WL0042           Address Line 1
     C                     MOVELBBADNA    WL0043           Address Line 2
     C                     MOVELBBAENA    WL0044           Address Line 3
     C                     MOVELBBAJNA    WL0045           City
     C                     MOVELBBBGCD    WL0046           State Code
     C                     MOVELBBBTTX    WL0047           Zip Postal Code
     C                     MOVELBBBVTX    WL0048           Telephone Numbe
     C                     Z-ADDBBANC7    WL0049           AR Customer Num
     C                     MOVELBBQNST    WL0050           Order Entry Hol
     C                     MOVELBBRJST    WL0051           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Trading Partner   RT - Customer EXT  * Get TP for Bill To Cu
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0053           EDI Trading Par
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0052    WABKC7           Ship To Custome
      * Establish starting position
     C           KRSSM     CHAIN@NEREAT              90    *
      * Data record not found
     C   90                MOVEL'USR2880' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAJ5NX    WL0053           EDI Trading Par
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Customer A/R Cust  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$CAJNB    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSN     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBBANC7    YL0022           AR Customer Num
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Cust Name/Addr     RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDYL0022    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSO     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    $CAETX           Customer Name
     C                     MOVELBBACNA    $CB1NA           Address Line 1
     C                     MOVELBBADNA    $CB3NA           Address Line 2
     C                     MOVELBBAJNA    $CB2NA           City
     C                     MOVELBBBGCD    $CBHCD           State Code
     C                     MOVELBBBTTX    $CC8TX           Zip Postal Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Cust A/r,Sls Rte  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$CAJNB    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSP     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBBANC7    YL0025           AR Customer Num
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV GTIN Req Sts      RT - EDI Bill To Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN GQJ5NX    WQSQ01           EDI Trading Par
     C           *LIKE     DEFN GQM4AA    WQSQ02           Interchange Cod
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           EDI Trading Par
     C                     KFLD           WQSQ02           Interchange Cod
      * Setup key
     C                     MOVEL$CJ5NX    WQSQ01           EDI Trading Par
     C                     MOVE *BLANK    WQSQ02           Interchange Cod
     C                     MOVEL'PO'      WQSQ02           Interchange Cod
      * Establish starting position
     C           KRSSQ     SETLL@GQRETZ                    *
     C           KRSSQ     READE@GQRETZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4373' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0026           EDI BTI GTIN Re
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELGQBHU1    YL0026           EDI BTI GTIN Re
     C                     GOTO SQEXIT                     *QUIT
     C           KRSSQ     READE@GQRETZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Ship To Name      RT - EDI Purchase Order Name  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           BSTSCN           ST02-TRANS SET
     C                     KFLD           BSTYPC           N101-NAME TYPE
      * Setup key
     C                     Z-ADDBRTSCN    BSTSCN           ST02-TRANS SET
     C                     MOVE *BLANK    BSTYPC           N101-NAME TYPE
     C                     MOVEL'ST'      BSTYPC           N101-NAME TYPE
      * Establish starting position
     C           KRSSR     CHAIN@P006LC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0027           N102-NAME
     C                     MOVEL*BLANK    YL0028           N104-ID CODE
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBSAMEX    YL0027           N102-NAME
     C                     MOVELBSDCDE    YL0028           N104-ID CODE
     C                     GOTO SREXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Item Defaults      RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0031           Conversion Fact
     C                     MOVEL*BLANK    YL0032           UOM Pricing Dft
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADDYL0030    BYHGCD           Item Code
      * Establish starting position
     C           KRSSS     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBYAWPC    YL0031           Conversion Fact
     C                     MOVELBYLICD    YL0032           UOM Pricing Dft
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv GTIN              RT - Item Default Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           BTHGCD           Item Code
      * Setup key
     C                     Z-ADDYL0030    BTHGCD           Item Code
      * Establish starting position
     C           KRSST     CHAIN@BTRETK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4745' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $ECUU1           IDE GTIN
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBTCUU1    $ECUU1           IDE GTIN
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv CIR Resource      RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           BIBKC7           Ship To Custome
     C                     KFLD           BIHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0054    BIBKC7           Ship To Custome
     C                     Z-ADDWL0055    BIHGCD           Item Code
      * Establish starting position
     C           KRSSU     CHAIN@BIREKY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0056           CIR Resource No
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBICOAA    WL0056           CIR Resource No
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQSV01           Ship To Custome
     C           *LIKE     DEFN WBCOAA    WQSV02           CIR Resource No
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Ship To Custome
     C                     KFLD           WQSV02           CIR Resource No
      * Setup key
     C                     Z-ADDWL0057    WQSV01           Ship To Custome
     C                     MOVELWL0059    WQSV02           CIR Resource No
      * Establish starting position
     C           KRSSV     SETLL@BIRECZ                    *
     C           KRSSV     READE@BIRECZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0058           Item Code
     C                     MOVEL*BLANK    WL0060           CIR UM Base Pri
     C                     GOTO SVEXIT                     *QUIT
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBHGCD    WL0058           Item Code
     C                     MOVELWBLESX    WL0060           CIR UM Base Pri
     C                     GOTO SVEXIT                     *QUIT
     C           KRSSV     READE@BIRECZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADDWBHGCD    BYHGCD           Item Code
      * Establish starting position
     C           KRSSW     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $FPSNA           Description Lin
     C                     MOVEL*BLANK    $FPTNA           Description Lin
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYAVNA    $FPSNA           Description Lin
     C                     MOVELBYAWNA    $FPTNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV STNm,Add,A/R,STflgRT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0061    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSX     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    WL0062           Customer Name
     C                     MOVELBBACNA    WL0063           Address Line 1
     C                     MOVELBBADNA    WL0064           Address Line 2
     C                     MOVELBBAENA    WL0065           Address Line 3
     C                     MOVELBBAJNA    WL0066           City
     C                     MOVELBBBGCD    WL0067           State Code
     C                     MOVELBBBTTX    WL0068           Zip Postal Code
     C                     Z-ADDBBANC7    WL0069           AR Customer Num
     C                     MOVELBBKXCD    WL0070           Country Code
     C                     MOVELBBRJST    WL0071           Ship To Custome
     C                     MOVELBBVSST    WL0072           Record Status
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Purchase Order    PO
      *================================================================
      * Prt Purchase Order    PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      * 10/11/18 RMC S13893 - Change logic that goes to the Cust Item Ref
      *  to match the edi draft order screen PUD3DFR
      * 8-12-14 SAZ added code to move G6808/PO111 Prod ID or
      * G6806/P109 PRODUCT ID to a text field.  If one is blank use the o
      * 8-14-14 SAZ added code rtv the UOM base Prc and populate CIR
      * 8-16-14 SAZ added rtv to get the GTIN sts flag
      * E004114 saz 061715 TYSON added note dtls print and note dtls file
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Resource nbr      PO
      *================================================================
      * Retrieve the Item code description
      * Prt Purchase Order    PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT EDI PO SAC/G72    PO
      *================================================================
      * PRT EDI PO SAC/G72    PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT EDI PO Notes DTL  PO
      *================================================================
      * PRT EDI PO Notes DTL  PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT PO SAC/G72 Al/Chg PO
      *================================================================
      *
     C                     MOVEL*BLANK    WN0003  1        USR Display 1
      *
      * PRT PO SAC/G72 Al/Chg PO: Mainline
     C                     EXSR F0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT BT Cust by DUNS   PO
      *================================================================
      * CASE: LCL.EDI Billto Duns Number EQ WRK.BLANK
     C           YL0011    IFEQ WUGSTX                     *IF
     C                     MOVEL@CN,006   YL0011           EDI Billto Duns
     C                     END                             *FI
      * 3/23/21 DN R17040-Passed in EDI Trading Partner No.
      *
     C                     MOVEL*BLANK    WN0004  1        USR Display 1
      *
      * PRT BT Cust by DUNS   PO: Mainline
     C                     EXSR G0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT ST Cust by DUNS   PO
      *================================================================
      * CASE: LCL.EDI Shipto Duns Number is Not Found
     C           YL0010    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,006   YL0010           EDI Shipto Duns
     C                     END                             *FI
      * 3/23/21 DN R17040-Passed in EDI Trading Partner No.
      *
     C                     MOVEL*BLANK    WN0005  1        USR Display 1
      *
      * PRT ST Cust by DUNS   PO: Mainline
     C                     EXSR H0MAIN
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT EDI PO Notes      PO
      *================================================================
      * PRT EDI PO Notes      PO: Mainline
     C                     EXSR I0MAIN
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * Prt Purchase Order    PO: Initialise
      *================================================================
      * USER: Initialize program
      * Modification history
     C                     EXSR UBSUBR                     Modification hi
      * RTV GTIN Req Sts      RT - EDI Bill To Interchange  * 
     C                     EXSR SQRVGN
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZGINIT    BEGSR
      *================================================================
      * PRT BT Cust by DUNS   PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'N'       WN0004           USR Display 1
      *================================================================
     CSR         ZGEXIT    ENDSR
      /EJECT
     CSR         ZHINIT    BEGSR
      *================================================================
      * PRT ST Cust by DUNS   PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'N'       WN0005           USR Display 1
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BQTSCN           ST02-TRANS SET
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAAAC8           Customer G_L Ve
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BRTSCN           ST02-TRANS SET
     C                     MOVEL*LOVAL    BRSEQX           ITEM SEQUENCE N
      * Define work field Text USR 7
     C                     MOVEL*BLANK    WUY8TX  7
      * Define work field Text 7 Alpha Usr
     C                     MOVEL*BLANK    WUZ3TX  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBBKC7           Ship To Custome
     C                     MOVEL*LOVAL    WBCOAA           CIR Resource No
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A7H9NY           EDI SURROGATE N
     C                     MOVEL*LOVAL    A7SEQX           ITEM SEQUENCE N
     C                     MOVEL*LOVAL    A7YFNY           Item Secondary
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    B0TSCN           ST02-TRANS SET
     C                     MOVEL*LOVAL    B0SEQX           ITEM SEQUENCE N
     C                     MOVEL*LOVAL    B0PSQ2           PO Secondary Se
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A8H9NY           EDI SURROGATE N
     C                     MOVEL*LOVAL    A8UONY           ENT01-SEQUENCE
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    NEU5TX           EDI Cust Duns N
     C                     MOVEL*LOVAL    NEBKC7           Ship To Custome
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    NEU5TX           EDI Cust Duns N
     C                     MOVEL*LOVAL    NEBKC7           Ship To Custome
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A9H9NY           EDI SURROGATE N
     C                     MOVEL*LOVAL    A9YGNY           Note Sequence 1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001 20
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003 30
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005 40
     C                     MOVEL*BLANK    WL0006 40
     C                     MOVEL*BLANK    WL0007 30
     C                     MOVEL*BLANK    WL0008 50
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  3
     C                     MOVEL*BLANK    WL0011 40
     C                     MOVEL*BLANK    WL0012 40
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0013  3
     C                     MOVEL*BLANK    WL0014 30
     C                     MOVEL*BLANK    WL0015  3
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0016  3
     C                     MOVEL*BLANK    WL0017 50
     C                     MOVEL*BLANK    WL0018  1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0019 10
     C                     MOVEL*BLANK    WL0020 10
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0021 10
     C                     MOVEL*BLANK    WL0022  6
     C                     Z-ADD*ZERO     WL0023  30
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0024  30
     C                     MOVEL*BLANK    WL0025 10
     C                     MOVEL*BLANK    WL0026 40
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0027  70
     C                     MOVEL*BLANK    WL0028 30
     C                     MOVEL*BLANK    WL0029 30
     C                     MOVEL*BLANK    WL0030 30
     C                     MOVEL*BLANK    WL0031 30
     C                     MOVEL*BLANK    WL0032 20
     C                     MOVEL*BLANK    WL0033  2
     C                     MOVEL*BLANK    WL0034 11
     C                     Z-ADD*ZERO     WL0035  70
     C                     MOVEL*BLANK    WL0036  6
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0037  70
     C                     MOVEL*BLANK    WL0038  6
     C                     MOVEL*BLANK    WL0039 20
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0040  70
     C                     MOVEL*BLANK    WL0041 30
     C                     MOVEL*BLANK    WL0042 30
     C                     MOVEL*BLANK    WL0043 30
     C                     MOVEL*BLANK    WL0044 30
     C                     MOVEL*BLANK    WL0045 20
     C                     MOVEL*BLANK    WL0046  2
     C                     MOVEL*BLANK    WL0047 11
     C                     MOVEL*BLANK    WL0048 25
     C                     Z-ADD*ZERO     WL0049  70
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0052  70
     C                     MOVEL*BLANK    WL0053  6
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  70
     C                     MOVEL*BLANK    WL0056 14
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0057  70
     C                     Z-ADD*ZERO     WL0058  70
     C                     MOVEL*BLANK    WL0059 14
     C                     MOVEL*BLANK    WL0060  2
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0061  70
     C                     MOVEL*BLANK    WL0062 30
     C                     MOVEL*BLANK    WL0063 30
     C                     MOVEL*BLANK    WL0064 30
     C                     MOVEL*BLANK    WL0065 30
     C                     MOVEL*BLANK    WL0066 20
     C                     MOVEL*BLANK    WL0067  2
     C                     MOVEL*BLANK    WL0068 11
     C                     Z-ADD*ZERO     WL0069  70
     C                     MOVEL*BLANK    WL0070  6
     C                     MOVEL*BLANK    WL0071  1
     C                     MOVEL*BLANK    WL0072  1
      * Define local work field EDI Cust Duns Number
     C                     MOVEL*BLANK    YL0001 20
      * Define local work field EDI Cust Duns Number
     C                     MOVEL*BLANK    YL0002 20
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0003  3
      * Define null work field Sales Route Description
     C                     MOVEL*BLANK    YN0001 30
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0004  70
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0002 40
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0003 40
      * Define null work field Salesperson Name
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Email Address
     C                     MOVEL*BLANK    YN0005 50
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0008 40
      * Define null work field Customer Name
     C                     MOVEL*BLANK    YN0006 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0007 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0008 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0009 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0010 20
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0011  2
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0012 11
      * Define local work field A_R Customer
     C                     Z-ADD*ZERO     YL0009  70
      * Define null work field Country Code
     C                     MOVEL*BLANK    YN0013  6
      * Define null work field EDI Trading Partner No
     C                     MOVEL*BLANK    YN0014  6
      * Define local work field EDI Shipto Duns Number
     C                     MOVEL*BLANK    YL0010 20
      * Define local work field EDI Billto Duns Number
     C                     MOVEL*BLANK    YL0011 20
      * Define local work field Salesperson Name
     C                     MOVEL*BLANK    YL0012 30
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0013 50
      * Define null work field Customer Name
     C                     MOVEL*BLANK    YN0015 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0016 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0017 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0018 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0019 20
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0020  2
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0021 11
      * Define null work field Telephone Number FF
     C                     MOVEL*BLANK    YN0022 25
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0014  70
      * Define null work field Order Entry Hold
     C                     MOVEL*BLANK    YN0023  1
      * Define local work field Ship To Customer Flag
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field EDI Trading Partner No
     C                     MOVEL*BLANK    YL0016  6
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0017  3
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0019  30
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0020 40
      * Define local work field EDI Trading Partner No
     C                     MOVEL*BLANK    YL0021  6
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0024 30
      * Define local work field A_R Customer
     C                     Z-ADD*ZERO     YL0022  70
      * Define null work field Country Code
     C                     MOVEL*BLANK    YN0025  6
      * Define local work field CMS Duns
     C                     MOVEL*BLANK    YL0023  9
      * Define local work field Customer Number NBR
     C                     Z-ADD*ZERO     YL0024  70
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0026 40
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0027 40
      * Define null work field Customer Name
     C                     MOVEL*BLANK    YN0028 30
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0025  70
      * Define null work field EDI Trading Partner No
     C                     MOVEL*BLANK    YN0029  6
      * Define local work field EDI BTI GTIN Required
     C                     MOVEL*BLANK    YL0026  2
      * Define local work field N102-NAME
     C                     MOVEL*BLANK    YL0027 30
      * Define local work field EDI Shipto Duns Number
     C                     MOVEL*BLANK    YL0028 20
      * Define local work field Item Code Txt
     C                     MOVEL*BLANK    YL0029  7
      * Define local work field Item Code Number 7.0  USR
     C                     Z-ADD*ZERO     YL0030  70
      * Define null work field Description Line One
     C                     MOVEL*BLANK    YN0030 30
      * Define null work field Description Line Two
     C                     MOVEL*BLANK    YN0031 30
      * Define null work field UOM Primary Dft
     C                     MOVEL*BLANK    YN0032  2
      * Define local work field Conversion Factor 1
     C                     Z-ADD*ZERO     YL0031  94
      * Define null work field Operation Factor 1
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field UOM Second Dft
     C                     MOVEL*BLANK    YN0034  2
      * Define null work field Conversion Factor 2
     C                     Z-ADD*ZERO     YN0035  94
      * Define null work field Operation Factor 2
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field UOM Third Dft
     C                     MOVEL*BLANK    YN0037  2
      * Define local work field UOM Pricing Dft
     C                     MOVEL*BLANK    YL0032  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0038 112
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0039  1
      * Define null work field Item Structure Class Code
     C                     Z-ADD*ZERO     YN0040  30
      * Define null work field Item Structure Group Code
     C                     Z-ADD*ZERO     YN0041  30
      * Define null work field Item Structure Type Code
     C                     Z-ADD*ZERO     YN0042  30
      * Define null work field Item Type Code
     C                     MOVEL*BLANK    YN0043  3
      * Define null work field Package Type Code
     C                     MOVEL*BLANK    YN0044  1
      * Define null work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    YN0045  2
      * Define null work field Variety_Rendered_Cut
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Frozen Make to Order Sts
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Credit Item Status
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field Seconds Item
     C                     MOVEL*BLANK    YN0049  1
      * Define local work field CIR Resource No
     C                     MOVEL*BLANK    YL0033 14
      * Define local work field USR Item Code 7,0 signed
     C                     Z-ADD*ZERO     YL0034  70
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0035  70
      * Define null work field CIR UM Base Price
     C                     MOVEL*BLANK    YN0050  2
      * Define local work field Item Secondary line Seq
     C                     Z-ADD*ZERO     YL0036  50
      * Define local work field Address Line 2
     C                     MOVEL*BLANK    YL0037 30
      * Define local work field Address Line 3
     C                     MOVEL*BLANK    YL0038 30
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0039  70
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0040  6
      * Define local work field Ship To Customer Flag
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field Usr Counter Dtl
     C                     Z-ADD*ZERO     YL0042  50
      * Define null work field Customer Name
     C                     MOVEL*BLANK    YN0051 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0052 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0053 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0054 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0055 20
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0056  2
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0057 11
      * Define null work field Country Code
     C                     MOVEL*BLANK    YN0058  6
      * Define null work field Ship To Customer Flag
     C                     MOVEL*BLANK    YN0059  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0060  1
      * Define local work field EDI Trading Partner No
     C                     MOVEL*BLANK    YL0043  6
      * Define local work field Address Line 2
     C                     MOVEL*BLANK    YL0044 30
      * Define local work field Address Line 3
     C                     MOVEL*BLANK    YL0045 30
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0046  70
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0047  6
      * Define local work field Ship To Customer Flag
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field Usr Counter Dtl
     C                     Z-ADD*ZERO     YL0049  50
      * Define null work field Customer Name
     C                     MOVEL*BLANK    YN0061 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0062 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0063 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0064 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0065 20
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0066  2
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0067 11
      * Define null work field Telephone Number FF
     C                     MOVEL*BLANK    YN0068 25
      * Define null work field Order Entry Hold
     C                     MOVEL*BLANK    YN0069  1
      * Define local work field EDI Trading Partner No
     C                     MOVEL*BLANK    YL0050  6
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
     C                     MOVEL'N'       P4EMPO           Email PO Error
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 DFTPOEMAIL
00002 Not Available
00003 Y2U0005
00004 DSYSCO
00005 NOT FOUND
00006 ********************
