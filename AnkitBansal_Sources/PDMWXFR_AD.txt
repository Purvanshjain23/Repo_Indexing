// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDMWXFR
// ?Date: 14.08.2025 Time: 03:28:47
// ?------------------------------------------------------------------------------------------------

//?Execute user function

// PAR.Price per Pricing U/M = CON.*ZERO
PAR.Commodity_Market_Price = *ZERO;

// PAR.Pricing Retrieved Amount = CON.*ZERO
PAR.Pricing_Retrieved_Amount = *ZERO;

// PAR.USR Date Priced = CON.*ZERO
PAR.USR_Date_Priced = *ZERO;

CASE;

// IF PAR.Date Method Code is Date Range Average
IF PAR.Date_Method_Code = 'DRA';

// Call program CLC Date Method        XF.
CALL PROGRAM(CLC Date Method        XF) ('PDLJXFR');
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Date_Method_Code);
PARAMETER(PAR.Market_Price_Date);
PARAMETER(*ZERO);
PARAMETER(PAR.Commodity_Market_Price);
PARAMETER(99);
PARAMETER(PAR.Commodity_Price_Group);
PARAMETER(PAR.Market_Price_Date);
PARAMETER(PAR.Date_To_USR);
PARAMETER(WRK.Date_Used_for_Calculation);
PARAMETER(WRK.Date_Error_Returned);
PARAMETER(*ZERO);

// IF *OTHERWISE
IF *OTHERWISE;

// Call program CLC Date Method        XF.
CALL PROGRAM(CLC Date Method        XF) ('PDLJXFR');
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Date_Method_Code);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(PAR.Commodity_Market_Price);
PARAMETER(99);
PARAMETER(PAR.Commodity_Price_Group);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(WRK.Date_Used_for_Calculation);
PARAMETER(WRK.Date_Error_Returned);
PARAMETER(*ZERO);

ENDIF;

CASE;

// IF WRK.Date Error Returned is Price Date Matching Error
IF WRK.Date_Error_Returned = 'KPD';

// AND PAR.Date Method Code is Current Day Price
AND PAR.Date_Method_Code = 'CUR';

// PAR.Pricing Retrieved Amount = CON.*ZERO
PAR.Pricing_Retrieved_Amount = *ZERO;

// IF *OTHERWISE
IF *OTHERWISE;

// PAR.Pricing Retrieved Amount = PAR.Price per Pricing U/M
PAR.Pricing_Retrieved_Amount = PAR.Commodity_Market_Price;

ENDIF;

// PAR.Error Return = WRK.Date Error Returned
PAR.Error_Return = WRK.Date_Error_Returned;

