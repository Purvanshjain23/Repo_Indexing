// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDFKXFR
// ?Date: 14.08.2025 Time: 03:31:41
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(CLC Download Orders    RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1386024;
PARAMETER(PAR.Load_ID);
{
 //?USER: Process Data record

 CASE;

 // IF PAR.Load ID is NE Blank
 IF PAR.Load_ID <> *ZERO;

 // AND DB1.Load ID NE PAR.Load ID
 AND DB1.Load_ID <> PAR.Load_ID;

 RETURN;

 ENDIF;

 //?** Write  -Accusort Processing if This is a Plant Floor Load
 DO;

 CASE;

 // IF DB1.Ship Status is Open
 IF DB1.Ship_Status = 'O';

 // OR DB1.Ship Status EQ WRK.BLANK
 OR DB1.Ship_Status = WRK.BLANK;

 // PAR.Trans Contol AS400/Plant = CND.AS400
 PAR.Trans_Contol_AS400_Plant = 'A';

 //?*** Return Plant Code from first Order Header
 EXECUTE FUNCTION(zzV for Accusort Load  RT) TYPE(RTVOBJ) FILE(OMFLCPP)          AC1322485;
 PARAMETER(DB1.Load_ID);
 PARAMETER(PAR.Trans_Contol_AS400_Plant);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(RTV Trans Control      RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1305919;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(WRK.Trans_Contol_AS400_Plant);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   EXECUTE FUNCTION(RTV Trans Control      RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1428569;
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(WRK.Trans_Contol_AS400_Plant);
   {
    //?USER: Process Data record

    CASE;

    // IF DB1.Detail Line Status is Not cancelled
    IF DB1.Detail_Line_Status = 'L'/'A'/'C'/'R'/'E'/'H'/'I';

    EXECUTE FUNCTION(Rtv Desc/Trans Control RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1304130;
    PARAMETER(DB1.Warehouse_Code);
    PARAMETER(WRK.Warehouse_Description);
    PARAMETER(PAR.Trans_Contol_AS400_Plant);
    {
     //?USER: Processing if Data record not found

     MOVE *ALL (To: PAR From: CON);

     //?USER: Process Data record

     MOVE *ALL (To: PAR From: DB1);

    }

    QUIT;

    ENDIF;

   }

   CASE;

   // IF WRK.Trans Contol AS400/Plant is Plant
   IF WRK.Trans_Contol_AS400_Plant = 'P';

   // PAR.Trans Contol AS400/Plant = WRK.Trans Contol AS400/Plant
   PAR.Trans_Contol_AS400_Plant = WRK.Trans_Contol_AS400_Plant;

   QUIT;

   ENDIF;

  }

  CASE;

  // IF WRK.Trans Contol AS400/Plant is Plant
  IF WRK.Trans_Contol_AS400_Plant = 'P';

  // PAR.Trans Contol AS400/Plant = WRK.Trans Contol AS400/Plant
  PAR.Trans_Contol_AS400_Plant = WRK.Trans_Contol_AS400_Plant;

  QUIT;

  ENDIF;

 }

 CASE;

 // IF PAR.Trans Contol AS400/Plant is Plant
 IF PAR.Trans_Contol_AS400_Plant = 'P';

 // Call program Zzz Lock/Unlock Box ID XF.
 CALL PROGRAM(Zzz Lock/Unlock Box ID XF) ('PDXFXFR');
 PARAMETER('L');

 // Call program Zzz AS Order Hdr/Dtl   XF.
 CALL PROGRAM(Zzz AS Order Hdr/Dtl   XF) ('PDQPXFR');
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Company_Number);

 // Call program Zzz Lock/Unlock Box ID XF.
 CALL PROGRAM(Zzz Lock/Unlock Box ID XF) ('PDXFXFR');
 PARAMETER('U');

 ENDIF;

 ENDIF;

 ENDDO;

}


