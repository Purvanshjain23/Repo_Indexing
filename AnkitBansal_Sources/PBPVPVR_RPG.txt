     H/TITLE Pmt Val for PO Ack    PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 01/25/23  Time  : 08:55:52
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPBPVPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Pmt Val for PO Ack    PV  Prompt & validate record
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPNGQREL1IF  E           K        DISK
      * RTV : EDI Bill To Interchange   Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FECP004L8IF  E           K        DISK
      * RSQ : EDI Purchase Order Header Trade Partner/PO Number
      *
     FOPBFCPLWIF  E           K        DISK
      * RTV : Order Header TRG          Orders not Cancelled
      *
     FECP004L3IF  E           K        DISK
      * RSQ : EDI Purchase Order Header PO Number
      *
     FPNGQREL2IF  E           K        DISK
      * RSQ : EDI Bill To Interchange   TradePartner/IntCode
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     E                    #L7         7  1
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@GQREH2
      * EDI Bill To Interchange   Retrieval index
      * Renamed input format fields
     I              GQB0C7                          WBB0C7
     I              GQM4AA                          WBM4AA
     I              GQM7AA                          WBM7AA
     I              GQJ5NX                          WBJ5NX
     I              GQA8U1                          WBA8U1
     I              GQA9U1                          WBA9U1
     I              GQBAU1                          WBBAU1
     I              GQBBU1                          WBBBU1
     I              GQY4NY                          WBY4NY
     I              GQY5NY                          WBY5NY
     I              GQBFU1                          WBBFU1
     I              GQBGU1                          WBBGU1
     I              GQBHU1                          WBBHU1
     I              GQBIU1                          WBBIU1
     I              GQSIAA                          WBSIAA
     I              GQSJAA                          WBSJAA
     I              GQVSST                          WBVSST
     I              GQMJDT                          WBMJDT
     I              GQBETM                          WBBETM
     I              GQCCVN                          WBCCVN
     I              GQCDVN                          WBCDVN
     I              GQMKDT                          WBMKDT
     I              GQBFTM                          WBBFTM
     I              GQCEVN                          WBCEVN
     I              GQCFVN                          WBCFVN
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WCAIC3
     I              AMC4NB                          WCC4NB
     I              AMRMNB                          WCRMNB
     I              AMRUNB                          WCRUNB
     I              AMXACD                          WCXACD
     I              AMOANA                          WCOANA
     I              AMHBAA                          WCHBAA
     I              AMJ0T1                          WCJ0T1
     I              AMGENY                          WCGENY
     I              AMJ1T1                          WCJ1T1
     I              AMHCAA                          WCHCAA
     I              AMQWDT                          WCQWDT
     I              AMQXDT                          WCQXDT
     I              AMQYDT                          WCQYDT
     I              AMHDAA                          WCHDAA
     I              AMCCTX                          WCCCTX
     I              AMJ2T1                          WCJ2T1
     I              AMRLNA                          WCRLNA
     I              AMRMNA                          WCRMNA
     I              AMGINY                          WCGINY
     I              AMGFNY                          WCGFNY
     I              AMGGNY                          WCGGNY
     I              AMGHNY                          WCGHNY
     I              AMHEVL                          WCHEVL
     I              AMHFVL                          WCHFVL
     I              AMHGVL                          WCHGVL
     I              AMQZDT                          WCQZDT
     I              AMQ0DT                          WCQ0DT
     I              AMQ1DT                          WCQ1DT
     I              AMQ2DT                          WCQ2DT
     I              AMC2TX                          WCC2TX
     I              AMC3TX                          WCC3TX
     I              AMC6TX                          WCC6TX
     I              AMCHTX                          WCCHTX
     I              AMCITX                          WCCITX
     I              AMCLTX                          WCCLTX
     I              AMB4TX                          WCB4TX
     I              AMCUTX                          WCCUTX
     I              AMCVTX                          WCCVTX
     I              AMB9TX                          WCB9TX
     I              AMJWSC                          WCJWSC
     I              AMITNY                          WCITNY
     I              AMLMT1                          WCLMT1
     I              AMLWAA                          WCLWAA
     I              AMFVST                          WCFVST
     I              AMF0ST                          WCF0ST
     I              AMF2ST                          WCF2ST
     I              AMF3ST                          WCF3ST
     I              AMJUSC                          WCJUSC
     I              AMJVSC                          WCJVSC
     I              AMV3T1                          WCV3T1
     I              AMV4T1                          WCV4T1
     I              AMV5T1                          WCV5T1
     I              AMV6T1                          WCV6T1
     I              AMV7T1                          WCV7T1
     I              AMV8T1                          WCV8T1
     I              AMV9T1                          WCV9T1
     I              AMWAT1                          WCWAT1
     I              AMWBT1                          WCWBT1
     I              AMWCT1                          WCWCT1
     I              AMWDT1                          WCWDT1
     I              AMQJNY                          WCQJNY
     I              AMQKNY                          WCQKNY
     I              AMQLNY                          WCQLNY
     I              AMP8NY                          WCP8NY
     I              AMP9NY                          WCP9NY
     I              AMQANY                          WCQANY
     I              AMQCNY                          WCQCNY
     I              AMQDNY                          WCQDNY
     I              AMQENY                          WCQENY
     I              AMQFNY                          WCQFNY
     I              AMQGNY                          WCQGNY
     I              AMQHNY                          WCQHNY
     I              AMQINY                          WCQINY
     I              AMQMNY                          WCQMNY
     I              AMMYU1                          WCMYU1
     I              AMJXSC                          WCJXSC
     I              AMJYSC                          WCJYSC
     I              AMJZSC                          WCJZSC
     I              AMJ0SC                          WCJ0SC
     I              AMMZU1                          WCMZU1
     I              AMM0U1                          WCM0U1
     I              AMM1U1                          WCM1U1
     I              AMM2U1                          WCM2U1
     I              AMM3U1                          WCM3U1
     I              AMW5DT                          WCW5DT
     I              AMW6DT                          WCW6DT
     I              AMUVST                          WCUVST
     I              AMUWST                          WCUWST
     I              AMUXST                          WCUXST
     I              AMVSST                          WCVSST
     I              AMAATM                          WCAATM
     I              AMAYNA                          WCAYNA
     I              AMA0NA                          WCA0NA
     I              AMAXDT                          WCAXDT
      *
     I@P004SK
      * EDI Purchase Order Header Trade Partner/PO Number
      * Renamed input format fields
     I              BQTSCN                          WDTSCN
     I              BQL3SX                          WDL3SX
     I              BQOSDT                          WDOSDT
     I              BQPONO                          WDPONO
     I              BQDKAA                          WDDKAA
     I              BQNAME                          WDNAME
     I              BQCQLF                          WDCQLF
     I              BQCNUM                          WDCNUM
     I              BQINRF                          WDINRF
     I              BQGNTX                          WDGNTX
     I              BQHUAA                          WDHUAA
     I              BQHUVL                          WDHUVL
     I              BQHVAA                          WDHVAA
     I              BQX8T1                          WDX8T1
     I              BQJ2AA                          WDJ2AA
     I              BQT6DT                          WDT6DT
     I              BQQLFX                          WDQLFX
     I              BQDELV                          WDDELV
     I              BQSHMT                          WDSHMT
     I              BQMTTY                          WDMTTY
     I              BQPLEX                          WDPLEX
     I              BQLDOP                          WDLDOP
     I              BQROUT                          WDROUT
     I              BQFOBP                          WDFOBP
     I              BQD3VL                          WDD3VL
     I              BQUNIT                          WDUNIT
     I              BQD4VL                          WDD4VL
     I              BQAMTX                          WDAMTX
     I              BQDSTS                          WDDSTS
     I              BQSRAA                          WDSRAA
     I              BQBRU1                          WDBRU1
     I              BQSSAA                          WDSSAA
     I              BQBSU1                          WDBSU1
     I              BQSTAA                          WDSTAA
     I              BQBTU1                          WDBTU1
     I              BQSUAA                          WDSUAA
     I              BQBUU1                          WDBUU1
     I              BQSVAA                          WDSVAA
     I              BQBVU1                          WDBVU1
     I              BQSWAA                          WDSWAA
     I              BQBWU1                          WDBWU1
     I              BQSXAA                          WDSXAA
     I              BQBXU1                          WDBXU1
     I              BQYDT1                          WDYDT1
     I              BQNLST                          WDNLST
     I              BQUFDT                          WDUFDT
     I              BQOJAA                          WDOJAA
     I              BQJ5NX                          WDJ5NX
      *
     I@BFCPZ9
      * Order Header TRG          Orders not Cancelled
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@P004SX
      * EDI Purchase Order Header PO Number
      * Renamed input format fields
     I              BQTSCN                          WFTSCN
     I              BQL3SX                          WFL3SX
     I              BQOSDT                          WFOSDT
     I              BQPONO                          WFPONO
     I              BQDKAA                          WFDKAA
     I              BQNAME                          WFNAME
     I              BQCQLF                          WFCQLF
     I              BQCNUM                          WFCNUM
     I              BQINRF                          WFINRF
     I              BQGNTX                          WFGNTX
     I              BQHUAA                          WFHUAA
     I              BQHUVL                          WFHUVL
     I              BQHVAA                          WFHVAA
     I              BQX8T1                          WFX8T1
     I              BQJ2AA                          WFJ2AA
     I              BQT6DT                          WFT6DT
     I              BQQLFX                          WFQLFX
     I              BQDELV                          WFDELV
     I              BQSHMT                          WFSHMT
     I              BQMTTY                          WFMTTY
     I              BQPLEX                          WFPLEX
     I              BQLDOP                          WFLDOP
     I              BQROUT                          WFROUT
     I              BQFOBP                          WFFOBP
     I              BQD3VL                          WFD3VL
     I              BQUNIT                          WFUNIT
     I              BQD4VL                          WFD4VL
     I              BQAMTX                          WFAMTX
     I              BQDSTS                          WFDSTS
     I              BQSRAA                          WFSRAA
     I              BQBRU1                          WFBRU1
     I              BQSSAA                          WFSSAA
     I              BQBSU1                          WFBSU1
     I              BQSTAA                          WFSTAA
     I              BQBTU1                          WFBTU1
     I              BQSUAA                          WFSUAA
     I              BQBUU1                          WFBUU1
     I              BQSVAA                          WFSVAA
     I              BQBVU1                          WFBVU1
     I              BQSWAA                          WFSWAA
     I              BQBWU1                          WFBWU1
     I              BQSXAA                          WFSXAA
     I              BQBXU1                          WFBXU1
     I              BQYDT1                          WFYDT1
     I              BQNLST                          WFNLST
     I              BQUFDT                          WFUFDT
     I              BQOJAA                          WFOJAA
     I              BQJ5NX                          WFJ5NX
      *
     I@GQRETZ
      * EDI Bill To Interchange   TradePartner/IntCode
      * Renamed input format fields
     I              GQB0C7                          WGB0C7
     I              GQM4AA                          WGM4AA
     I              GQM7AA                          WGM7AA
     I              GQJ5NX                          WGJ5NX
     I              GQA8U1                          WGA8U1
     I              GQA9U1                          WGA9U1
     I              GQBAU1                          WGBAU1
     I              GQBBU1                          WGBBU1
     I              GQY4NY                          WGY4NY
     I              GQY5NY                          WGY5NY
     I              GQBFU1                          WGBFU1
     I              GQBGU1                          WGBGU1
     I              GQBHU1                          WGBHU1
     I              GQBIU1                          WGBIU1
     I              GQSIAA                          WGSIAA
     I              GQSJAA                          WGSJAA
     I              GQVSST                          WGVSST
     I              GQMJDT                          WGMJDT
     I              GQBETM                          WGBETM
     I              GQCCVN                          WGCCVN
     I              GQCDVN                          WGCDVN
     I              GQMKDT                          WGMKDT
     I              GQBFTM                          WGBFTM
     I              GQCEVN                          WGCEVN
     I              GQCFVN                          WGCFVN
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WHAJVN
     I              DRAUNA                          WHAUNA
     I              DRB8NA                          WHB8NA
     I              DRAHVN                          WHAHVN
     I              DRI6ST                          WHI6ST
     I              DRI7ST                          WHI7ST
     I              DRXMST                          WHXMST
     I              DRXNST                          WHXNST
     I              DRI8ST                          WHI8ST
     I              DRNLNB                          WHNLNB
     I              DRMPNA                          WHMPNA
     I              DRBCCD                          WHBCCD
     I              DRAIC3                          WHAIC3
     I              DRDQCD                          WHDQCD
     I              DRDRCD                          WHDRCD
     I              DRAJCD                          WHAJCD
     I              DRBUVN                          WHBUVN
     I              DRUVST                          WHUVST
     I              DRUWST                          WHUWST
     I              DRUXST                          WHUXST
     I              DRAATM                          WHAATM
     I              DRAYNA                          WHAYNA
     I              DRA0NA                          WHA0NA
     I              DRAXDT                          WHAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WIAJVN
     I              DTDNCD                          WIDNCD
     I              DTAIC3                          WIAIC3
     I              DTDQCD                          WIDQCD
     I              DTDRCD                          WIDRCD
     I              DTAJCD                          WIAJCD
     I              DTJFST                          WIJFST
     I              DTUVST                          WIUVST
     I              DTUWST                          WIUWST
     I              DTUXST                          WIUXST
     I              DTAATM                          WIAATM
     I              DTAYNA                          WIAYNA
     I              DTA0NA                          WIA0NA
     I              DTAXDT                          WIAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WJDNCD
     I              DNAUNA                          WJAUNA
     I              DNVKST                          WJVKST
     I              DNRSCD                          WJRSCD
     I              DNUVST                          WJUVST
     I              DNUWST                          WJUWST
     I              DNUXST                          WJUXST
     I              DNAATM                          WJAATM
     I              DNAYNA                          WJAYNA
     I              DNA0NA                          WJA0NA
     I              DNAXDT                          WJAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Application Code
     I                                        6  11 P1DNCD
      * N :  Salesperson Code
     I                                       12  14 P1BCCD
      * N :  User Profile Name
     I                                       15  24 P1AJVN
      * N :  Allow Multi-Company
     I                                       25  25 P1I6ST
      * N :  Allow Multi Warehouse
     I                                       26  26 P1I8ST
      * N :  Default Printer
     I                                       27  36 P1MPNA
      * N :  First Time Flag
     I                                       37  37 P1TAST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PO Ack Created for OrdCMP'
      * Order Number
     I                                        1   7 ZA0001
      * Message data for 'PO Ack Not Created CMP'
      * Order Number
     I                                        1   7 ZA0002
      * Text 1 USR
     I                                        8  32 ZA0003
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'No PO exists for Order'
      * G5003-PURCHASE ORDER NUMB
     I                                        1  22 ZA0004
      * Order Number
     I                                       23  29 ZA0005
      * Message data for 'Trading Partner POACK Rqd'
      * EDI Trading Partner No.
     I                                        1   6 ZA0006
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0007
      * Application Code
     I                                       11  16 ZA0008
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0009
      * Application Code
     I                                       11  16 ZA0010
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * Val for PO Ack        IF
     C                     MOVEL'N'       YL0002           EDI Process Fla
      * Retrieve the BT Customer
      * Rtv Order Info ALL    RT - Order Header TRG  * 
     C                     EXSR SARVGN
      * Check to see it the BT Cust should get a POA/POAC (ack or chgd ac
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0003    WL0001           Bill to Custome
     C                     MOVEL'POACK'   WL0002    P      Interchange Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0006    P      POC/POCA ??
     C                     MOVELWL0004    YL0007    P      EDI Trading Par
      * W95589 DN 01/24/23-Commented Out & Moved Below.
      * W95589 DN 01/24/23-Only Check if Record Exist to Set EDI POA Flag
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Chk to see if BT cust requires a EDI PO ACK
      * CASE: LCL.POC/POCA ?? is PO Ack
     C           YL0006    IFEQ 'POACK'                    *IF
     C                     MOVEL'Y'       YL0008           EDI POA
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0008           EDI POA
     C                     END                             *FI
     C                     END                             *FI
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0003    WL0001           Bill to Custome
     C                     MOVEL'POCACK'  WL0002    P      Interchange Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0006    P      POC/POCA ??
     C                     MOVELWL0004    YL0007    P      EDI Trading Par
      * W95589 DN 01/24/23-Commented Out & Moved Below.
      * W95589 DN 01/24/23-Only Check if Record Exist to Set EDI POAC Fla
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Chk to see if BT cust requires a EDI PO Chg ACK
      * CASE: LCL.POC/POCA ?? is PO Change Ack
     C           YL0006    IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       YL0009           EDI POAC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0009           EDI POAC
     C                     END                             *FI
     C                     END                             *FI
      * See if a rcd has been written to OH ext.
      * RTV EDI PO Flag       RT - Order Header Extension  * 
     C                     EXSR SCRVGN
      * Record found in Order header ext
      * CASE: LCL.Record Found USR is Record Found
     C           YL0011    IFEQ 'Y'                        *IF
      * If flag blank, No ack has been sent for this PO yet.
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.OHE PO ACK Flag is *Blank
      *   |- c2    : LCL.OHE PO ACK Flag is *NO
      *   '-
     C           YL0010    IFEQ *BLANK                     *IF
     C           YL0010    OREQ '*NO'                      *OR
      * CASE: LCL.EDI POA is Yes
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0002           EDI Process Fla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If flag not blank, 855 ack has been sent for this PO. Need to sen
      * another 855(865) if the customer is set up for it.
      * CASE: LCL.EDI POAC is Yes
     C           YL0009    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0002           EDI Process Fla
     C                     END                             *FI
     C                     END                             *FI
      * If record not found and POA is yes, send
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.EDI POA is Yes
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0002           EDI Process Fla
     C                     END                             *FI
     C                     END                             *FI
      * When all chks are done, need to check to see if the Cust PO
      * has been entered. If not,do not send to customer.
      * If Cust PO# not entered
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6
      *   |- c1    : LCL.Customer Purchase Order # is tba
      *   |- c2    : LCL.Customer Purchase Order # is TBA(cap)
      *   |- c3    : LCL.Customer Purchase Order # is TBD(cap)
      *   |- c4    : LCL.Customer Purchase Order # is tbd
      *   |- c5    : LCL.Customer Purchase Order # is BLOCK(cap)
      *   |- c6    : LCL.Customer Purchase Order # is Block
      *   '-
     C           YL0004    IFEQ 'tba'                      *IF
     C           YL0004    OREQ 'TBA'                      *OR
     C           YL0004    OREQ 'TBD'                      *OR
     C           YL0004    OREQ 'tbd'                      *OR
     C           YL0004    OREQ 'BLOCK'                    *OR
     C           YL0004    OREQ 'Block'                    *OR
      * S13599 DN 08/16/18-Added check for 'TBD, tbd, BLOCK & Block'.
     C                     MOVEL'N'       YL0002           EDI Process Fla
     C                     MOVEL'NP'      YL0001           Trans Type 1 PA
     C                     END                             *FI
      * 2014/09/10 PKD/SAZ Check if PO was sent via EDI for SYSCO.  If ye
      *                    Create an 855; otherwise don't do it.
      * E003964 SLM  02/24/2015 logic for SYSCO & DSYSCO Work the same
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.EDI Trading Partner No. is SYSCO Dailys
      *   |- c2    : LCL.EDI Trading Partner No. is SYSCO Foods
      *   '-
     C           YL0007    IFEQ @CN,002                    *IF
     C           YL0007    OREQ 'SYSCO'                    *OR
      * VAL PO Exists         RT - EDI Purchase Order Header  * 
     C                     EXSR SDRVGN
      * VAL: Return Code
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0011    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0002           EDI Process Fla
     C                     MOVEL'TP'      YL0001           Trans Type 1 PA
     C                     END                             *FI
     C                     END                             *FI
      *  7/13/2021 JBB SDD657 - Trading Partner Control
      * Rtv EDI Manual PO Sts XF - EDI Bill To Interchange  * POACK
     C                     CALL 'PUTBXFR'              90  Rtv EDI Manual
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DAIC3    WQ0001  30       Company Number
     C                     PARM #DC4NB    WQ0002  70       Order Number
     C                     PARM 'POACK'   WQ0003  6        Interchange Cod
     C           YL0012    PARM *BLANK    WQ0004  1        Send EDI Docume
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
      * If Send EDI Invoice = N, set EDI Process Flag = N
      * CASE: LCL.Send EDI Document Y/N is No
     C           YL0012    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0002           EDI Process Fla
     C                     END                             *FI
      * CASE: LCL.EDI Process Flag is Process
     C           YL0002    IFEQ 'Y'                        *IF
      * 2014/09/09 PKD Added Price Audit condition
      * Do we need to EDI 855/865?
      * CASE:
      *  - c1 ORc2ORc3ORc4
      *   |- c1    : PAR.Pricing Event Called From is Market Price Change
      *   |- c2    : PAR.Pricing Event Called From is Order Entry
      *   |- c3    : PAR.Pricing Event Called From is Price Maintenance
      *   |- c4    : PAR.Pricing Event Called From is Price Audit
      *   '-
     C           #DPECF    IFEQ 'MPC'                      *IF
     C           #DPECF    OREQ 'OE'                       *OR
     C           #DPECF    OREQ 'PM'                       *OR
     C           #DPECF    OREQ 'PA'                       *OR
      * CASE: LCL.Price Status is Priced
     C           YL0005    IFEQ 'P'                        *IF
      * Rtv/Crt EDI PO Ack    XF - EDI PO Ack Hdr  * 
     C                     CALL 'PNYLXFR'              90  Rtv/Crt EDI PO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DAIC3    WQ0005  30       Company Number
     C                     PARM #DC4NB    WQ0006  70       Order Number
     C           YL0001    PARM YL0001    WQ0007  2        Trans Type 1 PA
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNYLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'OP'      YL0001           Trans Type 1 PA
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * S15383 DN 09/17/19-Commented Out & Moved Below.
      * S15383 DN 09/17/19-Send Completion Msg with the Correct Msg Conte
      * CASE: LCL.Trans Type 1 PASS     USR is not entered
     C           YL0001    IFEQ *BLANK                     *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'PO Ack Created for OrdCMP'
     C                     MOVEL'USR4767' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Text 1 USR = Condition name of LCL.Trans Type 1 PASS     USR
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1162839   Y2LSNO  70       List number
     C                     PARM YL0001    W0INVL 25        Trans Type 1 PA
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           YL0013    PARM           W0CNNM 25        Text 1 USR
      *
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELYL0013    ZA0003           Text 1 USR
      * Send message 'PO Ack Not Created CMP'
     C                     MOVEL'USR5149' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELVDAIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVDAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #DAIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #DAIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELVDC4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVDC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #DC4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #DC4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
     C                     MOVEL*BLANK    #DPONO           G5003-PURCHASE
      * 1. Order has to exist in Order header.
      * Retrieve the PO by the Order nbr and Co nbr
      * RTV Purchase Order     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DAIC3    WL0005           Company Number
     C                     Z-ADD#DC4NB    WL0006           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    #DPONO    P      Customer Purcha
      * 2. PO has to be sent in by EDI and exist in ECP004
      * S15383 DN 09/05/19-New Logic to Validate for EDI POACK 855.
      * CASE: *OTHERWISE
      * Validate PO # & Trading Partner #.
      * CASE: DTL.G5003-PURCHASE ORDER NUMB is Not Entered
     C           #DPONO    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DPONO    ZA0004           G5003-PURCHASE
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0005           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'No PO exists for Order'
     C                     MOVEL'USR4765' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Trade Partner     RT - EDI Purchase Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DPONO    WL0008    P      G5003-PURCHASE
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    #DJ5NX    P      EDI Trading Par
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
      * Send message 'EDI Purchase Order Hea NF'
     C                     MOVEL'USR3103' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      * Validate TP's PO ACK Required Flag.
      * CASE: DTL.EDI Trading Partner No. is Entered
     C           #DJ5NX    IFNE *BLANK                     *IF
      * Rtv PO ACK Required   RT - EDI Bill To Interchange  * 
     C                     EXSR SGRVGN
      * CASE: LCL.EDI PO ACK Required is Yes
     C           YL0014    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    #DPECF           Pricing Event C
     C                     MOVEL'PM'      #DPECF           Pricing Event C
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DJ5NX    ZA0006           EDI Trading Par
      * Send message 'Trading Partner POACK Rqd'
     C                     MOVEL'USR5145' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Company Number required
     C           #DAIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Number required
     C           #DC4NB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #DAIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    VDAIC3
     C                     Z-ADD*ZERO     #DC4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    VDC4NB
     C                     MOVEL*BLANK    #DJ5NX           EDI Trading Par
     C                     MOVEL*BLANK    #DPONO           G5003-PURCHASE
     C                     MOVEL*BLANK    #DPECF           Pricing Event C
     C                     MOVEL*BLANK    #DSZTX           Text 20
      * USER: Load screen
     C                     MOVEL*BLANK    #DPONO           G5003-PURCHASE
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #DAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#DAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VDAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Order Info ALL    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADD#DAIC3    WAAIC3           Company Number
     C                     Z-ADD#DC4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           A/R Customer Nu
     C                     MOVEL*BLANK    YL0004           Customer Purcha
     C                     MOVEL*BLANK    YL0005           Price Status
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAANC7    YL0003           A/R Customer Nu
     C                     MOVELWABCNA    YL0004           Customer Purcha
     C                     MOVELWAU1ST    YL0005           Price Status
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           POC/POCA ??
     C                     MOVEL*BLANK    WL0004           EDI Trading Par
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBB0C7           Bill to Custome
     C                     KFLD           WBM4AA           Interchange Cod
      * Setup key
     C                     Z-ADDWL0001    WBB0C7           Bill to Custome
     C                     MOVELWL0002    WBM4AA           Interchange Cod
      * Establish starting position
     C           KRSSB     CHAIN@GQREH2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4373' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           POC/POCA ??
     C                     MOVEL*BLANK    WL0004           EDI Trading Par
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBJ5NX    WL0004           EDI Trading Par
      * 01/24/23 DN W95589-Check Record Status is Active for both 855 & 8
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Interchange Code is PO Acknowledgement  855
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBM4AA    IFEQ 'POACK'                    *IF
     C           WBVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    WL0003           POC/POCA ??
     C                     MOVEL'POACK'   WL0003           POC/POCA ??
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Interchange Code is PO Change Ack       865
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBM4AA    IFEQ @CN,001                    *IF
     C           WBVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'POCACK'  WL0003           POC/POCA ??
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV EDI PO Flag       RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 3/11/14 SAZ If OHE PO ack flag = Blank, initialize to *NO
      * 3/11/14 SAZ If Record not found, initialize  OHE PO Ack Flag to *
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADD#DAIC3    WCAIC3           Company Number
     C                     Z-ADD#DC4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0011           Record Found US
     C                     MOVEL'N'       YL0011           Record Found US
     C                     MOVEL*BLANK    YL0010           OHE PO ACK Flag
     C                     MOVEL'*NO'     YL0010           OHE PO ACK Flag
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWCC6TX    YL0010           OHE PO ACK Flag
      * CASE: DB1.OHE PO ACK Flag is *Blank
     C           WCC6TX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    YL0010           OHE PO ACK Flag
     C                     MOVEL'*NO'     YL0010           OHE PO ACK Flag
     C                     END                             *FI
     C                     MOVEL'Y'       YL0011           Record Found US
     C                     GOTO SCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * VAL PO Exists         RT - EDI Purchase Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDJ5NX    WQSD01           EDI Trading Par
     C           *LIKE     DEFN WDPONO    WQSD02           G5003-PURCHASE
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           EDI Trading Par
     C                     KFLD           WQSD02           G5003-PURCHASE
      * Setup key
     C                     MOVELYL0007    WQSD01           EDI Trading Par
     C                     MOVELYL0004    WQSD02           G5003-PURCHASE
      * Establish starting position
     C           KRSSD     SETLL@P004SK                    *
     C           KRSSD     READE@P004SK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3103' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0011           Record Found US
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0011           Record Found US
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@P004SK                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Purchase Order     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0005    WEAIC3           Company Number
     C                     Z-ADDWL0006    WEC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BFCPZ9              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBCNA    WL0007           Customer Purcha
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Trade Partner     RT - EDI Purchase Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFPONO    WQSF01           G5003-PURCHASE
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           G5003-PURCHASE
      * Setup key
     C                     MOVELWL0008    WQSF01           G5003-PURCHASE
      * Establish starting position
     C           KRSSF     SETLL@P004SX                    *
     C           KRSSF     READE@P004SX                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3103' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           EDI Trading Par
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFJ5NX    WL0009           EDI Trading Par
     C           KRSSF     READE@P004SX                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv PO ACK Required   RT - EDI Bill To Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0014           EDI PO ACK Requ
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGJ5NX    WQSG01           EDI Trading Par
     C           *LIKE     DEFN WGM4AA    WQSG02           Interchange Cod
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           EDI Trading Par
     C                     KFLD           WQSG02           Interchange Cod
      * Setup key
     C                     MOVEL#DJ5NX    WQSG01           EDI Trading Par
     C                     MOVE *BLANK    WQSG02           Interchange Cod
     C                     MOVEL'POACK'   WQSG02           Interchange Cod
      * Establish starting position
     C           KRSSG     SETLL@GQRETZ                    *
     C           KRSSG     READE@GQRETZ                  90*
      * Data record not found
     C   90                MOVEL'USR4373' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGBFU1    YL0014           EDI PO ACK Requ
     C           KRSSG     READE@GQRETZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    WHAJVN           User Profile Na
      * Establish starting position
     C           KRSSH     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELWHMPNA    P1MPNA           Default Printer
     C                     MOVELWHBCCD    P1BCCD           Salesperson Cod
     C                     Z-ADDWHAIC3    YL0015           Company Number
     C                     MOVELWHBUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIAJVN           User Profile Na
     C                     KFLD           WIDNCD           Application Cod
      * Setup key
     C                     MOVELWL0010    WIAJVN           User Profile Na
     C                     MOVELWL0011    WIDNCD           Application Cod
      * Establish starting position
     C           KRSSI     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIAIC3    WL0012           Company Number
     C                     MOVELWIAJCD    WL0013           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJDNCD    WQSJ01           Application Cod
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSJ01           Application Cod
     C                     MOVEL'OMS'     WQSJ01           Application Cod
      * Establish starting position
     C           KRSSJ     SETLL@DNRESF                    *
     C           KRSSJ     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WJRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWJAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     C           KRSSJ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJDNCD    WQSK01           Application Cod
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Application Cod
      * Setup key
     C                     MOVELWJRSCD    WQSK01           Application Cod
      * Establish starting position
     C           KRSSK     SETLL@DNRESF                    *
     C           KRSSK     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJAUNA    WUAUNA           Description
     C           KRSSK     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBY4NY           EDI Alt ST Cust
     C                     Z-ADD*ZERO     WBY5NY           EDI unused nbr
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WCQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WCQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WCQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WCGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WCHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WCHGVL           Transload Termi
     C                     Z-ADD*ZERO     WCQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WCQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WCQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WCQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WCITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WCQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WCQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WCQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WCP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WCQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WCQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WCQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WCQENY           Original Appoin
     C                     Z-ADD*ZERO     WCQFNY           Original Appoin
     C                     Z-ADD*ZERO     WCQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WCQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WCW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDTSCN           ST02-TRANS SET
     C                     Z-ADD*ZERO     WDOSDT           G5002-ORDER DAT
     C                     Z-ADD*ZERO     WDHUVL           SAC05-$$ AMT OF
     C                     Z-ADD*ZERO     WDT6DT           G6202 Ship Date
     C                     Z-ADD*ZERO     WDDELV           G6202-DELIVERY
     C                     Z-ADD*ZERO     WDD3VL           G7601-QUANTITY
     C                     Z-ADD*ZERO     WDD4VL           G7603-WEIGHT OR
     C                     Z-ADD*ZERO     WDAMTX           G7608-ORDER AMO
     C                     Z-ADD*ZERO     WDUFDT           POH Date Stamp
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHNLNB           Entity Number
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  6
     C                     MOVEL*BLANK    WL0003  6
     C                     MOVEL*BLANK    WL0004  6
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007 15
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0008 22
     C                     MOVEL*BLANK    WL0009  6
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0010 10
     C                     MOVEL*BLANK    WL0011  6
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013  3
      * Define local work field Trans Type 1 PASS     USR
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field EDI Process Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0001  2
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0003  70
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0002  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0006 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0007 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0008  2
      * Define null work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YN0009 11
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0010  70
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0011 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0012 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0013 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0014 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0015 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0016  2
      * Define null work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YN0017 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0004 15
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0018  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0019  70
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0020  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0021  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0022  2
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0023 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0024 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0025  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YN0027  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0028  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0029  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0035  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0036 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0037  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0038 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0039 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0041  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0042  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0043  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0044  40
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0045  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0046 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0047  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0048  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0049 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0050  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0051  1
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0005  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0052  2
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0053  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0054  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0055  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0056  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0057  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0058  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0059  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0060  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0062  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0063  70
      * Define null work field Special Comment 1
     C                     MOVEL*BLANK    YN0064 30
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0065 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0066  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0067  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0068  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0069  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0070  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0071  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0072  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0073  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0074  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0075  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0076  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0077  1
      * Define null work field A/R order Value Total
     C                     Z-ADD*ZERO     YN0078 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0079  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0080  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0081  1
      * Define null work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     YN0082 112
      * Define null work field Process Sts for 3C
     C                     MOVEL*BLANK    YN0083  1
      * Define null work field Order Conf Fax Sts
     C                     MOVEL*BLANK    YN0084  1
      * Define null work field Manifest Fax Sts
     C                     MOVEL*BLANK    YN0085  1
      * Define null work field Invoice Fax Sts
     C                     MOVEL*BLANK    YN0086  1
      * Define null work field Transfer in Storage Ind
     C                     MOVEL*BLANK    YN0087  1
      * Define null work field Email Cust On Order Ship
     C                     MOVEL*BLANK    YN0088  1
      * Define null work field Order Emailed
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field Shipping Temp Code C/F
     C                     MOVEL*BLANK    YN0091  1
      * Define null work field Broker Order Status
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Air Freight Order
     C                     MOVEL*BLANK    YN0093  1
      * Define null work field Order Requires Review
     C                     MOVEL*BLANK    YN0094  2
      * Define null work field OH Load Plan Ready
     C                     MOVEL*BLANK    YN0095  2
      * Define null work field Export USDA Approved
     C                     MOVEL*BLANK    YN0096  2
      * Define null work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YN0097  3
      * Define null work field OH TF Exempt Code
     C                     MOVEL*BLANK    YN0098  3
      * Define null work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     YN0099  70
      * Define null work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     YN0100  70
      * Define null work field Load Actual Shipped Date
     C                     Z-ADD*ZERO     YN0101  70
      * Define null work field Load BOL Complete Date
     C                     Z-ADD*ZERO     YN0102  70
      * Define null work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YN0103  70
      * Define null work field Maximum Gross Weight
     C                     Z-ADD*ZERO     YN0104  60
      * Define null work field Time of Original Entry
     C                     Z-ADD*ZERO     YN0105  60
      * Define null work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     YN0106  60
      * Define null work field Load BOL Complete Time
     C                     Z-ADD*ZERO     YN0107  60
      * Define null work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YN0108  60
      * Define null work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YN0109 112
      * Define null work field Act Non-Ref Frt Amount
     C                     Z-ADD*ZERO     YN0110 112
      * Define null work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YN0111 112
      * Define null work field OH Total Non-Ref Frt Amt
     C                     Z-ADD*ZERO     YN0112 112
      * Define null work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YN0113 112
      * Define null work field Claim Number
     C                     Z-ADD*ZERO     YN0114  70
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0115  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0116  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0117  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0118  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0119 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0120 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0121  70
      * Define local work field POC/POCA ??
     C                     MOVEL*BLANK    YL0006  6
      * Define local work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YL0007  6
      * Define local work field EDI POA
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field EDI POAC
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0010  4
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Send EDI Document Y/N
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Text 1 USR
     C                     MOVEL*BLANK    YL0013 25
      * Define local work field EDI PO ACK Required
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0015  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0016  3
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SHRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0007           User Profile Na
     C                     MOVEL'OMS'     ZA0008           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0010    P      User Profile Na
     C                     MOVEL'OMS'     WL0011    P      Application Cod
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P1AIC3           Company Number
     C                     MOVELWL0013    YL0016    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0010    P      User Profile Na
     C                     MOVEL'OMS'     WL0011    P      Application Cod
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    P1AIC3           Company Number
     C                     MOVELWL0013    YL0016    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0016    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0009           User Profile Na
     C                     MOVEL'OMS'     ZA0010           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0015    IFNE 0                          *IF
     C                     Z-ADDYL0015    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0016    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0008  3        Warehouse Code
     C                     PARM YL0015    WQ0009  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SJRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 POCACK
00002 DSYSCO
00003 USR0752
00004 Y2U0005
