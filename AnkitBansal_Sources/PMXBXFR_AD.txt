// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMXBXFR
// ?Date: 14.08.2025 Time: 03:44:25
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?E00180 - Underweight loads sql
//?         Call Underweight loads & exec sql from job scheduler
EXECUTE FUNCTION(Rtv Plant Cos all     RT) TYPE(RTVOBJ) FILE(PDJYREP)           AC1809261;
PARAMETER(*ZERO);
PARAMETER(LCL.USR_Company_Number_1);
PARAMETER(LCL.USR_Company_Number_2);
PARAMETER(LCL.USR_Company_Number_3);
PARAMETER(LCL.USR_Company_Number_4);
PARAMETER(LCL.USR_Company_Number_5);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF PAR.USR Company Number 1 is Equal to zero
 IF PAR.USR_Company_Number_1 = *ZERO;

 // PAR.USR Company Number 1 = DB1.Company Number
 PAR.USR_Company_Number_1 = DB1.Company_Number;

 // IF PAR.USR Company Number 2 is Equal to zero
 IF PAR.USR_Company_Number_2 = *ZERO;

 // PAR.USR Company Number 2 = DB1.Company Number
 PAR.USR_Company_Number_2 = DB1.Company_Number;

 // IF PAR.USR Company Number 3 is Equal to zero
 IF PAR.USR_Company_Number_3 = *ZERO;

 // PAR.USR Company Number 3 = DB1.Company Number
 PAR.USR_Company_Number_3 = DB1.Company_Number;

 // IF PAR.USR Company Number 4 is Equal to zero
 IF PAR.USR_Company_Number_4 = *ZERO;

 // PAR.USR Company Number 4 = DB1.Company Number
 PAR.USR_Company_Number_4 = DB1.Company_Number;

 // IF PAR.USR Company Number 5 is Equal to zero
 IF PAR.USR_Company_Number_5 = *ZERO;

 // PAR.USR Company Number 5 = DB1.Company Number
 PAR.USR_Company_Number_5 = DB1.Company_Number;

 ENDIF;

}


EXECUTE FUNCTION(RTV Next Ship Date     RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1417256;
PARAMETER(LCL.USR_Company_Number_1);
PARAMETER(JOB.*Job_date);
PARAMETER(LCL.Scheduled_Ship_Date);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Post to G/L Date EQ PAR.Post to G/L Date
 IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

 // OR DB1.Day of Week is Sunday
 OR DB1.Day_of_Week = '1';

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Scheduled Ship Date = DB1.Post to G/L Date
 PAR.Scheduled_Ship_Date = DB1.Post_to_G_L_Date;

 QUIT;

 ENDIF;

}


// LCL.Number Value - 7 = LCL.Scheduled Ship Date
LCL.Number_Value_7 = LCL.Scheduled_Ship_Date;

//?RMC Run sql  ... and email to Gary Martin
// WRK.Text USR = CON.PRKUNDWT
WRK.Text_USR = 'PRKUNDWT';

// Execute command - 'EXECUTE SQL VIEW'
EXECUTE COMMAND(USR3987);
PARAMETER(LCL.Number_Value_7);
PARAMETER(WRK.Text_USR);

