// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBTGXFR
// ?Date: 14.08.2025 Time: 03:49:19
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(CLC TMS Sweep Dates    IF) TYPE(EXCINTFUN)                     AC2112611;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Post_to_G_L_Date);
PARAMETER(PAR.Date_0_RGT);
PARAMETER(PAR.Date_1_RGT);
PARAMETER(PAR.Date_2_RGT);
{
 //?Execute internal function

 EXECUTE FUNCTION(CLC TMS Sweep Dates   RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC2112465;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Post_to_G_L_Date);
 PARAMETER(PAR.Date_0_RGT);
 PARAMETER(PAR.Date_1_RGT);
 PARAMETER(PAR.Date_2_RGT);
 {
  //?USER: Initialize routine

  //?Clear the output parameters
  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?* If the day being passed in is Mon, Tue, Wed, Fri then put
  //?* the date being passed out into Date 0 RGT. If the day being
  //?* passed in is Thur, put the dates in Date 0 RGT, Date 1 RGT, Date 2 RGT
  //?If Monday, calculate Wednesday's date
  CASE;

  // IF DB1.Day of Week is Monday
  IF DB1.Day_of_Week = '2';

  // Call program CLC Add/Sub Any Date   XF.
  CALL PROGRAM(CLC Add/Sub Any Date   XF) ('PDX8XFR');
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(PAR.Date_0_RGT);
  PARAMETER(2);

  ENDIF;

  //?If Tuesday, calculate Thursday's date
  CASE;

  // IF DB1.Day of Week is Tuesday
  IF DB1.Day_of_Week = '3';

  // Call program CLC Add/Sub Any Date   XF.
  CALL PROGRAM(CLC Add/Sub Any Date   XF) ('PDX8XFR');
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(PAR.Date_0_RGT);
  PARAMETER(2);

  ENDIF;

  //?If Wednesday, calculate Friday's date
  CASE;

  // IF DB1.Day of Week is Wednesday
  IF DB1.Day_of_Week = '4';

  // Call program CLC Add/Sub Any Date   XF.
  CALL PROGRAM(CLC Add/Sub Any Date   XF) ('PDX8XFR');
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(PAR.Date_0_RGT);
  PARAMETER(2);

  ENDIF;

  //?If Thursday, calculate Saturday, Sunday and Monday's dates
  CASE;

  // IF DB1.Day of Week is Thursday
  IF DB1.Day_of_Week = '5';

  // Call program CLC Add/Sub Any Date   XF.
  CALL PROGRAM(CLC Add/Sub Any Date   XF) ('PDX8XFR');
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(PAR.Date_0_RGT);
  PARAMETER(2);

  // Call program CLC Add/Sub Any Date   XF.
  CALL PROGRAM(CLC Add/Sub Any Date   XF) ('PDX8XFR');
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(PAR.Date_1_RGT);
  PARAMETER(3);

  // Call program CLC Add/Sub Any Date   XF.
  CALL PROGRAM(CLC Add/Sub Any Date   XF) ('PDX8XFR');
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(PAR.Date_2_RGT);
  PARAMETER(4);

  ENDIF;

  //?If Friday, calculate next Tuesday's date
  CASE;

  // IF DB1.Day of Week is Friday
  IF DB1.Day_of_Week = '6';

  // Call program CLC Add/Sub Any Date   XF.
  CALL PROGRAM(CLC Add/Sub Any Date   XF) ('PDX8XFR');
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(PAR.Date_0_RGT);
  PARAMETER(4);

  ENDIF;

  //?If saturday,calc next Tuesday's date
  CASE;

  // IF DB1.Day of Week is Saturday
  IF DB1.Day_of_Week = '7';

  // Call program CLC Add/Sub Any Date   XF.
  CALL PROGRAM(CLC Add/Sub Any Date   XF) ('PDX8XFR');
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(PAR.Date_0_RGT);
  PARAMETER(3);

  ENDIF;

  //?If sunday,  calc next Tuesday's date
  CASE;

  // IF DB1.Day of Week is Sunday
  IF DB1.Day_of_Week = '1';

  // Call program CLC Add/Sub Any Date   XF.
  CALL PROGRAM(CLC Add/Sub Any Date   XF) ('PDX8XFR');
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(PAR.Date_0_RGT);
  PARAMETER(2);

  ENDIF;

 }

}


