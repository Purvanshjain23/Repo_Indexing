     H/TITLE Exc Upd EDI 944 Trsn   XF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 11/19/24  Time  : 17:34:22
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FECP065L2  IF   E           K DISK
      * RSQ : EDI WHS Stock Txf ADV HDR Surrogate/Unprocessed
      *
     FOPBFCPLO  IF   E           K DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FECP069L1  IF   E           K DISK
      * RTV : EDI WHS Stock Txf ADV NME Retrieval index
      *
     FCAEOREL1  IF   E           K DISK
      * RTV : Company Customer          Retrieval index
      *
     FPNG0REL1  IF   E           K DISK
      * RTV : EDI WHS Interchange       Retrieval index
      *
     FECP067L1  IF   E           K DISK
      * RTV : EDI WHS Stock Txf ADV MAN Retrieval index
      *
     FECP166L1  IF   E           K DISK
      * RTV : EDI WHS Stock Txf ADV REF Retrieval index
      *
     FECP066L1  IF   E           K DISK
      * RTV : EDI WHS Stock Txf ADV DTL Retrieval index
      *
     FPMAMREL1  IF   E           K DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FCAAFREL1  IF   E           K DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FCABZREL1  IF   E           K DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPMAMREL0  UF A E           K DISK
      * UPD : Order Header Extension    Update index
      *
     FPUAOCPL0  IF A E           K DISK
      * UPD : Manifest Detail EDI Rcpt  Update index
      *
     FECP065L0  UF   E           K DISK
      * UPD : EDI WHS Stock Txf ADV HDR Update index
      *
      * Long constants
     D @CN#            S              6    DIM(03)CTDATA PERRCD(1)
     D @CN             S             25    DIM(03) ALT(@CN#)
     D YDOW            S              1     DIM(7)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      /EJECT
     D XDINT           DS
      * Internal date
     D  XDINDT                 1      7  0
     D  XDINYY                 1      3  0
     D  XDINMM                 4      5  0
     D  XDINDD                 6      7  0
      /EJECT
     D XD2T            DS
      * Internal date
     D  XDINT2                 1      7  0
     D  XDINY2                 1      3  0
     D  XDINM2                 4      5  0
     D  XDIND2                 6      7  0
     D QPMAM1        E DS                  EXTNAME(PMAMREL0)
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     D  WJAIC3       E                     EXTFLD(AMAIC3)
     D  WJC4NB       E                     EXTFLD(AMC4NB)
     D  WJRMNB       E                     EXTFLD(AMRMNB)
     D  WJRUNB       E                     EXTFLD(AMRUNB)
     D  WJXACD       E                     EXTFLD(AMXACD)
     D  WJOANA       E                     EXTFLD(AMOANA)
     D  WJHBAA       E                     EXTFLD(AMHBAA)
     D  WJJ0T1       E                     EXTFLD(AMJ0T1)
     D  WJGENY       E                     EXTFLD(AMGENY)
     D  WJJ1T1       E                     EXTFLD(AMJ1T1)
     D  WJHCAA       E                     EXTFLD(AMHCAA)
     D  WJQWDT       E                     EXTFLD(AMQWDT)
     D  WJQXDT       E                     EXTFLD(AMQXDT)
     D  WJQYDT       E                     EXTFLD(AMQYDT)
     D  WJHDAA       E                     EXTFLD(AMHDAA)
     D  WJCCTX       E                     EXTFLD(AMCCTX)
     D  WJJ2T1       E                     EXTFLD(AMJ2T1)
     D  WJRLNA       E                     EXTFLD(AMRLNA)
     D  WJRMNA       E                     EXTFLD(AMRMNA)
     D  WJGINY       E                     EXTFLD(AMGINY)
     D  WJGFNY       E                     EXTFLD(AMGFNY)
     D  WJGGNY       E                     EXTFLD(AMGGNY)
     D  WJGHNY       E                     EXTFLD(AMGHNY)
     D  WJHEVL       E                     EXTFLD(AMHEVL)
     D  WJHFVL       E                     EXTFLD(AMHFVL)
     D  WJHGVL       E                     EXTFLD(AMHGVL)
     D  WJQZDT       E                     EXTFLD(AMQZDT)
     D  WJQ0DT       E                     EXTFLD(AMQ0DT)
     D  WJQ1DT       E                     EXTFLD(AMQ1DT)
     D  WJQ2DT       E                     EXTFLD(AMQ2DT)
     D  WJC2TX       E                     EXTFLD(AMC2TX)
     D  WJC3TX       E                     EXTFLD(AMC3TX)
     D  WJC6TX       E                     EXTFLD(AMC6TX)
     D  WJCHTX       E                     EXTFLD(AMCHTX)
     D  WJCITX       E                     EXTFLD(AMCITX)
     D  WJCLTX       E                     EXTFLD(AMCLTX)
     D  WJB4TX       E                     EXTFLD(AMB4TX)
     D  WJCUTX       E                     EXTFLD(AMCUTX)
     D  WJCVTX       E                     EXTFLD(AMCVTX)
     D  WJB9TX       E                     EXTFLD(AMB9TX)
     D  WJJWSC       E                     EXTFLD(AMJWSC)
     D  WJITNY       E                     EXTFLD(AMITNY)
     D  WJLMT1       E                     EXTFLD(AMLMT1)
     D  WJLWAA       E                     EXTFLD(AMLWAA)
     D  WJFVST       E                     EXTFLD(AMFVST)
     D  WJF0ST       E                     EXTFLD(AMF0ST)
     D  WJF2ST       E                     EXTFLD(AMF2ST)
     D  WJF3ST       E                     EXTFLD(AMF3ST)
     D  WJJUSC       E                     EXTFLD(AMJUSC)
     D  WJJVSC       E                     EXTFLD(AMJVSC)
     D  WJV3T1       E                     EXTFLD(AMV3T1)
     D  WJV4T1       E                     EXTFLD(AMV4T1)
     D  WJV5T1       E                     EXTFLD(AMV5T1)
     D  WJV6T1       E                     EXTFLD(AMV6T1)
     D  WJV7T1       E                     EXTFLD(AMV7T1)
     D  WJV8T1       E                     EXTFLD(AMV8T1)
     D  WJV9T1       E                     EXTFLD(AMV9T1)
     D  WJWAT1       E                     EXTFLD(AMWAT1)
     D  WJWBT1       E                     EXTFLD(AMWBT1)
     D  WJWCT1       E                     EXTFLD(AMWCT1)
     D  WJWDT1       E                     EXTFLD(AMWDT1)
     D  WJQJNY       E                     EXTFLD(AMQJNY)
     D  WJQKNY       E                     EXTFLD(AMQKNY)
     D  WJQLNY       E                     EXTFLD(AMQLNY)
     D  WJP8NY       E                     EXTFLD(AMP8NY)
     D  WJP9NY       E                     EXTFLD(AMP9NY)
     D  WJQANY       E                     EXTFLD(AMQANY)
     D  WJQCNY       E                     EXTFLD(AMQCNY)
     D  WJQDNY       E                     EXTFLD(AMQDNY)
     D  WJQENY       E                     EXTFLD(AMQENY)
     D  WJQFNY       E                     EXTFLD(AMQFNY)
     D  WJQGNY       E                     EXTFLD(AMQGNY)
     D  WJQHNY       E                     EXTFLD(AMQHNY)
     D  WJQINY       E                     EXTFLD(AMQINY)
     D  WJQMNY       E                     EXTFLD(AMQMNY)
     D  WJMYU1       E                     EXTFLD(AMMYU1)
     D  WJJXSC       E                     EXTFLD(AMJXSC)
     D  WJJYSC       E                     EXTFLD(AMJYSC)
     D  WJJZSC       E                     EXTFLD(AMJZSC)
     D  WJJ0SC       E                     EXTFLD(AMJ0SC)
     D  WJMZU1       E                     EXTFLD(AMMZU1)
     D  WJM0U1       E                     EXTFLD(AMM0U1)
     D  WJM1U1       E                     EXTFLD(AMM1U1)
     D  WJM2U1       E                     EXTFLD(AMM2U1)
     D  WJM3U1       E                     EXTFLD(AMM3U1)
     D  WJW5DT       E                     EXTFLD(AMW5DT)
     D  WJW6DT       E                     EXTFLD(AMW6DT)
     D  WJUVST       E                     EXTFLD(AMUVST)
     D  WJUWST       E                     EXTFLD(AMUWST)
     D  WJUXST       E                     EXTFLD(AMUXST)
     D  WJVSST       E                     EXTFLD(AMVSST)
     D  WJAATM       E                     EXTFLD(AMAATM)
     D  WJAYNA       E                     EXTFLD(AMAYNA)
     D  WJA0NA       E                     EXTFLD(AMA0NA)
     D  WJAXDT       E                     EXTFLD(AMAXDT)
      *
     D YARDCS          DS           894
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D QPUAO1        E DS                  EXTNAME(PUAOCPL0)
      * UPD : Manifest Detail EDI Rcpt  Update index
      * Renamed input format fields
     D  WKAIC3       E                     EXTFLD(AOAIC3)
     D  WKC4NB       E                     EXTFLD(AOC4NB)
     D  WKT4NY       E                     EXTFLD(AOT4NY)
     D  WKAXNZ       E                     EXTFLD(AOAXNZ)
     D  WKA1NZ       E                     EXTFLD(AOA1NZ)
     D  WKRMNB       E                     EXTFLD(AORMNB)
     D  WKHGCD       E                     EXTFLD(AOHGCD)
     D  WKH7NY       E                     EXTFLD(AOH7NY)
     D  WKPFNX       E                     EXTFLD(AOPFNX)
     D  WKSIQT       E                     EXTFLD(AOSIQT)
     D  WKP5WG       E                     EXTFLD(AOP5WG)
     D  WKWDAA       E                     EXTFLD(AOWDAA)
     D  WKHMU1       E                     EXTFLD(AOHMU1)
     D  WKWBAA       E                     EXTFLD(AOWBAA)
     D  WKWCAA       E                     EXTFLD(AOWCAA)
     D  WKPMST       E                     EXTFLD(AOPMST)
     D  WKWSDT       E                     EXTFLD(AOWSDT)
     D  WKEETM       E                     EXTFLD(AOEETM)
     D  WKE1SC       E                     EXTFLD(AOE1SC)
     D  WKGVSC       E                     EXTFLD(AOGVSC)
     D  WKWTDT       E                     EXTFLD(AOWTDT)
     D  WKCHNZ       E                     EXTFLD(AOCHNZ)
     D  WKSKQT       E                     EXTFLD(AOSKQT)
     D  WKIDU1       E                     EXTFLD(AOIDU1)
     D  WKAATM       E                     EXTFLD(AOAATM)
     D  WKAYNA       E                     EXTFLD(AOAYNA)
     D  WKA0NA       E                     EXTFLD(AOA0NA)
     D  WKAXDT       E                     EXTFLD(AOAXDT)
      *
     D QECP01        E DS                  EXTNAME(ECP065L0)
      * UPD : EDI WHS Stock Txf ADV HDR Update index
      * Renamed input format fields
     D  WOH9NY       E                     EXTFLD(AIH9NY)
     D  WOHPAA       E                     EXTFLD(AIHPAA)
     D  WOA0ST       E                     EXTFLD(AIA0ST)
     D  WOETSC       E                     EXTFLD(AIETSC)
     D  WOAUNZ       E                     EXTFLD(AIAUNZ)
     D  WOHCU1       E                     EXTFLD(AIHCU1)
     D  WOAVNZ       E                     EXTFLD(AIAVNZ)
     D  WOAWNZ       E                     EXTFLD(AIAWNZ)
     D  WOEUSC       E                     EXTFLD(AIEUSC)
     D  WOHEU1       E                     EXTFLD(AIHEU1)
     D  WOHDU1       E                     EXTFLD(AIHDU1)
     D  WOV6AA       E                     EXTFLD(AIV6AA)
     D  WOWPDT       E                     EXTFLD(AIWPDT)
     D  WOEWSC       E                     EXTFLD(AIEWSC)
     D  WOV8AA       E                     EXTFLD(AIV8AA)
     D  WOV7AA       E                     EXTFLD(AIV7AA)
     D  WOWQDT       E                     EXTFLD(AIWQDT)
     D  WOEXSC       E                     EXTFLD(AIEXSC)
     D  WOEYSC       E                     EXTFLD(AIEYSC)
     D  WOHKU1       E                     EXTFLD(AIHKU1)
     D  WOV9AA       E                     EXTFLD(AIV9AA)
     D  WOWRDT       E                     EXTFLD(AIWRDT)
     D  WOEZSC       E                     EXTFLD(AIEZSC)
     D  WOE0SC       E                     EXTFLD(AIE0SC)
     D  WOHLU1       E                     EXTFLD(AIHLU1)
     D  WOWAAA       E                     EXTFLD(AIWAAA)
     D  WOA0NZ       E                     EXTFLD(AIA0NZ)
      *
     D YBRDCS          DS           199
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  W0CLPG         S             10
     D  YL0001         S              1
     D  WN0001         S              1
     D  WN0002         S              5
     D  WN0003         S              1
     D  YL0002         S              7  0
     D  YL0003         S              1
     D  YL0004         S              3  0
     D  YL0005         S              2
     D  YL0006         S              7  0
     D  YL0007         S              7  0
     D  YL0008         S              1
     D  YL0009         S              7  0
     D  WQSB01         S                   LIKE(WBC4NB)
     D  Y0CX01         S              1
     D  YL0010         S              8  0
     D  YL0011         S              7  0
     D  YL0012         S              7  0
     D  XDWK1          S              8  0
     D  XDAY1          S              6  0
     D  XDAY2          S              6  0
     D  XDURR          S              8  0
     D  XDSEL          S              1
     D  XDCDW          S              7
     D  XDWSL          S              1  0
     D  XDSTP          S              1  0
     D  XDWNB          S              6  0
     D  XDLSW          S              1  0
     D  YY             S              6  0
     D  XDWK3          S              7  1
     D  XDWK2          S              6  0
     D  YL0013         S              1
     D  WN0004         S             20
     D  WQSC01         S                   LIKE(WCH9NY)
     D  Y0CX02         S              1
     D  YL0014         S             20
     D  YL0015         S              3
     D  WL0001         S              3  0
     D  WL0002         S              7  0
     D  WL0003         S              3
     D  YN0001         S              3
     D  YN0002         S              6
     D  YN0003         S              1
     D  YN0004         S              7  0
     D  YN0005         S              6  0
     D  YN0006         S             10
     D  YN0007         S             10
     D  YN0008         S              7  0
     D  YN0009         S              6  0
     D  YN0010         S             10
     D  YN0011         S             10
     D  WQSF01         S                   LIKE(WFH9NY)
     D  YL0016         S              9
     D  YL0017         S              1
     D  WQSG01         S                   LIKE(WGH9NY)
     D  YL0018         S              8
     D  YL0019         S              1
     D  YL0020         S              1
     D  WQSH01         S                   LIKE(WHH9NY)
     D  WQSI01         S                   LIKE(WFH9NY)
     D  WQSJ01         S                   LIKE(WHH9NY)
     D  YL0021         S              7
     D  YL0022         S              5
     D  YL0023         S              1
     D  YL0024         S              5  0
     D  YL0025         S              7  0
     D  YL0026         S              6
     D  WN0005         S              5  0
     D  WN0006         S              3
     D  WN0007         S             20
     D  WN0008         S             25
     D  WN0009         S             30
     D  WN0010         S             15
     D  WN0011         S             15
     D  WN0012         S             20
     D  WN0013         S              7  0
     D  WN0014         S              7  0
     D  WN0015         S              7  0
     D  WN0016         S              3
     D  WN0017         S              1
     D  WN0018         S             12
     D  WN0019         S             35
     D  WN0020         S             75
     D  WN0021         S             11  0
     D  WN0022         S             11  0
     D  WN0023         S             11  0
     D  WN0024         S             11  0
     D  WN0025         S             11  2
     D  WN0026         S             11  2
     D  WN0027         S             11  2
     D  WN0028         S              7  0
     D  WN0029         S              7  0
     D  WN0030         S              7  0
     D  WN0031         S              4
     D  WN0032         S              4
     D  WN0033         S              4
     D  WN0034         S              2
     D  WN0035         S              2
     D  WN0036         S              2
     D  WN0037         S              3
     D  WN0038         S              3
     D  WN0039         S              3
     D  WN0040         S              5
     D  WN0041         S              5  0
     D  WN0042         S             38
     D  WN0043         S              6
     D  WN0044         S              6
     D  WN0045         S              6
     D  WN0046         S              6
     D  WN0047         S              1
     D  WN0048         S              1
     D  WN0049         S             10
     D  WN0050         S             10
     D  WN0051         S             10
     D  WN0052         S             15
     D  WN0053         S             15
     D  WN0054         S             15
     D  WN0055         S             30
     D  WN0056         S             30
     D  WN0057         S             30
     D  WN0058         S             50
     D  WN0059         S             50
     D  WN0060         S              3  0
     D  WN0061         S              3  0
     D  WN0062         S              3  0
     D  WN0063         S              5  2
     D  WN0064         S              5  2
     D  WN0065         S              5  0
     D  WN0066         S              6  0
     D  WN0067         S              6  0
     D  WN0068         S              6  0
     D  WN0069         S              6  0
     D  WN0070         S              9  0
     D  WN0071         S              9  0
     D  WN0072         S              9  0
     D  WN0073         S              9  6
     D  WN0074         S             15
     D  WN0075         S              1
     D  WN0076         S              1
     D  WN0077         S              2
     D  WN0078         S              2
     D  WN0079         S              5
     D  WN0080         S              5
     D  WN0081         S             15
     D  WN0082         S             15
     D  WN0083         S             30
     D  WN0084         S              7  0
     D  WN0085         S              7  0
     D  WN0086         S              1
     D  WN0087         S              1
     D  WN0088         S              1
     D  WN0089         S              1
     D  WN0090         S              6  0
     D  WN0091         S             10
     D  WN0092         S             10
     D  WN0093         S              7  0
     D  ZADFMF         S             10
     D  WN0094         S              7  0
     D  WN0095         S              5  0
     D  WN0096         S              3
     D  WN0097         S             20
     D  WN0098         S             25
     D  WN0099         S             30
     D  WN0100         S             15
     D  WN0101         S             15
     D  WN0102         S             20
     D  WN0103         S              7  0
     D  WN0104         S              7  0
     D  WN0105         S              7  0
     D  WN0106         S              3
     D  WN0107         S              1
     D  WN0108         S             12
     D  WN0109         S             35
     D  WN0110         S             75
     D  WN0111         S             11  0
     D  WN0112         S             11  0
     D  WN0113         S             11  0
     D  WN0114         S             11  0
     D  WN0115         S             11  2
     D  WN0116         S             11  2
     D  WN0117         S             11  2
     D  WN0118         S              7  0
     D  WN0119         S              7  0
     D  WN0120         S              7  0
     D  WN0121         S              7  0
     D  WN0122         S              4
     D  WN0123         S              4
     D  WN0124         S              4
     D  WN0125         S              2
     D  WN0126         S              2
     D  WN0127         S              2
     D  WN0128         S              3
     D  WN0129         S              3
     D  WN0130         S              3
     D  WN0131         S              5
     D  WN0132         S              5  0
     D  WN0133         S             38
     D  WN0134         S              6
     D  WN0135         S              6
     D  WN0136         S              6
     D  WN0137         S              6
     D  WN0138         S              1
     D  WN0139         S              1
     D  WN0140         S             10
     D  WN0141         S             10
     D  WN0142         S             10
     D  WN0143         S             15
     D  WN0144         S             15
     D  WN0145         S             15
     D  WN0146         S             30
     D  WN0147         S             30
     D  WN0148         S             30
     D  WN0149         S             50
     D  WN0150         S             50
     D  WN0151         S              3  0
     D  WN0152         S              3  0
     D  WN0153         S              3  0
     D  WN0154         S              5  2
     D  WN0155         S              5  2
     D  WN0156         S              5  0
     D  WN0157         S              6  0
     D  WN0158         S              6  0
     D  WN0159         S              6  0
     D  WN0160         S              6  0
     D  WN0161         S              9  0
     D  WN0162         S              9  0
     D  WN0163         S              9  0
     D  WN0164         S              9  6
     D  WN0165         S             15
     D  WN0166         S              1
     D  WN0167         S              1
     D  WN0168         S              2
     D  WN0169         S              2
     D  WN0170         S              5
     D  WN0171         S              5
     D  WN0172         S             15
     D  WN0173         S             15
     D  WN0174         S             30
     D  WN0175         S              7  0
     D  WN0176         S              7  0
     D  WN0177         S              1
     D  WN0178         S              1
     D  WN0179         S              1
     D  WN0180         S              1
     D  WN0181         S              6  0
     D  WN0182         S             10
     D  WN0183         S             10
     D  WN0184         S              7  0
     D  YARDC          S              1
     D  WQSN01         S                   LIKE(WFH9NY)
     D  WQSO01         S                   LIKE(WHH9NY)
     D  WQSO02         S                   LIKE(WHT4NY)
     D  YL0027         S              7  0
     D  WQSP01         S                   LIKE(WGH9NY)
     D  WQSP02         S                   LIKE(WGT4NY)
     D  WQSP03         S                   LIKE(WGAXNZ)
     D  YL0028         S              9
     D  YL0029         S              9  0
     D  YL0030         S              7
     D  YL0031         S              7  0
     D  YL0032         S              8
     D  YL0033         S              8  0
     D  YL0034         S              8  0
     D  YL0035         S              7  0
     D  WL0004         S              3  0
     D  WL0005         S              7  0
     D  WL0006         S              5  0
     D  WL0007         S              5  0
     D  WL0008         S              5  0
     D  WL0009         S              7  0
     D  WL0010         S              7  0
     D  WL0011         S              9  0
     D  WL0012         S              8  0
     D  WL0013         S              5  0
     D  WL0014         S             11  2
     D  WL0015         S              2
     D  WL0016         S             12
     D  WL0017         S              2
     D  WL0018         S              2
     D  WL0019         S              1
     D  WL0020         S              7  0
     D  WL0021         S              6  0
     D  WL0022         S              2
     D  WL0023         S              1
     D  WL0024         S              7  0
     D  WL0025         S              7  0
     D  WL0026         S             11  2
     D  WL0027         S             25
     D  WN0185         S              6  0
     D  WN0186         S             10
     D  WN0187         S             10
     D  WN0188         S              7  0
     D  YL0036         S              7  0
     D  YL0037         S              9
     D  YL0038         S              9  0
     D  YL0039         S              5
     D  YL0040         S              5  0
     D  YL0041         S              7  0
     D  YL0042         S              6
     D  YL0043         S              1
     D  YL0044         S              4
     D  ZQ             S              5  0
     D  YL0045         S              2
     D  YL0046         S              7
     D  YL0047         S              7  0
     D  YL0048         S              2
     D  YL0049         S             11  2
     D  YL0050         S             11  2
     D  YL0051         S              8  0
     D  YL0052         S              3
     D  YL0053         S              1
     D  WQ0001         S              3  0
     D  WQ0002         S              7  0
     D  WQ0003         S              9  0
     D  WQ0004         S             10
     D  WQ0005         S              1
     D  YBRDC          S              1
     D  WQ0006         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  YRSW00         S              5  0
     D  YRSW01         S              5  0
     D  W0PMT          S              1
     D digits          C                   '0123456789'
     D len             S              3  0
     D                 DS
     D  ZAMSDA                 1    132
     I@P065A6
      * EDI WHS Stock Txf ADV HDR Surrogate/Unprocessed
      * Renamed input format fields
     I              AIH9NY                      WAH9NY
     I              AIHPAA                      WAHPAA
     I              AIA0ST                      WAA0ST
     I              AIETSC                      WAETSC
     I              AIAUNZ                      WAAUNZ
     I              AIHCU1                      WAHCU1
     I              AIAVNZ                      WAAVNZ
     I              AIAWNZ                      WAAWNZ
     I              AIEUSC                      WAEUSC
     I              AIHEU1                      WAHEU1
     I              AIHDU1                      WAHDU1
     I              AIV6AA                      WAV6AA
     I              AIWPDT                      WAWPDT
     I              AIEWSC                      WAEWSC
     I              AIV8AA                      WAV8AA
     I              AIV7AA                      WAV7AA
     I              AIWQDT                      WAWQDT
     I              AIEXSC                      WAEXSC
     I              AIEYSC                      WAEYSC
     I              AIHKU1                      WAHKU1
     I              AIV9AA                      WAV9AA
     I              AIWRDT                      WAWRDT
     I              AIEZSC                      WAEZSC
     I              AIE0SC                      WAE0SC
     I              AIHLU1                      WAHLU1
     I              AIWAAA                      WAWAAA
     I              AIA0NZ                      WAA0NZ
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                      WBAIC3
     I              BEC4NB                      WBC4NB
     I              BEJNCD                      WBJNCD
     I              BEANC7                      WBANC7
     I              BEBKC7                      WBBKC7
     I              BEBRTX                      WBBRTX
     I              BEHMNA                      WBHMNA
     I              BEHONA                      WBHONA
     I              BEHPNA                      WBHPNA
     I              BEHNNA                      WBHNNA
     I              BEDBCD                      WBDBCD
     I              BECKTX                      WBCKTX
     I              BEB0C7                      WBB0C7
     I              BEAETX                      WBAETX
     I              BEB1NA                      WBB1NA
     I              BEB3NA                      WBB3NA
     I              BEB4NA                      WBB4NA
     I              BEB2NA                      WBB2NA
     I              BEBHCD                      WBBHCD
     I              BEC8TX                      WBC8TX
     I              BEBCNA                      WBBCNA
     I              BEA0DT                      WBA0DT
     I              BEA5DT                      WBA5DT
     I              BEGNDT                      WBGNDT
     I              BEACDT                      WBACDT
     I              BEAQCD                      WBAQCD
     I              BEB6NA                      WBB6NA
     I              BEBYNA                      WBBYNA
     I              BEBZNA                      WBBZNA
     I              BEGTST                      WBGTST
     I              BEGVST                      WBGVST
     I              BEGUST                      WBGUST
     I              BEQFST                      WBQFST
     I              BECQCD                      WBCQCD
     I              BEGJST                      WBGJST
     I              BEGWST                      WBGWST
     I              BEGXST                      WBGXST
     I              BEGYST                      WBGYST
     I              BEAODT                      WBAODT
     I              BEAIVN                      WBAIVN
     I              BECXDT                      WBCXDT
     I              BEJZVA                      WBJZVA
     I              BEA1WG                      WBA1WG
     I              BEXIST                      WBXIST
     I              BEXJST                      WBXJST
     I              BEXKST                      WBXKST
     I              BEEIDT                      WBEIDT
     I              BEAFTM                      WBAFTM
     I              BEE8CD                      WBE8CD
     I              BEE9CD                      WBE9CD
     I              BERMNB                      WBRMNB
     I              BETBNB                      WBTBNB
     I              BER1NB                      WBR1NB
     I              BEPJST                      WBPJST
     I              BEU0ST                      WBU0ST
     I              BEU1ST                      WBU1ST
     I              BEQ2CD                      WBQ2CD
     I              BEU2ST                      WBU2ST
     I              BEVEST                      WBVEST
     I              BEVFST                      WBVFST
     I              BEVGST                      WBVGST
     I              BERPCD                      WBRPCD
     I              BERNNB                      WBRNNB
     I              BEVDST                      WBVDST
     I              BEATIN                      WBATIN
     I              BEU4ST                      WBU4ST
     I              BEU5ST                      WBU5ST
     I              BERSRN                      WBRSRN
     I              BEMHNA                      WBMHNA
     I              BEMINA                      WBMINA
     I              BEWBST                      WBWBST
     I              BER4CD                      WBR4CD
     I              BEBFCD                      WBBFCD
     I              BEQ4CD                      WBQ4CD
     I              BET3NB                      WBT3NB
     I              BESICD                      WBSICD
     I              BECONB                      WBCONB
     I              BECEST                      WBCEST
     I              BEAWDT                      WBAWDT
     I              BEJPCD                      WBJPCD
     I              BEXUST                      WBXUST
     I              BEZ1ST                      WBZ1ST
     I              BEVRVA                      WBVRVA
     I              BEOBST                      WBOBST
     I              BEBCST                      WBBCST
     I              BEBDST                      WBBDST
     I              BEB7VL                      WBB7VL
     I              BEGASX                      WBGASX
     I              BEGBSX                      WBGBSX
     I              BEGCSX                      WBGCSX
     I              BEGDSX                      WBGDSX
     I              BEFNSX                      WBFNSX
     I              BEFOSX                      WBFOSX
     I              BEFPSX                      WBFPSX
     I              BEFQSX                      WBFQSX
     I              BEFRSX                      WBFRSX
     I              BEFSSX                      WBFSSX
     I              BEFTSX                      WBFTSX
     I              BEFUSX                      WBFUSX
     I              BEFVSX                      WBFVSX
     I              BEFWSX                      WBFWSX
     I              BEFXSX                      WBFXSX
     I              BEFYSX                      WBFYSX
     I              BENODT                      WBNODT
     I              BENPDT                      WBNPDT
     I              BENQDT                      WBNQDT
     I              BENRDT                      WBNRDT
     I              BENSDT                      WBNSDT
     I              BEBPTM                      WBBPTM
     I              BEBQTM                      WBBQTM
     I              BEBRTM                      WBBRTM
     I              BEBSTM                      WBBSTM
     I              BEBTTM                      WBBTTM
     I              BEH0NX                      WBH0NX
     I              BEH1NX                      WBH1NX
     I              BEH2NX                      WBH2NX
     I              BEH3NX                      WBH3NX
     I              BEH4NX                      WBH4NX
     I              BEC0C7                      WBC0C7
     I              BEUVST                      WBUVST
     I              BEUWST                      WBUWST
     I              BEUXST                      WBUXST
     I              BEAATM                      WBAATM
     I              BEAYNA                      WBAYNA
     I              BEA0NA                      WBA0NA
     I              BEAXDT                      WBAXDT
      *
     I@ANCPAZ
      * EDI WHS Stock Txf ADV NME Retrieval index
      * Renamed input format fields
     I              ANH9NY                      WCH9NY
     I              ANTYPC                      WCTYPC
     I              ANAMEX                      WCAMEX
     I              ANDCDQ                      WCDCDQ
     I              ANDCDE                      WCDCDE
     I              ANAME1                      WCAME1
     I              ANAME2                      WCAME2
     I              ANDD1X                      WCDD1X
     I              ANDD2X                      WCDD2X
     I              ANITYX                      WCITYX
     I              ANTATE                      WCTATE
     I              ANIPXX                      WCIPXX
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                      WDAIC3
     I              EOBKC7                      WDBKC7
     I              EOAQCD                      WDAQCD
     I              EOR4CD                      WDR4CD
     I              EOBYNA                      WDBYNA
     I              EOB6NA                      WDB6NA
     I              EOBZNA                      WDBZNA
     I              EOLLST                      WDLLST
     I              EOPPST                      WDPPST
     I              EOR5NB                      WDR5NB
     I              EOR6NB                      WDR6NB
     I              EOQGST                      WDQGST
     I              EOBOCD                      WDBOCD
     I              EOTBNB                      WDTBNB
     I              EOMTCU                      WDMTCU
     I              EOW2NB                      WDW2NB
     I              EORPCD                      WDRPCD
     I              EOAJCD                      WDAJCD
     I              EOX9ST                      WDX9ST
     I              EOT9CD                      WDT9CD
     I              EOUBCD                      WDUBCD
     I              EOISTX                      WDISTX
     I              EOLQCD                      WDLQCD
     I              EONJNA                      WDNJNA
     I              EOI0TX                      WDI0TX
     I              EONKNA                      WDNKNA
     I              EOI1TX                      WDI1TX
     I              EOVLST                      WDVLST
     I              EORLST                      WDRLST
     I              EOMMTX                      WDMMTX
     I              EOOHNA                      WDOHNA
     I              EOQ6ST                      WDQ6ST
     I              EOQ8ST                      WDQ8ST
     I              EORBST                      WDRBST
     I              EOREST                      WDREST
     I              EOUVST                      WDUVST
     I              EOUWST                      WDUWST
     I              EOUXST                      WDUXST
     I              EOVSST                      WDVSST
     I              EOAATM                      WDAATM
     I              EOAYNA                      WDAYNA
     I              EOA0NA                      WDA0NA
     I              EOAXDT                      WDAXDT
      *
     I@G0REJZ
      * EDI WHS Interchange       Retrieval index
      * Renamed input format fields
     I              G0AJCD                      WEAJCD
     I              G0M4AA                      WEM4AA
     I              G0M7AA                      WEM7AA
     I              G0J5NX                      WEJ5NX
     I              G0X2T1                      WEX2T1
     I              G0JBSC                      WEJBSC
     I              G0JCSC                      WEJCSC
     I              G0JDSC                      WEJDSC
     I              G0JESC                      WEJESC
     I              G0QGU1                      WEQGU1
     I              G0F5NZ                      WEF5NZ
     I              G0LSSC                      WELSSC
     I              G0LTSC                      WELTSC
     I              G0AHAB                      WEAHAB
     I              G0F6NZ                      WEF6NZ
     I              G0VSST                      WEVSST
     I              G0MJDT                      WEMJDT
     I              G0BETM                      WEBETM
     I              G0CCVN                      WECCVN
     I              G0CDVN                      WECDVN
     I              G0MKDT                      WEMKDT
     I              G0BFTM                      WEBFTM
     I              G0CEVN                      WECEVN
     I              G0CFVN                      WECFVN
      *
     I@AKCPAQ
      * EDI WHS Stock Txf ADV MAN Retrieval index
      * Renamed input format fields
     I              AKH9NY                      WFH9NY
     I              AKT4NY                      WFT4NY
     I              AKVZAA                      WFVZAA
     I              AKHGU1                      WFHGU1
      *
     I@A0CPCJ
      * EDI WHS Stock Txf ADV REF Retrieval index
      * Renamed input format fields
     I              A0H9NY                      WGH9NY
     I              A0T4NY                      WGT4NY
     I              A0AXNZ                      WGAXNZ
     I              A0A1NZ                      WGA1NZ
     I              A0V3AA                      WGV3AA
     I              A0HIU1                      WGHIU1
     I              A0PXWG                      WGPXWG
     I              A0A4NZ                      WGA4NZ
      *
     I@AJCPAN
      * EDI WHS Stock Txf ADV DTL Retrieval index
      * Renamed input format fields
     I              AJH9NY                      WHH9NY
     I              AJT4NY                      WHT4NY
     I              AJAXNZ                      WHAXNZ
     I              AJSGQT                      WHSGQT
     I              AJVYAA                      WHVYAA
     I              AJEVSC                      WHEVSC
     I              AJF3C7                      WHF3C7
     I              AJHFU1                      WHHFU1
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                      WIAIC3
     I              AMC4NB                      WIC4NB
     I              AMRMNB                      WIRMNB
     I              AMRUNB                      WIRUNB
     I              AMXACD                      WIXACD
     I              AMOANA                      WIOANA
     I              AMHBAA                      WIHBAA
     I              AMJ0T1                      WIJ0T1
     I              AMGENY                      WIGENY
     I              AMJ1T1                      WIJ1T1
     I              AMHCAA                      WIHCAA
     I              AMQWDT                      WIQWDT
     I              AMQXDT                      WIQXDT
     I              AMQYDT                      WIQYDT
     I              AMHDAA                      WIHDAA
     I              AMCCTX                      WICCTX
     I              AMJ2T1                      WIJ2T1
     I              AMRLNA                      WIRLNA
     I              AMRMNA                      WIRMNA
     I              AMGINY                      WIGINY
     I              AMGFNY                      WIGFNY
     I              AMGGNY                      WIGGNY
     I              AMGHNY                      WIGHNY
     I              AMHEVL                      WIHEVL
     I              AMHFVL                      WIHFVL
     I              AMHGVL                      WIHGVL
     I              AMQZDT                      WIQZDT
     I              AMQ0DT                      WIQ0DT
     I              AMQ1DT                      WIQ1DT
     I              AMQ2DT                      WIQ2DT
     I              AMC2TX                      WIC2TX
     I              AMC3TX                      WIC3TX
     I              AMC6TX                      WIC6TX
     I              AMCHTX                      WICHTX
     I              AMCITX                      WICITX
     I              AMCLTX                      WICLTX
     I              AMB4TX                      WIB4TX
     I              AMCUTX                      WICUTX
     I              AMCVTX                      WICVTX
     I              AMB9TX                      WIB9TX
     I              AMJWSC                      WIJWSC
     I              AMITNY                      WIITNY
     I              AMLMT1                      WILMT1
     I              AMLWAA                      WILWAA
     I              AMFVST                      WIFVST
     I              AMF0ST                      WIF0ST
     I              AMF2ST                      WIF2ST
     I              AMF3ST                      WIF3ST
     I              AMJUSC                      WIJUSC
     I              AMJVSC                      WIJVSC
     I              AMV3T1                      WIV3T1
     I              AMV4T1                      WIV4T1
     I              AMV5T1                      WIV5T1
     I              AMV6T1                      WIV6T1
     I              AMV7T1                      WIV7T1
     I              AMV8T1                      WIV8T1
     I              AMV9T1                      WIV9T1
     I              AMWAT1                      WIWAT1
     I              AMWBT1                      WIWBT1
     I              AMWCT1                      WIWCT1
     I              AMWDT1                      WIWDT1
     I              AMQJNY                      WIQJNY
     I              AMQKNY                      WIQKNY
     I              AMQLNY                      WIQLNY
     I              AMP8NY                      WIP8NY
     I              AMP9NY                      WIP9NY
     I              AMQANY                      WIQANY
     I              AMQCNY                      WIQCNY
     I              AMQDNY                      WIQDNY
     I              AMQENY                      WIQENY
     I              AMQFNY                      WIQFNY
     I              AMQGNY                      WIQGNY
     I              AMQHNY                      WIQHNY
     I              AMQINY                      WIQINY
     I              AMQMNY                      WIQMNY
     I              AMMYU1                      WIMYU1
     I              AMJXSC                      WIJXSC
     I              AMJYSC                      WIJYSC
     I              AMJZSC                      WIJZSC
     I              AMJ0SC                      WIJ0SC
     I              AMMZU1                      WIMZU1
     I              AMM0U1                      WIM0U1
     I              AMM1U1                      WIM1U1
     I              AMM2U1                      WIM2U1
     I              AMM3U1                      WIM3U1
     I              AMW5DT                      WIW5DT
     I              AMW6DT                      WIW6DT
     I              AMUVST                      WIUVST
     I              AMUWST                      WIUWST
     I              AMUXST                      WIUXST
     I              AMVSST                      WIVSST
     I              AMAATM                      WIAATM
     I              AMAYNA                      WIAYNA
     I              AMA0NA                      WIA0NA
     I              AMAXDT                      WIAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                      WJAIC3
     I              AMC4NB                      WJC4NB
     I              AMRMNB                      WJRMNB
     I              AMRUNB                      WJRUNB
     I              AMXACD                      WJXACD
     I              AMOANA                      WJOANA
     I              AMHBAA                      WJHBAA
     I              AMJ0T1                      WJJ0T1
     I              AMGENY                      WJGENY
     I              AMJ1T1                      WJJ1T1
     I              AMHCAA                      WJHCAA
     I              AMQWDT                      WJQWDT
     I              AMQXDT                      WJQXDT
     I              AMQYDT                      WJQYDT
     I              AMHDAA                      WJHDAA
     I              AMCCTX                      WJCCTX
     I              AMJ2T1                      WJJ2T1
     I              AMRLNA                      WJRLNA
     I              AMRMNA                      WJRMNA
     I              AMGINY                      WJGINY
     I              AMGFNY                      WJGFNY
     I              AMGGNY                      WJGGNY
     I              AMGHNY                      WJGHNY
     I              AMHEVL                      WJHEVL
     I              AMHFVL                      WJHFVL
     I              AMHGVL                      WJHGVL
     I              AMQZDT                      WJQZDT
     I              AMQ0DT                      WJQ0DT
     I              AMQ1DT                      WJQ1DT
     I              AMQ2DT                      WJQ2DT
     I              AMC2TX                      WJC2TX
     I              AMC3TX                      WJC3TX
     I              AMC6TX                      WJC6TX
     I              AMCHTX                      WJCHTX
     I              AMCITX                      WJCITX
     I              AMCLTX                      WJCLTX
     I              AMB4TX                      WJB4TX
     I              AMCUTX                      WJCUTX
     I              AMCVTX                      WJCVTX
     I              AMB9TX                      WJB9TX
     I              AMJWSC                      WJJWSC
     I              AMITNY                      WJITNY
     I              AMLMT1                      WJLMT1
     I              AMLWAA                      WJLWAA
     I              AMFVST                      WJFVST
     I              AMF0ST                      WJF0ST
     I              AMF2ST                      WJF2ST
     I              AMF3ST                      WJF3ST
     I              AMJUSC                      WJJUSC
     I              AMJVSC                      WJJVSC
     I              AMV3T1                      WJV3T1
     I              AMV4T1                      WJV4T1
     I              AMV5T1                      WJV5T1
     I              AMV6T1                      WJV6T1
     I              AMV7T1                      WJV7T1
     I              AMV8T1                      WJV8T1
     I              AMV9T1                      WJV9T1
     I              AMWAT1                      WJWAT1
     I              AMWBT1                      WJWBT1
     I              AMWCT1                      WJWCT1
     I              AMWDT1                      WJWDT1
     I              AMQJNY                      WJQJNY
     I              AMQKNY                      WJQKNY
     I              AMQLNY                      WJQLNY
     I              AMP8NY                      WJP8NY
     I              AMP9NY                      WJP9NY
     I              AMQANY                      WJQANY
     I              AMQCNY                      WJQCNY
     I              AMQDNY                      WJQDNY
     I              AMQENY                      WJQENY
     I              AMQFNY                      WJQFNY
     I              AMQGNY                      WJQGNY
     I              AMQHNY                      WJQHNY
     I              AMQINY                      WJQINY
     I              AMQMNY                      WJQMNY
     I              AMMYU1                      WJMYU1
     I              AMJXSC                      WJJXSC
     I              AMJYSC                      WJJYSC
     I              AMJZSC                      WJJZSC
     I              AMJ0SC                      WJJ0SC
     I              AMMZU1                      WJMZU1
     I              AMM0U1                      WJM0U1
     I              AMM1U1                      WJM1U1
     I              AMM2U1                      WJM2U1
     I              AMM3U1                      WJM3U1
     I              AMW5DT                      WJW5DT
     I              AMW6DT                      WJW6DT
     I              AMUVST                      WJUVST
     I              AMUWST                      WJUWST
     I              AMUXST                      WJUXST
     I              AMVSST                      WJVSST
     I              AMAATM                      WJAATM
     I              AMAYNA                      WJAYNA
     I              AMA0NA                      WJA0NA
     I              AMAXDT                      WJAXDT
      *
     I@AOCPA2
      * Manifest Detail EDI Rcpt  Update index
      * Renamed input format fields
     I              AOAIC3                      WKAIC3
     I              AOC4NB                      WKC4NB
     I              AOT4NY                      WKT4NY
     I              AOAXNZ                      WKAXNZ
     I              AOA1NZ                      WKA1NZ
     I              AORMNB                      WKRMNB
     I              AOHGCD                      WKHGCD
     I              AOH7NY                      WKH7NY
     I              AOPFNX                      WKPFNX
     I              AOSIQT                      WKSIQT
     I              AOP5WG                      WKP5WG
     I              AOWDAA                      WKWDAA
     I              AOHMU1                      WKHMU1
     I              AOWBAA                      WKWBAA
     I              AOWCAA                      WKWCAA
     I              AOPMST                      WKPMST
     I              AOWSDT                      WKWSDT
     I              AOEETM                      WKEETM
     I              AOE1SC                      WKE1SC
     I              AOGVSC                      WKGVSC
     I              AOWTDT                      WKWTDT
     I              AOCHNZ                      WKCHNZ
     I              AOSKQT                      WKSKQT
     I              AOIDU1                      WKIDU1
     I              AOAATM                      WKAATM
     I              AOAYNA                      WKAYNA
     I              AOA0NA                      WKA0NA
     I              AOAXDT                      WKAXDT
      *
     I@AFREBE
      * Calendar Master           Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                      WLAIC3
     I              AFBCDT                      WLBCDT
     I              AFCQNB                      WLCQNB
     I              AFESNB                      WLESNB
     I              AFETNB                      WLETNB
     I              AFBZNB                      WLBZNB
     I              AFA9ST                      WLA9ST
     I              AFEINB                      WLEINB
     I              AFC5ST                      WLC5ST
     I              AFAQNB                      WLAQNB
     I              AFCMST                      WLCMST
     I              AFV9ST                      WLV9ST
     I              AFWAST                      WLWAST
     I              AFX2ST                      WLX2ST
     I              AFOJDT                      WLOJDT
     I              AFNQNX                      WLNQNX
     I              AFNRNX                      WLNRNX
     I              AFI9SX                      WLI9SX
     I              AFJASX                      WLJASX
     I              AFOKDT                      WLOKDT
     I              AFOLDT                      WLOLDT
     I              AFUVST                      WLUVST
     I              AFUWST                      WLUWST
     I              AFUXST                      WLUXST
     I              AFAATM                      WLAATM
     I              AFAYNA                      WLAYNA
     I              AFA0NA                      WLA0NA
     I              AFAXDT                      WLAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                      WMAIC3
     I              BZHGCD                      WMHGCD
     I              BZAVNA                      WMAVNA
     I              BZAWNA                      WMAWNA
     I              BZL7NA                      WML7NA
     I              BZL8NA                      WML8NA
     I              BZL6NA                      WML6NA
     I              BZMFNA                      WMMFNA
     I              BZADCD                      WMADCD
     I              BZAWPC                      WMAWPC
     I              BZLXST                      WMLXST
     I              BZAECD                      WMAECD
     I              BZAXPC                      WMAXPC
     I              BZLYST                      WMLYST
     I              BZAFCD                      WMAFCD
     I              BZAICD                      WMAICD
     I              BZAIWG                      WMAIWG
     I              BZHICD                      WMHICD
     I              BZRBCD                      WMRBCD
     I              BZFZST                      WMFZST
     I              BZAVST                      WMAVST
     I              BZCZWG                      WMCZWG
     I              BZC0WG                      WMC0WG
     I              BZURTN                      WMURTN
     I              BZAJC8                      WMAJC8
     I              BZRINB                      WMRINB
     I              BZRHNB                      WMRHNB
     I              BZRGNB                      WMRGNB
     I              BZLNCD                      WMLNCD
     I              BZTFNB                      WMTFNB
     I              BZN0CD                      WMN0CD
     I              BZX4ST                      WMX4ST
     I              BZTMVA                      WMTMVA
     I              BZTNVA                      WMTNVA
     I              BZBLPR                      WMBLPR
     I              BZBMPR                      WMBMPR
     I              BZLRCD                      WMLRCD
     I              BZU9ST                      WMU9ST
     I              BZCMCO                      WMCMCO
     I              BZQ1CD                      WMQ1CD
     I              BZQ8CD                      WMQ8CD
     I              BZCHTM                      WMCHTM
     I              BZQZCD                      WMQZCD
     I              BZXWST                      WMXWST
     I              BZXXST                      WMXXST
     I              BZVMST                      WMVMST
     I              BZSWGH                      WMSWGH
     I              BZPPHE                      WMPPHE
     I              BZR3CD                      WMR3CD
     I              BZSDCD                      WMSDCD
     I              BZICN1                      WMICN1
     I              BZSVCD                      WMSVCD
     I              BZICN2                      WMICN2
     I              BZSWCD                      WMSWCD
     I              BZV2NB                      WMV2NB
     I              BZSXCD                      WMSXCD
     I              BZITCN                      WMITCN
     I              BZSYCD                      WMSYCD
     I              BZITC5                      WMITC5
     I              BZSZCD                      WMSZCD
     I              BZICN6                      WMICN6
     I              BZS0CD                      WMS0CD
     I              BZICN7                      WMICN7
     I              BZS1CD                      WMS1CD
     I              BZICN8                      WMICN8
     I              BZS2CD                      WMS2CD
     I              BZICN9                      WMICN9
     I              BZS3CD                      WMS3CD
     I              BZICN0                      WMICN0
     I              BZS4CD                      WMS4CD
     I              BZSFNB                      WMSFNB
     I              BZA3WG                      WMA3WG
     I              BZSJNB                      WMSJNB
     I              BZLLCD                      WMLLCD
     I              BZLMCD                      WMLMCD
     I              BZP3ST                      WMP3ST
     I              BZSKNB                      WMSKNB
     I              BZSLNB                      WMSLNB
     I              BZSMNB                      WMSMNB
     I              BZP4ST                      WMP4ST
     I              BZCFNB                      WMCFNB
     I              BZCGNB                      WMCGNB
     I              BZILNB                      WMILNB
     I              BZCHNB                      WMCHNB
     I              BZCINB                      WMCINB
     I              BZCJNB                      WMCJNB
     I              BZCMNB                      WMCMNB
     I              BZCNNB                      WMCNNB
     I              BZCRNB                      WMCRNB
     I              BZCSNB                      WMCSNB
     I              BZCVNB                      WMCVNB
     I              BZCWNB                      WMCWNB
     I              BZCXNB                      WMCXNB
     I              BZCZNB                      WMCZNB
     I              BZC0NB                      WMC0NB
     I              BZN1CD                      WMN1CD
     I              BZB4NB                      WMB4NB
     I              BZB5NB                      WMB5NB
     I              BZX5ST                      WMX5ST
     I              BZX6ST                      WMX6ST
     I              BZX7ST                      WMX7ST
     I              BZPCCT                      WMPCCT
     I              BZBDNB                      WMBDNB
     I              BZBJNB                      WMBJNB
     I              BZSUST                      WMSUST
     I              BZSVST                      WMSVST
     I              BZSYST                      WMSYST
     I              BZSZST                      WMSZST
     I              BZS1ST                      WMS1ST
     I              BZXRCD                      WMXRCD
     I              BZXTCD                      WMXTCD
     I              BZXUCD                      WMXUCD
     I              BZF5WG                      WMF5WG
     I              BZF6WG                      WMF6WG
     I              BZF7WG                      WMF7WG
     I              BZBLNB                      WMBLNB
     I              BZBNNB                      WMBNNB
     I              BZS2ST                      WMS2ST
     I              BZS4ST                      WMS4ST
     I              BZS5ST                      WMS5ST
     I              BZS6ST                      WMS6ST
     I              BZS8ST                      WMS8ST
     I              BZS9ST                      WMS9ST
     I              BZTCST                      WMTCST
     I              BZTDST                      WMTDST
     I              BZUVST                      WMUVST
     I              BZUWST                      WMUWST
     I              BZUXST                      WMUXST
     I              BZVSST                      WMVSST
     I              BZAATM                      WMAATM
     I              BZAYNA                      WMAYNA
     I              BZA0NA                      WMA0NA
     I              BZAXDT                      WMAXDT
      *
     I@AICPAJ
      * EDI WHS Stock Txf ADV HDR Update index
      * Renamed input format fields
     I              AIH9NY                      WOH9NY
     I              AIHPAA                      WOHPAA
     I              AIA0ST                      WOA0ST
     I              AIETSC                      WOETSC
     I              AIAUNZ                      WOAUNZ
     I              AIHCU1                      WOHCU1
     I              AIAVNZ                      WOAVNZ
     I              AIAWNZ                      WOAWNZ
     I              AIEUSC                      WOEUSC
     I              AIHEU1                      WOHEU1
     I              AIHDU1                      WOHDU1
     I              AIV6AA                      WOV6AA
     I              AIWPDT                      WOWPDT
     I              AIEWSC                      WOEWSC
     I              AIV8AA                      WOV8AA
     I              AIV7AA                      WOV7AA
     I              AIWQDT                      WOWQDT
     I              AIEXSC                      WOEXSC
     I              AIEYSC                      WOEYSC
     I              AIHKU1                      WOHKU1
     I              AIV9AA                      WOV9AA
     I              AIWRDT                      WOWRDT
     I              AIEZSC                      WOEZSC
     I              AIE0SC                      WOE0SC
     I              AIHLU1                      WOHLU1
     I              AIWAAA                      WOWAAA
     I              AIA0NZ                      WOA0NZ
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc Upd EDI 944 Trsn   XF
      * SR21655 DN 11/19/24-Exit Program if Between 3:30AM thru 3:50AM.
      * CASE: JOB.*Job time is Between 3:30am & 3:50am
     C                   IF        ##JTM >= 033000 AND
     C                             ##JTM <= 035000
     C                   MOVEL     W0RTN         P0RTN                          *Return code
     C                   EXSR      ZYEXPG
     C                   END                                                    *FI
      * EUS EDI 944 Data Dfn  US - /UT User Source  * Delcare Data Defini
      * Declare EDI 944 Data Definitions
      * WI517 DN 10/12/23-Setup Eradani's Environment Libraries.
      * Upd Setup Eradani Libs CL - /UT User Programs  * 
     C                   CALL      'PVBFUPC'                            90      Upd Setup Erada
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVBFUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * WI517 DN 10/05/23-Added/Init 'Send Email f/Failed API U' Output P
     C                   MOVEL     'N'           YL0001                         Send Email f/Fa
      * Rtv Upd EDI 944 Trsn   RT - EDI WHS Stock Txf ADV HDR  * 
     C                   EXSR      SARVGN
      * WI517 DN 10/05/23-If 'Send Email f/Failed API U=Yes' Then Send Em
      * CASE: LCL.Send Email f/Failed API U is Yes
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                   IF        YL0001 = 'Y'
     C                   CALL      'PVA9XFR'                            90      Prc Eml Shippin
     C                   PARM      *BLANK        W0RTN
     C                   PARM      @CN(003)      WQ0006                         Called From Pro
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVA9XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv Upd EDI 944 Trsn   RT - EDI WHS Stock Txf ADV HDR  * 
      *================================================================
      *
     C                   EVAL      WN0001 = ' '                                 EDI-Record Proc
     C                   EVAL      WN0002 = ' '                                 OHE EDI Error R
     C                   EVAL      WN0003 = ' '                                 Invalid Order N
      *
     C                   EVAL      W0RTN = ' '
      * Establish starting position
     C     *LOVAL        SETLL     @P065A6                                      *
     C                   READ      @P065A6                                90    *
      * Data record not found
     C   90              MOVEL     'USR4999'     W0RTN
      * USER: Process Data record
      * Data Validation.
      * CASE: *OTHERWISE
      * Initialize.
      * CASE: *OTHERWISE
     C                   DOW       NOT *IN90
     C                   MOVEL     'Y'           WN0001                         EDI-Record Proc
     C                   EVAL      WN0002 = ' '                                 OHE EDI Error R
     C                   MOVEL     'Y'           WN0003                         Invalid Order N
      * Validate Order Number.
      * CASE: DB1.W1704 Depositor Order Nbr is Not Entered
     C                   IF        WAAVNZ = ' '
     C                   MOVEL     'E'           WN0001                         EDI-Record Proc
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0002                         Order Number
      * Val Numeric Digit     US - /UT User Source  * 
      *
     c                   Monitor
      *
     c                   If        %check(digits : %trim(WAAVNZ)) = 0
      * All Digit, Validation Pass.
     c                   eval      YL0003 = 'Y'
     c                   else
      * Non-Digit Found, Validation Fail.
     c                   eval      YL0003 = 'N'
     c                   endif
      *
      * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
     c                   On-Error  00105                                        Do Nothing
      *
     c                   EndMon
      *
      * Order Number Pass Digit Check?
      * CASE: LCL.Validation Pass USR is Yes
      * Order Number Cannot Be More Than 7 Digits Long.
      * Val Order# Data Length US - EDI WHS Stock Txf ADV HDR  * 
     C                   IF        YL0003 = 'Y'
      *
      * Check Order Number Data Length.
     c                   eval      len = %len(%trim(WAAVNZ))
      * Order Number Cannot Be Greater Than 7.
     c                   If        len <= 7
     c                   eval      YL0003 = 'Y'
     c                   eval      YL0002 = %dec(%trim(WAAVNZ) : 7:0)
     c                   else
      * Order # Data Length > 7, Validation Fail.
     c                   eval      YL0003 = 'N'
     c                   eval      YL0002 = 0
     c                   endif
      *
      * Order Number Pass Length Check?
      * CASE: LCL.Validation Pass USR is Yes
      * RTV Order Hdr EDI 944  RT - Order Header TRG  * 
     C                   IF        YL0003 = 'Y'
     C                   EXSR      SBRVGN
      * Order Found?
      * CASE: PGM.*Return code is *Normal
      * Error if NOT a Transfer Order.
      * CASE: LCL.Order Type - Sales is Transfer Order
     C                   IF        W0RTN = ' '
     C                   IF        YL0005 = 'TR'
     C                   MOVEL     'N'           WN0003                         Invalid Order N
      * CASE: LCL.Header Status is Confirmed & Complete
     C                   IF        YL0008 = 'C' OR
     C                             YL0008 = 'R'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'E'           WN0001                         EDI-Record Proc
     C                   MOVEL     'ORDST'       WN0002                         OHE EDI Error R
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'E'           WN0001                         EDI-Record Proc
     C                   MOVEL     'ORDNM'       WN0002                         OHE EDI Error R
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'E'           WN0001                         EDI-Record Proc
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'E'           WN0001                         EDI-Record Proc
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'E'           WN0001                         EDI-Record Proc
     C                   END                                                    *FI
     C                   END                                                    *FI
      * If Order Number Not in Error, Continue Validation.
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.EDI-Record Processed is Error
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WN0001 = 'E'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
      * Check Receipt Date.
      * CASE: DB1.W1702 Receipt Date is Not Entered
     C                   IF        Y0CX01 = '1'
     C                   IF        WAAUNZ = ' '
     C                   MOVEL     'RCPDT'       WN0002                         OHE EDI Error R
     C                   ELSE
      * CASE: *OTHERWISE
      * Val Numeric Digit     US - /UT User Source  * 
     c                   Monitor
     c                   If        %check(digits : %trim(WAAUNZ)) = 0
     c                   eval      YL0003 = 'Y'
     c                   else
     c                   eval      YL0003 = 'N'
     c                   endif
     c                   On-Error  00105                                        Do Nothing
     c                   EndMon
      * Receipt Date Pass Digit Check?
      * CASE: LCL.Validation Pass USR is Yes
     C                   IF        YL0003 = 'Y'
     C                   MOVE      WAAUNZ        YL0010                         Receipt Date US
      * LCL.Receipt Date 2 USR = LCL.Receipt Date USR
     C                   IF        YL0010 = *ZERO
     C                   Z-ADD     *ZERO         YL0011
     C                   ELSE
     C     YL0010        SUB       19000000      YL0011                         Receipt Date 2
     C                   END
      * Receipt Date Cannot Be < Actual Ship Date OR Rcpt Dte > ASD (+14
      * CASE: LCL.Receipt Date 2 USR LT LCL.Actual Shipped Date
     C                   IF        YL0011 < YL0007
     C                   MOVEL     'RCPDT'       WN0002                         OHE EDI Error R
     C                   ELSE
      * CASE: *OTHERWISE
      * LCL.Actual Ship Date Usr = LCL.Actual Shipped Date + CON.14 *DAYS
     C     YL0007        ADD       1000000       XDINDT
     C                   EXSR      XCVTA
     C                   Z-ADD     XDAY1         XDAY2
     C                   Z-ADD     14            XDURR
     C                   MOVEL     '1'           XDSEL
     C                   MOVEL     '1111111'     XDCDW
     C                   EXSR      XDOWS
     C                   EXSR      XDADY
     C                   EXSR      XCVFA
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0012
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0012
     C                   END
      * CASE: LCL.Receipt Date 2 USR GT LCL.Actual Ship Date Usr
     C                   IF        YL0011 > YL0012
     C                   MOVEL     'RCPDT'       WN0002                         OHE EDI Error R
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'RCPDT'       WN0002                         OHE EDI Error R
     C                   END                                                    *FI
     C                   END                                                    *FI
      * If Not in Error, Check Ship To Warehouse DUNS#.
      * CASE: PAR.OHE EDI Error Reasons is Blank
      * RTV Validte Ship To WhsRT - EDI WHS Stock Txf ADV NME  * 
     C                   IF        WN0002 = ' '
     C                   EXSR      SCRVGN
      * CASE: LCL.Invalid Ship To Whs USR is Yes
     C                   IF        YL0013 = 'Y'
     C                   MOVEL     'ORDWH'       WN0002                         OHE EDI Error R
     C                   END                                                    *FI
     C                   END                                                    *FI
      * If Not in Error, Check Total Qty Received.
      * CASE: PAR.OHE EDI Error Reasons is Blank
      * CASE: DB1.W1401 Total Qty Received is LE 0
     C                   IF        WN0002 = ' '
     C                   IF        WAA0NZ <= 0
     C                   MOVEL     'RCPQT'       WN0002                         OHE EDI Error R
     C                   END                                                    *FI
     C                   END                                                    *FI
      * If Not in Error, Check Pallet ID.
      * CASE: PAR.OHE EDI Error Reasons is Blank
      * RTV Validate Pallet ID RT - EDI WHS Stock Txf ADV MAN  * 
     C                   IF        WN0002 = ' '
     C                   EXSR      SFRVGN
     C                   END                                                    *FI
      * If Not in Error, Check Serial #.
      * CASE: PAR.OHE EDI Error Reasons is Blank
      * RTV Validate Serial #  RT - EDI WHS Stock Txf ADV REF  * 
     C                   IF        WN0002 = ' '
     C                   EXSR      SGRVGN
     C                   END                                                    *FI
      * If Not in Error, Check Unit of Measure (UOM).
      * CASE: PAR.OHE EDI Error Reasons is Blank
      * RTV Validate UOM       RT - EDI WHS Stock Txf ADV DTL  * 
     C                   IF        WN0002 = ' '
     C                   EXSR      SHRVGN
      * CASE: LCL.Invalid UOM USR is Yes
     C                   IF        YL0020 = 'Y'
     C                   EVAL      WN0002 = ' '                                 OHE EDI Error R
     C                   MOVEL     'UOM'         WN0002                         OHE EDI Error R
     C                   END                                                    *FI
     C                   END                                                    *FI
      * If Not in Error, DTL/MAN Missing,Check Item Number & Item Number
      * CASE: PAR.OHE EDI Error Reasons is Blank
      * Val WHS Stk Txfr MAN  RT - EDI WHS Stock Txf ADV MAN  * 
     C                   IF        WN0002 = ' '
     C                   EXSR      SIRVGN
      * RMC 1/29/20  ERROR if missing MAN or DTL
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(001)
     C                   MOVEL     'EDIMN'       WN0002                         OHE EDI Error R
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV Validate Item Code RT - EDI WHS Stock Txf ADV DTL  * 
     C                   EXSR      SJRVGN
      * RMC 1/29/20  ERROR if missing DTL
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(001)
     C                   MOVEL     'EDIDT'       WN0002                         OHE EDI Error R
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CASE: PAR.OHE EDI Error Reasons is Blank
     C                   IF        WN0002 = ' '
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'E'           WN0001                         EDI-Record Proc
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Continue with Update.
      * CASE: *OTHERWISE
      * If Valid Order Number then Update OHE & Create Manifest Detail ED
      * CASE: PAR.Invalid Order Number USR is No
      * CASE: PAR.OHE EDI Error Reasons is Blank
     C                   IF        WN0003 = 'N'
     C                   IF        WN0002 = ' '
     C                   EVAL      YL0026 = ' '                                 OHE EDI 944 Act
     C                   MOVEL     'R'           YL0026                         OHE EDI 944 Act
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0026 = ' '                                 OHE EDI 944 Act
     C                   MOVEL     'E'           YL0026                         OHE EDI 944 Act
     C                   END                                                    *FI
      * Upd OHE EDI 944 Action RT - Order Header Extension  * 
     C                   EXSR      SKRVGN
     C                   END                                                    *FI
      * Crt Manifest; Adjust the Inv on the TO warehouse if sent/recvd is
      * CASE: PAR.OHE EDI Error Reasons is Blank
      * UPD Mnfst Dtl EDI Rcpt RT - EDI WHS Stock Txf ADV MAN  * Crt EDI
     C                   IF        WN0002 = ' '
     C                   EXSR      SNRVGN
      * R14364 DN 03/25/19-Check EDI Inv Upd Flag Whether to Run Inv Adju
      * Rtv Default Warehouse  RT - Company Customer  * Get Ship To Whse
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     YL0004        WL0001                         Company Number
     C                   Z-ADD     YL0006        WL0002                         Ship To Custome
     C                   EXSR      SDRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0003        YL0052                         Warehouse Code
      * Rtv Inventory Update  RT - EDI WHS Interchange  * 
     C                   EXSR      STRVGN
      * CASE: LCL.EDI Inventory Update is Yes
      * WI517 DN 10/05/23-Added Parms 'Called From Program' &
      *   'Send Email f/Failed API U'.
      * Exc Adj To Whs Inv     XF - Manifest Detail EDI Rcpt  * 
     C                   IF        YL0053 = 'Y'
     C                   CALL      'PUFAXFR'                            90      Exc Adj To Whs
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0004        WQ0001                         Company Number
     C                   PARM      YL0002        WQ0002                         Order Number
     C                   PARM      WAH9NY        WQ0003                         EDI SURROGATE N
     C                   PARM      @CN(003)      WQ0004                         Called From Pro
     C     YL0001        PARM      *BLANK        WQ0005                         Send Email f/Fa
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUFAXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CHG WHS StckTxf ADV HD CH - EDI WHS Stock Txf ADV HDR  * 
     C                   EXSR      SUCHRC
     C                   READ      @P065A6                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * RTV Order Hdr EDI 944  RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0004                         Company Number
     C                   EVAL      YL0005 = ' '                                 Order Type_Sale
     C                   Z-ADD     *ZERO         YL0006                         Ship To Custome
     C                   Z-ADD     *ZERO         YL0007                         Actual Shipped
     C                   EVAL      YL0008 = ' '                                 Header Status
     C                   Z-ADD     *ZERO         YL0009                         Load ID
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WQSB01                         Order Number
      * Setup key
     C                   Z-ADD     YL0002        WQSB01                         Order Number
      * Establish starting position
     C     KRSSB         SETLL     @BFCPY2                                      *
     C     KRSSB         READE     @BFCPY2                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   Z-ADD     WBAIC3        YL0004                         Company Number
     C                   MOVEL     WBJNCD        YL0005                         Order Type_Sale
     C                   Z-ADD     WBBKC7        YL0006                         Ship To Custome
     C                   Z-ADD     WBGNDT        YL0007                         Actual Shipped
     C                   MOVEL     WBGWST        YL0008                         Header Status
     C                   Z-ADD     WBRMNB        YL0009                         Load ID
     C     KRSSB         READE     @BFCPY2                                90    *
     C                   ENDDO
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * RTV Validte Ship To WhsRT - EDI WHS Stock Txf ADV NME  * 
      *================================================================
      *
     C                   EVAL      WN0004 = ' '                                 EDI Whs Duns Nu
      *
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           YL0013                         Invalid Ship To
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WQSC01                         EDI SURROGATE N
      * Setup key
     C                   Z-ADD     WAH9NY        WQSC01                         EDI SURROGATE N
      * Establish starting position
     C     KRSSC         SETLL     @ANCPAZ                                      *
     C     KRSSC         READE     @ANCPAZ                                90    *
      * Data record not found
     C   90              MOVEL     'USR5009'     W0RTN
      * USER: Process Data record
      * Validate Ship To Warehouse DUNS#.
      * CASE:
      *  - (c1 OR c2) AND c3 AND c4
      *   |- c1    : DB1.N101-NAME TYPE CODE is Warehouse
      *   |- c2    : DB1.N101-NAME TYPE CODE is Ship To
      *   |- c3    : DB1.N104-ID CODE is Entered
      *   |- c4    : DB1.N103-ID CODE QUALIFIER is Duns ID
      *   '-
     C                   DOW       NOT *IN90
     C                   MOVEL     '0'           Y0CX01
     C                   MOVEL     '0'           Y0CX02
     C                   IF        WCTYPC = 'WH' OR
     C                             WCTYPC = 'ST'
     C                   MOVEL     '1'           Y0CX02
     C                   END                                                    *FI
     C                   IF        Y0CX02 = '1'
     C                   IF        WCDCDE <> ' '
     C                   IF        WCDCDQ = '9'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * EUS TrimL ShpToWh DUNS US - EDI WHS Stock Txf ADV NME  * 
     C                   IF        Y0CX01 = '1'
      * Trim Left Ship To Warehouse DUNS #.
     c                   eval      YL0014 = %triml(WCDCDE)
      *
      * Rtv Default Warehouse  RT - Company Customer  * Get Ship To Whse
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     YL0004        WL0001                         Company Number
     C                   Z-ADD     YL0006        WL0002                         Ship To Custome
     C                   EXSR      SDRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0003        YL0015                         Warehouse Code
      * Rtv WHS Interchg All  RT - EDI WHS Interchange  * By WHSTFR Inter
     C                   EXSR      SERVGN
      * DUNS # Mismatch.
      * CASE: PAR.EDI Whs Duns Number NE LCL.EDI Whs Duns Number
     C                   IF        WN0004 <> YL0014
     C                   MOVEL     'Y'           YL0013                         Invalid Ship To
     C                   GOTO      SCEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSC         READE     @ANCPAZ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * Get Ship To Whse
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WDAIC3                         Company Number
     C                   KFLD                    WDBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     WL0001        WDAIC3                         Company Number
     C                   Z-ADD     WL0002        WDBKC7                         Ship To Custome
      * Establish starting position
     C     KRSSD         CHAIN     @EOREXM                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1007'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0003 = ' '                                 Warehouse Code
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WDAJCD        WL0003                         Warehouse Code
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * Rtv WHS Interchg All  RT - EDI WHS Interchange  * By WHSTFR Inte
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WN0004 = ' '                                 EDI Whs Duns Nu
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WEAJCD                         Warehouse Code
     C                   KFLD                    WEM4AA                         Interchange Cod
      * Setup key
     C                   MOVEL     YL0015        WEAJCD                         Warehouse Code
     C                   MOVEL     'WHSTAD'      WEM4AA                         Interchange Cod
      * Establish starting position
     C     KRSSE         CHAIN     @G0REJZ                            90        *
      * Data record not found
     C   90              MOVEL     'USR4409'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WEX2T1        WN0004                         EDI Whs Duns Nu
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * RTV Validate Pallet ID RT - EDI WHS Stock Txf ADV MAN  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   EVAL      WN0002 = ' '                                 OHE EDI Error R
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    WQSF01                         EDI SURROGATE N
      * Setup key
     C                   Z-ADD     WAH9NY        WQSF01                         EDI SURROGATE N
      * Establish starting position
     C     KRSSF         SETLL     @AKCPAQ                                      *
     C     KRSSF         READE     @AKCPAQ                                90    *
      * Data record not found
     C   90              MOVEL     'USR5003'     W0RTN
      * USER: Process Data record
      * CASE: DB1.N0901 Reference ID Qlfr is Pallet Number
     C                   DOW       NOT *IN90
      * CASE: DB1.N0902 Reference ID is Entered
     C                   IF        WFVZAA = 'W'
      * EUS TrimL Pallet ID    US - EDI WHS Stock Txf ADV MAN  * 
     C                   IF        WFHGU1 <> ' '
      * Trim Left & Substring Out the Pallet ID.
     c                   eval      YL0016 = %subst(%triml(WFHGU1):11:9)
      *
      * Val Numeric Digit     US - /UT User Source  * 
     c                   Monitor
     c                   If        %check(digits : %trim(YL0016)) = 0
     c                   eval      YL0017 = 'Y'
     c                   else
     c                   eval      YL0017 = 'N'
     c                   endif
     c                   On-Error  00105                                        Do Nothing
     c                   EndMon
      * Pallet ID Pass Digit Check?
      * CASE: LCL.Validation Pass USR is No
     C                   IF        YL0017 = 'N'
     C                   MOVEL     'PALLT'       WN0002                         OHE EDI Error R
     C                   GOTO      SFEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'PALLT'       WN0002                         OHE EDI Error R
     C                   GOTO      SFEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'PALQL'       WN0002                         OHE EDI Error R
     C                   GOTO      SFEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSF         READE     @AKCPAQ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGRVGN        BEGSR
      *================================================================
      * RTV Validate Serial #  RT - EDI WHS Stock Txf ADV REF  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   EVAL      WN0002 = ' '                                 OHE EDI Error R
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSG         KLIST
     C                   KFLD                    WQSG01                         EDI SURROGATE N
      * Setup key
     C                   Z-ADD     WAH9NY        WQSG01                         EDI SURROGATE N
      * Establish starting position
     C     KRSSG         SETLL     @A0CPCJ                                      *
     C     KRSSG         READE     @A0CPCJ                                90    *
      * Data record not found
     C   90              MOVEL     'USR5051'     W0RTN
      * USER: Process Data record
      * CASE: DB1.N901 Reference ID Qlfr is Serial Number
     C                   DOW       NOT *IN90
      * CASE: DB1.N902 Reference ID Nbr is Entered
     C                   IF        WGV3AA = 'SE'
      * EUS TrimL Serial Nbr   US - EDI WHS Shipping Adv REF  * 
     C                   IF        WGHIU1 <> ' '
      * Trim Left Serial Number.
     c                   eval      YL0018 = %triml(WGHIU1)
      *
      * Val Numeric Digit     US - /UT User Source  * 
     c                   Monitor
     c                   If        %check(digits : %trim(YL0018)) = 0
     c                   eval      YL0019 = 'Y'
     c                   else
     c                   eval      YL0019 = 'N'
     c                   endif
     c                   On-Error  00105                                        Do Nothing
     c                   EndMon
      * Serial # Pass Digit Check?
      * CASE: LCL.Validation Pass USR is No
     C                   IF        YL0019 = 'N'
     C                   MOVEL     'SERLN'       WN0002                         OHE EDI Error R
     C                   GOTO      SGEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'SERLN'       WN0002                         OHE EDI Error R
     C                   GOTO      SGEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'SERQL'       WN0002                         OHE EDI Error R
     C                   GOTO      SGEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSG         READE     @A0CPCJ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHRVGN        BEGSR
      *================================================================
      * RTV Validate UOM       RT - EDI WHS Stock Txf ADV DTL  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           YL0020                         Invalid UOM USR
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSH         KLIST
     C                   KFLD                    WQSH01                         EDI SURROGATE N
      * Setup key
     C                   Z-ADD     WAH9NY        WQSH01                         EDI SURROGATE N
      * Establish starting position
     C     KRSSH         SETLL     @AJCPAN                                      *
     C     KRSSH         READE     @AJCPAN                                90    *
      * Data record not found
     C   90              MOVEL     'USR5001'     W0RTN
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DB1.W0702 UOM is Boxes
      *   |- c2    : DB1.W0702 UOM is Combos
      *   |- c3    : DB1.W0702 UOM is Each
      *   |- c4    : DB1.W0702 UOM is Pounds
      *   |- c5    : DB1.W0702 UOM is Cases
      *   '-
     C                   DOW       NOT *IN90
      * R14364 DN 04/10/19-Added 'CS' (Cases).
     C                   IF        WHVYAA = 'CA' OR
     C                             WHVYAA = 'CZ' OR
     C                             WHVYAA = 'EA' OR
     C                             WHVYAA = 'LB' OR
     C                             WHVYAA = 'CS'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           YL0020                         Invalid UOM USR
     C                   GOTO      SHEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSH         READE     @AJCPAN                                90    *
     C                   ENDDO
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   SIRVGN        BEGSR
      *================================================================
      * Val WHS Stk Txfr MAN  RT - EDI WHS Stock Txf ADV MAN  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSI         KLIST
     C                   KFLD                    WQSI01                         EDI SURROGATE N
      * Setup key
     C                   Z-ADD     WAH9NY        WQSI01                         EDI SURROGATE N
      * Establish starting position
     C     KRSSI         SETLL     @AKCPAQ                                      *
     C     KRSSI         READE     @AKCPAQ                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5003'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SIEXIT
     C                   ENDIF
      *
      *================================================================
     CSR   SIEXIT        ENDSR
      /EJECT
     CSR   SJRVGN        BEGSR
      *================================================================
      * RTV Validate Item Code RT - EDI WHS Stock Txf ADV DTL  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSJ         KLIST
     C                   KFLD                    WQSJ01                         EDI SURROGATE N
      * Setup key
     C                   Z-ADD     WAH9NY        WQSJ01                         EDI SURROGATE N
      * Establish starting position
     C     KRSSJ         SETLL     @AJCPAN                                      *
     C     KRSSJ         READE     @AJCPAN                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5001'     W0RTN
      * USER: Processing if Data record not found
      * RMC added -- if no rcds found     1/29/20
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SJEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.W0704 Prod ID Qlfr is Vendor Item Number
      *   |- c2    : DB1.W0705 Prod ID Code is Not DIVIDERS
      *   '-
     C                   DOW       NOT *IN90
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WHEVSC = 'VN'
     C                   IF        WHF3C7 <> @CN(002)
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CASE: DB1.W0705 Prod ID Code is Entered
     C                   IF        Y0CX01 = '1'
      * EUS TrimL Prod ID Code US - EDI WHS Stock Txf ADV DTL  * 
     C                   IF        WHF3C7 <> ' '
      * Trim Left Product ID.
     c                   eval      YL0021 = %triml(WHF3C7)
      *
     C                   MOVEL     YL0021        YL0022                         Item Code 5A
      * Val Numeric Digit     US - /UT User Source  * 
     c                   Monitor
     c                   If        %check(digits : %trim(YL0022)) = 0
     c                   eval      YL0023 = 'Y'
     c                   else
     c                   eval      YL0023 = 'N'
     c                   endif
     c                   On-Error  00105                                        Do Nothing
     c                   EndMon
      * Item Code Pass Digit Check?
      * CASE: LCL.Validation Pass USR is Yes
      * Validate Item Code Exist in Order Detail.
     C                   IF        YL0023 = 'Y'
     C                   MOVE      YL0022        YL0024                         Item Code 5.0
     C                   Z-ADD     YL0024        YL0025                         Item Code
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'ITEMN'       WN0002                         OHE EDI Error R
     C                   GOTO      SJEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'ITEMN'       WN0002                         OHE EDI Error R
     C                   GOTO      SJEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.W0705 Prod ID Code is Not DIVIDERS
     C                   IF        WHF3C7 <> @CN(002)
     C                   MOVEL     'ITMQL'       WN0002                         OHE EDI Error R
     C                   GOTO      SJEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSJ         READE     @AJCPAN                                90    *
     C                   ENDDO
      *================================================================
     CSR   SJEXIT        ENDSR
      /EJECT
     CSR   SKRVGN        BEGSR
      *================================================================
      * Upd OHE EDI 944 Action RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSK         KLIST
     C                   KFLD                    WIAIC3                         Company Number
     C                   KFLD                    WIC4NB                         Order Number
      * Setup key
     C                   Z-ADD     YL0004        WIAIC3                         Company Number
     C                   Z-ADD     YL0002        WIC4NB                         Order Number
      * Establish starting position
     C     KRSSK         CHAIN     @AMREJF                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR3697'     W0RTN
      * USER: Processing if Data record not found
      * CRT OHE EDI 944 Action CR - Order Header Extension  * 
     C                   EXSR      SLCRRC
     C                   GOTO      SKEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * CHG OHE EDI 944 Action CH - Order Header Extension  * 
     C                   IF        NOT *IN90
     C                   EXSR      SMCHRC
     C                   ENDIF
      *================================================================
     CSR   SKEXIT        ENDSR
      /EJECT
     CSR   SLCRRC        BEGSR
      *================================================================
      * CRT OHE EDI 944 Action CR - Order Header Extension  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0005                         Stop_Drop Seque
     C                   EVAL      WN0006 = ' '                                 Shipping Line
     C                   EVAL      WN0007 = ' '                                 Port Delv Termi
     C                   EVAL      WN0008 = ' '                                 OHE City
     C                   EVAL      WN0009 = ' '                                 OHE Vessel_Airl
     C                   EVAL      WN0010 = ' '                                 OHE Voyage_Flig
     C                   EVAL      WN0011 = ' '                                 OHE Booking Num
     C                   EVAL      WN0012 = ' '                                 OHE Discharge P
     C                   Z-ADD     *ZERO         WN0013                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WN0014                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WN0015                         OHE Arrival Dat
     C                   EVAL      WN0016 = ' '                                 OHE Late Delive
     C                   EVAL      WN0017 = ' '                                 OHE Ship Status
     C                   EVAL      WN0018 = ' '                                 OHE Container N
     C                   EVAL      WN0019 = ' '                                 OHE Comment 1
     C                   EVAL      WN0020 = ' '                                 OHE Comment 2
     C                   Z-ADD     *ZERO         WN0021                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0022                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0023                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0024                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0025                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WN0026                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WN0027                         Transload Termi
     C                   Z-ADD     *ZERO         WN0028                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WN0029                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WN0030                         OHE Port_Pier P
     C                   EVAL      WN0031 = ' '                                 OHE Carrier SCA
     C                   EVAL      WN0032 = ' '                                 OHE Spot Buy
     C                   EVAL      WN0033 = ' '                                 OHE PO ACK Flag
     C                   EVAL      WN0034 = ' '                                 OHE Override Ty
     C                   EVAL      WN0035 = ' '                                 OHE Backhaul St
     C                   EVAL      WN0036 = ' '                                 OHE Backhaul ET
     C                   EVAL      WN0037 = ' '                                 OHE Load Haul T
     C                   EVAL      WN0038 = ' '                                 OHE Backhaul Ca
     C                   EVAL      WN0039 = ' '                                 OHE Bookings Co
     C                   EVAL      WN0040 = ' '                                 OHE EDI Error R
     C                   Z-ADD     *ZERO         WN0041                         HPB COA Batch N
     C                   EVAL      WN0042 = ' '                                 Delivery P_O  N
     C                   EVAL      WN0043 = ' '                                 OHE Intended fo
     C                   EVAL      WN0044 = ' '                                 OHE EDI 943 Act
     C                   EVAL      WN0045 = ' '                                 OHE EDI 940 Act
     C                   EVAL      WN0046 = ' '                                 OHE EDI 945 Act
     C                   EVAL      WN0047 = ' '                                 OHE EDI 856 Act
     C                   EVAL      WN0048 = ' '                                 OHE EDI 824 Act
     C                   EVAL      WN0049 = ' '                                 OHE Transload S
     C                   EVAL      WN0050 = ' '                                 OHE Abs Rate Ov
     C                   EVAL      WN0051 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0052 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0053 = ' '                                 OHE Backhaul Ch
     C                   EVAL      WN0054 = ' '                                 OHE Transload C
     C                   EVAL      WN0055 = ' '                                 OHE Pier Pass I
     C                   EVAL      WN0056 = ' '                                 OHE Carrier Nm
     C                   EVAL      WN0057 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0058 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0059 = ' '                                 Letter of Credi
     C                   Z-ADD     *ZERO         WN0060                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WN0061                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WN0062                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0063                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WN0064                         OHE Port Check
     C                   Z-ADD     *ZERO         WN0065                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WN0066                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WN0067                         OHE Load Sched
     C                   Z-ADD     *ZERO         WN0068                         Original Appoin
     C                   Z-ADD     *ZERO         WN0069                         Original Appoin
     C                   Z-ADD     *ZERO         WN0070                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0071                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0072                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WN0073                         OHE Orig ABS Fr
     C                   EVAL      WN0074 = ' '                                 OHE Genset Numb
     C                   EVAL      WN0075 = ' '                                 OHE Email BOL_S
     C                   EVAL      WN0076 = ' '                                 OHE EDI Order A
     C                   EVAL      WN0077 = ' '                                 OHE EDI 601 Act
     C                   EVAL      WN0078 = ' '                                 OHE Unused Stat
     C                   EVAL      WN0079 = ' '                                 OHE Unused Text
     C                   EVAL      WN0080 = ' '                                 OHE Unused Text
     C                   EVAL      WN0081 = ' '                                 OHE Customer Ve
     C                   EVAL      WN0082 = ' '                                 OHE EDI 824 AES
     C                   EVAL      WN0083 = ' '                                 OHE Unused Text
     C                   Z-ADD     *ZERO         WN0084                         OHE Unused Date
     C                   Z-ADD     *ZERO         WN0085                         OHE Unused Date
     C                   EVAL      WN0086 = ' '                                 EDI Status 1
     C                   EVAL      WN0087 = ' '                                 EDI Status 2
     C                   EVAL      WN0088 = ' '                                 EDI Status 3
     C                   EVAL      WN0089 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0090                         Job Time
     C                   EVAL      WN0091 = ' '                                 User Id
     C                   EVAL      WN0092 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0093                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @AMREJE
     C                   Z-ADD     YL0004        WJAIC3                         Company Number
     C                   Z-ADD     YL0002        WJC4NB                         Order Number
     C                   Z-ADD     YL0009        WJRMNB                         Load ID
     C                   Z-ADD     YL0007        WJQ2DT                         OHE Actual Ship
     C                   MOVEL     WN0002        WJB9TX                         OHE EDI Error R
     C                   MOVEL     YL0026        WJF0ST                         OHE EDI 944 Act
      *
      * USER: Processing before Data update
     C                   MOVEL     'A'           WJVSST                         Record Status
     C                   Z-ADD     ##JTM         WJAATM                         Job Time
     C                   Z-ADD     ##JDT         WJAXDT                         Job Date
     C                   MOVEL     ##PGM         WJA0NA                         Job Name
     C                   MOVEL     ##USR         WJAYNA                         User Id
     C     KLCRSL        KLIST
     C                   KFLD                    WJAIC3                         Company Number
     C                   KFLD                    WJC4NB                         Order Number
      * Check for duplicate primary key
     C     KLCRSL        SETLL     @AMREJE                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR3698'     W0RTN
      * Send message 'Order Header Extension EX'
     C                   MOVEL     'USR3698'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SLEXIT
     C                   ENDIF
      *
     C                   WRITE     @AMREJE                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SLEXIT        ENDSR
      /EJECT
     CSR   SMCHRC        BEGSR
      *================================================================
      * CHG OHE EDI 944 Action CH - Order Header Extension  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0094                         Load ID
     C                   Z-ADD     *ZERO         WN0095                         Stop_Drop Seque
     C                   EVAL      WN0096 = ' '                                 Shipping Line
     C                   EVAL      WN0097 = ' '                                 Port Delv Termi
     C                   EVAL      WN0098 = ' '                                 OHE City
     C                   EVAL      WN0099 = ' '                                 OHE Vessel_Airl
     C                   EVAL      WN0100 = ' '                                 OHE Voyage_Flig
     C                   EVAL      WN0101 = ' '                                 OHE Booking Num
     C                   EVAL      WN0102 = ' '                                 OHE Discharge P
     C                   Z-ADD     *ZERO         WN0103                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WN0104                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WN0105                         OHE Arrival Dat
     C                   EVAL      WN0106 = ' '                                 OHE Late Delive
     C                   EVAL      WN0107 = ' '                                 OHE Ship Status
     C                   EVAL      WN0108 = ' '                                 OHE Container N
     C                   EVAL      WN0109 = ' '                                 OHE Comment 1
     C                   EVAL      WN0110 = ' '                                 OHE Comment 2
     C                   Z-ADD     *ZERO         WN0111                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0112                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0113                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0114                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0115                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WN0116                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WN0117                         Transload Termi
     C                   Z-ADD     *ZERO         WN0118                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WN0119                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WN0120                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WN0121                         OHE Actual Ship
     C                   EVAL      WN0122 = ' '                                 OHE Carrier SCA
     C                   EVAL      WN0123 = ' '                                 OHE Spot Buy
     C                   EVAL      WN0124 = ' '                                 OHE PO ACK Flag
     C                   EVAL      WN0125 = ' '                                 OHE Override Ty
     C                   EVAL      WN0126 = ' '                                 OHE Backhaul St
     C                   EVAL      WN0127 = ' '                                 OHE Backhaul ET
     C                   EVAL      WN0128 = ' '                                 OHE Load Haul T
     C                   EVAL      WN0129 = ' '                                 OHE Backhaul Ca
     C                   EVAL      WN0130 = ' '                                 OHE Bookings Co
     C                   EVAL      WN0131 = ' '                                 OHE EDI Error R
     C                   Z-ADD     *ZERO         WN0132                         HPB COA Batch N
     C                   EVAL      WN0133 = ' '                                 Delivery P_O  N
     C                   EVAL      WN0134 = ' '                                 OHE Intended fo
     C                   EVAL      WN0135 = ' '                                 OHE EDI 943 Act
     C                   EVAL      WN0136 = ' '                                 OHE EDI 940 Act
     C                   EVAL      WN0137 = ' '                                 OHE EDI 945 Act
     C                   EVAL      WN0138 = ' '                                 OHE EDI 856 Act
     C                   EVAL      WN0139 = ' '                                 OHE EDI 824 Act
     C                   EVAL      WN0140 = ' '                                 OHE Transload S
     C                   EVAL      WN0141 = ' '                                 OHE Abs Rate Ov
     C                   EVAL      WN0142 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0143 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0144 = ' '                                 OHE Backhaul Ch
     C                   EVAL      WN0145 = ' '                                 OHE Transload C
     C                   EVAL      WN0146 = ' '                                 OHE Pier Pass I
     C                   EVAL      WN0147 = ' '                                 OHE Carrier Nm
     C                   EVAL      WN0148 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0149 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0150 = ' '                                 Letter of Credi
     C                   Z-ADD     *ZERO         WN0151                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WN0152                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WN0153                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0154                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WN0155                         OHE Port Check
     C                   Z-ADD     *ZERO         WN0156                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WN0157                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WN0158                         OHE Load Sched
     C                   Z-ADD     *ZERO         WN0159                         Original Appoin
     C                   Z-ADD     *ZERO         WN0160                         Original Appoin
     C                   Z-ADD     *ZERO         WN0161                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0162                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0163                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WN0164                         OHE Orig ABS Fr
     C                   EVAL      WN0165 = ' '                                 OHE Genset Numb
     C                   EVAL      WN0166 = ' '                                 OHE Email BOL_S
     C                   EVAL      WN0167 = ' '                                 OHE EDI Order A
     C                   EVAL      WN0168 = ' '                                 OHE EDI 601 Act
     C                   EVAL      WN0169 = ' '                                 OHE Unused Stat
     C                   EVAL      WN0170 = ' '                                 OHE Unused Text
     C                   EVAL      WN0171 = ' '                                 OHE Unused Text
     C                   EVAL      WN0172 = ' '                                 OHE Customer Ve
     C                   EVAL      WN0173 = ' '                                 OHE EDI 824 AES
     C                   EVAL      WN0174 = ' '                                 OHE Unused Text
     C                   Z-ADD     *ZERO         WN0175                         OHE Unused Date
     C                   Z-ADD     *ZERO         WN0176                         OHE Unused Date
     C                   EVAL      WN0177 = ' '                                 EDI Status 1
     C                   EVAL      WN0178 = ' '                                 EDI Status 2
     C                   EVAL      WN0179 = ' '                                 EDI Status 3
     C                   EVAL      WN0180 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0181                         Job Time
     C                   EVAL      WN0182 = ' '                                 User Id
     C                   EVAL      WN0183 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0184                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @AMREJE
     C                   Z-ADD     WIAIC3        WJAIC3                         Company Number
     C                   Z-ADD     WIC4NB        WJC4NB                         Order Number
      *
     C     KLCHSM        KLIST
     C                   KFLD                    WJAIC3                         Company Number
     C                   KFLD                    WJC4NB                         Order Number
     C     KLCHSM        CHAIN     @AMREJE                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PMAMREL0'    MDACP
     C                   MOVEL     '@AMREJE'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SMEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SMEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPMAM1        YARDCS
      * Move non-key fields to @AMREJE
     C                   MOVEL(P)  WN0002        WJB9TX                         OHE EDI Error R
     C                   MOVEL(P)  YL0026        WJF0ST                         OHE EDI 944 Act
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
     C                   Z-ADD     ##JTM         WJAATM                         Job Time
     C                   Z-ADD     ##JDT         WJAXDT                         Job Date
     C                   MOVEL     ##PGM         WJA0NA                         Job Name
     C                   MOVEL     ##USR         WJAYNA                         User Id
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @AMREJE                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PMAMREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SMEXIT        ENDSR
      /EJECT
     CSR   SNRVGN        BEGSR
      *================================================================
      * UPD Mnfst Dtl EDI Rcpt RT - EDI WHS Stock Txf ADV MAN  * Crt EDI
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSN         KLIST
     C                   KFLD                    WQSN01                         EDI SURROGATE N
      * Setup key
     C                   Z-ADD     WAH9NY        WQSN01                         EDI SURROGATE N
      * Establish starting position
     C     KRSSN         SETLL     @AKCPAQ                                      *
     C     KRSSN         READE     @AKCPAQ                                90    *
      * Data record not found
     C   90              MOVEL     'USR5003'     W0RTN
      * USER: Process Data record
      * UPD Mnfst Dtl EDI Rcpt RT - EDI WHS Stock Txf ADV DTL  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SORVGN
     C     KRSSN         READE     @AKCPAQ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SNEXIT        ENDSR
      /EJECT
     CSR   SORVGN        BEGSR
      *================================================================
      * UPD Mnfst Dtl EDI Rcpt RT - EDI WHS Stock Txf ADV DTL  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSO         KLIST
     C                   KFLD                    WQSO01                         EDI SURROGATE N
     C                   KFLD                    WQSO02                         LX01 Sequence N
      * Setup key
     C                   Z-ADD     WFH9NY        WQSO01                         EDI SURROGATE N
     C                   Z-ADD     WFT4NY        WQSO02                         LX01 Sequence N
      * Establish starting position
     C     KRSSO         SETLL     @AJCPAN                                      *
     C     KRSSO         READE     @AJCPAN                                90    *
      * Data record not found
     C   90              MOVEL     'USR5001'     W0RTN
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.W0705 Prod ID Code is Not DIVIDERS
      *   |- c2    : DB1.W0701 Quantity Received is GT 0
      *   '-
     C                   DOW       NOT *IN90
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WHF3C7 <> @CN(002)
     C                   IF        WHSGQT > 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * UPD Mnfst Dtl EDI Rcpt RT - EDI WHS Stock Txf ADV REF  * 
     C                   IF        Y0CX01 = '1'
     C                   EXSR      SPRVGN
      * If no serial level REF is found:
     C                   Z-ADD     YL0011        YL0036                         MDER Receipt Da
      * Write manifest dtl rcpt with pallet no. serial will be -0-
      * CASE: PGM.*Return code is *Record does not exist
      * Format Data
     C                   IF        W0RTN = @CN(001)
     C                   EXSR      UASUBR                                       Format Data
      * RTV Unit Weight/UM Prm RT - Company Item  * 
     C                   EXSR      SSRVGN
     C     YL0049        MULT      WHSGQT        YL0050                         Weight Received
      * CRT Manifest Dtl EDI   CR - Manifest Detail EDI Rcpt  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     YL0004        WL0004                         Company Number
     C                   Z-ADD     YL0002        WL0005                         Order Number
     C                   Z-ADD     WHT4NY        WL0006                         LX01 Sequence N
     C                   Z-ADD     WHAXNZ        WL0007                         EDI Case Sequen
     C                   Z-ADD     1             WL0008                         EDI Ref Sequenc
     C                   Z-ADD     YL0009        WL0009                         Load ID
     C                   Z-ADD     YL0041        WL0010                         Item Code
     C                   Z-ADD     YL0038        WL0011                         Manifest Pallet
     C                   Z-ADD     YL0051        WL0012                         PT Serial Numbe
     C                   Z-ADD     WHSGQT        WL0013                         Quantity Receiv
     C                   Z-ADD     YL0050        WL0014                         Weight Received
     C                   MOVEL(P)  YL0048        WL0015                         UOM
     C                   MOVEL(P)  WHHFU1        WL0016                         Warehouse Lot N
     C                   EVAL      WL0017 = ' '                                 Receiving Condi
     C                   EVAL      WL0018 = ' '                                 Damage Reason C
     C                   EVAL      WL0019 = ' '                                 Inventory Updat
     C                   Z-ADD     YL0036        WL0020                         MDER Receipt Da
     C                   Z-ADD     ##JTM         WL0021                         MDER Receipt Ti
     C                   EVAL      WL0022 = ' '                                 MDER Error Sts
     C                   EVAL      WL0023 = ' '                                 MDER Unused Sts
     C                   Z-ADD     YL0047        WL0024                         MDER Production
     C                   Z-ADD     *ZERO         WL0025                         MDER Unused nbr
     C                   Z-ADD     *ZERO         WL0026                         MDER Unused Qty
     C                   EVAL      WL0027 = ' '                                 MDER Unused Txt
     C                   EXSR      SQCRRC
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSO         READE     @AJCPAN                                90    *
     C                   ENDDO
      *================================================================
     CSR   SOEXIT        ENDSR
      /EJECT
     CSR   SPRVGN        BEGSR
      *================================================================
      * UPD Mnfst Dtl EDI Rcpt RT - EDI WHS Stock Txf ADV REF  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   Z-ADD     YL0011        YL0027                         MDER Receipt Da
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSP         KLIST
     C                   KFLD                    WQSP01                         EDI SURROGATE N
     C                   KFLD                    WQSP02                         LX01 Sequence N
     C                   KFLD                    WQSP03                         EDI Case Sequen
      * Setup key
     C                   Z-ADD     WHH9NY        WQSP01                         EDI SURROGATE N
     C                   Z-ADD     WHT4NY        WQSP02                         LX01 Sequence N
     C                   Z-ADD     WHAXNZ        WQSP03                         EDI Case Sequen
      * Establish starting position
     C     KRSSP         SETLL     @A0CPCJ                                      *
     C     KRSSP         READE     @A0CPCJ                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5051'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SPEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Format Data.
      * CASE: *OTHERWISE
      * Substring Out the Pallet ID, Position 11 for 9 bytes.
      * EUS TrimL Pallet ID    US - EDI WHS Stock Txf ADV MAN  * 
     C                   DOW       NOT *IN90
     c                   eval      YL0028 = %subst(%triml(WFHGU1):11:9)
      * Cvt Pallet ID to Nbr   US - /UT User Source  * 
      * Trim Pallet ID and Convert to Numeric.
     c                   eval      YL0029 = %dec(%trim(YL0028) : 9:0)
      *
      * Item Code.
      * EUS TrimL Prod ID Code US - EDI WHS Stock Txf ADV DTL  * 
     c                   eval      YL0030 = %triml(WHF3C7)
      * Cvt Item Code to Nbr   US - EDI WHS Shipping Adv DTL  * 
      * Trim Item Code and Convert to Numeric.
     c                   eval      YL0031 = %dec(%trim(YL0030) : 7:0)
      *
      * Serial #.
      * EUS TrimL Serial Nbr   US - EDI WHS Shipping Adv REF  * 
     c                   eval      YL0032 = %triml(WGHIU1)
      * Cvt Serial# Txt to Nbr US - /UT User Source  * 
      * Trim Serial # and Convert to Numeric.
     c                   eval      YL0033 = %dec(%trim(YL0032) : 8:0)
      *
      * Production Date.
      * CASE: DB1.N904 Production Date is Entered
      * LCL.Production Date USR D8# = DB1.N904 Production Date
     C                   IF        WGA4NZ <> 0
     C                   Z-ADD     WGA4NZ        YL0034                         Production Date
      * LCL.MDER Production Date = LCL.Production Date USR D8#
     C                   IF        YL0034 = *ZERO
     C                   Z-ADD     *ZERO         YL0035
     C                   ELSE
     C     YL0034        SUB       19000000      YL0035                         MDER Production
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0035                         MDER Production
     C                   END                                                    *FI
      * CRT Manifest Dtl EDI   CR - Manifest Detail EDI Rcpt  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     YL0004        WL0004                         Company Number
     C                   Z-ADD     YL0002        WL0005                         Order Number
     C                   Z-ADD     WGT4NY        WL0006                         LX01 Sequence N
     C                   Z-ADD     WGAXNZ        WL0007                         EDI Case Sequen
     C                   Z-ADD     WGA1NZ        WL0008                         EDI Ref Sequenc
     C                   Z-ADD     YL0009        WL0009                         Load ID
     C                   Z-ADD     YL0031        WL0010                         Item Code
     C                   Z-ADD     YL0029        WL0011                         Manifest Pallet
     C                   Z-ADD     YL0033        WL0012                         PT Serial Numbe
     C                   Z-ADD     1             WL0013                         Quantity Receiv
     C                   Z-ADD     WGPXWG        WL0014                         Weight Received
     C                   MOVEL(P)  WHVYAA        WL0015                         UOM
     C                   MOVEL(P)  WHHFU1        WL0016                         Warehouse Lot N
     C                   EVAL      WL0017 = ' '                                 Receiving Condi
     C                   EVAL      WL0018 = ' '                                 Damage Reason C
     C                   EVAL      WL0019 = ' '                                 Inventory Updat
     C                   Z-ADD     YL0011        WL0020                         MDER Receipt Da
     C                   Z-ADD     ##JTM         WL0021                         MDER Receipt Ti
     C                   EVAL      WL0022 = ' '                                 MDER Error Sts
     C                   EVAL      WL0023 = ' '                                 MDER Unused Sts
     C                   Z-ADD     YL0035        WL0024                         MDER Production
     C                   Z-ADD     *ZERO         WL0025                         MDER Unused nbr
     C                   Z-ADD     *ZERO         WL0026                         MDER Unused Qty
     C                   EVAL      WL0027 = ' '                                 MDER Unused Txt
     C                   EXSR      SQCRRC
     C     KRSSP         READE     @A0CPCJ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SPEXIT        ENDSR
      /EJECT
     CSR   SQCRRC        BEGSR
      *================================================================
      * CRT Manifest Dtl EDI   CR - Manifest Detail EDI Rcpt  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0185                         Job Time
     C                   EVAL      WN0186 = ' '                                 User Id
     C                   EVAL      WN0187 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0188                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @AOCPA2
     C                   Z-ADD     WL0004        WKAIC3                         Company Number
     C                   Z-ADD     WL0005        WKC4NB                         Order Number
     C                   Z-ADD     WL0006        WKT4NY                         LX01 Sequence N
     C                   Z-ADD     WL0007        WKAXNZ                         EDI Case Sequen
     C                   Z-ADD     WL0008        WKA1NZ                         EDI Ref Sequenc
     C                   Z-ADD     WL0009        WKRMNB                         Load ID
     C                   Z-ADD     WL0010        WKHGCD                         Item Code
     C                   Z-ADD     WL0011        WKH7NY                         Manifest Pallet
     C                   Z-ADD     WL0012        WKPFNX                         PT Serial Numbe
     C                   Z-ADD     WL0013        WKSIQT                         Quantity Receiv
     C                   Z-ADD     WL0014        WKP5WG                         Weight Received
     C                   MOVEL     WL0015        WKWDAA                         UOM
     C                   MOVEL     WL0016        WKHMU1                         Warehouse Lot N
     C                   MOVEL     WL0017        WKWBAA                         Receiving Condi
     C                   MOVEL     WL0018        WKWCAA                         Damage Reason C
     C                   MOVEL     WL0019        WKPMST                         Inventory Updat
     C                   Z-ADD     WL0020        WKWSDT                         MDER Receipt Da
     C                   Z-ADD     WL0021        WKEETM                         MDER Receipt Ti
     C                   MOVEL     WL0022        WKE1SC                         MDER Error Sts
     C                   MOVEL     WL0023        WKGVSC                         MDER Unused Sts
     C                   Z-ADD     WL0024        WKWTDT                         MDER Production
     C                   Z-ADD     WL0025        WKCHNZ                         MDER Unused nbr
     C                   Z-ADD     WL0026        WKSKQT                         MDER Unused Qty
     C                   MOVEL     WL0027        WKIDU1                         MDER Unused Txt
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                   Z-ADD     ##JTM         WKAATM                         Job Time
     C                   MOVEL     ##USR         WKAYNA                         User Id
     C                   MOVEL     ##JOB         WKA0NA                         Job Name
     C                   Z-ADD     ##JDT         WKAXDT                         Job Date
     C                   MOVEL     ##PGM         WKA0NA                         Job Name
     C     KLCRSQ        KLIST
     C                   KFLD                    WKAIC3                         Company Number
     C                   KFLD                    WKC4NB                         Order Number
     C                   KFLD                    WKT4NY                         LX01 Sequence N
     C                   KFLD                    WKAXNZ                         EDI Case Sequen
     C                   KFLD                    WKA1NZ                         EDI Ref Sequenc
      * Check for duplicate primary key
     C     KLCRSQ        SETLL     @AOCPA2                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5012'     W0RTN
      * Send message 'Manifest Detail EDI Rc EX'
     C                   MOVEL     'USR5012'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SQEXIT
     C                   ENDIF
      *
     C                   WRITE     @AOCPA2                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SQEXIT        ENDSR
      /EJECT
     CSR   SRRVGN        BEGSR
      *================================================================
      * VAL Date               RT - Calendar  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSR         KLIST
     C                   KFLD                    WLAIC3                         Company Number
     C                   KFLD                    WLBCDT                         Post to G_L Dat
      * Setup key
     C                   Z-ADD     YL0004        WLAIC3                         Company Number
     C                   Z-ADD     YL0047        WLBCDT                         Post to G_L Dat
      * Establish starting position
     C     KRSSR         CHAIN     @AFREBE                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0018'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SREXIT
     C                   ENDIF
      *
      *================================================================
     CSR   SREXIT        ENDSR
      /EJECT
     CSR   SSRVGN        BEGSR
      *================================================================
      * RTV Unit Weight/UM Prm RT - Company Item  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSS         KLIST
     C                   KFLD                    WMAIC3                         Company Number
     C                   KFLD                    WMHGCD                         Item Code
      * Setup key
     C                   Z-ADD     YL0004        WMAIC3                         Company Number
     C                   Z-ADD     YL0041        WMHGCD                         Item Code
      * Establish starting position
     C     KRSSS         CHAIN     @BZREJU                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0326'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0048 = ' '                                 UOM Primary
     C                   Z-ADD     *ZERO         YL0049                         Unit Weight
     C                   GOTO      SSEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WMADCD        YL0048                         UOM Primary
     C                   Z-ADD     WMAIWG        YL0049                         Unit Weight
     C                   ENDIF
      *================================================================
     CSR   SSEXIT        ENDSR
      /EJECT
     CSR   STRVGN        BEGSR
      *================================================================
      * Rtv Inventory Update  RT - EDI WHS Interchange  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0053 = ' '                                 EDI Inventory U
      * Define keylist
     C     KRSST         KLIST
     C                   KFLD                    WEAJCD                         Warehouse Code
     C                   KFLD                    WEM4AA                         Interchange Cod
      * Setup key
     C                   MOVEL     YL0052        WEAJCD                         Warehouse Code
     C                   MOVEL     'WHSTAD'      WEM4AA                         Interchange Cod
      * Establish starting position
     C     KRSST         CHAIN     @G0REJZ                            90        *
      * Data record not found
     C   90              MOVEL     'USR4409'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WEJCSC        YL0053                         EDI Inventory U
     C                   ENDIF
      *================================================================
     CSR   STEXIT        ENDSR
      /EJECT
     CSR   SUCHRC        BEGSR
      *================================================================
      * CHG WHS StckTxf ADV HD CH - EDI WHS Stock Txf ADV HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @AICPAJ
     C                   Z-ADD     WAH9NY        WOH9NY                         EDI SURROGATE N
      *
     C     KLCHSU        KLIST
     C                   KFLD                    WOH9NY                         EDI SURROGATE N
     C     KLCHSU        CHAIN     @AICPAJ                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'ECP065L0'    MDACP
     C                   MOVEL     '@AICPAJ'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SUEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SUEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QECP01        YBRDCS
      * Move non-key fields to @AICPAJ
     C                   MOVEL(P)  WAHPAA        WOHPAA                         TRADE PARTNER C
     C                   MOVEL(P)  WN0001        WOA0ST                         EDI-Record Proc
     C                   MOVEL(P)  WAETSC        WOETSC                         W1701 Reporting
     C                   MOVEL(P)  WAAUNZ        WOAUNZ                         W1702 Receipt D
     C                   MOVEL(P)  WAHCU1        WOHCU1                         W1703 Warehouse
     C                   MOVEL(P)  WAAVNZ        WOAVNZ                         W1704 Depositor
     C                   MOVEL(P)  WAAWNZ        WOAWNZ                         W1705 Shipment
     C                   MOVEL(P)  WAEUSC        WOEUSC                         W0801 Transport
     C                   MOVEL(P)  WAHEU1        WOHEU1                         W0802 SCAC Carr
     C                   MOVEL(P)  WAHDU1        WOHDU1                         W0803 Routing
     C                   MOVEL(P)  WAV6AA        WOV6AA                         G6201 ARRIV DAT
     C                   MOVEL(P)  WAWPDT        WOWPDT                         G6202 ARRIV DAT
     C                   MOVEL(P)  WAEWSC        WOEWSC                         G6203 ARRIV TIM
     C                   MOVEL(P)  WAV8AA        WOV8AA                         G6204 ARRIV TIM
     C                   MOVEL(P)  WAV7AA        WOV7AA                         G6205 ARRIV TIM
     C                   MOVEL(P)  WAWQDT        WOWQDT                         G6201 UNLD DATE
     C                   MOVEL(P)  WAEXSC        WOEXSC                         G6202 UNLD DATE
     C                   MOVEL(P)  WAEYSC        WOEYSC                         G6203 UNLD TIME
     C                   MOVEL(P)  WAHKU1        WOHKU1                         G6204 UNLD TIME
     C                   MOVEL(P)  WAV9AA        WOV9AA                         G6205 UNLD TIME
     C                   MOVEL(P)  WAWRDT        WOWRDT                         G6201 SPOT UNLD
     C                   MOVEL(P)  WAEZSC        WOEZSC                         G6202 SPOT UNLD
     C                   MOVEL(P)  WAE0SC        WOE0SC                         G6203 SPOT UNLD
     C                   MOVEL(P)  WAHLU1        WOHLU1                         G6204 SPOT UNLD
     C                   MOVEL(P)  WAWAAA        WOWAAA                         G6205 SPOT UNLD
     C                   Z-ADD     WAA0NZ        WOA0NZ                         W1401 Total Qty
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QECP01 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @AICPAJ                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    ECP065L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SUEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Format Data
      *================================================================
      * Substring Out the Pallet ID, Position 11 for 9 bytes.
      * EUS TrimL Pallet ID    US - EDI WHS Stock Txf ADV MAN  * 
     c                   eval      YL0037 = %subst(%triml(WFHGU1):11:9)
      * CASE: LCL.Pallet ID USR is NE Blanks
      * Cvt Pallet ID to Nbr   US - /UT User Source  * 
     C                   IF        YL0037 <> ' '
     c                   eval      YL0038 = %dec(%trim(YL0037) : 9:0)
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0038                         Manifest Pallet
     C                   END                                                    *FI
      * Item Code.
      * EUS TrimL Prod ID Code US - EDI WHS Stock Txf ADV DTL  * 
     c                   eval      YL0039 = %triml(WHF3C7)
     C                   MOVE      YL0039        YL0040                         Item Code 5.0
     C                   Z-ADD     YL0040        YL0041                         Item Code
      * Production Date.
      * CASE: DB1.W0708 Warehouse Lot Nbr is Entered
     C                   IF        WHHFU1 > ' '
     C                   MOVEL     WHHFU1        YL0042                         Date (Char-6) U
      * Val Numeric Digit     US - /UT User Source  * 
     c                   Monitor
     c                   If        %check(digits : %trim(YL0042)) = 0
     c                   eval      YL0043 = 'Y'
     c                   else
     c                   eval      YL0043 = 'N'
     c                   endif
     c                   On-Error  00105                                        Do Nothing
     c                   EndMon
      * Date Pass Digit Check?
      * CASE: LCL.Validation Pass USR is No
     C                   IF        YL0043 = 'N'
     C                   ELSE
      * CASE: *OTHERWISE
      * ?? format date from mmddyy
     C                   Z-ADD     4             YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00006 OR
     C                             ZQ > 00006
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0042:ZQ     YL0044                 90      Month/Day Alpha
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     2             YRSW00
     C                   Z-ADD     5             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00006 OR
     C                             ZQ > 00006
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0042:ZQ     YL0045                 90      Year  (Char) US
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     *ZERO         ZQ
     C     YL0045        CAT(P)    YL0044:ZQ     YL0042                         Date (Char-6) U
     C                   Z-ADD     *ZERO         ZQ
     C     '1'           CAT(P)    YL0042:ZQ     YL0046                         Date (Alpha) US
     C                   MOVE      YL0046        YL0047                         MDER Production
     C                   END                                                    *FI
      * RMC 9/13/21
      * output 0 date if date is invalid - CB from CP will have order# he
      * VAL Date               RT - Calendar  * 
     C                   EXSR      SRRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C                   IF        W0RTN = @CN(001)
     C                   Z-ADD     *ZERO         YL0047                         MDER Production
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0047                         MDER Production
     C                   END                                                    *FI
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   XCVFA         BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C                   IF        XDAY1 > 109267
     C                   ADD       2             XDAY1
     C                   ELSE
     C                   IF        XDAY1 > 36218
     C                   ADD       1             XDAY1
     C                   END
     C                   END
      * Full years (up to the date)
     C     XDAY1         DIV       365.25        XDWK1
     C                   MVR                     XDWK3
     C                   Z-ADD     XDWK1         XDINYY
      * The date is the end of a year
     C                   IF        XDWK3 = 0
     C                   Z-ADD     12            XDINMM
     C                   Z-ADD     31            XDINDD
     C                   ELSE
      * Year days up to the date
     C     XDWK1         MULT      365.25        XDWK2
     C                   SUB       XDWK2         XDAY1
     C                   ADD       1             XDINYY
      * Leap year ?
     C     XDINYY        DIV       4             XDWK1
     C                   MVR                     XDWK1
      * March 1 (relative day of the year)
     C                   IF        XDWK1 = 0
     C                   Z-ADD     60            XDWK1
     C                   ELSE
     C                   Z-ADD     59            XDWK1
     C                   END
      * Define date base month and offset day -
      *  - January (thru February)
     C                   IF        XDAY1 <= XDWK1
     C                   Z-ADD     1             XDINMM
     C                   ELSE
     C                   SUB       XDWK1         XDAY1
      *  - March (thru July)
     C                   IF        XDAY1 <= 153
     C                   Z-ADD     3             XDINMM
     C                   ELSE
      *  - August (thru December)
     C                   Z-ADD     8             XDINMM
     C                   SUB       153           XDAY1
     C                   END
      * Calculate 2 month base and offset day
     C     XDAY1         SUB       1             XDWK1
     C                   DIV       61            XDWK1
     C                   MVR                     XDAY1
     C                   ADD       1             XDAY1
     C                   MULT      2             XDWK1
     C                   ADD       XDWK1         XDINMM
     C                   END
      * Calculate date increment,
     C                   IF        XDAY1 > 31
     C                   ADD       1             XDINMM
     C                   SUB       31            XDAY1
     C                   END
     C                   Z-ADD     XDAY1         XDINDD
     C                   END
      *================================================================
     CSR   XCVFAE        ENDSR
      /EJECT
     CSR   XCVTA         BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C     XDINYY        SUB       1             XDWK1
     C     XDWK1         MULT      365.25        XDAY1
     C                   IF        XDWK1 >= 300
     C                   SUB       2             XDAY1
     C                   ELSE
     C                   IF        XDWK1 >= 100
     C                   SUB       1             XDAY1
     C                   END
     C                   END
      * (from the beginning of the year to the beginning of the month:)
     C     XDINMM        SUB       1             XDWK1
      *     ...+31*(MM-1) (for January-February) ...
     C                   IF        XDINMM < 3
     C                   MULT      31            XDWK1
     C                   ADD       XDWK1         XDAY1
     C                   ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                   MULT      30            XDWK1
     C                   ADD       XDWK1         XDAY1
      *         ...-2 (for preceding February) ...
     C                   SUB       2             XDAY1
      *         ...+1 (for preceding February, if leap year) ...
     C                   IF        XDINYY <> 100 AND
     C                             XDINYY <> 300
     C     XDINYY        DIV       4             XDWK1
     C                   MVR                     XDWK1
     C                   IF        XDWK1 = 0
     C                   ADD       1             XDAY1
     C                   END
     C                   END
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C                   IF        XDINMM < 8
     C     XDINMM        MULT      .5            XDWK1
     C                   ADD       XDWK1         XDAY1
     C                   ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C     XDINMM        ADD       1             XDWK1
     C                   MULT      .5            XDWK1
     C                   ADD       XDWK1         XDAY1
     C                   END
     C                   END
      * ...+DD (days in the month up to the ending date)
     C                   ADD       XDINDD        XDAY1
      *================================================================
     CSR   XCVTAE        ENDSR
      /EJECT
     CSR   XDADY         BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
      * None days of week selected
     C                   IF        XDURR = 0 OR
     C                             XDWSL = 0
     C                   Z-ADD     XDAY2         XDAY1
      * Return Code: Unable to increment date.
     C                   IF        XDURR <> *ZERO
     C                   MOVEL     'Y2U0059'     W0RTN
     C                   ENDIF
     C                   GOTO      XDADYE
     C                   ENDIF
      * All days of week selected
     C                   IF        XDWSL = 7
     C     XDAY2         ADD       XDURR         XDAY1
     C                   GOTO      XDADYM
     C                   ENDIF
      * Some days of week selected
     C                   IF        XDURR >= 0
     C                   Z-ADD     1             XDSTP
     C                   ELSE
     C                   Z-ADD     -1            XDSTP
     C                   ENDIF
      * Get number of full weeks in the duration
     C     XDURR         DIV       XDWSL         XDWNB
      * Isolate the last week
     C                   MVR                     XDLSW
     C                   IF        XDLSW = 0
     C     XDWSL         MULT      XDSTP         XDLSW
     C                   SUB       XDSTP         XDWNB
     C                   ENDIF
      * Increment the date by the full weeks
     C     XDWNB         MULT      7             XDWK1
     C     XDAY2         ADD       XDWK1         XDAY1
      * Determine day of week of the beginning date
     C     XDAY2         ADD       3             YY
     C                   DIV       7             YY
     C                   MVR                     YY
     C                   IF        YY = 0
     C                   Z-ADD     7             YY
     C                   ENDIF
      * Loop: Increment the date by the last week
      * Increment the date
     C                   DOW       XDLSW <> 0
     C                   ADD       XDSTP         XDAY1
      * Increment the day of week
     C                   ADD       XDSTP         YY
      * Put day of week into the range 1-7
     C                   IF        YY = 0
     C                   Z-ADD     7             YY
     C                   ELSE
     C                   IF        YY = 8
     C                   Z-ADD     1             YY
     C                   ELSE
     C                   IF        YY = -1
     C                   Z-ADD     6             YY
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * Selected day of the last week has been processed
     C                   IF        YDOW(YY) = XDSEL
     C                   SUB       XDSTP         XDLSW
     C                   ENDIF
      * End of loop
     C                   ENDDO
     C     XDADYM        TAG
     C                   IF        XDINDD < 1
     C                   Z-ADD     1             XDINDD
     C                   MOVEL     'Y2U0006'     W0RTN
     C                   ENDIF
      *================================================================
     CSR   XDADYE        ENDSR
      /EJECT
     CSR   XDOWS         BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                   MOVEA     XDCDW         YDOW
     C                   Z-ADD     0             XDWSL
     C                   Z-ADD     1             YY
     C                   DOW       YY <= 7
     C                   IF        YDOW(YY) = XDSEL
     C                   ADD       1             XDWSL
     C                   END
     C                   ADD       1             YY
     C                   END
      *================================================================
     CSR   XDOWSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAH9NY                         EDI SURROGATE N
     C                   Z-ADD     *ZERO         WAA0NZ                         W1401 Total Qty
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WBBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WBB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WBA0DT                         Order Date
     C                   Z-ADD     *ZERO         WBA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WBGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WBACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WBAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WBCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WBJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WBA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WBEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WBAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WBRMNB                         Load ID
     C                   Z-ADD     *ZERO         WBTBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WBR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WBRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WBATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WBRSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WBT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WBCONB                         Invoice Number
     C                   Z-ADD     *ZERO         WBAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WBVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WBB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WBNODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WBNPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WBNQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WBNRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WBNSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WBBPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WBBQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WBBRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WBBSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WBBTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WBH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WBH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WBH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WBH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WBH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WBC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCH9NY                         EDI SURROGATE N
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDAIC3                         Company Number
     C                   Z-ADD     *ZERO         WDBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WDR5NB                         Deliver after t
     C                   Z-ADD     *ZERO         WDR6NB                         Deliver before
     C                   Z-ADD     *ZERO         WDTBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WDMTCU                         Mileage To Cust
     C                   Z-ADD     *ZERO         WDW2NB                         Co_Cust Overage
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEF5NZ                         EDI Company # 9
     C                   Z-ADD     *ZERO         WEF6NZ                         Hold til ship w
     C                   Z-ADD     *ZERO         WEMJDT                         Create Date
     C                   Z-ADD     *ZERO         WEBETM                         Create Time
     C                   Z-ADD     *ZERO         WEMKDT                         Change Date
     C                   Z-ADD     *ZERO         WEBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WFH9NY                         EDI SURROGATE N
     C                   Z-ADD     *ZERO         WFT4NY                         LX01 Sequence N
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WGH9NY                         EDI SURROGATE N
     C                   Z-ADD     *ZERO         WGT4NY                         LX01 Sequence N
     C                   Z-ADD     *ZERO         WGAXNZ                         EDI Case Sequen
     C                   Z-ADD     *ZERO         WGA1NZ                         EDI Ref Sequenc
     C                   Z-ADD     *ZERO         WGPXWG                         N903 Reference
     C                   Z-ADD     *ZERO         WGA4NZ                         N904 Production
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WHH9NY                         EDI SURROGATE N
     C                   Z-ADD     *ZERO         WHT4NY                         LX01 Sequence N
     C                   Z-ADD     *ZERO         WHAXNZ                         EDI Case Sequen
     C                   Z-ADD     *ZERO         WHSGQT                         W0701 Quantity
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WIAIC3                         Company Number
     C                   Z-ADD     *ZERO         WIC4NB                         Order Number
     C                   Z-ADD     *ZERO         WIRMNB                         Load ID
     C                   Z-ADD     *ZERO         WIRUNB                         Stop_Drop Seque
     C                   Z-ADD     *ZERO         WIQWDT                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WIQXDT                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WIQYDT                         OHE Arrival Dat
     C                   Z-ADD     *ZERO         WIGINY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WIGFNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WIGGNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WIGHNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WIHEVL                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WIHFVL                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WIHGVL                         Transload Termi
     C                   Z-ADD     *ZERO         WIQZDT                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WIQ0DT                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WIQ1DT                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WIQ2DT                         OHE Actual Ship
     C                   Z-ADD     *ZERO         WIITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WIQJNY                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WIQKNY                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WIQLNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WIP8NY                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WIP9NY                         OHE Port Check
     C                   Z-ADD     *ZERO         WIQANY                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WIQCNY                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WIQDNY                         OHE Load Sched
     C                   Z-ADD     *ZERO         WIQENY                         Original Appoin
     C                   Z-ADD     *ZERO         WIQFNY                         Original Appoin
     C                   Z-ADD     *ZERO         WIQGNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WIQHNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WIQINY                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WIQMNY                         OHE Orig ABS Fr
     C                   Z-ADD     *ZERO         WIW5DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WIW6DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WIAATM                         Job Time
     C                   Z-ADD     *ZERO         WIAXDT                         Job Date
      * Clear all neither parameters
      * CRT OHE EDI 944 Action CR - Order Header Extension  * 
     C                   Z-ADD     *ZERO         WJRUNB                         Stop_Drop Seque
     C                   Z-ADD     *ZERO         WJQWDT                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WJQXDT                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WJQYDT                         OHE Arrival Dat
     C                   Z-ADD     *ZERO         WJGINY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WJGFNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WJGGNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WJGHNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WJHEVL                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WJHFVL                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WJHGVL                         Transload Termi
     C                   Z-ADD     *ZERO         WJQZDT                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WJQ0DT                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WJQ1DT                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WJITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WJQJNY                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WJQKNY                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WJQLNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WJP8NY                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WJP9NY                         OHE Port Check
     C                   Z-ADD     *ZERO         WJQANY                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WJQCNY                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WJQDNY                         OHE Load Sched
     C                   Z-ADD     *ZERO         WJQENY                         Original Appoin
     C                   Z-ADD     *ZERO         WJQFNY                         Original Appoin
     C                   Z-ADD     *ZERO         WJQGNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WJQHNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WJQINY                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WJQMNY                         OHE Orig ABS Fr
     C                   Z-ADD     *ZERO         WJW5DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WJW6DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WJAATM                         Job Time
     C                   Z-ADD     *ZERO         WJAXDT                         Job Date
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WKAIC3                         Company Number
     C                   Z-ADD     *ZERO         WKC4NB                         Order Number
     C                   Z-ADD     *ZERO         WKT4NY                         LX01 Sequence N
     C                   Z-ADD     *ZERO         WKAXNZ                         EDI Case Sequen
     C                   Z-ADD     *ZERO         WKA1NZ                         EDI Ref Sequenc
     C                   Z-ADD     *ZERO         WKRMNB                         Load ID
     C                   Z-ADD     *ZERO         WKHGCD                         Item Code
     C                   Z-ADD     *ZERO         WKH7NY                         Manifest Pallet
     C                   Z-ADD     *ZERO         WKPFNX                         PT Serial Numbe
     C                   Z-ADD     *ZERO         WKSIQT                         Quantity Receiv
     C                   Z-ADD     *ZERO         WKP5WG                         Weight Received
     C                   Z-ADD     *ZERO         WKWSDT                         MDER Receipt Da
     C                   Z-ADD     *ZERO         WKEETM                         MDER Receipt Ti
     C                   Z-ADD     *ZERO         WKWTDT                         MDER Production
     C                   Z-ADD     *ZERO         WKCHNZ                         MDER Unused nbr
     C                   Z-ADD     *ZERO         WKSKQT                         MDER Unused Qty
     C                   Z-ADD     *ZERO         WKAATM                         Job Time
     C                   Z-ADD     *ZERO         WKAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WLAIC3                         Company Number
     C                   Z-ADD     *ZERO         WLBCDT                         Post to G_L Dat
     C                   Z-ADD     *ZERO         WLCQNB                         Julian Date
     C                   Z-ADD     *ZERO         WLESNB                         Accounting Year
     C                   Z-ADD     *ZERO         WLETNB                         Accounting Peri
     C                   Z-ADD     *ZERO         WLBZNB                         OM Week
     C                   Z-ADD     *ZERO         WLEINB                         Week Number
     C                   Z-ADD     *ZERO         WLAQNB                         Billing Cycle
     C                   Z-ADD     *ZERO         WLOJDT                         HPS PIC Date
     C                   Z-ADD     *ZERO         WLNQNX                         HPS Calendar Ye
     C                   Z-ADD     *ZERO         WLNRNX                         HPS Calendar We
     C                   Z-ADD     *ZERO         WLOKDT                         Calendar Unused
     C                   Z-ADD     *ZERO         WLOLDT                         Calendar Unused
     C                   Z-ADD     *ZERO         WLAATM                         Job Time
     C                   Z-ADD     *ZERO         WLAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WMAIC3                         Company Number
     C                   Z-ADD     *ZERO         WMHGCD                         Item Code
     C                   Z-ADD     *ZERO         WMAWPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WMAXPC                         Conversion Fact
     C                   Z-ADD     *ZERO         WMAIWG                         Unit Weight
     C                   Z-ADD     *ZERO         WMCZWG                         Minimum Weight
     C                   Z-ADD     *ZERO         WMC0WG                         Maximum Weight
     C                   Z-ADD     *ZERO         WMURTN                         Number Cases On
     C                   Z-ADD     *ZERO         WMAJC8                         Vendor Item Def
     C                   Z-ADD     *ZERO         WMRINB                         Item Structure
     C                   Z-ADD     *ZERO         WMRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WMRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WMTFNB                         Transportation
     C                   Z-ADD     *ZERO         WMTMVA                         Maximum Audit V
     C                   Z-ADD     *ZERO         WMTNVA                         Minimum Audit V
     C                   Z-ADD     *ZERO         WMBLPR                         Market Overage
     C                   Z-ADD     *ZERO         WMBMPR                         Standard Overag
     C                   Z-ADD     *ZERO         WMCMCO                         Item Pricing Co
     C                   Z-ADD     *ZERO         WMCHTM                         Fresh Chilling
     C                   Z-ADD     *ZERO         WMSWGH                         Std Weight_Head
     C                   Z-ADD     *ZERO         WMPPHE                         Pieces Per Head
     C                   Z-ADD     *ZERO         WMICN1                         Item Category N
     C                   Z-ADD     *ZERO         WMICN2                         Item Category N
     C                   Z-ADD     *ZERO         WMV2NB                         Item Category N
     C                   Z-ADD     *ZERO         WMITCN                         Item Category N
     C                   Z-ADD     *ZERO         WMITC5                         Item Category N
     C                   Z-ADD     *ZERO         WMICN6                         Item Category N
     C                   Z-ADD     *ZERO         WMICN7                         Item Category N
     C                   Z-ADD     *ZERO         WMICN8                         Item Category N
     C                   Z-ADD     *ZERO         WMICN9                         Item Category N
     C                   Z-ADD     *ZERO         WMICN0                         Item Category N
     C                   Z-ADD     *ZERO         WMSFNB                         Pallet Tare Wei
     C                   Z-ADD     *ZERO         WMA3WG                         Misc Tare Weigh
     C                   Z-ADD     *ZERO         WMSJNB                         Production Lead
     C                   Z-ADD     *ZERO         WMSKNB                         Agrimetrics gro
     C                   Z-ADD     *ZERO         WMSLNB                         Agrimetrics pac
     C                   Z-ADD     *ZERO         WMSMNB                         Agrimetrics gra
     C                   Z-ADD     *ZERO         WMCFNB                         PM Pounds per H
     C                   Z-ADD     *ZERO         WMCGNB                         Item Frt Overag
     C                   Z-ADD     *ZERO         WMILNB                         Packages per ca
     C                   Z-ADD     *ZERO         WMCHNB                         Use_Freeze_Sell
     C                   Z-ADD     *ZERO         WMCINB                         PM Batch Size
     C                   Z-ADD     *ZERO         WMCJNB                         Package Level s
     C                   Z-ADD     *ZERO         WMCMNB                         Partial Item Co
     C                   Z-ADD     *ZERO         WMCNNB                         WIP Item Code
     C                   Z-ADD     *ZERO         WMCRNB                         WIP Reject Code
     C                   Z-ADD     *ZERO         WMCSNB                         Std Costing Uni
     C                   Z-ADD     *ZERO         WMCVNB                         FP Std Green We
     C                   Z-ADD     *ZERO         WMCWNB                         PM Std LBS Man
     C                   Z-ADD     *ZERO         WMCXNB                         PM Raw Meat LBS
     C                   Z-ADD     *ZERO         WMCZNB                         PM Formula LBS
     C                   Z-ADD     *ZERO         WMC0NB                         PM Finished LBS
     C                   Z-ADD     *ZERO         WMB4NB                         PM Raw Material
     C                   Z-ADD     *ZERO         WMB5NB                         PM Line Number
     C                   Z-ADD     *ZERO         WMBDNB                         Pieces Per Bag
     C                   Z-ADD     *ZERO         WMBJNB                         Bags Per Unit
     C                   Z-ADD     *ZERO         WMF5WG                         Item Target Pri
     C                   Z-ADD     *ZERO         WMF6WG                         Minimum Piece W
     C                   Z-ADD     *ZERO         WMF7WG                         Maximum Piece W
     C                   Z-ADD     *ZERO         WMBLNB                         Seaboard Equiva
     C                   Z-ADD     *ZERO         WMBNNB                         Production Qty
     C                   Z-ADD     *ZERO         WMAATM                         Job Time
     C                   Z-ADD     *ZERO         WMAXDT                         Job Date
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        YRSW00                         *Synon (5,0) wo
     C                   Z-ADD     *ZEROS        YRSW01                         *Synon (5,0) wo
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SDRVGN.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   EVAL      WL0003 = ' '
      * Define local variables for subroutine SQCRRC.
     C                   Z-ADD     *ZERO         WL0004
     C                   Z-ADD     *ZERO         WL0005
     C                   Z-ADD     *ZERO         WL0006
     C                   Z-ADD     *ZERO         WL0007
     C                   Z-ADD     *ZERO         WL0008
     C                   Z-ADD     *ZERO         WL0009
     C                   Z-ADD     *ZERO         WL0010
     C                   Z-ADD     *ZERO         WL0011
     C                   Z-ADD     *ZERO         WL0012
     C                   Z-ADD     *ZERO         WL0013
     C                   Z-ADD     *ZERO         WL0014
     C                   EVAL      WL0015 = ' '
     C                   EVAL      WL0016 = ' '
     C                   EVAL      WL0017 = ' '
     C                   EVAL      WL0018 = ' '
     C                   EVAL      WL0019 = ' '
     C                   Z-ADD     *ZERO         WL0020
     C                   Z-ADD     *ZERO         WL0021
     C                   EVAL      WL0022 = ' '
     C                   EVAL      WL0023 = ' '
     C                   Z-ADD     *ZERO         WL0024
     C                   Z-ADD     *ZERO         WL0025
     C                   Z-ADD     *ZERO         WL0026
     C                   EVAL      WL0027 = ' '
      * Define local work field Send Email f/Failed API U
     C                   EVAL      YL0001 = ' '
      * Define local work field Order Number
     C                   Z-ADD     *ZERO         YL0002
      * Define local work field Validation Pass USR
     C                   EVAL      YL0003 = ' '
      * Define local work field Company Number
     C                   Z-ADD     *ZERO         YL0004
      * Define local work field Order Type_Sales
     C                   EVAL      YL0005 = ' '
      * Define local work field Ship To Customer
     C                   Z-ADD     *ZERO         YL0006
      * Define local work field Actual Shipped Date
     C                   Z-ADD     *ZERO         YL0007
      * Define local work field Header Status
     C                   EVAL      YL0008 = ' '
      * Define local work field Load ID
     C                   Z-ADD     *ZERO         YL0009
      * Define local work field Receipt Date USR
     C                   Z-ADD     *ZERO         YL0010
      * Define local work field Receipt Date 2 USR
     C                   Z-ADD     *ZERO         YL0011
      * Define local work field Actual Ship Date Usr
     C                   Z-ADD     *ZERO         YL0012
      * Define local work field Invalid Ship To Whs USR
     C                   EVAL      YL0013 = ' '
      * Define local work field EDI Whs Duns Number
     C                   EVAL      YL0014 = ' '
      * Define local work field Ship To Warehouse
     C                   EVAL      YL0015 = ' '
      * Define null work field Class Code
     C                   EVAL      YN0001 = ' '
      * Define null work field EDI Trading Partner No
     C                   EVAL      YN0002 = ' '
      * Define null work field Record Status
     C                   EVAL      YN0003 = ' '
      * Define null work field Create Date
     C                   Z-ADD     *ZERO         YN0004
      * Define null work field Create Time
     C                   Z-ADD     *ZERO         YN0005
      * Define null work field Create User
     C                   EVAL      YN0006 = ' '
      * Define null work field Create Program
     C                   EVAL      YN0007 = ' '
      * Define null work field Change Date
     C                   Z-ADD     *ZERO         YN0008
      * Define null work field Change Time
     C                   Z-ADD     *ZERO         YN0009
      * Define null work field Change User
     C                   EVAL      YN0010 = ' '
      * Define null work field Change Program
     C                   EVAL      YN0011 = ' '
      * Define local work field Pallet ID USR
     C                   EVAL      YL0016 = ' '
      * Define local work field Validation Pass USR
     C                   EVAL      YL0017 = ' '
      * Define local work field PT Serial Number Txt USR
     C                   EVAL      YL0018 = ' '
      * Define local work field Validation Pass USR
     C                   EVAL      YL0019 = ' '
      * Define local work field Invalid UOM USR
     C                   EVAL      YL0020 = ' '
      * Define local work field Item Code Txt
     C                   EVAL      YL0021 = ' '
      * Define local work field Item Code 5A
     C                   EVAL      YL0022 = ' '
      * Define local work field Validation Pass USR
     C                   EVAL      YL0023 = ' '
      * Define local work field Item Code 5.0
     C                   Z-ADD     *ZERO         YL0024
      * Define local work field Item Code
     C                   Z-ADD     *ZERO         YL0025
      * Define local work field OHE EDI 944 Action
     C                   EVAL      YL0026 = ' '
      * Define local work field MDER Receipt Date
     C                   Z-ADD     *ZERO         YL0027
      * Define local work field Pallet ID USR
     C                   EVAL      YL0028 = ' '
      * Define local work field Manifest Pallet Number
     C                   Z-ADD     *ZERO         YL0029
      * Define local work field Item Code Txt
     C                   EVAL      YL0030 = ' '
      * Define local work field Item Code
     C                   Z-ADD     *ZERO         YL0031
      * Define local work field PT Serial Number Txt USR
     C                   EVAL      YL0032 = ' '
      * Define local work field PT Serial Number
     C                   Z-ADD     *ZERO         YL0033
      * Define local work field Production Date USR D8#
     C                   Z-ADD     *ZERO         YL0034
      * Define local work field MDER Production Date
     C                   Z-ADD     *ZERO         YL0035
      * Define local work field MDER Receipt Date
     C                   Z-ADD     *ZERO         YL0036
      * Define local work field Pallet ID USR
     C                   EVAL      YL0037 = ' '
      * Define local work field Manifest Pallet Number
     C                   Z-ADD     *ZERO         YL0038
      * Define local work field Item Code 5A
     C                   EVAL      YL0039 = ' '
      * Define local work field Item Code 5.0
     C                   Z-ADD     *ZERO         YL0040
      * Define local work field Item Code
     C                   Z-ADD     *ZERO         YL0041
      * Define local work field Date (Char-6) USR
     C                   EVAL      YL0042 = ' '
      * Define local work field Validation Pass USR
     C                   EVAL      YL0043 = ' '
      * Define local work field Month/Day Alpha MMDD
     C                   EVAL      YL0044 = ' '
      * Define local work field Year  (Char) USR
     C                   EVAL      YL0045 = ' '
      * Define local work field Date (Alpha) USR
     C                   EVAL      YL0046 = ' '
      * Define local work field MDER Production Date
     C                   Z-ADD     *ZERO         YL0047
      * Define local work field UOM Primary
     C                   EVAL      YL0048 = ' '
      * Define local work field Unit Weight
     C                   Z-ADD     *ZERO         YL0049
      * Define local work field Weight Received
     C                   Z-ADD     *ZERO         YL0050
      * Define local work field PT Serial Number
     C                   Z-ADD     *ZERO         YL0051
      * Define local work field Ship To Warehouse
     C                   EVAL      YL0052 = ' '
      * Define local work field EDI Inventory Update
     C                   EVAL      YL0053 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 Y2U0005
00002 DIVIDERS
00003 PUDLXFR
