     H/TITLE UPD Age A/R Cust Inv   XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISABANS
     H* Date          : 09/09/24  Time  : 06:29:35
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPMAIF  E           K        DISK
      * RSQ : Order Header TRG          AR Cust/Ord not C or
      *
     FOPEXREL1IF  E           K        DISK
      * RTV : Order Types               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FARBDCPL6IF  E           K        DISK
      * RSQ : AR Header New             Co/Customer AR        V
      *
     FPMADCPL1IF  E           K        DISK
      * RTV : AR Aging Control          Retrieval index
      *
     FARBDCPL8IF  E           K        DISK
      * RSQ : AR Header New             Co,Cust,Last Pay Date (D
      *
     FARBDCPLUIF  E           K        DISK
      * RSQ : AR Header New             Co/Bank/Date/Cust      N
      *
     FARBECPL1IF  E           K        DISK
      * RTV : AR Details N              Retrieval index       V
      *
     FARBDCPLAIF  E           K        DISK
      * RSQ : AR Header New             Co,Cust,PIF Date/IN,DM,C
      *
     FARBDCPLFIF  E           K        DISK
      * RSQ : AR Header New             RSQ Customer/All rec. NV
      *
     FARBECPL6IF  E           K        DISK
      * RSQ : AR Details N              Co/Inv All Records
      *
     FOPBFCPNCIF  E           K        DISK
      * RSQ : Order Header TRG          ArCust/InvDt, sel
      *
     FOPBFCPNDIF  E           K        DISK
      * RSQ : Order Header TRG          ArCust/OrdDt, sel 'OR
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPDLDCPL0UF  E           K        DISK                      A
      * UPD : AR Balance File           Update index
      *
     FARBCREL0UF  E           K        DISK
      * UPD : AR Summarys               Update index
      *
     E                    YDOW        7  1               *Days of week
     IZBFCPEH
      * Order Header TRG          AR Cust/Ord not C or
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@EXREYP
      * Order Types               Retrieval index
      * Renamed input format fields
     I              EXJNCD                          WBJNCD
     I              EXJVNA                          WBJVNA
     I              EXOAST                          WBOAST
     I              EXOBST                          WBOBST
     I              EXOEST                          WBOEST
     I              EXOFST                          WBOFST
     I              EXVBST                          WBVBST
     I              EXPYST                          WBPYST
     I              EXX8ST                          WBX8ST
     I              EXISTX                          WBISTX
     I              EXUVST                          WBUVST
     I              EXUWST                          WBUWST
     I              EXUXST                          WBUXST
     I              EXVSST                          WBVSST
     I              EXAATM                          WBAATM
     I              EXAYNA                          WBAYNA
     I              EXA0NA                          WBA0NA
     I              EXAXDT                          WBAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BDCPGB
      * AR Header New             Co/Customer AR        V
      * Renamed input format fields
     I              BDAIC3                          WFAIC3
     I              BDCONB                          WFCONB
     I              BDCEST                          WFCEST
     I              BDUHCD                          WFUHCD
     I              BDBSVA                          WFBSVA
     I              BDAIVA                          WFAIVA
     I              BDAOVA                          WFAOVA
     I              BDBGVA                          WFBGVA
     I              BDAJST                          WFAJST
     I              BDE3ST                          WFE3ST
     I              BDG4CD                          WFG4CD
     I              BDCKNB                          WFCKNB
     I              BDCAC7                          WFCAC7
     I              BDBKC7                          WFBKC7
     I              BDBCCD                          WFBCCD
     I              BDR4CD                          WFR4CD
     I              BDB4DT                          WFB4DT
     I              BDATDT                          WFATDT
     I              BDH0DT                          WFH0DT
     I              BDH3DT                          WFH3DT
     I              BDH4DT                          WFH4DT
     I              BDH5DT                          WFH5DT
     I              BDANC7                          WFANC7
     I              BDCPTX                          WFCPTX
     I              BDBSDY                          WFBSDY
     I              BDUVST                          WFUVST
     I              BDUWST                          WFUWST
     I              BDUXST                          WFUXST
     I              BDAATM                          WFAATM
     I              BDAYNA                          WFAYNA
     I              BDA0NA                          WFA0NA
     I              BDAXDT                          WFAXDT
      *
     I@ADCPHM
      * AR Aging Control          Retrieval index
      * Renamed input format fields
     I              ADG8AA                          WGG8AA
     I              ADAEDY                          WGAEDY
     I              ADAFDY                          WGAFDY
     I              ADAGDY                          WGAGDY
     I              ADAHDY                          WGAHDY
     I              ADEUST                          WGEUST
     I              ADA1TX                          WGA1TX
     I              ADUNUS                          WGUNUS
     I              ADUNU2                          WGUNU2
     I              ADUNU3                          WGUNU3
     I              ADFHNY                          WGFHNY
     I              ADQSDT                          WGQSDT
     I              ADQRDT                          WGQRDT
     I              ADI3T1                          WGI3T1
     I              ADVSST                          WGVSST
     I              ADMJDT                          WGMJDT
     I              ADBETM                          WGBETM
     I              ADCCVN                          WGCCVN
     I              ADCDVN                          WGCDVN
     I              ADMKDT                          WGMKDT
     I              ADBFTM                          WGBFTM
     I              ADCEVN                          WGCEVN
     I              ADCFVN                          WGCFVN
      *
     I@LDCPMI
      * AR Balance File           Update index
      * Renamed input format fields
     I              LDAIC3                          WHAIC3
     I              LDANC7                          WHANC7
     I              LDA1NB                          WHA1NB
     I              LDY4NB                          WHY4NB
     I              LDALVA                          WHALVA
     I              LDAIDT                          WHAIDT
     I              LDY5VA                          WHY5VA
     I              LDZAVA                          WHZAVA
     I              LDY7VA                          WHY7VA
     I              LDY8VA                          WHY8VA
     I              LDY9VA                          WHY9VA
     I              LDRTNX                          WHRTNX
     I              LDRUNX                          WHRUNX
     I              LDRVNX                          WHRVNX
     I              LDRWNX                          WHRWNX
     I              LDRXNX                          WHRXNX
     I              LDB4DY                          WHB4DY
     I              LDBSDY                          WHBSDY
     I              LDK2DT                          WHK2DT
     I              LDUNUS                          WHUNUS
     I              LDUNU2                          WHUNU2
     I              LDUVST                          WHUVST
     I              LDUWST                          WHUWST
     I              LDUXST                          WHUXST
     I              LDVSST                          WHVSST
     I              LDAATM                          WHAATM
     I              LDAYNA                          WHAYNA
     I              LDA0NA                          WHA0NA
     I              LDAXDT                          WHAXDT
      *
     I@BDCPMK
      * AR Header New             Co,Cust,Last Pay Date (D
      * Renamed input format fields
     I              BDAIC3                          WIAIC3
     I              BDCONB                          WICONB
     I              BDCEST                          WICEST
     I              BDUHCD                          WIUHCD
     I              BDBSVA                          WIBSVA
     I              BDAIVA                          WIAIVA
     I              BDAOVA                          WIAOVA
     I              BDBGVA                          WIBGVA
     I              BDAJST                          WIAJST
     I              BDE3ST                          WIE3ST
     I              BDG4CD                          WIG4CD
     I              BDCKNB                          WICKNB
     I              BDCAC7                          WICAC7
     I              BDBKC7                          WIBKC7
     I              BDBCCD                          WIBCCD
     I              BDR4CD                          WIR4CD
     I              BDB4DT                          WIB4DT
     I              BDATDT                          WIATDT
     I              BDH0DT                          WIH0DT
     I              BDH3DT                          WIH3DT
     I              BDH4DT                          WIH4DT
     I              BDH5DT                          WIH5DT
     I              BDANC7                          WIANC7
     I              BDCPTX                          WICPTX
     I              BDBSDY                          WIBSDY
     I              BDUVST                          WIUVST
     I              BDUWST                          WIUWST
     I              BDUXST                          WIUXST
     I              BDAATM                          WIAATM
     I              BDAYNA                          WIAYNA
     I              BDA0NA                          WIA0NA
     I              BDAXDT                          WIAXDT
      *
     I@BDCPD5
      * AR Header New             Co/Bank/Date/Cust      N
      * Renamed input format fields
     I              BDAIC3                          WJAIC3
     I              BDCONB                          WJCONB
     I              BDCEST                          WJCEST
     I              BDUHCD                          WJUHCD
     I              BDBSVA                          WJBSVA
     I              BDAIVA                          WJAIVA
     I              BDAOVA                          WJAOVA
     I              BDBGVA                          WJBGVA
     I              BDAJST                          WJAJST
     I              BDE3ST                          WJE3ST
     I              BDG4CD                          WJG4CD
     I              BDCKNB                          WJCKNB
     I              BDCAC7                          WJCAC7
     I              BDBKC7                          WJBKC7
     I              BDBCCD                          WJBCCD
     I              BDR4CD                          WJR4CD
     I              BDB4DT                          WJB4DT
     I              BDATDT                          WJATDT
     I              BDH0DT                          WJH0DT
     I              BDH3DT                          WJH3DT
     I              BDH4DT                          WJH4DT
     I              BDH5DT                          WJH5DT
     I              BDANC7                          WJANC7
     I              BDCPTX                          WJCPTX
     I              BDBSDY                          WJBSDY
     I              BDUVST                          WJUVST
     I              BDUWST                          WJUWST
     I              BDUXST                          WJUXST
     I              BDAATM                          WJAATM
     I              BDAYNA                          WJAYNA
     I              BDA0NA                          WJA0NA
     I              BDAXDT                          WJAXDT
      *
     I@BFCPFO
      * AR Details N              Retrieval index       V
      * Renamed input format fields
     I              BFAIC3                          WKAIC3
     I              BFCONB                          WKCONB
     I              BFCEST                          WKCEST
     I              BFDXNB                          WKDXNB
     I              BFUHCD                          WKUHCD
     I              BFBSVA                          WKBSVA
     I              BFCPTX                          WKCPTX
     I              BFNGNA                          WKNGNA
     I              BFB4DT                          WKB4DT
     I              BFDVDT                          WKDVDT
     I              BFYXNX                          WKYXNX
     I              BFHYDT                          WKHYDT
     I              BFG4CD                          WKG4CD
     I              BFCKNB                          WKCKNB
     I              BFA5ST                          WKA5ST
     I              BFAJST                          WKAJST
     I              BFB1VN                          WKB1VN
     I              BFEAZT                          WKEAZT
     I              BFC1NY                          WKC1NY
     I              BFIZTX                          WKIZTX
     I              BFETSX                          WKETSX
     I              BFW3SX                          WKW3SX
     I              BFW4SX                          WKW4SX
     I              BFW5SX                          WKW5SX
     I              BFW6SX                          WKW6SX
     I              BFW7SX                          WKW7SX
     I              BFW8SX                          WKW8SX
     I              BFQHDT                          WKQHDT
     I              BFQIDT                          WKQIDT
     I              BFQJDT                          WKQJDT
     I              BFQKDT                          WKQKDT
     I              BFQLDT                          WKQLDT
     I              BFGLVL                          WKGLVL
     I              BFGMVL                          WKGMVL
     I              BFGNVL                          WKGNVL
     I              BFGOVL                          WKGOVL
     I              BFGPVL                          WKGPVL
     I              BFUVST                          WKUVST
     I              BFUWST                          WKUWST
     I              BFUXST                          WKUXST
     I              BFAATM                          WKAATM
     I              BFAYNA                          WKAYNA
     I              BFA0NA                          WKA0NA
     I              BFAXDT                          WKAXDT
      *
     I@BDCPML
      * AR Header New             Co,Cust,PIF Date/IN,DM,C
      * Renamed input format fields
     I              BDAIC3                          WLAIC3
     I              BDCONB                          WLCONB
     I              BDCEST                          WLCEST
     I              BDUHCD                          WLUHCD
     I              BDBSVA                          WLBSVA
     I              BDAIVA                          WLAIVA
     I              BDAOVA                          WLAOVA
     I              BDBGVA                          WLBGVA
     I              BDAJST                          WLAJST
     I              BDE3ST                          WLE3ST
     I              BDG4CD                          WLG4CD
     I              BDCKNB                          WLCKNB
     I              BDCAC7                          WLCAC7
     I              BDBKC7                          WLBKC7
     I              BDBCCD                          WLBCCD
     I              BDR4CD                          WLR4CD
     I              BDB4DT                          WLB4DT
     I              BDATDT                          WLATDT
     I              BDH0DT                          WLH0DT
     I              BDH3DT                          WLH3DT
     I              BDH4DT                          WLH4DT
     I              BDH5DT                          WLH5DT
     I              BDANC7                          WLANC7
     I              BDCPTX                          WLCPTX
     I              BDBSDY                          WLBSDY
     I              BDUVST                          WLUVST
     I              BDUWST                          WLUWST
     I              BDUXST                          WLUXST
     I              BDAATM                          WLAATM
     I              BDAYNA                          WLAYNA
     I              BDA0NA                          WLA0NA
     I              BDAXDT                          WLAXDT
      *
     I@BDCPIJ
      * AR Header New             RSQ Customer/All rec. NV
      * Renamed input format fields
     I              BDAIC3                          WMAIC3
     I              BDCONB                          WMCONB
     I              BDCEST                          WMCEST
     I              BDUHCD                          WMUHCD
     I              BDBSVA                          WMBSVA
     I              BDAOVA                          WMAOVA
     I              BDBGVA                          WMBGVA
     I              BDAJST                          WMAJST
     I              BDE3ST                          WME3ST
     I              BDCAC7                          WMCAC7
     I              BDBKC7                          WMBKC7
     I              BDBCCD                          WMBCCD
     I              BDB4DT                          WMB4DT
     I              BDATDT                          WMATDT
     I              BDH0DT                          WMH0DT
     I              BDH3DT                          WMH3DT
     I              BDH4DT                          WMH4DT
     I              BDH5DT                          WMH5DT
     I              BDANC7                          WMANC7
     I              BDCPTX                          WMCPTX
     I              BDBSDY                          WMBSDY
     I              BDUVST                          WMUVST
     I              BDUWST                          WMUWST
     I              BDUXST                          WMUXST
     I              BDAATM                          WMAATM
     I              BDAYNA                          WMAYNA
     I              BDA0NA                          WMA0NA
     I              BDAXDT                          WMAXDT
      *
     I@BECPDS
      * AR Details N              Co/Inv All Records
      * Renamed input format fields
     I              BFAIC3                          WOAIC3
     I              BFCONB                          WOCONB
     I              BFCEST                          WOCEST
     I              BFDXNB                          WODXNB
     I              BFUHCD                          WOUHCD
     I              BFBSVA                          WOBSVA
     I              BFCPTX                          WOCPTX
     I              BFNGNA                          WONGNA
     I              BFB4DT                          WOB4DT
     I              BFDVDT                          WODVDT
     I              BFYXNX                          WOYXNX
     I              BFHYDT                          WOHYDT
     I              BFG4CD                          WOG4CD
     I              BFCKNB                          WOCKNB
     I              BFA5ST                          WOA5ST
     I              BFAJST                          WOAJST
     I              BFB1VN                          WOB1VN
     I              BFEAZT                          WOEAZT
     I              BFC1NY                          WOC1NY
     I              BFIZTX                          WOIZTX
     I              BFETSX                          WOETSX
     I              BFW3SX                          WOW3SX
     I              BFW4SX                          WOW4SX
     I              BFW5SX                          WOW5SX
     I              BFW6SX                          WOW6SX
     I              BFW7SX                          WOW7SX
     I              BFW8SX                          WOW8SX
     I              BFQHDT                          WOQHDT
     I              BFQIDT                          WOQIDT
     I              BFQJDT                          WOQJDT
     I              BFQKDT                          WOQKDT
     I              BFQLDT                          WOQLDT
     I              BFGLVL                          WOGLVL
     I              BFGMVL                          WOGMVL
     I              BFGNVL                          WOGNVL
     I              BFGOVL                          WOGOVL
     I              BFGPVL                          WOGPVL
     I              BFUVST                          WOUVST
     I              BFUWST                          WOUWST
     I              BFUXST                          WOUXST
     I              BFAATM                          WOAATM
     I              BFAYNA                          WOAYNA
     I              BFA0NA                          WOA0NA
     I              BFAXDT                          WOAXDT
      *
     I@BFCPOR
      * Order Header TRG          ArCust/InvDt, sel
      * Renamed input format fields
     I              BEAIC3                          WRAIC3
     I              BEC4NB                          WRC4NB
     I              BEJNCD                          WRJNCD
     I              BEANC7                          WRANC7
     I              BEBKC7                          WRBKC7
     I              BEBRTX                          WRBRTX
     I              BEHMNA                          WRHMNA
     I              BEHONA                          WRHONA
     I              BEHPNA                          WRHPNA
     I              BEHNNA                          WRHNNA
     I              BEDBCD                          WRDBCD
     I              BECKTX                          WRCKTX
     I              BEB0C7                          WRB0C7
     I              BEAETX                          WRAETX
     I              BEB1NA                          WRB1NA
     I              BEB3NA                          WRB3NA
     I              BEB4NA                          WRB4NA
     I              BEB2NA                          WRB2NA
     I              BEBHCD                          WRBHCD
     I              BEC8TX                          WRC8TX
     I              BEBCNA                          WRBCNA
     I              BEA0DT                          WRA0DT
     I              BEA5DT                          WRA5DT
     I              BEGNDT                          WRGNDT
     I              BEACDT                          WRACDT
     I              BEAQCD                          WRAQCD
     I              BEB6NA                          WRB6NA
     I              BEBYNA                          WRBYNA
     I              BEBZNA                          WRBZNA
     I              BEGTST                          WRGTST
     I              BEGVST                          WRGVST
     I              BEGUST                          WRGUST
     I              BEQFST                          WRQFST
     I              BECQCD                          WRCQCD
     I              BEGJST                          WRGJST
     I              BEGWST                          WRGWST
     I              BEGXST                          WRGXST
     I              BEGYST                          WRGYST
     I              BEAODT                          WRAODT
     I              BEAIVN                          WRAIVN
     I              BECXDT                          WRCXDT
     I              BEJZVA                          WRJZVA
     I              BEA1WG                          WRA1WG
     I              BEXIST                          WRXIST
     I              BEXJST                          WRXJST
     I              BEXKST                          WRXKST
     I              BEEIDT                          WREIDT
     I              BEAFTM                          WRAFTM
     I              BEE8CD                          WRE8CD
     I              BEE9CD                          WRE9CD
     I              BERMNB                          WRRMNB
     I              BETBNB                          WRTBNB
     I              BER1NB                          WRR1NB
     I              BEPJST                          WRPJST
     I              BEU0ST                          WRU0ST
     I              BEU1ST                          WRU1ST
     I              BEQ2CD                          WRQ2CD
     I              BEU2ST                          WRU2ST
     I              BEVEST                          WRVEST
     I              BEVFST                          WRVFST
     I              BEVGST                          WRVGST
     I              BERPCD                          WRRPCD
     I              BERNNB                          WRRNNB
     I              BEVDST                          WRVDST
     I              BEATIN                          WRATIN
     I              BEU4ST                          WRU4ST
     I              BEU5ST                          WRU5ST
     I              BERSRN                          WRRSRN
     I              BEMHNA                          WRMHNA
     I              BEMINA                          WRMINA
     I              BEWBST                          WRWBST
     I              BER4CD                          WRR4CD
     I              BEBFCD                          WRBFCD
     I              BEQ4CD                          WRQ4CD
     I              BET3NB                          WRT3NB
     I              BESICD                          WRSICD
     I              BECONB                          WRCONB
     I              BECEST                          WRCEST
     I              BEAWDT                          WRAWDT
     I              BEJPCD                          WRJPCD
     I              BEXUST                          WRXUST
     I              BEZ1ST                          WRZ1ST
     I              BEVRVA                          WRVRVA
     I              BEOBST                          WROBST
     I              BEBCST                          WRBCST
     I              BEBDST                          WRBDST
     I              BEB7VL                          WRB7VL
     I              BEGASX                          WRGASX
     I              BEGBSX                          WRGBSX
     I              BEGCSX                          WRGCSX
     I              BEGDSX                          WRGDSX
     I              BEFNSX                          WRFNSX
     I              BEFOSX                          WRFOSX
     I              BEFPSX                          WRFPSX
     I              BEFQSX                          WRFQSX
     I              BEFRSX                          WRFRSX
     I              BEFSSX                          WRFSSX
     I              BEFTSX                          WRFTSX
     I              BEFUSX                          WRFUSX
     I              BEFVSX                          WRFVSX
     I              BEFWSX                          WRFWSX
     I              BEFXSX                          WRFXSX
     I              BEFYSX                          WRFYSX
     I              BENODT                          WRNODT
     I              BENPDT                          WRNPDT
     I              BENQDT                          WRNQDT
     I              BENRDT                          WRNRDT
     I              BENSDT                          WRNSDT
     I              BEBPTM                          WRBPTM
     I              BEBQTM                          WRBQTM
     I              BEBRTM                          WRBRTM
     I              BEBSTM                          WRBSTM
     I              BEBTTM                          WRBTTM
     I              BEH0NX                          WRH0NX
     I              BEH1NX                          WRH1NX
     I              BEH2NX                          WRH2NX
     I              BEH3NX                          WRH3NX
     I              BEH4NX                          WRH4NX
     I              BEC0C7                          WRC0C7
     I              BEUVST                          WRUVST
     I              BEUWST                          WRUWST
     I              BEUXST                          WRUXST
     I              BEAATM                          WRAATM
     I              BEAYNA                          WRAYNA
     I              BEA0NA                          WRA0NA
     I              BEAXDT                          WRAXDT
      *
     I@BFCPOS
      * Order Header TRG          ArCust/OrdDt, sel 'OR
      * Renamed input format fields
     I              BEAIC3                          WSAIC3
     I              BEC4NB                          WSC4NB
     I              BEJNCD                          WSJNCD
     I              BEANC7                          WSANC7
     I              BEBKC7                          WSBKC7
     I              BEBRTX                          WSBRTX
     I              BEHMNA                          WSHMNA
     I              BEHONA                          WSHONA
     I              BEHPNA                          WSHPNA
     I              BEHNNA                          WSHNNA
     I              BEDBCD                          WSDBCD
     I              BECKTX                          WSCKTX
     I              BEB0C7                          WSB0C7
     I              BEAETX                          WSAETX
     I              BEB1NA                          WSB1NA
     I              BEB3NA                          WSB3NA
     I              BEB4NA                          WSB4NA
     I              BEB2NA                          WSB2NA
     I              BEBHCD                          WSBHCD
     I              BEC8TX                          WSC8TX
     I              BEBCNA                          WSBCNA
     I              BEA0DT                          WSA0DT
     I              BEA5DT                          WSA5DT
     I              BEGNDT                          WSGNDT
     I              BEACDT                          WSACDT
     I              BEAQCD                          WSAQCD
     I              BEB6NA                          WSB6NA
     I              BEBYNA                          WSBYNA
     I              BEBZNA                          WSBZNA
     I              BEGTST                          WSGTST
     I              BEGVST                          WSGVST
     I              BEGUST                          WSGUST
     I              BEQFST                          WSQFST
     I              BECQCD                          WSCQCD
     I              BEGJST                          WSGJST
     I              BEGWST                          WSGWST
     I              BEGXST                          WSGXST
     I              BEGYST                          WSGYST
     I              BEAODT                          WSAODT
     I              BEAIVN                          WSAIVN
     I              BECXDT                          WSCXDT
     I              BEJZVA                          WSJZVA
     I              BEA1WG                          WSA1WG
     I              BEXIST                          WSXIST
     I              BEXJST                          WSXJST
     I              BEXKST                          WSXKST
     I              BEEIDT                          WSEIDT
     I              BEAFTM                          WSAFTM
     I              BEE8CD                          WSE8CD
     I              BEE9CD                          WSE9CD
     I              BERMNB                          WSRMNB
     I              BETBNB                          WSTBNB
     I              BER1NB                          WSR1NB
     I              BEPJST                          WSPJST
     I              BEU0ST                          WSU0ST
     I              BEU1ST                          WSU1ST
     I              BEQ2CD                          WSQ2CD
     I              BEU2ST                          WSU2ST
     I              BEVEST                          WSVEST
     I              BEVFST                          WSVFST
     I              BEVGST                          WSVGST
     I              BERPCD                          WSRPCD
     I              BERNNB                          WSRNNB
     I              BEVDST                          WSVDST
     I              BEATIN                          WSATIN
     I              BEU4ST                          WSU4ST
     I              BEU5ST                          WSU5ST
     I              BERSRN                          WSRSRN
     I              BEMHNA                          WSMHNA
     I              BEMINA                          WSMINA
     I              BEWBST                          WSWBST
     I              BER4CD                          WSR4CD
     I              BEBFCD                          WSBFCD
     I              BEQ4CD                          WSQ4CD
     I              BET3NB                          WST3NB
     I              BESICD                          WSSICD
     I              BECONB                          WSCONB
     I              BECEST                          WSCEST
     I              BEAWDT                          WSAWDT
     I              BEJPCD                          WSJPCD
     I              BEXUST                          WSXUST
     I              BEZ1ST                          WSZ1ST
     I              BEVRVA                          WSVRVA
     I              BEOBST                          WSOBST
     I              BEBCST                          WSBCST
     I              BEBDST                          WSBDST
     I              BEB7VL                          WSB7VL
     I              BEGASX                          WSGASX
     I              BEGBSX                          WSGBSX
     I              BEGCSX                          WSGCSX
     I              BEGDSX                          WSGDSX
     I              BEFNSX                          WSFNSX
     I              BEFOSX                          WSFOSX
     I              BEFPSX                          WSFPSX
     I              BEFQSX                          WSFQSX
     I              BEFRSX                          WSFRSX
     I              BEFSSX                          WSFSSX
     I              BEFTSX                          WSFTSX
     I              BEFUSX                          WSFUSX
     I              BEFVSX                          WSFVSX
     I              BEFWSX                          WSFWSX
     I              BEFXSX                          WSFXSX
     I              BEFYSX                          WSFYSX
     I              BENODT                          WSNODT
     I              BENPDT                          WSNPDT
     I              BENQDT                          WSNQDT
     I              BENRDT                          WSNRDT
     I              BENSDT                          WSNSDT
     I              BEBPTM                          WSBPTM
     I              BEBQTM                          WSBQTM
     I              BEBRTM                          WSBRTM
     I              BEBSTM                          WSBSTM
     I              BEBTTM                          WSBTTM
     I              BEH0NX                          WSH0NX
     I              BEH1NX                          WSH1NX
     I              BEH2NX                          WSH2NX
     I              BEH3NX                          WSH3NX
     I              BEH4NX                          WSH4NX
     I              BEC0C7                          WSC0C7
     I              BEUVST                          WSUVST
     I              BEUWST                          WSUWST
     I              BEUXST                          WSUXST
     I              BEAATM                          WSAATM
     I              BEAYNA                          WSAYNA
     I              BEA0NA                          WSA0NA
     I              BEAXDT                          WSAXDT
      *
     I@BCREFD
      * AR Summarys               Update index
      * Renamed input format fields
     I              BCAIC3                          WTAIC3
     I              BCANC7                          WTANC7
     I              BCAGVA                          WTAGVA
     I              BCACVA                          WTACVA
     I              BCADVA                          WTADVA
     I              BCAEVA                          WTAEVA
     I              BCAFVA                          WTAFVA
     I              BCAHVA                          WTAHVA
     I              BCVIVA                          WTVIVA
     I              BCVJVA                          WTVJVA
     I              BCVKVA                          WTVKVA
     I              BCVLVA                          WTVLVA
     I              BCVMVA                          WTVMVA
     I              BCVNVA                          WTVNVA
     I              BCEEVA                          WTEEVA
     I              BCAKTM                          WTAKTM
     I              BCAHDT                          WTAHDT
     I              BCANDT                          WTANDT
     I              BCANVA                          WTANVA
     I              BCALDT                          WTALDT
     I              BCAMVA                          WTAMVA
     I              BCAIDT                          WTAIDT
     I              BCALVA                          WTALVA
     I              BCDJNB                          WTDJNB
     I              BCDLNB                          WTDLNB
     I              BCDDNB                          WTDDNB
     I              BCDMNB                          WTDMNB
     I              BCDUDT                          WTDUDT
     I              BCLYNO                          WTLYNO
     I              BCLYNC                          WTLYNC
     I              BCLYNP                          WTLYNP
     I              BCLYNI                          WTLYNI
     I              BCADPM                          WTADPM
     I              BCVOVA                          WTVOVA
     I              BCBTDY                          WTBTDY
     I              BCBUDY                          WTBUDY
     I              BCVPVA                          WTVPVA
     I              BCVQVA                          WTVQVA
     I              BCBCCD                          WTBCCD
     I              BCR4CD                          WTR4CD
     I              BCCUMO                          WTCUMO
     I              BCUVST                          WTUVST
     I              BCUWST                          WTUWST
     I              BCUXST                          WTUXST
     I              BCAATM                          WTAATM
     I              BCAYNA                          WTAYNA
     I              BCA0NA                          WTA0NA
     I              BCAXDT                          WTAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDLD1    E DSPDLDCPL0
      * UPD : AR Balance File           Update index
      * Renamed input format fields
     I              LDAIC3                          WHAIC3
     I              LDANC7                          WHANC7
     I              LDA1NB                          WHA1NB
     I              LDY4NB                          WHY4NB
     I              LDALVA                          WHALVA
     I              LDAIDT                          WHAIDT
     I              LDY5VA                          WHY5VA
     I              LDZAVA                          WHZAVA
     I              LDY7VA                          WHY7VA
     I              LDY8VA                          WHY8VA
     I              LDY9VA                          WHY9VA
     I              LDRTNX                          WHRTNX
     I              LDRUNX                          WHRUNX
     I              LDRVNX                          WHRVNX
     I              LDRWNX                          WHRWNX
     I              LDRXNX                          WHRXNX
     I              LDB4DY                          WHB4DY
     I              LDBSDY                          WHBSDY
     I              LDK2DT                          WHK2DT
     I              LDUNUS                          WHUNUS
     I              LDUNU2                          WHUNU2
     I              LDUVST                          WHUVST
     I              LDUWST                          WHUWST
     I              LDUXST                          WHUXST
     I              LDVSST                          WHVSST
     I              LDAATM                          WHAATM
     I              LDAYNA                          WHAYNA
     I              LDA0NA                          WHA0NA
     I              LDAXDT                          WHAXDT
      *
     IYBRDCS      DS                            110
      /EJECT
     IXD1T        DS
      * Internal date
     I                                        1   70XDINT1
     I                                        1   30XDINY1
     I                                        4   50XDINM1
     I                                        6   70XDIND1
      /EJECT
     IXDMT        DS
      * Duration mask
     I                                        1   70XDIMDT
     I                                        1   30XDIMYY
     I                                        4   50XDIMMM
     I                                        6   70XDIMDD
     IYCRDCS      DS                            110
     IQARBC1    E DSARBCREL0
      * UPD : AR Summarys               Update index
      * Renamed input format fields
     I              BCAIC3                          WTAIC3
     I              BCANC7                          WTANC7
     I              BCAGVA                          WTAGVA
     I              BCACVA                          WTACVA
     I              BCADVA                          WTADVA
     I              BCAEVA                          WTAEVA
     I              BCAFVA                          WTAFVA
     I              BCAHVA                          WTAHVA
     I              BCVIVA                          WTVIVA
     I              BCVJVA                          WTVJVA
     I              BCVKVA                          WTVKVA
     I              BCVLVA                          WTVLVA
     I              BCVMVA                          WTVMVA
     I              BCVNVA                          WTVNVA
     I              BCEEVA                          WTEEVA
     I              BCAKTM                          WTAKTM
     I              BCAHDT                          WTAHDT
     I              BCANDT                          WTANDT
     I              BCANVA                          WTANVA
     I              BCALDT                          WTALDT
     I              BCAMVA                          WTAMVA
     I              BCAIDT                          WTAIDT
     I              BCALVA                          WTALVA
     I              BCDJNB                          WTDJNB
     I              BCDLNB                          WTDLNB
     I              BCDDNB                          WTDDNB
     I              BCDMNB                          WTDMNB
     I              BCDUDT                          WTDUDT
     I              BCLYNO                          WTLYNO
     I              BCLYNC                          WTLYNC
     I              BCLYNP                          WTLYNP
     I              BCLYNI                          WTLYNI
     I              BCADPM                          WTADPM
     I              BCVOVA                          WTVOVA
     I              BCBTDY                          WTBTDY
     I              BCBUDY                          WTBUDY
     I              BCVPVA                          WTVPVA
     I              BCVQVA                          WTVQVA
     I              BCBCCD                          WTBCCD
     I              BCR4CD                          WTR4CD
     I              BCCUMO                          WTCUMO
     I              BCUVST                          WTUVST
     I              BCUWST                          WTUWST
     I              BCUXST                          WTUXST
     I              BCAATM                          WTAATM
     I              BCAYNA                          WTAYNA
     I              BCA0NA                          WTA0NA
     I              BCAXDT                          WTAXDT
      *
     IYDRDCS      DS                            213
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Age_Due_Aging 1_CB
     I                                    P   1   62P1ACVA
      * N :  Age_Due_Aging 2_CB
     I                                    P   7  122P1ADVA
      * N :  Age_Due_Aging 3_CB
     I                                    P  13  182P1AEVA
      * N :  Age_Due_Aging 4_CB
     I                                    P  19  242P1AFVA
      * N :  Age_Due_Current_CB
     I                                    P  25  302P1AGVA
      * N :  Age_Due_Aging 5_CB
     I                                    P  31  362P1AHVA
      * N :  Amount of Highest A_R Bal
     I                                    P  37  422P1ALVA
      * N :  Amount of Last Payment
     I                                    P  43  482P1AMVA
      * N :  Date of Highest A_R Bal
     I                                    P  49  520P1AIDT
      * N :  Date of Last Payment
     I                                    P  53  560P1ALDT
      * I :  Company Number
     I                                    P  57  580P1AIC3
      * I :  AR Customer Number
     I                                    P  59  620P1ANC7
      * N :  Age_Due_Current_W_O_CB
     I                                    P  63  682P1VIVA
      * N :  Age_Due_Aging 1_W_O_CB
     I                                    P  69  742P1VJVA
      * N :  Age_Due_Aging 2_W_O_CB
     I                                    P  75  802P1VKVA
      * N :  Age_Due_Aging 3_W_O_CB
     I                                    P  81  862P1VLVA
      * N :  Age_Due_Aging 4_W_O_CB
     I                                    P  87  922P1VMVA
      * N :  Age_Due_Aging 5_W_O_CB
     I                                    P  93  982P1VNVA
      * N :  MTD Invoices Paid
     I                                    P  99 1010P1ADPM
      * N :  YTD Invoices Paid
     I                                    P 102 1040P1VOVA
      * N :  MTD Days Paid
     I                                    P 105 1070P1BTDY
      * N :  YTD Days Paid
     I                                    P 108 1100P1BUDY
      * N :  Paid in Full Date
     I                                    P 111 1140P1H4DT
      * N :  Days to Pay
     I                                    P 115 1170P1BSDY
      * N :  USR Tot. Due W/O CB
     I                                    P 118 1232P1WBVA
      * N :  USR Number of Payments
     I                                    P 124 1260P1NBPY
      * N :  USR Total Due
     I                                    P 127 1322P1V7VA
      * N :  Current Month
     I                                    P 133 1340P1CUMO
      * N :  USR Total Order Value
     I                                    P 135 1402P1VSVA
      * N :  A_R Balance Month
     I                                    P 141 1420P1Y4NB
      * N :  A_R Balance Year
     I                                    P 143 1450P1A1NB
      * N :  *Job year
     I                                    P 146 1470P1JYY
      * I :  A/R Summ-Curr W/O  USR
     I                                    P 148 1532P1BXVL
      * I :  A/R Summ-Age1 W/O  USR
     I                                    P 154 1592P1BYVL
      * I :  A/R Summ-Age2 W/O  USR
     I                                    P 160 1652P1BZVL
      * I :  A/R Summ-Age3 W/O  USR
     I                                    P 166 1712P1B0VL
      * I :  A/R Summ-Age4 W/O  USR
     I                                    P 172 1772P1B1VL
      * I :  A/R Summ-Age5 W/O  USR
     I                                    P 178 1832P1B2VL
      * I :  A/R Summ-Amt High A/R USR
     I                                    P 184 1892P1B3VL
      * I :  A/R Summ-Dte High A/R USR
     I                                    P 190 1930P1NHDT
      * I :  A/R Summ-Curr Month   USR
     I                                    P 194 1950P1A8NX
      * I :  A/R Summ-MTD Inv Paid USR
     I                                    P 196 1980P1A9NX
      * I :  A/R Summ-YTD Inv Paid USR
     I                                    P 199 2010P1B3DY
      * I :  A/R Summ-MTD Days Pd  USR
     I                                    P 202 2040P1B1DY
      * I :  A/R Summ-YTD Days Pd  USR
     I                                    P 205 2070P1B2DY
     IP2PARM      DS
      * N :  Value of Open Orders
     I                                    P   1   62P2EEVA
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1ANC7    PARM           WP0002  70       AR Customer Num
     C           P1BXVL    PARM           WP0003 112       A/R Summ-Curr W
     C           P1BYVL    PARM           WP0004 112       A/R Summ-Age1 W
     C           P1BZVL    PARM           WP0005 112       A/R Summ-Age2 W
     C           P1B0VL    PARM           WP0006 112       A/R Summ-Age3 W
     C           P1B1VL    PARM           WP0007 112       A/R Summ-Age4 W
     C           P1B2VL    PARM           WP0008 112       A/R Summ-Age5 W
     C           P1B3VL    PARM           WP0009 112       A/R Summ-Amt Hi
     C           P1NHDT    PARM           WP0010  70       A/R Summ-Dte Hi
     C           P1A8NX    PARM           WP0011  20       A/R Summ-Curr M
     C           P1A9NX    PARM           WP0012  50       A/R Summ-MTD In
     C           P1B3DY    PARM           WP0013  50       A/R Summ-YTD In
     C           P1B1DY    PARM           WP0014  50       A/R Summ-MTD Da
     C           P1B2DY    PARM           WP0015  50       A/R Summ-YTD Da
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Age A/R Cust Inv   XF
      * ********************************
      * 1. Initialize Fields.
     C                     EXSR UASUBR                     1. Initialize F
      * 2. Value of Open Orders.
     C                     EXSR UDSUBR                     2. Value of Ope
      * 3. Age Receivables Due Buckets for A/R customer.
     C                     EXSR UFSUBR                     3. Age Receivab
      * 4. Highest A/R Balance & Date. (w/o CB)
     C                     EXSR NKSUBR                     4. Highest A/R
      * 5. Last Payment Amount & Date.
     C                     EXSR NNSUBR                     5. Last Payment
      * 6. (MTD/YTD) Days to Pay & Invoices Paid. & A/R Bal new fields 11
     C                     EXSR NOSUBR                     6. (MTD/YTD) Da
      * 7. Number of Payments.
     C                     EXSR NXSUBR                     7. Number of Pa
      * 8. Update the A/R Summary record.
     C                     EXSR NYSUBR                     8. Update the A
      * ***** Change Log and Comments
     C                     EXSR NZSUBR                     ***** Change Lo
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NASUBR    BEGSR
      *================================================================
      * Past Due Period 4.
      *================================================================
      * CLC Aging Bucket       IF
      * CASE: PAR.Invoice Suffix is Charge Backs and Rebills
     C           WFCEST    IFEQ 'CB'                       *IF
     C           WFCEST    OREQ 'RB'
      * Age Chargebacks and Rebills.
     C                     EXSR NBSUBR                     Age Chargebacks
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Invoices
      *   |- c2    : PAR.Invoice Suffix is Debit Memos
      *   '-
     C           WFCEST    IFEQ 'IN'                       *IF
     C           WFCEST    OREQ 'DM'                       *OR
      * Age Invoices and Debit Memos.
     C                     EXSR NCSUBR                     Age Invoices an
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Credit Memos
      *   |- c2    : PAR.Invoice Suffix is On Account Cash
      *   '-
     C           WFCEST    IFEQ 'CM'                       *IF
     C           WFCEST    OREQ 'OA'                       *OR
      * Accumulate Credit to Apply.
     C                     EXSR NDSUBR                     Accumulate Cred
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBSUBR    BEGSR
      *================================================================
      * Age Chargebacks and Rebills.
      *================================================================
     C                     ADD  WFBGVA    WN0129           Aging - CB    A
     C                     ADD  WFBGVA    WN0135           Aging - IN/DM/C
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCSUBR    BEGSR
      *================================================================
      * Age Invoices and Debit Memos.
      *================================================================
     C                     ADD  WFBGVA    WN0141           Aging - IN/DM A
     C                     ADD  WFBGVA    WN0135           Aging - IN/DM/C
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDSUBR    BEGSR
      *================================================================
      * Accumulate Credit to Apply.
      *================================================================
     C                     ADD  WFBGVA    WN0143           Aging - CM/OA A
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NESUBR    BEGSR
      *================================================================
      * Past Due Period 5.
      *================================================================
      * CLC Aging Bucket       IF
      * CASE: PAR.Invoice Suffix is Charge Backs and Rebills
     C           WFCEST    IFEQ 'CB'                       *IF
     C           WFCEST    OREQ 'RB'
      * Age Chargebacks and Rebills.
     C                     EXSR NFSUBR                     Age Chargebacks
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Invoices
      *   |- c2    : PAR.Invoice Suffix is Debit Memos
      *   '-
     C           WFCEST    IFEQ 'IN'                       *IF
     C           WFCEST    OREQ 'DM'                       *OR
      * Age Invoices and Debit Memos.
     C                     EXSR NGSUBR                     Age Invoices an
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Credit Memos
      *   |- c2    : PAR.Invoice Suffix is On Account Cash
      *   '-
     C           WFCEST    IFEQ 'CM'                       *IF
     C           WFCEST    OREQ 'OA'                       *OR
      * Accumulate Credit to Apply.
     C                     EXSR NHSUBR                     Accumulate Cred
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFSUBR    BEGSR
      *================================================================
      * Age Chargebacks and Rebills.
      *================================================================
     C                     ADD  WFBGVA    WN0130           Aging - CB    A
     C                     ADD  WFBGVA    WN0137           Aging - IN/DM/C
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGSUBR    BEGSR
      *================================================================
      * Age Invoices and Debit Memos.
      *================================================================
     C                     ADD  WFBGVA    WN0142           Aging - IN/DM A
     C                     ADD  WFBGVA    WN0137           Aging - IN/DM/C
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHSUBR    BEGSR
      *================================================================
      * Accumulate Credit to Apply.
      *================================================================
     C                     ADD  WFBGVA    WN0143           Aging - CM/OA A
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NISUBR    BEGSR
      *================================================================
      * Apply Credits.
      *================================================================
      * *** Save total credit amount for later. ***
     C                     Z-ADDWN0143    WN0149           Save Total Cred
      * *** Apply credits to oldest dollars first. (without CB) ***
      * Start by Applying Credit to Bucket 5.
      * CASE: PAR.USR Age Value 5 GE PAR.USR Total Credit Amount
     C           WN0142    IFGE WN0143                     *IF
     C                     SUB  WN0143    WN0142           USR Age Value 5
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0142    WN0143           USR Total Credi
     C                     Z-ADD*ZERO     WN0142           USR Age Value 5
      * Apply Remaining Credit to Bucket 4.
      * CASE: PAR.USR Age Value 4 GE PAR.USR Total Credit Amount
     C           WN0141    IFGE WN0143                     *IF
     C                     SUB  WN0143    WN0141           USR Age Value 4
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0141    WN0143           USR Total Credi
     C                     Z-ADD*ZERO     WN0141           USR Age Value 4
      * Apply Remaining Credit to Bucket 3.
      * CASE: PAR.USR Age Value 3 GE PAR.USR Total Credit Amount
     C           WN0140    IFGE WN0143                     *IF
     C                     SUB  WN0143    WN0140           USR Age Value 3
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0140    WN0143           USR Total Credi
     C                     Z-ADD*ZERO     WN0140           USR Age Value 3
      * Apply Remaining Credit to Bucket 2.
      * CASE: PAR.USR Age Value 2 GE PAR.USR Total Credit Amount
     C           WN0139    IFGE WN0143                     *IF
     C                     SUB  WN0143    WN0139           USR Age Value 2
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0139    WN0143           USR Total Credi
     C                     Z-ADD*ZERO     WN0139           USR Age Value 2
      * Apply Remaining Credit to Bucket 1.
      * CASE: PAR.USR Age Value 1 GE PAR.USR Total Credit Amount
     C           WN0138    IFGE WN0143                     *IF
     C                     SUB  WN0143    WN0138           USR Age Value 1
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0138    WN0143           USR Total Credi
     C                     Z-ADD*ZERO     WN0138           USR Age Value 1
     C                     SUB  WN0143    WN0144           USR Age Current
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *** Reset total credit amount. ***
     C                     Z-ADDWN0149    WN0143           USR Total Credi
      * *** Apply credits to oldest dollars first. (with CB) ***
      * Start by Applying Credit to Bucket 5.
      * CASE: PAR.USR Age Value 5 B GE PAR.USR Total Credit Amount
     C           WN0137    IFGE WN0143                     *IF
     C                     SUB  WN0143    WN0137           USR Age Value 5
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0137    WN0143           USR Total Credi
     C                     Z-ADD*ZERO     WN0137           USR Age Value 5
      * Apply Remaining Credit to Bucket 4.
      * CASE: PAR.USR Age Value 4 B GE PAR.USR Total Credit Amount
     C           WN0135    IFGE WN0143                     *IF
     C                     SUB  WN0143    WN0135           USR Age Value 4
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0135    WN0143           USR Total Credi
     C                     Z-ADD*ZERO     WN0135           USR Age Value 4
      * Apply Remaining Credit to Bucket 3.
      * CASE: PAR.USR Age Value 3 B GE PAR.USR Total Credit Amount
     C           WN0134    IFGE WN0143                     *IF
     C                     SUB  WN0143    WN0134           USR Age Value 3
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0134    WN0143           USR Total Credi
     C                     Z-ADD*ZERO     WN0134           USR Age Value 3
      * Apply Remaining Credit to Bucket 2.
      * CASE: PAR.USR Age Value 2 B GE PAR.USR Total Credit Amount
     C           WN0133    IFGE WN0143                     *IF
     C                     SUB  WN0143    WN0133           USR Age Value 2
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0133    WN0143           USR Total Credi
     C                     Z-ADD*ZERO     WN0133           USR Age Value 2
      * Apply Remaining Credit to Bucket 1.
      * CASE: PAR.USR Age Value 1 B GE PAR.USR Total Credit Amount
     C           WN0132    IFGE WN0143                     *IF
     C                     SUB  WN0143    WN0132           USR Age Value 1
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WN0132    WN0143           USR Total Credi
     C                     Z-ADD*ZERO     WN0132           USR Age Value 1
     C                     SUB  WN0143    WN0131           USR Age Current
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJSUBR    BEGSR
      *================================================================
      * Load Output Parameters.
      *================================================================
     C                     Z-ADDWN0131    P1AGVA           Age_Due_Current
     C                     Z-ADDWN0132    P1ACVA           Age_Due_Aging 1
     C                     Z-ADDWN0133    P1ADVA           Age_Due_Aging 2
     C                     Z-ADDWN0134    P1AEVA           Age_Due_Aging 3
     C                     Z-ADDWN0135    P1AFVA           Age_Due_Aging 4
     C                     Z-ADDWN0137    P1AHVA           Age_Due_Aging 5
     C                     Z-ADDWN0144    P1VIVA           Age_Due_Current
     C                     Z-ADDWN0138    P1VJVA           Age_Due_Aging 1
     C                     Z-ADDWN0139    P1VKVA           Age_Due_Aging 2
     C                     Z-ADDWN0140    P1VLVA           Age_Due_Aging 3
     C                     Z-ADDWN0141    P1VMVA           Age_Due_Aging 4
     C                     Z-ADDWN0142    P1VNVA           Age_Due_Aging 5
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKSUBR    BEGSR
      *================================================================
      * 4. Highest A/R Balance & Date. (w/o CB)
      *================================================================
      * Compute OLD Total Due
      * PAR.USR Total Due =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      * x1    : PAR.A/R Summ-Curr W/O  USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.A/R Summ-Age1 W/O  USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.A/R Summ-Age2 W/O  USR
      * +     : PGM.*Synon (17,7) work field
      * x4    : PAR.A/R Summ-Age3 W/O  USR
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.A/R Summ-Age4 W/O  USR
      * +     : PGM.*Synon (17,7) work field
      * x6    : PAR.A/R Summ-Age5 W/O  USR
     C           P1BXVL    ADD  P1BYVL    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  P1BZVL    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  P1B0VL    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  P1B1VL    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  P1B2VL    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P1V7VA           USR Total Due
      * Compute NEW Total Due
      * PAR.USR Tot. Due W/O CB =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      * x1    : PAR.Age_Due_Current_W_O_CB
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Age_Due_Aging 1_W_O_CB
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.Age_Due_Aging 2_W_O_CB
      * +     : PGM.*Synon (17,7) work field
      * x4    : PAR.Age_Due_Aging 3_W_O_CB
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.Age_Due_Aging 4_W_O_CB
      * +     : PGM.*Synon (17,7) work field
      * x6    : PAR.Age_Due_Aging 5_W_O_CB
     C           P1VIVA    ADD  P1VJVA    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  P1VKVA    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  P1VLVA    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  P1VMVA    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  P1VNVA    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P1WBVA           USR Tot. Due W/
      * CASE: PAR.USR Tot. Due W/O CB GT PAR.USR Total Due
     C           P1WBVA    IFGT P1V7VA                     *IF
      * Update monthly balance & determine highest 12 month balance.
     C                     EXSR NLSUBR                     Update monthly
     C                     ELSE
      * CASE: *OTHERWISE
      * No change to highest balance.
     C                     EXSR NMSUBR                     No change to hi
     C                     END                             *FI
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLSUBR    BEGSR
      *================================================================
      * Update monthly balance & determine highest 12 month balance.
      *================================================================
      * Create or Update Monthly Balance record.
      * PAR.A/R Balance Year = JOB.*Job date *YEAR
     C           ##JDT     ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    P1A1NB
     C                     Z-ADD##JMM     P1Y4NB           A_R Balance Mon
      * CHG or CRT A/R Balance CH - A/R Balance File  * 
     C                     EXSR SHCHRC
      * Determine highest balance in last 12 months.
     C                     SUB  1         P1A1NB           A_R Balance Yea
      * CLC 12 mo. High Bal    XF - A/R Balance File  * 
     C                     CALL 'PDV0XFR'              90  CLC 12 mo. High
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1ANC7    WQ0002  70       AR Customer Num
     C                     PARM P1A1NB    WQ0003  40       A_R Balance Yea
     C                     PARM P1Y4NB    WQ0004  20       A_R Balance Mon
     C           P1ALVA    PARM P1ALVA    WQ0005 112       Amount of Highe
     C           P1AIDT    PARM P1AIDT    WQ0006  70       Date of Highest
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMSUBR    BEGSR
      *================================================================
      * No change to highest balance.
      *================================================================
     C                     Z-ADDP1B3VL    P1ALVA           Amount of Highe
     C                     Z-ADDP1NHDT    P1AIDT           Date of Highest
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNSUBR    BEGSR
      *================================================================
      * 5. Last Payment Amount & Date.
      *================================================================
     C                     Z-ADD9999999   P1ALDT           Date of Last Pa
      * RTV Last Payment Date  RT - A/R Header  * 
     C                     EXSR SJRVGN
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NOSUBR    BEGSR
      *================================================================
      * 6. (MTD/YTD) Days to Pay & Invoices Paid. & A/R Bal new fields 1
      *================================================================
      * Set Current Month Field.
      * CASE: PAR.A/R Summ-Curr Month   USR is Equal to Zero
     C           P1A8NX    IFEQ *ZERO                      *IF
     C                     Z-ADD##JMM     P1CUMO           Current Month
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1A8NX    P1CUMO           Current Month
     C                     END                             *FI
      * CASE: PAR.Current Month EQ JOB.*Job month
     C           P1CUMO    IFEQ ##JMM                      *IF
      * Current Month from A/R Summary = Job Month.
     C                     EXSR NPSUBR                     Current Month f
     C                     END                             *FI
      * 11/15/02 Upd A/R Balance with new fields at EOM
      * 02/10/05 Dont back out old month 1 year ago
      * CASE: PAR.Current Month NE JOB.*Job month
     C           P1CUMO    IFNE ##JMM                      *IF
      * Current Month from A/R Summary not= Job Month.
     C                     EXSR NRSUBR                     Current Month f
     C                     END                             *FI
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPSUBR    BEGSR
      *================================================================
      * Current Month from A/R Summary = Job Month.
      *================================================================
     C                     Z-ADD*ZERO     P1BSDY           Days to Pay
     C                     Z-ADD*ZERO     P1ADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WUADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     P1VOVA           YTD Invoices Pa
      * 1st day of current month.
     C                     EXSR NQSUBR                     1st day of curr
      * RTV Days Paid MTD      RT - A/R Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0034           Company Number
     C                     Z-ADDP1H4DT    WL0035           Paid in Full Da
     C                     Z-ADDP1ANC7    WL0036           AR Customer Num
     C                     Z-ADDP1BSDY    WL0037           Days to Pay
     C                     Z-ADD##JMM     WL0038           USR Current Mon
     C                     Z-ADD##JYY     WL0039           *Job year
     C                     Z-ADDP1ADPM    WL0040           MTD Invoices Pa
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    P1BSDY           Days to Pay
     C                     Z-ADDWL0040    P1ADPM           MTD Invoices Pa
      * Invoices Paid Fields.
      * CASE: PAR.MTD Invoices Paid GT PAR.A/R Summ-MTD Inv Paid USR
     C           P1ADPM    IFGT P1A9NX                     *IF
     C           P1ADPM    SUB  P1A9NX    WUADPM           MTD Invoices Pa
     C           WUADPM    ADD  P1B3DY    P1VOVA           YTD Invoices Pa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1A9NX    P1ADPM           MTD Invoices Pa
     C                     Z-ADDP1B3DY    P1VOVA           YTD Invoices Pa
     C                     END                             *FI
      * Days Paid Fields.
      * CASE: PAR.Days to Pay GT PAR.A/R Summ-MTD Days Pd  USR
     C           P1BSDY    IFGT P1B1DY                     *IF
     C           P1BSDY    SUB  P1B1DY    WUBSDY           Days to Pay
     C           P1B2DY    ADD  WUBSDY    P1BUDY           YTD Days Paid
     C                     Z-ADDP1BSDY    P1BTDY           MTD Days Paid
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1B2DY    P1BUDY           YTD Days Paid
     C                     Z-ADDP1B1DY    P1BTDY           MTD Days Paid
     C                     END                             *FI
     C                     Z-ADDP1A8NX    P1CUMO           Current Month
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQSUBR    BEGSR
      *================================================================
      * 1st day of current month.
      *================================================================
      * 1st day of current month
      * PAR.Paid in Full Date =
      *    *COMPUTE ((x1 * x2) + (x3 * x4) + x5)
      * x1    : JOB.*Job year
      * *     : PGM.*Synon (17,7) work field *
      * x2    : CON.10000
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.Current Month
      * *     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x5    : CON.01
     C           ##JYY     MULT 10000     W0WD02           *Synon (17,7) w
     C           P1CUMO    MULT 100       W0WD03           *Synon (17,7) w
     C           W0WD02    ADD  W0WD03    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  01        W0WD00           *Synon (17,7) w
      * PAR.Paid in Full Date =       * 1st day of current month
     C                     Z-ADDW0WD00    P1H4DT           Paid in Full Da
      * Set Century.
      * CASE: JOB.*Job year is LT 40
     C           ##JYY     IFLT 40                         *IF
     C                     ADD  1000000   P1H4DT           Paid in Full Da
     C                     END                             *FI
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRSUBR    BEGSR
      *================================================================
      * Current Month from A/R Summary not= Job Month.
      *================================================================
     C                     Z-ADD*ZERO     P1BSDY           Days to Pay
     C                     Z-ADD*ZERO     P1ADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     P1VOVA           YTD Invoices Pa
     C                     Z-ADDP1B2DY    P1BUDY           YTD Days Paid
      * Process old month   & update A/R Balance new fields 11/15/02
     C                     EXSR NSSUBR                     Process old mon
      * Process new month
     C                     EXSR NVSUBR                     Process new mon
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSSUBR    BEGSR
      *================================================================
      * Process old month   & update A/R Balance new fields 11/15/02
      *================================================================
      * ** Days to Pay Usr fields size changed from 3.0 to 5.0     LJB
      * Set up 1st day of old month
      * CASE: PAR.A/R Summ-Curr Month   USR is December
     C           P1A8NX    IFEQ 12                         *IF
      * 1st day of current month. (minus 1 year)
     C                     EXSR NTSUBR                     1st day of curr
     C                     ELSE
      * CASE: *OTHERWISE
      * 1st day of current month.
     C                     EXSR NUSUBR                     1st day of curr
     C                     END                             *FI
      * RTV Days Paid MTD      RT - A/R Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0034           Company Number
     C                     Z-ADDP1H4DT    WL0035           Paid in Full Da
     C                     Z-ADDP1ANC7    WL0036           AR Customer Num
     C                     Z-ADDP1BSDY    WL0037           Days to Pay
     C                     Z-ADDP1A8NX    WL0038           USR Current Mon
     C                     Z-ADDP1JYY     WL0039           *Job year
     C                     Z-ADDP1ADPM    WL0040           MTD Invoices Pa
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    P1BSDY           Days to Pay
     C                     Z-ADDWL0040    P1ADPM           MTD Invoices Pa
     C                     Z-ADDP1BSDY    WURYNX           Days to Pay 1 U
     C                     Z-ADDP1ADPM    WUCNTU           Count USR
      * Days to Pay.
      * CASE: PAR.Days to Pay GT PAR.A/R Summ-MTD Days Pd  USR
     C           P1BSDY    IFGT P1B1DY                     *IF
     C           P1BSDY    SUB  P1B1DY    WUBSDY           Days to Pay
     C                     ADD  WUBSDY    P1BUDY           YTD Days Paid
     C                     Z-ADD*ZERO     P1BTDY           MTD Days Paid
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1B1DY    P1BTDY           MTD Days Paid
     C                     Z-ADDP1B2DY    P1BUDY           YTD Days Paid
     C                     END                             *FI
      * MTD and YTD Invoices Paid
      * CASE: PAR.MTD Invoices Paid GT PAR.A/R Summ-MTD Inv Paid USR
     C           P1ADPM    IFGT P1A9NX                     *IF
     C           P1ADPM    SUB  P1A9NX    WUADPM           MTD Invoices Pa
     C           WUADPM    ADD  P1B3DY    P1VOVA           YTD Invoices Pa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1A9NX    P1ADPM           MTD Invoices Pa
     C                     Z-ADDP1B3DY    P1VOVA           YTD Invoices Pa
     C                     END                             *FI
      * Update A/R Balance at Month-end - new fields 11/15/02
     C                     Z-ADDP1ADPM    WURXNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WUB4DY           Bal Avg Days to
      * CASE: WRK.Count USR is GT 0
     C           WUCNTU    IFGT *ZERO                      *IF
     C           WURYNX    DIV  WUCNTU    WUB4DY           Bal Avg Days to
     C                     END                             *FI
     C                     MOVEL'1'       WUPFTX           Text 1 Length U
     C                     MOVEL'01'      WUT6TX           Day   (Char) US
     C           2000      ADD  P1JYY     P1A1NB           A_R Balance Yea
     C                     Z-ADDP1A1NB    WUI8NX           Year  NBR USR
      * RTV Num. Paymnts p/Mo RT - A/R Header  * 
     C                     EXSR SNRVGN
     C                     MOVELWUI8NX    WUUATX           Year Alpha (YY)
      * *Move-Right - /UT User Source  * 
     C                     MOVE P1A8NX    WUMONT
     C                     Z-ADD*ZERO     ZQ      50
     C           WUPFTX    CAT  WUUATX:ZQ WUVETX    P      Day 1 3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVETX    CAT  WUMONT:ZQ WUY7TX    P      Text USR 5
     C                     Z-ADD*ZERO     ZQ      50
     C           WUY7TX    CAT  WUT6TX:ZQ WUR4TX    P      Date (Alpha) US
     C                     MOVE WUR4TX    YL0003           Invoice Date
      * Rtv f/A/R Bal MTD Upd RT - Order Header TRG  * 
     C                     EXSR SPRVGN
      * Rtv f/A/R Bal #OrdUpd RT - Order Header TRG  * 
     C                     EXSR SQRVGN
      * ** Update Days to Pay with Days from A/R Header  9/11/06 LJB
      * Chg/Crt A/R Bal MTDs  CH - A/R Balance File  * 
     C                     EXSR SRCHRC
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTSUBR    BEGSR
      *================================================================
      * 1st day of current month. (minus 1 year)
      *================================================================
      * 1st day of current month
      * PAR.Paid in Full Date =
      *    *COMPUTE ((x1 * x2) + (x3 * x4) + x5)
      * x1    : JOB.*Job year
      * *     : PGM.*Synon (17,7) work field *
      * x2    : CON.10000
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.A/R Summ-Curr Month   USR
      * *     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x5    : CON.01
     C           ##JYY     MULT 10000     W0WD02           *Synon (17,7) w
     C           P1A8NX    MULT 100       W0WD03           *Synon (17,7) w
     C           W0WD02    ADD  W0WD03    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  01        W0WD00           *Synon (17,7) w
      * PAR.Paid in Full Date =       * 1st day of current month
     C                     Z-ADDW0WD00    P1H4DT           Paid in Full Da
      * Set Century.
      * CASE: JOB.*Job year is LT 40
     C           ##JYY     IFLT 40                         *IF
     C                     ADD  1000000   P1H4DT           Paid in Full Da
     C                     END                             *FI
      * PAR.Paid in Full Date = PAR.Paid in Full Date + CON.-1 *YEARS
     C           P1H4DT    ADD  1000000   XDINDT
     C                     Z-ADD-1        XDURR   80
     C                     EXSR XDAYR
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1H4DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1H4DT
     C                     END
      * PAR.*Job year = PAR.Paid in Full Date *YEAR
     C           P1H4DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    P1JYY
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NUSUBR    BEGSR
      *================================================================
      * 1st day of current month.
      *================================================================
      * 1st day of current month
      * PAR.Paid in Full Date =
      *    *COMPUTE ((x1 * x2) + (x3 * x4) + x5)
      * x1    : JOB.*Job year
      * *     : PGM.*Synon (17,7) work field *
      * x2    : CON.10000
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.A/R Summ-Curr Month   USR
      * *     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x5    : CON.01
     C           ##JYY     MULT 10000     W0WD02           *Synon (17,7) w
     C           P1A8NX    MULT 100       W0WD03           *Synon (17,7) w
     C           W0WD02    ADD  W0WD03    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  01        W0WD00           *Synon (17,7) w
      * PAR.Paid in Full Date =       * 1st day of current month
     C                     Z-ADDW0WD00    P1H4DT           Paid in Full Da
      * Set Century.
      * CASE: JOB.*Job year is LT 40
     C           ##JYY     IFLT 40                         *IF
     C                     ADD  1000000   P1H4DT           Paid in Full Da
     C                     END                             *FI
      * PAR.*Job year = PAR.Paid in Full Date *YEAR
     C           P1H4DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    P1JYY
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVSUBR    BEGSR
      *================================================================
      * Process new month
      *================================================================
     C                     Z-ADD##JMM     P1CUMO           Current Month
     C                     Z-ADD*ZERO     P1BSDY           Days to Pay
      * 1st day of current month.
     C                     EXSR NWSUBR                     1st day of curr
      * RTV Days Paid MTD      RT - A/R Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0034           Company Number
     C                     Z-ADDP1H4DT    WL0035           Paid in Full Da
     C                     Z-ADDP1ANC7    WL0036           AR Customer Num
     C                     Z-ADDP1BSDY    WL0037           Days to Pay
     C                     Z-ADDP1CUMO    WL0038           USR Current Mon
     C                     Z-ADD##JYY     WL0039           *Job year
     C                     Z-ADDP1ADPM    WL0040           MTD Invoices Pa
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    P1BSDY           Days to Pay
     C                     Z-ADDWL0040    P1ADPM           MTD Invoices Pa
     C                     ADD  P1ADPM    P1VOVA           YTD Invoices Pa
     C                     ADD  P1BSDY    P1BUDY           YTD Days Paid
     C                     Z-ADDP1BSDY    P1BTDY           MTD Days Paid
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWSUBR    BEGSR
      *================================================================
      * 1st day of current month.
      *================================================================
      * 1st day of current month
      * PAR.Paid in Full Date =
      *    *COMPUTE ((x1 * x2) + (x3 * x4) + x5)
      * x1    : JOB.*Job year
      * *     : PGM.*Synon (17,7) work field *
      * x2    : CON.10000
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.Current Month
      * *     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x5    : CON.01
     C           ##JYY     MULT 10000     W0WD02           *Synon (17,7) w
     C           P1CUMO    MULT 100       W0WD03           *Synon (17,7) w
     C           W0WD02    ADD  W0WD03    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  01        W0WD00           *Synon (17,7) w
      * PAR.Paid in Full Date =       * 1st day of current month
     C                     Z-ADDW0WD00    P1H4DT           Paid in Full Da
      * Set Century.
      * CASE: JOB.*Job year is LT 40
     C           ##JYY     IFLT 40                         *IF
     C                     ADD  1000000   P1H4DT           Paid in Full Da
     C                     END                             *FI
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXSUBR    BEGSR
      *================================================================
      * 7. Number of Payments.
      *================================================================
      * RTV Num. Payments      RT - A/R Header  * 
     C                     EXSR SSRVGN
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYSUBR    BEGSR
      *================================================================
      * 8. Update the A/R Summary record.
      *================================================================
      * CHG Nite Aging Fields  CH - A/R Summary  * 
     C                     EXSR SUCHRC
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * RMC 2/10/05 Comment the code that does this under Step 6:
      *             Process old month 1 year ago (back out figures)
      * It was for a 12 month rolling figure so now its throwing off the
      * *****
      * ** 05/19/2006 LJB T00009
      * ** Size of the Days to Pay Usr Fields was changed from
      * ** 3.0 to 5.0 to prevent truncating when accumulating for
      * ** large volume customers.
      * *****
      * ** 09/11/2006 LJB L60906C
      * ** Update Days to Pay for last month in A/R Balance from
      * ** Days to Pay in A/R Header
      * *****
      * ** 12/01/2006 LJB PK0039
      * ** The Aging range information is now stored in the A/R Control f
      * ** The rtv was changed to get it from there and to use the
      * ** DEFAULT record.
      * *****
      * ** 12/13/2016 JBB E8097
      * ** Recompile for changes in CLC Age Cust Inv.      IF - A/R Heade
      * ** The Aging function now ages Rebills with Chargebacks.
      * ****
      * S019492  AB  09/09/2024  Re-compiled as ARBDCPP is converted to D
      * Logicals with sub-select of fields converted to all fields indexe
      * ****
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV -Value of Open Ord RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Billing Activit
     C                     MOVEL*BLANK    WN0002  1        Affect Sales Do
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P2EEVA           Value of Open O
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAANC7    WQSA02           AR Customer Num
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           AR Customer Num
      * Setup key
     C                     Z-ADDP1ANC7    WQSA02           AR Customer Num
      * Establish starting position
     C           KRSSA     SETLLZBFCPEH                    *
     C           KRSSA     READEZBFCPEH                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Order Types        RT - OP Order Types  * 
     C                     EXSR SBRVGN
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Billing Activity Type is Invoice
      *   |- c2    : PAR.Affect Sales Doll Default is yes
      *   |- c3    : DB1.Block Order Flag is Firm Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0001    IFEQ '1'                        *IF
     C           WN0002    IFEQ 'Y'                        *IF
     C           WABCST    IFEQ 'F'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/07/06 PKD PK0040 Retrieve the Accounting Company Number for
      *              the Order and only accumulate if PAR.Company Number
      *              is equal to the Accounting Company Number.
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YN0001    P      Warehouse Code
     C                     Z-ADDWL0004    YL0001           Shipping Compan
     C                     Z-ADDWL0005    YL0002           Accounting Comp
      * CASE: LCL.Accounting Company EQ PAR.Company Number
     C           YL0002    IFEQ P1AIC3                     *IF
     C                     ADD  WAJZVA    P2EEVA           Value of Open O
      * Update the "A/R Order Value" if <> "Order Value Total".
     C                     EXSR UESUBR                     Update the "A/R
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READEZBFCPEH                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Order Types        RT - OP Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBJNCD           Order Type_Sale
      * Setup key
     C                     MOVELWAJNCD    WBJNCD           Order Type_Sale
      * Establish starting position
     C           KRSSB     CHAIN@EXREYP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1063' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUOSTX           Order Type Desc
     C                     MOVEL*BLANK    WUZNST           Processing Cycl
     C                     MOVEL*BLANK    WN0001           Billing Activit
     C                     MOVEL*BLANK    WUZNST           Affect Inventor
     C                     MOVEL*BLANK    WN0002           Affect Sales Do
     C                     MOVEL*BLANK    WUZNST           Affect Sales Pn
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBJVNA    WUOSTX           Order Type Desc
     C                     MOVELWBOAST    WUZNST           Processing Cycl
     C                     MOVELWBOBST    WN0001           Billing Activit
     C                     MOVELWBOEST    WUZNST           Affect Inventor
     C                     MOVELWBOFST    WN0002           Affect Sales Do
     C                     MOVELWBVBST    WUZNST           Affect Sales Pn
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSC01           Company Number
     C                     Z-ADDWL0002    WQSC02           Order Number
      * Establish starting position
     C           KRSSC     SETLL@BGWKL1                    *
     C           KRSSC     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'C'
     C           WCGMST    OREQ 'R'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCGMST    OREQ 'I'
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
     C                     EXSR SDRVGN
     C                     MOVELWCAJCD    WL0003           Warehouse Code
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWCAJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Shipping Compan
     C                     Z-ADD*ZERO     WL0005           Accounting Comp
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDBWC3    WL0004           Shipping Compan
     C                     Z-ADDWDBTC3    WL0005           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * CHG A/R Order Value    CH - PD Order Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0003  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0004  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0005  70       Ship To Custome
     C                     MOVEL*BLANK    WN0006 30        Ship To Name
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 30        Ship To Address
     C                     MOVEL*BLANK    WN0009 30        Ship To Address
     C                     MOVEL*BLANK    WN0010 20        Ship To City
     C                     MOVEL*BLANK    WN0011  2        Ship To State C
     C                     MOVEL*BLANK    WN0012 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0013  70       Bill to Custome
     C                     MOVEL*BLANK    WN0014 30        Bill to Name
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 30        Bill to Address
     C                     MOVEL*BLANK    WN0017 30        Bill to Address
     C                     MOVEL*BLANK    WN0018 20        Bill to City
     C                     MOVEL*BLANK    WN0019  2        Bill to State C
     C                     MOVEL*BLANK    WN0020 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0021 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0022  70       Order Date
     C                     Z-ADD*ZERO     WN0023  70       Requested Ship
     C                     Z-ADD*ZERO     WN0024  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0025  70       Cancel Date
     C                     MOVEL*BLANK    WN0026  2        Terms Code
     C                     MOVEL*BLANK    WN0027 40        Special Instruc
     C                     MOVEL*BLANK    WN0028 40        Special Instruc
     C                     MOVEL*BLANK    WN0029  3        Carrier Code
     C                     MOVEL*BLANK    WN0030  1        Comment Print A
     C                     MOVEL*BLANK    WN0031  1        Comment Print I
     C                     MOVEL*BLANK    WN0032  1        Comment Print P
     C                     MOVEL*BLANK    WN0033  1        Comment Print S
     C                     MOVEL*BLANK    WN0034  3        Reason Code
     C                     MOVEL*BLANK    WN0035  1        Order in Use
     C                     MOVEL*BLANK    WN0036  1        Header Status
     C                     MOVEL*BLANK    WN0037  1        Header Status L
     C                     MOVEL*BLANK    WN0038  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0039  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0040 10        User Original E
     C                     Z-ADD*ZERO     WN0041  70       Date of Origina
     C                     Z-ADD*ZERO     WN0042 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0043 112       Order Weight To
     C                     MOVEL*BLANK    WN0044  1        Credit Hold
     C                     MOVEL*BLANK    WN0045  1        Production Hold
     C                     MOVEL*BLANK    WN0046  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0047  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0048  40       Requested Deliv
     C                     MOVEL*BLANK    WN0049  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0050 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0051  70       Load ID
     C                     Z-ADD*ZERO     WN0052  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0053 112       Rated Freight
     C                     MOVEL*BLANK    WN0054  1        LTL Flag
     C                     MOVEL*BLANK    WN0055  1        Price Audit
     C                     MOVEL*BLANK    WN0056  1        Price Status
     C                     MOVEL*BLANK    WN0057  2        Shipping Method
     C                     MOVEL*BLANK    WN0058  1        Export Status
     C                     MOVEL*BLANK    WN0059  1        Palletize
     C                     MOVEL*BLANK    WN0060  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0061  1        Slip Sheet
     C                     MOVEL*BLANK    WN0062  1        Age Code
     C                     Z-ADD*ZERO     WN0063  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0064  1        Load Type
     C                     Z-ADD*ZERO     WN0065  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0066  1        Load Plan Order
     C                     MOVEL*BLANK    WN0067  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0068  70       Resell Referenc
     C                     MOVEL*BLANK    WN0069 30        Special Comment
     C                     MOVEL*BLANK    WN0070 30        Special Comment
     C                     MOVEL*BLANK    WN0071  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0072  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0073  2        Manager Level C
     C                     MOVEL*BLANK    WN0074  3        VP Level Code
     C                     Z-ADD*ZERO     WN0075  70       Attach to Order
     C                     MOVEL*BLANK    WN0076  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0077  70       Invoice Number
     C                     MOVEL*BLANK    WN0078  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0079  70       Invoice Date
     C                     MOVEL*BLANK    WN0080  2        Event Code
     C                     MOVEL*BLANK    WN0081  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0082  1        Modified Flag
     C                     MOVEL*BLANK    WN0083  1        Billing Activit
     C                     MOVEL*BLANK    WN0084  1        Block Order Fla
     C                     MOVEL*BLANK    WN0085  1        Order Certifica
     C                     Z-ADD*ZERO     WN0086 112       Invoice Order V
     C                     MOVEL*BLANK    WN0087  1        Process Sts for
     C                     MOVEL*BLANK    WN0088  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0089  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0090  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0091  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0092  1        Email Cust On O
     C                     MOVEL*BLANK    WN0093  1        Order Emailed
     C                     MOVEL*BLANK    WN0094  1        Export Docs Go
     C                     MOVEL*BLANK    WN0095  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0096  1        Broker Order St
     C                     MOVEL*BLANK    WN0097  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0098  2        Order Requires
     C                     MOVEL*BLANK    WN0099  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0100  2        Export USDA App
     C                     MOVEL*BLANK    WN0101  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0102  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0103  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0104  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0105  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0106  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0107  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0108  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0109  60       Time of Origina
     C                     Z-ADD*ZERO     WN0110  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0111  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0112  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0113 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0114 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0115 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0116 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0117 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0118  70       Claim Number
     C                     MOVEL*BLANK    WN0119  1        EDI Status 1
     C                     MOVEL*BLANK    WN0120  1        EDI Status 2
     C                     MOVEL*BLANK    WN0121  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0122  60       Job Time
     C                     MOVEL*BLANK    WN0123 10        User Id
     C                     MOVEL*BLANK    WN0124 10        Job Name
     C                     Z-ADD*ZERO     WN0125  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0006    WEAIC3           Company Number
     C                     Z-ADDWL0007    WEC4NB           Order Number
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C           KLCHSE    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0008    WEVRVA           A_R order Value
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWEAIC3    PAAIC3           Company Number
     C                     Z-ADDWEC4NB    PAC4NB           Order Number
     C                     MOVELWEJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWEANC7    PAANC7           AR Customer Num
     C                     Z-ADDWEBKC7    PABKC7           Ship To Custome
     C                     MOVELWEBRTX    PABRTX    P      Ship To Name
     C                     MOVELWEHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWEHONA    PAHONA    P      Ship To Address
     C                     MOVELWEHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWEHNNA    PAHNNA    P      Ship To City
     C                     MOVELWEDBCD    PADBCD    P      Ship To State C
     C                     MOVELWECKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWEB0C7    PAB0C7           Bill to Custome
     C                     MOVELWEAETX    PAAETX    P      Bill to Name
     C                     MOVELWEB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWEB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWEB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWEB2NA    PAB2NA    P      Bill to City
     C                     MOVELWEBHCD    PABHCD    P      Bill to State C
     C                     MOVELWEC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWEBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWEA0DT    PAA0DT           Order Date
     C                     Z-ADDWEA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWEGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWEACDT    PAACDT           Cancel Date
     C                     MOVELWEAQCD    PAAQCD    P      Terms Code
     C                     MOVELWEB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWEBYNA    PABYNA    P      Special Instruc
     C                     MOVELWEBZNA    PABZNA    P      Carrier Code
     C                     MOVELWEGTST    PAGTST    P      Comment Print A
     C                     MOVELWEGVST    PAGVST    P      Comment Print I
     C                     MOVELWEGUST    PAGUST    P      Comment Print P
     C                     MOVELWEQFST    PAQFST    P      Comment Print S
     C                     MOVELWECQCD    PACQCD    P      Reason Code
     C                     MOVELWEGJST    PAGJST    P      Order in Use
     C                     MOVELWEGWST    PAGWST    P      Header Status
     C                     MOVELWEGXST    PAGXST    P      Header Status L
     C                     MOVELWEGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWEAODT    PAAODT           Scheduled Ship
     C                     MOVELWEAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWECXDT    PACXDT           Date of Origina
     C                     Z-ADDWEJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWEA1WG    PAA1WG           Order Weight To
     C                     MOVELWEXIST    PAXIST    P      Credit Hold
     C                     MOVELWEXJST    PAXJST    P      Production Hold
     C                     MOVELWEXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWEEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWEAFTM    PAAFTM           Requested Deliv
     C                     MOVELWEE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWEE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWERMNB    PARMNB           Load ID
     C                     Z-ADDWETBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWER1NB    PAR1NB           Rated Freight
     C                     MOVELWEPJST    PAPJST    P      LTL Flag
     C                     MOVELWEU0ST    PAU0ST    P      Price Audit
     C                     MOVELWEU1ST    PAU1ST    P      Price Status
     C                     MOVELWEQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWEU2ST    PAU2ST    P      Export Status
     C                     MOVELWEVEST    PAVEST    P      Palletize
     C                     MOVELWEVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWEVGST    PAVGST    P      Slip Sheet
     C                     MOVELWERPCD    PARPCD    P      Age Code
     C                     Z-ADDWERNNB    PARNNB           Reefer Temperat
     C                     MOVELWEVDST    PAVDST    P      Load Type
     C                     Z-ADDWEATIN    PAATIN           Attach to Invoi
     C                     MOVELWEU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWEU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWERSRN    PARSRN           Resell Referenc
     C                     MOVELWEMHNA    PAMHNA    P      Special Comment
     C                     MOVELWEMINA    PAMINA    P      Special Comment
     C                     MOVELWEWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWER4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWEBFCD    PABFCD    P      Manager Level C
     C                     MOVELWEQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWET3NB    PAT3NB           Attach to Order
     C                     MOVELWESICD    PASICD    P      Reason for Pric
     C                     Z-ADDWECONB    PACONB           Invoice Number
     C                     MOVELWECEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWEAWDT    PAAWDT           Invoice Date
     C                     MOVELWEJPCD    PAJPCD    P      Event Code
     C                     MOVELWEXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWEZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWEVRVA    PAVRVA           A_R order Value
     C                     MOVELWEOBST    PAOBST    P      Billing Activit
     C                     MOVELWEBCST    PABCST    P      Block Order Fla
     C                     MOVELWEBDST    PABDST    P      Order Certifica
     C                     Z-ADDWEB7VL    PAB7VL           Invoice Order V
     C                     MOVELWEGASX    PAGASX    P      Process Sts for
     C                     MOVELWEGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWEGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWEGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWEFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWEFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWEFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWEFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWEFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWEFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWEFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWEFUSX    PAFUSX    P      Order Requires
     C                     MOVELWEFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWEFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWEFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWEFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWENODT    PANODT           OH Appt Confirm
     C                     Z-ADDWENPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWENQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWENRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWENSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWEBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWEBQTM    PABQTM           Time of Origina
     C                     Z-ADDWEBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWEBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWEBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWEH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWEH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWEH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWEH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWEH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWEC0C7    PAC0C7           Claim Number
     C                     MOVELWEUVST    PAUVST    P      EDI Status 1
     C                     MOVELWEUWST    PAUWST    P      EDI Status 2
     C                     MOVELWEUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWEAATM    PAAATM           Job Time
     C                     MOVELWEAYNA    PAAYNA    P      User Id
     C                     MOVELWEA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWEAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV CLC Age Inv - Cust RT - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0126 112       USR Age Value 1
     C                     Z-ADD*ZERO     WN0127 112       USR Age Value 2
     C                     Z-ADD*ZERO     WN0128 112       USR Age Value 3
     C                     Z-ADD*ZERO     WN0129 112       USR Age Value 4
     C                     Z-ADD*ZERO     WN0130 112       USR Age Value 5
     C                     Z-ADD*ZERO     WN0131 112       USR Age Current
     C                     Z-ADD*ZERO     WN0132 112       USR Age Value 1
     C                     Z-ADD*ZERO     WN0133 112       USR Age Value 2
     C                     Z-ADD*ZERO     WN0134 112       USR Age Value 3
     C                     Z-ADD*ZERO     WN0135 112       USR Age Value 4
     C                     Z-ADD*ZERO     WN0136 112       USR Age Current
     C                     Z-ADD*ZERO     WN0137 112       USR Age Value 5
     C                     Z-ADD*ZERO     WN0138 112       USR Age Value 1
     C                     Z-ADD*ZERO     WN0139 112       USR Age Value 2
     C                     Z-ADD*ZERO     WN0140 112       USR Age Value 3
     C                     Z-ADD*ZERO     WN0141 112       USR Age Value 4
     C                     Z-ADD*ZERO     WN0142 112       USR Age Value 5
     C                     Z-ADD*ZERO     WN0143 112       USR Total Credi
     C                     Z-ADD*ZERO     WN0144 112       USR Age Current
     C                     Z-ADD*ZERO     WN0145  30       A_R Aging Days_
     C                     Z-ADD*ZERO     WN0146  30       A_R Aging Days_
     C                     Z-ADD*ZERO     WN0147  30       A_R Aging Days_
     C                     Z-ADD*ZERO     WN0148  30       A_R Aging Days_
     C                     Z-ADD*ZERO     WN0149 112       Save Total Cred
     C                     Z-ADD*ZERO     WN0150  50       Days Past Due
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Initialize Neither Parameters.
     C                     EXSR UGSUBR                     Initialize Neit
      * Retrieve Aging Ranges.
     C                     EXSR UHSUBR                     Retrieve Aging
      * ***** Change Log and Comments
     C                     EXSR UISUBR                     ***** Change Lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFANC7    WQSF02           AR Customer Num
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           AR Customer Num
      * Setup key
     C                     Z-ADDP1AIC3    WQSF01           Company Number
     C                     Z-ADDP1ANC7    WQSF02           AR Customer Num
      * Establish starting position
     C           KRSSF     SETLL@BDCPGB                    *
     C           KRSSF     READE@BDCPGB                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Remaining Balance Due is not equal to zeros
     C           WFBGVA    IFNE 0                          *IF
      * Sum A/R Cust Invoices with a Remaining Bal.(IN,DM)(CB)(CM,OA)
     C                     EXSR UJSUBR                     Sum A/R Cust In
     C                     END                             *FI
     C           KRSSF     READE@BDCPGB                  90*
     C                     ENDDO
      * USER: Exit processing
      * Apply Credits.
     C                     EXSR NISUBR                     Apply Credits.
      * Load Output Parameters.
     C                     EXSR NJSUBR                     Load Output Par
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Default Aging Code RT - A/R Aging Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WUG8AA           A_R Aging Code
      * Establish starting position
     C           *LOVAL    SETLL@ADCPHM                    *
     C                     READ @ADCPHM                  90*
      * Data record not found
     C   90                MOVEL'USR3661' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWGG8AA    WUG8AA           A_R Aging Code
      * CASE: DB1.Default Y/N is yes
     C           WGA1TX    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     MOVELWGG8AA    WUG8AA           A_R Aging Code
     C                     Z-ADDWGAEDY    WN0145           A_R Aging Days_
     C                     Z-ADDWGAFDY    WN0146           A_R Aging Days_
     C                     Z-ADDWGAGDY    WN0147           A_R Aging Days_
     C                     Z-ADDWGAHDY    WN0148           A_R Aging Days_
     C                     MOVELWGEUST    WUEUST           Age by Trans or
     C                     MOVELWGA1TX    WUA1TX           Default Y_N
     C                     MOVELWGVSST    WUVSST           Record Status
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C                     READ @ADCPHM                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * CHG or CRT A/R Balance CH - A/R Balance File  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0151 112       Amount of Highe
     C                     Z-ADD*ZERO     WN0152  70       Date of Highest
     C                     Z-ADD*ZERO     WN0153 112       Beginning Balan
     C                     Z-ADD*ZERO     WN0154 112       A_R Balance Val
     C                     Z-ADD*ZERO     WN0155 112       A_R Balance Val
     C                     Z-ADD*ZERO     WN0156 112       A_R Balance Val
     C                     Z-ADD*ZERO     WN0157 112       A_R Balance Val
     C                     MOVEL*BLANK    WN0158  1        EDI Status 1
     C                     MOVEL*BLANK    WN0159  1        EDI Status 2
     C                     MOVEL*BLANK    WN0160  1        EDI Status 3
     C                     MOVEL*BLANK    WN0161  1        Record Status
     C                     Z-ADD*ZERO     WN0162  60       Job Time
     C                     MOVEL*BLANK    WN0163 10        User Id
     C                     MOVEL*BLANK    WN0164 10        Job Name
     C                     Z-ADD*ZERO     WN0165  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @LDCPMI
     C                     Z-ADDP1AIC3    WHAIC3           Company Number
     C                     Z-ADDP1ANC7    WHANC7           AR Customer Num
     C                     Z-ADDP1A1NB    WHA1NB           A_R Balance Yea
     C                     Z-ADDP1Y4NB    WHY4NB           A_R Balance Mon
      *
     C           KLCHSH    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHANC7           AR Customer Num
     C                     KFLD           WHA1NB           A_R Balance Yea
     C                     KFLD           WHY4NB           A_R Balance Mon
     C           KLCHSH    CHAIN@LDCPMI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * CRT A/R Balance File   CR - A/R Balance File  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP1ANC7    WL0010           AR Customer Num
     C                     Z-ADDP1A1NB    WL0011           A_R Balance Yea
     C                     Z-ADDP1Y4NB    WL0012           A_R Balance Mon
     C                     Z-ADDP1WBVA    WL0013           Amount of Highe
     C                     Z-ADD##JDT     WL0014           Date of Highest
     C                     Z-ADD*ZERO     WL0015           Beginning Balan
     C                     Z-ADD*ZERO     WL0016           A_R Balance Val
     C                     Z-ADD*ZERO     WL0017           A_R Balance Val
     C                     Z-ADD*ZERO     WL0018           A_R Balance Val
     C                     Z-ADD*ZERO     WL0019           A_R Balance Val
     C                     Z-ADD*ZERO     WL0020           Bal Nbr of Orde
     C                     Z-ADD*ZERO     WL0021           Bal Nbr of Cred
     C                     Z-ADD*ZERO     WL0022           Bal Nbr of Paym
     C                     Z-ADD*ZERO     WL0023           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WL0024           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WL0025           Bal Avg Days to
     C                     Z-ADDP1BSDY    WL0026           Days to Pay
     C                     Z-ADD*ZERO     WL0027           Override Total
     C                     MOVELWUUNUS    WL0028    P      SSI Download Fl
     C                     MOVELWUUNU2    WL0029    P      unused status 2
     C                     MOVELWN0158    WL0030    P      EDI Status 1
     C                     MOVELWN0159    WL0031    P      EDI Status 2
     C                     MOVELWN0160    WL0032    P      EDI Status 3
     C                     MOVELWN0161    WL0033    P      Record Status
     C                     EXSR SICRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLDCPL0'MDACP
     C                     MOVEL'@LDCPMI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDLD1    YBRDCS
      * Move non-key fields to @LDCPMI
     C                     Z-ADD*ZERO     WHRTNX           Bal Nbr of Orde
     C                     Z-ADD*ZERO     WHRUNX           Bal Nbr of Cred
     C                     Z-ADD*ZERO     WHRVNX           Bal Nbr of Paym
     C                     Z-ADD*ZERO     WHRWNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WHRXNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WHB4DY           Bal Avg Days to
     C                     Z-ADDP1BSDY    WHBSDY           Days to Pay
     C                     Z-ADD*ZERO     WHK2DT           Override Total
     C                     MOVELWUUNUS    WHUNUS    P      SSI Download Fl
     C                     MOVELWUUNU2    WHUNU2    P      unused status 2
      *
      * Set PGM.*Record Data Changed flag
     C           QPDLD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * CASE: PAR.USR Total Bal Due - Cust GT DB1.Amount of Highest A/R B
     C           P1WBVA    IFGT WHALVA                     *IF
     C                     Z-ADDP1WBVA    WHALVA           Amount of Highe
     C                     Z-ADD##JDT     WHAIDT           Date of Highest
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QPDLD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@LDCPMI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDLDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * CRT A/R Balance File   CR - A/R Balance File  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0166  60       Job Time
     C                     MOVEL*BLANK    WN0167 10        User Id
     C                     MOVEL*BLANK    WN0168 10        Job Name
     C                     Z-ADD*ZERO     WN0169  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LDCPMI
     C                     Z-ADDWL0009    WHAIC3           Company Number
     C                     Z-ADDWL0010    WHANC7           AR Customer Num
     C                     Z-ADDWL0011    WHA1NB           A_R Balance Yea
     C                     Z-ADDWL0012    WHY4NB           A_R Balance Mon
     C                     Z-ADDWL0013    WHALVA           Amount of Highe
     C                     Z-ADDWL0014    WHAIDT           Date of Highest
     C                     Z-ADDWL0015    WHY5VA           Beginning Balan
     C                     Z-ADDWL0016    WHZAVA           A_R Balance Val
     C                     Z-ADDWL0017    WHY7VA           A_R Balance Val
     C                     Z-ADDWL0018    WHY8VA           A_R Balance Val
     C                     Z-ADDWL0019    WHY9VA           A_R Balance Val
     C                     Z-ADDWL0020    WHRTNX           Bal Nbr of Orde
     C                     Z-ADDWL0021    WHRUNX           Bal Nbr of Cred
     C                     Z-ADDWL0022    WHRVNX           Bal Nbr of Paym
     C                     Z-ADDWL0023    WHRWNX           Bal Nbr of Invo
     C                     Z-ADDWL0024    WHRXNX           Bal Nbr of Invo
     C                     Z-ADDWL0025    WHB4DY           Bal Avg Days to
     C                     Z-ADDWL0026    WHBSDY           Days to Pay
     C                     Z-ADDWL0027    WHK2DT           Override Total
     C                     MOVELWL0028    WHUNUS           SSI Download Fl
     C                     MOVELWL0029    WHUNU2           unused status 2
     C                     MOVELWL0030    WHUVST           EDI Status 1
     C                     MOVELWL0031    WHUWST           EDI Status 2
     C                     MOVELWL0032    WHUXST           EDI Status 3
     C                     MOVELWL0033    WHVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSI    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHANC7           AR Customer Num
     C                     KFLD           WHA1NB           A_R Balance Yea
     C                     KFLD           WHY4NB           A_R Balance Mon
      * Check for duplicate primary key
     C           KLCRSI    SETLL@LDCPMI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2449' W0RTN   7
      * Send message 'AR Balance File        EX'
     C                     MOVEL'USR2449' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@LDCPMI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Last Payment Date  RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P1AMVA           Amount of Last
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WIANC7    WQSJ02           AR Customer Num
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           AR Customer Num
     C                     KFLD           WIH0DT           Last Payment Da
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           AR Customer Num
      * Setup key
     C                     Z-ADDP1AIC3    WQSJ01           Company Number
     C                     Z-ADDP1ANC7    WQSJ02           AR Customer Num
     C                     Z-ADDP1ALDT    WIH0DT           Last Payment Da
      * Establish starting position
     C           KPSSJ     SETLL@BDCPMK                    *
     C           KRSSJ     READE@BDCPMK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     P1ALDT           Last Payment Da
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Invoice Suffix is Invoice or Debit Memo
     C           WICEST    IFEQ 'DM'                       *IF
     C           WICEST    OREQ 'IN'
      * CASE: DB1.Last Payment Date NE WRK.ZERO
     C           WIH0DT    IFNE WUW0NB                     *IF
     C                     Z-ADDWIH0DT    P1ALDT           Last Payment Da
      * RTV Last Paid Invoices RT - A/R Header  * 
     C                     EXSR SKRVGN
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@BDCPMK                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Last Payment Date is High Values
     C           P1ALDT    IFEQ 9999999                    *IF
     C                     Z-ADD*ZERO     P1ALDT           Last Payment Da
     C                     END                             *FI
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Last Paid Invoices RT - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0170 112       Transaction Amo
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P1AMVA           USR Cash Appl A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WJG4CD    WQSK02           Bank Code
     C           *LIKE     DEFN WJH0DT    WQSK03           Last Payment Da
     C           *LIKE     DEFN WJANC7    WQSK04           AR Customer Num
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Bank Code
     C                     KFLD           WQSK03           Last Payment Da
     C                     KFLD           WQSK04           AR Customer Num
      * Setup key
     C                     Z-ADDP1AIC3    WQSK01           Company Number
     C                     MOVELWIG4CD    WQSK02           Bank Code
     C                     Z-ADDWIH0DT    WQSK03           Last Payment Da
     C                     Z-ADDWIANC7    WQSK04           AR Customer Num
      * Establish starting position
     C           KRSSK     SETLL@BDCPD5                    *
     C           KRSSK     READE@BDCPD5                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Bank Code EQ DB1.Bank Code
      *   |- c2    : PAR.Last Payment Date EQ DB1.Last Payment Date
      *   |- c3    : PAR.A/R Customer Number EQ DB1.A/R Customer Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WIG4CD    IFEQ WJG4CD                     *IF
     C           WIH0DT    IFEQ WJH0DT                     *IF
     C           WIANC7    IFEQ WJANC7                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Last Payment Amt   RT - A/R Detail  * 
     C                     EXSR SLRVGN
     C                     ADD  WN0170    P1AMVA           USR Cash Appl A
     C                     END                             *FI
     C           KRSSK     READE@BDCPD5                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Last Payment Amt   RT - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0170           Transaction Amo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WKCONB    WQSL02           Invoice Number
     C           *LIKE     DEFN WKCEST    WQSL03           Invoice Suffix
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Invoice Number
     C                     KFLD           WQSL03           Invoice Suffix
     C                     KFLD           WKDXNB           Sequence Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Invoice Number
     C                     KFLD           WQSL03           Invoice Suffix
      * Setup key
     C                     Z-ADDP1AIC3    WQSL01           Company Number
     C                     Z-ADDWJCONB    WQSL02           Invoice Number
     C                     MOVELWJCEST    WQSL03           Invoice Suffix
     C                     Z-ADD*ZERO     WKDXNB           Sequence Number
      * Establish starting position
     C           KPSSL     SETLL@BFCPFO                    *
     C           KRSSL     READE@BFCPFO                  90*
      * Data record not found
     C   90                MOVEL'USR0178' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Payment/Deposit Date EQ DB1.Payment/Deposit Date
      *   |- c2    : PAR.Bank Code EQ DB1.Bank Code
      *   |- c3    : PAR.Invoice Number EQ DB1.Invoice Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WIH0DT    IFEQ WKDVDT                     *IF
     C           WIG4CD    IFEQ WKG4CD                     *IF
     C           WJCONB    IFEQ WKCONB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Cash/Adj is Cash Adjustment
     C           WKA5ST    IFEQ 'CSH'                      *IF
     C                     ADD  WKBSVA    WN0170           Transaction Amo
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@BFCPFO                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Days Paid MTD      RT - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0171  20       USR Job Year
     C                     Z-ADD*ZERO     WN0172  20       USR Job Month
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0037           Days to Pay
     C                     Z-ADD*ZERO     WL0040           MTD Invoices Pa
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WLANC7    WQSM02           AR Customer Num
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           AR Customer Num
     C                     KFLD           WLH4DT           Paid in Full Da
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           AR Customer Num
      * Setup key
     C                     Z-ADDWL0034    WQSM01           Company Number
     C                     Z-ADDWL0036    WQSM02           AR Customer Num
     C                     Z-ADDWL0035    WLH4DT           Paid in Full Da
      * Establish starting position
     C           KPSSM     SETLL@BDCPML                    *
     C           KRSSM     READE@BDCPML                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Remaining Balance Due is equal to zero
      *   |- c2    : DB1.Invoice Suffix is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WLBGVA    IFEQ 0                          *IF
     C           WLCEST    IFEQ 'DM'                       *IF
     C           WLCEST    OREQ 'IN'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PAR.USR Job Year = DB1.Paid in Full Date *YEAR
     C           WLH4DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0171
      * PAR.USR Job Month = DB1.Paid in Full Date *MONTH
     C           WLH4DT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WN0172
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR Job Year EQ PAR.*Job year
      *   |- c2    : PAR.USR Job Month EQ PAR.USR Current Month
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0171    IFEQ WL0039                     *IF
     C           WN0172    IFEQ WL0038                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  WLBSDY    WL0037           Days to Pay
     C                     ADD  1         WL0040           MTD Invoices Pa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@BDCPML                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Num. Paymnts p/Mo RT - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0173  20       USR Job Year
     C                     Z-ADD*ZERO     WN0174  50       USR Accum. Pay
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WURVNX           USR Number of P
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMANC7    WQSN01           AR Customer Num
     C           *LIKE     DEFN WMAIC3    WQSN02           Company Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           AR Customer Num
     C                     KFLD           WQSN02           Company Number
      * Setup key
     C                     Z-ADDP1ANC7    WQSN01           AR Customer Num
     C                     Z-ADDP1AIC3    WQSN02           Company Number
      * Establish starting position
     C           KRSSN     SETLL@BDCPIJ                    *
     C           KRSSN     READE@BDCPIJ                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR.USR Job Year = DB1.Last Payment Date *YEAR
     C           WMH0DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0173
     C                     Z-ADD*ZERO     WN0174           USR Accum. Pay
      * CASE: PAR.*Job year EQ PAR.USR Job Year
     C           WUI8NX    IFEQ WN0173                     *IF
      * RTV No of Paymnts p/mo RT - A/R Detail  * 
     C                     EXSR SORVGN
     C                     ADD  WN0174    WURVNX           USR Number of P
     C                     END                             *FI
     C           KRSSN     READE@BDCPIJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV No of Paymnts p/mo RT - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0174           USR Number of P
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WOCONB    WQSO02           Invoice Number
     C           *LIKE     DEFN WOCEST    WQSO03           Invoice Suffix
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Invoice Number
     C                     KFLD           WQSO03           Invoice Suffix
      * Setup key
     C                     Z-ADDWMAIC3    WQSO01           Company Number
     C                     Z-ADDWMCONB    WQSO02           Invoice Number
     C                     MOVELWMCEST    WQSO03           Invoice Suffix
      * Establish starting position
     C           KRSSO     SETLL@BECPDS                    *
     C           KRSSO     READE@BECPDS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0178' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SOEXIT                     *QUIT
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * WRK.Month                 USR = DB1.Transaction Date Code *MONTH
     C           WOB4DT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUXX45
      * WRK.USR Job Year = DB1.Transaction Date Code *YEAR
     C           WOB4DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUJBYR
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Month                 USR EQ PAR.A/R Summ-Curr M
      *   |- c2    : WRK.USR Job Year EQ PAR.USR Job Year
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUXX45    IFEQ P1A8NX                     *IF
     C           WUJBYR    IFEQ WN0173                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Cash/Adj is Cash Adjustment
     C           WOA5ST    IFEQ 'CSH'                      *IF
     C                     ADD  1         WN0174           USR Number of P
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@BECPDS                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv f/A/R Bal MTD Upd RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WURWNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WURUNX           Bal Nbr of Cred
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRANC7    WQSP02           AR Customer Num
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP02           AR Customer Num
     C                     KFLD           WRAWDT           Invoice Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP02           AR Customer Num
      * Setup key
     C                     Z-ADDP1ANC7    WQSP02           AR Customer Num
     C                     Z-ADDYL0003    WRAWDT           Invoice Date
      * Establish starting position
     C           KPSSP     SETLL@BFCPOR                    *
     C           KRSSP     READE@BFCPOR                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * WRK.Month                 USR = DB1.Invoice Date *MONTH
     C           WRAWDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUXX45
      * WRK.Year Code = DB1.Invoice Date *YEAR
     C           WRAWDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
      * CASE:
      *  - c2ANDc1
      *   |- c2    : WRK.Year Code EQ PAR.Year Code
      *   |- c1    : WRK.Month                 USR EQ PAR.Month
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAYNX    IFEQ P1A1NB                     *IF
     C           WUXX45    IFEQ P1A8NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/07/06 PKD PK0040 Retrieve the Accounting Company Number for
      *              the Order and only accumulate if PAR.Company Number
      *              is equal to the Accounting Company Number.
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0001           Company Number
     C                     Z-ADDWRC4NB    WL0002           Order Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YN0002    P      Warehouse Code
     C                     Z-ADDWL0004    YL0004           Shipping Compan
     C                     Z-ADDWL0005    YL0005           Accounting Comp
      * CASE: LCL.Accounting Company EQ PAR.Company Number
     C           YL0005    IFEQ P1AIC3                     *IF
      * CASE: DB1.Billing Activity Type is Invoice
     C           WROBST    IFEQ '1'                        *IF
     C                     ADD  1         WURWNX           Bal Nbr of Invo
     C                     ELSE
      * CASE: DB1.Billing Activity Type is Credit Memo
     C           WROBST    IFEQ '2'                        *IF
     C                     ADD  1         WURUNX           Bal Nbr of Cred
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@BFCPOR                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv f/A/R Bal #OrdUpd RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WURTNX           Bal Nbr of Orde
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSANC7    WQSQ02           AR Customer Num
      * Define keylist
     C           KPSSQ     KLIST
     C                     KFLD           WQSQ02           AR Customer Num
     C                     KFLD           WSA0DT           Order Date
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           AR Customer Num
      * Setup key
     C                     Z-ADDP1ANC7    WQSQ02           AR Customer Num
     C                     Z-ADDYL0003    WSA0DT           Order Date
      * Establish starting position
     C           KPSSQ     SETLL@BFCPOS                    *
     C           KRSSQ     READE@BFCPOS                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * WRK.Month                 USR = DB1.Order Date *MONTH
     C           WSA0DT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUXX45
      * WRK.Year Code = DB1.Order Date *YEAR
     C           WSA0DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
      * CASE:
      *  - c2ANDc1
      *   |- c2    : WRK.Year Code EQ PAR.Year Code
      *   |- c1    : WRK.Month                 USR EQ PAR.Month
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAYNX    IFEQ P1A1NB                     *IF
     C           WUXX45    IFEQ P1A8NX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/07/06 PKD PK0040 Retrieve the Accounting Company Number for
      *              the Order and only accumulate if PAR.Company Number
      *              is equal to the Accounting Company Number.
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0001           Company Number
     C                     Z-ADDWSC4NB    WL0002           Order Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YN0003    P      Warehouse Code
     C                     Z-ADDWL0004    YL0006           Shipping Compan
     C                     Z-ADDWL0005    YL0007           Accounting Comp
      * CASE: LCL.Accounting Company EQ PAR.Company Number
     C           YL0007    IFEQ P1AIC3                     *IF
     C                     ADD  1         WURTNX           Bal Nbr of Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSQ     READE@BFCPOS                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg/Crt A/R Bal MTDs  CH - A/R Balance File  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0175 112       Amount of Highe
     C                     Z-ADD*ZERO     WN0176  70       Date of Highest
     C                     Z-ADD*ZERO     WN0177 112       Beginning Balan
     C                     Z-ADD*ZERO     WN0178 112       A_R Balance Val
     C                     Z-ADD*ZERO     WN0179 112       A_R Balance Val
     C                     Z-ADD*ZERO     WN0180 112       A_R Balance Val
     C                     Z-ADD*ZERO     WN0181 112       A_R Balance Val
     C                     Z-ADD*ZERO     WN0182  70       Override Total
     C                     MOVEL*BLANK    WN0183  1        SSI Download Fl
     C                     MOVEL*BLANK    WN0184  1        unused status 2
     C                     MOVEL*BLANK    WN0185  1        EDI Status 1
     C                     MOVEL*BLANK    WN0186  1        EDI Status 2
     C                     MOVEL*BLANK    WN0187  1        EDI Status 3
     C                     MOVEL*BLANK    WN0188  1        Record Status
     C                     Z-ADD*ZERO     WN0189  60       Job Time
     C                     MOVEL*BLANK    WN0190 10        User Id
     C                     MOVEL*BLANK    WN0191 10        Job Name
     C                     Z-ADD*ZERO     WN0192  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @LDCPMI
     C                     Z-ADDP1AIC3    WHAIC3           Company Number
     C                     Z-ADDP1ANC7    WHANC7           AR Customer Num
     C                     Z-ADDP1A1NB    WHA1NB           A_R Balance Yea
     C                     Z-ADDP1A8NX    WHY4NB           A_R Balance Mon
      *
     C           KLCHSR    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHANC7           AR Customer Num
     C                     KFLD           WHA1NB           A_R Balance Yea
     C                     KFLD           WHY4NB           A_R Balance Mon
     C           KLCHSR    CHAIN@LDCPMI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * CRT A/R Balance File   CR - A/R Balance File  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP1ANC7    WL0010           AR Customer Num
     C                     Z-ADDP1A1NB    WL0011           A_R Balance Yea
     C                     Z-ADDP1A8NX    WL0012           A_R Balance Mon
     C                     Z-ADD*ZERO     WL0013           Amount of Highe
     C                     Z-ADD*ZERO     WL0014           Date of Highest
     C                     Z-ADD*ZERO     WL0015           Beginning Balan
     C                     Z-ADD*ZERO     WL0016           A_R Balance Val
     C                     Z-ADD*ZERO     WL0017           A_R Balance Val
     C                     Z-ADD*ZERO     WL0018           A_R Balance Val
     C                     Z-ADD*ZERO     WL0019           A_R Balance Val
     C                     Z-ADDWURTNX    WL0020           Bal Nbr of Orde
     C                     Z-ADDWURUNX    WL0021           Bal Nbr of Cred
     C                     Z-ADDWURVNX    WL0022           Bal Nbr of Paym
     C                     Z-ADDWURWNX    WL0023           Bal Nbr of Invo
     C                     Z-ADDWURXNX    WL0024           Bal Nbr of Invo
     C                     Z-ADDWUB4DY    WL0025           Bal Avg Days to
     C                     Z-ADDP1BSDY    WL0026           Days to Pay
     C                     Z-ADDWUK2DT    WL0027           Override Total
     C                     MOVELWUUNUS    WL0028    P      SSI Download Fl
     C                     MOVELWUUNU2    WL0029    P      unused status 2
     C                     MOVELWN0185    WL0030    P      EDI Status 1
     C                     MOVELWN0186    WL0031    P      EDI Status 2
     C                     MOVELWN0187    WL0032    P      EDI Status 3
     C                     MOVELWN0188    WL0033    P      Record Status
     C                     EXSR SICRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLDCPL0'MDACP
     C                     MOVEL'@LDCPMI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDLD1    YCRDCS
      * Move non-key fields to @LDCPMI
     C                     Z-ADDWURTNX    WHRTNX           Bal Nbr of Orde
     C                     Z-ADDWURUNX    WHRUNX           Bal Nbr of Cred
     C                     Z-ADDWURVNX    WHRVNX           Bal Nbr of Paym
     C                     Z-ADDWURWNX    WHRWNX           Bal Nbr of Invo
     C                     Z-ADDWURXNX    WHRXNX           Bal Nbr of Invo
     C                     Z-ADDWUB4DY    WHB4DY           Bal Avg Days to
     C                     Z-ADDP1BSDY    WHBSDY           Days to Pay
      *
      * Set PGM.*Record Data Changed flag
     C           QPDLD1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDLD1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@LDCPMI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDLDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Num. Payments      RT - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0193  20       USR Job Year
     C                     Z-ADD*ZERO     WN0194  50       USR Accum. Pay
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P1NBPY           USR Number of P
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMANC7    WQSS01           AR Customer Num
     C           *LIKE     DEFN WMAIC3    WQSS02           Company Number
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           AR Customer Num
     C                     KFLD           WQSS02           Company Number
      * Setup key
     C                     Z-ADDP1ANC7    WQSS01           AR Customer Num
     C                     Z-ADDP1AIC3    WQSS02           Company Number
      * Establish starting position
     C           KRSSS     SETLL@BDCPIJ                    *
     C           KRSSS     READE@BDCPIJ                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR.USR Job Year = DB1.Last Payment Date *YEAR
     C           WMH0DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0193
     C                     Z-ADD*ZERO     WN0194           USR Accum. Pay
      * CASE: PAR.*Job year EQ PAR.USR Job Year
     C           ##JYY     IFEQ WN0193                     *IF
      * RTV Num. of Payments   RT - A/R Detail  * 
     C                     EXSR STRVGN
     C                     ADD  WN0194    P1NBPY           USR Number of P
     C                     END                             *FI
     C           KRSSS     READE@BDCPIJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Num. of Payments   RT - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0194           USR Number of P
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQST01           Company Number
     C           *LIKE     DEFN WOCONB    WQST02           Invoice Number
     C           *LIKE     DEFN WOCEST    WQST03           Invoice Suffix
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Invoice Number
     C                     KFLD           WQST03           Invoice Suffix
      * Setup key
     C                     Z-ADDWMAIC3    WQST01           Company Number
     C                     Z-ADDWMCONB    WQST02           Invoice Number
     C                     MOVELWMCEST    WQST03           Invoice Suffix
      * Establish starting position
     C           KRSST     SETLL@BECPDS                    *
     C           KRSST     READE@BECPDS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0178' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO STEXIT                     *QUIT
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Cash/Adj is Cash Adjustment
     C           WOA5ST    IFEQ 'CSH'                      *IF
     C                     ADD  1         WN0194           USR Number of P
     C                     END                             *FI
     C           KRSST     READE@BECPDS                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG Nite Aging Fields  CH - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0195  70       Date of First S
     C                     Z-ADD*ZERO     WN0196  70       Date of Last Sh
     C                     Z-ADD*ZERO     WN0197 112       Amount of Last
     C                     Z-ADD*ZERO     WN0198  50       Number of Invoi
     C                     Z-ADD*ZERO     WN0199  50       Number of Order
     C                     Z-ADD*ZERO     WN0200  50       Number of Credi
     C                     Z-ADD*ZERO     WN0201  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0202  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0203  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0204  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0205 112       YTD Sales Invoi
     C                     Z-ADD*ZERO     WN0206 112       Last Year Sales
     C                     MOVEL*BLANK    WN0207  3        Salesperson Cod
     C                     MOVEL*BLANK    WN0208  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0209  1        EDI Status 1
     C                     MOVEL*BLANK    WN0210  1        EDI Status 2
     C                     MOVEL*BLANK    WN0211  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0212  60       Job Time
     C                     MOVEL*BLANK    WN0213 10        User Id
     C                     MOVEL*BLANK    WN0214 10        Job Name
     C                     Z-ADD*ZERO     WN0215  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BCREFD
     C                     Z-ADDP1AIC3    WTAIC3           Company Number
     C                     Z-ADDP1ANC7    WTANC7           AR Customer Num
      *
     C           KLCHSU    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTANC7           AR Customer Num
     C           KLCHSU    CHAIN@BCREFD              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBCREL0'MDACP
     C                     MOVEL'@BCREFD' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBC1    YDRDCS
      * Move non-key fields to @BCREFD
     C                     Z-ADDP1AGVA    WTAGVA           Age_Due_Current
     C                     Z-ADDP1ACVA    WTACVA           Age_Due_Aging 1
     C                     Z-ADDP1ADVA    WTADVA           Age_Due_Aging 2
     C                     Z-ADDP1AEVA    WTAEVA           Age_Due_Aging 3
     C                     Z-ADDP1AFVA    WTAFVA           Age_Due_Aging 4
     C                     Z-ADDP1AHVA    WTAHVA           Age_Due_Aging 5
     C                     Z-ADDP1VIVA    WTVIVA           Age_Due_Current
     C                     Z-ADDP1VJVA    WTVJVA           Age_Due_Aging 1
     C                     Z-ADDP1VKVA    WTVKVA           Age_Due_Aging 2
     C                     Z-ADDP1VLVA    WTVLVA           Age_Due_Aging 3
     C                     Z-ADDP1VMVA    WTVMVA           Age_Due_Aging 4
     C                     Z-ADDP1VNVA    WTVNVA           Age_Due_Aging 5
     C                     Z-ADDP2EEVA    WTEEVA           Value of Open O
     C                     Z-ADD##JTM     WTAKTM           Time of Last Ag
     C                     Z-ADDP1ALDT    WTALDT           Date of Last Pa
     C                     Z-ADDP1AMVA    WTAMVA           Amount of Last
     C                     Z-ADDP1AIDT    WTAIDT           Date of Highest
     C                     Z-ADDP1ALVA    WTALVA           Amount of Highe
     C                     Z-ADDP1NBPY    WTDMNB           Number of Payme
     C                     Z-ADD##JDT     WTDUDT           Date of Last Ag
     C                     Z-ADDP1ADPM    WTADPM           MTD Invoices Pa
     C                     Z-ADDP1VOVA    WTVOVA           YTD Invoices Pa
     C                     Z-ADDP1BTDY    WTBTDY           MTD Days Paid
     C                     Z-ADDP1BUDY    WTBUDY           YTD Days Paid
     C                     Z-ADDP1CUMO    WTCUMO           Current Month
      *
      * Set PGM.*Record Data Changed flag
     C           QARBC1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BCREFD                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBCREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * 1. Initialize Fields.
      *================================================================
      * Initialize all neither parameters.
     C                     EXSR UBSUBR                     Initialize all
      * Initialize all work fields.
     C                     EXSR UCSUBR                     Initialize all
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Initialize all neither parameters.
      *================================================================
     C                     Z-ADD*ZERO     P1AGVA           Age_Due_Current
     C                     Z-ADD*ZERO     P1ACVA           Age_Due_Aging 1
     C                     Z-ADD*ZERO     P1ADVA           Age_Due_Aging 2
     C                     Z-ADD*ZERO     P1AEVA           Age_Due_Aging 3
     C                     Z-ADD*ZERO     P1AFVA           Age_Due_Aging 4
     C                     Z-ADD*ZERO     P1AHVA           Age_Due_Aging 5
     C                     Z-ADD*ZERO     P1VIVA           Age_Due_Current
     C                     Z-ADD*ZERO     P1VJVA           Age_Due_Aging 1
     C                     Z-ADD*ZERO     P1VKVA           Age_Due_Aging 2
     C                     Z-ADD*ZERO     P1VLVA           Age_Due_Aging 3
     C                     Z-ADD*ZERO     P1VMVA           Age_Due_Aging 4
     C                     Z-ADD*ZERO     P1VNVA           Age_Due_Aging 5
     C                     Z-ADD*ZERO     P1ALDT           Date of Last Pa
     C                     Z-ADD*ZERO     P1AMVA           Amount of Last
     C                     Z-ADD*ZERO     P1AIDT           Date of Highest
     C                     Z-ADD*ZERO     P1ALVA           Amount of Highe
     C                     Z-ADD*ZERO     P1ADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     P1VOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     P1BTDY           MTD Days Paid
     C                     Z-ADD*ZERO     P1BUDY           YTD Days Paid
     C                     Z-ADD*ZERO     P1H4DT           Paid in Full Da
     C                     Z-ADD*ZERO     P1BSDY           Days to Pay
     C                     Z-ADD*ZERO     P1WBVA           USR Tot. Due W/
     C                     Z-ADD*ZERO     P1NBPY           USR Number of P
     C                     Z-ADD*ZERO     P1V7VA           USR Total Due
     C                     Z-ADD*ZERO     P1CUMO           Current Month
     C                     Z-ADD*ZERO     P2EEVA           Value of Open O
     C                     Z-ADD*ZERO     P1A1NB           A_R Balance Yea
     C                     Z-ADD*ZERO     P1Y4NB           A_R Balance Mon
     C                     Z-ADD*ZERO     P1JYY            *Job year
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Initialize all work fields.
      *================================================================
     C                     Z-ADD*ZERO     WUBSDY           Days to Pay
     C                     Z-ADD*ZERO     WUADPM           MTD Invoices Pa
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * 2. Value of Open Orders.
      *================================================================
      * Calculate the "Value of Open Orders" for the A/R Customer from
      * the PD Order Header file.
      * Update the "A/R Order Value" if not = to "Value of Open Orders".
      * RTV -Value of Open Ord RT - Order Header TRG  * 
     C                     EXSR SARVGN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Update the "A/R Order Value" if <> "Order Value Total".
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Order Value Total NE DB1.A/R order Value Total
      *   |- c2    : DB1.A/R order Value Total NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAJZVA    IFNE WAVRVA                     *IF
     C           WAVRVA    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG A/R Order Value    CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0006           Company Number
     C                     Z-ADDWAC4NB    WL0007           Order Number
     C                     Z-ADDWAJZVA    WL0008           A_R order Value
     C                     EXSR SECHRC
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * 3. Age Receivables Due Buckets for A/R customer.
      *================================================================
      * RTV CLC Age Inv - Cust RT - A/R Header  * 
     C                     EXSR SFRVGN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Initialize Neither Parameters.
      *================================================================
     C                     Z-ADD*ZERO     WN0144           USR Age Current
     C                     Z-ADD*ZERO     WN0138           USR Age Value 1
     C                     Z-ADD*ZERO     WN0139           USR Age Value 2
     C                     Z-ADD*ZERO     WN0140           USR Age Value 3
     C                     Z-ADD*ZERO     WN0141           USR Age Value 4
     C                     Z-ADD*ZERO     WN0142           USR Age Value 5
     C                     Z-ADD*ZERO     WN0136           USR Age Current
     C                     Z-ADD*ZERO     WN0126           USR Age Value 1
     C                     Z-ADD*ZERO     WN0127           USR Age Value 2
     C                     Z-ADD*ZERO     WN0128           USR Age Value 3
     C                     Z-ADD*ZERO     WN0129           USR Age Value 4
     C                     Z-ADD*ZERO     WN0130           USR Age Value 5
     C                     Z-ADD*ZERO     WN0131           USR Age Current
     C                     Z-ADD*ZERO     WN0132           USR Age Value 1
     C                     Z-ADD*ZERO     WN0133           USR Age Value 2
     C                     Z-ADD*ZERO     WN0134           USR Age Value 3
     C                     Z-ADD*ZERO     WN0135           USR Age Value 4
     C                     Z-ADD*ZERO     WN0137           USR Age Value 5
     C                     Z-ADD*ZERO     WN0143           USR Total Credi
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Retrieve Aging Ranges.
      *================================================================
      * ** Retrieve aging ranges for the default record   12/01/06 LJB
      * RTV Default Aging Code RT - A/R Aging Control  * 
     C                     EXSR SGRVGN
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 12/01/2006 LJB PK0039
      * ** Aging ranges are now stored in the A/R Aging Control file
      * ** Retrieve aging ranges for the default record
      * *****
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Sum A/R Cust Invoices with a Remaining Bal.(IN,DM)(CB)(CM,OA)
      *================================================================
      * PAR.Days Past Due  USR = JOB.*Job date - DB1.Due Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WFATDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     WN0150
     C                     ELSE
     C           XDURR     MULT -1        WN0150
     C                     END
      * CASE: PAR.Days Past Due  USR is <= Zero
     C           WN0150    IFLE 0                          *IF
      * Current.
     C                     EXSR UKSUBR                     Current.
     C                     ELSE
      * CASE: PAR.Days Past Due  USR LE PAR.A/R Aging Days - 1
     C           WN0150    IFLE WN0145                     *IF
      * Past Due Period 1.
     C                     EXSR UOSUBR                     Past Due Period
     C                     ELSE
      * CASE: PAR.Days Past Due  USR LE PAR.A/R Aging Days - 2
     C           WN0150    IFLE WN0146                     *IF
      * Past Due Period 2.
     C                     EXSR USSUBR                     Past Due Period
     C                     ELSE
      * CASE: PAR.Days Past Due  USR LE PAR.A/R Aging Days - 3
     C           WN0150    IFLE WN0147                     *IF
      * Past Due Period 3.
     C                     EXSR UWSUBR                     Past Due Period
     C                     ELSE
      * CASE: PAR.Days Past Due  USR LE PAR.A/R Aging Days - 4
     C           WN0150    IFLE WN0148                     *IF
      * Past Due Period 4.
     C                     EXSR NASUBR                     Past Due Period
     C                     ELSE
      * CASE: *OTHERWISE
      * Past Due Period 5.
     C                     EXSR NESUBR                     Past Due Period
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Current.
      *================================================================
      * CLC Aging Bucket       IF
      * CASE: PAR.Invoice Suffix is Charge Backs and Rebills
     C           WFCEST    IFEQ 'CB'                       *IF
     C           WFCEST    OREQ 'RB'
      * Age Chargebacks and Rebills.
     C                     EXSR ULSUBR                     Age Chargebacks
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Invoices
      *   |- c2    : PAR.Invoice Suffix is Debit Memos
      *   '-
     C           WFCEST    IFEQ 'IN'                       *IF
     C           WFCEST    OREQ 'DM'                       *OR
      * Age Invoices and Debit Memos.
     C                     EXSR UMSUBR                     Age Invoices an
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Credit Memos
      *   |- c2    : PAR.Invoice Suffix is On Account Cash
      *   '-
     C           WFCEST    IFEQ 'CM'                       *IF
     C           WFCEST    OREQ 'OA'                       *OR
      * Accumulate Credit to Apply.
     C                     EXSR UNSUBR                     Accumulate Cred
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Age Chargebacks and Rebills.
      *================================================================
     C                     ADD  WFBGVA    WN0136           Aging - CB    A
     C                     ADD  WFBGVA    WN0131           Aging - IN/DM/C
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Age Invoices and Debit Memos.
      *================================================================
     C                     ADD  WFBGVA    WN0144           Aging - IN/DM A
     C                     ADD  WFBGVA    WN0131           Aging - IN/DM/C
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Accumulate Credit to Apply.
      *================================================================
     C                     ADD  WFBGVA    WN0143           Aging - CM/OA A
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Past Due Period 1.
      *================================================================
      * CLC Aging Bucket       IF
      * CASE: PAR.Invoice Suffix is Charge Backs and Rebills
     C           WFCEST    IFEQ 'CB'                       *IF
     C           WFCEST    OREQ 'RB'
      * Age Chargebacks and Rebills.
     C                     EXSR UPSUBR                     Age Chargebacks
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Invoices
      *   |- c2    : PAR.Invoice Suffix is Debit Memos
      *   '-
     C           WFCEST    IFEQ 'IN'                       *IF
     C           WFCEST    OREQ 'DM'                       *OR
      * Age Invoices and Debit Memos.
     C                     EXSR UQSUBR                     Age Invoices an
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Credit Memos
      *   |- c2    : PAR.Invoice Suffix is On Account Cash
      *   '-
     C           WFCEST    IFEQ 'CM'                       *IF
     C           WFCEST    OREQ 'OA'                       *OR
      * Accumulate Credit to Apply.
     C                     EXSR URSUBR                     Accumulate Cred
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Age Chargebacks and Rebills.
      *================================================================
     C                     ADD  WFBGVA    WN0126           Aging - CB    A
     C                     ADD  WFBGVA    WN0132           Aging - IN/DM/C
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Age Invoices and Debit Memos.
      *================================================================
     C                     ADD  WFBGVA    WN0138           Aging - IN/DM A
     C                     ADD  WFBGVA    WN0132           Aging - IN/DM/C
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Accumulate Credit to Apply.
      *================================================================
     C                     ADD  WFBGVA    WN0143           Aging - CM/OA A
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Past Due Period 2.
      *================================================================
      * CLC Aging Bucket       IF
      * CASE: PAR.Invoice Suffix is Charge Backs and Rebills
     C           WFCEST    IFEQ 'CB'                       *IF
     C           WFCEST    OREQ 'RB'
      * Age Chargebacks and Rebills.
     C                     EXSR UTSUBR                     Age Chargebacks
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Invoices
      *   |- c2    : PAR.Invoice Suffix is Debit Memos
      *   '-
     C           WFCEST    IFEQ 'IN'                       *IF
     C           WFCEST    OREQ 'DM'                       *OR
      * Age Invoices and Debit Memos.
     C                     EXSR UUSUBR                     Age Invoices an
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Credit Memos
      *   |- c2    : PAR.Invoice Suffix is On Account Cash
      *   '-
     C           WFCEST    IFEQ 'CM'                       *IF
     C           WFCEST    OREQ 'OA'                       *OR
      * Accumulate Credit to Apply.
     C                     EXSR UVSUBR                     Accumulate Cred
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Age Chargebacks and Rebills.
      *================================================================
     C                     ADD  WFBGVA    WN0127           Aging - CB    A
     C                     ADD  WFBGVA    WN0133           Aging - IN/DM/C
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Age Invoices and Debit Memos.
      *================================================================
     C                     ADD  WFBGVA    WN0139           Aging - IN/DM A
     C                     ADD  WFBGVA    WN0133           Aging - IN/DM/C
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Accumulate Credit to Apply.
      *================================================================
     C                     ADD  WFBGVA    WN0143           Aging - CM/OA A
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Past Due Period 3.
      *================================================================
      * CLC Aging Bucket       IF
      * CASE: PAR.Invoice Suffix is Charge Backs and Rebills
     C           WFCEST    IFEQ 'CB'                       *IF
     C           WFCEST    OREQ 'RB'
      * Age Chargebacks and Rebills.
     C                     EXSR UXSUBR                     Age Chargebacks
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Invoices
      *   |- c2    : PAR.Invoice Suffix is Debit Memos
      *   '-
     C           WFCEST    IFEQ 'IN'                       *IF
     C           WFCEST    OREQ 'DM'                       *OR
      * Age Invoices and Debit Memos.
     C                     EXSR UYSUBR                     Age Invoices an
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Invoice Suffix is Credit Memos
      *   |- c2    : PAR.Invoice Suffix is On Account Cash
      *   '-
     C           WFCEST    IFEQ 'CM'                       *IF
     C           WFCEST    OREQ 'OA'                       *OR
      * Accumulate Credit to Apply.
     C                     EXSR UZSUBR                     Accumulate Cred
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * Age Chargebacks and Rebills.
      *================================================================
     C                     ADD  WFBGVA    WN0128           Aging - CB    A
     C                     ADD  WFBGVA    WN0134           Aging - IN/DM/C
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * Age Invoices and Debit Memos.
      *================================================================
     C                     ADD  WFBGVA    WN0140           Aging - IN/DM A
     C                     ADD  WFBGVA    WN0134           Aging - IN/DM/C
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * Accumulate Credit to Apply.
      *================================================================
     C                     ADD  WFBGVA    WN0143           Aging - CM/OA A
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDAG1     BEGSR
      *================================================================
      * Prepare parameters to calculate Date Increment
      *================================================================
     C           XDURR     IFLT 0
      * Negative date increment
     C                     Z-ADD-1        XDWK2   60
     C                     ELSE
      * Positive date increment
     C                     Z-ADD1         XDWK2
     C                     ENDIF
     C                     MULT XDWK2     XDURR
      * Refresh the length of updated month (returned in XDWK1).
     C                     Z-ADDXDINDT    XDINT2
     C                     EXSR XDMNH
     C           XDINDD    IFEQ XDWK1
      * Save the start day
     C                     Z-ADD0         XDINDD
     C                     ENDIF
     C                     Z-ADD0         XDINT2
     C                     Z-ADD0         XDIMDT
     C                     MOVEL*BLANK    W0RTN   7
      *================================================================
     CSR         XDAG1E    ENDSR
      /EJECT
     CSR         XDAG2     BEGSR
      *================================================================
      * General calculations driven by Increment Mask
      *================================================================
      * Extract days
     C           XDIMDD    IFEQ 1
     C                     DIV  100       XDURR   80
     C                     MVR            XDIND2
     C                     ENDIF
      * Extract months
     C           XDIMMM    IFEQ 1
     C                     DIV  100       XDURR   80
     C                     MVR            XDINM2
     C                     ENDIF
      * Extract years
     C           XDIMYY    IFEQ 1
     C                     DIV  1000      XDURR   80
     C                     MVR            XDINY2
     C                     ENDIF
     C           XDURR     IFNE 0
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      * Normalize month increment
     C           XDINM2    DIV  12        XDURR   80
     C                     MVR            XDINM2
     C                     ADD  XDURR     XDINY2
      * Apply year increment
     C                     MULT XDWK2     XDINY2
     C                     ADD  XDINYY    XDINY2
      * Apply month increment
     C                     MULT XDWK2     XDINM2
     C                     ADD  XDINMM    XDINM2
      * Normalize updated month
     C                     EXSR XDNZM
     C           XDINDD    IFGT XDWK1
     C           XDINDD    OREQ 0
      * Restore the start day
     C                     Z-ADDXDWK1     XDINDD
     C                     ENDIF
      * Apply day increment
     C                     MULT XDWK2     XDIND2
     C           XDINDD    ADD  XDIND2    XDURR
     C                     Z-ADD0         XDIND2
      * Normalize day increment
     C           XDIND2    DOWLE0
     C           XDURR     IFEQ 0
     C                     ADD  XDWK2     XDINM2
      * Normalize updated month
     C                     EXSR XDNZM
     C                     Z-ADDXDWK1     XDURR
     C                     ENDIF
     C           XDURR     IFLT 0
     C                     SUB  1         XDINM2
      * Normalize updated month
     C                     EXSR XDNZM
     C                     ADD  XDWK1     XDURR
     C                     ELSE
     C           XDURR     IFGT XDWK1
     C                     SUB  XDWK1     XDURR
     C                     ADD  1         XDINM2
      * Normalize updated month
     C                     EXSR XDNZM
     C                     ELSE
     C                     Z-ADDXDURR     XDIND2
     C                     ENDIF
     C                     ENDIF
     C                     ENDDO
      * Check updated year
     C           XDINY2    IFGE 400
     C           XDINY2    ORLE 0
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
     C           W0RTN     IFEQ 'Y2U0006'
     C                     Z-ADD0         XDINDT
     C                     ELSE
     C                     Z-ADDXDINT2    XDINDT
     C                     ENDIF
      *================================================================
     CSR         XDAG2E    ENDSR
      /EJECT
     CSR         XDAYR     BEGSR
      *================================================================
      * Calculate duration, *YEARS
      *================================================================
      * Check and adjust End Of Month dates, if any.
     C                     EXSR XDAG1
      * Define increment Mask.
     C                     Z-ADD1         XDIMYY
      * Initiate general DATE INCREMENT calculations.
     C                     EXSR XDAG2
      *================================================================
     CSR         XDAYRE    ENDSR
      /EJECT
     CSR         XDMNH     BEGSR
      *================================================================
      * Find length(XDWK1) in days for the month passed in XDIN2TS
      *================================================================
     C           XDINM2    IFEQ 4
     C           XDINM2    OREQ 6
     C           XDINM2    OREQ 9
     C           XDINM2    OREQ 11
     C                     Z-ADD30        XDWK1   80
     C                     ELSE
     C                     Z-ADD31        XDWK1
     C                     END
     C           XDINM2    IFEQ 2
      * Determine February length
     C           XDINY2    IFEQ 300
     C           XDINY2    OREQ 100
     C                     Z-ADD28        XDWK1
     C                     ELSE
     C           XDINY2    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     Z-ADD29        XDWK1
     C                     ELSE
     C                     Z-ADD28        XDWK1
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         XDMNHE    ENDSR
      /EJECT
     CSR         XDNZM     BEGSR
      *================================================================
      * Normalize days
      *================================================================
     C           XDINM2    IFLT 1
     C                     ADD  12        XDINM2
     C                     SUB  1         XDINY2
     C                     ENDIF
     C           XDINM2    IFGT 12
     C                     SUB  12        XDINM2
     C                     ADD  1         XDINY2
     C                     ENDIF
      * Refresh the length of updated month (returned in XDWK1).
     C                     EXSR XDMNH
      *================================================================
     CSR         XDNZME    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1ACVA           Age_Due_Aging 1
     C                     Z-ADD*ZERO     P1ADVA           Age_Due_Aging 2
     C                     Z-ADD*ZERO     P1AEVA           Age_Due_Aging 3
     C                     Z-ADD*ZERO     P1AFVA           Age_Due_Aging 4
     C                     Z-ADD*ZERO     P1AGVA           Age_Due_Current
     C                     Z-ADD*ZERO     P1AHVA           Age_Due_Aging 5
     C                     Z-ADD*ZERO     P1ALVA           Amount of Highe
     C                     Z-ADD*ZERO     P1AMVA           Amount of Last
     C                     Z-ADD*ZERO     P1AIDT           Date of Highest
     C                     Z-ADD*ZERO     P1ALDT           Date of Last Pa
     C                     Z-ADD*ZERO     P1VIVA           Age_Due_Current
     C                     Z-ADD*ZERO     P1VJVA           Age_Due_Aging 1
     C                     Z-ADD*ZERO     P1VKVA           Age_Due_Aging 2
     C                     Z-ADD*ZERO     P1VLVA           Age_Due_Aging 3
     C                     Z-ADD*ZERO     P1VMVA           Age_Due_Aging 4
     C                     Z-ADD*ZERO     P1VNVA           Age_Due_Aging 5
     C                     Z-ADD*ZERO     P1ADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     P1VOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     P1BTDY           MTD Days Paid
     C                     Z-ADD*ZERO     P1BUDY           YTD Days Paid
     C                     Z-ADD*ZERO     P1H4DT           Paid in Full Da
     C                     Z-ADD*ZERO     P1BSDY           Days to Pay
     C                     Z-ADD*ZERO     P1WBVA           USR Tot. Due W/
     C                     Z-ADD*ZERO     P1NBPY           USR Number of P
     C                     Z-ADD*ZERO     P1V7VA           USR Total Due
     C                     Z-ADD*ZERO     P1CUMO           Current Month
     C                     Z-ADD*ZERO     P1VSVA           USR Total Order
     C                     Z-ADD*ZERO     P1Y4NB           A_R Balance Mon
     C                     Z-ADD*ZERO     P1A1NB           A_R Balance Yea
     C                     Z-ADD*ZERO     P1JYY            *Job year
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2EEVA           Value of Open O
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Days to Pay
     C                     Z-ADD*ZERO     WUBSDY  50
      * Define work field MTD Invoices Paid
     C                     Z-ADD*ZERO     WUADPM  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A_R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Unused Parm - Text    USR
     C                     MOVEL*BLANK    WUOSTX 25
      * Define work field Unused Parm - Status  USR
     C                     MOVEL*BLANK    WUZNST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WFAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WFAOVA           Amount Paid
     C                     Z-ADD*ZERO     WFBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WFCKNB           GL Document Num
     C                     Z-ADD*ZERO     WFCAC7           Order Number Re
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WFATDT           Due Date
     C                     Z-ADD*ZERO     WFH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WFH3DT           Original Inv fo
     C                     Z-ADD*ZERO     WFH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WFH5DT           Last G_L Post D
     C                     Z-ADD*ZERO     WFANC7           AR Customer Num
     C                     Z-ADD*ZERO     WFBSDY           Days to Pay
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field A_R Aging Code
     C                     MOVEL*BLANK    WUG8AA  6
      * Define work field Age by Trans or Due Date
     C                     MOVEL*BLANK    WUEUST  1
      * Define work field Default Y_N
     C                     MOVEL*BLANK    WUA1TX  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field SSI Download Flag
     C                     MOVEL*BLANK    WUUNUS  1
      * Define work field unused status 2
     C                     MOVEL*BLANK    WUUNU2  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHANC7           AR Customer Num
     C                     Z-ADD*ZERO     WHA1NB           A_R Balance Yea
     C                     Z-ADD*ZERO     WHY4NB           A_R Balance Mon
     C                     Z-ADD*ZERO     WHALVA           Amount of Highe
     C                     Z-ADD*ZERO     WHAIDT           Date of Highest
     C                     Z-ADD*ZERO     WHY5VA           Beginning Balan
     C                     Z-ADD*ZERO     WHZAVA           A_R Balance Val
     C                     Z-ADD*ZERO     WHY7VA           A_R Balance Val
     C                     Z-ADD*ZERO     WHY8VA           A_R Balance Val
     C                     Z-ADD*ZERO     WHY9VA           A_R Balance Val
     C                     Z-ADD*ZERO     WHRTNX           Bal Nbr of Orde
     C                     Z-ADD*ZERO     WHRUNX           Bal Nbr of Cred
     C                     Z-ADD*ZERO     WHRVNX           Bal Nbr of Paym
     C                     Z-ADD*ZERO     WHRWNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WHRXNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WHB4DY           Bal Avg Days to
     C                     Z-ADD*ZERO     WHBSDY           Days to Pay
     C                     Z-ADD*ZERO     WHK2DT           Override Total
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKCONB           Invoice Number
     C                     Z-ADD*ZERO     WKDXNB           Sequence Number
     C                     Z-ADD*ZERO     WKBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WKB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WKDVDT           Payment_Deposit
     C                     Z-ADD*ZERO     WKYXNX           Deposit Time
     C                     Z-ADD*ZERO     WKHYDT           G_L Post Date
     C                     Z-ADD*ZERO     WKCKNB           GL Document Num
     C                     Z-ADD*ZERO     WKC1NY           G_L Posting Com
     C                     Z-ADD*ZERO     WKQHDT           TFS Adj Week_En
     C                     Z-ADD*ZERO     WKQIDT           A_R Orig Inv fo
     C                     Z-ADD*ZERO     WKQJDT           A_R Invoice Num
     C                     Z-ADD*ZERO     WKQKDT           A_R Dtl UnUsed
     C                     Z-ADD*ZERO     WKQLDT           A_R Dtl UnUsed
     C                     Z-ADD*ZERO     WKGLVL           G_L Sub_Ledger
     C                     Z-ADD*ZERO     WKGMVL           A_R Dtl UnUsed
     C                     Z-ADD*ZERO     WKGNVL           A_R Dtl UnUsed
     C                     Z-ADD*ZERO     WKGOVL           A_R Dtl UnUsed
     C                     Z-ADD*ZERO     WKGPVL           A_R Dtl UnUsed
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Days to Pay 1 USR
     C                     Z-ADD*ZERO     WURYNX  50
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Bal Nbr of Invoices Paid
     C                     Z-ADD*ZERO     WURXNX  50
      * Define work field Bal Avg Days to Pay
     C                     Z-ADD*ZERO     WUB4DY  50
      * Define work field Text 1 Length USR
     C                     MOVEL*BLANK    WUPFTX  1
      * Define work field Day   (Char) USR
     C                     MOVEL*BLANK    WUT6TX  2
      * Define work field Year  NBR USR
     C                     Z-ADD*ZERO     WUI8NX  20
      * Define work field Bal Nbr of Payments
     C                     Z-ADD*ZERO     WURVNX  50
      * Define work field Month                 USR
     C                     Z-ADD*ZERO     WUXX45  20
      * Define work field USR Job Year
     C                     Z-ADD*ZERO     WUJBYR  20
      * Define work field Year Alpha (YY) USR
     C                     MOVEL*BLANK    WUUATX  2
      * Define work field Month USR
     C                     MOVEL*BLANK    WUMONT  2
      * Define work field Day 1 3A
     C                     MOVEL*BLANK    WUVETX  3
      * Define work field Text USR 5
     C                     MOVEL*BLANK    WUY7TX  5
      * Define work field Date (Alpha) USR
     C                     MOVEL*BLANK    WUR4TX  7
      * Define work field Bal Nbr of Invoices
     C                     Z-ADD*ZERO     WURWNX  50
      * Define work field Bal Nbr of Credits
     C                     Z-ADD*ZERO     WURUNX  50
      * Define work field Year Code
     C                     Z-ADD*ZERO     WUAYNX  40
      * Define work field Bal Nbr of Orders
     C                     Z-ADD*ZERO     WURTNX  50
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTANC7           AR Customer Num
     C                     Z-ADD*ZERO     WTAGVA           Age_Due_Current
     C                     Z-ADD*ZERO     WTACVA           Age_Due_Aging 1
     C                     Z-ADD*ZERO     WTADVA           Age_Due_Aging 2
     C                     Z-ADD*ZERO     WTAEVA           Age_Due_Aging 3
     C                     Z-ADD*ZERO     WTAFVA           Age_Due_Aging 4
     C                     Z-ADD*ZERO     WTAHVA           Age_Due_Aging 5
     C                     Z-ADD*ZERO     WTVIVA           Age_Due_Current
     C                     Z-ADD*ZERO     WTVJVA           Age_Due_Aging 1
     C                     Z-ADD*ZERO     WTVKVA           Age_Due_Aging 2
     C                     Z-ADD*ZERO     WTVLVA           Age_Due_Aging 3
     C                     Z-ADD*ZERO     WTVMVA           Age_Due_Aging 4
     C                     Z-ADD*ZERO     WTVNVA           Age_Due_Aging 5
     C                     Z-ADD*ZERO     WTEEVA           Value of Open O
     C                     Z-ADD*ZERO     WTAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WTAHDT           Date of First S
     C                     Z-ADD*ZERO     WTANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WTANVA           Amount of Last
     C                     Z-ADD*ZERO     WTALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WTAMVA           Amount of Last
     C                     Z-ADD*ZERO     WTAIDT           Date of Highest
     C                     Z-ADD*ZERO     WTALVA           Amount of Highe
     C                     Z-ADD*ZERO     WTDJNB           Number of Invoi
     C                     Z-ADD*ZERO     WTDLNB           Number of Order
     C                     Z-ADD*ZERO     WTDDNB           Number of Credi
     C                     Z-ADD*ZERO     WTDMNB           Number of Payme
     C                     Z-ADD*ZERO     WTDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WTLYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTLYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTLYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WTVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WTBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WTBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WTVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WTVQVA           Last Year Sales
     C                     Z-ADD*ZERO     WTCUMO           Current Month
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD04 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  30
      * Define local variables for subroutine SECHRC.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008 112
      * Define local variables for subroutine SICRRC.
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  40
     C                     Z-ADD*ZERO     WL0012  20
     C                     Z-ADD*ZERO     WL0013 112
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019 112
     C                     Z-ADD*ZERO     WL0020  50
     C                     Z-ADD*ZERO     WL0021  50
     C                     Z-ADD*ZERO     WL0022  50
     C                     Z-ADD*ZERO     WL0023  50
     C                     Z-ADD*ZERO     WL0024  50
     C                     Z-ADD*ZERO     WL0025  50
     C                     Z-ADD*ZERO     WL0026  50
     C                     Z-ADD*ZERO     WL0027  70
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0034  30
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  70
     C                     Z-ADD*ZERO     WL0037  50
     C                     Z-ADD*ZERO     WL0038  20
     C                     Z-ADD*ZERO     WL0039  20
     C                     Z-ADD*ZERO     WL0040  50
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0001  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0002  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0005  30
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0003  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0007  30
      *================================================================
     CSR         ZZEXIT    ENDSR
