     H/TITLE Prc Cmp/Frt/Da's/Net  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:48:33
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKARREL4IF  E           K        DISK
      * RSQ : Carcass Merit Program     CMP Competitors only
      *
     FPKA1CPNKIF  E           K        DISK
      * RSQ : Tattoo Header             Co/BOL/Tto/Pd/KD UnPy Hl
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPKB1CPLHIF  E           K        DISK
      * RTV : Carcass Detail            Active Carcasses Only
      *
     FPKARREL0IF  E           K        DISK
      * RTV : Carcass Merit Program     Retrieval index
      *
     FPLBPCPL2IF  E           K        DISK
      * RSQ : Carcass Merit Prog MktGrp CMP/Mkt/Group/PurchDteDe
      *
     FPKBYREL2IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Row  Cmp/MinCrc(d)
      *
     FPKBZREL2IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Lean%
      *
     FPKBZREL3IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Lean%(a)
      *
     FPKBYREL1IF  E           K        DISK
      * RTV : Carcass Merit Matrix Row  Retrieval index
      *
     FPKBZREL6IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/RoW/Bckft(d)
      *
     FPKBZREL5IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Bckft(a)
      *
     FPKA1CPN3IF  E           K        DISK
      * RSQ : Tattoo Header            Co/Bol/Ttt/Pd/kd slunp/lv
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKB1CPL0UF  E           K        DISK
      * UPD : Carcass Detail            Update index
      *
     FPKB1CPLDIF  E           K        DISK                      A
      * UPD : Carcass Detail            Update index Purge
      *
     I@ARRETN
      * Carcass Merit Program     CMP Competitors only
      * Renamed input format fields
     I              ARAMCD                          WAAMCD
     I              ARA3TX                          WAA3TX
     I              ARDLST                          WADLST
     I              ARDMST                          WADMST
     I              ARDOST                          WADOST
     I              ARDQST                          WADQST
     I              ARAZPC                          WAAZPC
     I              ARA0PC                          WAA0PC
     I              ARDTST                          WADTST
     I              ARF5ST                          WAF5ST
     I              ARI1PR                          WAI1PR
     I              ARVEPR                          WAVEPR
     I              ARVFPR                          WAVFPR
     I              ARVHPR                          WAVHPR
     I              ARVIPR                          WAVIPR
     I              ARVJPR                          WAVJPR
     I              ARZ2ST                          WAZ2ST
     I              ARZ3ST                          WAZ3ST
     I              ARZ4ST                          WAZ4ST
     I              ARAAVN                          WAAAVN
     I              ARAADT                          WAAADT
     I              ARAMTM                          WAAMTM
     I              ARAJST                          WAAJST
     I              ARAHVN                          WAAHVN
     I              ARAGVN                          WAAGVN
     I              ARABVN                          WAABVN
     I              ARABDT                          WAABDT
     I              ARABTM                          WAABTM
      *
     I@A1CPG3
      * Tattoo Header             Co/BOL/Tto/Pd/KD UnPy Hl
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@AWCPBI
      * Buy Order Header          Retrieval index
      * Renamed input format fields
     I              AWHMNB                          WEHMNB
     I              AWBNNB                          WEBNNB
     I              AWARDT                          WEARDT
     I              AWASDT                          WEASDT
     I              AWA4ST                          WEA4ST
     I              AWA5ST                          WEA5ST
     I              AWAAPR                          WEAAPR
     I              AWA6ST                          WEA6ST
     I              AWA7ST                          WEA7ST
     I              AWB3ST                          WEB3ST
     I              AWALPR                          WEALPR
     I              AWETCD                          WEETCD
     I              AWEUCD                          WEEUCD
     I              AWJ5TX                          WEJ5TX
     I              AWD5DT                          WED5DT
     I              AWD6DT                          WED6DT
     I              AWD7DT                          WED7DT
     I              AWD8DT                          WED8DT
     I              AWD9DT                          WED9DT
     I              AWJOEJ                          WEJOEJ
     I              AWKOFF                          WEKOFF
     I              AWKWPE                          WEKWPE
     I              AWIMBF                          WEIMBF
     I              AWOPTR                          WEOPTR
     I              AWOEJD                          WEOEJD
     I              AWIRMF                          WEIRMF
     I              AWJIRM                          WEJIRM
     I              AWJRKF                          WEJRKF
     I              AWKFIR                          WEKFIR
     I              AWUZST                          WEUZST
     I              AWU0ST                          WEU0ST
     I              AWU1ST                          WEU1ST
     I              AWU2ST                          WEU2ST
     I              AWU3ST                          WEU3ST
     I              AWHXNB                          WEHXNB
     I              AWGANB                          WEGANB
     I              AWGBNB                          WEGBNB
     I              AWABCD                          WEABCD
     I              AWAECD                          WEAECD
     I              AWAKCD                          WEAKCD
     I              AWALCD                          WEALCD
     I              AWAGCD                          WEAGCD
     I              AWAICD                          WEAICD
     I              AWAMCD                          WEAMCD
     I              AWACCD                          WEACCD
     I              AWAAVN                          WEAAVN
     I              AWAADT                          WEAADT
     I              AWAMTM                          WEAMTM
     I              AWAJST                          WEAJST
     I              AWAHVN                          WEAHVN
     I              AWAGVN                          WEAGVN
     I              AWABVN                          WEABVN
     I              AWABDT                          WEABDT
     I              AWABTM                          WEABTM
      *
     I@AQCPA0
      * Producer Sub-Contract     Retrieval index
      * Renamed input format fields
     I              AQAKCD                          WFAKCD
     I              AQALCD                          WFALCD
     I              AQAHDT                          WFAHDT
     I              AQA2ST                          WFA2ST
     I              AQAZPR                          WFAZPR
     I              AQA0PR                          WFA0PR
     I              AQA9PC                          WFA9PC
     I              AQA7PR                          WFA7PR
     I              AQA8PR                          WFA8PR
     I              AQF3ST                          WFF3ST
     I              AQA9PR                          WFA9PR
     I              AQERCD                          WFERCD
     I              AQESCD                          WFESCD
     I              AQF6PR                          WFF6PR
     I              AQJ3TX                          WFJ3TX
     I              AQABCD                          WFABCD
     I              AQAECD                          WFAECD
     I              AQAGCD                          WFAGCD
     I              AQAICD                          WFAICD
     I              AQAMCD                          WFAMCD
     I              AQAAVN                          WFAAVN
     I              AQAADT                          WFAADT
     I              AQAMTM                          WFAMTM
     I              AQAJST                          WFAJST
     I              AQAHVN                          WFAHVN
     I              AQAGVN                          WFAGVN
     I              AQABVN                          WFABVN
     I              AQABDT                          WFABDT
     I              AQABTM                          WFABTM
      *
     I@B1CPEF
      * Carcass Detail            Active Carcasses Only
      * Renamed input format fields
     I              B1HMNB                          WGHMNB
     I              B1BNNB                          WGBNNB
     I              B1BONB                          WGBONB
     I              B1CVNB                          WGCVNB
     I              B1B0DT                          WGB0DT
     I              B1LGNB                          WGLGNB
     I              B1EUNB                          WGEUNB
     I              B1LHNB                          WGLHNB
     I              B1INST                          WGINST
     I              B1BEPR                          WGBEPR
     I              B1ASPC                          WGASPC
     I              B1EWNB                          WGEWNB
     I              B1B4PR                          WGB4PR
     I              B1EYNB                          WGEYNB
     I              B1B1PR                          WGB1PR
     I              B1AVPR                          WGAVPR
     I              B1AUPC                          WGAUPC
     I              B1AWPR                          WGAWPR
     I              B1AXPR                          WGAXPR
     I              B1EZNB                          WGEZNB
     I              B1AYPR                          WGAYPR
     I              B1BBDT                          WGBBDT
     I              B1AKTM                          WGAKTM
     I              B1IQST                          WGIQST
     I              B1EFST                          WGEFST
     I              B1H6NB                          WGH6NB
     I              B1BEPC                          WGBEPC
     I              B1GCST                          WGGCST
     I              B1GDST                          WGGDST
     I              B1GEST                          WGGEST
     I              B1BHPC                          WGBHPC
     I              B1IOST                          WGIOST
     I              B1IPST                          WGIPST
     I              B1LTNB                          WGLTNB
     I              B1JNST                          WGJNST
     I              B1X4NB                          WGX4NB
     I              B1FNPC                          WGFNPC
     I              B1FOPC                          WGFOPC
     I              B1FPPC                          WGFPPC
     I              B1K2ST                          WGK2ST
     I              B1K3ST                          WGK3ST
     I              B1JWPR                          WGJWPR
     I              B1F5PC                          WGF5PC
     I              B1JXPR                          WGJXPR
     I              B1JYPR                          WGJYPR
     I              B1JZPR                          WGJZPR
     I              B1J0PR                          WGJ0PR
     I              B1J1PR                          WGJ1PR
     I              B1J2PR                          WGJ2PR
     I              B1J3PR                          WGJ3PR
     I              B1J4PR                          WGJ4PR
     I              B1UTST                          WGUTST
     I              B1HVCD                          WGHVCD
     I              B1DKJR                          WGDKJR
     I              B1ITJF                          WGITJF
     I              B1IJGR                          WGIJGR
     I              B1ORJE                          WGORJE
     I              B1OTJR                          WGOTJR
     I              B1PEIR                          WGPEIR
     I              B1IEUF                          WGIEUF
     I              B1ORUE                          WGORUE
     I              B1IUTR                          WGIUTR
     I              B1IJRR                          WGIJRR
     I              B1VCST                          WGVCST
     I              B1VDST                          WGVDST
     I              B1VEST                          WGVEST
     I              B1VFST                          WGVFST
     I              B1VGST                          WGVGST
     I              B1ABCD                          WGABCD
     I              B1AACD                          WGAACD
     I              B1AAVN                          WGAAVN
     I              B1AADT                          WGAADT
     I              B1AMTM                          WGAMTM
     I              B1AJST                          WGAJST
     I              B1AHVN                          WGAHVN
     I              B1AGVN                          WGAGVN
     I              B1ABVN                          WGABVN
     I              B1ABDT                          WGABDT
     I              B1ABTM                          WGABTM
      *
     I@ARREBF
      * Carcass Merit Program     Retrieval index
      * Renamed input format fields
     I              ARAMCD                          WHAMCD
     I              ARA3TX                          WHA3TX
     I              ARDLST                          WHDLST
     I              ARDMST                          WHDMST
     I              ARDOST                          WHDOST
     I              ARDQST                          WHDQST
     I              ARAZPC                          WHAZPC
     I              ARA0PC                          WHA0PC
     I              ARDTST                          WHDTST
     I              ARF5ST                          WHF5ST
     I              ARI1PR                          WHI1PR
     I              ARVEPR                          WHVEPR
     I              ARVFPR                          WHVFPR
     I              ARVHPR                          WHVHPR
     I              ARVIPR                          WHVIPR
     I              ARVJPR                          WHVJPR
     I              ARZ2ST                          WHZ2ST
     I              ARZ3ST                          WHZ3ST
     I              ARZ4ST                          WHZ4ST
     I              ARAAVN                          WHAAVN
     I              ARAADT                          WHAADT
     I              ARAMTM                          WHAMTM
     I              ARAJST                          WHAJST
     I              ARAHVN                          WHAHVN
     I              ARAGVN                          WHAGVN
     I              ARABVN                          WHABVN
     I              ARABDT                          WHABDT
     I              ARABTM                          WHABTM
      *
     I@BPCPSK
      * Carcass Merit Prog MktGrp CMP/Mkt/Group/PurchDteDe
      * Renamed input format fields
     I              BPAMCD                          WIAMCD
     I              BPGYDT                          WIGYDT
     I              BPPXCD                          WIPXCD
     I              BPPYCD                          WIPYCD
     I              BPAAVN                          WIAAVN
     I              BPAADT                          WIAADT
     I              BPAMTM                          WIAMTM
     I              BPAJST                          WIAJST
     I              BPAHVN                          WIAHVN
     I              BPAGVN                          WIAGVN
     I              BPABVN                          WIABVN
     I              BPABDT                          WIABDT
     I              BPABTM                          WIABTM
      *
     I@BYREJ9
      * Carcass Merit Matrix Row  Cmp/MinCrc(d)
      * Renamed input format fields
     I              BYAMCD                          WJAMCD
     I              BYE8NB                          WJE8NB
     I              BYEGNB                          WJEGNB
     I              BYEHNB                          WJEHNB
     I              BYEINB                          WJEINB
     I              BYEJNB                          WJEJNB
     I              BYEKNB                          WJEKNB
     I              BYAQPC                          WJAQPC
     I              BYEMNB                          WJEMNB
     I              BYE2NB                          WJE2NB
     I              BYLJA1                          WJLJA1
     I              BYAAVN                          WJAAVN
     I              BYAADT                          WJAADT
     I              BYAMTM                          WJAMTM
     I              BYAJST                          WJAJST
     I              BYAHVN                          WJAHVN
     I              BYAGVN                          WJAGVN
     I              BYABVN                          WJABVN
     I              BYABDT                          WJABDT
     I              BYABTM                          WJABTM
      *
     I@BZREKA
      * Carcass Merit Matrix Col  Cmp/Row/Lean%
      * Renamed input format fields
     I              BZAMCD                          WKAMCD
     I              BZE8NB                          WKE8NB
     I              BZE4NB                          WKE4NB
     I              BZA1PC                          WKA1PC
     I              BZE7NB                          WKE7NB
     I              BZCHCD                          WKCHCD
     I              BZERNB                          WKERNB
     I              BZAAVN                          WKAAVN
     I              BZAADT                          WKAADT
     I              BZAMTM                          WKAMTM
     I              BZAJST                          WKAJST
     I              BZAHVN                          WKAHVN
     I              BZAGVN                          WKAGVN
     I              BZABVN                          WKABVN
     I              BZABDT                          WKABDT
     I              BZABTM                          WKABTM
      *
     I@BZREPO
      * Carcass Merit Matrix Col  Cmp/Row/Lean%(a)
      * Renamed input format fields
     I              BZAMCD                          WLAMCD
     I              BZE8NB                          WLE8NB
     I              BZE4NB                          WLE4NB
     I              BZA1PC                          WLA1PC
     I              BZE7NB                          WLE7NB
     I              BZCHCD                          WLCHCD
     I              BZERNB                          WLERNB
     I              BZAAVN                          WLAAVN
     I              BZAADT                          WLAADT
     I              BZAMTM                          WLAMTM
     I              BZAJST                          WLAJST
     I              BZAHVN                          WLAHVN
     I              BZAGVN                          WLAGVN
     I              BZABVN                          WLABVN
     I              BZABDT                          WLABDT
     I              BZABTM                          WLABTM
      *
     I@BYREGF
      * Carcass Merit Matrix Row  Retrieval index
      * Renamed input format fields
     I              BYAMCD                          WMAMCD
     I              BYE8NB                          WME8NB
     I              BYEGNB                          WMEGNB
     I              BYEHNB                          WMEHNB
     I              BYEINB                          WMEINB
     I              BYEJNB                          WMEJNB
     I              BYEKNB                          WMEKNB
     I              BYAQPC                          WMAQPC
     I              BYEMNB                          WMEMNB
     I              BYE2NB                          WME2NB
     I              BYLJA1                          WMLJA1
     I              BYAAVN                          WMAAVN
     I              BYAADT                          WMAADT
     I              BYAMTM                          WMAMTM
     I              BYAJST                          WMAJST
     I              BYAHVN                          WMAHVN
     I              BYAGVN                          WMAGVN
     I              BYABVN                          WMABVN
     I              BYABDT                          WMABDT
     I              BYABTM                          WMABTM
      *
     I@BZRETM
      * Carcass Merit Matrix Col  Cmp/RoW/Bckft(d)
      * Renamed input format fields
     I              BZAMCD                          WOAMCD
     I              BZE8NB                          WOE8NB
     I              BZE4NB                          WOE4NB
     I              BZA1PC                          WOA1PC
     I              BZE7NB                          WOE7NB
     I              BZCHCD                          WOCHCD
     I              BZERNB                          WOERNB
     I              BZAAVN                          WOAAVN
     I              BZAADT                          WOAADT
     I              BZAMTM                          WOAMTM
     I              BZAJST                          WOAJST
     I              BZAHVN                          WOAHVN
     I              BZAGVN                          WOAGVN
     I              BZABVN                          WOABVN
     I              BZABDT                          WOABDT
     I              BZABTM                          WOABTM
      *
     I@BZRETL
      * Carcass Merit Matrix Col  Cmp/Row/Bckft(a)
      * Renamed input format fields
     I              BZAMCD                          WRAMCD
     I              BZE8NB                          WRE8NB
     I              BZE4NB                          WRE4NB
     I              BZA1PC                          WRA1PC
     I              BZE7NB                          WRE7NB
     I              BZCHCD                          WRCHCD
     I              BZERNB                          WRERNB
     I              BZAAVN                          WRAAVN
     I              BZAADT                          WRAADT
     I              BZAMTM                          WRAMTM
     I              BZAJST                          WRAJST
     I              BZAHVN                          WRAHVN
     I              BZAGVN                          WRAGVN
     I              BZABVN                          WRABVN
     I              BZABDT                          WRABDT
     I              BZABTM                          WRABTM
      *
     I@B1CPG6
      * Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WSHMNB
     I              B1BNNB                          WSBNNB
     I              B1BONB                          WSBONB
     I              B1CVNB                          WSCVNB
     I              B1B0DT                          WSB0DT
     I              B1LGNB                          WSLGNB
     I              B1EUNB                          WSEUNB
     I              B1LHNB                          WSLHNB
     I              B1INST                          WSINST
     I              B1BEPR                          WSBEPR
     I              B1ASPC                          WSASPC
     I              B1EWNB                          WSEWNB
     I              B1B4PR                          WSB4PR
     I              B1EYNB                          WSEYNB
     I              B1B1PR                          WSB1PR
     I              B1AVPR                          WSAVPR
     I              B1AUPC                          WSAUPC
     I              B1AWPR                          WSAWPR
     I              B1AXPR                          WSAXPR
     I              B1EZNB                          WSEZNB
     I              B1AYPR                          WSAYPR
     I              B1BBDT                          WSBBDT
     I              B1AKTM                          WSAKTM
     I              B1IQST                          WSIQST
     I              B1EFST                          WSEFST
     I              B1H6NB                          WSH6NB
     I              B1BEPC                          WSBEPC
     I              B1GCST                          WSGCST
     I              B1GDST                          WSGDST
     I              B1GEST                          WSGEST
     I              B1BHPC                          WSBHPC
     I              B1IOST                          WSIOST
     I              B1IPST                          WSIPST
     I              B1LTNB                          WSLTNB
     I              B1JNST                          WSJNST
     I              B1X4NB                          WSX4NB
     I              B1FNPC                          WSFNPC
     I              B1FOPC                          WSFOPC
     I              B1FPPC                          WSFPPC
     I              B1K2ST                          WSK2ST
     I              B1K3ST                          WSK3ST
     I              B1JWPR                          WSJWPR
     I              B1F5PC                          WSF5PC
     I              B1JXPR                          WSJXPR
     I              B1JYPR                          WSJYPR
     I              B1JZPR                          WSJZPR
     I              B1J0PR                          WSJ0PR
     I              B1J1PR                          WSJ1PR
     I              B1J2PR                          WSJ2PR
     I              B1J3PR                          WSJ3PR
     I              B1J4PR                          WSJ4PR
     I              B1UTST                          WSUTST
     I              B1HVCD                          WSHVCD
     I              B1DKJR                          WSDKJR
     I              B1ITJF                          WSITJF
     I              B1IJGR                          WSIJGR
     I              B1ORJE                          WSORJE
     I              B1OTJR                          WSOTJR
     I              B1PEIR                          WSPEIR
     I              B1IEUF                          WSIEUF
     I              B1ORUE                          WSORUE
     I              B1IUTR                          WSIUTR
     I              B1IJRR                          WSIJRR
     I              B1VCST                          WSVCST
     I              B1VDST                          WSVDST
     I              B1VEST                          WSVEST
     I              B1VFST                          WSVFST
     I              B1VGST                          WSVGST
     I              B1ABCD                          WSABCD
     I              B1AACD                          WSAACD
     I              B1AAVN                          WSAAVN
     I              B1AADT                          WSAADT
     I              B1AMTM                          WSAMTM
     I              B1AJST                          WSAJST
     I              B1AHVN                          WSAHVN
     I              B1AGVN                          WSAGVN
     I              B1ABVN                          WSABVN
     I              B1ABDT                          WSABDT
     I              B1ABTM                          WSABTM
      *
     I@B1CPVI
      * Carcass Detail            Update index Purge
      * Renamed input format fields
     I              B1HMNB                          WTHMNB
     I              B1BNNB                          WTBNNB
     I              B1BONB                          WTBONB
     I              B1CVNB                          WTCVNB
     I              B1B0DT                          WTB0DT
     I              B1LGNB                          WTLGNB
     I              B1EUNB                          WTEUNB
     I              B1LHNB                          WTLHNB
     I              B1INST                          WTINST
     I              B1BEPR                          WTBEPR
     I              B1ASPC                          WTASPC
     I              B1EWNB                          WTEWNB
     I              B1B4PR                          WTB4PR
     I              B1EYNB                          WTEYNB
     I              B1B1PR                          WTB1PR
     I              B1AVPR                          WTAVPR
     I              B1AUPC                          WTAUPC
     I              B1AWPR                          WTAWPR
     I              B1AXPR                          WTAXPR
     I              B1EZNB                          WTEZNB
     I              B1AYPR                          WTAYPR
     I              B1BBDT                          WTBBDT
     I              B1AKTM                          WTAKTM
     I              B1IQST                          WTIQST
     I              B1EFST                          WTEFST
     I              B1H6NB                          WTH6NB
     I              B1BEPC                          WTBEPC
     I              B1GCST                          WTGCST
     I              B1GDST                          WTGDST
     I              B1GEST                          WTGEST
     I              B1BHPC                          WTBHPC
     I              B1IOST                          WTIOST
     I              B1IPST                          WTIPST
     I              B1LTNB                          WTLTNB
     I              B1JNST                          WTJNST
     I              B1X4NB                          WTX4NB
     I              B1FNPC                          WTFNPC
     I              B1FOPC                          WTFOPC
     I              B1FPPC                          WTFPPC
     I              B1K2ST                          WTK2ST
     I              B1K3ST                          WTK3ST
     I              B1JWPR                          WTJWPR
     I              B1F5PC                          WTF5PC
     I              B1JXPR                          WTJXPR
     I              B1JYPR                          WTJYPR
     I              B1JZPR                          WTJZPR
     I              B1J0PR                          WTJ0PR
     I              B1J1PR                          WTJ1PR
     I              B1J2PR                          WTJ2PR
     I              B1J3PR                          WTJ3PR
     I              B1J4PR                          WTJ4PR
     I              B1UTST                          WTUTST
     I              B1HVCD                          WTHVCD
     I              B1DKJR                          WTDKJR
     I              B1ITJF                          WTITJF
     I              B1IJGR                          WTIJGR
     I              B1ORJE                          WTORJE
     I              B1OTJR                          WTOTJR
     I              B1PEIR                          WTPEIR
     I              B1IEUF                          WTIEUF
     I              B1ORUE                          WTORUE
     I              B1IUTR                          WTIUTR
     I              B1IJRR                          WTIJRR
     I              B1VCST                          WTVCST
     I              B1VDST                          WTVDST
     I              B1VEST                          WTVEST
     I              B1VFST                          WTVFST
     I              B1VGST                          WTVGST
     I              B1ABCD                          WTABCD
     I              B1AACD                          WTAACD
     I              B1AAVN                          WTAAVN
     I              B1AADT                          WTAADT
     I              B1AMTM                          WTAMTM
     I              B1AJST                          WTAJST
     I              B1AHVN                          WTAHVN
     I              B1AGVN                          WTAGVN
     I              B1ABVN                          WTABVN
     I              B1ABDT                          WTABDT
     I              B1ABTM                          WTABTM
      *
     I@A1CPV3
      * Tattoo Header            Co/Bol/Ttt/Pd/kd slunp/lv
      * Renamed input format fields
     I              A1HMNB                          WVHMNB
     I              A1BNNB                          WVBNNB
     I              A1BONB                          WVBONB
     I              A1CVNB                          WVCVNB
     I              A1B0DT                          WVB0DT
     I              A1AWDT                          WVAWDT
     I              A1BICD                          WVBICD
     I              A1CPST                          WVCPST
     I              A1ACPR                          WVACPR
     I              A1B9PR                          WVB9PR
     I              A1CAPR                          WVCAPR
     I              A1C4ST                          WVC4ST
     I              A1AIPR                          WVAIPR
     I              A1A6DT                          WVA6DT
     I              A1C2ST                          WVC2ST
     I              A1CXNB                          WVCXNB
     I              A1CWNB                          WVCWNB
     I              A1FCNB                          WVFCNB
     I              A1H9NB                          WVH9NB
     I              A1FDNB                          WVFDNB
     I              A1FENB                          WVFENB
     I              A1HENB                          WVHENB
     I              A1HFNB                          WVHFNB
     I              A1CYNB                          WVCYNB
     I              A1LRNB                          WVLRNB
     I              A1E0NB                          WVE0NB
     I              A1A5PC                          WVA5PC
     I              A1FBNB                          WVFBNB
     I              A1A4PC                          WVA4PC
     I              A1F7NB                          WVF7NB
     I              A1HDNB                          WVHDNB
     I              A1F5NB                          WVF5NB
     I              A1F4NB                          WVF4NB
     I              A1F3NB                          WVF3NB
     I              A1F2NB                          WVF2NB
     I              A1AVPC                          WVAVPC
     I              A1AWPC                          WVAWPC
     I              A1CWPC                          WVCWPC
     I              A1A8PC                          WVA8PC
     I              A1A7PC                          WVA7PC
     I              A1B8PR                          WVB8PR
     I              A1AMPR                          WVAMPR
     I              A1ANPR                          WVANPR
     I              A1AYVA                          WVAYVA
     I              A1AWVA                          WVAWVA
     I              A1AOPR                          WVAOPR
     I              A1AXVA                          WVAXVA
     I              A1APPR                          WVAPPR
     I              A1ASPR                          WVASPR
     I              A1A4VA                          WVA4VA
     I              A1ATPR                          WVATPR
     I              A1A5VA                          WVA5VA
     I              A1CBPR                          WVCBPR
     I              A1CCPR                          WVCCPR
     I              A1LPNB                          WVLPNB
     I              A1CDPR                          WVCDPR
     I              A1A7VA                          WVA7VA
     I              A1A2PR                          WVA2PR
     I              A1JWST                          WVJWST
     I              A1CWST                          WVCWST
     I              A1D7ST                          WVD7ST
     I              A1D8ST                          WVD8ST
     I              A1DWST                          WVDWST
     I              A1D6ST                          WVD6ST
     I              A1GHNB                          WVGHNB
     I              A1BYDT                          WVBYDT
     I              A1E0ST                          WVE0ST
     I              A1E1ST                          WVE1ST
     I              A1E2ST                          WVE2ST
     I              A1BSDT                          WVBSDT
     I              A1BTDT                          WVBTDT
     I              A1BUDT                          WVBUDT
     I              A1HGNB                          WVHGNB
     I              A1HHNB                          WVHHNB
     I              A1HINB                          WVHINB
     I              A1A3PR                          WVA3PR
     I              A1A4PR                          WVA4PR
     I              A1A6PR                          WVA6PR
     I              A1J9NB                          WVJ9NB
     I              A1D6PR                          WVD6PR
     I              A1D7PR                          WVD7PR
     I              A1D8PR                          WVD8PR
     I              A1D9PR                          WVD9PR
     I              A1EAPR                          WVEAPR
     I              A1EBPR                          WVEBPR
     I              A1ECPR                          WVECPR
     I              A1EDPR                          WVEDPR
     I              A1EEPR                          WVEEPR
     I              A1EFPR                          WVEFPR
     I              A1EGPR                          WVEGPR
     I              A1EHPR                          WVEHPR
     I              A1KAST                          WVKAST
     I              A1J7ST                          WVJ7ST
     I              A1J9ST                          WVJ9ST
     I              A1OXNB                          WVOXNB
     I              A1LKST                          WVLKST
     I              A1LLST                          WVLLST
     I              A1J8ST                          WVJ8ST
     I              A1LIST                          WVLIST
     I              A1LJST                          WVLJST
     I              A1NZTX                          WVNZTX
     I              A1HJCD                          WVHJCD
     I              A1R4ST                          WVR4ST
     I              A1R5ST                          WVR5ST
     I              A1R6ST                          WVR6ST
     I              A1R7ST                          WVR7ST
     I              A1THWT                          WVTHWT
     I              A1T2WT                          WVT2WT
     I              A1THHD                          WVTHHD
     I              A1T2HD                          WVT2HD
     I              A1OBPR                          WVOBPR
     I              A1KOER                          WVKOER
     I              A1OPIR                          WVOPIR
     I              A1OPEM                          WVOPEM
     I              A1IORP                          WVIORP
     I              A1OWEO                          WVOWEO
     I              A1OQET                          WVOQET
     I              A1URST                          WVURST
     I              A1USST                          WVUSST
     I              A1HHPC                          WVHHPC
     I              A1S9PR                          WVS9PR
     I              A1TAPR                          WVTAPR
     I              A1TBPR                          WVTBPR
     I              A1JFUR                          WVJFUR
     I              A1KRIF                          WVKRIF
     I              A1KORF                          WVKORF
     I              A1KAPR                          WVKAPR
     I              A1KROT                          WVKROT
     I              A1OTJG                          WVOTJG
     I              A1IRJG                          WVIRJG
     I              A1IMJF                          WVIMJF
     I              A1IRGF                          WVIRGF
     I              A1KRJF                          WVKRJF
     I              A1OJRF                          WVOJRF
     I              A1KFOR                          WVKFOR
     I              A1ORJK                          WVORJK
     I              A1OMVJ                          WVOMVJ
     I              A1MVNF                          WVMVNF
     I              A1MCNF                          WVMCNF
     I              A1NCNF                          WVNCNF
     I              A1NCHF                          WVNCHF
     I              A1IGIR                          WVIGIR
     I              A1KFJR                          WVKFJR
     I              A1EADT                          WVEADT
     I              A1EBDT                          WVEBDT
     I              A1ECDT                          WVECDT
     I              A1EDDT                          WVEDDT
     I              A1EEDT                          WVEEDT
     I              A1U4ST                          WVU4ST
     I              A1U5ST                          WVU5ST
     I              A1U6ST                          WVU6ST
     I              A1U7ST                          WVU7ST
     I              A1U8ST                          WVU8ST
     I              A1U9ST                          WVU9ST
     I              A1VAST                          WVVAST
     I              A1VBST                          WVVBST
     I              A1BDCD                          WVBDCD
     I              A1CSCD                          WVCSCD
     I              A1ABCD                          WVABCD
     I              A1AECD                          WVAECD
     I              A1ACCD                          WVACCD
     I              A1AGCD                          WVAGCD
     I              A1BECD                          WVBECD
     I              A1AAVN                          WVAAVN
     I              A1AADT                          WVAADT
     I              A1AMTM                          WVAMTM
     I              A1AJST                          WVAJST
     I              A1AHVN                          WVAHVN
     I              A1AGVN                          WVAGVN
     I              A1ABVN                          WVABVN
     I              A1ABDT                          WVABDT
     I              A1ABTM                          WVABTM
      *
     I@A8REDA
      * Hog Classification        Retrieval index
      * Renamed input format fields
     I              A8BECD                          WWBECD
     I              A8BDTX                          WWBDTX
     I              A8BXST                          WWBXST
     I              A8BYST                          WWBYST
     I              A8BITX                          WWBITX
     I              A8B0ST                          WWB0ST
     I              A8FBST                          WWFBST
     I              A8AAVN                          WWAAVN
     I              A8AADT                          WWAADT
     I              A8AMTM                          WWAMTM
     I              A8AJST                          WWAJST
     I              A8AHVN                          WWAHVN
     I              A8AGVN                          WWAGVN
     I              A8ABVN                          WWABVN
     I              A8ABDT                          WWABDT
     I              A8ABTM                          WWABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     IYARDCS      DS                            583
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WSHMNB
     I              B1BNNB                          WSBNNB
     I              B1BONB                          WSBONB
     I              B1CVNB                          WSCVNB
     I              B1B0DT                          WSB0DT
     I              B1LGNB                          WSLGNB
     I              B1EUNB                          WSEUNB
     I              B1LHNB                          WSLHNB
     I              B1INST                          WSINST
     I              B1BEPR                          WSBEPR
     I              B1ASPC                          WSASPC
     I              B1EWNB                          WSEWNB
     I              B1B4PR                          WSB4PR
     I              B1EYNB                          WSEYNB
     I              B1B1PR                          WSB1PR
     I              B1AVPR                          WSAVPR
     I              B1AUPC                          WSAUPC
     I              B1AWPR                          WSAWPR
     I              B1AXPR                          WSAXPR
     I              B1EZNB                          WSEZNB
     I              B1AYPR                          WSAYPR
     I              B1BBDT                          WSBBDT
     I              B1AKTM                          WSAKTM
     I              B1IQST                          WSIQST
     I              B1EFST                          WSEFST
     I              B1H6NB                          WSH6NB
     I              B1BEPC                          WSBEPC
     I              B1GCST                          WSGCST
     I              B1GDST                          WSGDST
     I              B1GEST                          WSGEST
     I              B1BHPC                          WSBHPC
     I              B1IOST                          WSIOST
     I              B1IPST                          WSIPST
     I              B1LTNB                          WSLTNB
     I              B1JNST                          WSJNST
     I              B1X4NB                          WSX4NB
     I              B1FNPC                          WSFNPC
     I              B1FOPC                          WSFOPC
     I              B1FPPC                          WSFPPC
     I              B1K2ST                          WSK2ST
     I              B1K3ST                          WSK3ST
     I              B1JWPR                          WSJWPR
     I              B1F5PC                          WSF5PC
     I              B1JXPR                          WSJXPR
     I              B1JYPR                          WSJYPR
     I              B1JZPR                          WSJZPR
     I              B1J0PR                          WSJ0PR
     I              B1J1PR                          WSJ1PR
     I              B1J2PR                          WSJ2PR
     I              B1J3PR                          WSJ3PR
     I              B1J4PR                          WSJ4PR
     I              B1UTST                          WSUTST
     I              B1HVCD                          WSHVCD
     I              B1DKJR                          WSDKJR
     I              B1ITJF                          WSITJF
     I              B1IJGR                          WSIJGR
     I              B1ORJE                          WSORJE
     I              B1OTJR                          WSOTJR
     I              B1PEIR                          WSPEIR
     I              B1IEUF                          WSIEUF
     I              B1ORUE                          WSORUE
     I              B1IUTR                          WSIUTR
     I              B1IJRR                          WSIJRR
     I              B1VCST                          WSVCST
     I              B1VDST                          WSVDST
     I              B1VEST                          WSVEST
     I              B1VFST                          WSVFST
     I              B1VGST                          WSVGST
     I              B1ABCD                          WSABCD
     I              B1AACD                          WSAACD
     I              B1AAVN                          WSAAVN
     I              B1AADT                          WSAADT
     I              B1AMTM                          WSAMTM
     I              B1AJST                          WSAJST
     I              B1AHVN                          WSAHVN
     I              B1AGVN                          WSAGVN
     I              B1ABVN                          WSABVN
     I              B1ABDT                          WSABDT
     I              B1ABTM                          WSABTM
      *
     IYBRDCS      DS                            267
     IQPKB12    E DSPKB1CPLD
      * UPD : Carcass Detail            Update index Purge
      * Renamed input format fields
     I              B1HMNB                          WTHMNB
     I              B1BNNB                          WTBNNB
     I              B1BONB                          WTBONB
     I              B1CVNB                          WTCVNB
     I              B1B0DT                          WTB0DT
     I              B1LGNB                          WTLGNB
     I              B1EUNB                          WTEUNB
     I              B1LHNB                          WTLHNB
     I              B1INST                          WTINST
     I              B1BEPR                          WTBEPR
     I              B1ASPC                          WTASPC
     I              B1EWNB                          WTEWNB
     I              B1B4PR                          WTB4PR
     I              B1EYNB                          WTEYNB
     I              B1B1PR                          WTB1PR
     I              B1AVPR                          WTAVPR
     I              B1AUPC                          WTAUPC
     I              B1AWPR                          WTAWPR
     I              B1AXPR                          WTAXPR
     I              B1EZNB                          WTEZNB
     I              B1AYPR                          WTAYPR
     I              B1BBDT                          WTBBDT
     I              B1AKTM                          WTAKTM
     I              B1IQST                          WTIQST
     I              B1EFST                          WTEFST
     I              B1H6NB                          WTH6NB
     I              B1BEPC                          WTBEPC
     I              B1GCST                          WTGCST
     I              B1GDST                          WTGDST
     I              B1GEST                          WTGEST
     I              B1BHPC                          WTBHPC
     I              B1IOST                          WTIOST
     I              B1IPST                          WTIPST
     I              B1LTNB                          WTLTNB
     I              B1JNST                          WTJNST
     I              B1X4NB                          WTX4NB
     I              B1FNPC                          WTFNPC
     I              B1FOPC                          WTFOPC
     I              B1FPPC                          WTFPPC
     I              B1K2ST                          WTK2ST
     I              B1K3ST                          WTK3ST
     I              B1JWPR                          WTJWPR
     I              B1F5PC                          WTF5PC
     I              B1JXPR                          WTJXPR
     I              B1JYPR                          WTJYPR
     I              B1JZPR                          WTJZPR
     I              B1J0PR                          WTJ0PR
     I              B1J1PR                          WTJ1PR
     I              B1J2PR                          WTJ2PR
     I              B1J3PR                          WTJ3PR
     I              B1J4PR                          WTJ4PR
     I              B1UTST                          WTUTST
     I              B1HVCD                          WTHVCD
     I              B1DKJR                          WTDKJR
     I              B1ITJF                          WTITJF
     I              B1IJGR                          WTIJGR
     I              B1ORJE                          WTORJE
     I              B1OTJR                          WTOTJR
     I              B1PEIR                          WTPEIR
     I              B1IEUF                          WTIEUF
     I              B1ORUE                          WTORUE
     I              B1IUTR                          WTIUTR
     I              B1IJRR                          WTIJRR
     I              B1VCST                          WTVCST
     I              B1VDST                          WTVDST
     I              B1VEST                          WTVEST
     I              B1VFST                          WTVFST
     I              B1VGST                          WTVGST
     I              B1ABCD                          WTABCD
     I              B1AACD                          WTAACD
     I              B1AAVN                          WTAAVN
     I              B1AADT                          WTAADT
     I              B1AMTM                          WTAMTM
     I              B1AJST                          WTAJST
     I              B1AHVN                          WTAHVN
     I              B1AGVN                          WTAGVN
     I              B1ABVN                          WTABVN
     I              B1ABDT                          WTABDT
     I              B1ABTM                          WTABTM
      *
     IYCRDCS      DS                            583
      * Outward parameters
     IPARC        DS                             16
      * KEY : Tattoo Header             Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20PAHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PABNNB
      * I : RST BOL Load Number
     I                                    P   7   90PABONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PACVNB
      * I : RST TH Kill Date
     I                                    P  13  160PAB0DT
      *
     IYDRDCS      DS                            583
     IYERDCS      DS                            583
     IYFRDCS      DS                            583
     IYGRDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Control HPE
      * I : MAP CC Company Number
     I                                    P   1   20P1HONB
     IP2PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P2EVTX
     IP3PARM      DS
      * I : MAP Pmt Current Payment Date
     I                                    P   1   40P3CKDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P2EVTX    PARM           WP0002 40        Oms System Valu
     C           P3CKDT    PARM           WP0003  70       Pmt Current Pay
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Cmp/Frt/Da's/Net  XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      * Remove the fix pgm for HPE056 to not to update the payment type
      * any more because the payment type should already be populated
      * ***********************************************************
      * Rtv the Competitors Carcass Merit codes only 3 allowed
      * Rtv Cmp Competitors   RT - Carcass Merit Program  * 
     C                     EXSR SARVGN
      * Read each Tattoo that are unpaid, and Recalc Net
      * and Process Carcass Merit Program, Freight Allocation, D/A's
      * and Calculate Net.
      * *-------------------------------------------------------------*
      * 12/10/01 PKD Added the following for calculating the Average
      *              Value of Valid Carcasses for adding carcasses
      *              at an average.
      * Rtv Clc CrMr f/HldOvr RT - Tattoo Header  * 
     C                     EXSR SBRVGN
      * *-------------------------------------------------------------*
      * HPE053p:  Read TH all "Unpaid Producer and Live Anything"
      *  and call the routines to calc the CrMrt/frt/da/net amounts
      * Rtv Clc CrMr/Ft/Da/Nt RT - Tattoo Header  * 
     C                     EXSR SYRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NASUBR    BEGSR
      *================================================================
      * Freight
      *================================================================
      * Modification history
     C                     EXSR NBSUBR                     Modification hi
      * Get bol frt fields, and find out if any tattoo for this
      * load has been paid.
      * If a tattoo has been paid bringh this back, also held over frt bu
      * Rtv Frt All f/BOL/TTO  XF - Buy Order Load  * 
     C                     CALL 'PKEHXFR'              90  Rtv Frt All f/B
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0274  30       BOH Company Num
     C                     PARM WVBNNB    WQ0275  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0276  50       BOL Load Number
     C           WUCMST    PARM WUCMST    WQ0277  2        BOL Freight UOM
     C           WUAGPR    PARM WUAGPR    WQ0278  72       BOL Freight Uni
     C           WUATVA    PARM WUATVA    WQ0279  72       BOL Freight Amt
     C           WUI1ST    PARM WUI1ST    WQ0280  1        BOL Freight All
     C           WUDHNB    PARM WUDHNB    WQ0281  70       BOL Head Receiv
     C           WUDINB    PARM WUDINB    WQ0282  71       BOL Live Wgt Re
     C           WUIOJR    PARM WUIOJR    WQ0283  70       BOL Head Receiv
     C           WUNPST    PARM WUNPST    WQ0284  1        Tattoo is paid
     C           WUNFST    PARM WUNFST    WQ0285  1        Held Over Recor
     C           WUK4PR    PARM WUK4PR    WQ0286  72       Tot Frt Spdb af
     C           WUK7PR    PARM WUK7PR    WQ0287  72       Frt Amt spread
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKEHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If allocated but no paid then allow to re spread of frt
      * If not allocated allow spread of frt
      * CASE: not paid tattoo but allocated frt allow reallocate
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo is paid Usr is No
      *   |- c2    : WRK.BOL Freight Allocation is Freight is Allocated
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUNPST    IFEQ 'N'                        *IF
     C           WUI1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUI5ST           Freight Allocia
      * Clc Frght Allctn/UnAl  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ6XFR'              90  Clc Frght Allct
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0288  30       BOH Company Num
     C                     PARM WVBNNB    WQ0289  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0290  50       BOL Load Number
     C                     PARM WUCMST    WQ0291  2        BOL Freight UOM
     C                     PARM WUAGPR    WQ0292  72       BOL Freight Uni
     C                     PARM WUATVA    WQ0293  72       BOL Freight Amt
     C                     PARM WUI1ST    WQ0294  1        BOL Freight All
     C                     PARM WUDHNB    WQ0295  70       BOL Head Receiv
     C                     PARM WUDINB    WQ0296  71       BOL Live Wgt Re
     C                     PARM WUIOJR    WQ0297  70       BOL Head Receiv
     C                     PARM WUI5ST    WQ0298  1        Freight Allocia
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: WRK.BOL Freight Allocation is Freight is not Allocated
     C           WUI1ST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUI5ST           Freight Allocia
      * Clc Frght Allctn/UnAl  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ6XFR'              90  Clc Frght Allct
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0299  30       BOH Company Num
     C                     PARM WVBNNB    WQ0300  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0301  50       BOL Load Number
     C                     PARM WUCMST    WQ0302  2        BOL Freight UOM
     C                     PARM WUAGPR    WQ0303  72       BOL Freight Uni
     C                     PARM WUATVA    WQ0304  72       BOL Freight Amt
     C                     PARM WUI1ST    WQ0305  1        BOL Freight All
     C                     PARM WUDHNB    WQ0306  70       BOL Head Receiv
     C                     PARM WUDINB    WQ0307  71       BOL Live Wgt Re
     C                     PARM WUIOJR    WQ0308  70       BOL Head Receiv
     C                     PARM WUI5ST    WQ0309  1        Freight Allocia
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBSUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  3/07/2019 JBB E14281 - Zero prices on BOL
      *                         Added parameter to BOL RTVOBJ to get Mark
      *                         Head Received.
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Cmp Competitors   RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUP0NB           Count USR
     C                     MOVEL*BLANK    WUE7CD           Competitors Cod
     C                     MOVEL*BLANK    WUE8CD           Competitors Cod
     C                     MOVEL*BLANK    WUE9CD           Competitors Cod
      * Establish starting position
     C           *LOVAL    SETLL@ARRETN                    *
     C                     READ @ARRETN                  90*
      * Data record not found
     C   90                MOVEL'PRK0039' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  001       WUP0NB           Count USR
      * CASE: WRK.Count USR is One
     C           WUP0NB    IFEQ 1                          *IF
     C                     MOVELWAAMCD    WUE7CD           Competitors Cod
     C                     ELSE
      * CASE: WRK.Count USR is Two
     C           WUP0NB    IFEQ 2                          *IF
     C                     MOVELWAAMCD    WUE8CD           Competitors Cod
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUP0NB    IFEQ 3                          *IF
     C                     MOVELWAAMCD    WUE9CD           Competitors Cod
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @ARRETN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Clc CrMr f/HldOvr RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  72       Total Carc Val
     C                     Z-ADD*ZERO     WN0002  70       Head Total USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Total Carc Val
     C                     Z-ADD*ZERO     WN0002           Head Total USR
     C                     Z-ADD*ZERO     YL0001           BOH Buy Order N
     C                     Z-ADD*ZERO     YL0002           BOL Load Number
     C                     Z-ADD*ZERO     YL0003           TH Tattoo Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HONB    WQSB01           BOH Company Num
      * Establish starting position
     C           KRSSB     SETLL@A1CPG3                    *
     C           KRSSB     READE@A1CPG3                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : LCL.BOH Buy Order Number NE DB1.BOH Buy Order Number
      *   |- c2    : LCL.BOL Load Number NE DB1.BOL Load Number
      *   |- c3    : LCL.TH Tattoo Number NE DB1.TH Tattoo Number
      *   '-
     C           YL0001    IFNE WBBNNB                     *IF
     C           YL0002    ORNE WBBONB                     *OR
     C           YL0003    ORNE WBCVNB                     *OR
      * TH VC Gross Value /Hd
      * CASE: PAR.Head Total USR is Greater then Zero
     C           WN0002    IFGT 0                          *IF
     C           WN0001    DIV  WN0002    YL0004    H      TH VC Gross Val
      * Upd VC Gross Val /Hd  RT - Tattoo Header  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0004           TH VC Gross Val
     C                     END                             *FI
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
     C                     EXSR SERVGN
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
     C                     EXSR SFRVGN
     C                     Z-ADDWBBNNB    YL0001           BOH Buy Order N
     C                     Z-ADDWBBONB    YL0002           BOL Load Number
     C                     Z-ADDWBCVNB    YL0003           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WN0002           Head Total USR
     C                     Z-ADD*ZERO     WN0001           Total Carc Val
     C                     END                             *FI
      * Clc Base Mkt Price    XF - Pricing Option  * 
     C                     CALL 'PKJ7XFR'              90  Clc Base Mkt Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBBNNB    WQ0001  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0002  50       BOL Load Number
     C                     PARM WBCVNB    WQ0003  50       TH Tattoo Numbe
     C                     PARM WBAWDT    WQ0004  70       TH Purchase Dat
     C                     PARM WBCYNB    WQ0005  71       TH Live Wgt
     C           YL0022    PARM *ZERO     WQ0006  52       TH CM Base Mkt
     C                     PARM WBB0DT    WQ0007  70       TH Kill Date
     C                     PARM WBHMNB    WQ0008  30       BOH Company Num
     C                     PARM YL0015    WQ0009  52       PSC Floor Price
     C                     PARM YL0016    WQ0010  52       PSC Ceiling Pri
     C                     PARM YL0017    WQ0011  30       PSC Market Perc
     C                     PARM YL0021    WQ0012  52       PSC Mkt Percent
     C           YL0023    PARM YL0023    WQ0013  52       Market Price US
     C           YL0024    PARM *BLANK    WQ0014  2        Pricing UOM USR
     C           YL0025    PARM *ZERO     WQ0015  70       Pricing Date US
     C                     PARM YL0013    WQ0016  3        PO Option Code
     C                     PARM YL0011    WQ0017  5        PC Contract Cod
     C                     PARM YL0012    WQ0018  5        PSC Sub-Contrac
     C                     PARM YL0005    WQ0019  52       BOH Market Add/
     C                     PARM YL0014    WQ0020  3        CMP Program Cod
     C                     PARM YL0006    WQ0021  2        BOH Quote Price
     C                     PARM YL0007    WQ0022  52       BOH Quoted Base
     C                     PARM YL0008    WQ0023  3        BOH Commodity M
     C                     PARM YL0009    WQ0024  7        BOH Commodity P
     C                     PARM YL0010    WQ0025  3        BOH Market Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E2521 03/27/13  slm mpr cutout or hog cutout. hard code remove in
      * Clc Crc Mrt Activ Crc RT - Carcass Detail  * 
     C                     EXSR SGRVGN
     C                     ADD  YL0026    WN0002           Head Total USR
     C                     ADD  YL0033    WN0001           Total Carc Val
     C           KRSSB     READE@A1CPG3                  90*
     C                     ENDDO
      * USER: Exit processing
      * TH VC Gross Value /Hd
      * CASE: PAR.Head Total USR is Greater then Zero
     C           WN0002    IFGT 0                          *IF
     C           WN0001    DIV  WN0002    YL0004    H      TH VC Gross Val
      * Upd VC Gross Val /Hd  RT - Tattoo Header  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Upd VC Gross Val /Hd  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSC03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSC04           TH Tattoo Numbe
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
     C                     KFLD           WQSC04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHMNB    WQSC01           BOH Company Num
     C                     Z-ADDYL0001    WQSC02           BOH Buy Order N
     C                     Z-ADDYL0002    WQSC03           BOL Load Number
     C                     Z-ADDYL0003    WQSC04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSC     SETLL@A1CPC4                    *
     C           KRSSC     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg VC Gross Val /Hd  CH - Tattoo Header  * 
     C                     EXSR SDCHRC
     C           KRSSC     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg VC Gross Val /Hd  CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0004 10        TH Group Refere
     C                     MOVEL*BLANK    WN0005  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0006  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0007  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0008  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0009  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0010  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0011  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0012  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0013  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0014  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0015  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0016  50       TH Held Over
     C                     Z-ADD*ZERO     WN0017  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0018  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0019  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0020  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0021  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0022  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0023  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0024  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0025  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0026  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0027  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0028  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0029  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0030  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0031  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0032  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0033  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0034  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0035  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0036  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0037  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0038  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0039  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0040  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0041  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0042  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0043  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0044  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0045  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0046  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0047  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0048  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0049  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0050  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0051  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0052  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0053  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0054  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0055  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0056  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0057  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0058  1        TH Header Error
     C                     MOVEL*BLANK    WN0059  1        TH Detail Error
     C                     MOVEL*BLANK    WN0060  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0061  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0062  80       TH Commission A
     C                     Z-ADD*ZERO     WN0063  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0064  1        TH User Error O
     C                     MOVEL*BLANK    WN0065  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0066  1        TH Sex
     C                     Z-ADD*ZERO     WN0067  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0068  70       TH Commission P
     C                     Z-ADD*ZERO     WN0069  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0070  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0071  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0072  31       TH FFLI
     C                     Z-ADD*ZERO     WN0073  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0074  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0075  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0076  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0077  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0078  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0079  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0080  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0081  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0082  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0083  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0084  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0085  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0086  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0087  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0088  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0089  1        TH Source Type
     C                     MOVEL*BLANK    WN0090  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0091  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0092  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0093  3        TH Source Code
     C                     MOVEL*BLANK    WN0094  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0095  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0096  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0097  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0098  3        TH State
     C                     MOVEL*BLANK    WN0099  3        TH Unused Code
     C                     MOVEL*BLANK    WN0100  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0101  1        TH Commission S
     C                     MOVEL*BLANK    WN0102  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0103  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0104  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0105  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0106  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0107  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0108  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0109  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0110  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0111  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0112  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0113  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0114  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0115  3        TH PHA Average
     C                     MOVEL*BLANK    WN0116  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0117  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0118  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0119  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0120  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0121  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0122  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0123  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0124  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0125  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0126  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0127  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0128 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0129 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0130 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0131 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0132  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0133  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0134  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0135  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0136  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0137  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0138  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0139  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0140  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0141  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0142  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0143  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0144  70       TH Unused Date
     C                     MOVEL*BLANK    WN0145  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0146  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0147  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0148  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0149  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0150  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0151  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0152  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0153  6        DF Defect Code
     C                     MOVEL*BLANK    WN0154  6        THP Process Cod
     C                     MOVEL*BLANK    WN0155  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0156  6        PL Location Cod
     C                     MOVEL*BLANK    WN0157  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0158  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0159  3        HC Class Code
     C                     MOVEL*BLANK    WN0160 10        RS User Changed
     C                     Z-ADD*ZERO     WN0161  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0162  60       RS Time Changed
     C                     MOVEL*BLANK    WN0163  1        RS Record Statu
     C                     MOVEL*BLANK    WN0164 10        RS Job
     C                     MOVEL*BLANK    WN0165 10        RS Program
     C                     MOVEL*BLANK    WN0166 10        RS User Added
     C                     Z-ADD*ZERO     WN0167  70       RS Date Added
     C                     Z-ADD*ZERO     WN0168  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHSD    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YARDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDYL0004    WDTAPR           TH VC Gross Val
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSE     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * 1/28/08 SLM LEFT OVER INFORMATION MAY HAVE CAUSED ISSUES
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0005           BOH Market Add/
     C                     MOVEL*BLANK    YL0006           BOH Quote Price
     C                     Z-ADD*ZERO     YL0007           BOH Quoted Base
     C                     MOVEL*BLANK    YL0008           BOH Commodity M
     C                     MOVEL*BLANK    YL0009           BOH Commodity P
     C                     MOVEL*BLANK    YL0010           BOH Market Date
     C                     MOVEL*BLANK    YL0011           PC Contract Cod
     C                     MOVEL*BLANK    YL0012           PSC Sub-Contrac
     C                     MOVEL*BLANK    YL0013           PO Option Code
     C                     MOVEL*BLANK    YL0014           CMP Program Cod
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAAPR    YL0005           BOH Market Add/
     C                     MOVELWEB3ST    YL0006           BOH Quote Price
     C                     Z-ADDWEALPR    YL0007           BOH Quoted Base
     C                     MOVELWEETCD    YL0008           BOH Commodity M
     C                     MOVELWEEUCD    YL0009           BOH Commodity P
     C                     MOVELWEJ5TX    YL0010           BOH Market Date
     C                     MOVELWEAKCD    YL0011           PC Contract Cod
     C                     MOVELWEALCD    YL0012           PSC Sub-Contrac
     C                     MOVELWEAICD    YL0013           PO Option Code
     C                     MOVELWEAMCD    YL0014           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAKCD           PC Contract Cod
     C                     KFLD           WFALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELYL0011    WFAKCD           PC Contract Cod
     C                     MOVELYL0012    WFALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSF     CHAIN@AQCPA0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0015           PSC Floor Price
     C                     Z-ADD*ZERO     YL0016           PSC Ceiling Pri
     C                     Z-ADD*ZERO     YL0017           PSC Market Perc
     C                     Z-ADD*ZERO     YL0018           PSC Break Even
     C                     Z-ADD*ZERO     YL0019           PSC FLoor Price
     C                     MOVEL*BLANK    YL0020           PSC Sub-Contrac
     C                     Z-ADD*ZERO     YL0021           PSC Mkt Percent
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFAZPR    YL0015           PSC Floor Price
     C                     Z-ADDWFA0PR    YL0016           PSC Ceiling Pri
     C                     Z-ADDWFA9PC    YL0017           PSC Market Perc
     C                     Z-ADDWFA7PR    YL0018           PSC Break Even
     C                     Z-ADDWFA8PR    YL0019           PSC FLoor Price
     C                     MOVELWFF3ST    YL0020           PSC Sub-Contrac
     C                     Z-ADDWFA9PR    YL0021           PSC Mkt Percent
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Clc Crc Mrt Activ Crc RT - Carcass Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0169  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0170  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0171  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0172  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0173  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0174  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0175  31       CD Lean Percent
     C                     Z-ADD*ZERO     WN0176  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0177  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0178  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0179  72       CD Gross Value
     C                     Z-ADD*ZERO     WN0180  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0181  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0182  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0183  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0184  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0185  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0186  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0187  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0188  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0189  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0190  72       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0191  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0192  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0193  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0194  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0195  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0196  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0197  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0198  72       CD Gross Before
     C                     MOVEL*BLANK    WN0199  1        CMP Grading Typ
     C                     MOVEL*BLANK    WN0200  1        CMP Sort Basis
     C                     MOVEL*BLANK    WN0201  1        CMP Sts
     C                     MOVEL*BLANK    WN0202  2        CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0203  31       CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0204  31       CMP Lean Factor
     C                     MOVEL*BLANK    WN0205  1        CMP Optimal Row
     C                     MOVEL*BLANK    WN0206  1        CMP Type
     C                     Z-ADD*ZERO     WN0207  52       CMP % of Carcas
     C                     Z-ADD*ZERO     WN0208  52       CMP Fixed Cost
     C                     Z-ADD*ZERO     WN0209  52       CMP Grade Type
     C                     Z-ADD*ZERO     WN0210  30       CMMR Row Number
     C                     Z-ADD*ZERO     WN0211  52       CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0212  52       CMMR Sort Disco
     C                     Z-ADD*ZERO     WN0213  52       CMMR Unused Fie
     C                     Z-ADD*ZERO     WN0214  52       CMMR Midpoint
     C                     Z-ADD*ZERO     WN0215  31       CMMC Lean Perce
     C                     Z-ADD*ZERO     WN0216  53       CMMC Premium Va
     C                     Z-ADD*ZERO     WN0217  52       PurchPrc + Sort
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 10/11/17 Calc MPR Sort Loss -- change on otherwise stmt
      * 5/23/03  Calc MPR Sort Loss in Carcass Analysis Detail section
      * Initialize Total Fields
     C                     EXSR UBSUBR                     Initialize Tota
      * 10/23/2007 CMP Grade Type Adj to store the adj for backfat
      * Rtv CMP Payment Info3 RT - Carcass Merit Program  * 
     C                     EXSR SHRVGN
      * comments
     C                     EXSR UCSUBR                     comments
     C                     Z-ADDWBAWDT    YL0051           CMP Effect Purc
      * Rtv Carcass Merit Prog RT - Carcass Merit Prog MktGrp  * 
     C                     EXSR SIRVGN
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WN0199    IFEQ 'M'                        *IF
      * RTV Market Price      XF - STR Order Management Sys  * 
     C                     CALL 'PDMWXFR'              90  RTV Market Pric
     C                     PARM WURTN     WQ0026  7        *Return code
     C                     PARM YL0052    WQ0027  3        PSC Commodity M
     C                     PARM YL0053    WQ0028  7        PSC Commodity P
     C                     PARM WBAWDT    WQ0029  70       TH Purchase Dat
     C                     PARM *ZERO     WQ0030  70       Date To   USR
     C           YL0054    PARM *ZERO     WQ0031 114       OMS Market Pric
     C           YL0055    PARM *ZERO     WQ0032  70       Pricing Date US
     C                     PARM WBHMNB    WQ0033  30       BOH Company Num
     C                     PARM 'CUR'     WQ0034  3        BOH Market Date
     C                     PARM 'H'       WQ0035  1        System Used
     C           WUIPTX    PARM *BLANK    WQ0036  5        OMS Error Retur
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMWXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * FIXED COST
      * if LCL.OMS Market Price Amt Usr is zero, then send a message
      * to some distribution list Market Price not available for Fixed Co
      * Calculation.
      * Market Prc Hog/Cutout USR
      * LCL.Market Prc Hog/Cutout USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : LCL.OMS Market Price Amt Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMP % of Carcass Cutout
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0207    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0054    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0056           Market Prc Hog/
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN WGBNNB    WQSG02           BOH Buy Order N
     C           *LIKE     DEFN WGBONB    WQSG03           BOL Load Number
     C           *LIKE     DEFN WGCVNB    WQSG04           TH Tattoo Numbe
     C           *LIKE     DEFN WGB0DT    WQSG05           TH Kill Date
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           BOH Buy Order N
     C                     KFLD           WQSG03           BOL Load Number
     C                     KFLD           WQSG04           TH Tattoo Numbe
     C                     KFLD           WQSG05           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WQSG01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSG02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSG03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSG04           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WQSG05           TH Kill Date
      * Establish starting position
     C           KRSSG     SETLL@B1CPEF                    *
     C           KRSSG     READE@B1CPEF                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: Excluded Records
      *  - (c1 AND c2 AND c3) OR (c4 AND c5 AND c6)
      *   |- c1    : PAR.Competitors Processing is Yes
      *   |- c2    : PAR.CM Processing Type Usr is Payment
      *   |- c3    : DB1.CD Record Add/Del Sts is Delete
      *   |- c4    : PAR.Competitors Processing is No
      *   |- c5    : PAR.CM Processing Type Usr is Analysis
      *   |- c6    : DB1.CD Record Add/Del Sts is Delete
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'N'       IFEQ 'Y'                        *IF
     C           'P'       IFEQ 'P'                        *IF
     C           WGINST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           'N'       IFEQ 'N'                        *IF
     C           'P'       IFEQ 'A'                        *IF
     C           WGINST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.CD Adjust/Add Type is Not Add w/Average Value
      *   |- c2    : PAR.Competitors Processing is Yes
      *   '-
     C           WGUTST    IFEQ 'HST'                      *IF
     C           WGUTST    OREQ 'AVG'
     C           WGUTST    OREQ '2WK'
     C           WGUTST    OREQ '4WK'
     C           WGUTST    OREQ 'LN%'
     C           WGUTST    OREQ *BLANK
     C           WGUTST    OREQ 'LOT'
     C           'N'       OREQ 'Y'                        *OR
      * move db1 ca fields to par ca fields
     C                     EXSR UDSUBR                     move db1 ca fie
      * move db1 CD fields to par CD fields
     C                     EXSR UESUBR                     move db1 CD fie
      * Use competitors Averages or regular carcass analysis
      * CASE: PAR.Average Pay Sts Usr is Yes
     C           'N'       IFEQ 'Y'                        *IF
      * Move Averages to Cd fields before extension or totals are accum
     C                     EXSR UFSUBR                     Move Averages t
     C                     ELSE
      * CASE: *OTHERWISE
      * Carcass Analysis Detail
     C                     EXSR UGSUBR                     Carcass Analysi
     C                     END                             *FI
      * Totals
     C                     EXSR UNSUBR                     Totals
      * Move cd fields to ca fields, and or zero out cd fields
      * CASE: PAR.Competitors Processing is Yes
     C           'N'       IFEQ 'Y'                        *IF
      * zero out cd ca fields
     C                     EXSR UOSUBR                     zero out cd ca
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.CD Payment Type is Live
     C           WBJ9ST    IFEQ 'L'                        *IF
      * move cd fields to cd ca fields
     C                     EXSR UPSUBR                     move cd fields
      * zero out cd fields
     C                     EXSR UQSUBR                     zero out cd fie
     C                     ELSE
      * CASE: PAR.CD Payment Type is Carcass Merit
     C           WBJ9ST    IFEQ 'C'                        *IF
      * CASE: PAR.CD Source Type is External
     C           WBKAST    IFEQ 'E'                        *IF
      * zero out cd ca fields
     C                     EXSR URSUBR                     zero out cd ca
      * Leave payment information in the CD fields
     C                     ELSE
      * CASE: PAR.CD Source Type is Internal
     C           WBKAST    IFEQ 'I'                        *IF
      * CASE: PAR.CM Processing Type Usr is Analysis
     C           'P'       IFEQ 'A'                        *IF
      * move cd fields to cd ca fields
     C                     EXSR USSUBR                     move cd fields
      * zero out cd fields
     C                     EXSR UTSUBR                     zero out cd fie
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update Production Library
      * CASE: PAR.Competitors Processing is No
     C           'N'       IFEQ 'N'                        *IF
      * Chg Carcass Detail 2  CH - Carcass Detail  * 
     C                     EXSR SUCHRC
     C                     END                             *FI
      * Create a record in QTEMP
      * CASE: PAR.Print Comp Sum/Dtl STS is Yes
     C           'N'       IFEQ 'Y'                        *IF
      * Crt Carcass Dtl QTEMP CR - Carcass Detail  * 
     C                     EXSR SVCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSG     READE@B1CPEF                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv CMP Payment Info3 RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAMCD           CMP Program Cod
      * Setup key
     C                     MOVELYL0014    WHAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSH     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUC6TX           CMP Description
     C                     MOVEL*BLANK    WN0199           CMP Grading Typ
     C                     MOVEL*BLANK    WN0200           CMP Sort Basis
     C                     MOVEL*BLANK    WN0202           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0203           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0204           CMP Lean Factor
     C                     MOVEL*BLANK    WN0205           CMP Optimal Row
     C                     MOVEL*BLANK    WN0206           CMP Type
     C                     Z-ADD*ZERO     WUI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WN0207           CMP % of Carcas
     C                     Z-ADD*ZERO     WN0208           CMP Fixed Cost
     C                     Z-ADD*ZERO     WN0209           CMP Grade Type
     C                     MOVEL*BLANK    WUZ2ST           CMP CLC Premium
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHA3TX    WUC6TX           CMP Description
     C                     MOVELWHDLST    WN0199           CMP Grading Typ
     C                     MOVELWHDMST    WN0200           CMP Sort Basis
     C                     MOVELWHDQST    WN0202           CMP Carc Wgt Ty
     C                     Z-ADDWHAZPC    WN0203           CMP Std Lean Pe
     C                     Z-ADDWHA0PC    WN0204           CMP Lean Factor
     C                     MOVELWHDTST    WN0205           CMP Optimal Row
     C                     MOVELWHF5ST    WN0206           CMP Type
     C                     Z-ADDWHI1PR    WUI1PR           CMP Market Add/
     C                     Z-ADDWHVEPR    WN0207           CMP % of Carcas
     C                     Z-ADDWHVFPR    WN0208           CMP Fixed Cost
     C                     Z-ADDWHVHPR    WN0209           CMP Grade Type
     C                     MOVELWHZ2ST    WUZ2ST           CMP CLC Premium
     C                     MOVELWHAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Carcass Merit Prog RT - Carcass Merit Prog MktGrp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAMCD    WQSI01           CMP Program Cod
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           CMP Program Cod
     C                     KFLD           WIGYDT           CMP Effect Purc
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           CMP Program Cod
      * Setup key
     C                     MOVELYL0014    WQSI01           CMP Program Cod
     C                     Z-ADDYL0051    WIGYDT           CMP Effect Purc
      * Establish starting position
     C           KPSSI     SETLL@BPCPSK                    *
     C           KRSSI     READE@BPCPSK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1291' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0051           CMP Effect Purc
     C                     MOVEL*BLANK    YL0052           CMP Commodity M
     C                     MOVEL*BLANK    YL0053           CMP Commodity G
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.CMP Effect Kill Date GE DB1.CMP Effect Kill Date
     C           YL0051    IFGE WIGYDT                     *IF
      * PAR = DB1 By name
     C                     Z-ADDWIGYDT    YL0051           CMP Effect Purc
     C                     MOVELWIPXCD    YL0052           CMP Commodity M
     C                     MOVELWIPYCD    YL0053           CMP Commodity G
     C                     GOTO SIEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.CMP Effect Kill Date LT DB1.CMP Effect Kill Date
     C           YL0051    IFLT WIGYDT                     *IF
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@BPCPSK                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv StdYl/SrtDsc/MdPt RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAMCD    WQSJ01           CMP Program Cod
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           CMP Program Cod
     C                     KFLD           WJEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           CMP Program Cod
      * Setup key
     C                     MOVELYL0014    WQSJ01           CMP Program Cod
     C                     Z-ADDWGEWNB    WJEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSSJ     SETLL@BYREJ9                    *
     C           KRSSJ     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0210           CMMR Row Number
     C                     Z-ADD*ZERO     WN0211           CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0214           CMMR Midpoint
     C                     Z-ADD*ZERO     WN0169           CD Sort Loss
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJE8NB    WN0210           CMMR Row Number
     C                     Z-ADDWJAQPC    WN0211           CMMR Std Dressi
     C                     Z-ADDWJLJA1    WN0214           CMMR Midpoint
     C                     Z-ADDWJEMNB    WN0169           CD Sort Loss
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAMCD    WQSK01           CMP Program Cod
     C           *LIKE     DEFN WKE8NB    WQSK02           CMMR Row Number
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           CMP Program Cod
     C                     KFLD           WQSK02           CMMR Row Number
     C                     KFLD           WKA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           CMP Program Cod
     C                     KFLD           WQSK02           CMMR Row Number
      * Setup key
     C                     MOVELYL0014    WQSK01           CMP Program Cod
     C                     Z-ADDWN0210    WQSK02           CMMR Row Number
     C                     Z-ADDWGAUPC    WKA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSK     SETLL@BZREKA                    *
     C           KRSSK     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0216           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWKERNB    WN0216           CMMC Premium Va
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAMCD    WQSL01           CMP Program Cod
     C           *LIKE     DEFN WLE8NB    WQSL02           CMMR Row Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           CMP Program Cod
     C                     KFLD           WQSL02           CMMR Row Number
      * Setup key
     C                     MOVELYL0014    WQSL01           CMP Program Cod
     C                     Z-ADDWN0210    WQSL02           CMMR Row Number
      * Establish starting position
     C           KRSSL     SETLL@BZREPO                    *
     C           KRSSL     READE@BZREPO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWLERNB    WN0216           CMMC Premium Va
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@BZREPO                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Optimal Midpoint  RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WMAMCD           CMP Program Cod
     C                     KFLD           WME8NB           CMMR Row Number
      * Setup key
     C                     MOVELYL0014    WMAMCD           CMP Program Cod
     C                     Z-ADDYL0058    WME8NB           CMMR Row Number
      * Establish starting position
     C           KRSSM     CHAIN@BYREGF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0059           CMMR Midpoint
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMLJA1    YL0059           CMMR Midpoint
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAMCD    WQSN01           CMP Program Cod
     C           *LIKE     DEFN WKE8NB    WQSN02           CMMR Row Number
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           CMP Program Cod
     C                     KFLD           WQSN02           CMMR Row Number
     C                     KFLD           WKA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           CMP Program Cod
     C                     KFLD           WQSN02           CMMR Row Number
      * Setup key
     C                     MOVELYL0014    WQSN01           CMP Program Cod
     C                     Z-ADDWN0210    WQSN02           CMMR Row Number
     C                     Z-ADDWN0215    WKA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSN     SETLL@BZREKA                    *
     C           KRSSN     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0216           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWKERNB    WN0216           CMMC Premium Va
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAMCD    WQSO01           CMP Program Cod
     C           *LIKE     DEFN WLE8NB    WQSO02           CMMR Row Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           CMP Program Cod
     C                     KFLD           WQSO02           CMMR Row Number
      * Setup key
     C                     MOVELYL0014    WQSO01           CMP Program Cod
     C                     Z-ADDWN0210    WQSO02           CMMR Row Number
      * Establish starting position
     C           KRSSO     SETLL@BZREPO                    *
     C           KRSSO     READE@BZREPO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWLERNB    WN0216           CMMC Premium Va
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@BZREPO                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv BckF Premium       RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAMCD    WQSP01           CMP Program Cod
     C           *LIKE     DEFN WOE8NB    WQSP02           CMMR Row Number
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           CMP Program Cod
     C                     KFLD           WQSP02           CMMR Row Number
     C                     KFLD           WOE7NB           CMMC Backfat In
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           CMP Program Cod
     C                     KFLD           WQSP02           CMMR Row Number
      * Setup key
     C                     MOVELYL0014    WQSP01           CMP Program Cod
     C                     Z-ADDWN0210    WQSP02           CMMR Row Number
     C                     Z-ADDWUVENB    WOE7NB           CMMC Backfat In
      * Establish starting position
     C           KPSSP     SETLL@BZRETM                    *
     C           KRSSP     READE@BZRETM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0216           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWOERNB    WN0216           CMMC Premium Va
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@BZRETM                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv BckF Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAMCD    WQSQ01           CMP Program Cod
     C           *LIKE     DEFN WRE8NB    WQSQ02           CMMR Row Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           CMP Program Cod
     C                     KFLD           WQSQ02           CMMR Row Number
      * Setup key
     C                     MOVELYL0014    WQSQ01           CMP Program Cod
     C                     Z-ADDWN0210    WQSQ02           CMMR Row Number
      * Establish starting position
     C           KRSSQ     SETLL@BZRETL                    *
     C           KRSSQ     READE@BZRETL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWRERNB    WN0216           CMMC Premium Va
     C                     GOTO SQEXIT                     *QUIT
     C           KRSSQ     READE@BZRETL                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAMCD    WQSR01           CMP Program Cod
     C           *LIKE     DEFN WKE8NB    WQSR02           CMMR Row Number
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WQSR01           CMP Program Cod
     C                     KFLD           WQSR02           CMMR Row Number
     C                     KFLD           WKA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           CMP Program Cod
     C                     KFLD           WQSR02           CMMR Row Number
      * Setup key
     C                     MOVELYL0014    WQSR01           CMP Program Cod
     C                     Z-ADDYL0058    WQSR02           CMMR Row Number
     C                     Z-ADDWGAUPC    WKA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSR     SETLL@BZREKA                    *
     C           KRSSR     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0061           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWKERNB    YL0061           CMMC Premium Va
     C                     GOTO SREXIT                     *QUIT
     C           KRSSR     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAMCD    WQSS01           CMP Program Cod
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS01           CMP Program Cod
     C                     KFLD           WJEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           CMP Program Cod
      * Setup key
     C                     MOVELYL0014    WQSS01           CMP Program Cod
     C                     Z-ADDWGEWNB    WJEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSSS     SETLL@BYREJ9                    *
     C           KRSSS     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0058           CMMR Row Number
     C                     Z-ADD*ZERO     YL0062           CMMR Std Dressi
     C                     Z-ADD*ZERO     YL0063           CD Sort Loss
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJE8NB    YL0058           CMMR Row Number
     C                     Z-ADDWJAQPC    YL0062           CMMR Std Dressi
     C                     Z-ADDWJEMNB    YL0063           CD Sort Loss
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAMCD    WQST01           CMP Program Cod
     C           *LIKE     DEFN WKE8NB    WQST02           CMMR Row Number
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           CMP Program Cod
     C                     KFLD           WQST02           CMMR Row Number
     C                     KFLD           WKA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           CMP Program Cod
     C                     KFLD           WQST02           CMMR Row Number
      * Setup key
     C                     MOVELYL0014    WQST01           CMP Program Cod
     C                     Z-ADDYL0058    WQST02           CMMR Row Number
     C                     Z-ADDWGAUPC    WKA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSST     SETLL@BZREKA                    *
     C           KRSST     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0064           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWKERNB    YL0064           CMMC Premium Va
     C                     GOTO STEXIT                     *QUIT
     C           KRSST     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Carcass Detail 2  CH - Carcass Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0218  51       CD Carcass/Hot
     C                     Z-ADD*ZERO     WN0219  31       CD Lean Percent
     C                     Z-ADD*ZERO     WN0220  60       CD Kill Time
     C                     MOVEL*BLANK    WN0221  1        CD Carcass Acti
     C                     Z-ADD*ZERO     WN0222  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0223  31       CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0224  31       CD Light Reflec
     C                     MOVEL*BLANK    WN0225  1        CD Trim Area
     C                     MOVEL*BLANK    WN0226  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0227  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0228  31       CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0229  31       CD Light Reflec
     C                     Z-ADD*ZERO     WN0230  31       CD Lean Percent
     C                     MOVEL*BLANK    WN0231  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0232  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0233  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0234  52       CD Backfat Inch
     C                     MOVEL*BLANK    WN0235  1        CD Broken Back
     C                     MOVEL*BLANK    WN0236  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0237  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0238  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0239  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0240 10        RS User Changed
     C                     Z-ADD*ZERO     WN0241  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0242  60       RS Time Changed
     C                     MOVEL*BLANK    WN0243  1        RS Record Statu
     C                     MOVEL*BLANK    WN0244 10        RS Job
     C                     MOVEL*BLANK    WN0245 10        RS Program
     C                     MOVEL*BLANK    WN0246 10        RS User Added
     C                     Z-ADD*ZERO     WN0247  70       RS Date Added
     C                     Z-ADD*ZERO     WN0248  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B1CPG6
     C                     Z-ADDWGHMNB    WSHMNB           BOH Company Num
     C                     Z-ADDWGBNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    WSBONB           BOL Load Number
     C                     Z-ADDWGCVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    WSB0DT           TH Kill Date
     C                     Z-ADDWGLGNB    WSLGNB           CD Scale Sequen
     C                     Z-ADDWGEUNB    WSEUNB           CD Carcass Numb
     C                     Z-ADDWGLHNB    WSLHNB           CD Carcass Numb
      *
     C           KLCHSU    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
     C                     KFLD           WSLGNB           CD Scale Sequen
     C                     KFLD           WSEUNB           CD Carcass Numb
     C                     KFLD           WSLHNB           CD Carcass Numb
     C           KLCHSU    CHAIN@B1CPG6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB1CPL0'MDACP
     C                     MOVEL'@B1CPG6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKB11    YBRDCS
      * Move non-key fields to @B1CPG6
     C                     MOVELWGINST    WSINST    P      CD Record Add/D
     C                     Z-ADDWN0169    WSBEPR           CD Sort Loss
     C                     Z-ADDWN0170    WSASPC           CD STD Yield
     C                     Z-ADDWN0171    WSB4PR           CD Base Carcass
     C                     Z-ADDWN0172    WSEYNB           CD Crc Value Pe
     C                     Z-ADDWN0173    WSB1PR           CD Base Carc Va
     C                     Z-ADDWN0174    WSAVPR           CD Crc Value $
     C                     Z-ADDWN0176    WSAWPR           CD Lean Premium
     C                     Z-ADDWN0177    WSAXPR           CD Lean Premium
     C                     Z-ADDWN0178    WSEZNB           CD Gross Value
     C                     Z-ADDWN0179    WSAYPR           CD Gross Value
     C                     Z-ADDWGBBDT    WSBBDT           CD Kill Date
     C                     MOVELWGIQST    WSIQST    P      CD Shift
     C                     Z-ADDWGBHPC    WSBHPC           CD FFLI
     C                     MOVELWGIOST    WSIOST    P      CD Record Creat
     C                     MOVELWGIPST    WSIPST    P      CD Record Creat
     C                     Z-ADDWGLTNB    WSLTNB           CD LOT
     C                     MOVELWGJNST    WSJNST    P      CD User Error O
     C                     MOVELWBKAST    WSK2ST    P      CD Source Type
     C                     MOVELWBJ9ST    WSK3ST    P      CD Payment Type
     C                     Z-ADDWN0181    WSJWPR           CD CA Sort Loss
     C                     Z-ADDWN0182    WSF5PC           CD CA Std Yield
     C                     Z-ADDWN0183    WSJXPR           CD CA Base Carc
     C                     Z-ADDWN0184    WSJYPR           CD CA Crc Value
     C                     Z-ADDWN0185    WSJZPR           CD CA Base Carc
     C                     Z-ADDWN0186    WSJ0PR           CD CA Crc Value
     C                     Z-ADDWN0187    WSJ1PR           CD CA Lean Prem
     C                     Z-ADDWN0188    WSJ2PR           CD CA Lean Prem
     C                     Z-ADDWN0189    WSJ3PR           CD CA Gross Val
     C                     Z-ADDWN0190    WSJ4PR           CD CA Gross Val
     C                     Z-ADDWN0191    WSIJGR           CD Meat Value F
     C                     Z-ADDWN0192    WSORJE           CD Lean Prem/Di
     C                     Z-ADDWN0193    WSOTJR           CD Fixed Cost F
     C                     Z-ADDWN0194    WSPEIR           CD MPR Sort Los
     C                     Z-ADDWN0195    WSIEUF           CD Meat Value F
     C                     Z-ADDWN0196    WSORUE           CD Fixed Cost F
     C                     Z-ADDWN0197    WSIUTR           CD Gross Before
     C                     Z-ADDWN0198    WSIJRR           CD Gross Before
     C                     MOVELWGABCD    WSABCD    P      PD Producer Cod
     C                     MOVELWGAACD    WSAACD    P      SR Source Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WSAAVN           RS User Changed
     C                     Z-ADD##JDT     WSAADT           RS Date Changed
     C                     Z-ADD##JTM     WSAMTM           RS Time Changed
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL##PGM     WSAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B1CPG6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKB1CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Crt Carcass Dtl QTEMP CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPVI
     C                     Z-ADDWGHMNB    WTHMNB           BOH Company Num
     C                     Z-ADDWGBNNB    WTBNNB           BOH Buy Order N
     C                     Z-ADDWGBONB    WTBONB           BOL Load Number
     C                     Z-ADDWGCVNB    WTCVNB           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    WTB0DT           TH Kill Date
     C                     Z-ADDWGLGNB    WTLGNB           CD Scale Sequen
     C                     Z-ADDWGEUNB    WTEUNB           CD Carcass Numb
     C                     Z-ADDWGLHNB    WTLHNB           CD Carcass Numb
     C                     MOVELWGINST    WTINST           CD Record Add/D
     C                     Z-ADDWN0169    WTBEPR           CD Sort Loss
     C                     Z-ADDWN0170    WTASPC           CD STD Yield
     C                     Z-ADDWGEWNB    WTEWNB           CD Carcass/Hot
     C                     Z-ADDWN0171    WTB4PR           CD Base Carcass
     C                     Z-ADDWN0172    WTEYNB           CD Crc Value Pe
     C                     Z-ADDWN0173    WTB1PR           CD Base Carc Va
     C                     Z-ADDWN0174    WTAVPR           CD Crc Value $
     C                     Z-ADDWGAUPC    WTAUPC           CD Lean Percent
     C                     Z-ADDWN0176    WTAWPR           CD Lean Premium
     C                     Z-ADDWN0177    WTAXPR           CD Lean Premium
     C                     Z-ADDWN0178    WTEZNB           CD Gross Value
     C                     Z-ADDWN0179    WTAYPR           CD Gross Value
     C                     Z-ADDWGBBDT    WTBBDT           CD Kill Date
     C                     Z-ADDWGAKTM    WTAKTM           CD Kill Time
     C                     MOVELWGIQST    WTIQST           CD Shift
     C                     MOVELWGEFST    WTEFST           CD Carcass Acti
     C                     Z-ADDWGH6NB    WTH6NB           CD Backfat Thic
     C                     Z-ADDWGBEPC    WTBEPC           CD Loin-Eye Dep
     C                     Z-ADDWGGCST    WTGCST           CD Light Reflec
     C                     MOVELWGGDST    WTGDST           CD Trim Area
     C                     MOVELWGGEST    WTGEST           CD Carcass Sex
     C                     Z-ADDWGBHPC    WTBHPC           CD FFLI
     C                     MOVELWGIOST    WTIOST           CD Record Creat
     C                     MOVELWGIPST    WTIPST           CD Record Creat
     C                     Z-ADDWGLTNB    WTLTNB           CD LOT
     C                     MOVELWGJNST    WTJNST           CD User Error O
     C                     Z-ADDWGX4NB    WTX4NB           CD Backfat Thic
     C                     Z-ADDWGFNPC    WTFNPC           CD Loin-Eye Dep
     C                     Z-ADDWGFOPC    WTFOPC           CD Light Reflec
     C                     Z-ADDWGFPPC    WTFPPC           CD Lean Percent
     C                     MOVELWBKAST    WTK2ST           CD Source Type
     C                     MOVELWGK3ST    WTK3ST           CD Payment Type
     C                     Z-ADDWN0181    WTJWPR           CD CA Sort Loss
     C                     Z-ADDWN0182    WTF5PC           CD CA Std Yield
     C                     Z-ADDWN0183    WTJXPR           CD CA Base Carc
     C                     Z-ADDWN0184    WTJYPR           CD CA Crc Value
     C                     Z-ADDWN0185    WTJZPR           CD CA Base Carc
     C                     Z-ADDWN0186    WTJ0PR           CD CA Crc Value
     C                     Z-ADDWN0187    WTJ1PR           CD CA Lean Prem
     C                     Z-ADDWN0188    WTJ2PR           CD CA Lean Prem
     C                     Z-ADDWN0189    WTJ3PR           CD CA Gross Val
     C                     Z-ADDWN0190    WTJ4PR           CD CA Gross Val
     C                     MOVELWGUTST    WTUTST           CD Adjust/Add T
     C                     MOVELWGHVCD    WTHVCD           CD Producer Loc
     C                     Z-ADDWGDKJR    WTDKJR           CD Loin Eye Inc
     C                     Z-ADDWGITJF    WTITJF           CD Backfat Inch
     C                     Z-ADDWGIJGR    WTIJGR           CD Meat Value F
     C                     Z-ADDWGORJE    WTORJE           CD Lean Prem/Di
     C                     Z-ADDWGOTJR    WTOTJR           CD Fixed Cost F
     C                     Z-ADDWGPEIR    WTPEIR           CD MPR Sort Los
     C                     Z-ADDWGIEUF    WTIEUF           CD Meat Value F
     C                     Z-ADDWGORUE    WTORUE           CD Fixed Cost F
     C                     Z-ADDWGIUTR    WTIUTR           CD Gross Before
     C                     Z-ADDWGIJRR    WTIJRR           CD Gross Before
     C                     MOVELWGVCST    WTVCST           CD Broken Back
     C                     MOVELWGVDST    WTVDST           CD Adjust/Add S
     C                     MOVELWGVEST    WTVEST           CD Unused Sts 3
     C                     MOVELWGVFST    WTVFST           CD Unused Sts 4
     C                     MOVELWGVGST    WTVGST           CD Unused Sts 5
     C                     MOVELWGABCD    WTABCD           PD Producer Cod
     C                     MOVELWGAACD    WTAACD           SR Source Code
     C                     MOVELWGAAVN    WTAAVN           RS User Changed
     C                     Z-ADDWGAADT    WTAADT           RS Date Changed
     C                     Z-ADDWGAMTM    WTAMTM           RS Time Changed
     C                     MOVELWGAJST    WTAJST           RS Record Statu
     C                     MOVELWGAHVN    WTAHVN           RS Job
     C                     MOVELWGAGVN    WTAGVN           RS Program
     C                     MOVELWGABVN    WTABVN           RS User Added
     C                     Z-ADDWGABDT    WTABDT           RS Date Added
     C                     Z-ADDWGABTM    WTABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WTAJST           RS Record Statu
     C                     MOVEL##USR     WTABVN           RS User Added
     C                     Z-ADD##JDT     WTABDT           RS Date Added
     C                     Z-ADD##JTM     WTABTM           RS Time Added
     C                     MOVEL##PGM     WTAGVN           RS Program
     C                     MOVEL##JOB     WTAHVN           RS Job
     C           KLCRSV    KLIST
     C                     KFLD           WTHMNB           BOH Company Num
     C                     KFLD           WTBNNB           BOH Buy Order N
     C                     KFLD           WTBONB           BOL Load Number
     C                     KFLD           WTCVNB           TH Tattoo Numbe
     C                     KFLD           WTB0DT           TH Kill Date
     C                     KFLD           WTLGNB           CD Scale Sequen
     C                     KFLD           WTEUNB           CD Carcass Numb
     C                     KFLD           WTLHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSV    SETLL@B1CPVI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPVI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Upd VC Gross Val /Hd  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSW01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSW02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSW03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSW04           TH Tattoo Numbe
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WQSW02           BOH Buy Order N
     C                     KFLD           WQSW03           BOL Load Number
     C                     KFLD           WQSW04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHMNB    WQSW01           BOH Company Num
     C                     Z-ADDYL0001    WQSW02           BOH Buy Order N
     C                     Z-ADDYL0002    WQSW03           BOL Load Number
     C                     Z-ADDYL0003    WQSW04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSW     SETLL@A1CPC4                    *
     C           KRSSW     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg VC Gross Val /Hd  CH - Tattoo Header  * 
     C                     EXSR SXCHRC
     C           KRSSW     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg VC Gross Val /Hd  CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0249  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0250 10        TH Group Refere
     C                     MOVEL*BLANK    WN0251  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0252  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0253  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0254  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0255  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0256  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0257  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0258  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0259  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0260  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0261  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0262  50       TH Held Over
     C                     Z-ADD*ZERO     WN0263  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0264  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0265  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0266  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0267  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0268  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0269  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0270  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0271  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0272  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0273  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0274  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0275  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0276  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0277  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0278  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0279  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0280  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0281  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0282  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0283  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0284  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0285  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0286  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0287  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0288  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0289  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0290  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0291  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0292  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0293  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0294  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0295  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0296  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0297  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0298  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0299  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0300  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0301  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0302  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0303  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0304  1        TH Header Error
     C                     MOVEL*BLANK    WN0305  1        TH Detail Error
     C                     MOVEL*BLANK    WN0306  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0307  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0308  80       TH Commission A
     C                     Z-ADD*ZERO     WN0309  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0310  1        TH User Error O
     C                     MOVEL*BLANK    WN0311  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0312  1        TH Sex
     C                     Z-ADD*ZERO     WN0313  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0314  70       TH Commission P
     C                     Z-ADD*ZERO     WN0315  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0316  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0317  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0318  31       TH FFLI
     C                     Z-ADD*ZERO     WN0319  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0320  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0321  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0322  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0323  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0324  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0325  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0326  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0327  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0328  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0329  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0330  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0331  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0332  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0333  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0334  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0335  1        TH Source Type
     C                     MOVEL*BLANK    WN0336  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0337  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0338  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0339  3        TH Source Code
     C                     MOVEL*BLANK    WN0340  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0341  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0342  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0343  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0344  3        TH State
     C                     MOVEL*BLANK    WN0345  3        TH Unused Code
     C                     MOVEL*BLANK    WN0346  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0347  1        TH Commission S
     C                     MOVEL*BLANK    WN0348  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0349  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0350  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0351  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0352  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0353  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0354  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0355  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0356  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0357  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0358  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0359  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0360  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0361  3        TH PHA Average
     C                     MOVEL*BLANK    WN0362  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0363  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0364  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0365  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0366  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0367  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0368  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0369  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0370  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0371  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0372  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0373  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0374 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0375 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0376 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0377 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0378  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0379  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0380  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0381  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0382  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0383  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0384  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0385  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0386  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0387  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0388  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0389  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0390  70       TH Unused Date
     C                     MOVEL*BLANK    WN0391  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0392  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0393  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0394  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0395  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0396  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0397  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0398  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0399  6        DF Defect Code
     C                     MOVEL*BLANK    WN0400  6        THP Process Cod
     C                     MOVEL*BLANK    WN0401  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0402  6        PL Location Cod
     C                     MOVEL*BLANK    WN0403  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0404  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0405  3        HC Class Code
     C                     MOVEL*BLANK    WN0406 10        RS User Changed
     C                     Z-ADD*ZERO     WN0407  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0408  60       RS Time Changed
     C                     MOVEL*BLANK    WN0409  1        RS Record Statu
     C                     MOVEL*BLANK    WN0410 10        RS Job
     C                     MOVEL*BLANK    WN0411 10        RS Program
     C                     MOVEL*BLANK    WN0412 10        RS User Added
     C                     Z-ADD*ZERO     WN0413  70       RS Date Added
     C                     Z-ADD*ZERO     WN0414  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHSX    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHSX    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YCRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDYL0004    WDTAPR           TH VC Gross Val
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Clc CrMr/Ft/Da/Nt RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUDUNB           Last BOH BuyOrd
     C                     Z-ADD*ZERO     WUDVNB           Last BOL Load n
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVHMNB    WQSY01           BOH Company Num
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HONB    WQSY01           BOH Company Num
      * Establish starting position
     C           KRSSY     SETLL@A1CPV3                    *
     C           KRSSY     READE@A1CPV3                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Proc Ttt if Kill date is <= to Payment date for Carcass, or = for
      * CASE: Unpaid
      *  - (c1 AND c2) OR (c3ANDc4)
      *   |- c1    : DB1.TH Kill Date LE PAR.Pmt Current Payment Date
      *   |- c2    : DB1.TH Payment Sts is Unpaid Producer
      *   |- c3    : DB1.TH Kill Date EQ PAR.Pmt Current Payment Date
      *   |- c4    : DB1.TH Payment Sts is Live anything
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WVB0DT    IFLE P3CKDT                     *IF
     C           WVCWST    IFEQ 'ML'                       *IF
     C           WVCWST    OREQ 'SL'
     C           WVCWST    OREQ 'SC'
     C           WVCWST    OREQ 'IC'
     C           WVCWST    OREQ 'IL'
     C           WVCWST    OREQ *BLANK
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WVB0DT    IFEQ P3CKDT                     *IF
     C           WVCWST    IFEQ 'ML'                       *IF
     C           WVCWST    OREQ 'PL'
     C           WVCWST    OREQ 'NL'
     C           WVCWST    OREQ 'SL'
     C           WVCWST    OREQ 'IL'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: Held Over Not Complete | Not Balanced & Sub/Mrkt
      *  - (c1 AND c2) OR (c3 AND c4)
      *   |- c1    : DB1.TH Held Over is greater than 0
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   |- c3    : DB1.TH Kill Balancing Sts is Not Balanced Carcass
      *   |- c4    : DB1.TH Hog Class Type is Not Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WVH9NB    IFGT 0                          *IF
     C           WVBSDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WVDWST    IFEQ 'E'                        *IF
     C           WVDWST    OREQ *BLANK
     C           WVLLST    IFEQ 'M'                        *IF
     C           WVLLST    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PK0166 -Purva
     C                     ELSE
      * CASE: *OTHERWISE
      * Break in BOL
      * CASE: DB1.TH Payment Sts is Paid Anything
     C           WVCWST    IFEQ 'PL'                       *IF
     C           WVCWST    OREQ 'PC'
     C           WVCWST    OREQ 'NC'
     C           WVCWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
      * Break in BOL, delete unpaid Tattoo D/A's for the load
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.BOH Buy Order Number NE WRK.Last BOH BuyOrder Nb
      *   |- c2    : DB1.BOL Load Number NE WRK.Last BOL Load number  USR
      *   '-
     C           WVBNNB    IFNE WUDUNB                     *IF
     C           WVBONB    ORNE WUDVNB                     *OR
     C                     Z-ADDWVBNNB    WUDUNB           Last BOH BuyOrd
     C                     Z-ADDWVBONB    WUDVNB           Last BOL Load n
      * Dlt Tattoo D/A Unpaid XF - Tattoo Ded/Add  * 
     C                     CALL 'PKFPXFR'              90  Dlt Tattoo D/A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0037  30       BOH Company Num
     C                     PARM WVBNNB    WQ0038  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0039  50       BOL Load Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKFPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWVTAPR    YL0066           TH VC Gross Val
      * Live & Carcass Merit Payment.
      * CASE: DB1.TH Payment Sts is Live anything
     C           WVCWST    IFEQ 'ML'                       *IF
     C           WVCWST    OREQ 'PL'
     C           WVCWST    OREQ 'NL'
     C           WVCWST    OREQ 'SL'
     C           WVCWST    OREQ 'IL'
      *
     C                     MOVEL*BLANK    WN0415  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0416  5        PSC Sub-Contrac
     C                     Z-ADD*ZERO     WN0417  52       PSC FLoor Price
     C                     MOVEL*BLANK    WN0418  1        PSC Sub-Contrac
      *
      * Clc CrMrt/Frt/DA/NetLV IF
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      * Rtv Hog Class         RT - Hog Classification  * 
     C                     EXSR SZRVGN
      * Market and head kill greater then zero
      * Carcass Merit processing
      * CASE: WRK.HC Class Type is Market
     C           WUFBST    IFEQ 'M'                        *IF
      * *Retrieve Purchase Price calculation information.
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
     C                     EXSR TARVGN
      * Retrieve Sub-Contract information.
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
     C                     EXSR TBRVGN
      * Analysis/Payment
      * CASE: PAR.TH Payment Type is Live
     C           WVJ9ST    IFEQ 'L'                        *IF
      * Analysis
     C                     EXSR UUSUBR                     Analysis
     C                     ELSE
      * CASE: PAR.TH Payment Type is Carcass Merit
     C           WVJ9ST    IFEQ 'C'                        *IF
      * The above conditions is never true.
      * CASE: PAR.TH Source Type is Internal
     C           WVKAST    IFEQ 'I'                        *IF
      * Analysis
     C                     EXSR UVSUBR                     Analysis
     C                     END                             *FI
      * Payments
     C                     EXSR UWSUBR                     Payments
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Allocation of Freight
     C                     EXSR UXSUBR                     Allocation of F
      * CASE: PAR.TH Payment Sts is Paid Anything
     C           WVCWST    IFEQ 'PL'                       *IF
     C           WVCWST    OREQ 'PC'
     C           WVCWST    OREQ 'NC'
     C           WVCWST    OREQ 'NL'
     C                     MOVEL'P'       WUJGST           Ded/Add/Net Pay
      * Clc Ded/Add/Net Pay   XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKREXFR'              90  Clc Ded/Add/Net
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0188  30       BOH Company Num
     C                     PARM WVBNNB    WQ0189  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0190  50       BOL Load Number
     C                     PARM WVCVNB    WQ0191  50       TH Tattoo Numbe
     C                     PARM WVB0DT    WQ0192  70       TH Kill Date
     C                     PARM WUJGST    WQ0193  1        Ded/Add/Net Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKREXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Second time to create da
     C                     MOVEL'C'       WUJGST           Ded/Add/Net Pay
      * Clc Ded/Add/Net Pay   XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKREXFR'              90  Clc Ded/Add/Net
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0194  30       BOH Company Num
     C                     PARM WVBNNB    WQ0195  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0196  50       BOL Load Number
     C                     PARM WVCVNB    WQ0197  50       TH Tattoo Numbe
     C                     PARM WVB0DT    WQ0198  70       TH Kill Date
     C                     PARM WUJGST    WQ0199  1        Ded/Add/Net Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKREXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Payment Sts is Unpaid Producer
     C           WVCWST    IFEQ 'ML'                       *IF
     C           WVCWST    OREQ 'SL'
     C           WVCWST    OREQ 'SC'
     C           WVCWST    OREQ 'IC'
     C           WVCWST    OREQ 'IL'
     C           WVCWST    OREQ *BLANK
      * Clc CrMrt/Frt/DA/Net  IF
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      * Rtv Hog Class         RT - Hog Classification  * 
     C                     EXSR TDRVGN
      * Market and head kill greater then zero
      * Carcass Merit processing
      * CASE: WRK.HC Class Type is Market
     C           WUFBST    IFEQ 'M'                        *IF
      * CASE: PAR.TH Payment Sts is Live anything
     C           WVCWST    IFEQ 'ML'                       *IF
     C           WVCWST    OREQ 'PL'
     C           WVCWST    OREQ 'NL'
     C           WVCWST    OREQ 'SL'
     C           WVCWST    OREQ 'IL'
     C                     ELSE
      * CASE: *OTHERWISE
      * Carcass/Market only
      * *Retrieve Purchase Price calculation information.
      * 1/28/2008 SLM CHANGE ON NOT FOUND TO PASS BACK CON VALUE
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
     C                     EXSR TERVGN
      * 1/28/2008 SLM CHANGE ON NOT FOUND TO PASS BACK CON VALUE
      * Retrieve Sub-Contract information.
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
     C                     EXSR TFRVGN
      * Chg Tattoo Summary    CH - Tattoo Header  * 
     C                     EXSR TGCHRC
      * CASE: PAR.TH Payment Type is Live
     C           WVJ9ST    IFEQ 'L'                        *IF
      * The above condition will never be true. PKP/SLM
      * Analysis
     C                     EXSR UYSUBR                     Analysis
     C                     ELSE
      * CASE: PAR.TH Payment Type is Carcass Merit
     C           WVJ9ST    IFEQ 'C'                        *IF
      * *****************
      * Commented 01/31/97 for C2343. Per Rick Hoffman
      * We are not going through Analysis because it will be the same
      * as what we are going to pay now.
      * ****
      * If Pork decides to make the Average Competitor the Analysis,
      * this case would be uncommented.  See Clc Carcass Analysis  XF
      * for further instructions.  PKD/SLM
      * *****************
      * Payment
     C                     EXSR UZSUBR                     Payment
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Tattoo Summary    CH - Tattoo Header  * 
     C                     EXSR TICHRC
     C                     END                             *FI
      * Freight
     C                     EXSR NASUBR                     Freight
      * CASE: PAR.TH Payment Sts is Paid Anything
     C           WVCWST    IFEQ 'PL'                       *IF
     C           WVCWST    OREQ 'PC'
     C           WVCWST    OREQ 'NC'
     C           WVCWST    OREQ 'NL'
     C                     MOVEL'P'       WUJGST           Ded/Add/Net Pay
      * Clc Ded/Add/Net Pay   XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKREXFR'              90  Clc Ded/Add/Net
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0310  30       BOH Company Num
     C                     PARM WVBNNB    WQ0311  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0312  50       BOL Load Number
     C                     PARM WVCVNB    WQ0313  50       TH Tattoo Numbe
     C                     PARM WVB0DT    WQ0314  70       TH Kill Date
     C                     PARM WUJGST    WQ0315  1        Ded/Add/Net Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKREXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Second time to create da
     C                     MOVEL'C'       WUJGST           Ded/Add/Net Pay
      * Clc Ded/Add/Net Pay   XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKREXFR'              90  Clc Ded/Add/Net
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0316  30       BOH Company Num
     C                     PARM WVBNNB    WQ0317  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0318  50       BOL Load Number
     C                     PARM WVCVNB    WQ0319  50       TH Tattoo Numbe
     C                     PARM WVB0DT    WQ0320  70       TH Kill Date
     C                     PARM WUJGST    WQ0321  1        Ded/Add/Net Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKREXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSY     READE@A1CPV3                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Hog Class         RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WWBECD           HC Class Code
      * Setup key
     C                     MOVELWVBECD    WWBECD           HC Class Code
      * Establish starting position
     C           KRSSZ     CHAIN@A8REDA              90    *
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWWBDTX    WUBDTX           HC Description
     C                     MOVELWWBXST    WUBXST           HC Defect Requi
     C                     MOVELWWBYST    WUBYST           HC Price Requir
     C                     MOVELWWBITX    WUBITX           HC Resolution
     C                     MOVELWWB0ST    WUB0ST           HC Qualificatio
     C                     MOVELWWFBST    WUFBST           HC Class Type
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWVHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWVBNNB    WEBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSTA     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * 1/28/08 SLM LEFT OVER INFORMATION MAY HAVE CAUSED ISSUES
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAAPR           BOH Market Add/
     C                     MOVEL*BLANK    WUB3ST           BOH Quote Price
     C                     Z-ADD*ZERO     WUALPR           BOH Quoted Base
     C                     MOVEL*BLANK    WUETCD           BOH Commodity M
     C                     MOVEL*BLANK    WUEUCD           BOH Commodity P
     C                     MOVEL*BLANK    WUJ5TX           BOH Market Date
     C                     MOVEL*BLANK    WUAKCD           PC Contract Cod
     C                     MOVEL*BLANK    WUALCD           PSC Sub-Contrac
     C                     MOVEL*BLANK    WUAICD           PO Option Code
     C                     MOVEL*BLANK    WUAMCD           CMP Program Cod
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAAPR    WUAAPR           BOH Market Add/
     C                     MOVELWEB3ST    WUB3ST           BOH Quote Price
     C                     Z-ADDWEALPR    WUALPR           BOH Quoted Base
     C                     MOVELWEETCD    WUETCD           BOH Commodity M
     C                     MOVELWEEUCD    WUEUCD           BOH Commodity P
     C                     MOVELWEJ5TX    WUJ5TX           BOH Market Date
     C                     MOVELWEAKCD    WUAKCD           PC Contract Cod
     C                     MOVELWEALCD    WUALCD           PSC Sub-Contrac
     C                     MOVELWEAICD    WUAICD           PO Option Code
     C                     MOVELWEAMCD    WUAMCD           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WFAKCD           PC Contract Cod
     C                     KFLD           WFALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWUAKCD    WFAKCD           PC Contract Cod
     C                     MOVELWUALCD    WFALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSTB     CHAIN@AQCPA0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAZPR           PSC Floor Price
     C                     Z-ADD*ZERO     WUA0PR           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WUA9PC           PSC Market Perc
     C                     Z-ADD*ZERO     WUA7PR           PSC Break Even
     C                     Z-ADD*ZERO     WUA8PR           PSC FLoor Price
     C                     MOVEL*BLANK    WUF3ST           PSC Sub-Contrac
     C                     Z-ADD*ZERO     WUA9PR           PSC Mkt Percent
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFAZPR    WUAZPR           PSC Floor Price
     C                     Z-ADDWFA0PR    WUA0PR           PSC Ceiling Pri
     C                     Z-ADDWFA9PC    WUA9PC           PSC Market Perc
     C                     Z-ADDWFA7PR    WUA7PR           PSC Break Even
     C                     Z-ADDWFA8PR    WUA8PR           PSC FLoor Price
     C                     MOVELWFF3ST    WUF3ST           PSC Sub-Contrac
     C                     Z-ADDWFA9PR    WUA9PR           PSC Mkt Percent
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0419  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0420 10        TH Group Refere
     C                     MOVEL*BLANK    WN0421  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0422  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0423  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0424  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0425  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0426  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0427  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0428  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0429  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0430  50       TH Held Over
     C                     Z-ADD*ZERO     WN0431  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0432  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0433  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0434  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0435  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0436  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0437  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0438  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0439  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0440  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0441  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0442  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0443  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0444  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0445  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0446  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0447  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0448  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0449  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0450  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0451  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0452  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0453  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0454  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0455  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0456  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0457  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0458  1        TH Header Error
     C                     MOVEL*BLANK    WN0459  1        TH Detail Error
     C                     MOVEL*BLANK    WN0460  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0461  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0462  80       TH Commission A
     C                     Z-ADD*ZERO     WN0463  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0464  1        TH User Error O
     C                     MOVEL*BLANK    WN0465  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0466  1        TH Sex
     C                     Z-ADD*ZERO     WN0467  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0468  70       TH Commission P
     C                     Z-ADD*ZERO     WN0469  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0470  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0471  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0472  31       TH FFLI
     C                     Z-ADD*ZERO     WN0473  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0474  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0475  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0476  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0477  1        TH Source Type
     C                     MOVEL*BLANK    WN0478  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0479  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0480  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0481  3        TH Source Code
     C                     MOVEL*BLANK    WN0482  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0483  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0484  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0485  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0486  3        TH State
     C                     MOVEL*BLANK    WN0487  3        TH Unused Code
     C                     MOVEL*BLANK    WN0488  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0489  1        TH Commission S
     C                     MOVEL*BLANK    WN0490  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0491  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0492  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0493  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0494  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0495  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0496  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0497  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0498  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0499  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0500  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0501  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0502  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0503  3        TH PHA Average
     C                     MOVEL*BLANK    WN0504  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0505  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0506  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0507  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0508  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0509  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0510  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0511  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0512  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0513  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0514  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0515  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0516  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0517 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0518 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0519 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0520 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0521  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0522  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0523  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0524  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0525  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0526  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0527  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0528  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0529  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0530  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0531  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0532  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0533  70       TH Unused Date
     C                     MOVEL*BLANK    WN0534  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0535  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0536  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0537  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0538  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0539  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0540  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0541  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0542  6        DF Defect Code
     C                     MOVEL*BLANK    WN0543  6        THP Process Cod
     C                     MOVEL*BLANK    WN0544  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0545  6        PL Location Cod
     C                     MOVEL*BLANK    WN0546  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0547  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0548  3        HC Class Code
     C                     MOVEL*BLANK    WN0549 10        RS User Changed
     C                     Z-ADD*ZERO     WN0550  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0551  60       RS Time Changed
     C                     MOVEL*BLANK    WN0552  1        RS Record Statu
     C                     MOVEL*BLANK    WN0553 10        RS Job
     C                     MOVEL*BLANK    WN0554 10        RS Program
     C                     MOVEL*BLANK    WN0555 10        RS User Added
     C                     Z-ADD*ZERO     WN0556  70       RS Date Added
     C                     Z-ADD*ZERO     WN0557  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWVHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWVBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWVBONB    WDBONB           BOL Load Number
     C                     Z-ADDWVCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWVB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHTC    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHTC    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YDRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWVB9PR    WDB9PR           TH Live Gross A
     C                     Z-ADDWVCAPR    WDCAPR           TH LIve Net Amt
     C                     Z-ADDWVAVPC    WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADDWVCBPR    WDCBPR           TH Payment Gros
     C                     Z-ADDWVCCPR    WDCCPR           Th Payment Net
     C                     Z-ADDWVLPNB    WDLPNB           TH AP Voucher/D
     C                     Z-ADDWVCDPR    WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Hog Class         RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WWBECD           HC Class Code
      * Setup key
     C                     MOVELWVBECD    WWBECD           HC Class Code
      * Establish starting position
     C           KRSTD     CHAIN@A8REDA              90    *
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWWBDTX    WUBDTX           HC Description
     C                     MOVELWWBXST    WUBXST           HC Defect Requi
     C                     MOVELWWBYST    WUBYST           HC Price Requir
     C                     MOVELWWBITX    WUBITX           HC Resolution
     C                     MOVELWWB0ST    WUB0ST           HC Qualificatio
     C                     MOVELWWFBST    WUFBST           HC Class Type
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWVHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWVBNNB    WEBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSTE     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * 1/28/08 SLM LEFT OVER INFORMATION MAY HAVE CAUSED ISSUES
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAAPR           BOH Market Add/
     C                     MOVEL*BLANK    WUB3ST           BOH Quote Price
     C                     Z-ADD*ZERO     WUALPR           BOH Quoted Base
     C                     MOVEL*BLANK    WUETCD           BOH Commodity M
     C                     MOVEL*BLANK    WUEUCD           BOH Commodity P
     C                     MOVEL*BLANK    WUJ5TX           BOH Market Date
     C                     MOVEL*BLANK    WUAKCD           PC Contract Cod
     C                     MOVEL*BLANK    WUALCD           PSC Sub-Contrac
     C                     MOVEL*BLANK    WUAICD           PO Option Code
     C                     MOVEL*BLANK    WUAMCD           CMP Program Cod
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAAPR    WUAAPR           BOH Market Add/
     C                     MOVELWEB3ST    WUB3ST           BOH Quote Price
     C                     Z-ADDWEALPR    WUALPR           BOH Quoted Base
     C                     MOVELWEETCD    WUETCD           BOH Commodity M
     C                     MOVELWEEUCD    WUEUCD           BOH Commodity P
     C                     MOVELWEJ5TX    WUJ5TX           BOH Market Date
     C                     MOVELWEAKCD    WUAKCD           PC Contract Cod
     C                     MOVELWEALCD    WUALCD           PSC Sub-Contrac
     C                     MOVELWEAICD    WUAICD           PO Option Code
     C                     MOVELWEAMCD    WUAMCD           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WFAKCD           PC Contract Cod
     C                     KFLD           WFALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWUAKCD    WFAKCD           PC Contract Cod
     C                     MOVELWUALCD    WFALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSTF     CHAIN@AQCPA0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAZPR           PSC Floor Price
     C                     Z-ADD*ZERO     WUA0PR           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WUA9PC           PSC Market Perc
     C                     Z-ADD*ZERO     WUA7PR           PSC Break Even
     C                     Z-ADD*ZERO     WUA8PR           PSC FLoor Price
     C                     MOVEL*BLANK    WUF3ST           PSC Sub-Contrac
     C                     Z-ADD*ZERO     WUA9PR           PSC Mkt Percent
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFAZPR    WUAZPR           PSC Floor Price
     C                     Z-ADDWFA0PR    WUA0PR           PSC Ceiling Pri
     C                     Z-ADDWFA9PC    WUA9PC           PSC Market Perc
     C                     Z-ADDWFA7PR    WUA7PR           PSC Break Even
     C                     Z-ADDWFA8PR    WUA8PR           PSC FLoor Price
     C                     MOVELWFF3ST    WUF3ST           PSC Sub-Contrac
     C                     Z-ADDWFA9PR    WUA9PR           PSC Mkt Percent
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0558  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0559 10        TH Group Refere
     C                     MOVEL*BLANK    WN0560  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0561  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0562  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0563  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0564  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0565  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0566  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0567  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0568  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0569  50       TH Held Over
     C                     Z-ADD*ZERO     WN0570  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0571  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0572  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0573  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0574  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0575  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0576  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0577  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0578  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0579  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0580  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0581  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0582  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0583  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0584  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0585  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0586  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0587  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0588  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0589  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0590  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0591  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0592  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0593  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0594  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0595  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0596  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0597  1        TH Header Error
     C                     MOVEL*BLANK    WN0598  1        TH Detail Error
     C                     MOVEL*BLANK    WN0599  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0600  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0601  80       TH Commission A
     C                     Z-ADD*ZERO     WN0602  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0603  1        TH User Error O
     C                     MOVEL*BLANK    WN0604  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0605  1        TH Sex
     C                     Z-ADD*ZERO     WN0606  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0607  70       TH Commission P
     C                     Z-ADD*ZERO     WN0608  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0609  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0610  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0611  31       TH FFLI
     C                     Z-ADD*ZERO     WN0612  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0613  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0614  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0615  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0616  1        TH Source Type
     C                     MOVEL*BLANK    WN0617  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0618  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0619  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0620  3        TH Source Code
     C                     MOVEL*BLANK    WN0621  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0622  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0623  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0624  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0625  3        TH State
     C                     MOVEL*BLANK    WN0626  3        TH Unused Code
     C                     MOVEL*BLANK    WN0627  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0628  1        TH Commission S
     C                     MOVEL*BLANK    WN0629  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0630  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0631  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0632  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0633  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0634  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0635  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0636  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0637  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0638  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0639  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0640  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0641  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0642  3        TH PHA Average
     C                     MOVEL*BLANK    WN0643  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0644  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0645  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0646  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0647  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0648  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0649  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0650  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0651  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0652  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0653  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0654  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0655  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0656 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0657 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0658 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0659 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0660  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0661  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0662  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0663  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0664  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0665  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0666  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0667  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0668  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0669  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0670  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0671  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0672  70       TH Unused Date
     C                     MOVEL*BLANK    WN0673  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0674  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0675  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0676  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0677  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0678  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0679  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0680  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0681  6        DF Defect Code
     C                     MOVEL*BLANK    WN0682  6        THP Process Cod
     C                     MOVEL*BLANK    WN0683  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0684  6        PL Location Cod
     C                     MOVEL*BLANK    WN0685  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0686  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0687  3        HC Class Code
     C                     MOVEL*BLANK    WN0688 10        RS User Changed
     C                     Z-ADD*ZERO     WN0689  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0690  60       RS Time Changed
     C                     MOVEL*BLANK    WN0691  1        RS Record Statu
     C                     MOVEL*BLANK    WN0692 10        RS Job
     C                     MOVEL*BLANK    WN0693 10        RS Program
     C                     MOVEL*BLANK    WN0694 10        RS User Added
     C                     Z-ADD*ZERO     WN0695  70       RS Date Added
     C                     Z-ADD*ZERO     WN0696  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWVHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWVBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWVBONB    WDBONB           BOL Load Number
     C                     Z-ADDWVCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWVB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHTG    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHTG    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YERDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWVB9PR    WDB9PR           TH Live Gross A
     C                     Z-ADDWVCAPR    WDCAPR           TH LIve Net Amt
     C                     Z-ADDWVAVPC    WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADDWVCBPR    WDCBPR           TH Payment Gros
     C                     Z-ADDWVCCPR    WDCCPR           Th Payment Net
     C                     Z-ADDWVLPNB    WDLPNB           TH AP Voucher/D
     C                     Z-ADDWVCDPR    WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0697  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0698 10        TH Group Refere
     C                     MOVEL*BLANK    WN0699  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0700  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0701  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0702  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0703  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0704  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0705  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0706  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0707  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0708  50       TH Held Over
     C                     Z-ADD*ZERO     WN0709  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0710  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0711  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0712  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0713  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0714  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0715  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0716  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0717  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0718  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0719  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0720  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0721  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0722  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0723  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0724  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0725  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0726  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0727  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0728  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0729  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0730  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0731  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0732  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0733  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0734  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0735  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0736  1        TH Header Error
     C                     MOVEL*BLANK    WN0737  1        TH Detail Error
     C                     MOVEL*BLANK    WN0738  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0739  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0740  80       TH Commission A
     C                     Z-ADD*ZERO     WN0741  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0742  1        TH User Error O
     C                     MOVEL*BLANK    WN0743  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0744  1        TH Sex
     C                     Z-ADD*ZERO     WN0745  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0746  70       TH Commission P
     C                     Z-ADD*ZERO     WN0747  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0748  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0749  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0750  31       TH FFLI
     C                     Z-ADD*ZERO     WN0751  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0752  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0753  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0754  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0755  1        TH Source Type
     C                     MOVEL*BLANK    WN0756  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0757  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0758  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0759  3        TH Source Code
     C                     MOVEL*BLANK    WN0760  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0761  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0762  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0763  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0764  3        TH State
     C                     MOVEL*BLANK    WN0765  3        TH Unused Code
     C                     MOVEL*BLANK    WN0766  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0767  1        TH Commission S
     C                     MOVEL*BLANK    WN0768  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0769  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0770  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0771  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0772  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0773  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0774  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0775  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0776  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0777  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0778  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0779  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0780  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0781  3        TH PHA Average
     C                     MOVEL*BLANK    WN0782  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0783  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0784  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0785  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0786  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0787  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0788  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0789  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0790  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0791  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0792  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0793  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0794  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0795 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0796 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0797 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0798 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0799  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0800  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0801  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0802  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0803  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0804  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0805  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0806  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0807  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0808  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0809  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0810  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0811  70       TH Unused Date
     C                     MOVEL*BLANK    WN0812  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0813  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0814  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0815  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0816  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0817  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0818  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0819  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0820  6        DF Defect Code
     C                     MOVEL*BLANK    WN0821  6        THP Process Cod
     C                     MOVEL*BLANK    WN0822  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0823  6        PL Location Cod
     C                     MOVEL*BLANK    WN0824  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0825  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0826  3        HC Class Code
     C                     MOVEL*BLANK    WN0827 10        RS User Changed
     C                     Z-ADD*ZERO     WN0828  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0829  60       RS Time Changed
     C                     MOVEL*BLANK    WN0830  1        RS Record Statu
     C                     MOVEL*BLANK    WN0831 10        RS Job
     C                     MOVEL*BLANK    WN0832 10        RS Program
     C                     MOVEL*BLANK    WN0833 10        RS User Added
     C                     Z-ADD*ZERO     WN0834  70       RS Date Added
     C                     Z-ADD*ZERO     WN0835  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWVHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWVBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWVBONB    WDBONB           BOL Load Number
     C                     Z-ADDWVCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWVB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHTH    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHTH    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YFRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWVB9PR    WDB9PR           TH Live Gross A
     C                     Z-ADDWVCAPR    WDCAPR           TH LIve Net Amt
     C                     Z-ADDWVAVPC    WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADDWVCBPR    WDCBPR           TH Payment Gros
     C                     Z-ADDWVCCPR    WDCCPR           Th Payment Net
     C                     Z-ADDWVLPNB    WDLPNB           TH AP Voucher/D
     C                     Z-ADDWVCDPR    WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0836  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0837 10        TH Group Refere
     C                     MOVEL*BLANK    WN0838  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0839  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0840  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0841  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0842  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0843  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0844  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0845  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0846  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0847  50       TH Held Over
     C                     Z-ADD*ZERO     WN0848  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0849  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0850  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0851  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0852  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0853  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0854  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0855  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0856  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0857  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0858  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0859  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0860  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0861  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0862  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0863  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0864  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0865  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0866  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0867  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0868  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0869  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0870  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0871  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0872  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0873  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0874  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0875  1        TH Header Error
     C                     MOVEL*BLANK    WN0876  1        TH Detail Error
     C                     MOVEL*BLANK    WN0877  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0878  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0879  80       TH Commission A
     C                     Z-ADD*ZERO     WN0880  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0881  1        TH User Error O
     C                     MOVEL*BLANK    WN0882  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0883  1        TH Sex
     C                     Z-ADD*ZERO     WN0884  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0885  70       TH Commission P
     C                     Z-ADD*ZERO     WN0886  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0887  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0888  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0889  31       TH FFLI
     C                     Z-ADD*ZERO     WN0890  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0891  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0892  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0893  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0894  1        TH Source Type
     C                     MOVEL*BLANK    WN0895  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0896  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0897  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0898  3        TH Source Code
     C                     MOVEL*BLANK    WN0899  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0900  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0901  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0902  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0903  3        TH State
     C                     MOVEL*BLANK    WN0904  3        TH Unused Code
     C                     MOVEL*BLANK    WN0905  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0906  1        TH Commission S
     C                     MOVEL*BLANK    WN0907  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0908  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0909  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0910  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0911  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0912  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0913  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0914  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0915  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0916  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0917  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0918  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0919  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0920  3        TH PHA Average
     C                     MOVEL*BLANK    WN0921  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0922  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0923  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0924  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0925  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0926  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0927  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0928  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0929  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0930  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0931  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0932  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0933  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0934 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0935 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0936 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0937 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0938  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0939  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0940  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0941  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0942  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0943  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0944  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0945  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0946  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0947  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0948  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0949  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0950  70       TH Unused Date
     C                     MOVEL*BLANK    WN0951  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0952  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0953  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0954  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0955  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0956  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0957  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0958  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0959  6        DF Defect Code
     C                     MOVEL*BLANK    WN0960  6        THP Process Cod
     C                     MOVEL*BLANK    WN0961  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0962  6        PL Location Cod
     C                     MOVEL*BLANK    WN0963  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0964  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0965  3        HC Class Code
     C                     MOVEL*BLANK    WN0966 10        RS User Changed
     C                     Z-ADD*ZERO     WN0967  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0968  60       RS Time Changed
     C                     MOVEL*BLANK    WN0969  1        RS Record Statu
     C                     MOVEL*BLANK    WN0970 10        RS Job
     C                     MOVEL*BLANK    WN0971 10        RS Program
     C                     MOVEL*BLANK    WN0972 10        RS User Added
     C                     Z-ADD*ZERO     WN0973  70       RS Date Added
     C                     Z-ADD*ZERO     WN0974  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWVHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWVBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWVBONB    WDBONB           BOL Load Number
     C                     Z-ADDWVCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWVB0DT    WDB0DT           TH Kill Date
      *
     C           KLCHTI    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLCHTI    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YGRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWVB9PR    WDB9PR           TH Live Gross A
     C                     Z-ADDWVCAPR    WDCAPR           TH LIve Net Amt
     C                     Z-ADDWVAVPC    WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADDWVCBPR    WDCBPR           TH Payment Gros
     C                     Z-ADDWVCCPR    WDCCPR           Th Payment Net
     C                     Z-ADDWVLPNB    WDLPNB           TH AP Voucher/D
     C                     Z-ADDWVCDPR    WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E3814 JJH 10/07/15 - Recompile because PS Premises ID added to
      *   Producer Site. - No logic changes.
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *                       length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Initialize Total Fields
      *================================================================
     C                     Z-ADD*ZERO     YL0026           Head Total USR
     C                     Z-ADD*ZERO     YL0027           Sort Loss Tot U
     C                     Z-ADD*ZERO     YL0028           Std Yield % Tot
     C                     Z-ADD*ZERO     YL0029           Weight Tot USR
     C                     Z-ADD*ZERO     YL0034           Base Carc Val T
     C                     Z-ADD*ZERO     YL0030           Adj Base Carc V
     C                     Z-ADD*ZERO     YL0031           Lean Percent To
     C                     Z-ADD*ZERO     YL0032           Lean Add/Ded Va
     C                     Z-ADD*ZERO     YL0033           Total Carc Val
     C                     Z-ADD*ZERO     YL0050           TH MPR Sort Los
     C                     Z-ADD*ZERO     YL0037           Gross Before So
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * comments
      *================================================================
      * 12/15/06 PKD If Grading Type is Meat Value, then retrieve the
      *              USDA Pork Cutout Price for the Meav Value Factor.
      * 11/12/13 slm chnges per TF
      *              pull the mrk and the group from the Cmp mkt/grp
      *              need this for Triumph Foods  - Meat Value
      *              created nw file to hold this data
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * move db1 ca fields to par ca fields
      *================================================================
     C                     Z-ADDWGJWPR    WN0181           CD CA Sort Loss
     C                     Z-ADDWGF5PC    WN0182           CD CA Std Yield
     C                     Z-ADDWGJXPR    WN0183           CD CA Base Carc
     C                     Z-ADDWGJYPR    WN0184           CD CA Crc Value
     C                     Z-ADDWGJZPR    WN0185           CD CA Base Carc
     C                     Z-ADDWGJ0PR    WN0186           CD CA Crc Value
     C                     Z-ADDWGJ1PR    WN0187           CD CA Lean Prem
     C                     Z-ADDWGJ2PR    WN0188           CD CA Lean Prem
     C                     Z-ADDWGJ3PR    WN0189           CD CA Gross Val
     C                     Z-ADDWGJ4PR    WN0190           CD CA Gross Val
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * move db1 CD fields to par CD fields
      *================================================================
     C                     Z-ADDWGBEPR    WN0169           CD Sort Loss
     C                     Z-ADDWN0211    WN0170           CD STD Yield
     C                     Z-ADDWGB4PR    WN0171           CD Base Carcass
     C                     Z-ADDWGEYNB    WN0172           CD Crc Value Pe
     C                     Z-ADDWGB1PR    WN0173           CD Base Carc Va
     C                     Z-ADDWGAVPR    WN0174           CD Crc Value $
     C                     Z-ADDWGAWPR    WN0176           CD Lean Premium
     C                     Z-ADDWGAXPR    WN0177           CD Lean Premium
     C                     Z-ADDWGEZNB    WN0178           CD Gross Value
     C                     Z-ADDWGAYPR    WN0179           CD Gross Value
     C                     Z-ADDWGIUTR    WN0197           CD Gross Before
     C                     Z-ADDWGIJRR    WN0198           CD Gross Before
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Move Averages to Cd fields before extension or totals are accum
      *================================================================
     C                     Z-ADDWUKWPR    WN0169           CD Sort Loss
     C                     Z-ADDWUF9PC    WN0170           CD STD Yield
     C                     Z-ADDWUKRPR    WN0171           CD Base Carcass
     C                     Z-ADDWUKUPR    WN0172           CD Crc Value Pe
     C                     Z-ADDWUKSPR    WN0176           CD Lean Premium
     C                     Z-ADDWUKXPR    WN0178           CD Gross Value
      * RE EXTENDED
      * CD Base Carc Value
      * PAR.CD Base Carc Value =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0171    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0173           CD Base Carc Va
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0172    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0174           CD Crc Value $
      * CD LEAN PREM $ Per Hd
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0176    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0177           CD Lean Premium
     C           WN0174    ADD  WN0177    WN0179           CD Gross Value
     C           WN0172    ADD  WN0176    WN0178           CD Gross Value
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Carcass Analysis Detail
      *================================================================
      * Rtv StdYl/SrtDsc/MdPt RT - Carcass Merit Matrix Row  * 
     C                     EXSR SJRVGN
      * Commented out 12/16/98 PKD.
      * CD Base Carcass CWT  12/16/98 PKD
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           YL0024    IFEQ 'LW'                       *IF
      * CASE: PAR.CMMR Std Dressing Yield% is ne 0
     C           WN0211    IFNE 0                          *IF
      * CD Base Carcass CWT
      * PAR.CD Base Carcass CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WN0211    DIV  100       W0WD01    H      *Synon (17,7) w
     C           YL0022    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0171           CD Base Carcass
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0171           CD Base Carcass
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           YL0024    IFEQ 'CW'                       *IF
     C                     Z-ADDYL0022    WN0171           CD Base Carcass
     C                     END                             *FI
     C                     END                             *FI
      * CD Base Carc Value
      * PAR.CD Base Carc Value =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0171    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0173           CD Base Carc Va
      * Commented out 12/16/98 PKD.
      * CASE: WRK.CMP CLC Premium First is Sort First
     C           WUZ2ST    IFEQ *BLANK                     *IF
      * CAS: Calc CD Crc Value Per CWT w/ Quote Type.   08/03/95 PKP
      * CASE: PAR.CMP Sort Basis is Live
     C           WN0200    IFEQ 'L'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           YL0024    IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + x2) / (x3 / x4))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           YL0022    ADD  WN0169    W0WA01           *Synon (15,2) w
     C           WN0211    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WA01    DIV  W0WD02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0172           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           YL0024    IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + (x2 / (x3 / x4)))
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           WN0211    DIV  100       W0WD02    H      *Synon (17,7) w
     C           WN0169    DIV  W0WD02    W0WB01    H      *Synon (15,5) w
     C           WN0171    ADD  W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0172           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is Meat
     C           WN0200    IFEQ 'M'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           YL0024    IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT NEW
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + (x2 * (x3 / x4))) / (x5 / x6))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x5    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
     C           WN0211    DIV  100       W0WB03    H      *Synon (15,5) w
     C           WN0169    MULT W0WB03    W0WA02    H      *Synon (15,2) w
     C           YL0022    ADD  W0WA02    W0WA01           *Synon (15,2) w
     C           WN0211    DIV  100       W0WB04    H      *Synon (15,5) w
     C           W0WA01    DIV  W0WB04    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0172           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           YL0024    IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
     C           WN0171    ADD  WN0169    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0172           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is % of Base Price
     C           WN0200    IFEQ 'P'                        *IF
      * 06/20/05 PKD HPE011 Add calculation for Sort Loss based on
      *              percent of base.
      * CD Crc Value Per CWT
      * LCL.*Synon (15,5) work field =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0169    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0171    MULT W0WB01    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0057           *Synon (15,5) w
     C           YL0057    MULT 1         WN0172    H      CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is None
     C           WN0200    IFEQ *BLANK                     *IF
     C                     Z-ADDWN0171    WN0172           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * A = TH CM Base Market Price or CD Base Carcass CWT
     C                     Z-ADDWN0171    WN0172           CD Crc Value Pe
     C                     END                             *FI
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0172    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0174           CD Crc Value $
      * 10/23/2007 CMP Grade Type Adj will be used on the Back Fat
      * Grade/Premium
      * CASE: PAR.CMP Grading Type is Ln%N/SrtDscF/FltCrc/MtVal
     C           WN0199    IFEQ 'C'                        *IF
     C           WN0199    OREQ 'D'
     C           WN0199    OREQ 'L'
     C           WN0199    OREQ 'S'
     C           WN0199    OREQ 'M'
      * 06/20/05 PKD HPE011 Added Meat Value to Conditoin
      * LEAN PERCENT NPPC or SORT DISCOUNT FACTOR or FLAT CARCASS WEIGHT
     C                     EXSR UHSUBR                     LEAN PERCENT NP
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Lean Percent FOM
     C           WN0199    IFEQ 'P'                        *IF
      * LEAN PERCENT  FAT O METER
     C                     EXSR UKSUBR                     LEAN PERCENT  F
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Backfat
     C           WN0199    IFEQ 'B'                        *IF
      * Backfat
     C                     EXSR ULSUBR                     Backfat
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Lean Factor
     C           WN0199    IFEQ 'F'                        *IF
      * Lean Factor
     C                     EXSR UMSUBR                     Lean Factor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Sort after premium.  re-calc gross
      * CASE: WRK.CMP CLC Premium First is Premium First
     C           WUZ2ST    IFEQ 'P'                        *IF
     C                     Z-ADDWN0178    WN0197           CD Gross Before
     C                     Z-ADDWN0179    WN0198           CD Gross Before
      * CASE: PAR.CD Sort Loss is 100%
     C           WN0169    IFEQ 100                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * New Gross after Sort
      * Gross After Sort
      * LCL.*Synon (15,5) work field =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Before Sort CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0169    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0197    MULT W0WB01    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0057           *Synon (15,5) w
     C           YL0057    MULT 1         WN0178    H      CD Gross Value
      * Total Gross Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0178    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0179           CD Gross Value
     C                     END                             *FI
      * New Carcas Value
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + (x2 - x3))
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x3    : PAR.CD Gross Before Sort CWT
     C           WN0178    SUB  WN0197    W0WA01           *Synon (15,2) w
     C           WN0171    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0172           CD Crc Value Pe
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 + (x2 - x3))
      * x1    : PAR.CD Base Carc Value
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x3    : PAR.CD Gross Before Sort /HD
     C           WN0179    SUB  WN0198    W0WA01           *Synon (15,2) w
     C           WN0173    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0174           CD Crc Value $
     C                     END                             *FI
     C                     Z-ADDWN0211    WN0170           CD STD Yield
      * Calc MPR Sort Loss            5/23/03    -- Change 10/11/17 S1186
      * Calc MPR Sort Loss   5/23/03   - chg 01/15/07 for "M" cmp grading
      * CASE: PAR.CMP Optimal Row Nbr f/srt NE WRK.Blank Usr 1 fld Usr
     C           WN0205    IFNE WUIXTX                     *IF
     C                     MOVE WN0205    YL0060           Num NU USR
     C                     Z-ADDYL0060    YL0058           CMMR Row Number
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SRRVGN
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
     C                     EXSR SSRVGN
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR STRVGN
     C           YL0064    SUB  YL0061    YL0065           Sort Total %
      * CASE: PAR.CMP Grading Type is Lean Percent NPPC $Prem
     C           WN0199    IFEQ 'D'                        *IF
      * If grading type is D , the lean premium values are dollars $
      * Comp: CD Mpr Sort Loss-D
      * PAR.CD MPR Sort Loss =
      *    *COMPUTE ((x1 - x2) *(x3/x4))
      * x1    : LCL.CMMC Premium Value
      * -     : PGM.*Synon (17,7) work field
      * x2    : LCL.Optimal Lean Percent USR
      * *     : PGM.*Synon (17,7) work field *
      * x3    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
     C           YL0064    SUB  YL0061    W0WD01           *Synon (17,7) w
     C           WGEWNB    DIV  100       W0WD02           *Synon (17,7) w
     C           W0WD01    MULT W0WD02    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0194           CD MPR Sort Los
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WN0199    IFEQ 'M'                        *IF
      * If grading type is M , take diff cac value $hd - base value   01/
     C           WN0174    SUB  WN0173    WN0194           CD MPR Sort Los
     C                     ELSE
      * CASE: *OTHERWISE
      * Original Calc done for all grading types         06/28/04
      * Comp: CD Mpr Sort Loss
      * PAR.CD MPR Sort Loss =
      *    *COMPUTE ((x1 * x4)* (x2/x3))
      * x1    : LCL.Sort Total %
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (17,7) work field *
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0065    MULT WN0171    W0WD01           *Synon (17,7) w
     C           WGEWNB    DIV  100       W0WD02           *Synon (17,7) w
     C           W0WD01    MULT W0WD02    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0194           CD MPR Sort Los
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  WN0194    YL0050           TH MPR Sort Los
      * (note--sort loss s/be negative.)
     C                     ELSE
      * CASE: *OTHERWISE
      * Comp: CD Mpr Sort Loss
      * PAR.CD MPR Sort Loss =
      *    *COMPUTE ((x1 - x2))
      * x1    : PAR.CD Crc Value $ Per Hd
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Base Carc Value
     C           WN0174    SUB  WN0173    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0194           CD MPR Sort Los
     C                     ADD  WN0194    YL0050           TH MPR Sort Los
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * LEAN PERCENT NPPC or SORT DISCOUNT FACTOR or FLAT CARCASS WEIGHT
      *================================================================
      * 031606 slm added the meat value for TF Changes on Prd Avgs
      * CASE: Added Crc @ Historical Avg Hot wgt & avg Ln%
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.CD Adjust/Add Type is Producer Historical Avg
      *   |- c2    : PAR.Competitors Processing is No
      *   |- c3    : PAR.CM Processing Type Usr is Payment
      *   |- c4    : PAR.CMP Grading Type is Not Meat Value
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WGUTST    IFEQ 'HST'                      *IF
     C           WGUTST    OREQ '2WK'
     C           WGUTST    OREQ '4WK'
     C           WGUTST    OREQ 'LOT'
     C           'N'       IFEQ 'N'                        *IF
     C           'P'       IFEQ 'P'                        *IF
     C           WN0199    IFEQ 'B'                        *IF
     C           WN0199    OREQ 'C'
     C           WN0199    OREQ 'G'
     C           WN0199    OREQ 'F'
     C           WN0199    OREQ 'P'
     C           WN0199    OREQ 'D'
     C           WN0199    OREQ 'L'
     C           WN0199    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** PAID WITH HISTORY **
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.CMP Grading Type is Lean Percent NPPC
      *   |- c2    : PAR.CMP Grading Type is Meat Value
      *   '-
     C           WN0199    IFEQ 'D'                        *IF
     C           WN0199    OREQ 'L'
     C           WN0199    OREQ 'M'                        *OR
      * 06/20/05 PKD HPE011 Added Meat Value to the condition.
     C                     Z-ADDWBS9PR    WN0176           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WB01           *Synon (15,5) w
     C           WN0176    MULT W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0177           CD Lean Premium
     C           WN0172    ADD  WN0176    WN0178           CD Gross Value
     C           WN0174    ADD  WN0177    WN0179           CD Gross Value
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Flat Carcass Weight
     C           WN0199    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     WN0176           CD Lean Premium
     C                     Z-ADD*ZERO     WN0177           CD Lean Premium
     C           WN0172    ADD  WN0176    WN0178           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0178    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0179           CD Gross Value
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Sort Discount Factor
     C           WN0199    IFEQ 'S'                        *IF
      * **** Pay by Factory.  ****
     C           WBOMVJ    DIV  100       WN0216    H      CMMC Premium Va
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0172    MULT WN0216    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0178           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0178    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0179           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0178    SUB  WN0172    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0176           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0179    SUB  WN0174    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0177           CD Lean Premium
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: Paid with Average Value of Lot
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.CD Adjust/Add Type is Add w/Average Value
      *   |- c2    : PAR.Competitors Processing is No
      *   |- c3    : PAR.CM Processing Type Usr is Payment
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WGUTST    IFEQ 'ADD'                      *IF
     C           'N'       IFEQ 'N'                        *IF
     C           'P'       IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** ADDED AT AVERAGE VALUE OF THE LOT **
     C                     Z-ADD*ZERO     WN0176           CD Lean Premium
     C                     Z-ADD*ZERO     WN0177           CD Lean Premium
     C                     Z-ADD*ZERO     WN0178           CD Gross Value
     C                     Z-ADD*ZERO     WN0179           CD Gross Value
     C                     ELSE
      * CASE: *OTHERWISE
      * ** CALCULATE LEAN PREMIUM **
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SKRVGN
      * Rtv Lean% Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      * Lean Percent NPPC $Prem OR Meat Value *OTHERWISE
      * CASE: PAR.CMP Grading Type is Lean Percent NPPC $Prem
     C           WN0199    IFEQ 'D'                        *IF
     C                     Z-ADDWN0216    WN0176           CD Lean Premium
      * CD Lean Premium $ Per Hd
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0176    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0177           CD Lean Premium
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value $ Per Hd
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium $ Per Hd
     C           WN0174    ADD  WN0177    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0179           CD Gross Value
      * Total Carcass Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.CD Lean Premium CWT
     C           WN0172    ADD  WN0176    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0178           CD Gross Value
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WN0199    IFEQ 'M'                        *IF
      * Meat Value Calculation
     C                     EXSR UISUBR                     Meat Value Calc
     C                     ELSE
      * CASE: *OTHERWISE
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0172    MULT WN0216    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0178           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0178    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0179           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0178    SUB  WN0172    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0176           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0179    SUB  WN0174    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0177           CD Lean Premium
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Meat Value Calculation
      *================================================================
      * 06/20/05 PKD HPE011 Added Meat Value calculation
      * DOC:  Lean Premium Percent
     C                     EXSR UJSUBR                     DOC:  Lean Prem
     C                     Z-ADD*ZERO     YL0058           CMMR Row Number
     C                     MOVE WN0205    YL0058           CMMR Row Number
      * Rtv Optimal Midpoint  RT - Carcass Merit Matrix Row  * 
     C                     EXSR SMRVGN
      * 08/23/05 PKD Checking Midpoint to make sure they are entered.
     C                     Z-ADDWN0216    WN0192           CD Lean Prem/Di
      * CD Lean Premium $ Per Hd
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE ((x1 * (x4/x5)) * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x4    : PAR.CD Lean Prem/Disc Factor
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x5    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0192    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WN0171    MULT W0WB02    W0WB01    H      *Synon (15,5) w
     C           WGEWNB    DIV  100       W0WB03    H      *Synon (15,5) w
     C           W0WB01    MULT W0WB03    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0177           CD Lean Premium
      * CD Lean Premuim CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.CD Lean Premium $ Per Hd
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0177    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0176           CD Lean Premium
      * 12/15/06 PKD Below calculation uses the Base Price.
      * 12/15/06 PKD Use USDA Pork Cutout instead of the Base Price.
      *              USDA Pork Cutout = LCL.Market Prc Hog/Cutout USR
      *              pull the mrk and goup from the cmp market/group see
      * CD Fixed Cost Factor %
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.CMMR Midpoint is Entered
      *   |- c2    : PAR.CMMR Midpoint is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0059    IFGT 0                          *IF
     C           WN0214    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * FIXED COST
      * CD Fixed Cost Factor %
      * PAR.CD Fixed Cost Factor % =
      *    *COMPUTE ((((x3/x4-x3/x5)/x6)*x9))
      * x3    : PAR.CMP Fixed Cost Per Head
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : LCL.CMMR Midpoint
      * -     : PGM.*Synon (15,5) work field
      * x3    : PAR.CMP Fixed Cost Per Head
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x5    : PAR.CMMR Midpoint
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : LCL.Market Prc Hog/Cutout USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x9    : CON.100
     C           WN0208    DIV  YL0059    W0WB03    H      *Synon (15,5) w
     C           WN0208    DIV  WN0214    W0WB04    H      *Synon (15,5) w
     C           W0WB03    SUB  W0WB04    W0WB02           *Synon (15,5) w
     C           W0WB02    DIV  YL0056    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0193           CD Fixed Cost F
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0193           CD Fixed Cost F
     C                     END                             *FI
      * CD Fixed Cost Factor Amt
      * PAR.CD Fixed Cost Factor Amt =
      *    *COMPUTE (x1 * ((x2/x3) * (x5/x6)))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Fixed Cost Factor %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x5    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
     C           WN0193    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WGEWNB    DIV  100       W0WB03    H      *Synon (15,5) w
     C           W0WB02    MULT W0WB03    W0WB01    H      *Synon (15,5) w
     C           WN0171    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0196           CD Fixed Cost F
      * CD Meat Value Factor %
      * PAR.CD Meat Value Factor % =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : PAR.CD Sort Loss
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Fixed Cost Factor %
      * +     : PGM.*Synon (15,2) work field
      * x3    : PAR.CD Lean Prem/Disc Factor
     C           WN0169    ADD  WN0193    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WN0192    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0191           CD Meat Value F
      * CD Meat Value Factor Amt
      * PAR.CD Meat Value Factor Amt =
      *    *COMPUTE ((x1 * ((x2/x7) - x4) * (x5 / x6)) * x8)
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Meat Value Factor %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x7    : CON.100
      * -     : PGM.*Synon (15,5) work field
      * x4    : CON.1
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x5    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x8    : CON.1
     C           WN0191    DIV  100       W0WB04    H      *Synon (15,5) w
     C           W0WB04    SUB  1         W0WB03           *Synon (15,5) w
     C           WN0171    MULT W0WB03    W0WB02    H      *Synon (15,5) w
     C           WGEWNB    DIV  100       W0WB05    H      *Synon (15,5) w
     C           W0WB02    MULT W0WB05    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 1         W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0195           CD Meat Value F
      * CD Gross Value $ Per HD
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE ((x1 * (x2 / x3)) * (x4 / x5))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Meat Value Factor %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x5    : CON.100
     C           WN0191    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WN0171    MULT W0WB02    W0WB01    H      *Synon (15,5) w
     C           WGEWNB    DIV  100       W0WB03    H      *Synon (15,5) w
     C           W0WB01    MULT W0WB03    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0179           CD Gross Value
      * CD Gross Value Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.CD Gross Value $ Per HD
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0179    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0178           CD Gross Value
      * ****************
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * DOC:  Lean Premium Percent
      *================================================================
      * Lean Prem% = ((A * (B/100)) + (((C/D) - (C/E)) / F) + (G/100))
      * WHERE:
      * A = Starting Point (100)
      * B = Sort Loss Percent
      * C = Fixed Cost Per Head
      * D = Optimal Weight Range Midpoint
      * E = Weight Range Midpoint
      * F = Base Market Price
      * G = Lean Premium & Discount Percent
      * 12/15/06 PKD Current:  F=Base Market Price
      *                  New:  F=USDA Pork Cutout
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * LEAN PERCENT  FAT O METER
      *================================================================
      * ---------------------------------------------------------------
      * Added 6/11/99 by Purva for C0007557.
      * Add Lean Factor/Lean % +/- to Lean Percent MM
      * CASE: PAR.CMP Lean Factor is Greater than 0
     C           WN0204    IFGT 0                          *IF
     C           WGFPPC    ADD  WN0204    WN0215           CMMC Lean Perce
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWGFPPC    WN0215           CMMC Lean Perce
     C                     END                             *FI
      * ---------------------------------------------------------------
     C                     Z-ADD*ZERO     WN0216           CMMC Premium Va
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SNRVGN
      * Rtv Lean% Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SORVGN
     C                     END                             *FI
      * Add the meat premium
      * Total Carcass Per CWT add
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.CMMC Premium Value
     C           WN0172    ADD  WN0216    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0178           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0178    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0179           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0178    SUB  WN0172    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0176           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0179    SUB  WN0174    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0177           CD Lean Premium
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Backfat
      *================================================================
      * 10/23/2007 * out the hard code CMP Grade Type Adj
      *              and replace with value form the CMP Grade Backfat
     C           WGH6NB    ADD  WN0209    WUVENB           Backfat USR
      * Rtv BckF Premium       RT - Carcass Merit Matrix Col  * 
     C                     EXSR SPRVGN
      * Rtv Bckf Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv BckF Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
      * *---------------------------------------------------------------*
      * * 05/15/02 PKD Commented out.  The Backfat calculation needs
      *                to work similar to Lean Percent.
      * Lean Premium Value
      * Lean Premium Per Cwt
      * Gross Value Per cwt
      * Gross Value $
      * *---------------------------------------------------------------*
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0172    MULT WN0216    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0178           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0178    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0179           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0178    SUB  WN0172    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0176           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0179    SUB  WN0174    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0177           CD Lean Premium
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Lean Factor
      *================================================================
      * Diff actual/Std Lean%
      * PAR.CMMC Premium Value =
      *    *COMPUTE ((x1 - x2) / x3)
      * x1    : DB1.CD Lean Percent
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.CMP Std Lean Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WGAUPC    SUB  WN0203    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0216           CMMC Premium Va
      * multiple by lean factor
      * PAR.CMMC Premium Value =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : PAR.CMMC Premium Value
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.CMP Lean Factor
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0216    MULT WN0204    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0216           CMMC Premium Va
      * Lean Premium Per Cwt
     C           WN0216    MULT YL0022    WN0176    H      CD Lean Premium
      * Lean Premium Value
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE ((x1 * (x2 / x3)))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WGEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0176    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0177           CD Lean Premium
      * Gross Value Per cwt
      * Total Carcass Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium CWT
     C           WN0172    ADD  WN0176    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0178           CD Gross Value
      * Gross Value $
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value $ Per Hd
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium $ Per Hd
     C           WN0174    ADD  WN0177    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0179           CD Gross Value
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Totals
      *================================================================
     C                     ADD  1         YL0026           Head Total USR
     C                     ADD  WN0169    YL0027           Sort Loss Tot U
     C                     ADD  WN0170    YL0028           Std Yield % Tot
     C                     ADD  WGEWNB    YL0029           Weight Tot USR
     C                     ADD  WN0173    YL0034           Base Carc Val T
     C                     ADD  WN0174    YL0030           Adj Base Carc V
     C                     ADD  WGAUPC    YL0031           Lean Percent To
     C                     ADD  WN0177    YL0032           Lean Add/Ded Va
     C                     ADD  WN0179    YL0033           Total Carc Val
     C                     ADD  WN0195    YL0035           TH Meat Value F
     C                     ADD  WN0196    YL0036           TH Fixed Cost A
     C                     ADD  WN0198    YL0037           Gross Before So
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * zero out cd ca fields
      *================================================================
     C                     Z-ADD*ZERO     WN0181           CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0182           CD CA Std Yield
     C                     Z-ADD*ZERO     WN0183           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0184           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0185           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0186           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0187           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0188           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0189           CD CA Gross Val
     C                     Z-ADD*ZERO     WN0190           CD CA Gross Val
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * move cd fields to cd ca fields
      *================================================================
     C                     Z-ADDWN0169    WN0181           CD CA Sort Loss
     C                     Z-ADDWN0170    WN0182           CD CA Std Yield
     C                     Z-ADDWN0171    WN0183           CD CA Base Carc
     C                     Z-ADDWN0172    WN0184           CD CA Crc Value
     C                     Z-ADDWN0173    WN0185           CD CA Base Carc
     C                     Z-ADDWN0174    WN0186           CD CA Crc Value
     C                     Z-ADDWN0176    WN0187           CD CA Lean Prem
     C                     Z-ADDWN0177    WN0188           CD CA Lean Prem
     C                     Z-ADDWN0178    WN0189           CD CA Gross Val
     C                     Z-ADDWN0179    WN0190           CD CA Gross Val
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * zero out cd fields
      *================================================================
     C                     Z-ADD*ZERO     WN0169           CD Sort Loss
     C                     Z-ADD*ZERO     WN0170           CD STD Yield
     C                     Z-ADD*ZERO     WN0171           CD Base Carcass
     C                     Z-ADD*ZERO     WN0172           CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0173           CD Base Carc Va
     C                     Z-ADD*ZERO     WN0174           CD Crc Value $
     C                     Z-ADD*ZERO     WN0176           CD Lean Premium
     C                     Z-ADD*ZERO     WN0177           CD Lean Premium
     C                     Z-ADD*ZERO     WN0178           CD Gross Value
     C                     Z-ADD*ZERO     WN0179           CD Gross Value
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * zero out cd ca fields
      *================================================================
     C                     Z-ADD*ZERO     WN0181           CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0182           CD CA Std Yield
     C                     Z-ADD*ZERO     WN0183           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0184           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0185           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0186           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0187           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0188           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0189           CD CA Gross Val
     C                     Z-ADD*ZERO     WN0190           CD CA Gross Val
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * move cd fields to cd ca fields
      *================================================================
     C                     Z-ADDWN0169    WN0181           CD CA Sort Loss
     C                     Z-ADDWN0170    WN0182           CD CA Std Yield
     C                     Z-ADDWN0171    WN0183           CD CA Base Carc
     C                     Z-ADDWN0172    WN0184           CD CA Crc Value
     C                     Z-ADDWN0173    WN0185           CD CA Base Carc
     C                     Z-ADDWN0174    WN0186           CD CA Crc Value
     C                     Z-ADDWN0176    WN0187           CD CA Lean Prem
     C                     Z-ADDWN0177    WN0188           CD CA Lean Prem
     C                     Z-ADDWN0178    WN0189           CD CA Gross Val
     C                     Z-ADDWN0179    WN0190           CD CA Gross Val
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * zero out cd fields
      *================================================================
     C                     Z-ADD*ZERO     WN0169           CD Sort Loss
     C                     Z-ADD*ZERO     WN0170           CD STD Yield
     C                     Z-ADD*ZERO     WN0171           CD Base Carcass
     C                     Z-ADD*ZERO     WN0172           CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0173           CD Base Carc Va
     C                     Z-ADD*ZERO     WN0174           CD Crc Value $
     C                     Z-ADD*ZERO     WN0176           CD Lean Premium
     C                     Z-ADD*ZERO     WN0177           CD Lean Premium
     C                     Z-ADD*ZERO     WN0178           CD Gross Value
     C                     Z-ADD*ZERO     WN0179           CD Gross Value
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Analysis
      *================================================================
      * CASE: PAR.TH Head Killed is Not Zero
     C           WVFENB    IFNE 0                          *IF
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVBNNB    WQ0040  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0041  50       BOL Load Number
     C                     PARM WVCVNB    WQ0042  50       TH Tattoo Numbe
     C                     PARM WVAWDT    WQ0043  70       TH Purchase Dat
     C                     PARM WVCYNB    WQ0044  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0045  52       TH CM Base Mkt
     C                     PARM WVB0DT    WQ0046  70       TH Kill Date
     C                     PARM WVHMNB    WQ0047  30       BOH Company Num
     C                     PARM WUAZPR    WQ0048  52       PSC Floor Price
     C                     PARM WUA0PR    WQ0049  52       PSC Ceiling Pri
     C                     PARM WUA9PC    WQ0050  30       PSC Market Perc
     C                     PARM WUA9PR    WQ0051  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0052  52       Market Price US
     C                     PARM WUAICD    WQ0053  3        PO Option Code
     C                     PARM WUAKCD    WQ0054  5        PC Contract Cod
     C                     PARM WUALCD    WQ0055  5        PSC Sub-Contrac
     C                     PARM WUAAPR    WQ0056  52       BOH Market Add/
     C                     PARM WUAMCD    WQ0057  3        CMP Program Cod
     C                     PARM WUB3ST    WQ0058  2        BOH Quote Price
     C                     PARM WUALPR    WQ0059  52       BOH Quoted Base
     C                     PARM WUETCD    WQ0060  3        BOH Commodity M
     C                     PARM WUEUCD    WQ0061  7        BOH Commodity P
     C                     PARM WUJ5TX    WQ0062  3        BOH Market Date
     C                     PARM WVFENB    WQ0063  50       TH Head Killed
     C                     PARM WVHENB    WQ0064  50       TH Head Adds
     C                     PARM WVAWPC    WQ0065  52       TH Actual Yield
     C                     PARM WVCWPC    WQ0066  52       TH Adj Actual Y
     C                     PARM WVB8PR    WQ0067  52       TH CM Market Pr
     C                     PARM WVHHNB    WQ0068  71       TH Avg Hot Wgt
     C                     PARM WVJ9NB    WQ0069  50       TH Head Exclude
     C                     PARM WVKAST    WQ0070  1        TH Source Type
     C                     PARM WVJ9ST    WQ0071  1        TH Payment Type
     C                     PARM WVS9PR    WQ0072  52       TH PHA Lean Prm
     C           YL0066    PARM YL0066    WQ0073  52       TH VC Gross Val
     C                     PARM WVOMVJ    WQ0074  52       TH PHA Sort Dis
     C                     PARM 'N'       WQ0075  1        Competitors Pro
     C                     PARM 'A'       WQ0076  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Analysis
      *================================================================
      * CASE: PAR.TH Head Killed is Not Zero
     C           WVFENB    IFNE 0                          *IF
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVBNNB    WQ0077  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0078  50       BOL Load Number
     C                     PARM WVCVNB    WQ0079  50       TH Tattoo Numbe
     C                     PARM WVAWDT    WQ0080  70       TH Purchase Dat
     C                     PARM WVCYNB    WQ0081  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0082  52       TH CM Base Mkt
     C                     PARM WVB0DT    WQ0083  70       TH Kill Date
     C                     PARM WVHMNB    WQ0084  30       BOH Company Num
     C                     PARM WUAZPR    WQ0085  52       PSC Floor Price
     C                     PARM WUA0PR    WQ0086  52       PSC Ceiling Pri
     C                     PARM WUA9PC    WQ0087  30       PSC Market Perc
     C                     PARM WUA9PR    WQ0088  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0089  52       Market Price US
     C                     PARM WUAICD    WQ0090  3        PO Option Code
     C                     PARM WUAKCD    WQ0091  5        PC Contract Cod
     C                     PARM WUALCD    WQ0092  5        PSC Sub-Contrac
     C                     PARM WUAAPR    WQ0093  52       BOH Market Add/
     C                     PARM WUAMCD    WQ0094  3        CMP Program Cod
     C                     PARM WUB3ST    WQ0095  2        BOH Quote Price
     C                     PARM WUALPR    WQ0096  52       BOH Quoted Base
     C                     PARM WUETCD    WQ0097  3        BOH Commodity M
     C                     PARM WUEUCD    WQ0098  7        BOH Commodity P
     C                     PARM WUJ5TX    WQ0099  3        BOH Market Date
     C                     PARM WVFENB    WQ0100  50       TH Head Killed
     C                     PARM WVHENB    WQ0101  50       TH Head Adds
     C                     PARM WVAWPC    WQ0102  52       TH Actual Yield
     C                     PARM WVCWPC    WQ0103  52       TH Adj Actual Y
     C                     PARM WVB8PR    WQ0104  52       TH CM Market Pr
     C                     PARM WVHHNB    WQ0105  71       TH Avg Hot Wgt
     C                     PARM WVJ9NB    WQ0106  50       TH Head Exclude
     C                     PARM WVKAST    WQ0107  1        TH Source Type
     C                     PARM WVJ9ST    WQ0108  1        TH Payment Type
     C                     PARM WVS9PR    WQ0109  52       TH PHA Lean Prm
     C           YL0066    PARM YL0066    WQ0110  52       TH VC Gross Val
     C                     PARM WVOMVJ    WQ0111  52       TH PHA Sort Dis
     C                     PARM 'N'       WQ0112  1        Competitors Pro
     C                     PARM 'A'       WQ0113  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Tattoo Header - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDWVHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWVBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWVBONB    PABONB           BOL Load Number
     C                     Z-ADDWVCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWVB0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKXUPFR'              90  PRT Tattoo Head
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
     C                     PARM WUAMCD    WQ0114  3        CMP Program Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXUPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Payments
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
     C                     EXSR TCCHRC
      *   ** HPE053P
      * FOR Carcass, call the XF even if Head Killed is 0, because
      *  we need the th cm base mkt price if Ins Reimb is to be calcd.
      * Head Killed is checked in the XF.
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVBNNB    WQ0115  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0116  50       BOL Load Number
     C                     PARM WVCVNB    WQ0117  50       TH Tattoo Numbe
     C                     PARM WVAWDT    WQ0118  70       TH Purchase Dat
     C                     PARM WVCYNB    WQ0119  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0120  52       TH CM Base Mkt
     C                     PARM WVB0DT    WQ0121  70       TH Kill Date
     C                     PARM WVHMNB    WQ0122  30       BOH Company Num
     C                     PARM WUAZPR    WQ0123  52       PSC Floor Price
     C                     PARM WUA0PR    WQ0124  52       PSC Ceiling Pri
     C                     PARM WUA9PC    WQ0125  30       PSC Market Perc
     C                     PARM WUA9PR    WQ0126  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0127  52       Market Price US
     C                     PARM WUAICD    WQ0128  3        PO Option Code
     C                     PARM WUAKCD    WQ0129  5        PC Contract Cod
     C                     PARM WUALCD    WQ0130  5        PSC Sub-Contrac
     C                     PARM WUAAPR    WQ0131  52       BOH Market Add/
     C                     PARM WUAMCD    WQ0132  3        CMP Program Cod
     C                     PARM WUB3ST    WQ0133  2        BOH Quote Price
     C                     PARM WUALPR    WQ0134  52       BOH Quoted Base
     C                     PARM WUETCD    WQ0135  3        BOH Commodity M
     C                     PARM WUEUCD    WQ0136  7        BOH Commodity P
     C                     PARM WUJ5TX    WQ0137  3        BOH Market Date
     C                     PARM WVFENB    WQ0138  50       TH Head Killed
     C                     PARM WVHENB    WQ0139  50       TH Head Adds
     C                     PARM WVAWPC    WQ0140  52       TH Actual Yield
     C                     PARM WVCWPC    WQ0141  52       TH Adj Actual Y
     C                     PARM WVB8PR    WQ0142  52       TH CM Market Pr
     C                     PARM WVHHNB    WQ0143  71       TH Avg Hot Wgt
     C                     PARM WVJ9NB    WQ0144  50       TH Head Exclude
     C                     PARM WVKAST    WQ0145  1        TH Source Type
     C                     PARM WVJ9ST    WQ0146  1        TH Payment Type
     C                     PARM WVS9PR    WQ0147  52       TH PHA Lean Prm
     C           YL0066    PARM YL0066    WQ0148  52       TH VC Gross Val
     C                     PARM WVOMVJ    WQ0149  52       TH PHA Sort Dis
     C                     PARM 'N'       WQ0150  1        Competitors Pro
     C                     PARM 'P'       WQ0151  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * Allocation of Freight
      *================================================================
      * Get bol frt fields, and find out if any tattoo for this
      * load has been paid.
      * Also bring back if a tattoo has been paid, and fix bug on frt hel
      * Rtv Frt All f/BOL/TTO  XF - Buy Order Load  * 
     C                     CALL 'PKEHXFR'              90  Rtv Frt All f/B
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0152  30       BOH Company Num
     C                     PARM WVBNNB    WQ0153  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0154  50       BOL Load Number
     C           WUCMST    PARM WUCMST    WQ0155  2        BOL Freight UOM
     C           WUAGPR    PARM WUAGPR    WQ0156  72       BOL Freight Uni
     C           WUATVA    PARM WUATVA    WQ0157  72       BOL Freight Amt
     C           WUI1ST    PARM WUI1ST    WQ0158  1        BOL Freight All
     C           WUDHNB    PARM WUDHNB    WQ0159  70       BOL Head Receiv
     C           WUDINB    PARM WUDINB    WQ0160  71       BOL Live Wgt Re
     C           WUIOJR    PARM WUIOJR    WQ0161  70       BOL Head Receiv
     C           WUNPST    PARM WUNPST    WQ0162  1        Tattoo is paid
     C           WUNFST    PARM WUNFST    WQ0163  1        Held Over Recor
     C           WUK4PR    PARM WUK4PR    WQ0164  72       Tot Frt Spdb af
     C           WUK7PR    PARM WUK7PR    WQ0165  72       Frt Amt spread
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKEHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If allocated but no paid then allow to re spread of frt
      * If not allocated allow spread of frt
      * CASE: not paid tattoo but allocated frt allow reallocate
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo is paid Usr is No
      *   |- c2    : WRK.BOL Freight Allocation is Freight is Allocated
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUNPST    IFEQ 'N'                        *IF
     C           WUI1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUI5ST           Freight Allocia
      * Clc Frght Allctn/UnAl  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ6XFR'              90  Clc Frght Allct
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0166  30       BOH Company Num
     C                     PARM WVBNNB    WQ0167  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0168  50       BOL Load Number
     C                     PARM WUCMST    WQ0169  2        BOL Freight UOM
     C                     PARM WUAGPR    WQ0170  72       BOL Freight Uni
     C                     PARM WUATVA    WQ0171  72       BOL Freight Amt
     C                     PARM WUI1ST    WQ0172  1        BOL Freight All
     C                     PARM WUDHNB    WQ0173  70       BOL Head Receiv
     C                     PARM WUDINB    WQ0174  71       BOL Live Wgt Re
     C                     PARM WUIOJR    WQ0175  70       BOL Head Receiv
     C                     PARM WUI5ST    WQ0176  1        Freight Allocia
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: WRK.BOL Freight Allocation is Freight is not Allocated
     C           WUI1ST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUI5ST           Freight Allocia
      * Clc Frght Allctn/UnAl  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ6XFR'              90  Clc Frght Allct
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVHMNB    WQ0177  30       BOH Company Num
     C                     PARM WVBNNB    WQ0178  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0179  50       BOL Load Number
     C                     PARM WUCMST    WQ0180  2        BOL Freight UOM
     C                     PARM WUAGPR    WQ0181  72       BOL Freight Uni
     C                     PARM WUATVA    WQ0182  72       BOL Freight Amt
     C                     PARM WUI1ST    WQ0183  1        BOL Freight All
     C                     PARM WUDHNB    WQ0184  70       BOL Head Receiv
     C                     PARM WUDINB    WQ0185  71       BOL Live Wgt Re
     C                     PARM WUIOJR    WQ0186  70       BOL Head Receiv
     C                     PARM WUI5ST    WQ0187  1        Freight Allocia
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * Analysis
      *================================================================
      * CASE: PAR.TH Head Killed is Not Zero
     C           WVFENB    IFNE 0                          *IF
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVBNNB    WQ0200  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0201  50       BOL Load Number
     C                     PARM WVCVNB    WQ0202  50       TH Tattoo Numbe
     C                     PARM WVAWDT    WQ0203  70       TH Purchase Dat
     C                     PARM WVCYNB    WQ0204  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0205  52       TH CM Base Mkt
     C                     PARM WVB0DT    WQ0206  70       TH Kill Date
     C                     PARM WVHMNB    WQ0207  30       BOH Company Num
     C                     PARM WUAZPR    WQ0208  52       PSC Floor Price
     C                     PARM WUA0PR    WQ0209  52       PSC Ceiling Pri
     C                     PARM WUA9PC    WQ0210  30       PSC Market Perc
     C                     PARM WUA9PR    WQ0211  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0212  52       Market Price US
     C                     PARM WUAICD    WQ0213  3        PO Option Code
     C                     PARM WUAKCD    WQ0214  5        PC Contract Cod
     C                     PARM WUALCD    WQ0215  5        PSC Sub-Contrac
     C                     PARM WUAAPR    WQ0216  52       BOH Market Add/
     C                     PARM WUAMCD    WQ0217  3        CMP Program Cod
     C                     PARM WUB3ST    WQ0218  2        BOH Quote Price
     C                     PARM WUALPR    WQ0219  52       BOH Quoted Base
     C                     PARM WUETCD    WQ0220  3        BOH Commodity M
     C                     PARM WUEUCD    WQ0221  7        BOH Commodity P
     C                     PARM WUJ5TX    WQ0222  3        BOH Market Date
     C                     PARM WVFENB    WQ0223  50       TH Head Killed
     C                     PARM WVHENB    WQ0224  50       TH Head Adds
     C                     PARM WVAWPC    WQ0225  52       TH Actual Yield
     C                     PARM WVCWPC    WQ0226  52       TH Adj Actual Y
     C                     PARM WVB8PR    WQ0227  52       TH CM Market Pr
     C                     PARM WVHHNB    WQ0228  71       TH Avg Hot Wgt
     C                     PARM WVJ9NB    WQ0229  50       TH Head Exclude
     C                     PARM WVKAST    WQ0230  1        TH Source Type
     C                     PARM WVJ9ST    WQ0231  1        TH Payment Type
     C                     PARM WVS9PR    WQ0232  52       TH PHA Lean Prm
     C           YL0066    PARM YL0066    WQ0233  52       TH VC Gross Val
     C                     PARM WVOMVJ    WQ0234  52       TH PHA Sort Dis
     C                     PARM 'N'       WQ0235  1        Competitors Pro
     C                     PARM 'A'       WQ0236  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * Payment
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
     C                     EXSR THCHRC
      *   ** HPE053P
      * FOR Carcass, call the XF even if Head Killed is 0, because
      *  we need the th cm base mkt price if Ins Reimb is to be calcd.
      * Head Killed is checked in the XF.
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WVBNNB    WQ0237  70       BOH Buy Order N
     C                     PARM WVBONB    WQ0238  50       BOL Load Number
     C                     PARM WVCVNB    WQ0239  50       TH Tattoo Numbe
     C                     PARM WVAWDT    WQ0240  70       TH Purchase Dat
     C                     PARM WVCYNB    WQ0241  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0242  52       TH CM Base Mkt
     C                     PARM WVB0DT    WQ0243  70       TH Kill Date
     C                     PARM WVHMNB    WQ0244  30       BOH Company Num
     C                     PARM WUAZPR    WQ0245  52       PSC Floor Price
     C                     PARM WUA0PR    WQ0246  52       PSC Ceiling Pri
     C                     PARM WUA9PC    WQ0247  30       PSC Market Perc
     C                     PARM WUA9PR    WQ0248  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0249  52       Market Price US
     C                     PARM WUAICD    WQ0250  3        PO Option Code
     C                     PARM WUAKCD    WQ0251  5        PC Contract Cod
     C                     PARM WUALCD    WQ0252  5        PSC Sub-Contrac
     C                     PARM WUAAPR    WQ0253  52       BOH Market Add/
     C                     PARM WUAMCD    WQ0254  3        CMP Program Cod
     C                     PARM WUB3ST    WQ0255  2        BOH Quote Price
     C                     PARM WUALPR    WQ0256  52       BOH Quoted Base
     C                     PARM WUETCD    WQ0257  3        BOH Commodity M
     C                     PARM WUEUCD    WQ0258  7        BOH Commodity P
     C                     PARM WUJ5TX    WQ0259  3        BOH Market Date
     C                     PARM WVFENB    WQ0260  50       TH Head Killed
     C                     PARM WVHENB    WQ0261  50       TH Head Adds
     C                     PARM WVAWPC    WQ0262  52       TH Actual Yield
     C                     PARM WVCWPC    WQ0263  52       TH Adj Actual Y
     C                     PARM WVB8PR    WQ0264  52       TH CM Market Pr
     C                     PARM WVHHNB    WQ0265  71       TH Avg Hot Wgt
     C                     PARM WVJ9NB    WQ0266  50       TH Head Exclude
     C                     PARM WVKAST    WQ0267  1        TH Source Type
     C                     PARM WVJ9ST    WQ0268  1        TH Payment Type
     C                     PARM WVS9PR    WQ0269  52       TH PHA Lean Prm
     C           YL0066    PARM YL0066    WQ0270  52       TH VC Gross Val
     C                     PARM WVOMVJ    WQ0271  52       TH PHA Sort Dis
     C                     PARM 'N'       WQ0272  1        Competitors Pro
     C                     PARM 'P'       WQ0273  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Competitors Code 1 Usr
     C                     MOVEL*BLANK    WUE7CD  3
      * Define work field Competitors Code 2 Usr
     C                     MOVEL*BLANK    WUE8CD  3
      * Define work field Competitors Code 3 Usr
     C                     MOVEL*BLANK    WUE9CD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WAA0PC           CMP Lean Factor
     C                     Z-ADD*ZERO     WAI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WAVEPR           CMP % of Carcas
     C                     Z-ADD*ZERO     WAVFPR           CMP Fixed Cost
     C                     Z-ADD*ZERO     WAVHPR           CMP Grade Type
     C                     Z-ADD*ZERO     WAVIPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WAVJPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUP0NB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WEASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WEAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WEALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WED5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WED6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WED7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WED8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WED9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WEJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WEKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WEKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WEIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WEGANB           CW Year
     C                     Z-ADD*ZERO     WEGBNB           CW Week Number
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAHDT           PSC Date
     C                     Z-ADD*ZERO     WFAZPR           PSC Floor Price
     C                     Z-ADD*ZERO     WFA0PR           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WFA9PC           PSC Market Perc
     C                     Z-ADD*ZERO     WFA7PR           PSC Break Even
     C                     Z-ADD*ZERO     WFA8PR           PSC FLoor Price
     C                     Z-ADD*ZERO     WFA9PR           PSC Mkt Percent
     C                     Z-ADD*ZERO     WFF6PR           PSC Mkt + or -
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGLGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WGEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WGLHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WGBEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WGASPC           CD STD Yield
     C                     Z-ADD*ZERO     WGEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WGB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WGEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WGB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WGAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WGAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WGAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WGAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WGEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WGAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WGBBDT           CD Kill Date
     C                     Z-ADD*ZERO     WGAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WGH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WGBEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WGGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WGBHPC           CD FFLI
     C                     Z-ADD*ZERO     WGLTNB           CD LOT
     C                     Z-ADD*ZERO     WGX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WGFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WGFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WGFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WGJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WGF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WGJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WGJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WGJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WGJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WGJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WGJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WGJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WGJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WGDKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WGITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WGIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WGORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WGOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WGPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WGIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WGORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WGIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WGIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field #Txt USR
     C                     MOVEL*BLANK    WUC6TX 80
      * Define work field CMP Market Add/Deduct
     C                     Z-ADD*ZERO     WUI1PR  52
      * Define work field CMP CLC Premium First
     C                     MOVEL*BLANK    WUZ2ST  1
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIGYDT           CMP Effect Purc
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Define work field OMS Error Return Usr
     C                     MOVEL*BLANK    WUIPTX  5
      * Define work field Cmp Sort Dsc Carc
     C                     Z-ADD*ZERO     WUKWPR  62
      * Define work field Cmp Std Yield
     C                     Z-ADD*ZERO     WUF9PC  52
      * Define work field Cmp Base Carc
     C                     Z-ADD*ZERO     WUKRPR  62
      * Define work field Cmp Carc Val Carc
     C                     Z-ADD*ZERO     WUKUPR  52
      * Define work field Cmp Lean Premium Carc
     C                     Z-ADD*ZERO     WUKSPR  62
      * Define work field Cmp Gross Carc
     C                     Z-ADD*ZERO     WUKXPR  62
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJE8NB           CMMR Row Number
     C                     Z-ADD*ZERO     WJEGNB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WJEHNB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WJEINB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WJEJNB           CMMR Live Wgt M
     C                     Z-ADD*ZERO     WJEKNB           CMMR Live Wgt M
     C                     Z-ADD*ZERO     WJAQPC           CMMR Std Dressi
     C                     Z-ADD*ZERO     WJEMNB           CMMR Sort Disco
     C                     Z-ADD*ZERO     WJE2NB           CMMR Unused Fie
     C                     Z-ADD*ZERO     WJLJA1           CMMR Midpoint
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      * Define work field Record Found CMMC USR
     C                     MOVEL*BLANK    WUF6ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKE8NB           CMMR Row Number
     C                     Z-ADD*ZERO     WKE4NB           CMMC Column Num
     C                     Z-ADD*ZERO     WKA1PC           CMMC Lean Perce
     C                     Z-ADD*ZERO     WKE7NB           CMMC Backfat In
     C                     Z-ADD*ZERO     WKERNB           CMMC Premium Va
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Define work field Backfat USR
     C                     Z-ADD*ZERO     WUVENB  31
      * Define work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    WUIXTX  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Last BOH BuyOrder Nbr USR
     C                     Z-ADD*ZERO     WUDUNB  70
      * Define work field Last BOL Load number  USR
     C                     Z-ADD*ZERO     WUDVNB  50
      * Define work field HC Description
     C                     MOVEL*BLANK    WUBDTX 25
      * Define work field HC Defect Required
     C                     MOVEL*BLANK    WUBXST  1
      * Define work field HC Price Required
     C                     MOVEL*BLANK    WUBYST  1
      * Define work field HC Resolution
     C                     MOVEL*BLANK    WUBITX 60
      * Define work field HC Qualification
     C                     MOVEL*BLANK    WUB0ST  1
      * Define work field HC Class Type
     C                     MOVEL*BLANK    WUFBST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAADT           RS Date Changed
     C                     Z-ADD*ZERO     WWAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WWABDT           RS Date Added
     C                     Z-ADD*ZERO     WWABTM           RS Time Added
      * Define work field BOH Market Add/Deduct
     C                     Z-ADD*ZERO     WUAAPR  52
      * Define work field BOH Quote Price Type
     C                     MOVEL*BLANK    WUB3ST  2
      * Define work field BOH Quoted Base Mkt Price
     C                     Z-ADD*ZERO     WUALPR  52
      * Define work field BOH Commodity Market Code
     C                     MOVEL*BLANK    WUETCD  3
      * Define work field BOH Commodity Price Group
     C                     MOVEL*BLANK    WUEUCD  7
      * Define work field BOH Market Date Method
     C                     MOVEL*BLANK    WUJ5TX  3
      * Define work field PC Contract Code
     C                     MOVEL*BLANK    WUAKCD  5
      * Define work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    WUALCD  5
      * Define work field PO Option Code
     C                     MOVEL*BLANK    WUAICD  3
      * Define work field CMP Program Code
     C                     MOVEL*BLANK    WUAMCD  3
      * Define work field PSC Floor Price
     C                     Z-ADD*ZERO     WUAZPR  52
      * Define work field PSC Ceiling Price
     C                     Z-ADD*ZERO     WUA0PR  52
      * Define work field PSC Market Percent   NU
     C                     Z-ADD*ZERO     WUA9PC  30
      * Define work field PSC Break Even Percent
     C                     Z-ADD*ZERO     WUA7PR  52
      * Define work field PSC FLoor Price +/-
     C                     Z-ADD*ZERO     WUA8PR  52
      * Define work field PSC Sub-Contract Type
     C                     MOVEL*BLANK    WUF3ST  1
      * Define work field PSC Mkt Percent
     C                     Z-ADD*ZERO     WUA9PR  52
      * Define work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     WUAMPR  52
      * Define work field TH CM Market Price
     C                     Z-ADD*ZERO     WUB8PR  52
      * Define work field BOL Freight UOM
     C                     MOVEL*BLANK    WUCMST  2
      * Define work field BOL Freight Unit Amt
     C                     Z-ADD*ZERO     WUAGPR  72
      * Define work field BOL Freight Amt
     C                     Z-ADD*ZERO     WUATVA  72
      * Define work field BOL Freight Allocation
     C                     MOVEL*BLANK    WUI1ST  1
      * Define work field BOL Head Received
     C                     Z-ADD*ZERO     WUDHNB  70
      * Define work field BOL Live Wgt Received
     C                     Z-ADD*ZERO     WUDINB  71
      * Define work field BOL Head Received Market
     C                     Z-ADD*ZERO     WUIOJR  70
      * Define work field Tattoo is paid Usr
     C                     MOVEL*BLANK    WUNPST  1
      * Define work field Held Over Records Y/N
     C                     MOVEL*BLANK    WUNFST  1
      * Define work field Tot Frt Spdb aft pay Usr
     C                     Z-ADD*ZERO     WUK4PR  72
      * Define work field Frt Amt spread Usr
     C                     Z-ADD*ZERO     WUK7PR  72
      * Define work field Freight Allociation Apply
     C                     MOVEL*BLANK    WUI5ST  1
      * Define work field Ded/Add/Net Pay Usr
     C                     MOVEL*BLANK    WUJGST  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB03 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB04 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB05 155       *Synon (15,5) w
     C                     MOVEL'N'       W0PMT   1
      * Define local work field BOH Buy Order Number
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field BOL Load Number
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field TH Tattoo Number
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field TH VC Gross Value /HD
     C                     Z-ADD*ZERO     YL0004  52
      * Define local work field BOH Market Add/Deduct
     C                     Z-ADD*ZERO     YL0005  52
      * Define local work field BOH Quote Price Type
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field BOH Quoted Base Mkt Price
     C                     Z-ADD*ZERO     YL0007  52
      * Define local work field BOH Commodity Market Code
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field BOH Commodity Price Group
     C                     MOVEL*BLANK    YL0009  7
      * Define local work field BOH Market Date Method
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field PC Contract Code
     C                     MOVEL*BLANK    YL0011  5
      * Define local work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    YL0012  5
      * Define local work field PO Option Code
     C                     MOVEL*BLANK    YL0013  3
      * Define local work field CMP Program Code
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field PSC Floor Price
     C                     Z-ADD*ZERO     YL0015  52
      * Define local work field PSC Ceiling Price
     C                     Z-ADD*ZERO     YL0016  52
      * Define local work field PSC Market Percent   NU
     C                     Z-ADD*ZERO     YL0017  30
      * Define local work field PSC Break Even Percent
     C                     Z-ADD*ZERO     YL0018  52
      * Define local work field PSC FLoor Price +/-
     C                     Z-ADD*ZERO     YL0019  52
      * Define local work field PSC Sub-Contract Type
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field PSC Mkt Percent
     C                     Z-ADD*ZERO     YL0021  52
      * Define local work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YL0022  52
      * Define local work field Market Price USR
     C                     Z-ADD*ZERO     YL0023  52
      * Define local work field Pricing UOM USR
     C                     MOVEL*BLANK    YL0024  2
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0025  70
      * Define local work field Head Total USR
     C                     Z-ADD*ZERO     YL0026  70
      * Define local work field Sort Loss Tot USR
     C                     Z-ADD*ZERO     YL0027  72
      * Define local work field Std Yield % Tot USR
     C                     Z-ADD*ZERO     YL0028  72
      * Define local work field Weight Tot USR
     C                     Z-ADD*ZERO     YL0029  71
      * Define local work field Adj Base Carc Val Tot USR
     C                     Z-ADD*ZERO     YL0030  72
      * Define local work field Lean Percent Tot USR
     C                     Z-ADD*ZERO     YL0031  72
      * Define local work field Lean Add/Ded Val Tot USR
     C                     Z-ADD*ZERO     YL0032  72
      * Define local work field Total Carc Val Tot USR
     C                     Z-ADD*ZERO     YL0033  72
      * Define local work field Base Carc Val Tot USR
     C                     Z-ADD*ZERO     YL0034  72
      * Define local work field TH Meat Value Factor Amt
     C                     Z-ADD*ZERO     YL0035 112
      * Define local work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YL0036  72
      * Define local work field Gross Before Sort /HD Usr
     C                     Z-ADD*ZERO     YL0037  72
      * Define local work field Cmp Base Carc
     C                     Z-ADD*ZERO     YL0038  62
      * Define local work field Cmp Lean Premium Carc
     C                     Z-ADD*ZERO     YL0039  62
      * Define local work field Cmp Yield Gain/Loss Carc
     C                     Z-ADD*ZERO     YL0040  62
      * Define local work field Cmp Carc Val Carc
     C                     Z-ADD*ZERO     YL0041  52
      * Define local work field Cmp Sort Dsc Carc
     C                     Z-ADD*ZERO     YL0042  62
      * Define local work field Cmp Std Yield
     C                     Z-ADD*ZERO     YL0043  52
      * Define local work field Cmp Base Mkt Price
     C                     Z-ADD*ZERO     YL0044  52
      * Define local work field Cmp Base Live
     C                     Z-ADD*ZERO     YL0045  62
      * Define local work field Cmp Lean Premium Live
     C                     Z-ADD*ZERO     YL0046  62
      * Define local work field Cmp Yield Gain/Loss Live
     C                     Z-ADD*ZERO     YL0047  62
      * Define local work field Cmp Carc Val Live
     C                     Z-ADD*ZERO     YL0048  52
      * Define local work field Cmp Sort Dsc Live
     C                     Z-ADD*ZERO     YL0049  62
      * Define local work field TH MPR Sort Loss
     C                     Z-ADD*ZERO     YL0050  92
      * Define local work field CMP Effect Purchase Date
     C                     Z-ADD*ZERO     YL0051  70
      * Define local work field CMP Commodity Market
     C                     MOVEL*BLANK    YL0052  3
      * Define local work field CMP Commodity Group
     C                     MOVEL*BLANK    YL0053  7
      * Define local work field OMS Market Price Amt Usr
     C                     Z-ADD*ZERO     YL0054 114
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0055  70
      * Define local work field Market Prc Hog/Cutout USR
     C                     Z-ADD*ZERO     YL0056  52
      * Define local work field *Synon (15,5) work field
     C                     Z-ADD*ZERO     YL0057 155
      * Define local work field CMMR Row Number
     C                     Z-ADD*ZERO     YL0058  30
      * Define local work field CMMR Midpoint
     C                     Z-ADD*ZERO     YL0059  52
      * Define local work field Num NU USR
     C                     Z-ADD*ZERO     YL0060  10
      * Define local work field Optimal Lean Percent USR
     C                     Z-ADD*ZERO     YL0061  53
      * Define local work field CMMR Std Dressing Yield%
     C                     Z-ADD*ZERO     YL0062  52
      * Define local work field CD Sort Loss
     C                     Z-ADD*ZERO     YL0063  72
      * Define local work field CMMC Premium Value
     C                     Z-ADD*ZERO     YL0064  53
      * Define local work field Sort Total %
     C                     Z-ADD*ZERO     YL0065  74
      * Define local work field TH VC Gross Value /HD
     C                     Z-ADD*ZERO     YL0066  52
      *================================================================
     CSR         ZZEXIT    ENDSR
