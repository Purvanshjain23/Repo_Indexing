     H/TITLE Cvt A/R Hdr Nt to Dtl XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 09/17/08  Time  : 09:40:11
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOBUREL1IF  E           K        DISK
      * RTV : A/R Header Notes OLD      Retrieval index
      *
     FARBDCPL3IF  E           K        DISK
      * RTV : A/R Header                Retrieval index       NV
      *
     FPMEDCPL2IF  E           K        DISK
      * RSQ : A/R Header Note Header    Co/Inv/Sfx/NNum(d)
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPMEDCPL0IF  E           K        DISK                      A
      * UPD : A/R Header Note Header    Update index
      *
     FPMEFCPL0IF  E           K        DISK                      A
      * UPD : A/R Header Note Detail    Update index
      *
     I@BURELN
      * A/R Header Notes OLD      Retrieval index
      * Renamed input format fields
     I              BUAIC3                          WAAIC3
     I              BUCONB                          WACONB
     I              BUCEST                          WACEST
     I              BUOTDT                          WAOTDT
     I              BUDXNB                          WADXNB
     I              BUL5SX                          WAL5SX
     I              BUOUDT                          WAOUDT
     I              BUA3T1                          WAA3T1
     I              BUA4T1                          WAA4T1
     I              BUA5T1                          WAA5T1
     I              BUL6SX                          WAL6SX
     I              BUL7SX                          WAL7SX
     I              BUL8SX                          WAL8SX
     I              BUBKC7                          WABKC7
      *
     I@BDCPF7
      * A/R Header                Retrieval index       NV
      * Renamed input format fields
     I              BDAIC3                          WBAIC3
     I              BDCONB                          WBCONB
     I              BDCEST                          WBCEST
     I              BDUHCD                          WBUHCD
     I              BDBSVA                          WBBSVA
     I              BDAIVA                          WBAIVA
     I              BDAOVA                          WBAOVA
     I              BDBGVA                          WBBGVA
     I              BDAJST                          WBAJST
     I              BDE3ST                          WBE3ST
     I              BDG4CD                          WBG4CD
     I              BDCKNB                          WBCKNB
     I              BDCAC7                          WBCAC7
     I              BDBKC7                          WBBKC7
     I              BDBCCD                          WBBCCD
     I              BDR4CD                          WBR4CD
     I              BDB4DT                          WBB4DT
     I              BDATDT                          WBATDT
     I              BDH0DT                          WBH0DT
     I              BDH3DT                          WBH3DT
     I              BDH4DT                          WBH4DT
     I              BDH5DT                          WBH5DT
     I              BDANC7                          WBANC7
     I              BDCPTX                          WBCPTX
     I              BDBSDY                          WBBSDY
     I              BDUVST                          WBUVST
     I              BDUWST                          WBUWST
     I              BDUXST                          WBUXST
     I              BDAATM                          WBAATM
     I              BDAYNA                          WBAYNA
     I              BDA0NA                          WBA0NA
     I              BDAXDT                          WBAXDT
      *
     I@EDCPVJ
      * A/R Header Note Header    Co/Inv/Sfx/NNum(d)
      * Renamed input format fields
     I              EDAIC3                          WCAIC3
     I              EDCONB                          WCCONB
     I              EDCEST                          WCCEST
     I              EDNBNY                          WCNBNY
     I              EDSLDT                          WCSLDT
     I              EDDETM                          WCDETM
     I              EDENVN                          WCENVN
     I              EDSMDT                          WCSMDT
     I              EDFUPS                          WCFUPS
     I              EDSNDT                          WCSNDT
     I              EDDFTM                          WCDFTM
     I              EDEMVN                          WCEMVN
     I              EDANC7                          WCANC7
     I              EDR4CD                          WCR4CD
     I              EDVSST                          WCVSST
     I              EDMJDT                          WCMJDT
     I              EDBETM                          WCBETM
     I              EDCCVN                          WCCCVN
     I              EDCDVN                          WCCDVN
     I              EDMKDT                          WCMKDT
     I              EDBFTM                          WCBFTM
     I              EDCEVN                          WCCEVN
     I              EDCFVN                          WCCFVN
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WDAIC3
     I              EOBKC7                          WDBKC7
     I              EOAQCD                          WDAQCD
     I              EOR4CD                          WDR4CD
     I              EOBYNA                          WDBYNA
     I              EOB6NA                          WDB6NA
     I              EOBZNA                          WDBZNA
     I              EOLLST                          WDLLST
     I              EOPPST                          WDPPST
     I              EOR5NB                          WDR5NB
     I              EOR6NB                          WDR6NB
     I              EOQGST                          WDQGST
     I              EOBOCD                          WDBOCD
     I              EOTBNB                          WDTBNB
     I              EOMTCU                          WDMTCU
     I              EOW2NB                          WDW2NB
     I              EORPCD                          WDRPCD
     I              EOAJCD                          WDAJCD
     I              EOX9ST                          WDX9ST
     I              EOT9CD                          WDT9CD
     I              EOUBCD                          WDUBCD
     I              EOISTX                          WDISTX
     I              EOLQCD                          WDLQCD
     I              EONJNA                          WDNJNA
     I              EOI0TX                          WDI0TX
     I              EONKNA                          WDNKNA
     I              EOI1TX                          WDI1TX
     I              EOVLST                          WDVLST
     I              EORLST                          WDRLST
     I              EOMMTX                          WDMMTX
     I              EOOHNA                          WDOHNA
     I              EOQ6ST                          WDQ6ST
     I              EOQ8ST                          WDQ8ST
     I              EORBST                          WDRBST
     I              EOREST                          WDREST
     I              EOUVST                          WDUVST
     I              EOUWST                          WDUWST
     I              EOUXST                          WDUXST
     I              EOVSST                          WDVSST
     I              EOAATM                          WDAATM
     I              EOAYNA                          WDAYNA
     I              EOA0NA                          WDA0NA
     I              EOAXDT                          WDAXDT
      *
     I@EDCPVE
      * A/R Header Note Header    Update index
      * Renamed input format fields
     I              EDAIC3                          WEAIC3
     I              EDCONB                          WECONB
     I              EDCEST                          WECEST
     I              EDNBNY                          WENBNY
     I              EDSLDT                          WESLDT
     I              EDDETM                          WEDETM
     I              EDENVN                          WEENVN
     I              EDSMDT                          WESMDT
     I              EDFUPS                          WEFUPS
     I              EDSNDT                          WESNDT
     I              EDDFTM                          WEDFTM
     I              EDEMVN                          WEEMVN
     I              EDANC7                          WEANC7
     I              EDR4CD                          WER4CD
     I              EDVSST                          WEVSST
     I              EDMJDT                          WEMJDT
     I              EDBETM                          WEBETM
     I              EDCCVN                          WECCVN
     I              EDCDVN                          WECDVN
     I              EDMKDT                          WEMKDT
     I              EDBFTM                          WEBFTM
     I              EDCEVN                          WECEVN
     I              EDCFVN                          WECFVN
      *
     I@EFCPVY
      * A/R Header Note Detail    Update index
      * Renamed input format fields
     I              EFAIC3                          WFAIC3
     I              EFCONB                          WFCONB
     I              EFCEST                          WFCEST
     I              EFNBNY                          WFNBNY
     I              EFNCNY                          WFNCNY
     I              EFSWNA                          WFSWNA
     I              EFVSST                          WFVSST
     I              EFMJDT                          WFMJDT
     I              EFBETM                          WFBETM
     I              EFCCVN                          WFCCVN
     I              EFCDVN                          WFCDVN
     I              EFMKDT                          WFMKDT
     I              EFBFTM                          WFBFTM
     I              EFCEVN                          WFCEVN
     I              EFCFVN                          WFCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPMED1    E DSPMEDCPL0
      * UPD : A/R Header Note Header    Update index
      * Renamed input format fields
     I              EDAIC3                          WEAIC3
     I              EDCONB                          WECONB
     I              EDCEST                          WECEST
     I              EDNBNY                          WENBNY
     I              EDSLDT                          WESLDT
     I              EDDETM                          WEDETM
     I              EDENVN                          WEENVN
     I              EDSMDT                          WESMDT
     I              EDFUPS                          WEFUPS
     I              EDSNDT                          WESNDT
     I              EDDFTM                          WEDFTM
     I              EDEMVN                          WEEMVN
     I              EDANC7                          WEANC7
     I              EDR4CD                          WER4CD
     I              EDVSST                          WEVSST
     I              EDMJDT                          WEMJDT
     I              EDBETM                          WEBETM
     I              EDCCVN                          WECCVN
     I              EDCDVN                          WECDVN
     I              EDMKDT                          WEMKDT
     I              EDBFTM                          WEBFTM
     I              EDCEVN                          WECEVN
     I              EDCFVN                          WECFVN
      *
     IQPMEF1    E DSPMEFCPL0
      * UPD : A/R Header Note Detail    Update index
      * Renamed input format fields
     I              EFAIC3                          WFAIC3
     I              EFCONB                          WFCONB
     I              EFCEST                          WFCEST
     I              EFNBNY                          WFNBNY
     I              EFNCNY                          WFNCNY
     I              EFSWNA                          WFSWNA
     I              EFVSST                          WFVSST
     I              EFMJDT                          WFMJDT
     I              EFBETM                          WFBETM
     I              EFCCVN                          WFCCVN
     I              EFCDVN                          WFCDVN
     I              EFMKDT                          WFMKDT
     I              EFBFTM                          WFBFTM
     I              EFCEVN                          WFCEVN
     I              EFCFVN                          WFCFVN
      *
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Cvt A/R Hdr Nt to Dtl XF
      * Cvt A/R Hdr Nt to Dtl RT - A/R Header Notes  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Cvt A/R Hdr Nt to Dtl RT - A/R Header Notes  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       ARHN Note Numbe
     C                     Z-ADD*ZERO     WN0002  70       ARHN Note Date
     C                     Z-ADD*ZERO     WN0003  40       ARHN Note Time
     C                     MOVEL*BLANK    WN0004 10        ARHN Note Creat
     C                     Z-ADD*ZERO     WN0005  70       ARHN Follow Up
     C                     MOVEL*BLANK    WN0006  1        ARHN Follow Up
     C                     Z-ADD*ZERO     WN0007  70       ARHN Follow Up
     C                     Z-ADD*ZERO     WN0008  60       ARHN Follow Up
     C                     MOVEL*BLANK    WN0009 10        ARHN Follow Up
     C                     Z-ADD*ZERO     WN0010  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0011  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0012  1        Record Status
     C                     Z-ADD*ZERO     WN0013  70       Create Date
     C                     Z-ADD*ZERO     WN0014  60       Create Time
     C                     MOVEL*BLANK    WN0015 10        Create User
     C                     MOVEL*BLANK    WN0016 10        Create Program
     C                     Z-ADD*ZERO     WN0017  70       Change Date
     C                     Z-ADD*ZERO     WN0018  60       Change Time
     C                     MOVEL*BLANK    WN0019 10        Change User
     C                     MOVEL*BLANK    WN0020 10        Change Program
     C                     Z-ADD*ZERO     WN0021  50       ARHN Note Line
     C                     MOVEL*BLANK    WN0022 60        ARHN Detail Not
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@BURELN                    *
     C                     READ @BURELN                  90*
      * Data record not found
     C   90                MOVEL'USR3122' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CVT AR Notes          RT - A/R Header  * 
     C                     EXSR SBRVGN
      * Process Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Next Sequence     RT - A/R Header Note Header  * 
     C                     EXSR SCRVGN
     C                     Z-ADDWAOTDT    WN0002           ARHN Note Date
      * Note Time
      * CASE: DB1.Sequence Number is 460 - 499
     C           WADXNB    IFGE 460                        *IF
     C           WADXNB    ANDLE499
     C           WADXNB    SUB  60        WN0003           ARHN Note Time
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWADXNB    WN0003           ARHN Note Time
     C                     END                             *FI
     C                     Z-ADD1         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00003
     C           ZQ        ORGT 00003
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWAA3T1:ZQ YL0003    P  90  First Letter 1
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Note Created By
      * CASE: LCL.First Letter 1 USR is eq S
     C           YL0003    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    WN0004           ARHN Note Creat
     C                     MOVEL'PDCVERR' WN0004           ARHN Note Creat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0004           ARHN Note Creat
     C                     MOVEL'PDTWOOD' WN0004           ARHN Note Creat
     C                     END                             *FI
      * Follow Up Date
      * CASE: DB1.Follow-up Date is Eq Zero
     C           WAOUDT    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN0005           ARHN Follow Up
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAOUDT    WN0005           ARHN Follow Up
     C                     END                             *FI
      * Follow Up Status
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Purge Status is History
      *   |- c2    : LCL.Remaining Balance Due is equal to zero
      *   '-
     C           YL0002    IFEQ 'H'                        *IF
     C           YL0001    OREQ *ZERO                      *OR
     C                     MOVEL'C'       WN0006           ARHN Follow Up
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'O'       WN0006           ARHN Follow Up
     C                     END                             *FI
     C                     Z-ADD*ZERO     WN0007           ARHN Follow Up
     C                     Z-ADD*ZERO     WN0008           ARHN Follow Up
     C                     MOVEL*BLANK    WN0009           ARHN Follow Up
      * Sales Route Code
      * CASE: PAR.Sales Route Code is not entered
     C           WN0011    IFEQ *BLANK                     *IF
      * RTV Sales Route        RT - Company Customer  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     MOVEL'A'       WN0012           Record Status
      * CASE: DB1.Note Line 1 is Entered
     C           WAA4T1    IFNE *BLANK                     *IF
      * Crt A/R Hdr Note Dtls CR - A/R Header Note Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWACONB    WL0002           Invoice Number
     C                     MOVELWACEST    WL0003    P      Invoice Suffix
     C                     Z-ADDWN0001    WL0004           ARHN Note Numbe
     C                     Z-ADDWN0002    WL0005           ARHN Note Date
     C                     Z-ADDWN0003    WL0006           ARHN Note Time
     C                     MOVELWN0004    WL0007    P      ARHN Note Creat
     C                     Z-ADDWN0005    WL0008           ARHN Follow Up
     C                     MOVELWN0006    WL0009    P      ARHN Follow Up
     C                     Z-ADDWN0007    WL0010           ARHN Follow Up
     C                     Z-ADDWN0008    WL0011           ARHN Follow Up
     C                     MOVELWN0009    WL0012    P      ARHN Follow Up
     C                     Z-ADDWN0010    WL0013           A/R Customer Nu
     C                     MOVELWN0011    WL0014    P      Sales Route Cod
     C                     MOVELWN0012    WL0015    P      Record Status
     C                     Z-ADDWN0013    WL0016           Create Date
     C                     Z-ADDWN0014    WL0017           Create Time
     C                     MOVELWN0015    WL0018    P      Create User
     C                     MOVELWN0016    WL0019    P      Create Program
     C                     Z-ADDWN0017    WL0020           Change Date
     C                     Z-ADDWN0018    WL0021           Change Time
     C                     MOVELWN0019    WL0022    P      Change User
     C                     MOVELWN0020    WL0023    P      Change Program
     C                     EXSR SECRRC
     C                     Z-ADD1         WN0021           ARHN Note Line
     C                     MOVEL*BLANK    WN0022           ARHN Detail Not
     C                     MOVELWAA4T1    WN0022           ARHN Detail Not
      * Crt Note Detail       CR - A/R Header Note Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0024           Company Number
     C                     Z-ADDWACONB    WL0025           Invoice Number
     C                     MOVELWACEST    WL0026    P      Invoice Suffix
     C                     Z-ADDWN0001    WL0027           ARHN Note Numbe
     C                     Z-ADDWN0021    WL0028           ARHN Note Line
     C                     MOVELWN0022    WL0029    P      ARHN Detail Not
     C                     MOVELWN0012    WL0030    P      Record Status
     C                     Z-ADDWN0013    WL0031           Create Date
     C                     Z-ADDWN0014    WL0032           Create Time
     C                     MOVELWN0015    WL0033    P      Create User
     C                     MOVELWN0016    WL0034    P      Create Program
     C                     Z-ADDWN0017    WL0035           Change Date
     C                     Z-ADDWN0018    WL0036           Change Time
     C                     MOVELWN0019    WL0037    P      Change User
     C                     MOVELWN0020    WL0038    P      Change Program
     C                     EXSR SFCRRC
      * CASE: DB1.Note Line 2 is Entered
     C           WAA5T1    IFNE *BLANK                     *IF
     C                     Z-ADD2         WN0021           ARHN Note Line
     C                     MOVEL*BLANK    WN0022           ARHN Detail Not
     C                     MOVELWAA5T1    WN0022           ARHN Detail Not
      * Crt Note Detail       CR - A/R Header Note Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0024           Company Number
     C                     Z-ADDWACONB    WL0025           Invoice Number
     C                     MOVELWACEST    WL0026    P      Invoice Suffix
     C                     Z-ADDWN0001    WL0027           ARHN Note Numbe
     C                     Z-ADDWN0021    WL0028           ARHN Note Line
     C                     MOVELWN0022    WL0029    P      ARHN Detail Not
     C                     MOVELWN0012    WL0030    P      Record Status
     C                     Z-ADDWN0013    WL0031           Create Date
     C                     Z-ADDWN0014    WL0032           Create Time
     C                     MOVELWN0015    WL0033    P      Create User
     C                     MOVELWN0016    WL0034    P      Create Program
     C                     Z-ADDWN0017    WL0035           Change Date
     C                     Z-ADDWN0018    WL0036           Change Time
     C                     MOVELWN0019    WL0037    P      Change User
     C                     MOVELWN0020    WL0038    P      Change Program
     C                     EXSR SFCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Note Line 2 is Entered
     C           WAA5T1    IFNE *BLANK                     *IF
     C                     Z-ADD1         WN0021           ARHN Note Line
     C                     MOVEL*BLANK    WN0022           ARHN Detail Not
     C                     MOVELWAA5T1    WN0022           ARHN Detail Not
      * Crt A/R Hdr Note Dtls CR - A/R Header Note Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWACONB    WL0002           Invoice Number
     C                     MOVELWACEST    WL0003    P      Invoice Suffix
     C                     Z-ADDWN0001    WL0004           ARHN Note Numbe
     C                     Z-ADDWN0002    WL0005           ARHN Note Date
     C                     Z-ADDWN0003    WL0006           ARHN Note Time
     C                     MOVELWN0004    WL0007    P      ARHN Note Creat
     C                     Z-ADDWN0005    WL0008           ARHN Follow Up
     C                     MOVELWN0006    WL0009    P      ARHN Follow Up
     C                     Z-ADDWN0007    WL0010           ARHN Follow Up
     C                     Z-ADDWN0008    WL0011           ARHN Follow Up
     C                     MOVELWN0009    WL0012    P      ARHN Follow Up
     C                     Z-ADDWN0010    WL0013           A/R Customer Nu
     C                     MOVELWN0011    WL0014    P      Sales Route Cod
     C                     MOVELWN0012    WL0015    P      Record Status
     C                     Z-ADDWN0013    WL0016           Create Date
     C                     Z-ADDWN0014    WL0017           Create Time
     C                     MOVELWN0015    WL0018    P      Create User
     C                     MOVELWN0016    WL0019    P      Create Program
     C                     Z-ADDWN0017    WL0020           Change Date
     C                     Z-ADDWN0018    WL0021           Change Time
     C                     MOVELWN0019    WL0022    P      Change User
     C                     MOVELWN0020    WL0023    P      Change Program
     C                     EXSR SECRRC
      * Crt Note Detail       CR - A/R Header Note Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0024           Company Number
     C                     Z-ADDWACONB    WL0025           Invoice Number
     C                     MOVELWACEST    WL0026    P      Invoice Suffix
     C                     Z-ADDWN0001    WL0027           ARHN Note Numbe
     C                     Z-ADDWN0021    WL0028           ARHN Note Line
     C                     MOVELWN0022    WL0029    P      ARHN Detail Not
     C                     MOVELWN0012    WL0030    P      Record Status
     C                     Z-ADDWN0013    WL0031           Create Date
     C                     Z-ADDWN0014    WL0032           Create Time
     C                     MOVELWN0015    WL0033    P      Create User
     C                     MOVELWN0016    WL0034    P      Create Program
     C                     Z-ADDWN0017    WL0035           Change Date
     C                     Z-ADDWN0018    WL0036           Change Time
     C                     MOVELWN0019    WL0037    P      Change User
     C                     MOVELWN0020    WL0038    P      Change Program
     C                     EXSR SFCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BURELN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * CVT AR Notes          RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBCONB           Invoice Number
     C                     KFLD           WBCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWACONB    WBCONB           Invoice Number
     C                     MOVELWACEST    WBCEST           Invoice Suffix
      * Establish starting position
     C           KRSSB     CHAIN@BDCPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0001           Remaining Balan
     C                     MOVEL*BLANK    YL0002           Purge Status
     C                     MOVEL*BLANK    WN0011           Sales Route Cod
     C                     Z-ADD*ZERO     WN0010           A/R Customer Nu
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBBGVA    YL0001           Remaining Balan
     C                     MOVELWBE3ST    YL0002           Purge Status
     C                     MOVELWBR4CD    WN0011           Sales Route Cod
     C                     Z-ADDWBANC7    WN0010           A/R Customer Nu
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence     RT - A/R Header Note Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCCONB    WQSC02           Invoice Number
     C           *LIKE     DEFN WCCEST    WQSC03           Invoice Suffix
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Invoice Number
     C                     KFLD           WQSC03           Invoice Suffix
      * Setup key
     C                     Z-ADDWAAIC3    WQSC01           Company Number
     C                     Z-ADDWACONB    WQSC02           Invoice Number
     C                     MOVELWACEST    WQSC03           Invoice Suffix
      * Establish starting position
     C           KRSSC     SETLL@EDCPVJ                    *
     C           KRSSC     READE@EDCPVJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4014' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0001           ARHN Note Numbe
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WCNBNY    ADD  1         WN0001           ARHN Note Numbe
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@EDCPVJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Sales Route        RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     Z-ADDWABKC7    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@EOREXM              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDR4CD    WN0011           Sales Route Cod
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt A/R Hdr Note Dtls CR - A/R Header Note Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EDCPVE
     C                     Z-ADDWL0001    WEAIC3           Company Number
     C                     Z-ADDWL0002    WECONB           Invoice Number
     C                     MOVELWL0003    WECEST           Invoice Suffix
     C                     Z-ADDWL0004    WENBNY           ARHN Note Numbe
     C                     Z-ADDWL0005    WESLDT           ARHN Note Date
     C                     Z-ADDWL0006    WEDETM           ARHN Note Time
     C                     MOVELWL0007    WEENVN           ARHN Note Creat
     C                     Z-ADDWL0008    WESMDT           ARHN Follow Up
     C                     MOVELWL0009    WEFUPS           ARHN Follow Up
     C                     Z-ADDWL0010    WESNDT           ARHN Follow Up
     C                     Z-ADDWL0011    WEDFTM           ARHN Follow Up
     C                     MOVELWL0012    WEEMVN           ARHN Follow Up
     C                     Z-ADDWL0013    WEANC7           A/R Customer Nu
     C                     MOVELWL0014    WER4CD           Sales Route Cod
     C                     MOVELWL0015    WEVSST           Record Status
     C                     Z-ADDWL0016    WEMJDT           Create Date
     C                     Z-ADDWL0017    WEBETM           Create Time
     C                     MOVELWL0018    WECCVN           Create User
     C                     MOVELWL0019    WECDVN           Create Program
     C                     Z-ADDWL0020    WEMKDT           Change Date
     C                     Z-ADDWL0021    WEBFTM           Change Time
     C                     MOVELWL0022    WECEVN           Change User
     C                     MOVELWL0023    WECFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WEVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WEMJDT           Create Date
     C                     Z-ADD##JTM     WEBETM           Create Time
     C                     MOVEL##USR     WECCVN           Create User
     C                     MOVEL##PGM     WECDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
     C                     MOVEL*BLANK    WECEVN           Change User
     C                     MOVEL*BLANK    WECFVN           Change Program
     C           KLCRSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WECONB           Invoice Number
     C                     KFLD           WECEST           Invoice Suffix
     C                     KFLD           WENBNY           ARHN Note Numbe
      * Check for duplicate primary key
     C           KLCRSE    SETLL@EDCPVE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4015' W0RTN   7
      * Send message 'A/R Header Note Header EX'
     C                     MOVEL'USR4015' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@EDCPVE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt Note Detail       CR - A/R Header Note Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EFCPVY
     C                     Z-ADDWL0024    WFAIC3           Company Number
     C                     Z-ADDWL0025    WFCONB           Invoice Number
     C                     MOVELWL0026    WFCEST           Invoice Suffix
     C                     Z-ADDWL0027    WFNBNY           ARHN Note Numbe
     C                     Z-ADDWL0028    WFNCNY           ARHN Note Line
     C                     MOVELWL0029    WFSWNA           ARHN Detail Not
     C                     MOVELWL0030    WFVSST           Record Status
     C                     Z-ADDWL0031    WFMJDT           Create Date
     C                     Z-ADDWL0032    WFBETM           Create Time
     C                     MOVELWL0033    WFCCVN           Create User
     C                     MOVELWL0034    WFCDVN           Create Program
     C                     Z-ADDWL0035    WFMKDT           Change Date
     C                     Z-ADDWL0036    WFBFTM           Change Time
     C                     MOVELWL0037    WFCEVN           Change User
     C                     MOVELWL0038    WFCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WFVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WFMJDT           Create Date
     C                     Z-ADD##JTM     WFBETM           Create Time
     C                     MOVEL##USR     WFCCVN           Create User
     C                     MOVEL##PGM     WFCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
     C                     MOVEL*BLANK    WFCEVN           Change User
     C                     MOVEL*BLANK    WFCFVN           Change Program
     C           KLCRSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFCONB           Invoice Number
     C                     KFLD           WFCEST           Invoice Suffix
     C                     KFLD           WFNBNY           ARHN Note Numbe
     C                     KFLD           WFNCNY           ARHN Note Line
      * Check for duplicate primary key
     C           KLCRSF    SETLL@EFCPVY                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4021' W0RTN   7
      * Send message 'A/R Header Note1899443'
     C                     MOVEL'USR4021' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@EFCPVY                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAOTDT           Note Date
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WAOUDT           Follow-up Date
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WBAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WBAOVA           Amount Paid
     C                     Z-ADD*ZERO     WBBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WBCAC7           Order Number Re
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WBATDT           Due Date
     C                     Z-ADD*ZERO     WBH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WBH3DT           Unused Date Cod
     C                     Z-ADD*ZERO     WBH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WBH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBSDY           Days to Pay
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCNBNY           ARHN Note Numbe
     C                     Z-ADD*ZERO     WCSLDT           ARHN Note Date
     C                     Z-ADD*ZERO     WCDETM           ARHN Note Time
     C                     Z-ADD*ZERO     WCSMDT           ARHN Follow Up
     C                     Z-ADD*ZERO     WCSNDT           ARHN Follow Up
     C                     Z-ADD*ZERO     WCDFTM           ARHN Follow Up
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDR5NB           Deliver after t
     C                     Z-ADD*ZERO     WDR6NB           Deliver before
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WDW2NB           Freight Overage
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFNBNY           ARHN Note Numbe
     C                     Z-ADD*ZERO     WFNCNY           ARHN Note Line
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SECRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     Z-ADD*ZERO     WL0004  50
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  40
     C                     MOVEL*BLANK    WL0007 10
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  1
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  60
     C                     MOVEL*BLANK    WL0012 10
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014  3
     C                     MOVEL*BLANK    WL0015  1
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  60
     C                     MOVEL*BLANK    WL0018 10
     C                     MOVEL*BLANK    WL0019 10
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  60
     C                     MOVEL*BLANK    WL0022 10
     C                     MOVEL*BLANK    WL0023 10
      * Define local variables for subroutine SFCRRC.
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  70
     C                     MOVEL*BLANK    WL0026  2
     C                     Z-ADD*ZERO     WL0027  50
     C                     Z-ADD*ZERO     WL0028  50
     C                     MOVEL*BLANK    WL0029 60
     C                     MOVEL*BLANK    WL0030  1
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  60
     C                     MOVEL*BLANK    WL0033 10
     C                     MOVEL*BLANK    WL0034 10
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  60
     C                     MOVEL*BLANK    WL0037 10
     C                     MOVEL*BLANK    WL0038 10
      * Define local work field Remaining Balance Due
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field Purge Status
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field First Letter 1 USR
     C                     MOVEL*BLANK    YL0003  1
      *================================================================
     CSR         ZZEXIT    ENDSR
