     H/TITLE WW Load Plans ALL      DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPJAKH
     H* Date          : 04/12/24  Time  : 08:08:27
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDNUDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Load Plans ALL      DF Display file
      *
     FOMFJCPMSIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Load Header               SchSh(D/Seq/RqDlv/Loa
      *
     FPNFOREL1IF  E           K        DISK
      * RTV : User Application Whs      Retrieval index
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FPDKECPL1IF  E           K        DISK
      * RTV : Traffic Comments          Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOMFJCPLMIF  E           K        DISK
      * RSQ : Load Header               Car/SSD
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFJCPLJIF  E           K        DISK
      * RSQ : Load Header               RqsDlv/Co/SchSh/Seq(D)/L
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier Info              Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 037  5 0A
     E                    W0END   7 037  5 0A
     E                    W0NAM   7 037 10
      * Long constants
     E                    @CN#    1  09  6   @CN    25
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WCRMNB
     I              FLRUNB                          WCRUNB
     I              FLRVNB                          WCRVNB
     I              FLDQTX                          WCDQTX
     I              FLRWNB                          WCRWNB
     I              FLRXNB                          WCRXNB
     I              FLSQNB                          WCSQNB
     I              FLT0NB                          WCT0NB
     I              FLT1NB                          WCT1NB
     I              FLR1NB                          WCR1NB
     I              FLAIC3                          WCAIC3
     I              FLC4NB                          WCC4NB
     I              FLVCST                          WCVCST
     I              FLKEDT                          WCKEDT
     I              FLSXNB                          WCSXNB
     I              FLKFDT                          WCKFDT
     I              FLACTM                          WCACTM
     I              FLK5TX                          WCK5TX
     I              FLW5CD                          WCW5CD
     I              FLEJDT                          WCEJDT
     I              FLAGTM                          WCAGTM
     I              FLKJDT                          WCKJDT
     I              FLATTM                          WCATTM
     I              FLHDDT                          WCHDDT
     I              FLAUTM                          WCAUTM
     I              FLKKDT                          WCKKDT
     I              FLAVTM                          WCAVTM
     I              FLZ4NB                          WCZ4NB
     I              FLY7ST                          WCY7ST
     I              FLY2ST                          WCY2ST
     I              FLWHTX                          WCWHTX
     I              FLWITX                          WCWITX
     I              FLWJTX                          WCWJTX
     I              FLWKTX                          WCWKTX
     I              FLWLTX                          WCWLTX
     I              FLN7DT                          WCN7DT
     I              FLN8DT                          WCN8DT
     I              FLN9DT                          WCN9DT
     I              FLB3TM                          WCB3TM
     I              FLB4TM                          WCB4TM
     I              FLB5TM                          WCB5TM
     I              FLIASX                          WCIASX
     I              FLIBSX                          WCIBSX
     I              FLICSX                          WCICSX
     I              FLWVTX                          WCWVTX
     I              FLWWTX                          WCWWTX
     I              FLWXTX                          WCWXTX
     I              FLUVST                          WCUVST
     I              FLUWST                          WCUWST
     I              FLUXST                          WCUXST
     I              FLAATM                          WCAATM
     I              FLAYNA                          WCAYNA
     I              FLA0NA                          WCA0NA
     I              FLAXDT                          WCAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WDRMNB
     I              FLRUNB                          WDRUNB
     I              FLRVNB                          WDRVNB
     I              FLDQTX                          WDDQTX
     I              FLRWNB                          WDRWNB
     I              FLRXNB                          WDRXNB
     I              FLSQNB                          WDSQNB
     I              FLT0NB                          WDT0NB
     I              FLT1NB                          WDT1NB
     I              FLR1NB                          WDR1NB
     I              FLAIC3                          WDAIC3
     I              FLC4NB                          WDC4NB
     I              FLVCST                          WDVCST
     I              FLKEDT                          WDKEDT
     I              FLSXNB                          WDSXNB
     I              FLKFDT                          WDKFDT
     I              FLACTM                          WDACTM
     I              FLK5TX                          WDK5TX
     I              FLW5CD                          WDW5CD
     I              FLEJDT                          WDEJDT
     I              FLAGTM                          WDAGTM
     I              FLKJDT                          WDKJDT
     I              FLATTM                          WDATTM
     I              FLHDDT                          WDHDDT
     I              FLAUTM                          WDAUTM
     I              FLKKDT                          WDKKDT
     I              FLAVTM                          WDAVTM
     I              FLZ4NB                          WDZ4NB
     I              FLY7ST                          WDY7ST
     I              FLY2ST                          WDY2ST
     I              FLWHTX                          WDWHTX
     I              FLWITX                          WDWITX
     I              FLWJTX                          WDWJTX
     I              FLWKTX                          WDWKTX
     I              FLWLTX                          WDWLTX
     I              FLN7DT                          WDN7DT
     I              FLN8DT                          WDN8DT
     I              FLN9DT                          WDN9DT
     I              FLB3TM                          WDB3TM
     I              FLB4TM                          WDB4TM
     I              FLB5TM                          WDB5TM
     I              FLIASX                          WDIASX
     I              FLIBSX                          WDIBSX
     I              FLICSX                          WDICSX
     I              FLWVTX                          WDWVTX
     I              FLWWTX                          WDWWTX
     I              FLWXTX                          WDWXTX
     I              FLUVST                          WDUVST
     I              FLUWST                          WDUWST
     I              FLUXST                          WDUXST
     I              FLAATM                          WDAATM
     I              FLAYNA                          WDAYNA
     I              FLA0NA                          WDA0NA
     I              FLAXDT                          WDAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
     I@FJCPRX
      * Load Header               Car/SSD
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
     I@FJCPQO
      * Load Header               RqsDlv/Co/SchSh/Seq(D)/L
      * Renamed input format fields
     I              FJRMNB                          WGRMNB
     I              FJAIC3                          WGAIC3
     I              FJAODT                          WGAODT
     I              FJPJST                          WGPJST
     I              FJPKST                          WGPKST
     I              FJRNNB                          WGRNNB
     I              FJDMTX                          WGDMTX
     I              FJDNTX                          WGDNTX
     I              FJDOTX                          WGDOTX
     I              FJWTTX                          WGWTTX
     I              FJWUTX                          WGWUTX
     I              FJRPNB                          WGRPNB
     I              FJFLAM                          WGFLAM
     I              FJXQST                          WGXQST
     I              FJRRNB                          WGRRNB
     I              FJDXTX                          WGDXTX
     I              FJDYTX                          WGDYTX
     I              FJSBNB                          WGSBNB
     I              FJBZNA                          WGBZNA
     I              FJRONB                          WGRONB
     I              FJSQNB                          WGSQNB
     I              FJR1NB                          WGR1NB
     I              FJVCST                          WGVCST
     I              FJVDST                          WGVDST
     I              FJSDNB                          WGSDNB
     I              FJPAOU                          WGPAOU
     I              FJDGWG                          WGDGWG
     I              FJSXNB                          WGSXNB
     I              FJHADT                          WGHADT
     I              FJAART                          WGAART
     I              FJDHWG                          WGDHWG
     I              FJDIWG                          WGDIWG
     I              FJAQDT                          WGAQDT
     I              FJS6NB                          WGS6NB
     I              FJT4NB                          WGT4NB
     I              FJPRTM                          WGPRTM
     I              FJNPSV                          WGNPSV
     I              FJJ8TX                          WGJ8TX
     I              FJTLMI                          WGTLMI
     I              FJJ9TX                          WGJ9TX
     I              FJQ2CD                          WGQ2CD
     I              FJVPCD                          WGVPCD
     I              FJDBCD                          WGDBCD
     I              FJGRWE                          WGGRWE
     I              FJXCCD                          WGXCCD
     I              FJU2ST                          WGU2ST
     I              FJF9DT                          WGF9DT
     I              FJONTM                          WGONTM
     I              FJJ4DT                          WGJ4DT
     I              FJTRTM                          WGTRTM
     I              FJJ5DT                          WGJ5DT
     I              FJSPTM                          WGSPTM
     I              FJJ6DT                          WGJ6DT
     I              FJLFTM                          WGLFTM
     I              FJJ7DT                          WGJ7DT
     I              FJBOTM                          WGBOTM
     I              FJJ8DT                          WGJ8DT
     I              FJBLTM                          WGBLTM
     I              FJKIDT                          WGKIDT
     I              FJASTM                          WGASTM
     I              FJKADT                          WGKADT
     I              FJAJCM                          WGAJCM
     I              FJXACD                          WGXACD
     I              FJOANA                          WGOANA
     I              FJK4TX                          WGK4TX
     I              FJVOAG                          WGVOAG
     I              FJKBDT                          WGKBDT
     I              FJNBBO                          WGNBBO
     I              FJW4CD                          WGW4CD
     I              FJEFDT                          WGEFDT
     I              FJCNTN                          WGCNTN
     I              FJKCDT                          WGKCDT
     I              FJTMIN                          WGTMIN
     I              FJKDDT                          WGKDDT
     I              FJVMNB                          WGVMNB
     I              FJOCFR                          WGOCFR
     I              FJKJDT                          WGKJDT
     I              FJATTM                          WGATTM
     I              FJOTRS                          WGOTRS
     I              FJRNST                          WGRNST
     I              FJBRBK                          WGBRBK
     I              FJEIDT                          WGEIDT
     I              FJRMST                          WGRMST
     I              FJAJCD                          WGAJCD
     I              FJKKDT                          WGKKDT
     I              FJAVTM                          WGAVTM
     I              FJKZDT                          WGKZDT
     I              FJAXTM                          WGAXTM
     I              FJLHOS                          WGLHOS
     I              FJLHOR                          WGLHOR
     I              FJWNTX                          WGWNTX
     I              FJOITX                          WGOITX
     I              FJOJTX                          WGOJTX
     I              FJLLDT                          WGLLDT
     I              FJLSHG                          WGLSHG
     I              FJYPST                          WGYPST
     I              FJK0DT                          WGK0DT
     I              FJAYTM                          WGAYTM
     I              FJKNNX                          WGKNNX
     I              FJICWG                          WGICWG
     I              FJIDWG                          WGIDWG
     I              FJH9SX                          WGH9SX
     I              FJWOTX                          WGWOTX
     I              FJK1DT                          WGK1DT
     I              FJAZTM                          WGAZTM
     I              FJK2DT                          WGK2DT
     I              FJA0TM                          WGA0TM
     I              FJROST                          WGROST
     I              FJRPST                          WGRPST
     I              FJRQST                          WGRQST
     I              FJRRST                          WGRRST
     I              FJZBVA                          WGZBVA
     I              FJWPTX                          WGWPTX
     I              FJWQTX                          WGWQTX
     I              FJWRTX                          WGWRTX
     I              FJWSTX                          WGWSTX
     I              FJRVSX                          WGRVSX
     I              FJRUSX                          WGRUSX
     I              FJRWSX                          WGRWSX
     I              FJRXSX                          WGRXSX
     I              FJRYSX                          WGRYSX
     I              FJRZSX                          WGRZSX
     I              FJR0SX                          WGR0SX
     I              FJR1SX                          WGR1SX
     I              FJR2SX                          WGR2SX
     I              FJR3SX                          WGR3SX
     I              FJR4SX                          WGR4SX
     I              FJPYDT                          WGPYDT
     I              FJCKTM                          WGCKTM
     I              FJPZDT                          WGPZDT
     I              FJCLTM                          WGCLTM
     I              FJP0DT                          WGP0DT
     I              FJCMTM                          WGCMTM
     I              FJP1DT                          WGP1DT
     I              FJCNTM                          WGCNTM
     I              FJP2DT                          WGP2DT
     I              FJCOTM                          WGCOTM
     I              FJP3DT                          WGP3DT
     I              FJCQTM                          WGCQTM
     I              FJUVST                          WGUVST
     I              FJUWST                          WGUWST
     I              FJUXST                          WGUXST
     I              FJAATM                          WGAATM
     I              FJAYNA                          WGAYNA
     I              FJA0NA                          WGA0NA
     I              FJAXDT                          WGAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                             23
      * KEY : Trailer                   Retrieval index
      * I :  Carrier Code
     I                                        1   3 PABZNA
      * I :  Trailer Id
     I                                        4  23 PADXTX
      *
      * Outward parameters
     IPBRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I : RST Load ID
     I                                    P   1   40PBRMNB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Enterprise Code 1
     I                                        6   9 P1DQCD
      * N :  Enterprise Code 2
     I                                       10  21 P1DRCD
      * N :  Salesperson Code
     I                                       22  24 P1BCCD
      * N :  System Date Format
     I                                       25  27 P1B8NA
      * N :  User Profile Name
     I                                       28  37 P1AJVN
      * N :  Allow Multi-Company
     I                                       38  38 P1I6ST
      * N :  Default Printer
     I                                       39  48 P1MPNA
      * N :  First Time Flag
     I                                       49  49 P1TAST
      * N :  Requested Delivery Date
     I                                    P  50  530P1EIDT
     IP2PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P2G3TX
      * N :  PRT Printer Device
     I                                       26  35 P2WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P2WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P2WTST
      * N :  PRT Number of Copies
     I                                       44  450P2DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P2WUST
      * N :  PRT Night Queue
     I                                       47  56 P2BVVN
      * N :  Company Number Pass   USR
     I                                    P  57  645P2AJAA
      * N :  Date 1          PASS  USR
     I                                    P  65  725P2AJAB
      * N :  Order Number 1  PASS  USR
     I                                    P  73  805P2AJAE
      * N :  System Value Numeric
     I                                    P  81  885P2M8NB
      * N :  Status - Y or N
     I                                       89  89 P2B8ST
      * N :  Change Flag USR
     I                                       90  90 P2HWSX
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Scheduled Ship Date
     I                                    P   1   40P3AODT
      * N :  Display Prt Opt Pmt USR
     I                                        5   8 P3XFST
      * N :  USR Output Only Status
     I                                        9   9 P3E5ST
      * N :  USR Print Detail
     I                                       10  10 P3E7ST
      * N :  Seq No 1  PASS        USR
     I                                    P  11  185P3SEQ1
      * N :  USR Update Flag
     I                                       19  19 P3R4ST
      * N : MAP Error Status
     I                                       20  20 P3ECST
      * N :  USR Weight Accumulated
     I                                    P  21  262P3CDWG
     IP4PARM      DS
      * N :  Salesperson Code 1
     I                                        1   3 P4DFCD
     IP5PARM      DS
      * N :  Job Name CDE
     I                                        1  10 P5B2VN
     IP6PARM      DS
      * N :  USR Flag 1
     I                                        1   1 P6D4ST
     IP7PARM      DS
      * FLD: Load Header
      * N :  Load ID
     I                                    P   1   40P7RMNB
      * N :  Carrier Code
     I                                        5   7 P7BZNA
     IP8PARM      DS
      * N :  Job Name
     I                                        1  10 P8A0NA
     IP9PARM      DS
      * N :  USR Quit
     I                                        1   1 P9
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0001
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0002
      * Warehouse Code
     I                                       11  13 ZA0003
      * Message data for 'Warehouse Codes        NF'
      * Warehouse Code
     I                                        1   3 ZA0004
      * Message data for 'Live TMS Function Invalid'
      * *CMD key
     I                                        1   2 ZA0005
      * Message data for 'Must enter Sched Ship...'
      * Scheduled Ship Date
     I                                    P   1   40ZA0006
      * Carrier Code
     I                                        5   7 ZA0007
      * Message data for 'No Loads Unconfirmed'
      * Carrier Code
     I                                        1   3 ZA0008
      * Scheduled Ship Date
     I                                    P   4   70ZA0009
      * Message data for 'Company Number  7.0 Not F'
      * Company Number CDE
     I                                    P   1   20ZA0010
      * Message data for 'Salesperson            NF'
      * Message data for 'OM Load Header not found'
      * Load ID
     I                                    P   1   40ZA0011
      * Message data for 'Live TMS Option Invalid'
      * SH Order Sales Channel
     I                                        1   2 ZA0012
      * Message data for 'Carrier must be entered'
      * Carrier Code
     I                                        1   3 ZA0013
      * Load ID
     I                                    P   4   70ZA0014
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0015
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0016
      * Message data for 'Carrier entered to Fax'
      * *SFLSEL
     I                                        1   1 ZA0017
      * Carrier Code
     I                                        2   4 ZA0018
      * Message data for 'BOL RePrint Invalid'
      * *SFLSEL
     I                                        1   1 ZA0019
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0020
      * Application Code
     I                                       11  16 ZA0021
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0022
      * Application Code
     I                                       11  16 ZA0023
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * FIRST TIME
      * CASE: PAR.First Time Flag is Yes
     C           P1TAST    IFEQ 'Y'                        *IF
      * ** Re-instated loading the company number on the screen per
      * ** request. This is protected if Allow Multi-Company is no
      * RMC  3/1/6 Dont default
      * CASE: PAR.Allow Multi-Company is no
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
     C                     END                             *FI
      * CASE: LCL.Application WHS Restrict is no
     C           YL0001    IFEQ 'N'                        *IF
     C                     MOVELP1BCCD    #CBCCD           Salesperson Cod
     C                     END                             *FI
     C                     MOVELP1BCCD    P4DFCD           Salesperson Cod
     C                     MOVEL'INC'     #CVQCD           Include/Exclude
     C                     MOVEL'N'       P1TAST           First Time Flag
     C                     Z-ADD*ZERO     WUG0NX           Numeric 4,0
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Rtv 1st Warehouse     RT - User Application Whs  * 
     C                     EXSR SARVGN
     C                     END                             *FI
     C                     END                             *FI
      * RTV Salesperson        RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CBCCD    WL0001    P      Salesperson Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CALTX    P      Salesperson Nam
      * If load id is entered retrieve delivery date
      * CASE: CTL.Load ID is NE Blank
     C           #2RMNB    IFNE *ZERO                      *IF
      * RTV Sched ShipDte,Seq  RT - Load Header  * 
     C                     EXSR SCRVGN
     C                     Z-ADD#2T4NB    #CG0NX           Numeric 4,0
     C                     Z-ADD#CG0NX    WUG0NX           Numeric 4,0
     C                     END                             *FI
     C                     MOVEL#C        YL0002           Ship Method Typ
     C                     MOVEL#CCPCD    YL0003           USR Warehouse C
      * *Set Cursor: CTL.Load ID  (*Override=*YES)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD011       W0ROW0
     C                     Z-ADD005       W0COL0
     C                     MOVEL'1'       W0OVR0           *YES
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           FJAODT           Scheduled Ship
     C                     KFLD           FJT4NB           Schedule Sequen
     C                     KFLD           FJEIDT           Requested Deliv
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C           #2AODT    IFEQ *ZERO
     C                     MOVEL*HIVAL    FJAODT           Scheduled Ship
     C                     ELSE
     C                     Z-ADD#2AODT    FJAODT
     C                     ENDIF
     C                     Z-ADD#2T4NB    FJT4NB
     C                     Z-ADD#2EIDT    FJEIDT
     C                     Z-ADD#2RMNB    FJRMNB
     C           KPOS      SETLL@FJCPQJ
     C                     READ @FJCPQJ                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2T4NB    WZT4NB
     C                     MOVEL#2T4NB    WZT4NB           Schedule Sequen
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2TLMI    WZTLMI
     C                     MOVEL#2TLMI    WZTLMI           Total Load Mile
     C           *LIKE     DEFN #2RPNB    WZRPNB
     C                     MOVEL#2RPNB    WZRPNB           Total Load Orde
     C           *LIKE     DEFN #2DXTX    WZDXTX
     C                     MOVEL#2DXTX    WZDXTX           Trailer Id
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2PKST    WZPKST
     C                     MOVEL#2PKST    WZPKST           Load Status
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
     C           *LIKE     DEFN #2BZNA    WZBZNA
     C                     MOVEL#2BZNA    WZBZNA           Carrier Code
     C           *LIKE     DEFN #2H9SX    WZH9SX
     C                     MOVEL#2H9SX    WZH9SX           Load Confirmed
     C           *LIKE     DEFN #2Q2CD    WZQ2CD
     C                     MOVEL#2Q2CD    WZQ2CD           Shipping Method
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@FJCPQJ                  90*
     C  N82                READ @FJCPQJ                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,45
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2T4NB    IFNE *ZERO                      Schedule Sequen
     C           FJT4NB    CABLT#2T4NB    BB020            Schedule Sequen
     C                     END
     C                     END
     C           #2VDST    IFNE *BLANK                     Load Type
     C           FJVDST    CABNE#2VDST    BB020            Load Type
     C                     END
     C           #2RPNB    IFNE *ZERO                      Total Load Orde
     C           FJRPNB    CABGT#2RPNB    BB020            Total Load Orde
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2T4NB    OREQ *ZERO                      Schedule Sequen
     C           #2EIDT    OREQ *ZERO                      Requested Deliv
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           FJRMNB    CABLT#2RMNB    BB020            Load ID
     C                     END
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2T4NB    OREQ *ZERO                      Schedule Sequen
     C           #2EIDT    IFNE *ZERO                      Requested Deliv
     C           FJEIDT    CABNE#2EIDT    BB020            Requested Deliv
     C                     END
     C                     END
     C           #2BZNA    IFNE *BLANK                     Carrier Code
     C           FJBZNA    CABNE#2BZNA    BB020            Carrier Code
     C                     END
     C           #2H9SX    IFNE *BLANK                     Load Confirmed
     C           FJH9SX    CABNE#2H9SX    BB020            Load Confirmed
     C                     END
     C           #2Q2CD    IFNE *BLANK                     Shipping Method
     C           FJQ2CD    CABNE#2Q2CD    BB020            Shipping Method
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * If company selection is made, then select only that company
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Company Number is not equal to zero
      *   |- c2    : DB1.Company Number NE CTL.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AIC3    IFNE *ZERO                      *IF
     C           FJAIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Multi Company Load is no
     C           FJRVSX    IFEQ 'N'                        *IF
      * RMC 7/27/06 ADDED THIS CASE FOR MULTI-PICKUP LOADS TO BE SEEN BY
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select salesperson if entered.
      * CASE: CTL.Salesperson Code is entered
     C           #CBCCD    IFNE *BLANK                     *IF
      * RTV Chk Slsprsn on Ord RT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Process INC/EXC option
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: CTL.Load Status EQ WRK.BLANK
     C           #2PKST    IFEQ WUGSTX                     *IF
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Include
     C           #CVQCD    IFEQ 'INC'                      *IF
      * Select only records which match CTL load status
      * CASE: DB1.Load Status NE CTL.Load Status
     C           FJPKST    IFNE #2PKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Exclude
     C           #CVQCD    IFEQ 'EXC'                      *IF
      * Select only records which do NOT match CTL load status
      * CASE: DB1.Load Status EQ CTL.Load Status
     C           FJPKST    IFEQ #2PKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Fill trailer ID on screen
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELFJDXTX    #RS2TX           Trailer ID USR
     C                     END                             *FI
      * Get Last Stop on Order   -- TRF011 scan for ctl.last stop city 7/
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Last Stop Consign  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0003           Load ID
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WUBKC7           Ship To Custome
     C                     MOVELWL0005    WUBRTX    P      Ship To Name
     C                     MOVELWL0006    WUHMNA    P      Ship To Address
     C                     MOVELWL0007    WUHONA    P      Ship To Address
     C                     MOVELWL0008    WUHPNA    P      Ship To Address
     C                     MOVELWL0009    WUHNNA    P      Ship To City
     C                     MOVELWL0010    #RV9CD    P      Ship To State C
     C                     MOVELWL0011    WUCKTX    P      Ship To Zip_Pos
     C                     MOVELWUHNNA    #RY7TX           Text USR 5
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Ship To State Code is State code not Blanks
      *   |- c2    : RCD.USR State Code NE CTL.Ship To State Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2DBCD    IFNE *BLANK                     *IF
     C           #RV9CD    IFNE #2DBCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Scan for Ctl.last stop city         TRF011 RMC 7/28/06
      * CASE: CTL.Text 5 all caps     USR is Entered
     C           #CIQT1    IFNE *BLANK                     *IF
      * CLC Call Qclscan       UP - /UT User Source  * 
     C                     CALL 'QCLSCAN'              90  CLC Call Qclsca
     C                     PARM WUHNNA    WQ0001256        USR Qclscan fie
     C                     PARM 20        WQ0002  30       USR Qclscan Len
     C                     PARM 1         WQ0003  30       USR Qclscan Sta
     C                     PARM #CIQT1    WQ0004256        USR Qclscan Mas
     C                     PARM 5         WQ0005  30       USR Qclscan Mas
     C                     PARM '1'       WQ0006  1        USR Qclscan Tra
     C                     PARM '1'       WQ0007  1        USR Qclscan Tri
     C                     PARM *BLANK    WQ0008  1        USR Qclscan Wil
     C           WUY8NB    PARM WUY8NB    WQ0009  30       USR Qclscan Res
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'QCLSCAN' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
     C                     END
      * CASE: WRK.USR Qclscan Result ? is Does contain
     C           WUY8NB    IFGT 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Restrict on Trailer Id  field
      * CASE: CTL.Trailer ID USR NE WRK.BLANK
     C           #CS2TX    IFNE WUGSTX                     *IF
      * CASE: RCD.Trailer ID USR NE CTL.Trailer ID USR
     C           #RS2TX    IFNE #CS2TX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Restrict on Delivery Checked field
      * CASE: CTL.Status - Y or N is Y/N Values
     C           #CB8ST    IFEQ 'N'                        *IF
     C           #CB8ST    OREQ 'Y'
      * CASE: RCD.Status - Y or N NE CTL.Status - Y or N
     C           #RB8ST    IFNE #CB8ST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * 02/27/08 PKD Gary Martin wants the regular shipping method
      *              instead of the ship method type. Made the Ship Metho
      *              Type field and description hidden. Leaving the code
      *              to populate it. Just incase they want it back.
     C                     Z-ADD1         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00002
     C           ZQ        ORGT 00002
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST#1Q2CD:ZQ #R        P  90  Ship Method Typ
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * RCD.Generic Heading 1 - 5 = Condition name of RCD.Ship Method Typ
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1864398   Y2LSNO  70       List number
     C                     PARM #R        W0INVL 25        Ship Method Typ
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #RYPTX    PARM           W0CNNM 25        Generic Heading
      *
      * SEL: Ship Method Type
      * CASE: CTL.Ship Method Type USR is *ALL values
     C           #C        IFEQ 'R'                        *IF
     C           #C        OREQ 'T'
      * CASE: RCD.Ship Method Type USR NE CTL.Ship Method Type USR
     C           #R        IFNE #C                         *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RTV First Order Whse   RT - Load Detail  * 
     C                     EXSR SHRVGN
      * SEL: CTL.USR Warehouse Code
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * SEL: Warehouse Code
      * CASE: RCD.USR Warehouse Code NE CTL.USR Warehouse Code
     C           #RCPCD    IFNE #CCPCD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL: Warehouse Code
      * CASE: CTL.USR Warehouse Code is Not Blanks
     C           #CCPCD    IFNE *BLANK                     *IF
      * CASE: RCD.USR Warehouse Code NE CTL.USR Warehouse Code
     C           #RCPCD    IFNE #CCPCD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Delivery Checked field, according to On Time Y/N
      * CASE: DB1.On Time - (Y/N) is Y/N Values
     C           FJONTM    IFEQ 'N'                        *IF
     C           FJONTM    OREQ 'Y'
     C                     MOVEL'Y'       #RB8ST           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RB8ST           Status - Y or N
     C                     END                             *FI
      * *----------------------------------------------------------------
      * * 05/15/00 PKD OMS336 Include the Pallet Tare Weight.
      * * 01/18/10 LJB E000261 If Combos and palletized, subtract Pallet
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
     C                     EXSR SKRVGN
      * *----------------------------------------------------------------
     C                     Z-ADDP3CDWG    #RG2NX           Weight Adjust 6
     C                     MOVEL'N'       P6D4ST           USR Flag 1
      * Set quit flag when reach last load for rqs delivery date
      * CASE: CTL.Requested Delivery Date NE WRK.ZERO
     C           #2EIDT    IFNE WUW0NB                     *IF
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : WRK.Load ID EQ DB1.Load ID
      *   |- c2    : WRK.Scheduled Ship Date EQ DB1.Scheduled Ship Date
      *   |- c3    : WRK.Schedule Sequence Number EQ DB1.Schedule Sequenc
      *   |- c4    : WRK.Company Number EQ DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WURMNB    IFEQ FJRMNB                     *IF
     C           WUAODT    IFEQ FJAODT                     *IF
     C           WUT4NB    IFEQ FJT4NB                     *IF
     C           WUAIC3    IFEQ FJAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Set On Indicator 82    US - /UT User Source  * 
     C                     SETON                     82    SETON INDICATOR
     C                     END                             *FI
     C                     END                             *FI
      * Highlight load number if traffic comments exist
      * RTV Verify Trffc Cmnts RT - Traffic Comments  * 
     C                     EXSR SMRVGN
      * Set Highlight Flag
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       #RKOST           Include Todays
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RKOST           Include Todays
     C                     END                             *FI
     C           FJAXTM    DIV  100       YL0008           USR Deadline De
     C           FJASTM    DIV  100       YL0009           USR Truck Depar
      * Set Highlight Flag - Sched Ship Date
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : DB1.Truck Departure Date GT DB1.Deadline Departure D
      *   |- c2    : DB1.Truck Departure Date EQ DB1.Deadline Departure D
      *   |- c3    : LCL.USR Truck Depart Time GT LCL.USR Deadline Deprt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           FJKIDT    IFGT FJKZDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           FJKIDT    IFEQ FJKZDT                     *IF
     C           YL0009    IFGT YL0008                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       #RE6ST           USR Status (Y/N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RE6ST           USR Status (Y/N
     C                     END                             *FI
      * Set Highlight Flag - if Override miles is displayed
      * CASE: DB1.Override Total Load Miles is Entered
     C           FJK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDFJK2DT    #RG1NX           Total Miles 4,0
     C                     MOVEL'Y'       #RHWSX           Change Flag USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFJTLMI    #RG1NX           Total Miles 4,0
     C                     MOVEL'N'       #RHWSX           Change Flag USR
     C                     END                             *FI
     C                     Z-ADD#1T4NB    #RG0NX           Numeric 4,0
      * ---------------------------------------------------------
      * 01/22/08 PKD Added Selection for Ship Method Type
      * ---------------------------------------------------------
      * SFL Fold/Drop  RPG 2  US - /UT User Source  * 
     C           MODE      IFEQ '0'
     C                     SETON                     89
     C                     ELSE
     C                     SETOF                     89
     C                     ENDIF
      * 090508 slm Multiple companies on a load
      * Val More Then 1 Co    RT - Load Detail  * 
     C                     EXSR SNRVGN
      * E01488 RMC See if any stop has a confirmed appt
      * Val Appt confirm     RT - Load Detail  * 
     C                     EXSR SORVGN
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @FJCPQJ                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Requested Delivery Date
      * External date
     C                     Z-ADDV2EIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDXDINDT    #2EIDT
      * Validate Load Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2PKST'  IFEQ YPMTFD
      * Load Status
     C                     MOVEL#2PKST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFPKST
     C                     SELEC
     C           W0INVL    WHEQ 'U'                        U
     C                     Z-ADD1         ZFPKST
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD2         ZFPKST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZFPKST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD4         ZFPKST
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD5         ZFPKST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD6         ZFPKST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD7         ZFPKST
     C                     ENDSL
     C                     EXFMTZEPKST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFPKST    WHEQ 1
     C                     MOVEL'U'       W0INVL           U
     C           ZFPKST    WHEQ 2
     C                     MOVEL'L'       W0INVL           L
     C           ZFPKST    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C           ZFPKST    WHEQ 4
     C                     MOVEL'E'       W0INVL           E
     C           ZFPKST    WHEQ 5
     C                     MOVEL'C'       W0INVL           C
     C           ZFPKST    WHEQ 6
     C                     MOVEL'I'       W0INVL           I
     C           ZFPKST    WHEQ 7
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2PKST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Status - Y or N
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CB8ST'  IFEQ YPMTFD
      * Status - Y or N
     C                     MOVEL#CB8ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFB8ST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZFB8ST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZFB8ST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZFB8ST
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD4         ZFB8ST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD5         ZFB8ST
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD6         ZFB8ST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD7         ZFB8ST
     C           W0INVL    WHEQ 'Z'                        Z
     C                     Z-ADD8         ZFB8ST
     C           W0INVL    WHEQ 'G'                        G
     C                     Z-ADD9         ZFB8ST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD10        ZFB8ST
     C           W0INVL    WHEQ 'O'                        O
     C                     Z-ADD11        ZFB8ST
     C                     ENDSL
     C                     EXFMTZEB8ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFB8ST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZFB8ST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZFB8ST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFB8ST    WHEQ 4
     C                     MOVEL'F'       W0INVL           F
     C           ZFB8ST    WHEQ 5
     C                     MOVEL'P'       W0INVL           P
     C           ZFB8ST    WHEQ 6
     C                     MOVEL'X'       W0INVL           X
     C           ZFB8ST    WHEQ 7
     C                     MOVEL'E'       W0INVL           E
     C           ZFB8ST    WHEQ 8
     C                     MOVEL'Z'       W0INVL           Z
     C           ZFB8ST    WHEQ 9
     C                     MOVEL'G'       W0INVL           G
     C           ZFB8ST    WHEQ 10
     C                     MOVEL'S'       W0INVL           S
     C           ZFB8ST    WHEQ 11
     C                     MOVEL'O'       W0INVL           O
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CB8ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Load Confirmed Sts
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2H9SX    W0NSRQ  1        Load Confirmed
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2H9SX'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158374   Y2LSNO  70
     C           #2H9SX    PARM #2H9SX    W0EXVL 25        Load Confirmed
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Shipping Method
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2Q2CD'  IFEQ YPMTFD
      * Shipping Method
     C                     MOVEL#2Q2CD    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFQ2CD
     C                     SELEC
     C           W0INVL    WHEQ 'CR'                       CR
     C                     Z-ADD1         ZFQ2CD
     C           W0INVL    WHEQ 'CT'                       CT
     C                     Z-ADD2         ZFQ2CD
     C           W0INVL    WHEQ 'PR'                       PR
     C                     Z-ADD3         ZFQ2CD
     C           W0INVL    WHEQ 'PT'                       PT
     C                     Z-ADD4         ZFQ2CD
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD5         ZFQ2CD
     C                     ENDSL
     C                     EXFMTZEQ2CD
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFQ2CD    WHEQ 1
     C                     MOVEL'CR'      W0INVL           CR
     C           ZFQ2CD    WHEQ 2
     C                     MOVEL'CT'      W0INVL           CT
     C           ZFQ2CD    WHEQ 3
     C                     MOVEL'PR'      W0INVL           PR
     C           ZFQ2CD    WHEQ 4
     C                     MOVEL'PT'      W0INVL           PT
     C           ZFQ2CD    WHEQ 5
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2Q2CD
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * SEL: CTL.USR Warehouse Code
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.USR Warehouse Code
     C           W0CFL     IFEQ '#CCPCD'                   *IF
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Sel User Appl Whs     SR - User Application Whs  * 
     C                     CALL 'PNMMSRR'              90  Sel User Appl W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0017 10        User Profile Na
     C                     PARM 'TRF'     WQ0018  6        Application Cod
     C           #CCPCD    PARM #CCPCD    WQ0019  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #CCPCD    PARM #CCPCD    WQ0020  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Val Warehouse         IF
      * VAL: Warehouse Code
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * CASE: PAR.Warehouse Code is Blanks
     C           #CCPCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CCPCD    ZA0001           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0021 10        User Profile Na
     C                     PARM 'TRF'     WQ0022  6        Application Cod
     C                     PARM #CCPCD    WQ0023  3        Warehouse Code
     C                     PARM *ZERO     WQ0024  70       Item Code
     C           YL0010    PARM *BLANK    WQ0025  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
      * CASE: LCL.WHS/Item Access Sts USR is Access Denied
     C           YL0010    IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0002           *USER
     C                     MOVEL#CCPCD    ZA0003           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Code is Not Blanks
     C           #CCPCD    IFNE *BLANK                     *IF
      * Val Warehouse Exists   RT - Warehouse  * 
     C                     EXSR SPRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     MOVEL#CCPCD    ZA0004           Warehouse Code
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * F5=Refresh
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Salesperson has changed
      * CASE: PAR.Salesperson Code 1 NE CTL.Salesperson Code
     C           P4DFCD    IFNE #CBCCD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#CBCCD    P4DFCD           Salesperson Cod
     C                     END                             *FI
      * Scheduled Seq# change (F2 for second line)
      * CASE: CTL.Numeric 4,0           USR is *Zero
     C           #CG0NX    IFEQ *ZERO                      *IF
      * CASE: CTL.Numeric 4,0           USR NE WRK.Numeric 4,0
     C           #CG0NX    IFNE WUG0NX                     *IF
     C                     Z-ADD*ZERO     #2T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WUG0NX           Numeric 4,0
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Numeric 4,0           USR NE WRK.Numeric 4,0
     C           #CG0NX    IFNE WUG0NX                     *IF
     C                     Z-ADD#CG0NX    #2T4NB           Schedule Sequen
     C                     Z-ADD#CG0NX    WUG0NX           Numeric 4,0
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * ***  E2625 TPM ***
      * E4119  LIVE WITH TMS RESTRICTED FUNCTION KEYS
      * CASE: LCL.Live with TPM is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * CASE: CTL.*CMD key is CF11
     C           *IN11     IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL'11'      ZA0005           *CMD key
      * Send message 'Live TMS Function Invalid'
     C                     MOVEL'USR4602' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * ***  PK0114  ***
      * F11=Confirm Loads
      * CASE: CTL.*CMD key is CF11
     C           *IN11     IFEQ '1'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Scheduled Ship Date is not entered
      *   |- c2    : CTL.Carrier Code is not entered
      *   '-
     C           #2AODT    IFEQ *ZERO                      *IF
     C           #2BZNA    OREQ *BLANK                     *OR
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0006
     C                     MOVEL#2BZNA    ZA0007           Carrier Code
      * Send message 'Must enter Sched Ship...'
     C                     MOVEL'USR2936' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993440*
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL Confirmed Loads    RT - Load Header  * 
     C                     EXSR SQRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#2BZNA    ZA0008           Carrier Code
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Send message 'No Loads Unconfirmed'
     C                     MOVEL'USR2938' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     994034*
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * DSP Load Confirm       DF - Load Header  * 
     C                     CALL 'POBEDFR'              90  DSP Load Confir
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AODT    WQ0026  70       Scheduled Ship
     C                     PARM #2BZNA    WQ0027  3        Carrier Code
     C                     PARM #CCPCD    WQ0028  3        USR Warehouse C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POBEDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993440*
     C                     SETON                     44    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZEIDT    CASNE#2EIDT    FBRQRL
     C           WZPKST    CASNE#2PKST    FBRQRL
     C           WZDBCD    CASNE#2DBCD    FBRQRL
     C           WZBZNA    CASNE#2BZNA    FBRQRL
     C           WZH9SX    CASNE#2H9SX    FBRQRL
     C           WZQ2CD    CASNE#2Q2CD    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL'N'       P3E7ST           USR Print Detai
     C                     MOVEL'N'       P9               USR Quit
     C                     MOVEL*BLANK    #CALTX           Salesperson Nam
      * f4 company number
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V2AIC3'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Allow Multi-Company is no
     C           P1I6ST    IFEQ 'N'                        *IF
      * Send message 'Prompt Not Allowed'
     C                     MOVEL'USR2410' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0029  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * F4 Select salesperson
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Salesperson Code
     C           W0CFL     IFEQ '#CBCCD'                   *IF
      * SEL Salesperson All    SR - Salesperson  * 
     C                     CALL 'PDFASRR'              90  SEL Salesperson
     C                     PARM *BLANK    W0RTN   7
     C           #CBCCD    PARM #CBCCD    WQ0030  3        Salesperson Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * Validate company number if entered
      * CASE: CTL.Company Number is not equal to zero
     C           #2AIC3    IFNE *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SRRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0010           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0010           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Company Number  7.0 Not F'
     C                     MOVEL'USR2008' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate salesperson if entered
      * CASE: CTL.Salesperson Code is entered
     C           #CBCCD    IFNE *BLANK                     *IF
      * RTV Salesperson        RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CBCCD    WL0001    P      Salesperson Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CALTX    P      Salesperson Nam
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Salesperson            NF'
     C                     MOVEL'USR0039' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * F7=Display Unbooked Orders
      * CASE: CTL.*CMD key is CF07
     C           *IN07     IFEQ '1'                        *IF
      * DSP Unbooked Orders    DF - Order Header TRG  * 
     C                     CALL 'PDCNDFR'              90  DSP Unbooked Or
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0031  30       Company Number
     C           WUBNVN    PARM WUBNVN    WQ0032 10        USR Program nam
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCNDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F8=Toggle Include/Exclude
      * CASE: CTL.*CMD key is *Option Toggle
     C           *IN08     IFEQ '1'                        *IF
      * CASE: CTL.Include/Exclude Option is Include
     C           #CVQCD    IFEQ 'INC'                      *IF
     C                     MOVEL'EXC'     #CVQCD           Include/Exclude
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Exclude
     C           #CVQCD    IFEQ 'EXC'                      *IF
     C                     MOVEL'INC'     #CVQCD           Include/Exclude
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * f10 edit trailer
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * EDT Trailer            PV - Trailer  * 
     C                     CLEARPARC
     C                     MOVEL*BLANK    PABZNA    P      Carrier Code
     C                     MOVEL*BLANK    PADXTX    P      Trailer Id
      *
     C                     CALL 'PDI0PVR'              90  EDT Trailer
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Trailer
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDI0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Reload subfile if trailer id field changes.
      * CASE: LCL.Trailer ID USR NE CTL.Trailer ID USR
     C           YL0012    IFNE #CS2TX                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#CS2TX    YL0012           Trailer ID USR
     C                     END                             *FI
      * Reload subfile if DC control field changes.
      * CASE: PAR.Status - Y or N NE CTL.Status - Y or N
     C           P2B8ST    IFNE #CB8ST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#CB8ST    P2B8ST           Status - Y or N
     C                     END                             *FI
      * Reload subfile if last stop city changes.        TRF011 7/28/06
      * CASE: LCL.Text 5 all caps     USR NE CTL.Text 5 all caps     USR
     C           YL0013    IFNE #CIQT1                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#CIQT1    YL0013           Text 5 all caps
     C                     END                             *FI
      * Reload Subfile if Ship Method Type has Changed.
      * CASE: CTL.Ship Method Type USR NE LCL.Ship Method Type USR
     C           #C        IFNE YL0002                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Reload Subfile if Warehouse has Changed.
      * CASE: CTL.USR Warehouse Code NE LCL.USR Warehouse Code
     C           #CCPCD    IFNE YL0003                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Get last load for requested delivery date
      * CASE: CTL.Requested Delivery Date NE WRK.ZERO
     C           #2EIDT    IFNE WUW0NB                     *IF
      * these WRK fields contain the last load which should show on the s
      * the selected requested delivery date
     C                     Z-ADD*ZERO     WUAODT           Scheduled Ship
     C                     Z-ADD99999     WUT4NB           Schedule Sequen
     C                     Z-ADD999999    WURMNB           Load ID
     C                     Z-ADD#2AIC3    WUAIC3           Company Number
      * RTV Last Ld for RqsDlv RT - Load Header  * 
     C                     EXSR SSRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WUT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WURMNB           Load ID
     C                     Z-ADD#2AIC3    WUAIC3           Company Number
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
     C                     MOVEL'N'       P3E7ST           USR Print Detai
     C                     MOVEL'N'       P6D4ST           USR Flag 1
      * CASE: PAR.USR Update Flag is No
     C           P3R4ST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     END                             *FI
     C                     MOVEL'*YES'    P3XFST           Display Prt Opt
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: Process command keys
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V2AIC3'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0033  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,45
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * * Ensure have current data
      * RTV WW Screen Fields   RT - Load Header  * 
     C                     EXSR STRVGN
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
     C                     EXSR SURVGN
      * Error if Load Header Not Found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0011           Load ID
      * Send message 'OM Load Header not found'
     C                     MOVEL'USR2313' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * ** Put Override miles on the screen, if entered       E00207
      * CASE: RCD.Override Total Load Miles is Entered
     C           #1K2DT    IFNE *ZERO                      *IF
     C                     Z-ADD#1K2DT    #RG1NX           Total Miles 4,0
     C                     MOVEL'Y'       #RHWSX           Change Flag USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1TLMI    #RG1NX           Total Miles 4,0
     C                     MOVEL'N'       #RHWSX           Change Flag USR
     C                     END                             *FI
      * E4119  MG Created Load  RESTRICTED OPTIONS
      * CASE: RCD.MG Created Load is Yes
     C           #1RYSX    IFEQ 'Y'                        *IF
      * CASE: RCD.*SFLSEL is Option 12
     C           #1SEL     IFEQ '12'                       *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0012           *SFLSEL
      * Send message 'Live TMS Option Invalid'
     C                     MOVEL'USR4601' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * 5=WW Orders on load
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * used to call WW DSP ORDERS ON LOAD DF (Order Header) (PDJ6DFR)
      * WW Orders on Load      DF - Load Detail  * 
     C                     CALL 'PDODDFR'              90  WW Orders on Lo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0034  70       Load ID
     C           P3CDWG    PARM P3CDWG    WQ0035 112       USR Weight Accu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDODDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  013       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * 6 = Print Load Confirmation
      * CASE: RCD.*SFLSEL is *Print
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
      * CASE: RCD.Carrier Code EQ WRK.BLANK
     C           #1BZNA    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0013           Carrier Code
     C                     Z-ADD#1RMNB    ZA0014           Load ID
      * Send message 'Carrier must be entered'
     C                     MOVEL'USR1253' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
     C                     Z-ADD#1RMNB    P2AJAE           Order Number 1
     C                     MOVEL#1BZNA    P7BZNA           Carrier Code
      * prompt for printer specs
      * CASE: PAR.USR Print Detail is Not Yes
     C           P3E7ST    IFEQ *BLANK                     *IF
     C           P3E7ST    OREQ 'N'
     C                     MOVEL@CN,004   P2G3TX           PRT Description
     C                     MOVELP1MPNA    P2WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P2WSST           PRT Hold Output
     C                     MOVEL'*NO'     P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     MOVEL'*NO'     P2WTST           PRT Save Output
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD1         P2DYNB           PRT Number of C
      * PMT Print Option  SHR  PV - Print Options  * 
     C                     CALL 'PDG0PVR'              90  PMT Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,005   WQ0036 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0037 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0038  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0039  4        PRT Save Output
     C           P2DYNB    PARM P2DYNB    WQ0040  20       PRT Number of C
     C           P2WUST    PARM P2WUST    WQ0041  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0042 10        PRT Night Queue
     C                     PARM 'O/M'     WQ0043  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDP2DYNB    P2M8NB           System Value Nu
     C                     MOVEL'Y'       P3E7ST           USR Print Detai
     C                     END                             *FI
      * Print Load Confirmation
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,006                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP2DYNB    P2M8NB           System Value Nu
      * ** default # of copies to 1 if it is zeros   P000737
      * CASE: PAR.System Value Numeric is Equal to zero
     C           P2M8NB    IFEQ *ZERO                      *IF
     C                     Z-ADD1         P2M8NB           System Value Nu
     C                     END                             *FI
      * ** Set Fax/Print flag to Print, Set fax carrier to No, set
      * ** fax dispatcher to No
      * ** set all other carrier print flags to NO            P000737
     C                     MOVEL'P'       WUE6ST           USR Status (Y/N
     C                     MOVEL@CN,007   WUNMTX           Status Descript
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     MOVEL'N'       WUQ1ST           Status Flag 1
      * EXC Load Confirm Fax   IF - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AJAA    WL0016           Company Number
     C                     Z-ADDP2AJAE    WL0017           Order Number 1
     C                     MOVEL*BLANK    WL0018           Transloader Car
     C                     MOVELP7BZNA    WL0019    P      Carrier Code
     C                     MOVEL*BLANK    WL0020           Shipping Line
     C                     MOVEL*BLANK    WL0021           OHE Carrier SCA
     C                     MOVELWUQ1ST    WL0022    P      Status Flag 1
     C                     MOVEL'N'       WL0023    P      Status Flag 2
     C                     MOVEL'N'       WL0024    P      Status Flag 3
     C                     MOVEL'N'       WL0025    P      Status Flag 4
     C                     MOVEL'N'       WL0026    P      Status Flag 5
     C                     MOVELWUB8ST    WL0027    P      Status - Y or N
     C                     MOVELWUNMTX    WL0028    P      Status Descript
     C                     MOVELWUE6ST    WL0029    P      USR Status (Y/N
     C                     MOVELP2G3TX    WL0030    P      PRT Description
     C                     MOVELP2WRST    WL0031    P      PRT Printer Dev
     C                     MOVELP2WSST    WL0032    P      PRT Hold Output
     C                     MOVELP2WTST    WL0033    P      PRT Save Output
     C                     MOVELP2WUST    WL0034    P      PRT Night Queue
     C                     MOVELP2BVVN    WL0035    P      PRT Night Queue
     C                     Z-ADDP2M8NB    WL0036           System Value Nu
     C                     MOVEL*BLANK    WL0037           Email Address
     C                     EXSR SVINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    P2AJAA           Company Number
     C                     Z-ADDWL0017    P2AJAE           Order Number 1
      * Send message 'Loads have been printed'
     C                     MOVEL'USR2574' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C                     END                             *FI
      * 11=Process Edit Traffic Comments
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
      * EDT PD Traffic Comment EF - Traffic Comments  * 
     C                     CALL 'PDCZEFR'              90  EDT PD Traffic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0064  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCZEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  013       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * 12=Recalculate Miles
      * CASE: RCD.*SFLSEL is Option 12
     C           #1SEL     IFEQ '12'                       *IF
      * CASE: LCL.Application WHS Restrict is no
     C           YL0001    IFEQ 'N'                        *IF
      * EDT Stop Miles         EF - Load Detail  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDW7EFR'              90  EDT Stop Miles
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Detai
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW7EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  013       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0015           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 14=Process Edit Dispatch request
      * CASE: RCD.*SFLSEL is Option 14
     C           #1SEL     IFEQ '14'                       *IF
      * 082906 slm E00169 Pass in blanks on the Warehouse Specific
      * this function will be used by specific user from a menu
      * when this executed other places then pass in blanks
      * EDT Cst Srv/Dispatcher XF - Load Header  * 
     C                     CALL 'PDE4XFR'              90  EDT Cst Srv/Dis
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0065  30       Company Number
     C           #1RMNB    PARM #1RMNB    WQ0066  70       Load ID
     C                     PARM *BLANK    WQ0067  1        Warehouse Speci
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  013       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 16=Process Display Dispatch/Tracer request
      * CASE: RCD.*SFLSEL is Option 16
     C           #1SEL     IFEQ '16'                       *IF
      * DSP Dispatch/Tracer    DF - Load Detail  * 
     C                     CALL 'PDT3DFR'              90  DSP Dispatch/Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0068  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDT3DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  013       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * 15=Process Edit Tracer request
      * CASE: RCD.*SFLSEL is Option 15
     C           #1SEL     IFEQ '15'                       *IF
      * e4119 call disply in here if live with tms load planning & MG Crt
      * EDT Cst Srv/TraceClerk XF - Load Detail  * 
     C                     CALL 'POHXXFR'              90  EDT Cst Srv/Tra
     C                     PARM *BLANK    W0RTN   7
     C           #1RMNB    PARM #1RMNB    WQ0069  70       Load ID
     C           #1AIC3    PARM #1AIC3    WQ0070  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POHXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  013       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * 17 = Process Display Export
      * CASE: RCD.*SFLSEL is Option 17
     C           #1SEL     IFEQ '17'                       *IF
      * CASE: RCD.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * ** Select the order and pass to the dsprcd     FP1101 LJB 04/09/2
     C                     MOVEL'N'       WUG8SX           Exit Selection
      * Repeat While
      * DO WHILE: WRK.Exit Selection USR is No
     C           WUG8SX    DOWEQ'N'                        *DOW
      * SEL Order/Load/Exp Sts SR - Order Header TRG  * 
     C                     CALL 'PMFXSRR'              90  SEL Order/Load/
     C                     PARM *BLANK    W0RTN   7
     C           WUG8SX    PARM WUG8SX    WQ0071  1        Exit Selection
     C           WUMPNB    PARM *ZERO     WQ0072  70       Order Number
     C                     PARM #1RMNB    WQ0073  70       Load ID
     C           WUFKNB    PARM *ZERO     WQ0074  30       USR Company Num
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFXSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** Dsp order until exit is requested
      * CASE: WRK.Exit Selection USR is No
     C           WUG8SX    IFEQ 'N'                        *IF
      * ** Use the dsprcd from the Order Header Extension   FP1101 LJB 04
      * DSP Cust Ord Export    D1 - Order Header Extension  * 
     C                     CALL 'PMFWD1R'              90  DSP Cust Ord Ex
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0075  30       Company Number
     C                     PARM WUMPNB    WQ0076  70       Order Number
     C                     PARM #1RMNB    WQ0077  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFWD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Send message 'Order Header Extension NF'
     C                     MOVEL'USR3697' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *ITR
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  013       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0016           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 13 = Process Edit Export
      * CASE: RCD.*SFLSEL is Option 13
     C           #1SEL     IFEQ '13'                       *IF
      * user cant chg stuff here when live with tms load planning E4119
      * CASE: RCD.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUG8SX           Exit Selection
      * ** Select the order and pass to the edtfil     FP1101 LJB 04/09/2
      * Repeat while
      * DO WHILE:
      *  - c1 OR c2
      *   |- c1    : WRK.Exit Selection USR is No
      *   |- c2    : WRK.USR Exit Program is yes
      *   '-
     C                     DO   *HIVAL                     *DOW
     C           WUG8SX    IFEQ 'N'                        *IF
     C           WUSTYN    OREQ 'Y'                        *OR
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * 12/12/22 DN DO4595-Replaced PMFXSRR with PUXRSRR.
      * SEL Order/Load/Exp Sts2SR - Order Header TRG  * 
     C                     CALL 'PUXRSRR'              90  SEL Order/Load/
     C                     PARM *BLANK    W0RTN   7
     C           WUG8SX    PARM WUG8SX    WQ0078  1        Exit Selection
     C           WUMPNB    PARM *ZERO     WQ0079  70       Order Number
     C                     PARM #1RMNB    WQ0080  70       Load ID
     C           WUFKNB    PARM *ZERO     WQ0081  30       USR Company Num
     C           YL0014    PARM YL0014    WQ0082  1        Orders have Sam
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUXRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** Edit Order Header Instructions
      * CASE: WRK.Exit Selection USR is No
     C           WUG8SX    IFEQ 'N'                        *IF
      * CASE: RCD.MG Created Load is Yes
     C           #1RYSX    IFEQ 'Y'                        *IF
      * DSP Cust Ord Export    D1 - Order Header Extension  * 
     C                     CALL 'PMFWD1R'              90  DSP Cust Ord Ex
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUFKNB    WQ0083  30       Company Number
     C                     PARM WUMPNB    WQ0084  70       Order Number
     C                     PARM #1RMNB    WQ0085  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFWD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * 12/12/22 DN DO4595-Passed in Parm 'Orders have Same Booking#'.
      * EDT Export Order Instr E2 - Order Header Extension  * 
     C                     CALL 'PNVZE2R'              90  EDT Export Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUFKNB    WQ0086  30       Company Number
     C                     PARM WUMPNB    WQ0087  70       Order Number
     C           #1RMNB    PARM #1RMNB    WQ0088  70       Load ID
     C           WUSTYN    PARM WUSTYN    WQ0089  1        USR Exit Progra
     C                     PARM YL0014    WQ0090  1        Orders have Sam
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNVZE2R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *ITR
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  013       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * ** Write the Carlisle record(s)
      * CASE: RCD.Load Status is Locked or Shipped
     C           #1PKST    IFEQ 'L'                        *IF
     C           #1PKST    OREQ 'S'
      * RMC 7/15/16 remove live with tpm check
      * Rtv Active Status     RT - PFS Interface  * 
     C                     EXSR SWRVGN
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0016    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0091  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 18 = Fax load confirmation
      * CASE: RCD.*SFLSEL is Option 18
     C           #1SEL     IFEQ '18'                       *IF
      * CASE: RCD.Carrier Code is not entered
     C           #1BZNA    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0017           *SFLSEL
     C                     MOVEL#1BZNA    ZA0018           Carrier Code
      * Send message 'Carrier entered to Fax'
     C                     MOVEL'USR2444' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
     C                     Z-ADD#1RMNB    P2AJAE           Order Number 1
     C                     Z-ADD#1RMNB    P7RMNB           Load ID
     C                     MOVEL#1BZNA    P7BZNA           Carrier Code
     C                     Z-ADD#1RMNB    WURMNB           Load ID
      * ** Check SSI download flag. If Yes, send info to PowerPro   FP116
      * RTV SSI Carrier flag   RT - Carrier  * 
     C                     EXSR SXRVGN
      * RTV SSI Fax'd Flag     RT - Load Header  * 
     C                     EXSR SYRVGN
      * CASE: RCD.MG Created Load is Not MG Created Load
     C           #1RYSX    IFEQ *BLANK                     *IF
      * ** See if carrier has already received a fax, if yes, send Change
      * CASE: WRK.SSI Download Flag is Yes, Download to SSI
     C           WUUNUS    IFEQ 'Y'                        *IF
      * CASE: WRK.Fax Sent to SSI Carrier is Not Fax'd to Carrier
     C           WURUSX    IFEQ *BLANK                     *IF
     C           WURUSX    OREQ 'N'
     C                     MOVEL'00'      WUAHST           SSI Add, Chg, D
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Send "Changed" record to SSI PowerPro
     C                     MOVEL'04'      WUAHST           SSI Add, Chg, D
     C                     END                             *FI
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0092  70       Load ID
     C                     PARM #1BZNA    WQ0093  3        Carrier Code
     C                     PARM WUAHST    WQ0094  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Fax'd to SSI flag  CH - Load Header  * 
     C                     EXSR SZCHRC
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * if user flag 1 is not yes                  changed per P000737
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.USR Flag 1 is Blank
      *   |- c2    : PAR.USR Flag 1 is No
      *   '-
     C           P6D4ST    IFEQ *BLANK                     *IF
     C           P6D4ST    OREQ 'N'                        *OR
      * ** PDVVUPC which calls PDVVPCLP which calls
      * ** PDAMXFR which calls PODYUPR to send any faxes and then calls
      * ** PLAMUPC to send any emails
      * ** Set Fax Carrier=Yes, Fax dispatch=No, Fax/Print=Fax
      * ** Default reporting parms, so no popup window for print options
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVEL'N'       WUQ1ST           Status Flag 1
     C                     MOVEL'F'       WUE6ST           USR Status (Y/N
     C                     MOVEL@CN,007   WUNMTX           Status Descript
     C                     MOVEL@CN,008   P2G3TX           PRT Description
     C                     MOVELP1MPNA    P2WRST           PRT Printer Dev
     C                     MOVEL'*YES'    P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     MOVEL'*NO'     P2WTST           PRT Save Output
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD1         P2DYNB           PRT Number of C
      * PMT Print Option  SHR  PV - Print Options  * 
     C                     CALL 'PDG0PVR'              90  PMT Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2G3TX    WQ0095 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0096 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0097  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0098  4        PRT Save Output
     C           P2DYNB    PARM P2DYNB    WQ0099  20       PRT Number of C
     C           P2WUST    PARM P2WUST    WQ0100  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0101 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0102  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDP2DYNB    P2M8NB           System Value Nu
     C                     MOVEL'Y'       P6D4ST           USR Flag 1
     C                     END                             *FI
      * * Only fax if F3 to cancel has not been pressed   C001921
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,006                    *IF
      * Send message 'Fax/Email cancelled'
     C                     MOVEL'USR4484' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * EXC Load Confirm Fax   IF - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AJAA    WL0016           Company Number
     C                     Z-ADDP2AJAE    WL0017           Order Number 1
     C                     MOVEL*BLANK    WL0018           Transloader Car
     C                     MOVELP7BZNA    WL0019    P      Carrier Code
     C                     MOVEL*BLANK    WL0020           Shipping Line
     C                     MOVEL*BLANK    WL0021           OHE Carrier SCA
     C                     MOVELWUQ1ST    WL0022    P      Status Flag 1
     C                     MOVEL'N'       WL0023    P      Status Flag 2
     C                     MOVEL'N'       WL0024    P      Status Flag 3
     C                     MOVEL'N'       WL0025    P      Status Flag 4
     C                     MOVEL'N'       WL0026    P      Status Flag 5
     C                     MOVELWUB8ST    WL0027    P      Status - Y or N
     C                     MOVELWUNMTX    WL0028    P      Status Descript
     C                     MOVELWUE6ST    WL0029    P      USR Status (Y/N
     C                     MOVELP2G3TX    WL0030    P      PRT Description
     C                     MOVELP2WRST    WL0031    P      PRT Printer Dev
     C                     MOVELP2WSST    WL0032    P      PRT Hold Output
     C                     MOVELP2WTST    WL0033    P      PRT Save Output
     C                     MOVELP2WUST    WL0034    P      PRT Night Queue
     C                     MOVELP2BVVN    WL0035    P      PRT Night Queue
     C                     Z-ADDP2M8NB    WL0036           System Value Nu
     C                     MOVEL*BLANK    WL0037           Email Address
     C                     EXSR SVINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    P2AJAA           Company Number
     C                     Z-ADDWL0017    P2AJAE           Order Number 1
      * Send message 'Fax Load Conf sent to car'
     C                     MOVEL'USR2445' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  013       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
     C                     END                             *FI
      * 19=Display Load
      * CASE: RCD.*SFLSEL is Option 19
     C           #1SEL     IFEQ '19'                       *IF
      * DSP Load Plan          DF - Load Detail  * 
     C                     CALL 'PDSLDFR'              90  DSP Load Plan
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0103  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSLDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 20 = Reprint BOL
      * CASE: RCD.*SFLSEL is Option 20
     C           #1SEL     IFEQ '20'                       *IF
      * CASE: RCD.Load Status is Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C                     MOVEL@CN,009   P2G3TX           PRT Description
     C                     MOVEL'N'       P6D4ST           USR Flag 1
      * ** rcd.total load miles will have Override miles in it, if entere
      * PMT B.O.L. Prompt      PV - Load Header  * 
     C                     CALL 'PDCKPVR'              90  PMT B.O.L. Prom
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0104  70       Load ID
     C                     PARM #1AIC3    WQ0105  30       Company Number
     C                     PARM #1AODT    WQ0106  70       Scheduled Ship
     C                     PARM #1PKST    WQ0107  1        Load Status
     C                     PARM #1RNNB    WQ0108  52       Reefer Temperat
     C                     PARM #1DMTX    WQ0109 15        Seal 1
     C                     PARM #1DNTX    WQ0110 15        Seal 2
     C                     PARM #1DOTX    WQ0111 15        Seal 3
     C                     PARM #1RPNB    WQ0112  70       Total Load Orde
     C                     PARM #RS2TX    WQ0113 20        Trailer Id
     C                     PARM #1VDST    WQ0114  1        Load Type
     C                     PARM #1SDNB    WQ0115  50       Number Pallets
     C                     PARM #1PAOU    WQ0116  50       Number Pallets
     C                     PARM #1PRTM    WQ0117  52       Product Tempera
     C                     PARM #1NPSV    WQ0118  50       Number Spacers
     C                     PARM #1J8TX    WQ0119 12        Car_Veh_Initial
     C                     PARM #1TLMI    WQ0120  70       Total Load Mile
     C                     PARM #1J9TX    WQ0121 12        Recorder ID
     C                     PARM #1Q2CD    WQ0122  2        Shipping Method
     C                     PARM #1VPCD    WQ0123  3        Ship From Wareh
     C                     PARM #1DBCD    WQ0124  2        Ship To State C
     C                     PARM #1U2ST    WQ0125  1        Export Status
     C                     PARM #1J7DT    WQ0126  70       BOL Complete Da
     C                     PARM #1BOTM    WQ0127  60       BOL Complete Ti
     C                     PARM #1KJDT    WQ0128  70       Scheduled Deliv
     C                     PARM #1ATTM    WQ0129  60       Scheduled Deliv
     C                     PARM #1ICWG    WQ0130  92       Avg Pallet Tare
     C                     PARM #1IDWG    WQ0131  92       Tot Pallet Tare
     C                     PARM #1RQST    WQ0132  1        Export Load USD
     C                     PARM #1WRTX    WQ0133 25        Shipping Temp C
     C           #1UVST    PARM #1UVST    WQ0134  1        EDI Status 1
     C           P2G3TX    PARM P2G3TX    WQ0135 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0136 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0137  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0138  4        PRT Save Output
     C           P2DYNB    PARM P2DYNB    WQ0139  20       PRT Number of C
     C                     PARM P6D4ST    WQ0140  1        USR Flag 1
     C                     PARM *BLANK    WQ0141  1        Unused Status U
     C                     PARM *BLANK    WQ0142  3        USR Warehouse C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCKPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0019           *SFLSEL
      * Send message 'BOL RePrint Invalid'
     C                     MOVEL'USR2997' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * screen displays state of last stop on load, so get that field aga
      * do this @end of validate, so that processing will use REAL ship t
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0003           Load ID
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WUBKC7           Ship To Custome
     C                     MOVELWL0005    WUBRTX    P      Ship To Name
     C                     MOVELWL0006    WUHMNA    P      Ship To Address
     C                     MOVELWL0007    WUHONA    P      Ship To Address
     C                     MOVELWL0008    WUHPNA    P      Ship To Address
     C                     MOVELWL0009    #RLINA    P      Ship To City
     C                     MOVELWL0010    #RV9CD    P      Ship To State C
     C                     MOVELWL0011    WUCKTX    P      Ship To Zip_Pos
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,45
     C                     SETOF                     98
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN78
     C           #RKOST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           #RS9TX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #RE6ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           #RN8DT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #RHWSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FJCPQJ fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Spacers
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 4
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     MOVELFJONTM    #1ONTM           On Time_Y_N
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U_M
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     MOVELFJJ8TX    #1J8TX           Car_Veh_Initial
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
      * Clear external version also
     C                     Z-ADD*ZERO     V1P1DT
     C                     MOVEL*BLANK    #RS9TX           Multiple Co Per
     C                     MOVEL*BLANK    #RKOST           Include Todays
     C                     MOVEL*BLANK    #RHWSX           Change Flag USR
     C                     MOVEL*BLANK    #RHNNA           Ship To City
     C                     MOVEL*BLANK    #RLINA           USR Load/Stop 1
     C                     Z-ADD*ZERO     #RN8DT           LD Unused Date
     C                     MOVEL*BLANK    #R               Ship Method Typ
     C                     MOVEL*BLANK    #RYPTX           Generic Heading
     C                     MOVEL*BLANK    #RE6ST           USR Status (Y/N
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RG1NX           Total Miles 4,0
     C                     Z-ADD*ZERO     #RG2NX           Weight Adjust 6
     C                     MOVEL*BLANK    #RY7TX           Text USR 5
     C                     MOVEL*BLANK    #RV9CD           USR State Code
     C                     MOVEL*BLANK    #RS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #RB8ST           Status - Y or N
     C                     Z-ADD*ZERO     #RG0NX           Numeric 4,0
     C                     MOVEL*BLANK    #RCPCD           USR Warehouse C
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP3ECST    #PECST           Error Status
     C                     MOVEL*BLANK    #CVQCD           Include/Exclude
     C                     Z-ADD*ZERO     #CK3DT           USR Requested D
     C                     Z-ADD*ZERO     #2T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #CG0NX           Numeric 4,0
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     Z-ADD*ZERO     #2TLMI           Total Load Mile
     C                     Z-ADD*ZERO     #2RPNB           Total Load Orde
     C                     MOVEL*BLANK    #CHNNA           Ship To City
     C                     MOVEL*BLANK    #CLINA           USR Load/Stop 1
     C                     MOVEL*BLANK    #2DXTX           Trailer Id
     C                     MOVEL*BLANK    #C               Ship Method Typ
     C                     MOVEL*BLANK    #CBCCD           Salesperson Cod
     C                     MOVEL*BLANK    #CALTX           Salesperson Nam
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V2EIDT
     C                     MOVEL*BLANK    #2PKST           Load Status
     C                     Z-ADD*ZERO     #CG1NX           Total Miles 4,0
     C                     Z-ADD*ZERO     #CG2NX           Weight Adjust 6
     C                     MOVEL*BLANK    #CIQT1           Text 5 all caps
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     MOVEL*BLANK    #CS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    #CB8ST           Status - Y or N
     C                     MOVEL*BLANK    #2H9SX           Load Confirmed
     C                     MOVEL*BLANK    #2Q2CD           Shipping Method
     C                     MOVEL*BLANK    #CCPCD           USR Warehouse C
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      * Convert TPM Planned Ship Date to display format
      * Convert date
     C           1000000   ADD  #1P1DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1P1DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #2EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2EIDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv 1st Warehouse     RT - User Application Whs  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FOAJVN    WQSA01           User Profile Na
     C           *LIKE     DEFN FODNCD    WQSA02           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           User Profile Na
     C                     KFLD           WQSA02           Application Cod
      * Setup key
     C                     MOVEL##USR     WQSA01           User Profile Na
     C                     MOVE *BLANK    WQSA02           Application Cod
     C                     MOVEL'TRF'     WQSA02           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@FOREDD                    *
     C           KRSSA     READE@FOREDD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4200' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CCPCD           Warehouse Code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFOAJCD    #CCPCD           Warehouse Code
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@FOREDD                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Salesperson        RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVELWL0001    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSB     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Salesperson Nam
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPALTX    WL0002           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Sched ShipDte,Seq  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSC     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAODT    #2AODT           Scheduled Ship
     C                     Z-ADDWAT4NB    #2T4NB           Schedule Sequen
     C                     Z-ADDWAEIDT    #2EIDT           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Chk Slsprsn on Ord RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  3        Salesperson Cod
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL'N'       WUWXST           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSD02           Load ID
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSD02           Load ID
      * Establish starting position
     C           KRSSD     SETLL@BFCPD9                    *
     C           KRSSD     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Salesman Code      RT - PD Sales Route  * 
     C                     EXSR SERVGN
      * CASE: PAR.Salesperson Code EQ PAR.Salesperson Code 1
     C           #CBCCD    IFEQ WN0001                     *IF
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - PD Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELBER4CD    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSE     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Salesperson Cod
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEBCCD    WN0001           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSF02           Load ID
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
      * Setup key
     C                     Z-ADDWL0003    WQSF02           Load ID
      * Establish starting position
     C           KRSSF     SETLL@FLCPE8                    *
     C           KRSSF     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - PD Order Header  * 
     C                     EXSR SGRVGN
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WBAIC3           Company Number
     C                     Z-ADDFLC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBBKC7    WL0004           Ship To Custome
     C                     MOVELWBBRTX    WL0005           Ship To Name
     C                     MOVELWBHMNA    WL0006           Ship To Address
     C                     MOVELWBHONA    WL0007           Ship To Address
     C                     MOVELWBHPNA    WL0008           Ship To Address
     C                     MOVELWBHNNA    WL0009           Ship To City
     C                     MOVELWBDBCD    WL0010           Ship To State C
     C                     MOVELWBCKTX    WL0011           Ship To Zip_Pos
     C                     MOVELWBBCNA    WUG0TX           Customer Purcha
     C                     MOVELWBB6NA    WUG0TX           Special Instruc
     C                     MOVELWBBYNA    WUG0TX           Special Instruc
     C                     Z-ADDWBEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWBAFTM    WUNFNN           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSH02           Load ID
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH02           Load ID
     C                     KFLD           WCRVNB           Stop_Drop
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSH02           Load ID
     C                     Z-ADD1         WCRVNB           Stop_Drop
      * Establish starting position
     C           KPSSH     SETLL@FLCPEB                    *
     C           KRSSH     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SIRVGN
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSI01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSI02           Order Number
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQSI01           Company Number
     C                     Z-ADDWCC4NB    WQSI02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSI     SETLL@BGWKAE                    *
     C           KRSSI     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RCPCD           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SJRVGN
      * PAR = DB1 By name
     C                     MOVELOMAJCD    #RCPCD           Warehouse Code
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P3CDWG           USR Weight Accu
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0012           Load ID
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YL0004           Pallets Loaded
     C                     Z-ADDWL0014    YL0005           Avg Pallet Tare
     C                     Z-ADDWL0015    YL0006           Tot Pallet Tare
     C                     END                             *FI
      * ***** Change log and comments
     C                     EXSR UASUBR                     ***** Change lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSK01           Load ID
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Load ID
     C                     KFLD           WDRUNB           Stop_Drop Seque
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSK01           Load ID
     C                     Z-ADD*ZERO     WDRUNB           Stop_Drop Seque
      * Establish starting position
     C           KPSSK     SETLL@FLCPBW                    *
     C           KRSSK     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 01/18/10 PKD E000261 SEND in LCL.Avg Pallet Tare
      * RTV Gross Wgt/Qty     XF - Order Detail  * 
     C                     CALL 'PQPQXFR'              90  RTV Gross Wgt/Q
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0010  30       Company Number
     C                     PARM WDC4NB    WQ0011  70       Order Number
     C                     PARM *ZERO     WQ0012  30       Order Sequence
     C                     PARM *ZERO     WQ0013  30       Order Secondary
     C           P3CDWG    PARM P3CDWG    WQ0014 112       USR Weight Accu
     C           YL0007    PARM YL0007    WQ0015 112       Order Quantity
     C                     PARM YL0005    WQ0016  92       Avg Pallet Tare
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PQPQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           KRSSK     READE@FLCPBW                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDRMNB    WL0012           Load ID
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YL0004           Pallets Loaded
     C                     Z-ADDWL0014    YL0005           Avg Pallet Tare
     C                     Z-ADDWL0015    YL0006           Tot Pallet Tare
     C                     ADD  YL0006    P3CDWG           USR Weight Accu
     C                     END                             *FI
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Pallet/Tare        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADDWL0012    WARMNB           Load ID
      * Establish starting position
     C           KRSSL     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAKNNX    WL0013           Pallets Loaded
     C                     Z-ADDWAICWG    WL0014           Avg Pallet Tare
     C                     Z-ADDWAIDWG    WL0015           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Verify Trffc Cmnts RT - Traffic Comments  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN KERMNB    WQSM01           Load ID
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSM01           Load ID
      * Establish starting position
     C           KRSSM     SETLL@KECPGI                    *
     C           KRSSM     READE@KECPGI                  90*
      * Data record not found
     C   90                MOVEL'USR2199' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@KECPGI                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Val More Then 1 Co    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       #RS9TX           Multiple Co Per
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSN02           Load ID
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSN02           Load ID
      * Establish starting position
     C           KRSSN     SETLL@FLCPKF                    *
     C           KRSSN     READE@FLCPKF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'USR1160' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Company Number NE DB1.Company Number
     C           #1AIC3    IFNE WEAIC3                     *IF
     C                     MOVEL'Y'       #RS9TX           Multiple Co Per
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSN     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Val Appt confirm     RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     #RN8DT           LD Unused Date
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSO02           Load ID
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSO02           Load ID
      * Establish starting position
     C           KRSSO     SETLL@FLCPKF                    *
     C           KRSSO     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LD Sls Appt Confirm Dt is Entered
     C           WEN8DT    IFGT 0                          *IF
     C                     Z-ADDWEN8DT    #RN8DT           LD Unused Date
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSO     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CCPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * VAL Confirmed Loads    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFBZNA    WQSQ02           Carrier Code
     C           *LIKE     DEFN WFAODT    WQSQ03           Scheduled Ship
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Carrier Code
     C                     KFLD           WQSQ03           Scheduled Ship
      * Setup key
     C                     MOVEL#2BZNA    WQSQ02           Carrier Code
     C                     Z-ADD#2AODT    WQSQ03           Scheduled Ship
      * Establish starting position
     C           KRSSQ     SETLL@FJCPRX                    *
     C           KRSSQ     READE@FJCPRX                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT                     *QUIT
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Load Confirmed Sts is no
     C           WFH9SX    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SQEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     END                             *FI
     C           KRSSQ     READE@FJCPRX                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSR     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUADTX           Name
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WUADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Last Ld for RqsDlv RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGEIDT    WQSS01           Requested Deliv
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS01           Requested Deliv
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGAODT           Scheduled Ship
     C                     KFLD           WGT4NB           Schedule Sequen
     C                     KFLD           WGRMNB           Load ID
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Requested Deliv
      * Setup key
     C                     Z-ADD#2EIDT    WQSS01           Requested Deliv
     C                     Z-ADDWUAIC3    WGAIC3           Company Number
     C                     Z-ADDWUAODT    WGAODT           Scheduled Ship
     C                     Z-ADDWUT4NB    WGT4NB           Schedule Sequen
     C                     Z-ADDWURMNB    WGRMNB           Load ID
      * Establish starting position
     C           KPSSS     SETLL@FJCPQO                    *
     C           KRSSS     READE@FJCPQO                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGAIC3    WUAIC3           Company Number
     C                     Z-ADDWGAODT    WUAODT           Scheduled Ship
     C                     Z-ADDWGT4NB    WUT4NB           Schedule Sequen
     C                     Z-ADDWGRMNB    WURMNB           Load ID
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@FJCPQO                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV WW Screen Fields   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSST     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAODT    #1AODT           Scheduled Ship
     C                     MOVELWAPKST    #1PKST           Load Status
     C                     Z-ADDWARPNB    #1RPNB           Total Load Orde
     C                     Z-ADDWAFLAM    #1FLAM           Flat Amount
     C                     MOVELWAXQST    #1XQST           Allocate Pounds
     C                     MOVELWADXTX    #1DXTX           Trailer Id
     C                     MOVELWABZNA    #1BZNA           Carrier Code
     C                     MOVELWARONB    #1RONB           Truck Size
     C                     MOVELWAVDST    #1VDST           Load Type
     C                     Z-ADDWAT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDWATLMI    #1TLMI           Total Load Mile
     C                     MOVELWAQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWAVPCD    #1VPCD           Ship From Wareh
     C                     MOVELWADBCD    #1DBCD           Ship To State C
     C                     MOVELWARMST    #1RMST           Load Acceptance
     C                     Z-ADDWAIDWG    #1IDWG           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSU     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAK2DT    #1K2DT           Override Total
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVINFN    BEGSR
      *================================================================
      * EXC Load Confirm Fax   IF - Load Header  * 
      *================================================================
      * EXC Load Confirm Fax   IF
      * ** See comments for explanation of parms.
      * PRC Submit Fax Load Cn UP - /UT User Programs  * 
     C                     CALL 'PDVVUPC'              90  PRC Submit Fax
     C                     PARM WUH3TX    WQ0044  7        Return Code Usr
     C           WL0016    PARM WL0016    WQ0045 155       Company Number
     C           WL0017    PARM WL0017    WQ0046 155       Order Number 1
     C                     PARM WL0018    WQ0047  3        Transloader Car
     C                     PARM WL0019    WQ0048  3        Carrier Code
     C                     PARM WL0020    WQ0049  3        Shipping Line
     C                     PARM WL0021    WQ0050  4        OHE Carrier SCA
     C                     PARM WL0022    WQ0051  1        Status Flag 1
     C                     PARM WL0023    WQ0052  1        Status Flag 2
     C                     PARM WL0024    WQ0053  1        Status Flag 3
     C                     PARM WL0025    WQ0054  1        Status Flag 4
     C                     PARM WL0026    WQ0055  1        Status Flag 5
     C                     PARM WL0027    WQ0056  1        Status - Y or N
     C                     PARM WL0028    WQ0057 10        Status Descript
     C                     PARM WL0029    WQ0058  1        USR Status (Y/N
     C                     PARM WL0031    WQ0059 10        PRT Printer Dev
     C                     PARM WL0032    WQ0060  4        PRT Hold Output
     C                     PARM WL0033    WQ0061  4        PRT Save Output
     C                     PARM WL0036    WQ0062 155       System Value Nu
     C                     PARM WL0037    WQ0063 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVVUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADD#1AIC3    BUY1NX           PFS Company Num
     C                     MOVEL'LDORDD'  BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSSW     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0015           PFS AccuSort Ac
     C                     MOVEL*BLANK    YL0016           PFS Carlisle Ac
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    YL0015           PFS AccuSort Ac
     C                     MOVELBUWUSX    YL0016           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV SSI Carrier flag   RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSX     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUUNUS           SSI Download Fl
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFUNUS    WUUNUS           SSI Download Fl
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV SSI Fax'd Flag     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSY     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWARUSX    WURUSX           Fax Sent to SSI
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * CHG Fax'd to SSI flag  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  30       Company Number
     C                     Z-ADD*ZERO     WN0003  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0004  1        LTL Flag
     C                     MOVEL*BLANK    WN0005  1        Load Status
     C                     Z-ADD*ZERO     WN0006  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0007 15        Seal 1
     C                     MOVEL*BLANK    WN0008 15        Seal 2
     C                     MOVEL*BLANK    WN0009 15        Seal 3
     C                     MOVEL*BLANK    WN0010 15        Seal 4
     C                     MOVEL*BLANK    WN0011 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0012  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0013 112       Flat Amount
     C                     MOVEL*BLANK    WN0014  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0015  50       Total Stops
     C                     MOVEL*BLANK    WN0016 20        Trailer Id
     C                     MOVEL*BLANK    WN0017  3        Transloader Car
     C                     Z-ADD*ZERO     WN0018  40       BOL Time
     C                     MOVEL*BLANK    WN0019  3        Carrier Code
     C                     MOVEL*BLANK    WN0020  7        Truck Size
     C                     Z-ADD*ZERO     WN0021  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0022 112       Rated Freight
     C                     MOVEL*BLANK    WN0023  1        Ship Status
     C                     MOVEL*BLANK    WN0024  1        Load Type
     C                     Z-ADD*ZERO     WN0025  50       Number Pallets
     C                     Z-ADD*ZERO     WN0026  50       Number Pallets
     C                     Z-ADD*ZERO     WN0027 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0028  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0029  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0030  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0031 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0032 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0033  70       Actual Departur
     C                     Z-ADD*ZERO     WN0034  40       Departure Time
     C                     Z-ADD*ZERO     WN0035  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0036  52       Product Tempera
     C                     Z-ADD*ZERO     WN0037  50       Number Spacers
     C                     MOVEL*BLANK    WN0038 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0039  70       Total Load Mile
     C                     MOVEL*BLANK    WN0040 12        Recorder ID
     C                     MOVEL*BLANK    WN0041  2        Shipping Method
     C                     MOVEL*BLANK    WN0042  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0043  2        Ship To State C
     C                     Z-ADD*ZERO     WN0044  70       Gross Weight
     C                     MOVEL*BLANK    WN0045  3        Carrier Broker
     C                     MOVEL*BLANK    WN0046  1        Export Status
     C                     Z-ADD*ZERO     WN0047  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0048  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0049  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0050  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0051  70       Spotted Date
     C                     Z-ADD*ZERO     WN0052  60       Spotted Time
     C                     Z-ADD*ZERO     WN0053  70       Load Finished D
     C                     Z-ADD*ZERO     WN0054  60       Load Finished T
     C                     Z-ADD*ZERO     WN0055  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0056  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0057  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0058  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0059  70       Truck Departure
     C                     Z-ADD*ZERO     WN0060  60       Truck Departure
     C                     Z-ADD*ZERO     WN0061  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0062  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0063  3        Shipping Line
     C                     MOVEL*BLANK    WN0064 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0065 30        Vessel Name
     C                     Z-ADD*ZERO     WN0066  50       Voyage
     C                     Z-ADD*ZERO     WN0067  70       Sail Date
     C                     MOVEL*BLANK    WN0068 12        Booking Number
     C                     MOVEL*BLANK    WN0069 20        Discharge Port
     C                     Z-ADD*ZERO     WN0070  70       Arrival Date
     C                     MOVEL*BLANK    WN0071 12        Container Numbe
     C                     Z-ADD*ZERO     WN0072  70       Date In
     C                     Z-ADD*ZERO     WN0073  60       Time In
     C                     Z-ADD*ZERO     WN0074  70       Date Out
     C                     Z-ADD*ZERO     WN0075  60       Time Out
     C                     Z-ADD*ZERO     WN0076 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0077  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0078  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0079  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0080  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0081  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0082  70       Requested Deliv
     C                     MOVEL*BLANK    WN0083  1        Load Acceptance
     C                     MOVEL*BLANK    WN0084  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0085  70       On Yard Date
     C                     Z-ADD*ZERO     WN0086  60       On Yard Time
     C                     Z-ADD*ZERO     WN0087  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0088  60       Deadline Depart
     C                     MOVEL*BLANK    WN0089  1        Load Held Over
     C                     MOVEL*BLANK    WN0090  1        Load Held Over
     C                     MOVEL*BLANK    WN0091 15        Load Held Over
     C                     MOVEL*BLANK    WN0092 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0093 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0094  70       Express Mail Da
     C                     MOVEL*BLANK    WN0095  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0096  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0097  70       Product Complet
     C                     Z-ADD*ZERO     WN0098  60       Product Complet
     C                     Z-ADD*ZERO     WN0099  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0100  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0101  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0102  1        Load Confirmed
     C                     MOVEL*BLANK    WN0103 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0104  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0105  60       Load Door 1
     C                     Z-ADD*ZERO     WN0106  70       Override Total
     C                     Z-ADD*ZERO     WN0107  60       Load Door 2
     C                     MOVEL*BLANK    WN0108  1        Partial Load
     C                     MOVEL*BLANK    WN0109  1        Load Confirmati
     C                     MOVEL*BLANK    WN0110  1        Export Load USD
     C                     MOVEL*BLANK    WN0111  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0112 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0113 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0114 15        Late Billing Em
     C                     MOVEL*BLANK    WN0115 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0116 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0117  1        Multi Company L
     C                     MOVEL*BLANK    WN0118  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0119  1        LH Power Only L
     C                     MOVEL*BLANK    WN0120  1        MG Created Load
     C                     MOVEL*BLANK    WN0121  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0122  2        Load U_M
     C                     MOVEL*BLANK    WN0123  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0124  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0125  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0126  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0127  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0128  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0129  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0130  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0131  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0132  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0133  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0134  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0135  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0136  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0137  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0138  60       LH Unused Time
     C                     MOVEL*BLANK    WN0139  1        EDI Status 1
     C                     MOVEL*BLANK    WN0140  1        EDI Status 2
     C                     MOVEL*BLANK    WN0141  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0142  60       Job Time
     C                     MOVEL*BLANK    WN0143 10        User Id
     C                     MOVEL*BLANK    WN0144 10        Job Name
     C                     Z-ADD*ZERO     WN0145  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WHRMNB           Load ID
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHSZ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'Y'       WHRUSX    P      Fax Sent to SSI
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0146    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P1MPNA           Default Printer
     C                     MOVELDRBCCD    P1BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0017           Company Number
     C                     MOVELDRBUVN    WN0147           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0038    DTAJVN           User Profile Na
     C                     MOVELWL0039    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTB     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0040           Company Number
     C                     MOVELDTAJCD    WL0041           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTC01           Application Cod
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTC01           Application Cod
     C                     MOVEL'OMS'     WQTC01           Application Cod
      * Establish starting position
     C           KRSTC     SETLL@DNRESF                    *
     C           KRSTC     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
     C           KRSTC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTD01           Application Cod
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTD01           Application Cod
      * Establish starting position
     C           KRSTD     SETLL@DNRESF                    *
     C           KRSTD     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTD     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTE     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Application WHS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI7ST    YL0001           Application WHS
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 01/18/2010 PKD E000261 Pass the Average Pallet Tare
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 04/24/2011 LJB P000737
      * ** Pgm PODPUPR replaced with PDVVUPC. Parms changed to either
      * ** Print Only or Fax/Email to all carriers that are passed in.
      * ** *** Parms are:
      * ** Status-Y or N = Fax Carrier, Status Flag 1 Y/N=Fax Dispatcher,
      * ** Status Flag 2 Y/N=Fax Transloader, Status Flag 3 Y/N=Fax Mexic
      * ** Status Flag 4 Y/N=Fax Exp Coordn, Status Flag 5 Y/N=Fax Ocean
      * ** Usr Status (Y/N)=Print Only/Fax, Status Description 3=Printer
      * *****
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * *****************************************************************
      * DDSDDL PJ 03/20/2024: File 'Load Header's logical OMFJCPLI is now
      * To OMFJCPMS, that's why re-compiled this function to reference th
      * *****************************************************************
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change log
      *================================================================
      * ***************************************************************
      * 12/22/22 DN  DO4595 - WI 539 AES to AS400 Integrations
      * - Replaced call PMFXSRR with PUXRSRR to keep track of same Bookin
      *   for all Orders for Load. (Only for opt 13=Edt Ord Exp)
      * - Passed in parm 'Orders have Same Booking#' when calling program
      *   PNVZE2R.
      * ***************************************************************
      * S13509 RMC 7/30/2018 chg ctl.company sel from EQ to ** so multi w
      * ***************************************************************
      * E4119 RMC 7/15/2016 For TMS checks, when Live with TMSLDP, check
      *   Load header fld MG Created Load=Y to disable options: 12/13/15
      * and dont send to SSI Download file for MG Created load  8/18
      * E4119 RMC 7/01/2016 check pfs interface "TMSLDP" to control opt 1
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * ***************************************************************
      * ** 10/13/2014 RMC E3329
      * ** If record not selected, do a *QUIT to speed it up
      * ***************************************************************
      * ** 08/07/2013 RMC E2625
      * ** TPM - restrict certain options if Live w/TPM
      * ***************************************************************
      * ** 10/03/2013 RMC P00196
      * ** CAT2 - call reg pfs interface
      * ***************************************************************
      * ** 05/23/12 RMC E2117 PASS export parms to BOL PRint pmt
      * **
      * ** 01/31/2012 LJB C001921
      * ** Don't fax load confirmation if F3 is pressed to cancel
      * **
      * ** 05/25/2011 RMC E01488 (RI) the req dlv date if sls appt confrm
      * **
      * E00519 Access by WHS  IF
      * ---------- November 2009 PKD ----------
      * *****  WW Cust/Order Inq O.E.  *****
      * - Do not allow Transfer Co if Application WHS Restrict = Y.
      * ***** Edit Order Header ***** -TESTED 11/10/09
      * -  Added validation on Warehouse Code.  If Application WHS Restri
      * is Yes, then only the Warehouse Code for O/P Application Code
      * are allowed.  If the Application WHS Restrict is No, then the
      * User is allowed access to all Active Warehouses.
      * -  Changed the F4=Prompt to only display the Warehouses the
      * User has access to if the Application WHS Restrict is Yes.
      * ***** Edit Order Detail Lines & Copy Order Template ***** TESTED
      * -  Added validation for Item Code. For each application and
      * Warehouse, addtional access control is defined for TF Exempt Code
      * Users that are restricted by Warehouse, they may also be restrict
      * on the Items they are able to sell.
      * -  Added validation on Order TF Exempt Code.  If the Customer is
      * is Exempt, then they can only sell Exempt Product. (E00505)
      * ***** Edit Load Plan Order Entry *****
      * -  Added WHS Code to the Control Context and Record Context.
      * For Users that are Application WHS Restrict = Yes,
      * the CTL.Warehouse Code will be restricted to the
      * Warehouses that they have access to.
      * -  CTL.Warehouse Code will be required for Users with
      * Application Warehouse Controlled.
      * -  Added Delivery State Code (Sail Port State) to the screen.
      * It will default to the Ship To State Code.  It will be overriden
      * to the Sail Port State if the Shipping Line and Port Delivery
      * Terminal are entered in the Order Header Extent.
      * -  Added subfile select for WHS and Delv ST.
      * ***** Edit Load Plan *****
      * -  For Users that are Application WHS Restrict = Yes,
      * the CTL.Warehouse Code will be restricted to the
      * Warehouses that they have access to.
      * -  CTL.Warehouse Code will be required for Users with
      * Application Warehouse Controlled.
      * -  CTL.USR Load Type---Default from the CTL.USR Warehosue Code
      * for users that are Application WHS Restrict.
      * ***** Display Change Log/Accept Load (PDAOXFR) *****
      * -  Deletes will not be accepted by Application WHS Restricted
      * users because we do not know the Warehouse that was on the Load.
      * -  If Application WHS Restrict is Yes, then only select the load
      * for acceptance if at least one order on the load has a warehouse
      * where the user has access.
      * -  Reverse imaged Warehouse Code on the Display. The Users with
      * Application WHS Restrict of No will be able to see all Loads.
      * ***** Edit Load Plan *****
      * - Added Warehouse Code to the Control and Detail Context with
      * appropriate validations.
      * ***** Work With Load Confirmation *****
      * - Added Warehouse Code as a parameter from the Work With Load
      * Plan All screen for selection of the Loads to Display on the
      * screen.  Added selection for Warehouse Code if one passed in.
      * If the Load is not to be selected due to not matching the Whs,
      * a record is created for the load in the array (exception array).
      * - Added Warehouse Code to the Subfile.
      * ***** Order Status Report Prompt *****
      * - Added Warehouse Code restriction on the prompt.
      * ***** Work With Orders Price Audit/Maintenance *****
      * - Added Warehouse Code restriction.
      * ***** Work With Orders - Edit Ship Date  *****
      * - Added Warehouse Code restriction.
      * ***************************************************************
      * ** 04/27/2011 LJB P000737
      * ** Change the load confirmation print and load confirmation fax
      * ** process. No longer using Pmt Pass Co/Load/Sts UP, calls PDVVUP
      * ** instead and pass the correct parms - hardcoding has been remov
      * ** Fax/Print using Work File has been removed
      * ** See EXC Load Confirm Fax IF for explanation of new parameters
      * ***************************************************************
      * ** This is the job stream to get a fax sent out:
      * ** Calls PODPUPR, calls PDVVUPC, calls PDVVPCLP which calls PDAMX
      * ** 01/18/10 PKD E000261 SEND in PAR.Avg Pallet Tare to Gross Wt c
      * ** If Combos and palletized, subtract Pallet Tare from tare total
      * ** 11/05/2008 LJB FP1166
      * ** If opt 18 to fax to carrier selected, see if SSI Carrier, if
      * ** yes, see if SSI info already sent, if No-create a change recor
      * ** if Yes-create a change record, download to SSI PowerPro
      * ** If opt 2 to Edit Load Header, If Fax=Y, if this is SSI Carrier
      * ** send info to SSI PowerPro
      * ** 09/05/2008 slm add this enhancement to E00169 email
      * from Rose - asking to include with current project
      * ** Highlight the Load company if there are more then one
      * ** company on the load
      * ** review the multiple company and this field in the database
      * ** is either blank or N or Y on current records so since
      * ** this field can be blanks then read the load detail
      * ** and if the co number from the Load header does not
      * ** equal the co number on the load detail then
      * ** there are multiple companies on a load-Rev Image co
      * ** 08/29/2008 slm E00169
      * ** Allow specific user to use the Edt Csr/Dspatch screen
      * ** change this program to pass the value of *blanks on
      * ** warehouse specific _*blanks = *none
      * ** warehouse specific _= W - states this is warehouse specific
      * ** 08/21/2008 LJB E00207
      * ** Change company selector field to select *EQ if co# is entered.
      * ** 08/18/2008 LJB E00207
      * ** Add option 12 to calc miles, Add Override Total Load Miles to
      * ** Load Header and associated functionality
      * ** Highlight miles field if Override Miles is being displayed.
      * ** FT683 LJB 12/14/2007
      * ** Company # was removed from the Select Order for Export
      * ** Instructions pgm. Recompile.
      * ** 5/17/06 LJB T00008 - Recompile due to change in the length of
      * ** Fax Number field.
      * ** FP1101 LJB 04/09/2007
      * ** Use the edtfil from the Order Header Extension
      * 3/01/06 RMC Dont dft ctl.Company
      * 07/28/06 RMC TFS011 - add ctl sel on Last Stop city,
      * 5/17/04 RMC PKTR01 - Co is Load Start Company
      * * 05/15/00 PKD OMS336 Replaced with routine that will include
      * *              the Pallet Tare Weight.
      * OMS169 -  8/26/96 - S. Schertz
      *           Change ' Total Weight' to read 'Net Weight'.
      *           Correct error when selecting by State of last stop
      * OMS184 -  9/09/96 - S. Schertz
      *           States displayed in subfile should relate to state ente
      *           control record if field is not blank.
      * C3230  - 10/14/97 - P. Lyons
      *           Change so running fax, print interactively;
      *           Use QTEMP for work file
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03328
     C           ZINPOS    ANDLE05376
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  13        W0CSRR  50
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ADD  13        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD13        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ035
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2PKST'  YPMTFD           Load Status
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ075
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CB8ST'  YPMTFD           Status - Y or N
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ078
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2H9SX'  YPMTFD           Load Confirmed
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDGE031
     C           ZHCSCL    ANDLE032
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2Q2CD'  YPMTFD           Shipping Method
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DQCD           Enterprise Code
     C                     MOVEL*BLANK    P1DRCD           Enterprise Code
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2G3TX           PRT Description
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     Z-ADD*ZERO     P2DYNB           PRT Number of C
     C                     MOVEL*BLANK    P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P2AJAA           Company Number
     C                     Z-ADD*ZERO     P2AJAB           Date 1
     C                     Z-ADD*ZERO     P2AJAE           Order Number 1
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     MOVEL*BLANK    P2B8ST           Status - Y or N
     C                     MOVEL*BLANK    P2HWSX           Change Flag USR
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3AODT           Scheduled Ship
     C                     MOVEL*BLANK    P3XFST           Display Prt Opt
     C                     MOVEL*BLANK    P3E5ST           USR Output Only
     C                     MOVEL*BLANK    P3E7ST           USR Print Detai
     C                     Z-ADD*ZERO     P3SEQ1           Seq No 1  PASS
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL*BLANK    P3ECST           Error Status
     C                     Z-ADD*ZERO     P3CDWG           USR Weight Accu
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4DFCD           Salesperson Cod
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5B2VN           Job Name CDE
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6D4ST           USR Flag 1
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7RMNB           Load ID
     C                     MOVEL*BLANK    P7BZNA           Carrier Code
      * Clear all neither parameters
     C                     MOVEL*BLANK    P8A0NA           Job Name
      * Clear all neither parameters
     C                     MOVEL*BLANK    P9               USR Quit
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Numeric 4,0           USR
     C                     Z-ADD*ZERO     WUG0NX  40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Spacers
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           AR Customer Num
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A_R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR Qclscan Result ?
     C                     Z-ADD*ZERO     WUY8NB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WCRVNB           Stop_Drop
     C                     Z-ADD*ZERO     WCRWNB           Miles to next s
     C                     Z-ADD*ZERO     WCRXNB           Freight Charge
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WCT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WCT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCKFDT           Appointment Con
     C                     Z-ADD*ZERO     WCACTM           Appointment Con
     C                     Z-ADD*ZERO     WCEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WCAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WCN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WCN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WCB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WCB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WCB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Schedule Sequence Number
     C                     Z-ADD*ZERO     WUT4NB  50
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field USR Program name
     C                     MOVEL*BLANK    WUBNVN 10
      * Define work field USR Status (Y/N)
     C                     MOVEL*BLANK    WUE6ST  1
      * Define work field Status Description 3  USR
     C                     MOVEL*BLANK    WUNMTX 10
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    WUQ1ST  1
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Define work field Exit Selection USR
     C                     MOVEL*BLANK    WUG8SX  1
      * Define work field USR Order Number
     C                     Z-ADD*ZERO     WUMPNB  70
      * Define work field USR Company Number
     C                     Z-ADD*ZERO     WUFKNB  30
      * Define work field USR Exit Program
     C                     MOVEL*BLANK    WUSTYN  1
      * Define work field SSI Download Flag
     C                     MOVEL*BLANK    WUUNUS  1
      * Define work field Fax Sent to SSI Carrier
     C                     MOVEL*BLANK    WURUSX  1
      * Define work field SSI Add, Chg, Delete flag
     C                     MOVEL*BLANK    WUAHST  2
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 30
     C                     MOVEL*BLANK    WL0007 30
     C                     MOVEL*BLANK    WL0008 30
     C                     MOVEL*BLANK    WL0009 20
     C                     MOVEL*BLANK    WL0010  2
     C                     MOVEL*BLANK    WL0011 11
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  50
     C                     Z-ADD*ZERO     WL0014  92
     C                     Z-ADD*ZERO     WL0015  92
      * Define local variables for subroutine SVINFN.
     C                     Z-ADD*ZERO     WL0016 155
     C                     Z-ADD*ZERO     WL0017 155
     C                     MOVEL*BLANK    WL0018  3
     C                     MOVEL*BLANK    WL0019  3
     C                     MOVEL*BLANK    WL0020  3
     C                     MOVEL*BLANK    WL0021  4
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028 10
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030 25
     C                     MOVEL*BLANK    WL0031 10
     C                     MOVEL*BLANK    WL0032  4
     C                     MOVEL*BLANK    WL0033  4
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035 10
     C                     Z-ADD*ZERO     WL0036 155
     C                     MOVEL*BLANK    WL0037 50
      * Define local variables for subroutine TBRVGN.
     C                     MOVEL*BLANK    WL0038 10
     C                     MOVEL*BLANK    WL0039  6
     C                     Z-ADD*ZERO     WL0040  30
     C                     MOVEL*BLANK    WL0041  3
      * Define local work field Application WHS Restrict
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Ship Method Type USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field USR Warehouse Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Pallets Loaded
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0005  92
      * Define local work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YL0006  92
      * Define local work field Order Quantity
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field USR Deadline Deprt Time
     C                     Z-ADD*ZERO     YL0008  40
      * Define local work field USR Truck Depart Time
     C                     Z-ADD*ZERO     YL0009  40
      * Define local work field WHS/Item Access Sts USR
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Live with TPM
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Trailer ID USR
     C                     MOVEL*BLANK    YL0012 12
      * Define local work field Text 5 all caps     USR
     C                     MOVEL*BLANK    YL0013  5
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Total Load Miles
     C                     Z-ADD*ZERO     YN0002  70
      * Define local work field Orders have Same Booking#
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0017  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0018  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD04        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UCSUBR                     Modifications a
     C                     Z-ADD50000     W0SLM            *Scan limit
      *
     C                     MOVEL*BLANK    WN0146 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0146           User Profile Na
      *
     C                     MOVEL*BLANK    WN0147 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TARVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0146    ZA0020           User Profile Na
     C                     MOVEL'OMS'     ZA0021           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0147    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0146    WL0038    P      User Profile Na
     C                     MOVEL'OMS'     WL0039    P      Application Cod
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0040    P1AIC3           Company Number
     C                     MOVELWL0041    YL0018    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0147    WL0038    P      User Profile Na
     C                     MOVEL'OMS'     WL0039    P      Application Cod
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0040    P1AIC3           Company Number
     C                     MOVELWL0041    YL0018    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0018    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0146    ZA0022           User Profile Na
     C                     MOVEL'OMS'     ZA0023           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0017    IFNE 0                          *IF
     C                     Z-ADDYL0017    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0018    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0143  3        Warehouse Code
     C                     PARM YL0017    WQ0144  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TCRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVELP1MPNA    P2WRST           PRT Printer Dev
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     MOVEL'*YES'    P3XFST           Display Prt Opt
     C                     MOVEL'N'       P3E7ST           USR Print Detai
     C                     MOVEL'Y'       P1TAST           First Time Flag
     C                     MOVEL##JOB     P5B2VN           Job Name CDE
     C                     Z-ADD9         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST##JOB:ZQ  P8A0NA    P  90  Job Name
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           P8A0NA    CAT  'P':ZQ    P8A0NA    P      Job Name
     C                     MOVEL'N'       P9               USR Quit
     C                     MOVEL'N'       P2HWSX           Change Flag USR
      * SFL Fold/Drop  RPG    US - /UT User Source  * 
     C                     Z-ADD8         ##SFPG
     C                     Z-ADD1         P2DYNB           PRT Number of C
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
     C                     EXSR TERVGN
      * EXC Rtv Status        XF - PFS Interface  * Is tms load planning
     C                     CALL 'PBXNXFR'              90  EXC Rtv Status
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0145  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0146  6        PFS Interface C
     C           YL0011    PARM *BLANK    WQ0147  1        PFS Carlisle Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ***** Change log
     C                     EXSR UDSUBR                     ***** Change lo
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01048010550153801794028210282902833
02842028510285302858028650287102874
02887028910289403103031130333003333
03341033450335403363033650337003377
03383033860339903403034060360003615
0362503649
** W0END
01050010840161501871028270283102840
02849028510285602863028690287202885
02889028910289403104031150333103339
03343033520336103363033680337503381
03384033970340103403034060360303616
0362703656
** W0NAM
#CBCCD    #CALTX    #2ST1     **SPT     #2RMNB    V2AIC3    V2AODT
V2EIDT    #2PKST    #CG1NX    #CG2NX    #CIQT1    #2DBCD    #CS2TX
#2BZNA    #CB8ST    #2H9SX    #2Q2CD    #CCPCD    #1SEL     #1RMNB
V1AIC3    V1AODT    V1EIDT    #1PKST    #RG1NX    #RG2NX    #RY7TX
#RV9CD    #RS2TX    #1BZNA    #RB8ST    #1H9SX    #RG0NX    #1Q2CD
#RCPCD    V1P1DT
** @CN
00001 Y2U0003
00002 USR0752
00003 Y2U0005
00004 PRTLDCNFRM
00005 Print Load. Confirm.
00006 Y2U9999
00007 PNW2PFR$
00008 FAXLDCNFRM
00009 Reprint Bill of Lading
