/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - PRINT PROGRAM WITH SELECTIONS FOR GET READY REPORT-  */
/*             CO#, FROM ORDER, TO ORDER, ENTRY DATE,               */
/*             REQ. SHIP DATE and Department Code                   */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT Get Ready Report                              */
/*  DATE      -  6/15/07                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/*          &COMPNYN    - COMPANY NUMBER - BLANK FOR ALL            */
/*          &FRMORDN    - FROM ORDER                                */
/*          &TOORDRN    - TO ORDER                                  */
/*          &ENTDATN    - ENTRY DATE                                */
/*          &REQDATN    - SCHECULED SHIP DATE                       */
/*          &OUTQ       - OUTPUT QUEUE                              */
/*          &HOLD       - HOLD PRINT                                */
/*          &SAVE       - SAVE PRINT                                */
/*          &COPYN      - NUMBER OF COPIES                          */
/*          &NIGHTQ     - NIGHT OUTPUT QUEUE                        */
/*          &DEPT       - DEPARTMENT CODE- BLANK FOR ALL            */
/********************************************************************/
 PMH5UPC:    PGM        PARM(&COMPNYN &FRMORDN &TOORDRN &ENTDATN +
                          &REQDATN &OUTQ &HOLD &SAVE &COPYN &NIGHTQ +
                          &DEPT)

/* PARMS                                                                      */
        DCL    &COMPNYN    *DEC                  /* Company Number (Passed)   */
        DCL    &DEPT       *CHAR   (6)           /* Department Code (Passed)  */
        DCL    &FRMORDN    *DEC                  /* FROM ORDER     (Passed)   */
        DCL    &TOORDRN    *DEC                  /* TO ORDER       (Passed)   */
        DCL    &ENTDATN    *DEC                  /* ENTRY DATE     (Passed)   */
        DCL    &REQDATN    *DEC                  /* REQ SHIP DATE  (Passed)   */
        DCL    &COPYN      *DEC                  /* No. of Copies             */
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue              */
        DCL    &HOLD       *CHAR   (4)           /* Hold Status               */
        DCL    &SAVE       *CHAR   (4)           /* Save Status               */
        DCL    &NIGHTQ     *CHAR   (10)          /* Night Job Queue           */
        DCL    &PGMO       *CHAR    10           /*  PRINTER FILE  */
        DCL    &B          *CHAR    30           /*  QRY-SEL CO.#  */
        DCL    &C          *CHAR    30           /*  QRY-SEL ORDER TYPE */
        DCL    &CC         *CHAR    30           /*  QRY-SEL ORDER TYPE */
        DCL    &CCC        *CHAR    30           /*  QRY-SEL ORDER TYPE */
        DCL    &D          *CHAR    25           /*  QRY-EXPORT SALES  */
        DCL    &DD         *CHAR    30           /*  QRY-SEL ENTRY DATE  */
        DCL    &DDD        *CHAR    30           /*  QRY-SEL REQ. SHIP DATE  */
        DCL    &DDDD       *CHAR    30           /*  QRY-SEL ACT. SHIP DATE  */
        DCL    &E          *CHAR   275           /*  QRY COMPLETE SEL. */
        DCL    &COMMAND    *CHAR   (512)

/* INTERNAL FIELDS                                                            */
        DCL    &COPY       *DEC    (2 0)         /* Number of copies          */
        DCL    &COMPANY    *DEC    (3 0)         /* Company Number            */
        DCL    &FRORDR     *DEC    (7 0)         /* From ORDER                */
        DCL    &TOORDR     *DEC    (7 0)         /* To ORDER                  */
        DCL    &ENTDAT     *DEC    (7 0)         /* ENTRY DATE                */
        DCL    &REQDAT     *DEC    (7 0)         /* REQ. SHIP DATE            */
        DCL    &ACTSDAT    *DEC    (7 0)         /* REQ. SHIP DATE            */
        DCL    &COMMAND    *CHAR   (512)         /* FOR PRT OVERRIDE          */

/* OPENQRYF FIELDS                                                            */
        DCL    &COMPA      *CHAR    3            /* ACK COMPLETE              */
        DCL    &FRMORDA    *CHAR    7            /* FROM ORDER                */
        DCL    &TOORDRA    *CHAR    7            /* TO ORDER       (Passed)   */
        DCL    &ENTDATA    *CHAR    7            /* ENTRY DATE     (Passed)   */
        DCL    &REQDATA    *CHAR    7            /* REQ SHIP DATE  (Passed)   */

/********************************************************************/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/********************************************************************/
             CHGVAR     VAR(&PGMO) VALUE(PMH0PFR$)
             CHGVAR     VAR(&COMPANY) VALUE(&COMPNYN)
             CHGVAR     VAR(&COMPA) VALUE(&COMPANY)
             CHGVAR     VAR(&FRORDR) VALUE(&FRMORDN)
             CHGVAR     VAR(&FRMORDA) VALUE(&FRORDR)
             CHGVAR     VAR(&TOORDR) VALUE(&TOORDRN)
             CHGVAR     VAR(&TOORDRA) VALUE(&TOORDR)
             CHGVAR     VAR(&ENTDAT) VALUE(&ENTDATN)
             CHGVAR     VAR(&ENTDATA) VALUE(&ENTDAT)
             CHGVAR     VAR(&REQDAT) VALUE(&REQDATN)
             CHGVAR     VAR(&REQDATA) VALUE(&REQDAT)
             CHGVAR     VAR(&COPY) VALUE(&COPYN)

/*********************************************************************/
/*   CREATE OPEN QUERY FILE TO BE USED TO SELECT.                    */
/*********************************************************************/
/*  IF CO. NUMBER SELECTED  */
             IF         COND(&COMPA *NE '000') THEN(DO)
             CHGVAR     VAR(&B) VALUE('BEAIC3 *EQ ' *CAT &COMPA)
             ENDDO

/*  IF FROM ORDER IS ENTERED */

             IF         COND(&FRMORDA *NE '0000000') THEN(DO)
             CHGVAR     VAR(&CC) VALUE('*AND BEC4NB *GE ' *CAT &FRMORDA)
             ENDDO

/*  IF TO ORDER IS ENTERED */
             IF         COND(&TOORDRA *NE '0000000') THEN(DO)
             CHGVAR     VAR(&CCC) VALUE('*AND BEC4NB *LE ' *CAT &TOORDRA)
             ENDDO

/*  IF ENTRY DATE IS SELECTED */

             IF         COND(&ENTDATA *NE '0000000') THEN(DO)
             CHGVAR     VAR(&DD) VALUE('*AND BECXDT *EQ ' *CAT &ENTDATA)
             ENDDO


/*  IF SCHEDULED SHIP DATE IS SELECTED */

             IF         COND(&REQDATA *NE '0000000') THEN(DO)
             CHGVAR     VAR(&DDD) VALUE('*AND BEAODT *EQ ' *CAT &REQDATA)
             ENDDO



             CHGVAR     VAR(&E) VALUE(&B *BCAT &C *BCAT &CC *BCAT +
                          &CCC *BCAT &D *BCAT &DD *BCAT &DDD *BCAT +
                          &DDDD)

             OVRDBF     FILE(OPBFCPLN) SHARE(*YES)
             OPNQRYF    FILE((OPBFCPLN)) +
                        QRYSLT(&E) +
                        KEYFLD((BEAIC3) (BEC4NB)) +
                        SEQONLY(*YES 1)

/********************************************************************/
/* OVERRIDE PRINTER FILE WITH USER SPECIFIED SELECTION VALUES       */
/********************************************************************/
             OVRPRTF    FILE(PMH0PFR$) OUTQ(&OUTQ) COPIES(&COPY) +
                          HOLD(&HOLD) SAVE(&SAVE) USRDTA(&DEPT)


/*********************************************************************/
/*   CALL DRIVER WHICH CALLS THE PRINT FILE              */
/*********************************************************************/

DRIVER:      CALL       PGM(PMIAXFR) PARM(' ' &COMPANY &DEPT &FRORDR)


/*********************************************************************/
/*   CLOSE OPEN QUERY FILE -
/*********************************************************************/

             CLOF       OPNID(OPBFCPLN)
             DLTOVR     FILE(OPBFCPLN)

 END:        ENDPGM
