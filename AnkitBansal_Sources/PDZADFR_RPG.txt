     H/TITLE WW User Profile        DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 08/11/11  Time  : 14:21:16
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDZADFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW User Profile        DF Display file
      *
     FCADRREL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADRREL2IF  E           K        DISK
      * RSQ : User Profile Control      User Profile Model
      *
     FOPBFCPMEIF  E           K        DISK
      * RSQ : Order Header TRG          UserPrf/NOT C or X
      *
     FOPBGWKLYIF  E           K        DISK
      * RSQ : Order Detail              User Profile
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : User Entry Control        Retrieval index       NV
      *
     FPDL1REL1IF  E           K        DISK
      * RTV : User Warehouse Access     Retrieval index
      *
     FPNFOREL1IF  E           K        DISK
      * RTV : User Application Whs      Retrieval index
      *
     FPOCXREL1IF  E           K        DISK
      * RTV : User Prod Line Access     Retrieval index
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPC0REL0UF  E           K        DISK
      * UPD : User Entry Control        Update index
      *
     FCADTREL0UF  E           K        DISK
      * UPD : User Application Profile  Update index
      *
     FPDL1REL0UF  E           K        DISK
      * UPD : User Warehouse Access     Update index
      *
     FCADRREL0UF  E           K        DISK
      * UPD : User Profile Control      Update index
      *
     FPNFOREL0UF  E           K        DISK
      * UPD : User Application Whs      Update index
      *
     FPOCXREL0UF  E           K        DISK
      * UPD : User Prod Line Access     Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  05  6   @CN    25
     I@DRRESK
      * User Profile Control      User Profile Model
      * Renamed input format fields
     I              DRAJVN                          WAAJVN
     I              DRAUNA                          WAAUNA
     I              DRB8NA                          WAB8NA
     I              DRAHVN                          WAAHVN
     I              DRI6ST                          WAI6ST
     I              DRI7ST                          WAI7ST
     I              DRXMST                          WAXMST
     I              DRXNST                          WAXNST
     I              DRI8ST                          WAI8ST
     I              DRNLNB                          WANLNB
     I              DRMPNA                          WAMPNA
     I              DRBCCD                          WABCCD
     I              DRAIC3                          WAAIC3
     I              DRDQCD                          WADQCD
     I              DRDRCD                          WADRCD
     I              DRAJCD                          WAAJCD
     I              DRBUVN                          WABUVN
     I              DRUVST                          WAUVST
     I              DRUWST                          WAUWST
     I              DRUXST                          WAUXST
     I              DRAATM                          WAAATM
     I              DRAYNA                          WAAYNA
     I              DRA0NA                          WAA0NA
     I              DRAXDT                          WAAXDT
      *
     I@C0REO3
      * User Entry Control        Update index
      * Renamed input format fields
     I              C0AJVN                          WBAJVN
     I              C0DNCD                          WBDNCD
     I              C0AIC3                          WBAIC3
     I              C0GTST                          WBGTST
     I              C0GUST                          WBGUST
     I              C0GVST                          WBGVST
     I              C0QFST                          WBQFST
     I              C0HRST                          WBHRST
     I              C0JCST                          WBJCST
     I              C0HTST                          WBHTST
     I              C0HUST                          WBHUST
     I              C0HVST                          WBHVST
     I              C0IBST                          WBIBST
     I              C0AKVN                          WBAKVN
     I              C0BHVN                          WBBHVN
     I              C0BIVN                          WBBIVN
     I              C0BOVN                          WBBOVN
     I              C0NANB                          WBNANB
     I              C0NBNB                          WBNBNB
     I              C0NCNB                          WBNCNB
     I              C0Q0ST                          WBQ0ST
     I              C0JNCD                          WBJNCD
     I              C0UVST                          WBUVST
     I              C0UWST                          WBUWST
     I              C0UXST                          WBUXST
     I              C0AATM                          WBAATM
     I              C0AYNA                          WBAYNA
     I              C0A0NA                          WBA0NA
     I              C0AXDT                          WBAXDT
      *
     I@DTRETF
      * User Application Profile  Update index
      * Renamed input format fields
     I              DTAJVN                          WCAJVN
     I              DTDNCD                          WCDNCD
     I              DTAIC3                          WCAIC3
     I              DTDQCD                          WCDQCD
     I              DTDRCD                          WCDRCD
     I              DTAJCD                          WCAJCD
     I              DTJFST                          WCJFST
     I              DTUVST                          WCUVST
     I              DTUWST                          WCUWST
     I              DTUXST                          WCUXST
     I              DTAATM                          WCAATM
     I              DTAYNA                          WCAYNA
     I              DTA0NA                          WCA0NA
     I              DTAXDT                          WCAXDT
      *
     I@L1RESI
      * User Warehouse Access     Update index
      * Renamed input format fields
     I              L1AJVN                          WDAJVN
     I              L1AJCD                          WDAJCD
     I              L1UWAS                          WDUWAS
     I              L1EPSX                          WDEPSX
     I              L1EQSX                          WDEQSX
     I              L1ERSX                          WDERSX
     I              L1UWAT                          WDUWAT
     I              L1EKSX                          WDEKSX
     I              L1ECSX                          WDECSX
     I              L1EDSX                          WDEDSX
     I              L1EESX                          WDEESX
     I              L1EFSX                          WDEFSX
     I              L1EGSX                          WDEGSX
     I              L1EHSX                          WDEHSX
     I              L1EISX                          WDEISX
     I              L1EJSX                          WDEJSX
     I              L1UWAU                          WDUWAU
     I              L1ELSX                          WDELSX
     I              L1EMSX                          WDEMSX
     I              L1ENSX                          WDENSX
     I              L1EOSX                          WDEOSX
     I              L1UVST                          WDUVST
     I              L1UWST                          WDUWST
     I              L1UXST                          WDUXST
     I              L1VSST                          WDVSST
     I              L1AATM                          WDAATM
     I              L1AYNA                          WDAYNA
     I              L1A0NA                          WDA0NA
     I              L1AXDT                          WDAXDT
      *
     I@DRRETI
      * User Profile Control      Update index
      * Renamed input format fields
     I              DRAJVN                          WEAJVN
     I              DRAUNA                          WEAUNA
     I              DRB8NA                          WEB8NA
     I              DRAHVN                          WEAHVN
     I              DRI6ST                          WEI6ST
     I              DRI7ST                          WEI7ST
     I              DRXMST                          WEXMST
     I              DRXNST                          WEXNST
     I              DRI8ST                          WEI8ST
     I              DRNLNB                          WENLNB
     I              DRMPNA                          WEMPNA
     I              DRBCCD                          WEBCCD
     I              DRAIC3                          WEAIC3
     I              DRDQCD                          WEDQCD
     I              DRDRCD                          WEDRCD
     I              DRAJCD                          WEAJCD
     I              DRBUVN                          WEBUVN
     I              DRUVST                          WEUVST
     I              DRUWST                          WEUWST
     I              DRUXST                          WEUXST
     I              DRAATM                          WEAATM
     I              DRAYNA                          WEAYNA
     I              DRA0NA                          WEA0NA
     I              DRAXDT                          WEAXDT
      *
     I@FOREDC
      * User Application Whs      Update index
      * Renamed input format fields
     I              FOAJVN                          WFAJVN
     I              FODNCD                          WFDNCD
     I              FOAJCD                          WFAJCD
     I              FOGPST                          WFGPST
     I              FOGRST                          WFGRST
     I              FOG1ST                          WFG1ST
     I              FOGZST                          WFGZST
     I              FOVSST                          WFVSST
     I              FOMJDT                          WFMJDT
     I              FOBETM                          WFBETM
     I              FOCCVN                          WFCCVN
     I              FOCDVN                          WFCDVN
     I              FOMKDT                          WFMKDT
     I              FOBFTM                          WFBFTM
     I              FOCEVN                          WFCEVN
     I              FOCFVN                          WFCFVN
      *
     I@CXREQY
      * User Prod Line Access     Update index
      * Renamed input format fields
     I              CXAJVN                          WGAJVN
     I              CXAIC3                          WGAIC3
     I              CXR3CD                          WGR3CD
     I              CXEWAA                          WGEWAA
     I              CXOOSX                          WGOOSX
     I              CXOPSX                          WGOPSX
     I              CXORSX                          WGORSX
     I              CXPHSX                          WGPHSX
     I              CXPISX                          WGPISX
     I              CXPJSX                          WGPJSX
     I              CXPKSX                          WGPKSX
     I              CXPLSX                          WGPLSX
     I              CXUVST                          WGUVST
     I              CXUWST                          WGUWST
     I              CXUXST                          WGUXST
     I              CXVSST                          WGVSST
     I              CXAATM                          WGAATM
     I              CXAYNA                          WGAYNA
     I              CXA0NA                          WGA0NA
     I              CXAXDT                          WGAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WHAIC3
     I              BEC4NB                          WHC4NB
     I              BEJNCD                          WHJNCD
     I              BEANC7                          WHANC7
     I              BEBKC7                          WHBKC7
     I              BEBRTX                          WHBRTX
     I              BEHMNA                          WHHMNA
     I              BEHONA                          WHHONA
     I              BEHPNA                          WHHPNA
     I              BEHNNA                          WHHNNA
     I              BEDBCD                          WHDBCD
     I              BECKTX                          WHCKTX
     I              BEB0C7                          WHB0C7
     I              BEAETX                          WHAETX
     I              BEB1NA                          WHB1NA
     I              BEB3NA                          WHB3NA
     I              BEB4NA                          WHB4NA
     I              BEB2NA                          WHB2NA
     I              BEBHCD                          WHBHCD
     I              BEC8TX                          WHC8TX
     I              BEBCNA                          WHBCNA
     I              BEA0DT                          WHA0DT
     I              BEA5DT                          WHA5DT
     I              BEGNDT                          WHGNDT
     I              BEACDT                          WHACDT
     I              BEAQCD                          WHAQCD
     I              BEB6NA                          WHB6NA
     I              BEBYNA                          WHBYNA
     I              BEBZNA                          WHBZNA
     I              BEGTST                          WHGTST
     I              BEGVST                          WHGVST
     I              BEGUST                          WHGUST
     I              BEQFST                          WHQFST
     I              BECQCD                          WHCQCD
     I              BEGJST                          WHGJST
     I              BEGWST                          WHGWST
     I              BEGXST                          WHGXST
     I              BEGYST                          WHGYST
     I              BEAODT                          WHAODT
     I              BEAIVN                          WHAIVN
     I              BECXDT                          WHCXDT
     I              BEJZVA                          WHJZVA
     I              BEA1WG                          WHA1WG
     I              BEXIST                          WHXIST
     I              BEXJST                          WHXJST
     I              BEXKST                          WHXKST
     I              BEEIDT                          WHEIDT
     I              BEAFTM                          WHAFTM
     I              BEE8CD                          WHE8CD
     I              BEE9CD                          WHE9CD
     I              BERMNB                          WHRMNB
     I              BETBNB                          WHTBNB
     I              BER1NB                          WHR1NB
     I              BEPJST                          WHPJST
     I              BEU0ST                          WHU0ST
     I              BEU1ST                          WHU1ST
     I              BEQ2CD                          WHQ2CD
     I              BEU2ST                          WHU2ST
     I              BEVEST                          WHVEST
     I              BEVFST                          WHVFST
     I              BEVGST                          WHVGST
     I              BERPCD                          WHRPCD
     I              BERNNB                          WHRNNB
     I              BEVDST                          WHVDST
     I              BEATIN                          WHATIN
     I              BEU4ST                          WHU4ST
     I              BEU5ST                          WHU5ST
     I              BERSRN                          WHRSRN
     I              BEMHNA                          WHMHNA
     I              BEMINA                          WHMINA
     I              BEWBST                          WHWBST
     I              BER4CD                          WHR4CD
     I              BEBFCD                          WHBFCD
     I              BEQ4CD                          WHQ4CD
     I              BET3NB                          WHT3NB
     I              BESICD                          WHSICD
     I              BECONB                          WHCONB
     I              BECEST                          WHCEST
     I              BEAWDT                          WHAWDT
     I              BEJPCD                          WHJPCD
     I              BEXUST                          WHXUST
     I              BEZ1ST                          WHZ1ST
     I              BEVRVA                          WHVRVA
     I              BEOBST                          WHOBST
     I              BEBCST                          WHBCST
     I              BEBDST                          WHBDST
     I              BEB7VL                          WHB7VL
     I              BEGASX                          WHGASX
     I              BEGBSX                          WHGBSX
     I              BEGCSX                          WHGCSX
     I              BEGDSX                          WHGDSX
     I              BEFNSX                          WHFNSX
     I              BEFOSX                          WHFOSX
     I              BEFPSX                          WHFPSX
     I              BEFQSX                          WHFQSX
     I              BEFRSX                          WHFRSX
     I              BEFSSX                          WHFSSX
     I              BEFTSX                          WHFTSX
     I              BEFUSX                          WHFUSX
     I              BEFVSX                          WHFVSX
     I              BEFWSX                          WHFWSX
     I              BEFXSX                          WHFXSX
     I              BEFYSX                          WHFYSX
     I              BENODT                          WHNODT
     I              BENPDT                          WHNPDT
     I              BENQDT                          WHNQDT
     I              BENRDT                          WHNRDT
     I              BENSDT                          WHNSDT
     I              BEBPTM                          WHBPTM
     I              BEBQTM                          WHBQTM
     I              BEBRTM                          WHBRTM
     I              BEBSTM                          WHBSTM
     I              BEBTTM                          WHBTTM
     I              BEH0NX                          WHH0NX
     I              BEH1NX                          WHH1NX
     I              BEH2NX                          WHH2NX
     I              BEH3NX                          WHH3NX
     I              BEH4NX                          WHH4NX
     I              BEC0C7                          WHC0C7
     I              BEUVST                          WHUVST
     I              BEUWST                          WHUWST
     I              BEUXST                          WHUXST
     I              BEAATM                          WHAATM
     I              BEAYNA                          WHAYNA
     I              BEA0NA                          WHA0NA
     I              BEAXDT                          WHAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      * Outward parameters
     IPARC        DS                             18
      * KEY : User Entry Control        Retrieval index       NV
      * I : RST User Profile Name
     I                                        1  10 PAAJVN
      * I : RST Application Code
     I                                       11  16 PADNCD
      * I : RST Company Number
     I                                    P  17  180PAAIC3
      *
      * Outward parameters
     IPBRC        DS                             12
      * KEY : User Authority            Retrieval index
      * I : RST User Profile Name
     I                                        1  10 PBAJVN
      *
     IQOPC01    E DSOPC0REL0
      * UPD : User Entry Control        Update index
      * Renamed input format fields
     I              C0AJVN                          WBAJVN
     I              C0DNCD                          WBDNCD
     I              C0AIC3                          WBAIC3
     I              C0GTST                          WBGTST
     I              C0GUST                          WBGUST
     I              C0GVST                          WBGVST
     I              C0QFST                          WBQFST
     I              C0HRST                          WBHRST
     I              C0JCST                          WBJCST
     I              C0HTST                          WBHTST
     I              C0HUST                          WBHUST
     I              C0HVST                          WBHVST
     I              C0IBST                          WBIBST
     I              C0AKVN                          WBAKVN
     I              C0BHVN                          WBBHVN
     I              C0BIVN                          WBBIVN
     I              C0BOVN                          WBBOVN
     I              C0NANB                          WBNANB
     I              C0NBNB                          WBNBNB
     I              C0NCNB                          WBNCNB
     I              C0Q0ST                          WBQ0ST
     I              C0JNCD                          WBJNCD
     I              C0UVST                          WBUVST
     I              C0UWST                          WBUWST
     I              C0UXST                          WBUXST
     I              C0AATM                          WBAATM
     I              C0AYNA                          WBAYNA
     I              C0A0NA                          WBA0NA
     I              C0AXDT                          WBAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCADT1    E DSCADTREL0
      * UPD : User Application Profile  Update index
      * Renamed input format fields
     I              DTAJVN                          WCAJVN
     I              DTDNCD                          WCDNCD
     I              DTAIC3                          WCAIC3
     I              DTDQCD                          WCDQCD
     I              DTDRCD                          WCDRCD
     I              DTAJCD                          WCAJCD
     I              DTJFST                          WCJFST
     I              DTUVST                          WCUVST
     I              DTUWST                          WCUWST
     I              DTUXST                          WCUXST
     I              DTAATM                          WCAATM
     I              DTAYNA                          WCAYNA
     I              DTA0NA                          WCA0NA
     I              DTAXDT                          WCAXDT
      *
     IQPDL11    E DSPDL1REL0
      * UPD : User Warehouse Access     Update index
      * Renamed input format fields
     I              L1AJVN                          WDAJVN
     I              L1AJCD                          WDAJCD
     I              L1UWAS                          WDUWAS
     I              L1EPSX                          WDEPSX
     I              L1EQSX                          WDEQSX
     I              L1ERSX                          WDERSX
     I              L1UWAT                          WDUWAT
     I              L1EKSX                          WDEKSX
     I              L1ECSX                          WDECSX
     I              L1EDSX                          WDEDSX
     I              L1EESX                          WDEESX
     I              L1EFSX                          WDEFSX
     I              L1EGSX                          WDEGSX
     I              L1EHSX                          WDEHSX
     I              L1EISX                          WDEISX
     I              L1EJSX                          WDEJSX
     I              L1UWAU                          WDUWAU
     I              L1ELSX                          WDELSX
     I              L1EMSX                          WDEMSX
     I              L1ENSX                          WDENSX
     I              L1EOSX                          WDEOSX
     I              L1UVST                          WDUVST
     I              L1UWST                          WDUWST
     I              L1UXST                          WDUXST
     I              L1VSST                          WDVSST
     I              L1AATM                          WDAATM
     I              L1AYNA                          WDAYNA
     I              L1A0NA                          WDA0NA
     I              L1AXDT                          WDAXDT
      *
     IQCADR1    E DSCADRREL0
      * UPD : User Profile Control      Update index
      * Renamed input format fields
     I              DRAJVN                          WEAJVN
     I              DRAUNA                          WEAUNA
     I              DRB8NA                          WEB8NA
     I              DRAHVN                          WEAHVN
     I              DRI6ST                          WEI6ST
     I              DRI7ST                          WEI7ST
     I              DRXMST                          WEXMST
     I              DRXNST                          WEXNST
     I              DRI8ST                          WEI8ST
     I              DRNLNB                          WENLNB
     I              DRMPNA                          WEMPNA
     I              DRBCCD                          WEBCCD
     I              DRAIC3                          WEAIC3
     I              DRDQCD                          WEDQCD
     I              DRDRCD                          WEDRCD
     I              DRAJCD                          WEAJCD
     I              DRBUVN                          WEBUVN
     I              DRUVST                          WEUVST
     I              DRUWST                          WEUWST
     I              DRUXST                          WEUXST
     I              DRAATM                          WEAATM
     I              DRAYNA                          WEAYNA
     I              DRA0NA                          WEA0NA
     I              DRAXDT                          WEAXDT
      *
     IQPNFO1    E DSPNFOREL0
      * UPD : User Application Whs      Update index
      * Renamed input format fields
     I              FOAJVN                          WFAJVN
     I              FODNCD                          WFDNCD
     I              FOAJCD                          WFAJCD
     I              FOGPST                          WFGPST
     I              FOGRST                          WFGRST
     I              FOG1ST                          WFG1ST
     I              FOGZST                          WFGZST
     I              FOVSST                          WFVSST
     I              FOMJDT                          WFMJDT
     I              FOBETM                          WFBETM
     I              FOCCVN                          WFCCVN
     I              FOCDVN                          WFCDVN
     I              FOMKDT                          WFMKDT
     I              FOBFTM                          WFBFTM
     I              FOCEVN                          WFCEVN
     I              FOCFVN                          WFCFVN
      *
     IQPOCX1    E DSPOCXREL0
      * UPD : User Prod Line Access     Update index
      * Renamed input format fields
     I              CXAJVN                          WGAJVN
     I              CXAIC3                          WGAIC3
     I              CXR3CD                          WGR3CD
     I              CXEWAA                          WGEWAA
     I              CXOOSX                          WGOOSX
     I              CXOPSX                          WGOPSX
     I              CXORSX                          WGORSX
     I              CXPHSX                          WGPHSX
     I              CXPISX                          WGPISX
     I              CXPJSX                          WGPJSX
     I              CXPKSX                          WGPKSX
     I              CXPLSX                          WGPLSX
     I              CXUVST                          WGUVST
     I              CXUWST                          WGUWST
     I              CXUXST                          WGUXST
     I              CXVSST                          WGVSST
     I              CXAATM                          WGAATM
     I              CXAYNA                          WGAYNA
     I              CXA0NA                          WGA0NA
     I              CXAXDT                          WGAXDT
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WHAIC3
     I              BEC4NB                          WHC4NB
     I              BEJNCD                          WHJNCD
     I              BEANC7                          WHANC7
     I              BEBKC7                          WHBKC7
     I              BEBRTX                          WHBRTX
     I              BEHMNA                          WHHMNA
     I              BEHONA                          WHHONA
     I              BEHPNA                          WHHPNA
     I              BEHNNA                          WHHNNA
     I              BEDBCD                          WHDBCD
     I              BECKTX                          WHCKTX
     I              BEB0C7                          WHB0C7
     I              BEAETX                          WHAETX
     I              BEB1NA                          WHB1NA
     I              BEB3NA                          WHB3NA
     I              BEB4NA                          WHB4NA
     I              BEB2NA                          WHB2NA
     I              BEBHCD                          WHBHCD
     I              BEC8TX                          WHC8TX
     I              BEBCNA                          WHBCNA
     I              BEA0DT                          WHA0DT
     I              BEA5DT                          WHA5DT
     I              BEGNDT                          WHGNDT
     I              BEACDT                          WHACDT
     I              BEAQCD                          WHAQCD
     I              BEB6NA                          WHB6NA
     I              BEBYNA                          WHBYNA
     I              BEBZNA                          WHBZNA
     I              BEGTST                          WHGTST
     I              BEGVST                          WHGVST
     I              BEGUST                          WHGUST
     I              BEQFST                          WHQFST
     I              BECQCD                          WHCQCD
     I              BEGJST                          WHGJST
     I              BEGWST                          WHGWST
     I              BEGXST                          WHGXST
     I              BEGYST                          WHGYST
     I              BEAODT                          WHAODT
     I              BEAIVN                          WHAIVN
     I              BECXDT                          WHCXDT
     I              BEJZVA                          WHJZVA
     I              BEA1WG                          WHA1WG
     I              BEXIST                          WHXIST
     I              BEXJST                          WHXJST
     I              BEXKST                          WHXKST
     I              BEEIDT                          WHEIDT
     I              BEAFTM                          WHAFTM
     I              BEE8CD                          WHE8CD
     I              BEE9CD                          WHE9CD
     I              BERMNB                          WHRMNB
     I              BETBNB                          WHTBNB
     I              BER1NB                          WHR1NB
     I              BEPJST                          WHPJST
     I              BEU0ST                          WHU0ST
     I              BEU1ST                          WHU1ST
     I              BEQ2CD                          WHQ2CD
     I              BEU2ST                          WHU2ST
     I              BEVEST                          WHVEST
     I              BEVFST                          WHVFST
     I              BEVGST                          WHVGST
     I              BERPCD                          WHRPCD
     I              BERNNB                          WHRNNB
     I              BEVDST                          WHVDST
     I              BEATIN                          WHATIN
     I              BEU4ST                          WHU4ST
     I              BEU5ST                          WHU5ST
     I              BERSRN                          WHRSRN
     I              BEMHNA                          WHMHNA
     I              BEMINA                          WHMINA
     I              BEWBST                          WHWBST
     I              BER4CD                          WHR4CD
     I              BEBFCD                          WHBFCD
     I              BEQ4CD                          WHQ4CD
     I              BET3NB                          WHT3NB
     I              BESICD                          WHSICD
     I              BECONB                          WHCONB
     I              BECEST                          WHCEST
     I              BEAWDT                          WHAWDT
     I              BEJPCD                          WHJPCD
     I              BEXUST                          WHXUST
     I              BEZ1ST                          WHZ1ST
     I              BEVRVA                          WHVRVA
     I              BEOBST                          WHOBST
     I              BEBCST                          WHBCST
     I              BEBDST                          WHBDST
     I              BEB7VL                          WHB7VL
     I              BEGASX                          WHGASX
     I              BEGBSX                          WHGBSX
     I              BEGCSX                          WHGCSX
     I              BEGDSX                          WHGDSX
     I              BEFNSX                          WHFNSX
     I              BEFOSX                          WHFOSX
     I              BEFPSX                          WHFPSX
     I              BEFQSX                          WHFQSX
     I              BEFRSX                          WHFRSX
     I              BEFSSX                          WHFSSX
     I              BEFTSX                          WHFTSX
     I              BEFUSX                          WHFUSX
     I              BEFVSX                          WHFVSX
     I              BEFWSX                          WHFWSX
     I              BEFXSX                          WHFXSX
     I              BEFYSX                          WHFYSX
     I              BENODT                          WHNODT
     I              BENPDT                          WHNPDT
     I              BENQDT                          WHNQDT
     I              BENRDT                          WHNRDT
     I              BENSDT                          WHNSDT
     I              BEBPTM                          WHBPTM
     I              BEBQTM                          WHBQTM
     I              BEBRTM                          WHBRTM
     I              BEBSTM                          WHBSTM
     I              BEBTTM                          WHBTTM
     I              BEH0NX                          WHH0NX
     I              BEH1NX                          WHH1NX
     I              BEH2NX                          WHH2NX
     I              BEH3NX                          WHH3NX
     I              BEH4NX                          WHH4NX
     I              BEC0C7                          WHC0C7
     I              BEUVST                          WHUVST
     I              BEUWST                          WHUWST
     I              BEUXST                          WHUXST
     I              BEAATM                          WHAATM
     I              BEAYNA                          WHAYNA
     I              BEA0NA                          WHA0NA
     I              BEAXDT                          WHAXDT
      *
     IYARDCS      DS                            779
      * Outward parameters
     IPCRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PCAIC3
      * I :  Order Number
     I                                    P   3   60PCC4NB
      * I :  Order Type - Sales
     I                                        7   8 PCJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PCANC7
      * I :  Ship To Customer
     I                                    P  13  160PCBKC7
      * I :  Ship To Name
     I                                       17  46 PCBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PCHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PCHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PCHPNA
      * I :  Ship To City
     I                                      137 156 PCHNNA
      * I :  Ship To State Code
     I                                      157 158 PCDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PCCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PCB0C7
      * I :  Bill to Name
     I                                      174 203 PCAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PCB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PCB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PCB4NA
      * I :  Bill to City
     I                                      294 313 PCB2NA
      * I :  Bill to State Code
     I                                      314 315 PCBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PCC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PCBCNA
      * I :  Order Date
     I                                    P 342 3450PCA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PCA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PCGNDT
      * I :  Cancel Date
     I                                    P 354 3570PCACDT
      * I :  Terms Code
     I                                      358 359 PCAQCD
      * I :  Special Instructions
     I                                      360 399 PCB6NA
      * I :  Special Instructions 2
     I                                      400 439 PCBYNA
      * I :  Carrier Code
     I                                      440 442 PCBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PCGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PCGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PCGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PCQFST
      * I :  Reason Code
     I                                      447 449 PCCQCD
      * I :  Order in Use
     I                                      450 450 PCGJST
      * I :  Header Status
     I                                      451 451 PCGWST
      * I :  Header Status Last
     I                                      452 452 PCGXST
      * I :  Order Type Print Status
     I                                      453 453 PCGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PCAODT
      * I :  User Original Entry
     I                                      458 467 PCAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PCCXDT
      * I :  Order Value Total
     I                                    P 472 4772PCJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PCA1WG
      * I :  Credit Hold
     I                                      484 484 PCXIST
      * I :  Production Hold
     I                                      485 485 PCXJST
      * I :  New Customer Hold
     I                                      486 486 PCXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PCEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PCAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PCE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PCE9CD
      * I :  Load ID
     I                                    P 510 5130PCRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PCTBNB
      * I :  Rated Freight
     I                                    P 517 5222PCR1NB
      * I :  LTL Flag
     I                                      523 523 PCPJST
      * I :  Price Audit
     I                                      524 524 PCU0ST
      * I :  Price Status
     I                                      525 525 PCU1ST
      * I :  Shipping Method
     I                                      526 527 PCQ2CD
      * I :  Export Status
     I                                      528 528 PCU2ST
      * I :  Palletize
     I                                      529 529 PCVEST
      * I :  Shrink Wrap
     I                                      530 530 PCVFST
      * I :  Slip Sheet
     I                                      531 531 PCVGST
      * I :  Age Code
     I                                      532 532 PCRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PCRNNB
      * I :  Load Type
     I                                      536 536 PCVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PCATIN
      * I :  Load Plan Order
     I                                      541 541 PCU4ST
      * I :  Print Pick Slip
     I                                      542 542 PCU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PCRSRN
      * I :  Special Comment 1
     I                                      547 576 PCMHNA
      * I :  Special Comment 2
     I                                      577 606 PCMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PCWBST
      * I :  Sales Route Code
     I                                      608 610 PCR4CD
      * I :  Manager Level Code
     I                                      611 612 PCBFCD
      * I :  VP Level Code
     I                                      613 615 PCQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PCT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PCSICD
      * I :  Invoice Number
     I                                    P 623 6260PCCONB
      * I :  Invoice Suffix
     I                                      627 628 PCCEST
      * I :  Invoice Date
     I                                    P 629 6320PCAWDT
      * I :  Event Code
     I                                      633 634 PCJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PCXUST
      * I :  Modified Flag
     I                                      636 636 PCZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PCVRVA
      * I :  Billing Activity Type
     I                                      643 643 PCOBST
      * I :  Block Order Flag
     I                                      644 644 PCBCST
      * I :  Order Certification Flag
     I                                      645 645 PCBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PCB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PCGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PCGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PCGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PCGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PCFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PCFOSX
      * I :  Order Emailed
     I                                      658 658 PCFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PCFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PCFRSX
      * I :  Broker Order Status
     I                                      661 661 PCFSSX
      * I :  Air Freight Order
     I                                      662 662 PCFTSX
      * I :  Signal Demand Send Sts
     I                                      663 664 PCFUSX
      * I :  EDI Nistevo Select Sts
     I                                      665 666 PCFVSX
      * I :  Export USDA Approved
     I                                      667 668 PCFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PCFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PCFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PCNODT
      * I :  OH Unused Date 2
     I                                    P 679 6820PCNPDT
      * I :  OH Unused Date 3
     I                                    P 683 6860PCNQDT
      * I :  OH Unused Date 4
     I                                    P 687 6900PCNRDT
      * I :  OH Unused Date 5
     I                                    P 691 6940PCNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PCBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PCBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PCBRTM
      * I :  OH Unused Time 4
     I                                    P 707 7100PCBSTM
      * I :  OH Unused Time 5
     I                                    P 711 7140PCBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PCH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PCH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PCH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PCH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PCH4NX
      * I :  Claim Number
     I                                    P 745 7480PCC0C7
      * I :  EDI Status 1
     I                                      749 749 PCUVST
      * I :  EDI Status 2
     I                                      750 750 PCUWST
      * I :  EDI Status 3
     I                                      751 751 PCUXST
      * I :  Job Time
     I                                    P 752 7550PCAATM
      * I :  User Id
     I                                      756 765 PCAYNA
      * I :  Job Name
     I                                      766 775 PCA0NA
      * I :  Job Date
     I                                    P 776 7790PCAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
     IYBRDCS      DS                            525
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Print Options
      * N :  PRT Printer Device
     I                                        1  10 P1WRST
      * N :  PRT Hold Output Sts
     I                                       11  14 P1WSST
      * N :  PRT Save Output Sts
     I                                       15  18 P1WTST
      * N :  PRT Number of Copies
     I                                       19  200P1DYNB
      * N :  PRT Night Queue Run Sts
     I                                       21  21 P1WUST
      * N :  PRT Night Queue
     I                                       22  31 P1BVVN
     IP2PARM      DS
      * N :  System Value Numeric
     I                                    P   1   85P2M8NB
     IP3PARM      DS
      * N :  Company Number
     I                                    P   1   20P3AIC3
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'User Model has Depend.'
      * *SFLSEL
     I                                        1   1 ZA0001
      * Message data for 'Appl. Access Memos denied'
      * *SFLSEL
     I                                        1   1 ZA0002
      * Message data for 'Company not selected'
      * *SFLSEL
     I                                        1   1 ZA0003
      * Message data for 'Application Profile Model'
      * User Profile Name
     I                                        1  10 ZA0004
      * Message data for 'User Profile-can't delete'
      * User Profile Name
     I                                        1  10 ZA0005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL#2AJVN    DRAJVN
     C           KPOS      SETLL@DRRETH
     C                     READ @DRRETH                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2B8NA    WZB8NA
     C                     MOVEL#2B8NA    WZB8NA           System Date For
     C           *LIKE     DEFN #2AHVN    WZAHVN
     C                     MOVEL#2AHVN    WZAHVN           Printer Device
     C           *LIKE     DEFN #2NLNB    WZNLNB
     C                     MOVEL#2NLNB    WZNLNB           Entity Number
     C           *LIKE     DEFN #2MPNA    WZMPNA
     C                     MOVEL#2MPNA    WZMPNA           Default Printer
     C           *LIKE     DEFN #2BCCD    WZBCCD
     C                     MOVEL#2BCCD    WZBCCD           Salesperson Cod
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2DQCD    WZDQCD
     C                     MOVEL#2DQCD    WZDQCD           Enterprise Code
     C           *LIKE     DEFN #2DRCD    WZDRCD
     C                     MOVEL#2DRCD    WZDRCD           Enterprise Code
     C           *LIKE     DEFN #2AJCD    WZAJCD
     C                     MOVEL#2AJCD    WZAJCD           Warehouse Code
     C           *LIKE     DEFN #2UVST    WZUVST
     C                     MOVEL#2UVST    WZUVST           EDI Status 1
     C           *LIKE     DEFN #2UWST    WZUWST
     C                     MOVEL#2UWST    WZUWST           EDI Status 2
     C           *LIKE     DEFN #2UXST    WZUXST
     C                     MOVEL#2UXST    WZUXST           EDI Status 3
     C           *LIKE     DEFN #2AATM    WZAATM
     C                     MOVEL#2AATM    WZAATM           Job Time
     C           *LIKE     DEFN #2AYNA    WZAYNA
     C                     MOVEL#2AYNA    WZAYNA           User Id
     C           *LIKE     DEFN #2A0NA    WZA0NA
     C                     MOVEL#2A0NA    WZA0NA           Job Name
     C           *LIKE     DEFN #2AXDT    WZAXDT
     C                     MOVEL#2AXDT    WZAXDT           Job Date
     C           *LIKE     DEFN #2AJVN    WZAJVN
     C                     MOVEL#2AJVN    WZAJVN           User Profile Na
     C           *LIKE     DEFN #2AUNA    WZAUNA
     C                     MOVEL#2AUNA    WZAUNA           Description
     C           *LIKE     DEFN #2BUVN    WZBUVN
     C                     MOVEL#2BUVN    WZBUVN           User Code Model
     C           *LIKE     DEFN #2I7ST    WZI7ST
     C                     MOVEL#2I7ST    WZI7ST           Application WHS
     C           *LIKE     DEFN #2I6ST    WZI6ST
     C                     MOVEL#2I6ST    WZI6ST           Allow Multi-Com
      * Translate search mask for text field
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2AUNA    WQAUNA           Description
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 30        WQA5N   50
     C                     PARM #2AUNA    WQAUNA           Description
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@DRRETH                  90*
     C  N82                READ @DRRETH                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,36
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2B8NA    IFNE *BLANK                     System Date For
     C           DRB8NA    CABNE#2B8NA    BB020            System Date For
     C                     END
     C           #2AHVN    IFNE *BLANK                     Printer Device
     C           DRAHVN    CABNE#2AHVN    BB020            Printer Device
     C                     END
     C           #2NLNB    IFNE *ZERO                      Entity Number
     C           DRNLNB    CABNE#2NLNB    BB020            Entity Number
     C                     END
     C           #2MPNA    IFNE *BLANK                     Default Printer
     C           DRMPNA    CABNE#2MPNA    BB020            Default Printer
     C                     END
     C           #2BCCD    IFNE *BLANK                     Salesperson Cod
     C           DRBCCD    CABNE#2BCCD    BB020            Salesperson Cod
     C                     END
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           DRAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C           #2DQCD    IFNE *BLANK                     Enterprise Code
     C           DRDQCD    CABNE#2DQCD    BB020            Enterprise Code
     C                     END
     C           #2DRCD    IFNE *BLANK                     Enterprise Code
     C           DRDRCD    CABNE#2DRCD    BB020            Enterprise Code
     C                     END
     C           #2AJCD    IFNE *BLANK                     Warehouse Code
     C           DRAJCD    CABNE#2AJCD    BB020            Warehouse Code
     C                     END
     C           #2UVST    IFNE *BLANK                     EDI Status 1
     C           DRUVST    CABNE#2UVST    BB020            EDI Status 1
     C                     END
     C           #2UWST    IFNE *BLANK                     EDI Status 2
     C           DRUWST    CABNE#2UWST    BB020            EDI Status 2
     C                     END
     C           #2UXST    IFNE *BLANK                     EDI Status 3
     C           DRUXST    CABNE#2UXST    BB020            EDI Status 3
     C                     END
     C           #2AATM    IFNE *ZERO                      Job Time
     C           DRAATM    CABNE#2AATM    BB020            Job Time
     C                     END
     C           #2AYNA    IFNE *BLANK                     User Id
     C           DRAYNA    CABNE#2AYNA    BB020            User Id
     C                     END
     C           #2A0NA    IFNE *BLANK                     Job Name
     C           DRA0NA    CABNE#2A0NA    BB020            Job Name
     C                     END
     C           #2AXDT    IFNE *ZERO                      Job Date
     C           DRAXDT    CABNE#2AXDT    BB020            Job Date
     C                     END
     C           #2AUNA    IFNE *BLANK                     Description
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           DRAUNA           Description
      * Length
     C                     PARM 30        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQAUNA
      * Length
     C                     PARM 30        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2BUVN    IFNE *BLANK                     User Code Model
     C           DRBUVN    CABNE#2BUVN    BB020            User Code Model
     C                     END
     C           #2I7ST    IFNE *BLANK                     Application WHS
     C           DRI7ST    CABNE#2I7ST    BB020            Application WHS
     C                     END
     C           #2I6ST    IFNE *BLANK                     Allow Multi-Com
     C           DRI6ST    CABNE#2I6ST    BB020            Allow Multi-Com
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @DRRETH                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Application WHS Restrict
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2I7ST'  IFEQ YPMTFD
      * Application WHS Restrict
     C                     MOVEL#2I7ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFI7ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZFI7ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZFI7ST
     C                     ENDSL
     C                     EXFMTZEI7ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFI7ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZFI7ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2I7ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Allow Multi-Company
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2I6ST'  IFEQ YPMTFD
      * Allow Multi-Company
     C                     MOVEL#2I6ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFI6ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZFI6ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZFI6ST
     C                     ENDSL
     C                     EXFMTZEI6ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFI6ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZFI6ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2I6ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAJVN    CASNE#2AJVN    FBRQRL
     C           WZAUNA    CASNE#2AUNA    FBRQRL
     C           WZBUVN    CASNE#2BUVN    FBRQRL
     C           WZI7ST    CASNE#2I7ST    FBRQRL
     C           WZI6ST    CASNE#2I6ST    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * Add New User Profile
      * CASE: CTL.*CMD key is *Add Details
     C           *IN06     IFEQ '1'                        *IF
      * EDT User Profile       E1 - User Profile Control  * 
     C                     CALL 'PDZBE1R'              90  EDT User Profil
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AJVN    WQ0001 10        User Profile Na
     C                     PARM #2BUVN    WQ0002 10        User Code Model
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZBE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Print User Profiles
      * CASE: CTL.*CMD key is *Print 21
     C           *IN21     IFEQ '1'                        *IF
      * PMT Pass Model         UP - /UT User Programs  * 
     C                     CALL 'PDAOUPR'              90  PMT Pass Model
     C           WUH3TX    PARM *BLANK    WQ0003  7        Return Code Usr
     C                     PARM 'C/A'     WQ0004  6        Application Cod
     C                     PARM @CN,001   WQ0005 10        Program name US
     C                     PARM #2BUVN    WQ0006 10        User Code Model
     C           P2M8NB    PARM P2M8NB    WQ0007 155       System Value Nu
     C                     PARM @CN,002   WQ0008 25        PRT Description
     C           P1WRST    PARM P1WRST    WQ0009 10        PRT Printer Dev
     C           P1WSST    PARM P1WSST    WQ0010  4        PRT Hold Output
     C           P1WTST    PARM P1WTST    WQ0011  4        PRT Save Output
     C           P1WUST    PARM P1WUST    WQ0012  1        PRT Night Queue
     C           P1BVVN    PARM P1BVVN    WQ0013 10        PRT Night Queue
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
     C                     END
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'File has been printed'
     C                     MOVEL'USR1742' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Print User Profiles - Yields
      * CASE: CTL.*CMD key is CF22
     C           *IN22     IFEQ '1'                        *IF
      * PMT Pass Model         UP - /UT User Programs  * 
     C                     CALL 'PDAOUPR'              90  PMT Pass Model
     C           WUH3TX    PARM *BLANK    WQ0014  7        Return Code Usr
     C                     PARM 'C/A'     WQ0015  6        Application Cod
     C                     PARM @CN,003   WQ0016 10        Program name US
     C                     PARM #2BUVN    WQ0017 10        User Code Model
     C           P2M8NB    PARM P2M8NB    WQ0018 155       System Value Nu
     C                     PARM @CN,002   WQ0019 25        PRT Description
     C           P1WRST    PARM P1WRST    WQ0020 10        PRT Printer Dev
     C           P1WSST    PARM P1WSST    WQ0021  4        PRT Hold Output
     C           P1WTST    PARM P1WTST    WQ0022  4        PRT Save Output
     C           P1WUST    PARM P1WUST    WQ0023  1        PRT Night Queue
     C           P1BVVN    PARM P1BVVN    WQ0024 10        PRT Night Queue
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
     C                     END
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'File has been printed'
     C                     MOVEL'USR1742' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,36
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * Perform is Change Selected
      * CASE: RCD.*SFLSEL is *Change Status
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
     C                     MOVEL*BLANK    #1BUVN           User Code Model
      * EDT User Profile       E1 - User Profile Control  * 
     C                     CALL 'PDZBE1R'              90  EDT User Profil
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AJVN    WQ0025 10        User Profile Na
     C                     PARM #1BUVN    WQ0026 10        User Code Model
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZBE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Validate Delete Request
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * * If deleting a model, there must be no dependencies.
      * Validation for dependencies
      * CASE: RCD.User Code Model is equal to blank
     C           #1BUVN    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       YL0001           USR Status (Y/N
      * RTV by User Prf. Model RT - User Profile Control  * 
     C                     EXSR SARVGN
      * Checks to see if user are based on model before model is deleted.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0001           *SFLSEL
      * Send message 'User Model has Depend.'
     C                     MOVEL'USR1701' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUJ1TX    YL0002           User Original E
      * Rtv User Prof Order    RT - PD Order Header      TRG  * 
     C                     EXSR SBRVGN
      * Rtv User Prof         RT - PD Order Detail  * 
     C                     EXSR SCRVGN
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Record Found USR is Record Found
      *   |- c2    : LCL.Record Found -OrdDtlUSR is Record Found
      *   '-
     C           YL0004    IFEQ 'Y'                        *IF
     C           YL0005    OREQ 'Y'                        *OR
      * CASE: LCL.Sales Route Code is not entered
     C           YL0003    IFEQ *BLANK                     *IF
     C                     MOVELYL0006    YL0003           Sales Route Cod
     C                     END                             *FI
      * Pmt User Prof Delete   PV - User Profile Control  * 
     C                     CALL 'POCFPVR'              90  Pmt User Prof D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AJVN    WQ0027 10        User Profile Na
     C                     PARM #1AUNA    WQ0028 30        Description
     C           YL0002    PARM YL0002    WQ0029 10        User Original E
     C                     PARM YL0003    WQ0030  3        Sales Route Cod
     C           W0RTN     PARM W0RTN     WQ0031  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POCFPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Perform Copy request
      * CASE: RCD.*SFLSEL is *Copy request
     C           #1SEL     IFEQ '3'                        *IF
     C           #1SEL     OREQ ' 3'
      * * Retrieve selected model to edit that it truely is a model
      * RTV Validate Profile  RT - User Profile Control  * 
     C                     EXSR SDRVGN
      * *  Prepare User Profile code for add using modeled on
     C                     MOVEL#1AJVN    #1BUVN           User Code Model
     C                     MOVEL#1AJVN    WUAJVN           User Profile Na
     C                     MOVEL*BLANK    #1AJVN           User Profile Na
      * EDT User Profile       E1 - User Profile Control  * 
     C                     CALL 'PDZBE1R'              90  EDT User Profil
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AJVN    WQ0032 10        User Profile Na
     C                     PARM #1BUVN    WQ0033 10        User Code Model
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZBE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVELWUAJVN    #1AJVN           User Profile Na
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Perform is Application Profile
      * CASE: RCD.*SFLSEL is *Application Profiles
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * CASE: RCD.User Code Model is equal to blank
     C           #1BUVN    IFEQ *BLANK                     *IF
      * WW Application Prof.   DF - Application Profile  * 
     C                     CALL 'PDZODFR'              90  WW Application
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AJVN    WQ0034 10        User Profile Na
     C                     PARM #1AUNA    WQ0035 30        Description
     C                     PARM #1AIC3    WQ0036  30       Company Number
     C                     PARM #1AJCD    WQ0037  3        Warehouse Code
     C                     PARM #1BUVN    WQ0038 10        User Code Model
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZODFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * WW Application Prof.   DF - Application Profile  * 
     C                     CALL 'PDZODFR'              90  WW Application
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BUVN    WQ0039 10        User Profile Na
     C                     PARM #1AUNA    WQ0040 30        Description
     C                     PARM #1AIC3    WQ0041  30       Company Number
     C                     PARM #1AJCD    WQ0042  3        Warehouse Code
     C                     PARM #1BUVN    WQ0043 10        User Code Model
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZODFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CM Entry Control
      * CASE: RCD.*SFLSEL is *Memo Entry Control
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
     C                     MOVEL*BLANK    WUDNCD           Application Cod
     C                     MOVEL'MEMO'    WUDNCD           Application Cod
      * Validate Memo processing access & get default company
      * CASE: RCD.User Code Model is equal to blank
     C           #1BUVN    IFEQ *BLANK                     *IF
      * RTV Appl O/P           RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0001    P      User Profile Na
     C                     MOVELWUDNCD    WL0002    P      Application Cod
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    P3AIC3           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl O/P           RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BUVN    WL0001    P      User Profile Na
     C                     MOVELWUDNCD    WL0002    P      Application Cod
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    P3AIC3           Company Number
     C                     END                             *FI
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0002           *SFLSEL
      * Send message 'Appl. Access Memos denied'
     C                     MOVEL'USR1978' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Select company if allow multi company
      * CASE: RCD.Allow Multi-Company is yes
     C           #1I6ST    IFEQ 'Y'                        *IF
      * SEL Co by Nbr w Rtn Cd SR - Company Name and Address  * 
     C                     CALL 'PDL7SRR'              90  SEL Co - Rtn 0
     C                     PARM *BLANK    W0RTN   7
     C           P3AIC3    PARM P3AIC3    WQ0044  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     Z-ADD*ZERO     P3AIC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
      * Edit Memo entry control if have a company selected
      * CASE: PAR.Accounting Company Number is not equal to zero
     C           P3AIC3    IFNE *ZERO                      *IF
      * EDT Cr/Dr/Ord Control  E1 - OP Entry Control  * 
     C                     CLEARPARC
     C                     MOVEL#1AJVN    PAAJVN    P      User Profile Na
     C                     MOVEL'C/M'     PADNCD    P      Application Cod
     C                     Z-ADDP3AIC3    PAAIC3           Company Number
      *
     C                     CALL 'PDP5E1R'              90  EDT Cr/Dr/Ord C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: User Entry
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP5E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0003           *SFLSEL
      * Send message 'Company not selected'
     C                     MOVEL'USR1773' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Warehouse Access
      * CASE: RCD.*SFLSEL is Option 10
     C           #1SEL     IFEQ '10'                       *IF
      * CASE: RCD.User Code Model is equal to blank
     C           #1BUVN    IFEQ *BLANK                     *IF
      * Edt User Whs Access   EF - User Warehouse Access  * 
     C                     CALL 'PDHREFR'              90  Edt User Whs Ac
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AJVN    WQ0045 10        User Profile Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHREFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Edt User Whs Access   EF - User Warehouse Access  * 
     C                     CALL 'PDHREFR'              90  Edt User Whs Ac
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BUVN    WQ0046 10        User Profile Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHREFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 11=Production Line Access
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
      * Edt Prod Line Access  EF - User Prod Line Access  * 
     C                     CALL 'POVQEFR'              90  Edt Prod Line A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AJVN    WQ0047 10        User Profile Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVQEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 12=Copy User Profile
      * CASE: RCD.*SFLSEL is Option 12
     C           #1SEL     IFEQ '12'                       *IF
      * Cpy User Profile      PV - User Profile Control  * 
     C                     CALL 'PNVGPVR'              90  Cpy User Profil
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AJVN    WQ0048 10        User Profile Na
     C                     PARM #1AUNA    WQ0049 30        Description
     C                     PARM #1BUVN    WQ0050 10        User Code Model
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNVGPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 13=Edit User Authority
      * CASE: RCD.*SFLSEL is Option 13
     C           #1SEL     IFEQ '13'                       *IF
      * Edt User Authority    EF - User Authority  * 
     C                     CLEARPBRC
     C                     MOVEL#1AJVN    PBAJVN    P      User Profile Na
      *
     C                     CALL 'PNY0EFR'              90  Edt User Author
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: User Autho
     C                     PARM #1AUNA    WQ0051 30        Description
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNY0EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,36
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Perform Delete
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * User profile and any dependent records are deleted
      * CASE: RCD.User Code Model is equal to blank
     C           #1BUVN    IFEQ *BLANK                     *IF
      * RTV fo Delete User/Pro RT - OP Entry Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0004    P      User Profile Na
     C                     EXSR SFRVGN
      * RTV For Delete         RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0005    P      User Profile Na
     C                     EXSR SHRVGN
      * Rtv for Delete        RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0006    P      User Profile Na
     C                     EXSR SJRVGN
      * Delete User Profile Contr - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0007    P      User Profile Na
     C                     EXSR SLDLRC
      * Del User Appl Whs     RT - User Application Whs  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0008    P      User Profile Na
     C                     EXSR SMRVGN
      * Del User Profile      RT - User Prod Line Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0009    P      User Profile Na
     C                     EXSR SORVGN
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV For Delete         RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0005    P      User Profile Na
     C                     EXSR SHRVGN
      * RTV fo Delete User/Pro RT - User Entry Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0004    P      User Profile Na
     C                     EXSR SFRVGN
      * Rtv for Delete        RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0006    P      User Profile Na
     C                     EXSR SJRVGN
      * DLT User Profile Contr DL - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0007    P      User Profile Na
     C                     EXSR SLDLRC
      * Del User Appl Whs     RT - User Application Whs  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0008    P      User Profile Na
     C                     EXSR SMRVGN
      * Del User Profile      RT - User Prod Line Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJVN    WL0009    P      User Profile Na
     C                     EXSR SORVGN
      * CASE: LCL.User Original Entry is equal to blank
     C           YL0002    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv/Chg User Orig Entr RT - PD Order Header      TRG  * 
     C                     EXSR SQRVGN
      * Rtv/Chg User Orig Entr RT - PD Order Detail  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @DRRETH fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELDRB8NA    #1B8NA           System Date For
     C                     MOVELDRAHVN    #1AHVN           Printer Device
     C                     MOVELDRXMST    #1XMST           Credit Hold Aut
     C                     MOVELDRXNST    #1XNST           Production Hold
     C                     MOVELDRI8ST    #1I8ST           Allow Multi War
     C                     Z-ADDDRNLNB    #1NLNB           Entity Number
     C                     MOVELDRMPNA    #1MPNA           Default Printer
     C                     MOVELDRBCCD    #1BCCD           Salesperson Cod
     C                     MOVELDRDQCD    #1DQCD           Enterprise Code
     C                     MOVELDRDRCD    #1DRCD           Enterprise Code
     C                     MOVELDRAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDDRAIC3    #1AIC3           Company Number
     C                     MOVELDRUVST    #1UVST           EDI Status 1
     C                     MOVELDRUWST    #1UWST           EDI Status 2
     C                     MOVELDRUXST    #1UXST           EDI Status 3
     C                     Z-ADDDRAATM    #1AATM           Job Time
     C                     MOVELDRAYNA    #1AYNA           User Id
     C                     MOVELDRA0NA    #1A0NA           Job Name
     C                     Z-ADDDRAXDT    #1AXDT           Job Date
     C                     MOVELDRAJVN    #1AJVN           User Profile Na
     C                     MOVELDRAUNA    #1AUNA           Description
     C                     MOVELDRBUVN    #1BUVN           User Code Model
     C                     MOVELDRI7ST    #1I7ST           Application WHS
     C                     MOVELDRI6ST    #1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #2B8NA           System Date For
     C                     MOVEL*BLANK    #2AHVN           Printer Device
     C                     Z-ADD*ZERO     #2NLNB           Entity Number
     C                     MOVEL*BLANK    #2MPNA           Default Printer
     C                     MOVEL*BLANK    #2BCCD           Salesperson Cod
     C                     Z-ADD*ZERO     #2AIC3           Company Number
     C                     MOVEL*BLANK    #2DQCD           Enterprise Code
     C                     MOVEL*BLANK    #2DRCD           Enterprise Code
     C                     MOVEL*BLANK    #2AJCD           Warehouse Code
     C                     MOVEL*BLANK    #2UVST           EDI Status 1
     C                     MOVEL*BLANK    #2UWST           EDI Status 2
     C                     MOVEL*BLANK    #2UXST           EDI Status 3
     C                     Z-ADD*ZERO     #2AATM           Job Time
     C                     MOVEL*BLANK    #2AYNA           User Id
     C                     MOVEL*BLANK    #2A0NA           Job Name
     C                     Z-ADD*ZERO     #2AXDT           Job Date
     C                     MOVEL*BLANK    #2AJVN           User Profile Na
     C                     MOVEL*BLANK    #2AUNA           Description
     C                     MOVEL*BLANK    #2BUVN           User Code Model
     C                     MOVEL*BLANK    #2I7ST           Application WHS
     C                     MOVEL*BLANK    #2I6ST           Allow Multi-Com
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV by User Prf. Model RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABUVN    WQSA01           User Code Model
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           User Code Model
      * Setup key
     C                     MOVEL#1AJVN    WQSA01           User Code Model
      * Establish starting position
     C           KRSSA     SETLL@DRRESK                    *
     C           KRSSA     READE@DRRESK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,004   W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@DRRESK                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv User Prof Order    RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEAIVN    WQSB02           User Original E
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB02           User Original E
      * Setup key
     C                     MOVEL#1AJVN    WQSB02           User Original E
      * Establish starting position
     C           KRSSB     SETLL@BFCPC8                    *
     C           KRSSB     READE@BFCPC8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0004           Record Found US
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0004           Record Found US
     C                     MOVELBER4CD    YL0003           Sales Route Cod
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@BFCPC8                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv User Prof         RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAJVN    WQSC01           User Profile Na
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           User Profile Na
      * Setup key
     C                     MOVEL#1AJVN    WQSC01           User Profile Na
      * Establish starting position
     C           KRSSC     SETLL@BGWKDE                    *
     C           KRSSC     READE@BGWKDE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0005           Record Found US
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0005           Record Found US
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@BGWKDE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Validate Profile  RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL#1AJVN    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSD     CHAIN@DRRETH              90    *
      * Data record not found
     C   90                MOVEL'USR0763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.User Code Model is equal to blank
     C           DRBUVN    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'User Prfl. not a model'
     C                     MOVEL'USR1700' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Appl O/P           RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    DTAJVN           User Profile Na
     C                     MOVELWL0002    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSE     CHAIN@DTRETE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0767' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,004   W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0003           Company Number
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0003           Company Number
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV fo Delete User/Pro RT - OP Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN C0AJVN    WQSF01           User Profile Na
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           User Profile Na
      * Setup key
     C                     MOVELWL0004    WQSF01           User Profile Na
      * Establish starting position
     C           KRSSF     SETLL@C0REO4                    *
     C           KRSSF     READE@C0REO4                  90*
      * Data record not found
     C   90                MOVEL'USR0527' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) C0DNCD' defaulted for 'Application Code'.
      * Field '(DB1) C0AIC3' defaulted for 'Company Number'.
      * *Delete Order Entry Cntl - OP Entry Control  * 
     C                     EXSR SGDLRC
     C           KRSSF     READE@C0REO4                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * *Delete Order Entry Cntl - OP Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @C0REO3
     C                     MOVELC0AJVN    WBAJVN           User Profile Na
     C                     MOVELC0DNCD    WBDNCD           Application Cod
     C                     Z-ADDC0AIC3    WBAIC3           Company Number
      *
     C           KLDLSG    KLIST
     C                     KFLD           WBAJVN           User Profile Na
     C                     KFLD           WBDNCD           Application Cod
     C                     KFLD           WBAIC3           Company Number
     C           KLDLSG    CHAIN@C0REO3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPC0REL0'MDACP
     C                     MOVEL'@C0REO3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@C0REO3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV For Delete         RT - Application Profile  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  6        Application Cod
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DTAJVN    WQSH01           User Profile Na
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           User Profile Na
      * Setup key
     C                     MOVELWL0005    WQSH01           User Profile Na
     C                     MOVELWN0001    DTDNCD           Application Cod
      * Establish starting position
     C           KPSSH     SETLL@DTRETE                    *
     C           KRSSH     READE@DTRETE                  90*
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Apllication Prof.  DO - Application Profile  * 
     C                     EXSR SIDLRC
     C           KRSSH     READE@DTRETE                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * DLT Apllication Prof.  DO - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data update
      * Setup message data for message
     C                     MOVELDTAJVN    ZA0004           User Profile Na
      * Send message 'Application Profile Model'
     C                     MOVEL'USR1696' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Move key fields to @DTRETF
     C                     MOVELDTAJVN    WCAJVN           User Profile Na
     C                     MOVELDTDNCD    WCDNCD           Application Cod
      *
     C           KLDLSI    KLIST
     C                     KFLD           WCAJVN           User Profile Na
     C                     KFLD           WCDNCD           Application Cod
     C           KLDLSI    CHAIN@DTRETF              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CADTREL0'MDACP
     C                     MOVEL'@DTRETF' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DTRETF                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv for Delete        RT - User Warehouse Access  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN L1AJVN    WQSJ01           User Profile Na
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           User Profile Na
      * Setup key
     C                     MOVELWL0006    WQSJ01           User Profile Na
      * Establish starting position
     C           KRSSJ     SETLL@L1RESJ                    *
     C           KRSSJ     READE@L1RESJ                  90*
      * Data record not found
     C   90                MOVEL'USR2626' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del User Whs Access   DL - User Warehouse Access  * 
     C                     EXSR SKDLRC
     C           KRSSJ     READE@L1RESJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKDLRC    BEGSR
      *================================================================
      * Del User Whs Access   DL - User Warehouse Access  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L1RESI
     C                     MOVELL1AJVN    WDAJVN           User Profile Na
     C                     MOVELL1AJCD    WDAJCD           Warehouse Code
      *
     C           KLDLSK    KLIST
     C                     KFLD           WDAJVN           User Profile Na
     C                     KFLD           WDAJCD           Warehouse Code
     C           KLDLSK    CHAIN@L1RESI              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL1REL0'MDACP
     C                     MOVEL'@L1RESI' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L1RESI                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * Delete User Profile Contr - User Profile Control  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data update
      *  Delete all application profile records for this user
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVELWL0007    ZA0005           User Profile Na
      * Send message 'User Profile-can't delete'
     C                     MOVEL'USR0903' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
      * Move key fields to @DRRETI
     C                     MOVELWL0007    WEAJVN           User Profile Na
      *
     C           KLDLSL    KLIST
     C                     KFLD           WEAJVN           User Profile Na
     C           KLDLSL    CHAIN@DRRETI              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CADRREL0'MDACP
     C                     MOVEL'@DRRETI' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DRRETI                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Del User Appl Whs     RT - User Application Whs  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FOAJVN    WQSM01           User Profile Na
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           User Profile Na
      * Setup key
     C                     MOVELWL0008    WQSM01           User Profile Na
      * Establish starting position
     C           KRSSM     SETLL@FOREDD                    *
     C           KRSSM     READE@FOREDD                  90*
      * Data record not found
     C   90                MOVEL'USR4200' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del User Appl Whs     DL - User Application Whs  * 
     C                     EXSR SNDLRC
     C           KRSSM     READE@FOREDD                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNDLRC    BEGSR
      *================================================================
      * Del User Appl Whs     DL - User Application Whs  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FOREDC
     C                     MOVELFOAJVN    WFAJVN           User Profile Na
     C                     MOVELFODNCD    WFDNCD           Application Cod
     C                     MOVELFOAJCD    WFAJCD           Warehouse Code
      *
     C           KLDLSN    KLIST
     C                     KFLD           WFAJVN           User Profile Na
     C                     KFLD           WFDNCD           Application Cod
     C                     KFLD           WFAJCD           Warehouse Code
     C           KLDLSN    CHAIN@FOREDC              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PNFOREL0'MDACP
     C                     MOVEL'@FOREDC' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FOREDC                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Del User Profile      RT - User Prod Line Access  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CXAJVN    WQSO01           User Profile Na
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           User Profile Na
      * Setup key
     C                     MOVELWL0009    WQSO01           User Profile Na
      * Establish starting position
     C           KRSSO     SETLL@CXREQZ                    *
     C           KRSSO     READE@CXREQZ                  90*
      * Data record not found
     C   90                MOVEL'USR3240' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del User Profile Dft  DL - User Prod Line Access  * 
     C                     EXSR SPDLRC
     C           KRSSO     READE@CXREQZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPDLRC    BEGSR
      *================================================================
      * Del User Profile Dft  DL - User Prod Line Access  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CXREQY
     C                     MOVELCXAJVN    WGAJVN           User Profile Na
     C                     Z-ADDCXAIC3    WGAIC3           Company Number
     C                     MOVELCXR3CD    WGR3CD           Department Code
     C                     MOVELCXEWAA    WGEWAA           Production Line
      *
     C           KLDLSP    KLIST
     C                     KFLD           WGAJVN           User Profile Na
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGR3CD           Department Code
     C                     KFLD           WGEWAA           Production Line
     C           KLDLSP    CHAIN@CXREQY              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POCXREL0'MDACP
     C                     MOVEL'@CXREQY' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CXREQY                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv/Chg User Orig Entr RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEAIVN    WQSQ02           User Original E
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           User Original E
      * Setup key
     C                     MOVEL#1AJVN    WQSQ02           User Original E
      * Establish starting position
     C           KRSSQ     SETLL@BFCPC8                    *
     C           KRSSQ     READE@BFCPC8                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg User Orig Entry    CH - PD Order Header      TRG  * 
     C                     EXSR SRCHRC
     C           KRSSQ     READE@BFCPC8                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg User Orig Entry    CH - PD Order Header      TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0003  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0004  70       Ship To Custome
     C                     MOVEL*BLANK    WN0005 30        Ship To Name
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 30        Ship To Address
     C                     MOVEL*BLANK    WN0009 20        Ship To City
     C                     MOVEL*BLANK    WN0010  2        Ship To State C
     C                     MOVEL*BLANK    WN0011 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0012  70       Bill to Custome
     C                     MOVEL*BLANK    WN0013 30        Bill to Name
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 30        Bill to Address
     C                     MOVEL*BLANK    WN0017 20        Bill to City
     C                     MOVEL*BLANK    WN0018  2        Bill to State C
     C                     MOVEL*BLANK    WN0019 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0020 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0021  70       Order Date
     C                     Z-ADD*ZERO     WN0022  70       Requested Ship
     C                     Z-ADD*ZERO     WN0023  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0024  70       Cancel Date
     C                     MOVEL*BLANK    WN0025  2        Terms Code
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027 40        Special Instruc
     C                     MOVEL*BLANK    WN0028  3        Carrier Code
     C                     MOVEL*BLANK    WN0029  1        Comment Print A
     C                     MOVEL*BLANK    WN0030  1        Comment Print I
     C                     MOVEL*BLANK    WN0031  1        Comment Print P
     C                     MOVEL*BLANK    WN0032  1        Comment Print S
     C                     MOVEL*BLANK    WN0033  3        Reason Code
     C                     MOVEL*BLANK    WN0034  1        Order in Use
     C                     MOVEL*BLANK    WN0035  1        Header Status
     C                     MOVEL*BLANK    WN0036  1        Header Status L
     C                     MOVEL*BLANK    WN0037  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0038  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     Z-ADD*ZERO     WN0040 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0041 112       Order Weight To
     C                     MOVEL*BLANK    WN0042  1        Credit Hold
     C                     MOVEL*BLANK    WN0043  1        Production Hold
     C                     MOVEL*BLANK    WN0044  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0045  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0046  40       Requested Deliv
     C                     MOVEL*BLANK    WN0047  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0048 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0049  70       Load ID
     C                     Z-ADD*ZERO     WN0050  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0051 112       Rated Freight
     C                     MOVEL*BLANK    WN0052  1        LTL Flag
     C                     MOVEL*BLANK    WN0053  1        Price Audit
     C                     MOVEL*BLANK    WN0054  1        Price Status
     C                     MOVEL*BLANK    WN0055  2        Shipping Method
     C                     MOVEL*BLANK    WN0056  1        Export Status
     C                     MOVEL*BLANK    WN0057  1        Palletize
     C                     MOVEL*BLANK    WN0058  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0059  1        Slip Sheet
     C                     MOVEL*BLANK    WN0060  1        Age Code
     C                     Z-ADD*ZERO     WN0061  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0062  1        Load Type
     C                     Z-ADD*ZERO     WN0063  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0064  1        Load Plan Order
     C                     MOVEL*BLANK    WN0065  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0066  70       Resell Referenc
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068 30        Special Comment
     C                     MOVEL*BLANK    WN0069  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0070  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0071  2        Manager Level C
     C                     MOVEL*BLANK    WN0072  3        VP Level Code
     C                     Z-ADD*ZERO     WN0073  70       Attach to Order
     C                     MOVEL*BLANK    WN0074  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0075  70       Invoice Number
     C                     MOVEL*BLANK    WN0076  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0077  70       Invoice Date
     C                     MOVEL*BLANK    WN0078  2        Event Code
     C                     MOVEL*BLANK    WN0079  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0080  1        Modified Flag
     C                     Z-ADD*ZERO     WN0081 112       A/R order Value
     C                     MOVEL*BLANK    WN0082  1        Billing Activit
     C                     MOVEL*BLANK    WN0083  1        Block Order Fla
     C                     MOVEL*BLANK    WN0084  1        Order Certifica
     C                     Z-ADD*ZERO     WN0085 112       Invoice Order V
     C                     MOVEL*BLANK    WN0086  1        Process Sts for
     C                     MOVEL*BLANK    WN0087  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0088  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0089  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0090  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0091  1        Email Cust On O
     C                     MOVEL*BLANK    WN0092  1        Order Emailed
     C                     MOVEL*BLANK    WN0093  1        Export Docs Go
     C                     MOVEL*BLANK    WN0094  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0095  1        Broker Order St
     C                     MOVEL*BLANK    WN0096  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0097  2        Signal Demand S
     C                     MOVEL*BLANK    WN0098  2        EDI Nistevo Sel
     C                     MOVEL*BLANK    WN0099  2        Export USDA App
     C                     MOVEL*BLANK    WN0100  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0101  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0102  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0103  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0104  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0105  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0106  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0107  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0108  60       Time of Origina
     C                     Z-ADD*ZERO     WN0109  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0110  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0111  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0112 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0113 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0114 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0115 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0116 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0117  70       Claim Number
     C                     MOVEL*BLANK    WN0118  1        EDI Status 1
     C                     MOVEL*BLANK    WN0119  1        EDI Status 2
     C                     MOVEL*BLANK    WN0120  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0121  60       Job Time
     C                     MOVEL*BLANK    WN0122 10        User Id
     C                     MOVEL*BLANK    WN0123 10        Job Name
     C                     Z-ADD*ZERO     WN0124  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDBEAIC3    WHAIC3           Company Number
     C                     Z-ADDBEC4NB    WHC4NB           Order Number
      *
     C           KLCHSR    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C           KLCHSR    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELYL0002    WHAIVN    P      User Original E
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWHAIC3    PCAIC3           Company Number
     C                     Z-ADDWHC4NB    PCC4NB           Order Number
     C                     MOVELWHJNCD    PCJNCD    P      Order Type - Sa
     C                     Z-ADDWHANC7    PCANC7           A/R Customer Nu
     C                     Z-ADDWHBKC7    PCBKC7           Ship To Custome
     C                     MOVELWHBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWHHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWHHONA    PCHONA    P      Ship To Address
     C                     MOVELWHHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWHHNNA    PCHNNA    P      Ship To City
     C                     MOVELWHDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWHCKTX    PCCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWHB0C7    PCB0C7           Bill to Custome
     C                     MOVELWHAETX    PCAETX    P      Bill to Name
     C                     MOVELWHB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWHB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWHB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWHB2NA    PCB2NA    P      Bill to City
     C                     MOVELWHBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWHC8TX    PCC8TX    P      Bill to Zip/Pos
     C                     MOVELWHBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWHA0DT    PCA0DT           Order Date
     C                     Z-ADDWHA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWHGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWHACDT    PCACDT           Cancel Date
     C                     MOVELWHAQCD    PCAQCD    P      Terms Code
     C                     MOVELWHB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWHBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWHBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWHGTST    PCGTST    P      Comment Print A
     C                     MOVELWHGVST    PCGVST    P      Comment Print I
     C                     MOVELWHGUST    PCGUST    P      Comment Print P
     C                     MOVELWHQFST    PCQFST    P      Comment Print S
     C                     MOVELWHCQCD    PCCQCD    P      Reason Code
     C                     MOVELWHGJST    PCGJST    P      Order in Use
     C                     MOVELWHGWST    PCGWST    P      Header Status
     C                     MOVELWHGXST    PCGXST    P      Header Status L
     C                     MOVELWHGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWHAODT    PCAODT           Scheduled Ship
     C                     MOVELWHAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWHCXDT    PCCXDT           Date of Origina
     C                     Z-ADDWHJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWHA1WG    PCA1WG           Order Weight To
     C                     MOVELWHXIST    PCXIST    P      Credit Hold
     C                     MOVELWHXJST    PCXJST    P      Production Hold
     C                     MOVELWHXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWHEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWHAFTM    PCAFTM           Requested Deliv
     C                     MOVELWHE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWHE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWHRMNB    PCRMNB           Load ID
     C                     Z-ADDWHTBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWHR1NB    PCR1NB           Rated Freight
     C                     MOVELWHPJST    PCPJST    P      LTL Flag
     C                     MOVELWHU0ST    PCU0ST    P      Price Audit
     C                     MOVELWHU1ST    PCU1ST    P      Price Status
     C                     MOVELWHQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWHU2ST    PCU2ST    P      Export Status
     C                     MOVELWHVEST    PCVEST    P      Palletize
     C                     MOVELWHVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWHVGST    PCVGST    P      Slip Sheet
     C                     MOVELWHRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWHRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWHVDST    PCVDST    P      Load Type
     C                     Z-ADDWHATIN    PCATIN           Attach to Invoi
     C                     MOVELWHU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWHU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWHRSRN    PCRSRN           Resell Referenc
     C                     MOVELWHMHNA    PCMHNA    P      Special Comment
     C                     MOVELWHMINA    PCMINA    P      Special Comment
     C                     MOVELWHWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWHR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWHBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWHQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWHT3NB    PCT3NB           Attach to Order
     C                     MOVELWHSICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWHCONB    PCCONB           Invoice Number
     C                     MOVELWHCEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWHAWDT    PCAWDT           Invoice Date
     C                     MOVELWHJPCD    PCJPCD    P      Event Code
     C                     MOVELWHXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWHZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWHVRVA    PCVRVA           A/R order Value
     C                     MOVELWHOBST    PCOBST    P      Billing Activit
     C                     MOVELWHBCST    PCBCST    P      Block Order Fla
     C                     MOVELWHBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWHB7VL    PCB7VL           Invoice Order V
     C                     MOVELWHGASX    PCGASX    P      Process Sts for
     C                     MOVELWHGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWHGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWHGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWHFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWHFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWHFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWHFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWHFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWHFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWHFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWHFUSX    PCFUSX    P      Signal Demand S
     C                     MOVELWHFVSX    PCFVSX    P      EDI Nistevo Sel
     C                     MOVELWHFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWHFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWHFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWHNODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWHNPDT    PCNPDT           OH Unused Date
     C                     Z-ADDWHNQDT    PCNQDT           OH Unused Date
     C                     Z-ADDWHNRDT    PCNRDT           OH Unused Date
     C                     Z-ADDWHNSDT    PCNSDT           OH Unused Date
     C                     Z-ADDWHBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWHBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWHBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWHBSTM    PCBSTM           OH Unused Time
     C                     Z-ADDWHBTTM    PCBTTM           OH Unused Time
     C                     Z-ADDWHH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWHH1NX    PCH1NX           Act Non-Ref Frt
     C                     Z-ADDWHH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWHH3NX    PCH3NX           OH Total Non-Re
     C                     Z-ADDWHH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWHC0C7    PCC0C7           Claim Number
     C                     MOVELWHUVST    PCUVST    P      EDI Status 1
     C                     MOVELWHUWST    PCUWST    P      EDI Status 2
     C                     MOVELWHUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWHAATM    PCAATM           Job Time
     C                     MOVELWHAYNA    PCAYNA    P      User Id
     C                     MOVELWHA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWHAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv/Chg User Orig Entr RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAJVN    WQSS01           User Profile Na
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           User Profile Na
      * Setup key
     C                     MOVEL#1AJVN    WQSS01           User Profile Na
      * Establish starting position
     C           KRSSS     SETLL@BGWKDE                    *
     C           KRSSS     READE@BGWKDE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg User Profile       CH - PD Order Detail  * 
     C                     EXSR STCHRC
     C           KRSSS     READE@BGWKDE                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg User Profile       CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0125  70       Item Code
     C                     MOVEL*BLANK    WN0126  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0127  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0128  70       Order Group Cod
     C                     MOVEL*BLANK    WN0129  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0130  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0131 112       Billing Detail
     C                     Z-ADD*ZERO     WN0132 112       Billing Detail
     C                     Z-ADD*ZERO     WN0133 112       Billing Detail
     C                     Z-ADD*ZERO     WN0134 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0135  1        Comment Print A
     C                     MOVEL*BLANK    WN0136  1        Comment Print I
     C                     MOVEL*BLANK    WN0137  1        Comment Print P
     C                     MOVEL*BLANK    WN0138  1        Comment Print S
     C                     Z-ADD*ZERO     WN0139 112       Extended Amount
     C                     Z-ADD*ZERO     WN0140  70       Market Pricing
     C                     MOVEL*BLANK    WN0141  3        Commodity Marke
     C                     MOVEL*BLANK    WN0142  3        Date Method Cod
     C                     MOVEL*BLANK    WN0143  3        Price Method Co
     C                     Z-ADD*ZERO     WN0144 114       Price Overage O
     C                     Z-ADD*ZERO     WN0145  70       Contract Number
     C                     MOVEL*BLANK    WN0146  1        Price Status
     C                     Z-ADD*ZERO     WN0147  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0148  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0149  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0150  1        Work Confirm St
     C                     MOVEL*BLANK    WN0151  1        Work Over/Short
     C                     MOVEL*BLANK    WN0152  1        OD Production P
     C                     MOVEL*BLANK    WN0153 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0154 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0155  1        Age Code
     C                     MOVEL*BLANK    WN0156  1        Palletize
     C                     MOVEL*BLANK    WN0157  1        Slip Sheet
     C                     MOVEL*BLANK    WN0158  1        Catch Weight St
     C                     MOVEL*BLANK    WN0159  1        Price Audit
     C                     MOVEL*BLANK    WN0160  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0161  1        Production Date
     C                     Z-ADD*ZERO     WN0162 112       Rated Freight
     C                     Z-ADD*ZERO     WN0163 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0164 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0165 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0166 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0167 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0168 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0169 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0170 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0171 114       Unit Price
     C                     Z-ADD*ZERO     WN0172 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0173 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0174 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0175 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0176  70       Requested Ship
     C                     Z-ADD*ZERO     WN0177  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0178  70       Actual Shipped
     C                     MOVEL*BLANK    WN0179  1        Affect Inventor
     C                     MOVEL*BLANK    WN0180  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0181  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0182  30       Item Structure
     C                     Z-ADD*ZERO     WN0183  30       Item Structure
     C                     Z-ADD*ZERO     WN0184  30       Item Structure
     C                     MOVEL*BLANK    WN0185  2        Item Level
     C                     MOVEL*BLANK    WN0186  2        Quality Level
     C                     MOVEL*BLANK    WN0187  2        Pricing Product
     C                     MOVEL*BLANK    WN0188  2        Season Product
     C                     Z-ADD*ZERO     WN0189  70       Date of Origina
     C                     MOVEL*BLANK    WN0190  6        Country Code
     C                     MOVEL*BLANK    WN0191  2        Event Code
     C                     MOVEL*BLANK    WN0192  3        Reason Code
     C                     MOVEL*BLANK    WN0193  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0194  1        Modified Flag
     C                     MOVEL*BLANK    WN0195  1        Substituted Fla
     C                     MOVEL*BLANK    WN0196  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0197 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0198 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0199  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0200  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0201  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0202  1        Affect Commissi
     C                     MOVEL*BLANK    WN0203  1        Affect Pricing
     C                     MOVEL*BLANK    WN0204  1        Released by Use
     C                     MOVEL*BLANK    WN0205  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0206  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0207  3        Production Ware
     C                     MOVEL*BLANK    WN0208  3        OD Price Type
     C                     Z-ADD*ZERO     WN0209  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0210  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0211  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0212  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0213  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0214  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0215  60       Price Code
     C                     Z-ADD*ZERO     WN0216  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0217  60       Substitution Li
     C                     Z-ADD*ZERO     WN0218  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0219 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0220 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0221 112       OD Item Target
     C                     Z-ADD*ZERO     WN0222 112       OD Minimum Unit
     C                     Z-ADD*ZERO     WN0223 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0224 114       Order Gate Pric
     C                     Z-ADD*ZERO     WN0225 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0226 114       OD Unused Prc 3
     C                     Z-ADD*ZERO     WN0227 114       OD Unused Prc 4
     C                     Z-ADD*ZERO     WN0228 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0229 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0230 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0231 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0232  1        OD UnUsed Price
     C                     MOVEL*BLANK    WN0233  1        OD UnUsed Price
     C                     MOVEL*BLANK    WN0234  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0235 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0236  40       Item Age Days
     C                     Z-ADD*ZERO     WN0237  70       Production Ovr
     C                     Z-ADD*ZERO     WN0238  70       Production Ovr
     C                     MOVEL*BLANK    WN0239  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0240  2        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0241  3        OD UnUsed Statu
     C                     Z-ADD*ZERO     WN0242  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0243  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0244  70       OD UnUsed Date
     C                     MOVEL*BLANK    WN0245  1        EDI Status 1
     C                     MOVEL*BLANK    WN0246  1        EDI Status 2
     C                     MOVEL*BLANK    WN0247  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0248  60       Job Time
     C                     MOVEL*BLANK    WN0249 10        User Id
     C                     MOVEL*BLANK    WN0250 10        Job Name
     C                     Z-ADD*ZERO     WN0251  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WIAIC3           Company Number
     C                     Z-ADDOMC4NB    WIC4NB           Order Number
     C                     Z-ADDOMDPNB    WIDPNB           Order Sequence
     C                     Z-ADDOMUENB    WIUENB           Order Secondary
      *
     C           KLCHST    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C           KLCHST    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELYL0002    WIAJVN    P      User Profile Na
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSU01           Application Cod
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSU01           Application Cod
     C                     MOVEL'C/S'     WQSU01           Application Cod
      * Establish starting position
     C           KRSSU     SETLL@DNRESF                    *
     C           KRSSU     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
     C           KRSSU     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSV01           Application Cod
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSV01           Application Cod
      * Establish starting position
     C           KRSSV     SETLL@DNRESF                    *
     C           KRSSV     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL@CN,004   W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSV     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD10        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ061
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2I7ST'  YPMTFD           Application WHS
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ066
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2I6ST'  YPMTFD           Allow Multi-Com
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              92    *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P1WSST           PRT Hold Output
     C                     MOVEL*BLANK    P1WTST           PRT Save Output
     C                     Z-ADD*ZERO     P1DYNB           PRT Number of C
     C                     MOVEL*BLANK    P1WUST           PRT Night Queue
     C                     MOVEL*BLANK    P1BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     Z-ADD*ZERO     P3AIC3           Company Number
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WANLNB           Entity Number
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field BLANK 1               USR
     C                     MOVEL*BLANK    WUJ1TX 25
      * Define work field Sales Route Code Ref  USR
     C                     MOVEL*BLANK    WUYGCD  3
      * Define work field User Profile Name
     C                     MOVEL*BLANK    WUAJVN 10
      * Define work field Application Code
     C                     MOVEL*BLANK    WUDNCD  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBNANB           Requested Date
     C                     Z-ADD*ZERO     WBNBNB           Ship Date Days
     C                     Z-ADD*ZERO     WBNCNB           Invoice Date Da
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WHA0DT           Order Date
     C                     Z-ADD*ZERO     WHA5DT           Requested Ship
     C                     Z-ADD*ZERO     WHGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WHACDT           Cancel Date
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHCXDT           Date of Origina
     C                     Z-ADD*ZERO     WHJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WHA1WG           Order Weight To
     C                     Z-ADD*ZERO     WHEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WHAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WHATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WHRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WHT3NB           Attach to Order
     C                     Z-ADD*ZERO     WHCONB           Invoice Number
     C                     Z-ADD*ZERO     WHAWDT           Invoice Date
     C                     Z-ADD*ZERO     WHVRVA           A/R order Value
     C                     Z-ADD*ZERO     WHB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WHNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WHNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WHNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WHNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WHNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WHBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WHBQTM           Time of Origina
     C                     Z-ADD*ZERO     WHBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WHBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WHBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WHH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WHH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WHH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WHH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WHH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WHC0C7           Claim Number
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WICFC7           Order Group Cod
     C                     Z-ADD*ZERO     WIMAVA           Billing Detail
     C                     Z-ADD*ZERO     WIKDVA           Billing Detail
     C                     Z-ADD*ZERO     WIL8VA           Billing Detail
     C                     Z-ADD*ZERO     WIL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WIAYVA           Extended Amount
     C                     Z-ADD*ZERO     WIEXDT           Market Pricing
     C                     Z-ADD*ZERO     WIBZPR           Price Overage O
     C                     Z-ADD*ZERO     WIL6NB           Contract Number
     C                     Z-ADD*ZERO     WIGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WIAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WID0WG           Weight Ordered
     C                     Z-ADD*ZERO     WICCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WIAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WICBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WIATWG           Weight Shipped
     C                     Z-ADD*ZERO     WIAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WIAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WIAKPR           Unit Price
     C                     Z-ADD*ZERO     WIALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WIAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WIAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WIA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WIA5DT           Requested Ship
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WIGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WICXDT           Date of Origina
     C                     Z-ADD*ZERO     WIDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WIB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WIA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WINTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WINUDT           Consumed Item C
     C                     Z-ADD*ZERO     WINVDT           Deadline Depart
     C                     Z-ADD*ZERO     WINWDT           OD Price Type R
     C                     Z-ADD*ZERO     WINXDT           OD Unused Date
     C                     Z-ADD*ZERO     WIBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WIBVTM           Price Code
     C                     Z-ADD*ZERO     WIBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WIBXTM           Substitution Li
     C                     Z-ADD*ZERO     WIBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WIH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WIH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WIH7NX           OD Item Target
     C                     Z-ADD*ZERO     WIH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WIH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WIDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WIDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WIDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WIDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WIDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WIGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WIGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WIGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WIPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WIRINY           Item Age Days
     C                     Z-ADD*ZERO     WITIDT           Production Ovr
     C                     Z-ADD*ZERO     WITJDT           Production Ovr
     C                     Z-ADD*ZERO     WITKDT           OD Market Begin
     C                     Z-ADD*ZERO     WITLDT           OD Market Endin
     C                     Z-ADD*ZERO     WITMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0004 10
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0005 10
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0006 10
      * Define local variables for subroutine SLDLRC.
     C                     MOVEL*BLANK    WL0007 10
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0008 10
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0009 10
      * Define local work field USR Status (Y/N)
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field User Original Entry
     C                     MOVEL*BLANK    YL0002 10
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Record Found -OrdDtlUSR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Sales Route Code Ref  USR
     C                     MOVEL*BLANK    YL0006  3
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD12        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SURVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'N'       P1WUST           PRT Night Queue
     C                     MOVEL*BLANK    P1WRST           PRT Printer Dev
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PDZVPCLP
00002 User Profile Listing
00003 PPD2PCLP
00004 Y2U0005
00005 Y2U9999
