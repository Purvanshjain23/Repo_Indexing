     H/TITLE Prc Manifest Report   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 08/23/05  Time  : 16:29:24
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : Application Profile       Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPPACCPP IF  E                    DISK         KRECNO Y01RRN
      * PHY : AS Manifest Report        Physical file
      *
     FPPADCPL3IF  E           K        DISK
      * RSQ : Order Manifest            Co/Ord/Itm/Case/Seq(d)
      *
     FPOB2CPLFIF  E           K        DISK
      * RSQ : Product Trace             Co/Srl#/LDte
      *
     FPPAAREL3IF  E           K        DISK
      * RSQ : Product Trace Line Scale  Co/ScaleID/Dte(d)
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPPADCPL0IF  E           K        DISK                      A
      * UPD : Order Manifest            Update index
      *
     FPOB2CPL0UF  E           K        DISK                      A
      * UPD : Product Trace             Update index
      *
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1   2  6   @CN    25
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WAAJVN
     I              DRAUNA                          WAAUNA
     I              DRB8NA                          WAB8NA
     I              DRAHVN                          WAAHVN
     I              DRI6ST                          WAI6ST
     I              DRI7ST                          WAI7ST
     I              DRXMST                          WAXMST
     I              DRXNST                          WAXNST
     I              DRI8ST                          WAI8ST
     I              DRNLNB                          WANLNB
     I              DRMPNA                          WAMPNA
     I              DRBCCD                          WABCCD
     I              DRAIC3                          WAAIC3
     I              DRDQCD                          WADQCD
     I              DRDRCD                          WADRCD
     I              DRAJCD                          WAAJCD
     I              DRBUVN                          WABUVN
     I              DRUVST                          WAUVST
     I              DRUWST                          WAUWST
     I              DRUXST                          WAUXST
     I              DRAATM                          WAAATM
     I              DRAYNA                          WAAYNA
     I              DRA0NA                          WAA0NA
     I              DRAXDT                          WAAXDT
      *
     I@DTRETE
      * Application Profile       Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WBAJVN
     I              DTDNCD                          WBDNCD
     I              DTAIC3                          WBAIC3
     I              DTDQCD                          WBDQCD
     I              DTDRCD                          WBDRCD
     I              DTAJCD                          WBAJCD
     I              DTJFST                          WBJFST
     I              DTUVST                          WBUVST
     I              DTUWST                          WBUWST
     I              DTUXST                          WBUXST
     I              DTAATM                          WBAATM
     I              DTAYNA                          WBAYNA
     I              DTA0NA                          WBA0NA
     I              DTAXDT                          WBAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WCAIC3
     I              ABADTX                          WCADTX
     I              ABACNA                          WCACNA
     I              ABADNA                          WCADNA
     I              ABAENA                          WCAENA
     I              ABAJNA                          WCAJNA
     I              ABBTTX                          WCBTTX
     I              ABBVTX                          WCBVTX
     I              ABBWTX                          WCBWTX
     I              ABA2NA                          WCA2NA
     I              ABABTX                          WCABTX
     I              ABBGCD                          WCBGCD
     I              ABKXCD                          WCKXCD
     I              ABUVST                          WCUVST
     I              ABUWST                          WCUWST
     I              ABUXST                          WCUXST
     I              ABVSST                          WCVSST
     I              ABAATM                          WCAATM
     I              ABAYNA                          WCAYNA
     I              ABA0NA                          WCA0NA
     I              ABAXDT                          WCAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WDDNCD
     I              DNAUNA                          WDAUNA
     I              DNVKST                          WDVKST
     I              DNRSCD                          WDRSCD
     I              DNUVST                          WDUVST
     I              DNUWST                          WDUWST
     I              DNUXST                          WDUXST
     I              DNAATM                          WDAATM
     I              DNAYNA                          WDAYNA
     I              DNA0NA                          WDA0NA
     I              DNAXDT                          WDAXDT
      *
     I@ADCPT6
      * Order Manifest            Co/Ord/Itm/Case/Seq(d)
      * Renamed input format fields
     I              ADAIC3                          WFAIC3
     I              ADC4NB                          WFC4NB
     I              ADHGCD                          WFHGCD
     I              ADUZNX                          WFUZNX
     I              ADDXNB                          WFDXNB
     I              ADPVDT                          WFPVDT
     I              ADKZWG                          WFKZWG
     I              ADRASX                          WFRASX
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     I@ADCPTW
      * Order Manifest            Update index
      * Renamed input format fields
     I              ADAIC3                          WGAIC3
     I              ADC4NB                          WGC4NB
     I              ADHGCD                          WGHGCD
     I              ADUZNX                          WGUZNX
     I              ADDXNB                          WGDXNB
     I              ADPVDT                          WGPVDT
     I              ADKZWG                          WGKZWG
     I              ADRASX                          WGRASX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     I@B2CPT3
      * Product Trace             Co/Srl#/LDte
      * Renamed input format fields
     I              B2AIC3                          WHAIC3
     I              B2PFNX                          WHPFNX
     I              B2AADX                          WHAADX
     I              B2B9TM                          WHB9TM
     I              B2ADDX                          WHADDX
     I              B2ABDX                          WHABDX
     I              B2CATM                          WHCATM
     I              B2MNSX                          WHMNSX
     I              B2JOWG                          WHJOWG
     I              B2JPWG                          WHJPWG
     I              B2MOSX                          WHMOSX
     I              B2DNAA                          WHDNAA
     I              B2PGNX                          WHPGNX
     I              B2BTT1                          WHBTT1
     I              B2D7C7                          WHD7C7
     I              B2PYNA                          WHPYNA
     I              B2PZNA                          WHPZNA
     I              B2MPSX                          WHMPSX
     I              B2CCT1                          WHCCT1
     I              B2PHNX                          WHPHNX
     I              B2MQSX                          WHMQSX
     I              B2DOAA                          WHDOAA
     I              B2BUT1                          WHBUT1
     I              B2DYAA                          WHDYAA
     I              B2BVT1                          WHBVT1
     I              B2DPAA                          WHDPAA
     I              B2DQAA                          WHDQAA
     I              B2BZT1                          WHBZT1
     I              B2BWT1                          WHBWT1
     I              B2DRAA                          WHDRAA
     I              B2B9T1                          WHB9T1
     I              B2DSAA                          WHDSAA
     I              B2B8T1                          WHB8T1
     I              B2D4AA                          WHD4AA
     I              B2EPAA                          WHEPAA
     I              B2EQAA                          WHEQAA
     I              B2ERAA                          WHERAA
     I              B2ESAA                          WHESAA
     I              B2PNSX                          WHPNSX
     I              B2UFNX                          WHUFNX
     I              B2UGNX                          WHUGNX
     I              B2UHNX                          WHUHNX
     I              B2AGDX                          WHAGDX
     I              B2CGTM                          WHCGTM
     I              B2POSX                          WHPOSX
     I              B2PPSX                          WHPPSX
     I              B2UINX                          WHUINX
     I              B2UJNX                          WHUJNX
     I              B2UKNX                          WHUKNX
     I              B2ULNX                          WHULNX
     I              B2PRSX                          WHPRSX
     I              B2PSSX                          WHPSSX
     I              B2AATM                          WHAATM
     I              B2AYNA                          WHAYNA
     I              B2A0NA                          WHA0NA
     I              B2AXDT                          WHAXDT
      *
     I@AARETD
      * Product Trace Line Scale  Co/ScaleID/Dte(d)
      * Renamed input format fields
     I              AAAIC3                          WIAIC3
     I              AAFAAA                          WIFAAA
     I              AAPUDT                          WIPUDT
     I              AAUXNX                          WIUXNX
     I              AAUVST                          WIUVST
     I              AAUWST                          WIUWST
     I              AAUXST                          WIUXST
     I              AAVSST                          WIVSST
     I              AAAATM                          WIAATM
     I              AAAYNA                          WIAYNA
     I              AAA0NA                          WIA0NA
     I              AAAXDT                          WIAXDT
      *
     I@B2CPMP
      * Product Trace             Update index
      * Renamed input format fields
     I              B2AIC3                          WJAIC3
     I              B2PFNX                          WJPFNX
     I              B2AADX                          WJAADX
     I              B2B9TM                          WJB9TM
     I              B2ADDX                          WJADDX
     I              B2ABDX                          WJABDX
     I              B2CATM                          WJCATM
     I              B2MNSX                          WJMNSX
     I              B2JOWG                          WJJOWG
     I              B2JPWG                          WJJPWG
     I              B2MOSX                          WJMOSX
     I              B2DNAA                          WJDNAA
     I              B2PGNX                          WJPGNX
     I              B2BTT1                          WJBTT1
     I              B2D7C7                          WJD7C7
     I              B2PYNA                          WJPYNA
     I              B2PZNA                          WJPZNA
     I              B2MPSX                          WJMPSX
     I              B2CCT1                          WJCCT1
     I              B2PHNX                          WJPHNX
     I              B2MQSX                          WJMQSX
     I              B2DOAA                          WJDOAA
     I              B2BUT1                          WJBUT1
     I              B2DYAA                          WJDYAA
     I              B2BVT1                          WJBVT1
     I              B2DPAA                          WJDPAA
     I              B2DQAA                          WJDQAA
     I              B2BZT1                          WJBZT1
     I              B2BWT1                          WJBWT1
     I              B2DRAA                          WJDRAA
     I              B2B9T1                          WJB9T1
     I              B2DSAA                          WJDSAA
     I              B2B8T1                          WJB8T1
     I              B2D4AA                          WJD4AA
     I              B2EPAA                          WJEPAA
     I              B2EQAA                          WJEQAA
     I              B2ERAA                          WJERAA
     I              B2ESAA                          WJESAA
     I              B2PNSX                          WJPNSX
     I              B2UFNX                          WJUFNX
     I              B2UGNX                          WJUGNX
     I              B2UHNX                          WJUHNX
     I              B2AGDX                          WJAGDX
     I              B2CGTM                          WJCGTM
     I              B2POSX                          WJPOSX
     I              B2PPSX                          WJPPSX
     I              B2UINX                          WJUINX
     I              B2UJNX                          WJUJNX
     I              B2UKNX                          WJUKNX
     I              B2ULNX                          WJULNX
     I              B2PRSX                          WJPRSX
     I              B2PSSX                          WJPSSX
     I              B2AATM                          WJAATM
     I              B2AYNA                          WJAYNA
     I              B2A0NA                          WJA0NA
     I              B2AXDT                          WJAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WKAIC3
     I              KMV8CD                          WKV8CD
     I              KMAUNA                          WKAUNA
     I              KMI5ST                          WKI5ST
     I              KMBXTX                          WKBXTX
     I              KMM8NB                          WKM8NB
     I              KMUVST                          WKUVST
     I              KMUWST                          WKUWST
     I              KMUXST                          WKUXST
     I              KMVSST                          WKVSST
     I              KMAATM                          WKAATM
     I              KMAYNA                          WKAYNA
     I              KMA0NA                          WKA0NA
     I              KMAXDT                          WKAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPPAD1    E DSPPADCPL0
      * UPD : Order Manifest            Update index
      * Renamed input format fields
     I              ADAIC3                          WGAIC3
     I              ADC4NB                          WGC4NB
     I              ADHGCD                          WGHGCD
     I              ADUZNX                          WGUZNX
     I              ADDXNB                          WGDXNB
     I              ADPVDT                          WGPVDT
     I              ADKZWG                          WGKZWG
     I              ADRASX                          WGRASX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     IQPOB21    E DSPOB2CPL0
      * UPD : Product Trace             Update index
      * Renamed input format fields
     I              B2AIC3                          WJAIC3
     I              B2PFNX                          WJPFNX
     I              B2AADX                          WJAADX
     I              B2B9TM                          WJB9TM
     I              B2ADDX                          WJADDX
     I              B2ABDX                          WJABDX
     I              B2CATM                          WJCATM
     I              B2MNSX                          WJMNSX
     I              B2JOWG                          WJJOWG
     I              B2JPWG                          WJJPWG
     I              B2MOSX                          WJMOSX
     I              B2DNAA                          WJDNAA
     I              B2PGNX                          WJPGNX
     I              B2BTT1                          WJBTT1
     I              B2D7C7                          WJD7C7
     I              B2PYNA                          WJPYNA
     I              B2PZNA                          WJPZNA
     I              B2MPSX                          WJMPSX
     I              B2CCT1                          WJCCT1
     I              B2PHNX                          WJPHNX
     I              B2MQSX                          WJMQSX
     I              B2DOAA                          WJDOAA
     I              B2BUT1                          WJBUT1
     I              B2DYAA                          WJDYAA
     I              B2BVT1                          WJBVT1
     I              B2DPAA                          WJDPAA
     I              B2DQAA                          WJDQAA
     I              B2BZT1                          WJBZT1
     I              B2BWT1                          WJBWT1
     I              B2DRAA                          WJDRAA
     I              B2B9T1                          WJB9T1
     I              B2DSAA                          WJDSAA
     I              B2B8T1                          WJB8T1
     I              B2D4AA                          WJD4AA
     I              B2EPAA                          WJEPAA
     I              B2EQAA                          WJEQAA
     I              B2ERAA                          WJERAA
     I              B2ESAA                          WJESAA
     I              B2PNSX                          WJPNSX
     I              B2UFNX                          WJUFNX
     I              B2UGNX                          WJUGNX
     I              B2UHNX                          WJUHNX
     I              B2AGDX                          WJAGDX
     I              B2CGTM                          WJCGTM
     I              B2POSX                          WJPOSX
     I              B2PPSX                          WJPPSX
     I              B2UINX                          WJUINX
     I              B2UJNX                          WJUJNX
     I              B2UKNX                          WJUKNX
     I              B2ULNX                          WJULNX
     I              B2PRSX                          WJPRSX
     I              B2PSSX                          WJPSSX
     I              B2AATM                          WJAATM
     I              B2AYNA                          WJAYNA
     I              B2A0NA                          WJA0NA
     I              B2AXDT                          WJAXDT
      *
     IYARDCS      DS                            434
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                             20
      * KEY : Order Manifest            Co/Ord/Itm/LDte/S#
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Order Number
     I                                    P   3   60PAC4NB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Application Code
     I                                        6  11 P1DNCD
      * N :  Enterprise Code 1
     I                                       12  15 P1DQCD
      * N :  Enterprise Code 2
     I                                       16  27 P1DRCD
      * N :  Salesperson Code
     I                                       28  30 P1BCCD
      * N :  System Date Format
     I                                       31  33 P1B8NA
      * N :  User Profile Name
     I                                       34  43 P1AJVN
      * N :  Allow Multi-Company
     I                                       44  44 P1I6ST
      * N :  Allow Multi Warehouse
     I                                       45  45 P1I8ST
      * N :  Default Printer
     I                                       46  55 P1MPNA
      * N :  First Time Flag
     I                                       56  56 P1TAST
      * N :  Name
     I                                       57  86 P1ADTX
      * N :  System Value Alpha
     I                                       87 126 P1BXTX
      * N :  Access Denied (Y/N)
     I                                      127 127 P1WVST
      * N :  Requested Delivery Date
     I                                    P 128 1310P1EIDT
      * N :  *Initial call
     I                                      132 132 P1ICL
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Chg User Data'
      * Program Name$ USR
     I                                        1  10 ZA0001
      * Order Alpha
     I                                       11  17 ZA0002
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Manifest Report   XF
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Int. Acc EXTNL IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Appl EXTERNAL IF
      * RTV Program Setup      RT - User Profile Control  * 
     C                     EXSR SARVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * Retrieve Appl. Profile - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0001    P      User Profile Na
     C                     MOVEL'OMS'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    P1AJCD    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0001    P      User Profile Na
     C                     MOVEL'OMS'     WL0002    P      Application Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    P1AJCD    P      Warehouse Code
     C                     END                             *FI
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     Z-ADDWUAIC3    P1AIC3           Company Number
     C                     MOVELWUWVST    P1WVST           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
      * RTV Screen Heading     RT
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SDRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Text String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C                     MOVE 'N'       FLAG    1        FLAG
     C           UX        DOWGT0
     C           FLAG      ANDEQ'N'
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     MOVE 'Y'       FLAG
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
      *** ADDED FOR HPE, THERE HEADER FOOTER IS OFF   MEA 042494
     C                     SUB  1         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
     C                     MOVELWUDE40    P1BXTX           System Value Al
      * Prc Manifest Report   RT - AS Manifest Report  * 
     C                     EXSR SFRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Program Setup      RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    WAAJVN           User Profile Na
      * Establish starting position
     C           KRSSA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELWAMPNA    P1MPNA           Default Printer
     C                     MOVELWABCCD    P1BCCD           Salesperson Cod
     C                     MOVELWABUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Retrieve Appl. Profile - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJVN           User Profile Na
     C                     KFLD           WBDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    WBAJVN           User Profile Na
     C                     MOVELWL0002    WBDNCD           Application Cod
      * Establish starting position
     C           KRSSB     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAIC3    WL0003           Company Number
     C                     MOVELWBAJCD    WL0004           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    WCAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P1ADTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCADTX    P1ADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDDNCD    WQSD01           Application Cod
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSD01           Application Cod
     C                     MOVEL'OMS'     WQSD01           Application Cod
      * Establish starting position
     C           KRSSD     SETLL@DNRESF                    *
     C           KRSSD     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WDRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWDAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C           KRSSD     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDDNCD    WQSE01           Application Cod
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Application Cod
      * Setup key
     C                     MOVELWDRSCD    WQSE01           Application Cod
      * Establish starting position
     C           KRSSE     SETLL@DNRESF                    *
     C           KRSSE     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAUNA    WUAUNA           Description
     C           KRSSE     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Prc Manifest Report   RT - AS Manifest Report  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       Order Number
     C                     Z-ADD*ZERO     WN0004  70       Item Code
     C                     Z-ADD*ZERO     WN0005  80       Case Serial Num
     C                     Z-ADD*ZERO     WN0006  80       Case Label date
     C                     Z-ADD*ZERO     WN0007  71       Case Net Weight
     C                     MOVEL*BLANK    WN0008  1        Process Status
     C                     MOVEL*BLANK    WN0009  1        EDI Status 1
     C                     MOVEL*BLANK    WN0010  1        EDI Status 2
     C                     MOVEL*BLANK    WN0011  1        EDI Status 3
     C                     MOVEL*BLANK    WN0012  1        Record Status
     C                     Z-ADD*ZERO     WN0013  60       Job Time
     C                     MOVEL*BLANK    WN0014 10        User Id
     C                     MOVEL*BLANK    WN0015 10        Job Name
     C                     Z-ADD*ZERO     WN0016  70       Job Date
     C                     MOVEL*BLANK    WN0017  8        AS Serial Numbe
     C                     MOVEL*BLANK    WN0018  8        AS Label Date Y
     C                     MOVEL*BLANK    WN0019  6        AS Net Weight
     C                     MOVEL*BLANK    WN0020  5        AS Product Code
     C                     MOVEL*BLANK    WN0021  7        AS Order Number
     C                     MOVEL*BLANK    WN0022  1        Report Line Typ
     C                     Z-ADD*ZERO     WN0023  50       Scan Length USR
     C                     Z-ADD*ZERO     WN0024  50       Start Position
     C                     MOVEL*BLANK    WN0025 45        Search Pattern
     C                     MOVEL*BLANK    WN0026132        Search Text USR
     C                     Z-ADD*ZERO     WN0027  50       Position USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C                     Z-ADD1         Y01RRN
     C           Y01RRN    SETLL@ACCPTR                    *
     C                     READ @ACCPTR                  90*
      * Data record not found
     C   90                MOVEL'USR3336' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELACQRNA    WN0026           Search Text USR
     C                     MOVEL*BLANK    WN0025           Search Pattern
     C                     MOVEL'Order'   WN0025           Search Pattern
     C                     Z-ADD5         WN0023           Scan Length USR
     C                     Z-ADD1         WN0024           Start Position
      * Scn Text              US - /UT User Source  * 
     C                     Z-ADD*ZEROS    POS     50
     C                     MOVE WN0023    LEN     50
     C                     MOVE WN0024    ST      50
     C           WN0025:LENSCAN WN0026:ST POS
     C                     MOVE POS       WN0027
      * CASE: PAR.Position USR is Greater than zero
     C           WN0027    IFGT *ZERO                      *IF
     C                     Z-ADD7         YRSW00
     C                     Z-ADD12        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ WN0021    P  90  AS Order Number
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE WN0021    WN0003           Order Number
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0025           Search Pattern
     C                     MOVEL@CN,01    WN0025           Search Pattern
     C                     Z-ADD9         WN0023           Scan Length USR
      * Scn Text              US - /UT User Source  * 
     C                     Z-ADD*ZEROS    POS     50
     C                     MOVE WN0023    LEN     50
     C                     MOVE WN0024    ST      50
     C           WN0025:LENSCAN WN0026:ST POS
     C                     MOVE POS       WN0027
      * CASE: PAR.Position USR is Greater than zero
     C           WN0027    IFGT *ZERO                      *IF
     C                     Z-ADD5         YRSW00
     C                     Z-ADD34        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ WN0020    P  90  AS Product Code
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     WN0004           Item Code
     C                     MOVE WN0020    WN0004           Item Code
     C                     ELSE
      * CASE: *OTHERWISE
      * --------------- Case 1 -----------------
      * * Serial Number *
     C                     Z-ADD8         YRSW00
     C                     Z-ADD8         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ WUYMTX    P  90  Text USR 8
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * RPG TESTN for 8 pos.  US - /UT User Source  * 
     C                     TESTN          WUYMTX  8  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * Create Case 1 Record
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * * Case Net Weight *
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0001    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0001    YL0002           Calc 4
     C                     Z-ADD1         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0003    P  90  Text 1 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0003    YL0004           Numeral 1
     C           YL0004    MULT .1        YL0005           Case Net Weight
     C           YL0005    ADD  YL0002    WN0007           Case Net Weight
      * * Case Serial Number *
     C                     MOVE WUYMTX    WN0005           Case Serial Num
      * * Case Label Date *
     C                     Z-ADD2         YRSW00
     C                     Z-ADD17        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0006    P  90  Month USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD20        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0007    P  90  Day USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD23        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0008    P  90  Year 2A USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZEROS    ZQ      50
     C           '20'      CAT  YL0008:ZQ YL0009    P      PT Prod Date AL
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0009    CAT  YL0006:ZQ YL0009    P      PT Prod Date AL
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0009    CAT  YL0007:ZQ YL0009    P      PT Prod Date AL
     C                     MOVE YL0009    YL0010           Date 8.0 USR
      * PAR.Case Label date = LCL.Date 8.0 USR
     C                     Z-ADDYL0010    WN0006           Case Label date
      * * Create Order Manifest Record *
      *
     C                     Z-ADD*ZERO     WN0028  30       Sequence Number
     C                     MOVEL*BLANK    WN0029  1        EDI Status 1
     C                     MOVEL*BLANK    WN0030  1        EDI Status 2
     C                     MOVEL*BLANK    WN0031  1        EDI Status 3
     C                     MOVEL*BLANK    WN0032  1        Record Status
     C                     Z-ADD*ZERO     WN0033  60       Job Time
     C                     MOVEL*BLANK    WN0034 10        User Id
     C                     MOVEL*BLANK    WN0035 10        Job Name
     C                     Z-ADD*ZERO     WN0036  70       Job Date
      *
      * Crt Order Manifest    IF
      * Rtv Next Sequence     RT - Order Manifest  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     Z-ADDWN0003    WL0006           Order Number
     C                     Z-ADDWN0004    WL0007           Item Code
     C                     Z-ADDWN0005    WL0008           Case Serial Num
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    WN0028           Sequence Number
      * Crt Order Manifest    CR - Order Manifest  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0010           Company Number
     C                     Z-ADDWN0003    WL0011           Order Number
     C                     Z-ADDWN0004    WL0012           Item Code
     C                     Z-ADDWN0005    WL0013           Case Serial Num
     C                     Z-ADDWN0028    WL0014           Sequence Number
     C                     Z-ADDWN0006    WL0015           Case Label date
     C                     Z-ADDWN0007    WL0016           Case Net Weight
     C                     MOVEL*BLANK    WL0017           Process Status
     C                     MOVELWN0029    WL0018    P      EDI Status 1
     C                     MOVELWN0030    WL0019    P      EDI Status 2
     C                     MOVELWN0031    WL0020    P      EDI Status 3
     C                     MOVELWN0032    WL0021    P      Record Status
     C                     Z-ADDWN0033    WL0022           Job Time
     C                     MOVELWN0034    WL0023    P      User Id
     C                     MOVELWN0035    WL0024    P      Job Name
     C                     Z-ADDWN0036    WL0025           Job Date
     C                     EXSR SHCRRC
      * Upd Order Number      RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0026           Company Number
     C                     Z-ADDWN0005    WL0027           PT Serial Numbe
     C                     Z-ADDWN0006    WL0028           PT Label Date Y
     C                     Z-ADDWN0007    WL0029           PT Net Weight
     C                     Z-ADDWN0003    WL0030           PT Order Number
     C                     Z-ADDWN0004    WL0031           PT Product Code
     C                     EXSR SIRVGN
     C                     END                             *FI
      * --------------- Case 2 -----------------
      * * Serial Number *
     C                     Z-ADD8         YRSW00
     C                     Z-ADD34        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ WUYMTX    P  90  Text USR 8
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * RPG TESTN for 8 pos.  US - /UT User Source  * 
     C                     TESTN          WUYMTX  8  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * Create Case 2 Record
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * * Case Net Weight *
     C                     Z-ADD4         YRSW00
     C                     Z-ADD27        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0001    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0001    YL0002           Calc 4
     C                     Z-ADD1         YRSW00
     C                     Z-ADD32        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0003    P  90  Text 1 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0003    YL0004           Numeral 1
     C           YL0004    MULT .1        YL0005           Case Net Weight
     C           YL0005    ADD  YL0002    WN0007           Case Net Weight
      * * Case Serial Number *
     C                     MOVE WUYMTX    WN0005           Case Serial Num
      * * Case Label Date *
     C                     Z-ADD2         YRSW00
     C                     Z-ADD43        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0006    P  90  Month USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD46        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0007    P  90  Day USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD49        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0008    P  90  Year 2A USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZEROS    ZQ      50
     C           '20'      CAT  YL0008:ZQ YL0009    P      PT Prod Date AL
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0009    CAT  YL0006:ZQ YL0009    P      PT Prod Date AL
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0009    CAT  YL0007:ZQ YL0009    P      PT Prod Date AL
     C                     MOVE YL0009    YL0010           Date 8.0 USR
      * PAR.Case Label date = LCL.Date 8.0 USR
     C                     Z-ADDYL0010    WN0006           Case Label date
      * * Create Order Manifest Record *
      *
     C                     Z-ADD*ZERO     WN0087  30       Sequence Number
     C                     MOVEL*BLANK    WN0088  1        EDI Status 1
     C                     MOVEL*BLANK    WN0089  1        EDI Status 2
     C                     MOVEL*BLANK    WN0090  1        EDI Status 3
     C                     MOVEL*BLANK    WN0091  1        Record Status
     C                     Z-ADD*ZERO     WN0092  60       Job Time
     C                     MOVEL*BLANK    WN0093 10        User Id
     C                     MOVEL*BLANK    WN0094 10        Job Name
     C                     Z-ADD*ZERO     WN0095  70       Job Date
      *
      * Crt Order Manifest    IF
      * Rtv Next Sequence     RT - Order Manifest  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     Z-ADDWN0003    WL0006           Order Number
     C                     Z-ADDWN0004    WL0007           Item Code
     C                     Z-ADDWN0005    WL0008           Case Serial Num
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    WN0087           Sequence Number
      * Crt Order Manifest    CR - Order Manifest  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0010           Company Number
     C                     Z-ADDWN0003    WL0011           Order Number
     C                     Z-ADDWN0004    WL0012           Item Code
     C                     Z-ADDWN0005    WL0013           Case Serial Num
     C                     Z-ADDWN0087    WL0014           Sequence Number
     C                     Z-ADDWN0006    WL0015           Case Label date
     C                     Z-ADDWN0007    WL0016           Case Net Weight
     C                     MOVEL*BLANK    WL0017           Process Status
     C                     MOVELWN0088    WL0018    P      EDI Status 1
     C                     MOVELWN0089    WL0019    P      EDI Status 2
     C                     MOVELWN0090    WL0020    P      EDI Status 3
     C                     MOVELWN0091    WL0021    P      Record Status
     C                     Z-ADDWN0092    WL0022           Job Time
     C                     MOVELWN0093    WL0023    P      User Id
     C                     MOVELWN0094    WL0024    P      Job Name
     C                     Z-ADDWN0095    WL0025           Job Date
     C                     EXSR SHCRRC
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1AIC3' defaulted for 'Company Number'.
      * Upd Order Number      RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0026           Company Number
     C                     Z-ADDWN0005    WL0027           PT Serial Numbe
     C                     Z-ADDWN0006    WL0028           PT Label Date Y
     C                     Z-ADDWN0007    WL0029           PT Net Weight
     C                     Z-ADDWN0003    WL0030           PT Order Number
     C                     Z-ADDWN0004    WL0031           PT Product Code
     C                     EXSR SIRVGN
     C                     END                             *FI
      * --------------- Case 3 -----------------
      * * Serial Number *
     C                     Z-ADD8         YRSW00
     C                     Z-ADD60        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ WUYMTX    P  90  Text USR 8
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * RPG TESTN for 8 pos.  US - /UT User Source  * 
     C                     TESTN          WUYMTX  8  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * Create Case 3 Record
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * * Case Net Weight *
     C                     Z-ADD4         YRSW00
     C                     Z-ADD53        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0001    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0001    YL0002           Calc 4
     C                     Z-ADD1         YRSW00
     C                     Z-ADD58        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0003    P  90  Text 1 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0003    YL0004           Numeral 1
     C           YL0004    MULT .1        YL0005           Case Net Weight
     C           YL0005    ADD  YL0002    WN0007           Case Net Weight
      * * Case Serial Number *
     C                     MOVE WUYMTX    WN0005           Case Serial Num
      * * Case Label Date *
     C                     Z-ADD2         YRSW00
     C                     Z-ADD69        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0006    P  90  Month USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD72        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0007    P  90  Day USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD75        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00132
     C           ZQ        ORGT 00132
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTACQRNA:ZQ YL0008    P  90  Year 2A USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZEROS    ZQ      50
     C           '20'      CAT  YL0008:ZQ YL0009    P      PT Prod Date AL
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0009    CAT  YL0006:ZQ YL0009    P      PT Prod Date AL
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0009    CAT  YL0007:ZQ YL0009    P      PT Prod Date AL
     C                     MOVE YL0009    YL0010           Date 8.0 USR
      * PAR.Case Label date = LCL.Date 8.0 USR
     C                     Z-ADDYL0010    WN0006           Case Label date
      * * Create Order Manifest Record *
      *
     C                     Z-ADD*ZERO     WN0096  30       Sequence Number
     C                     MOVEL*BLANK    WN0097  1        EDI Status 1
     C                     MOVEL*BLANK    WN0098  1        EDI Status 2
     C                     MOVEL*BLANK    WN0099  1        EDI Status 3
     C                     MOVEL*BLANK    WN0100  1        Record Status
     C                     Z-ADD*ZERO     WN0101  60       Job Time
     C                     MOVEL*BLANK    WN0102 10        User Id
     C                     MOVEL*BLANK    WN0103 10        Job Name
     C                     Z-ADD*ZERO     WN0104  70       Job Date
      *
      * Crt Order Manifest    IF
      * Rtv Next Sequence     RT - Order Manifest  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     Z-ADDWN0003    WL0006           Order Number
     C                     Z-ADDWN0004    WL0007           Item Code
     C                     Z-ADDWN0005    WL0008           Case Serial Num
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    WN0096           Sequence Number
      * Crt Order Manifest    CR - Order Manifest  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0010           Company Number
     C                     Z-ADDWN0003    WL0011           Order Number
     C                     Z-ADDWN0004    WL0012           Item Code
     C                     Z-ADDWN0005    WL0013           Case Serial Num
     C                     Z-ADDWN0096    WL0014           Sequence Number
     C                     Z-ADDWN0006    WL0015           Case Label date
     C                     Z-ADDWN0007    WL0016           Case Net Weight
     C                     MOVEL*BLANK    WL0017           Process Status
     C                     MOVELWN0097    WL0018    P      EDI Status 1
     C                     MOVELWN0098    WL0019    P      EDI Status 2
     C                     MOVELWN0099    WL0020    P      EDI Status 3
     C                     MOVELWN0100    WL0021    P      Record Status
     C                     Z-ADDWN0101    WL0022           Job Time
     C                     MOVELWN0102    WL0023    P      User Id
     C                     MOVELWN0103    WL0024    P      Job Name
     C                     Z-ADDWN0104    WL0025           Job Date
     C                     EXSR SHCRRC
      * Upd Order Number      RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0026           Company Number
     C                     Z-ADDWN0005    WL0027           PT Serial Numbe
     C                     Z-ADDWN0006    WL0028           PT Label Date Y
     C                     Z-ADDWN0007    WL0029           PT Net Weight
     C                     Z-ADDWN0003    WL0030           PT Order Number
     C                     Z-ADDWN0004    WL0031           PT Product Code
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @ACCPTR                  90*
     C                     ENDDO
      * USER: Exit processing
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SMRVGN
     C                     MOVELYL0017    YL0018           PRT Printer Dev
     C                     MOVEL*BLANK    YL0019           Order Alpha
     C                     MOVELWN0003    YL0019           Order Alpha
      * EXC Command SBDOVR     UP - /UT User Programs  * 
     C                     CALL 'PDPOUPR'              90  EXC Command SBD
     C                     PARM 'PPCIPFR$'WQ0006 10        Printer File
     C                     PARM YL0018    WQ0007 10        PRT Printer Dev
     C                     PARM '*YES'    WQ0008  4        PRT Hold Output
     C                     PARM '*YES'    WQ0009  4        PRT Save Output
     C                     PARM '1'       WQ0010  2        Nbr of Copies-A
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Prt Manifest          PF - Order Manifest  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
     C                     Z-ADDWN0003    PAC4NB           Order Number
      *
     C                     CALL 'PPCIPFR'              90  Prt Manifest
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Mani
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPCIPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Setup message data for message
     C                     MOVEL'PPCIPFR$'ZA0001           Program Name$ U
     C                     MOVELYL0019    ZA0002           Order Alpha
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3343' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence     RT - Order Manifest  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSG02           Order Number
     C           *LIKE     DEFN WFHGCD    WQSG03           Item Code
     C           *LIKE     DEFN WFUZNX    WQSG04           Case Serial Num
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WQSG03           Item Code
     C                     KFLD           WQSG04           Case Serial Num
      * Setup key
     C                     Z-ADDWL0005    WQSG01           Company Number
     C                     Z-ADDWL0006    WQSG02           Order Number
     C                     Z-ADDWL0007    WQSG03           Item Code
     C                     Z-ADDWL0008    WQSG04           Case Serial Num
      * Establish starting position
     C           KRSSG     SETLL@ADCPT6                    *
     C           KRSSG     READE@ADCPT6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3338' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0009           Sequence Number
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WFDXNB    ADD  1         WL0009           Sequence Number
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@ADCPT6                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt Order Manifest    CR - Order Manifest  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ADCPTW
     C                     Z-ADDWL0010    WGAIC3           Company Number
     C                     Z-ADDWL0011    WGC4NB           Order Number
     C                     Z-ADDWL0012    WGHGCD           Item Code
     C                     Z-ADDWL0013    WGUZNX           Case Serial Num
     C                     Z-ADDWL0014    WGDXNB           Sequence Number
     C                     Z-ADDWL0015    WGPVDT           Case Label date
     C                     Z-ADDWL0016    WGKZWG           Case Net Weight
     C                     MOVELWL0017    WGRASX           Process Status
     C                     MOVELWL0018    WGUVST           EDI Status 1
     C                     MOVELWL0019    WGUWST           EDI Status 2
     C                     MOVELWL0020    WGUXST           EDI Status 3
     C                     MOVELWL0021    WGVSST           Record Status
     C                     Z-ADDWL0022    WGAATM           Job Time
     C                     MOVELWL0023    WGAYNA           User Id
     C                     MOVELWL0024    WGA0NA           Job Name
     C                     Z-ADDWL0025    WGAXDT           Job Date
      *
      * USER: Processing before Data update
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WGVSST           Record Status
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGUZNX           Case Serial Num
     C                     KFLD           WGDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSH    SETLL@ADCPTW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3339' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@ADCPTW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Order Number      RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WHPFNX    WQSI02           PT Serial Numbe
     C           *LIKE     DEFN WHADDX    WQSI03           PT Label Date Y
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           PT Serial Numbe
     C                     KFLD           WQSI03           PT Label Date Y
      * Setup key
     C                     Z-ADDWL0026    WQSI01           Company Number
     C                     Z-ADDWL0027    WQSI02           PT Serial Numbe
     C                     Z-ADDWL0028    WQSI03           PT Label Date Y
      * Establish starting position
     C           KRSSI     SETLL@B2CPT3                    *
     C           KRSSI     READE@B2CPT3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3144' W0RTN   7
      * USER: Processing if Data record not found
      * When Co-Packer Products are shipped, the cases will be listed
      * in the Manifest report, but we will not have a Product Trace
      * record for it.  So, we need to create one.
     C                     MOVEL*BLANK    YL0011           AS Serial Numbe
     C                     MOVELWL0027    YL0011           AS Serial Numbe
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0011:ZQ YL0012    P  90  Scale ID
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVEL*BLANK    YL0013           Date From Conve
     C                     MOVELWL0028    YL0013           Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM YL0013    WQ0001 10        Date From Conve
     C           YL0014    PARM *BLANK    WQ0002 11        Date To Convert
     C                     PARM '*YYMD'   WQ0003  8        Date From Forma
     C                     PARM '*CYMD'   WQ0004  8        Date To Format
     C                     PARM '*NONE'   WQ0005  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0014    YL0015           Effective Label
      * Rtv Manifest Upl Info RT - Product Trace Line Scale  * 
     C                     EXSR SJRVGN
      * CASE: LCL.Scale ID is GE 20
     C           YL0012    IFGE '20'                       *IF
      * Crt Product Trace     CR - Product Trace  * 
     C                     EXSR SKCRRC
     C                     END                             *FI
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If the Order Number is 9999999, then the boxes were taken
      * off of the truck and placed back in Inventory.
      * CASE: PAR.PT Order Number is EQ 9999999
     C           WL0030    IFEQ 9999999                    *IF
      * Chg Order Number      CH - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0032           Company Number
     C                     Z-ADDWHPFNX    WL0033           PT Serial Numbe
     C                     Z-ADDWHAADX    WL0034           PT Prod Date YY
     C                     Z-ADDWHB9TM    WL0035           PT Production T
     C                     MOVEL'1'       WL0036    P      PT Inventory St
     C                     Z-ADD*ZERO     WL0037           PT Order Number
     C                     EXSR SLCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Order Number      CH - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0032           Company Number
     C                     Z-ADDWHPFNX    WL0033           PT Serial Numbe
     C                     Z-ADDWHAADX    WL0034           PT Prod Date YY
     C                     Z-ADDWHB9TM    WL0035           PT Production T
     C                     MOVEL'3'       WL0036    P      PT Inventory St
     C                     Z-ADDWL0030    WL0037           PT Order Number
     C                     EXSR SLCHRC
     C                     END                             *FI
     C           KRSSI     READE@B2CPT3                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Manifest Upl Info RT - Product Trace Line Scale  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WIUXNX    WQSJ02           Scale ID
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Scale ID
     C                     KFLD           WIPUDT           Effective Label
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Scale ID
      * Setup key
     C                     Z-ADDWL0026    WQSJ01           Company Number
     C                     MOVELYL0012    WQSJ02           Scale ID
     C                     Z-ADDYL0015    WIPUDT           Effective Label
      * Establish starting position
     C           KPSSJ     SETLL@AARETD                    *
     C           KRSSJ     READE@AARETD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3311' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0016           Line Code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIFAAA    YL0016           Line Code
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@AARETD                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Product Trace     CR - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B2CPMP
     C                     Z-ADDWL0026    WJAIC3           Company Number
     C                     Z-ADDWL0027    WJPFNX           PT Serial Numbe
     C                     Z-ADDWL0028    WJAADX           PT Prod Date YY
     C                     Z-ADD##JTM     WJB9TM           PT Production T
     C                     Z-ADDWL0028    WJADDX           PT Label Date Y
     C                     Z-ADDWL0028    WJABDX           PT Offset Prod
     C                     Z-ADD##JTM     WJCATM           PT Offset Prod
     C                     MOVEL'3'       WJMNSX           PT Inventory St
     C                     Z-ADDWL0029    WJJOWG           PT Net Weight
     C                     Z-ADD*ZERO     WJJPWG           PT Gross Weight
     C                     MOVELWUMOSX    WJMOSX           PT Shift Number
     C                     MOVELYL0016    WJDNAA           PT Warehouse ID
     C                     Z-ADDWL0030    WJPGNX           PT Order Number
     C                     MOVEL*BLANK    WJBTT1           PT Pallet Numbe
     C                     Z-ADDWL0031    WJD7C7           PT Product Code
     C                     MOVEL*BLANK    WJPYNA           PT Item Label L
     C                     MOVEL*BLANK    WJPZNA           PT Item Label L
     C                     MOVELWUMPSX    WJMPSX           PT Fresh/Frozen
     C                     MOVE *BLANK    WJCCT1           PT Item Picture
     C                     MOVEL'LOGO'    WJCCT1           PT Item Picture
     C                     Z-ADD*ZERO     WJPHNX           PT Tattoo Numbe
     C                     MOVELWUMQSX    WJMQSX           PT Source Type
     C                     MOVEL*BLANK    WJDOAA           PT Source Code
     C                     MOVEL*BLANK    WJBUT1           PT Source Code
     C                     MOVEL*BLANK    WJDYAA           PT Producer/Cel
     C                     MOVEL*BLANK    WJBVT1           PT Producer/Cel
     C                     MOVEL*BLANK    WJDPAA           PT Producer/Far
     C                     MOVEL*BLANK    WJDQAA           PT Producer Loc
     C                     MOVEL*BLANK    WJBZT1           PT Producer/Far
     C                     MOVEL*BLANK    WJBWT1           PT Producer/Far
     C                     MOVEL*BLANK    WJDRAA           PT Producer/Far
     C                     MOVEL*BLANK    WJB9T1           PT Producer/Far
     C                     MOVEL*BLANK    WJDSAA           PT Genetic Code
     C                     MOVEL*BLANK    WJB8T1           PT Genetic Desc
     C                     MOVEL*BLANK    WJD4AA           PT Gender Code
     C                     MOVEL*BLANK    WJEPAA           PT Producer/Far
     C                     MOVEL*BLANK    WJEQAA           PT Producer/Far
     C                     MOVEL*BLANK    WJERAA           PT Producer/Far
     C                     MOVEL*BLANK    WJESAA           PT Producer/Far
     C                     MOVELWUPNSX    WJPNSX           PT Item Type Co
     C                     Z-ADD*ZERO     WJUFNX           PT Item Str Cla
     C                     Z-ADD*ZERO     WJUGNX           PT Item Str Gro
     C                     Z-ADD*ZERO     WJUHNX           PT Item Str Typ
     C                     Z-ADD*ZERO     WJAGDX           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WJCGTM           PT WIP Dump/Pro
     C                     MOVELWUPOSX    WJPOSX           PT WIP Dump/Pro
     C                     MOVELWUPPSX    WJPPSX           PT WIP Used/Not
     C                     Z-ADD*ZERO     WJUINX           PT From FG Seri
     C                     Z-ADD*ZERO     WJUJNX           PT To FG Serial
     C                     Z-ADD*ZERO     WJUKNX           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WJULNX           PT Unused Nbr 4
     C                     MOVEL'N'       WJPRSX           PT Incl in Prod
     C                     MOVELWUPSSX    WJPSSX           PT Unused Sts 4
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     MOVEL*BLANK    WJAYNA           User Id
     C                     MOVEL*BLANK    WJA0NA           Job Name
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
     C           KLCRSK    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJPFNX           PT Serial Numbe
     C                     KFLD           WJAADX           PT Prod Date YY
     C                     KFLD           WJB9TM           PT Production T
      * Check for duplicate primary key
     C           KLCRSK    SETLL@B2CPMP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3145' W0RTN   7
      * Send message 'Product Trace          EX'
     C                     MOVEL'USR3145' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@B2CPMP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Order Number      CH - Product Trace  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0037  80       PT Label Date Y
     C                     Z-ADD*ZERO     WN0038  80       PT Offset Prod
     C                     Z-ADD*ZERO     WN0039  60       PT Offset Prod
     C                     Z-ADD*ZERO     WN0040  51       PT Net Weight
     C                     Z-ADD*ZERO     WN0041  51       PT Gross Weight
     C                     MOVEL*BLANK    WN0042  1        PT Shift Number
     C                     MOVEL*BLANK    WN0043  3        PT Warehouse ID
     C                     MOVEL*BLANK    WN0044 10        PT Pallet Numbe
     C                     Z-ADD*ZERO     WN0045  70       PT Product Code
     C                     MOVEL*BLANK    WN0046 32        PT Item Label L
     C                     MOVEL*BLANK    WN0047 32        PT Item Label L
     C                     MOVEL*BLANK    WN0048  2        PT Fresh/Frozen
     C                     MOVEL*BLANK    WN0049  9        PT Item Picture
     C                     Z-ADD*ZERO     WN0050  50       PT Tattoo Numbe
     C                     MOVEL*BLANK    WN0051  1        PT Source Type
     C                     MOVEL*BLANK    WN0052  3        PT Source Code
     C                     MOVEL*BLANK    WN0053 25        PT Source Code
     C                     MOVEL*BLANK    WN0054  5        PT Producer/Cel
     C                     MOVEL*BLANK    WN0055 25        PT Producer/Cel
     C                     MOVEL*BLANK    WN0056  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0057  6        PT Producer Loc
     C                     MOVEL*BLANK    WN0058 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0059 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0060  2        PT Producer/Far
     C                     MOVEL*BLANK    WN0061 20        PT Producer/Far
     C                     MOVEL*BLANK    WN0062  5        PT Genetic Code
     C                     MOVEL*BLANK    WN0063 25        PT Genetic Desc
     C                     MOVEL*BLANK    WN0064  1        PT Gender Code
     C                     MOVEL*BLANK    WN0065  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0066  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0067  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0068  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0069  3        PT Item Type Co
     C                     Z-ADD*ZERO     WN0070  30       PT Item Str Cla
     C                     Z-ADD*ZERO     WN0071  30       PT Item Str Gro
     C                     Z-ADD*ZERO     WN0072  30       PT Item Str Typ
     C                     Z-ADD*ZERO     WN0073  80       PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WN0074  60       PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0075  1        PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0076  1        PT WIP Used/Not
     C                     Z-ADD*ZERO     WN0077  80       PT From FG Seri
     C                     Z-ADD*ZERO     WN0078  80       PT To FG Serial
     C                     Z-ADD*ZERO     WN0079  80       PT Unused Nbr 3
     C                     Z-ADD*ZERO     WN0080  70       PT Unused Nbr 4
     C                     MOVEL*BLANK    WN0081  1        PT Incl in Prod
     C                     MOVEL*BLANK    WN0082  1        PT Unused Sts 4
     C                     Z-ADD*ZERO     WN0083  60       Job Time
     C                     MOVEL*BLANK    WN0084 10        User Id
     C                     MOVEL*BLANK    WN0085 10        Job Name
     C                     Z-ADD*ZERO     WN0086  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B2CPMP
     C                     Z-ADDWL0032    WJAIC3           Company Number
     C                     Z-ADDWL0033    WJPFNX           PT Serial Numbe
     C                     Z-ADDWL0034    WJAADX           PT Prod Date YY
     C                     Z-ADDWL0035    WJB9TM           PT Production T
      *
     C           KLCHSL    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJPFNX           PT Serial Numbe
     C                     KFLD           WJAADX           PT Prod Date YY
     C                     KFLD           WJB9TM           PT Production T
     C           KLCHSL    CHAIN@B2CPMP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB2CPL0'MDACP
     C                     MOVEL'@B2CPMP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB21    YARDCS
      * Move non-key fields to @B2CPMP
     C                     MOVELWL0036    WJMNSX    P      PT Inventory St
     C                     Z-ADDWL0037    WJPGNX           PT Order Number
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB21    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B2CPMP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    WKAIC3           Company Number
     C                     MOVEL@CN,02    WKV8CD           Company Value C
      * Establish starting position
     C           KRSSM     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKBXTX    YL0017           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1DQCD           Enterprise Code
     C                     MOVEL*BLANK    P1DRCD           Enterprise Code
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
     C                     MOVEL*BLANK    P1ADTX           Name
     C                     MOVEL*BLANK    P1BXTX           System Value Al
     C                     MOVEL*BLANK    P1WVST           Access Denied (
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     MOVEL*BLANK    P1ICL            *Initial call
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WANLNB           Entity Number
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Text USR 8
     C                     MOVEL*BLANK    WUYMTX  8
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFUZNX           Case Serial Num
     C                     Z-ADD*ZERO     WFDXNB           Sequence Number
     C                     Z-ADD*ZERO     WFPVDT           Case Label date
     C                     Z-ADD*ZERO     WFKZWG           Case Net Weight
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WHAADX           PT Prod Date YY
     C                     Z-ADD*ZERO     WHB9TM           PT Production T
     C                     Z-ADD*ZERO     WHADDX           PT Label Date Y
     C                     Z-ADD*ZERO     WHABDX           PT Offset Prod
     C                     Z-ADD*ZERO     WHCATM           PT Offset Prod
     C                     Z-ADD*ZERO     WHJOWG           PT Net Weight
     C                     Z-ADD*ZERO     WHJPWG           PT Gross Weight
     C                     Z-ADD*ZERO     WHPGNX           PT Order Number
     C                     Z-ADD*ZERO     WHD7C7           PT Product Code
     C                     Z-ADD*ZERO     WHPHNX           PT Tattoo Numbe
     C                     Z-ADD*ZERO     WHUFNX           PT Item Str Cla
     C                     Z-ADD*ZERO     WHUGNX           PT Item Str Gro
     C                     Z-ADD*ZERO     WHUHNX           PT Item Str Typ
     C                     Z-ADD*ZERO     WHAGDX           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WHCGTM           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WHUINX           PT From FG Seri
     C                     Z-ADD*ZERO     WHUJNX           PT To FG Serial
     C                     Z-ADD*ZERO     WHUKNX           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WHULNX           PT Unused Nbr 4
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIPUDT           Effective Label
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field PT Shift Number
     C                     MOVEL*BLANK    WUMOSX  1
      * Define work field PT Fresh/Frozen Code
     C                     MOVEL*BLANK    WUMPSX  2
      * Define work field PT Source Type
     C                     MOVEL*BLANK    WUMQSX  1
      * Define work field PT Item Type Code
     C                     MOVEL*BLANK    WUPNSX  3
      * Define work field PT WIP Dump/Production Sh
     C                     MOVEL*BLANK    WUPOSX  1
      * Define work field PT WIP Used/Not Used Sts
     C                     MOVEL*BLANK    WUPPSX  1
      * Define work field PT Unused Sts 4
     C                     MOVEL*BLANK    WUPSSX  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKM8NB           System Value Nu
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Relative record number for PPACCPP
     C                     Z-ADD1         Y01RRN  90
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  3
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  80
     C                     Z-ADD*ZERO     WL0009  30
      * Define local variables for subroutine SHCRRC.
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  80
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  80
     C                     Z-ADD*ZERO     WL0016  71
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
     C                     Z-ADD*ZERO     WL0022  60
     C                     MOVEL*BLANK    WL0023 10
     C                     MOVEL*BLANK    WL0024 10
     C                     Z-ADD*ZERO     WL0025  70
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  80
     C                     Z-ADD*ZERO     WL0028  80
     C                     Z-ADD*ZERO     WL0029  51
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  70
      * Define local variables for subroutine SLCHRC.
     C                     Z-ADD*ZERO     WL0032  30
     C                     Z-ADD*ZERO     WL0033  80
     C                     Z-ADD*ZERO     WL0034  80
     C                     Z-ADD*ZERO     WL0035  60
     C                     MOVEL*BLANK    WL0036  1
     C                     Z-ADD*ZERO     WL0037  70
      * Define local work field Text USR 4
     C                     MOVEL*BLANK    YL0001  4
      * Define local work field Calc 4
     C                     Z-ADD*ZERO     YL0002  40
      * Define local work field Text 1 Length USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Numeral 1             USR
     C                     Z-ADD*ZERO     YL0004  10
      * Define local work field Case Net Weight
     C                     Z-ADD*ZERO     YL0005  71
      * Define local work field Month USR
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Day USR
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Year 2A USR
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field PT Prod Date ALPHA
     C                     MOVEL*BLANK    YL0009  8
      * Define local work field Date 8.0 USR
     C                     Z-ADD*ZERO     YL0010  80
      * Define local work field AS Serial Number
     C                     MOVEL*BLANK    YL0011  8
      * Define local work field Scale ID
     C                     MOVEL*BLANK    YL0012  2
      * Define local work field Date From Convert USR
     C                     MOVEL*BLANK    YL0013 10
      * Define local work field Date To Convert USR
     C                     MOVEL*BLANK    YL0014 11
      * Define local work field Effective Label Date
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Line Code
     C                     MOVEL*BLANK    YL0016  6
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0017 40
      * Define local work field PRT Printer Device
     C                     MOVEL*BLANK    YL0018 10
      * Define local work field Order Alpha
     C                     MOVEL*BLANK    YL0019  7
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PRODUCT :
00002 FRZMANPTR
