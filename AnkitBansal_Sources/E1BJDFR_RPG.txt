     H/TITLE Dsp E10411 Voucher Ent DF Display file
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISRCENT
     H* Date          : 03/11/22  Time  : 16:02:37
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FE1BJDFR#  CF   E             WORKSTN
     F                                     SFILE(#SFLRCD:##RR)
     F                                     INFDS(INFDS#)
      * DSP: Dsp E10411 Voucher Ent DF Display file
      *
     FE10411L1  IF   E           K DISK
     F                                     INFDS(INFDS1)
      * RTV : Run Log Vchr Dtl   F0411  Retrieval index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      * ABO DEFINE LARGE STRING FOR CL CMD
     D YARTCM          DS           512
     D  DUMMY1                 1      1
     D INFDS#        E DS                  EXTNAME(Y2I#DSP)
      * Display file information data structure
      *
     D INFDS1        E DS                  EXTNAME(Y2I1DSP)
      * File information data structure
      *
      * Outward parameters
     D PARC            DS            51
      * KEY : Run Log Vchr Dtl   F0411  Retrieval index
      * I : RST EDI - User ID
     D  PAEDUS                 1     10
      * I : RST EDI - Batch Number
     D  PAEDBT                11     25
      * I : RST EDI - Transaction Nbr
     D  PAEDTN                26     47
      * I : RST EDI - Line Number
     D  PAEDLN                48     51P 3
      *
      /EJECT
     D XDINT           DS
      * Internal date
     D  XDINDT                 1      7  0
     D  XDINYY                 1      3  0
     D  XDINMM                 4      5  0
     D  XDINDD                 6      7  0
      /EJECT
     D XDEX            DS
      * External date
     D  XDEXDT                 1      8  0
     D  XDEY01                 1      4  0
     D  XDEX01                 1      2  0
     D  XDEX02                 3      4  0
     D  XDEY02                 5      8  0
     D  XDEX03                 5      6  0
     D  XDEX04                 7      8  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S             10
     D  WP0002         S             15
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  ##RRMX         S              5  0
     D  WZSFX          S                   LIKE(#2SFX)
     D  WZSFXE         S                   LIKE(#2SFXE)
     D  WZDCTA         S                   LIKE(#2DCTA)
     D  WZPYE          S                   LIKE(#2PYE)
     D  WZSNTO         S                   LIKE(#2SNTO)
     D  WZDIVJ         S                   LIKE(#2DIVJ)
     D  WZDSVJ         S                   LIKE(#2DSVJ)
     D  WZDDJ          S                   LIKE(#2DDJ)
     D  WZDDNJ         S                   LIKE(#2DDNJ)
     D  WZFY           S                   LIKE(#2FY)
     D  WZCTRY         S                   LIKE(#2CTRY)
     D  WZPN           S                   LIKE(#2PN)
     D  WZICU          S                   LIKE(#2ICU)
     D  WZICUT         S                   LIKE(#2ICUT)
     D  WZDICJ         S                   LIKE(#2DICJ)
     D  WZBALJ         S                   LIKE(#2BALJ)
     D  WZPSTC         S                   LIKE(#2PSTC)
     D  WZAG           S                   LIKE(#2AG)
     D  WZAAP          S                   LIKE(#2AAP)
     D  WZADSC         S                   LIKE(#2ADSC)
     D  WZADSA         S                   LIKE(#2ADSA)
     D  WZATXA         S                   LIKE(#2ATXA)
     D  WZATXN         S                   LIKE(#2ATXN)
     D  WZSTAM         S                   LIKE(#2STAM)
     D  WZTXA1         S                   LIKE(#2TXA1)
     D  WZEXR1         S                   LIKE(#2EXR1)
     D  WZCRRM         S                   LIKE(#2CRRM)
     D  WZCRCD         S                   LIKE(#2CRCD)
     D  WZCRR          S                   LIKE(#2CRR)
     D  WZACR          S                   LIKE(#2ACR)
     D  WZFAP          S                   LIKE(#2FAP)
     D  WZCDS          S                   LIKE(#2CDS)
     D  WZCDSA         S                   LIKE(#2CDSA)
     D  WZCTXA         S                   LIKE(#2CTXA)
     D  WZCTXN         S                   LIKE(#2CTXN)
     D  WZCTAM         S                   LIKE(#2CTAM)
     D  WZGLC          S                   LIKE(#2GLC)
     D  WZGLBA         S                   LIKE(#2GLBA)
     D  WZPOST         S                   LIKE(#2POST)
     D  WZAM           S                   LIKE(#2AM)
     D  WZAID2         S                   LIKE(#2AID2)
     D  WZMCU          S                   LIKE(#2MCU)
     D  WZOBJ          S                   LIKE(#2OBJ)
     D  WZSUB          S                   LIKE(#2SUB)
     D  WZSBLT         S                   LIKE(#2SBLT)
     D  WZSBL          S                   LIKE(#2SBL)
     D  WZBAID         S                   LIKE(#2BAID)
     D  WZPTC          S                   LIKE(#2PTC)
     D  WZVOD          S                   LIKE(#2VOD)
     D  WZOKCO         S                   LIKE(#2OKCO)
     D  WZODCT         S                   LIKE(#2ODCT)
     D  WZODOC         S                   LIKE(#2ODOC)
     D  WZOSFX         S                   LIKE(#2OSFX)
     D  WZCRC          S                   LIKE(#2CRC)
     D  WZVINV         S                   LIKE(#2VINV)
     D  WZPKCO         S                   LIKE(#2PKCO)
     D  WZPO           S                   LIKE(#2PO)
     D  WZPDCT         S                   LIKE(#2PDCT)
     D  WZLNID         S                   LIKE(#2LNID)
     D  WZSFXO         S                   LIKE(#2SFXO)
     D  WZOPSQ         S                   LIKE(#2OPSQ)
     D  WZVR01         S                   LIKE(#2VR01)
     D  WZUNIT         S                   LIKE(#2UNIT)
     D  WZMCU2         S                   LIKE(#2MCU2)
     D  WZRMK          S                   LIKE(#2RMK)
     D  WZRF           S                   LIKE(#2RF)
     D  WZDRF          S                   LIKE(#2DRF)
     D  WZCTL          S                   LIKE(#2CTL)
     D  WZFNLP         S                   LIKE(#2FNLP)
     D  WZU            S                   LIKE(#2U)
     D  WZUM           S                   LIKE(#2UM)
     D  WZPYIN         S                   LIKE(#2PYIN)
     D  WZTXA3         S                   LIKE(#2TXA3)
     D  WZRP1          S                   LIKE(#2RP1)
     D  WZRP2          S                   LIKE(#2RP2)
     D  WZRP3          S                   LIKE(#2RP3)
     D  WZAC07         S                   LIKE(#2AC07)
     D  WZTNN          S                   LIKE(#2TNN)
     D  WZDMCD         S                   LIKE(#2DMCD)
     D  WZITM          S                   LIKE(#2ITM)
     D  WZHCRR         S                   LIKE(#2HCRR)
     D  WZHDGJ         S                   LIKE(#2HDGJ)
     D  WZURCD         S                   LIKE(#2URCD)
     D  WZURDT         S                   LIKE(#2URDT)
     D  WZURAT         S                   LIKE(#2URAT)
     D  WZURAB         S                   LIKE(#2URAB)
     D  WZURRF         S                   LIKE(#2URRF)
     D  WZTORG         S                   LIKE(#2TORG)
     D  WZUSER         S                   LIKE(#2USER)
     D  WZPID          S                   LIKE(#2PID)
     D  WZUPMJ         S                   LIKE(#2UPMJ)
     D  WZUPMT         S                   LIKE(#2UPMT)
     D  WZJOBN         S                   LIKE(#2JOBN)
     D  WZDIM          S                   LIKE(#2DIM)
     D  WZDID          S                   LIKE(#2DID)
     D  WZDIY          S                   LIKE(#2DIY)
     D  WZDI#          S                   LIKE(#2DI#)
     D  WZDSVM         S                   LIKE(#2DSVM)
     D  WZDSVD         S                   LIKE(#2DSVD)
     D  WZDSVY         S                   LIKE(#2DSVY)
     D  WZDSV#         S                   LIKE(#2DSV#)
     D  WZDDM          S                   LIKE(#2DDM)
     D  WZDDDA         S                   LIKE(#2DDDA)
     D  WZDDY          S                   LIKE(#2DDY)
     D  WZDD#          S                   LIKE(#2DD#)
     D  WZDDNM         S                   LIKE(#2DDNM)
     D  WZDDND         S                   LIKE(#2DDND)
     D  WZDDNY         S                   LIKE(#2DDNY)
     D  WZDDN#         S                   LIKE(#2DDN#)
     D  WZDGM          S                   LIKE(#2DGM)
     D  WZDGD          S                   LIKE(#2DGD)
     D  WZDGY          S                   LIKE(#2DGY)
     D  WZDG#          S                   LIKE(#2DG#)
     D  WZDICM         S                   LIKE(#2DICM)
     D  WZDICD         S                   LIKE(#2DICD)
     D  WZDICY         S                   LIKE(#2DICY)
     D  WZDIC#         S                   LIKE(#2DIC#)
     D  WZHDGM         S                   LIKE(#2HDGM)
     D  WZHDGD         S                   LIKE(#2HDGD)
     D  WZHDGY         S                   LIKE(#2HDGY)
     D  WZHDG#         S                   LIKE(#2HDG#)
     D  WZDOCM         S                   LIKE(#2DOCM)
     D  WZTNST         S                   LIKE(#2TNST)
     D  WZYC01         S                   LIKE(#2YC01)
     D  WZYC02         S                   LIKE(#2YC02)
     D  WZYC03         S                   LIKE(#2YC03)
     D  WZYC04         S                   LIKE(#2YC04)
     D  WZYC05         S                   LIKE(#2YC05)
     D  WZYC06         S                   LIKE(#2YC06)
     D  WZYC07         S                   LIKE(#2YC07)
     D  WZYC08         S                   LIKE(#2YC08)
     D  WZYC09         S                   LIKE(#2YC09)
     D  WZYC10         S                   LIKE(#2YC10)
     D  WZDTXS         S                   LIKE(#2DTXS)
     D  WZBCRC         S                   LIKE(#2BCRC)
     D  WZATAD         S                   LIKE(#2ATAD)
     D  WZCTAD         S                   LIKE(#2CTAD)
     D  WZNRTA         S                   LIKE(#2NRTA)
     D  WZFNRT         S                   LIKE(#2FNRT)
     D  WZTAXP         S                   LIKE(#2TAXP)
     D  WZPRGF         S                   LIKE(#2PRGF)
     D  WZGFL5         S                   LIKE(#2GFL5)
     D  WZGFL6         S                   LIKE(#2GFL6)
     D  WZGAM1         S                   LIKE(#2GAM1)
     D  WZGAM2         S                   LIKE(#2GAM2)
     D  WZGEN4         S                   LIKE(#2GEN4)
     D  WZGEN5         S                   LIKE(#2GEN5)
     D  WZWTAD         S                   LIKE(#2WTAD)
     D  WZWTAF         S                   LIKE(#2WTAF)
     D  WZSMMF         S                   LIKE(#2SMMF)
     D  WZPYWP         S                   LIKE(#2PYWP)
     D  WZPWPG         S                   LIKE(#2PWPG)
     D  WZNETS         S                   LIKE(#2NETS)
     D  WZATFL         S                   LIKE(#2ATFL)
     D  WZATRL         S                   LIKE(#2ATRL)
     D  WZJOBS         S                   LIKE(#2JOBS)
     D  WZPSTE         S                   LIKE(#2PSTE)
     D  WZDWST         S                   LIKE(#2DWST)
     D  WZABDT         S                   LIKE(#2ABDT)
     D  WZABTM         S                   LIKE(#2ABTM)
     D  WZAJVN         S                   LIKE(#2AJVN)
     D  WZAKVN         S                   LIKE(#2AKVN)
     D  WZACDT         S                   LIKE(#2ACDT)
     D  WZACTM         S                   LIKE(#2ACTM)
     D  WZALVN         S                   LIKE(#2ALVN)
     D  WZDOC          S                   LIKE(#2DOC)
     D  WZKCO          S                   LIKE(#2KCO)
     D  WZEDUS         S                   LIKE(#2EDUS)
     D  WZEDBT         S                   LIKE(#2EDBT)
     D  WZEDTN         S                   LIKE(#2EDTN)
     D  WZEDLN         S                   LIKE(#2EDLN)
     D  WZEDSP         S                   LIKE(#2EDSP)
     D  WZCO           S                   LIKE(#2CO)
     D  WZDCT          S                   LIKE(#2DCT)
     D  WZDGJ          S                   LIKE(#2DGJ)
     D  WZAN8          S                   LIKE(#2AN8)
     D  WZO6TX         S                   LIKE(#2O6TX)
     D  WZO7TX         S                   LIKE(#2O7TX)
     D  WQB10X         S             10
     D  WQO6TX         S                   LIKE(#2O6TX)
     D  WQA5N          S              5  0
     D  WQC10X         S             10
     D  WQO7TX         S                   LIKE(#2O7TX)
     D  ##RROK         S              5  0
     D  WKIND0         S              1
     D  ##RR           S              5  0
     D  ##RRRD         S              9  0
     D  ##SPG          S              3  0
     D  ##SLIN         S              3  0
     D  ##SFLN         S              9  0
     D  WQA3N          S              3  0
     D  WQB3N          S              3  0
     D  WQC3N          S              3  0
     D  WQD1           S              1
     D  WQE1           S              1
     D  WQF1           S              1
     D  WQG3N          S              3  0
     D  YL0001         S              5  0
     D  WQ0001         S              5  0
     D  WQ0002         S              7  0
     D  W0CLPG         S             10
     D  W0HLP          S              1
     D  YPMT04         S              1
     D  HELP25         S              1
     D  ##OFF          S             30
     D  CAIN81         S              1
     D  ZHCSRW         S              5  0
     D  ZHCSCL         S              5  0
     D  ZZCSRW         S              3  0
     D  ZZCSCL         S              3  0
     D  W0HPMB         S             10
     D  YYHPFL         S             10
     D  YYHPLB         S             10
     D  YYHLVN         S             10
     D  YYUSOP         S             10
     D  YYRW           S              5  0
     D  YYCL           S              5  0
     D  YYLGCT         S              5  0
     D  YYLGVN         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAFSMS         S              1
     D  W0DCF          S              1
     D  XDDTFM         S              3
     D  YPMTFD         S             10
     D  YAFSCH         S              4  0
     D  YPMRRN         S              4  0
     D  Y#SFRC         S              4  0
     D  ZHSTRW         S              4  0
     D  ZHNDRW         S              4  0
     D  ZHRLEN         S              4  0
     D  ZHF4RW         S              4  0
     D  ZHWK1#         S              4  0
     D  YZSFDL         S              4  0
     D  ##SFPG         S              3  0
     D  W0SLM          S              9  0
     D  W0SPG          S              3  0
     D  W0RR0          S              4  0
     D  W0GRP          S              1
     D  WQ0003         S              3
     D  WQ0004         S              3  0
     D  WQ0005         S              6
     D  WQ0006         S              3
     D  WQ0007         S              1
     D  WQ0008         S             10
     D  WQ0009         S             30
     D  WQ0010         S             40
     D  WQ0011         S              1
     D  ZADFMF         S             10
     D  YSETCS         S              1
     D  WCSRLC         S              3
     D  ZINPOS         S              5  0
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0CFL          S             10
     D  W0CRW          S              5  0
     D  W0CCL          S              5  0
     D  ZZFFL          S             10
     D  ZZFLB          S             10
     D  ZZFMB          S             10
     D  ZZFQL          S             21
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Run Log Vchr Dtl   F0411
      * I : RST EDI - User ID
     D  P1EDUS                 1     10
      * I : RST EDI - Batch Number
     D  P1EDBT                11     25
     D P2PARM          DS
      * FLD: *Arrays
      * N :  OMS Warehouse Code
     D  P2LCTX                 1      3
      * N :  OMS Company Number
     D  P2GUNB                 4      5P 0
      * N :  OMS Application code
     D  P2CQCD                 6     11
      * N :  OMS Salesperson Code
     D  P2CSCD                12     14
      * N :  OMS Allow Multi-Company
     D  P2I2ST                15     15
      * N :  OMS Default Printer
     D  P2LDTX                16     25
      * N :  OMS NAME
     D  P2LETX                26     55
      * N :  OMS System Value Alpha
     D  P2KRTX                56     95
      * N :  OMS Access Denied (Y/N)
     D  P2I1ST                96     96
     D                 DS
     D  ZAMSDA                 1    132
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1EDUS        PARM                    WP0001                         EDI - User ID
     C     P1EDBT        PARM                    WP0002                         EDI - Batch Num
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
     C                   DO        *HIVAL
      * Initialise & load subfile page
     C                   EXSR      BAIZSF
     C                   MOVEL     'N'           W0RSF
      * Display screen until reload requested
      * Display screen
     C                   DOW       W0RSF = 'N'
     C                   EXSR      CAEXFM
      * Process response
      * Cancel & exit program
     C   03              CAS                     ZXEXPG
      * HOME: Request subfile reload
     C   05              CAS                     FBRQRL
      * Display next SFL page
     C   27
     COR 08              CAS                     BBLDSF
      * Process screen input
     C                   CAS                     DAPR##
     C                   END
      *
     C                   END                                                    OD W0RSF
     C                   END                                                    OD *HIVAL
      *****************************************************************
      /EJECT
     CSR   BAIZSF        BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                   SETON                                        80
     C                   WRITE     #SFLCTL
     C                   SETOFF                                       80
      * Reset no of records in subfile
     C                   Z-ADD     *ZERO         ##RRMX               81         SETOF 81
      * Position DBF file
     C     KPOS          KLIST
     C                   KFLD                    ELEDUS                         EDI - User ID
     C                   KFLD                    ELEDBT                         EDI - Batch Num
     C                   KFLD                    ELEDTN                         EDI - Transacti
     C                   KFLD                    ELEDLN                         EDI - Line Numb
      * Setup key
     C                   MOVEL     #2EDUS        ELEDUS
     C                   MOVEL     #2EDBT        ELEDBT
     C                   MOVEL     #2EDTN        ELEDTN
     C                   Z-ADD     #2EDLN        ELEDLN
     C     KPOS          SETLL     I0411L1
     C     KRST          KLIST
     C                   KFLD                    ELEDUS                         EDI - User ID
     C                   KFLD                    ELEDBT                         EDI - Batch Num
      * Setup key
     C                   MOVEL     #2EDUS        ELEDUS
     C                   MOVEL     #2EDBT        ELEDBT
     C     KRST          READE     I0411L1                              8782    *82=EOF
      * Save previous selector values
     C                   MOVEL     #2SFX         WZSFX                          Document Pay It
     C                   MOVEL     #2SFXE        WZSFXE                         Pay Item Extens
     C                   MOVEL     #2DCTA        WZDCTA                         Document Type -
     C                   MOVEL     #2PYE         WZPYE                          Payee Address N
     C                   MOVEL     #2SNTO        WZSNTO                         Address Number
     C                   MOVEL     #2DIVJ        WZDIVJ                         Invoice Date -
     C                   MOVEL     #2DSVJ        WZDSVJ                         Service/Tax Dat
     C                   MOVEL     #2DDJ         WZDDJ                          Date - Net Due
     C                   MOVEL     #2DDNJ        WZDDNJ                         Discount Due Da
     C                   MOVEL     #2FY          WZFY                           Fiscal Year
     C                   MOVEL     #2CTRY        WZCTRY                         Century
     C                   MOVEL     #2PN          WZPN                           Period Number -
     C                   MOVEL     #2ICU         WZICU                          Batch Number
     C                   MOVEL     #2ICUT        WZICUT                         Batch Type
     C                   MOVEL     #2DICJ        WZDICJ                         Batch Date
     C                   MOVEL     #2BALJ        WZBALJ                         Journal Entries
     C                   MOVEL     #2PSTC        WZPSTC                         Pay Status Code
     C                   MOVEL     #2AG          WZAG                           Gross Amount
     C                   MOVEL     #2AAP         WZAAP                          Open Amount
     C                   MOVEL     #2ADSC        WZADSC                         Discount Availa
     C                   MOVEL     #2ADSA        WZADSA                         Discount Taken
     C                   MOVEL     #2ATXA        WZATXA                         Taxable Amount
     C                   MOVEL     #2ATXN        WZATXN                         Non-Taxable Amo
     C                   MOVEL     #2STAM        WZSTAM                         Tax Amount
     C                   MOVEL     #2TXA1        WZTXA1                         Tax Rate/Area
     C                   MOVEL     #2EXR1        WZEXR1                         Tax Expl Code 1
     C                   MOVEL     #2CRRM        WZCRRM                         Currency Mode
     C                   MOVEL     #2CRCD        WZCRCD                         Currency Code -
     C                   MOVEL     #2CRR         WZCRR                          Currency Conver
     C                   MOVEL     #2ACR         WZACR                          Currency Amount
     C                   MOVEL     #2FAP         WZFAP                          Foreign Open Am
     C                   MOVEL     #2CDS         WZCDS                          Foreign Disc Av
     C                   MOVEL     #2CDSA        WZCDSA                         Foreign Disc Ta
     C                   MOVEL     #2CTXA        WZCTXA                         Foreign Taxable
     C                   MOVEL     #2CTXN        WZCTXN                         Foreign Non-Tax
     C                   MOVEL     #2CTAM        WZCTAM                         Foreign Tax Amo
     C                   MOVEL     #2GLC         WZGLC                          G/L Offset
     C                   MOVEL     #2GLBA        WZGLBA                         G/L Bank Accoun
     C                   MOVEL     #2POST        WZPOST                         G/L Posted Flag
     C                   MOVEL     #2AM          WZAM                           Account Mode -
     C                   MOVEL     #2AID2        WZAID2                         Account ID 2
     C                   MOVEL     #2MCU         WZMCU                          Business Unit/C
     C                   MOVEL     #2OBJ         WZOBJ                          Object Account
     C                   MOVEL     #2SUB         WZSUB                          Subsidiary
     C                   MOVEL     #2SBLT        WZSBLT                         Subledger Type
     C                   MOVEL     #2SBL         WZSBL                          Subledger - G/L
     C                   MOVEL     #2BAID        WZBAID                         Bank Transit Sh
     C                   MOVEL     #2PTC         WZPTC                          Payment Terms C
     C                   MOVEL     #2VOD         WZVOD                          Void Flag
     C                   MOVEL     #2OKCO        WZOKCO                         Document Co - O
     C                   MOVEL     #2ODCT        WZODCT                         Document Type -
     C                   MOVEL     #2ODOC        WZODOC                         Document - Orig
     C                   MOVEL     #2OSFX        WZOSFX                         Document Pay It
     C                   MOVEL     #2CRC         WZCRC                          Payment Handlin
     C                   MOVEL     #2VINV        WZVINV                         Supplier Invoic
     C                   MOVEL     #2PKCO        WZPKCO                         Document Co - P
     C                   MOVEL     #2PO          WZPO                           Purchase Order
     C                   MOVEL     #2PDCT        WZPDCT                         Document Type -
     C                   MOVEL     #2LNID        WZLNID                         Line number
     C                   MOVEL     #2SFXO        WZSFXO                         Order Suffix
     C                   MOVEL     #2OPSQ        WZOPSQ                         Sequence Nbr -
     C                   MOVEL     #2VR01        WZVR01                         Reference
     C                   MOVEL     #2UNIT        WZUNIT                         Unit
     C                   MOVEL     #2MCU2        WZMCU2                         Business Unit 2
     C                   MOVEL     #2RMK         WZRMK                          Name - Remark
     C                   MOVEL     #2RF          WZRF                           Frequency - Rec
     C                   MOVEL     #2DRF         WZDRF                          Recurring Freq
     C                   MOVEL     #2CTL         WZCTL                          Control/Stateme
     C                   MOVEL     #2FNLP        WZFNLP                         Closed Item as
     C                   MOVEL     #2U           WZU                            Units
     C                   MOVEL     #2UM          WZUM                           Unit of Measure
     C                   MOVEL     #2PYIN        WZPYIN                         Payment Instrum
     C                   MOVEL     #2TXA3        WZTXA3                         Tax Rate Area 3
     C                   MOVEL     #2RP1         WZRP1                          A/R-A/P-Misc Co
     C                   MOVEL     #2RP2         WZRP2                          A/R-A/P-Misc Co
     C                   MOVEL     #2RP3         WZRP3                          A/R-A/P-Cash Rc
     C                   MOVEL     #2AC07        WZAC07                         Catg Code - Add
     C                   MOVEL     #2TNN         WZTNN                          Flag for 1099
     C                   MOVEL     #2DMCD        WZDMCD                         Dom Entry w/ Mu
     C                   MOVEL     #2ITM         WZITM                          Item Number - S
     C                   MOVEL     #2HCRR        WZHCRR                         Historical Curr
     C                   MOVEL     #2HDGJ        WZHDGJ                         Historical Date
     C                   MOVEL     #2URCD        WZURCD                         User Reserved C
     C                   MOVEL     #2URDT        WZURDT                         User Reserved D
     C                   MOVEL     #2URAT        WZURAT                         User Reserved A
     C                   MOVEL     #2URAB        WZURAB                         User Reserved N
     C                   MOVEL     #2URRF        WZURRF                         User Reserved R
     C                   MOVEL     #2TORG        WZTORG                         Transaction Ori
     C                   MOVEL     #2USER        WZUSER                         User ID
     C                   MOVEL     #2PID         WZPID                          Program ID
     C                   MOVEL     #2UPMJ        WZUPMJ                         Date - Updated
     C                   MOVEL     #2UPMT        WZUPMT                         Time - Last Upd
     C                   MOVEL     #2JOBN        WZJOBN                         Work Station ID
     C                   MOVEL     #2DIM         WZDIM                          Invoice Date -
     C                   MOVEL     #2DID         WZDID                          Invoice Date -
     C                   MOVEL     #2DIY         WZDIY                          Invoice Date -
     C                   MOVEL     #2DI#         WZDI#                          Invoice Date -
     C                   MOVEL     #2DSVM        WZDSVM                         Service/Tax Dat
     C                   MOVEL     #2DSVD        WZDSVD                         Service/Tax Dat
     C                   MOVEL     #2DSVY        WZDSVY                         Service/Tax Dat
     C                   MOVEL     #2DSV#        WZDSV#                         Service/Tax Dat
     C                   MOVEL     #2DDM         WZDDM                          Net Due Date -
     C                   MOVEL     #2DDDA        WZDDDA                         Net Due Date -
     C                   MOVEL     #2DDY         WZDDY                          Net Due Date -
     C                   MOVEL     #2DD#         WZDD#                          Net Due Date -
     C                   MOVEL     #2DDNM        WZDDNM                         Discount Due Da
     C                   MOVEL     #2DDND        WZDDND                         Discount Due Da
     C                   MOVEL     #2DDNY        WZDDNY                         Discount Due Da
     C                   MOVEL     #2DDN#        WZDDN#                         Discount Due Da
     C                   MOVEL     #2DGM         WZDGM                          G/L Date - MO
     C                   MOVEL     #2DGD         WZDGD                          G/L Date - DA
     C                   MOVEL     #2DGY         WZDGY                          G/L Date - YR
     C                   MOVEL     #2DG#         WZDG#                          G/L Date - CTRY
     C                   MOVEL     #2DICM        WZDICM                         Batch Date - MO
     C                   MOVEL     #2DICD        WZDICD                         Batch Date - DA
     C                   MOVEL     #2DICY        WZDICY                         Batch Date - YR
     C                   MOVEL     #2DIC#        WZDIC#                         Batch Date - CT
     C                   MOVEL     #2HDGM        WZHDGM                         Historical Date
     C                   MOVEL     #2HDGD        WZHDGD                         Historical Date
     C                   MOVEL     #2HDGY        WZHDGY                         Historical Date
     C                   MOVEL     #2HDG#        WZHDG#                         Historical Date
     C                   MOVEL     #2DOCM        WZDOCM                         Document Matchi
     C                   MOVEL     #2TNST        WZTNST                         Bank Transit Nu
     C                   MOVEL     #2YC01        WZYC01                         Catg Code - A/P
     C                   MOVEL     #2YC02        WZYC02                         Catg Code - A/P
     C                   MOVEL     #2YC03        WZYC03                         Catg Code - A/P
     C                   MOVEL     #2YC04        WZYC04                         Catg Code - A/P
     C                   MOVEL     #2YC05        WZYC05                         Catg Code - A/P
     C                   MOVEL     #2YC06        WZYC06                         Catg Code - A/P
     C                   MOVEL     #2YC07        WZYC07                         Catg Code - A/P
     C                   MOVEL     #2YC08        WZYC08                         Catg Code - A/P
     C                   MOVEL     #2YC09        WZYC09                         Catg Code - A/P
     C                   MOVEL     #2YC10        WZYC10                         Catg Code - A/P
     C                   MOVEL     #2DTXS        WZDTXS                         Deferred Tax St
     C                   MOVEL     #2BCRC        WZBCRC                         Base Currency C
     C                   MOVEL     #2ATAD        WZATAD                         Amount To Distr
     C                   MOVEL     #2CTAD        WZCTAD                         Currency to Dis
     C                   MOVEL     #2NRTA        WZNRTA                         Non-Recoverable
     C                   MOVEL     #2FNRT        WZFNRT                         Non-Recoverable
     C                   MOVEL     #2TAXP        WZTAXP                         Purchasing Taxa
     C                   MOVEL     #2PRGF        WZPRGF                         Purge Flag
     C                   MOVEL     #2GFL5        WZGFL5                         Generic Flag 5
     C                   MOVEL     #2GFL6        WZGFL6                         Generic Flag 6
     C                   MOVEL     #2GAM1        WZGAM1                         Generic Amount
     C                   MOVEL     #2GAM2        WZGAM2                         Generic Amount
     C                   MOVEL     #2GEN4        WZGEN4                         Generic String
     C                   MOVEL     #2GEN5        WZGEN5                         Generic String
     C                   MOVEL     #2WTAD        WZWTAD                         Future W/H Tax
     C                   MOVEL     #2WTAF        WZWTAF                         Future W/H Tax
     C                   MOVEL     #2SMMF        WZSMMF                         Summarized Flag
     C                   MOVEL     #2PYWP        WZPYWP                         Pay When Paid
     C                   MOVEL     #2PWPG        WZPWPG                         Pay When Paid G
     C                   MOVEL     #2NETS        WZNETS                         Netting Status
     C                   MOVEL     #2ATFL        WZATFL                         Automation Flag
     C                   MOVEL     #2ATRL        WZATRL                         Automation Rule
     C                   MOVEL     #2JOBS        WZJOBS                         Job Number
     C                   MOVEL     #2PSTE        WZPSTE                         Process Type
     C                   MOVEL     #2DWST        WZDWST                         Record Status
     C                   MOVEL     #2ABDT        WZABDT                         Create Date
     C                   MOVEL     #2ABTM        WZABTM                         Create Time
     C                   MOVEL     #2AJVN        WZAJVN                         Create User
     C                   MOVEL     #2AKVN        WZAKVN                         Create Program
     C                   MOVEL     #2ACDT        WZACDT                         Change Date
     C                   MOVEL     #2ACTM        WZACTM                         Change Time
     C                   MOVEL     #2ALVN        WZALVN                         Change User
     C                   MOVEL     #2DOC         WZDOC                          Document Number
     C                   MOVEL     #2KCO         WZKCO                          Document Compan
     C                   MOVEL     #2EDUS        WZEDUS                         EDI - User ID
     C                   MOVEL     #2EDBT        WZEDBT                         EDI - Batch Num
     C                   MOVEL     #2EDTN        WZEDTN                         EDI - Transacti
     C                   MOVEL     #2EDLN        WZEDLN                         EDI - Line Numb
     C                   MOVEL     #2EDSP        WZEDSP                         EDI - Successfu
     C                   MOVEL     #2CO          WZCO                           Company
     C                   MOVEL     #2DCT         WZDCT                          Document Type
     C                   MOVEL     #2DGJ         WZDGJ                          G/L Date
     C                   MOVEL     #2AN8         WZAN8                          Address Number
     C                   MOVEL     #2O6TX        WZO6TX                         E1 Process Erro
     C                   MOVEL     #2O7TX        WZO7TX                         E1 Process Erro
      * Translate search mask for text field
     C                   MOVEL     'QSYST'       WQB10X
     C                   MOVE      'RNTBL'       WQB10X
     C                   CALL      'QDCXLATE'
      * Length
     C                   PARM      7             WQA5N
     C                   PARM      #2O6TX        WQO6TX                         E1 Process Erro
     C                   PARM                    WQB10X                         QSYSTRNTBL
     C                   PARM      'QSYS'        WQC10X
     C                   CALL      'QDCXLATE'
      * Length
     C                   PARM      25            WQA5N
     C                   PARM      #2O7TX        WQO7TX                         E1 Process Erro
     C                   PARM                    WQB10X                         QSYSTRNTBL
     C                   PARM      'QSYS'        WQC10X
      * Load subfile page
     C                   Z-ADD     0             ##RROK
     C                   EXSR      BBLDSF
      *================================================================
     CSR   BAEXIT        ENDSR
      /EJECT
     CSR   BBLDSF        BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27
     COR 08              DO
     C  N82              READP     I0411L1                                90    *
     C  N82              READ      I0411L1                                90    *
     C                   END
      *
      * Setof record error indicators
     C                   MOVEL     *ALL'0'       WKIND0
     C                   MOVEA     WKIND0        *IN(36)
      * Start at previous highest record in SFL
     C                   Z-ADD     ##RRMX        ##RR
      * Reset count of DBF records read
     C                   Z-ADD     0             ##RRRD
      * Set required pages based on *Set Cursor or *Subfile Pages
     C                   IF        W0RR0 > 0
     C     W0RR0         DIV       ##SFPG        ##SPG
     C                   MVR                     ##SLIN
     C                   IF        ##SLIN > 0
     C                   ADD       1             ##SPG
     C                   END
     C                   IF        W0SPG > ##SPG
     C                   Z-ADD     W0SPG         ##SPG
     C                   END
     C                   ELSE
     C                   Z-ADD     W0SPG         ##SPG
     C                   END
      * Compute lines required based on pages
     C     ##SPG         MULT      ##SFPG        ##SFLN
     C                   IF        ##SFLN > 999
     C                   Z-ADD     999           ##SFLN
     C                   END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
      * Check selection fields - if fail, read next record
     C                   DOW       NOT *IN82 AND
     C                             ##RROK < ##SFLN AND
     C                             ##RRRD < W0SLM
     C                   IF        #2SFX <> ' '
     C     ELSFX         CABNE     #2SFX         BB020                          Document Pay It
     C                   END
     C                   IF        #2SFXE <> *ZERO
     C     ELSFXE        CABNE     #2SFXE        BB020                          Pay Item Extens
     C                   END
     C                   IF        #2DCTA <> ' '
     C     ELDCTA        CABNE     #2DCTA        BB020                          Document Type -
     C                   END
     C                   IF        #2PYE <> *ZERO
     C     ELPYE         CABNE     #2PYE         BB020                          Payee Address N
     C                   END
     C                   IF        #2SNTO <> *ZERO
     C     ELSNTO        CABNE     #2SNTO        BB020                          Address Number
     C                   END
     C                   IF        #2DIVJ <> *ZERO
     C     ELDIVJ        CABNE     #2DIVJ        BB020                          Invoice Date -
     C                   END
     C                   IF        #2DSVJ <> *ZERO
     C     ELDSVJ        CABNE     #2DSVJ        BB020                          Service/Tax Dat
     C                   END
     C                   IF        #2DDJ <> *ZERO
     C     ELDDJ         CABNE     #2DDJ         BB020                          Date - Net Due
     C                   END
     C                   IF        #2DDNJ <> *ZERO
     C     ELDDNJ        CABNE     #2DDNJ        BB020                          Discount Due Da
     C                   END
     C                   IF        #2FY <> *ZERO
     C     ELFY          CABNE     #2FY          BB020                          Fiscal Year
     C                   END
     C                   IF        #2CTRY <> *ZERO
     C     ELCTRY        CABNE     #2CTRY        BB020                          Century
     C                   END
     C                   IF        #2PN <> *ZERO
     C     ELPN          CABNE     #2PN          BB020                          Period Number -
     C                   END
     C                   IF        #2ICU <> *ZERO
     C     ELICU         CABNE     #2ICU         BB020                          Batch Number
     C                   END
     C                   IF        #2ICUT <> ' '
     C     ELICUT        CABNE     #2ICUT        BB020                          Batch Type
     C                   END
     C                   IF        #2DICJ <> *ZERO
     C     ELDICJ        CABNE     #2DICJ        BB020                          Batch Date
     C                   END
     C                   IF        #2BALJ <> ' '
     C     ELBALJ        CABNE     #2BALJ        BB020                          Journal Entries
     C                   END
     C                   IF        #2PSTC <> ' '
     C     ELPSTC        CABNE     #2PSTC        BB020                          Pay Status Code
     C                   END
     C                   IF        #2AG <> *ZERO
     C     ELAG          CABNE     #2AG          BB020                          Gross Amount
     C                   END
     C                   IF        #2AAP <> *ZERO
     C     ELAAP         CABNE     #2AAP         BB020                          Open Amount
     C                   END
     C                   IF        #2ADSC <> *ZERO
     C     ELADSC        CABNE     #2ADSC        BB020                          Discount Availa
     C                   END
     C                   IF        #2ADSA <> *ZERO
     C     ELADSA        CABNE     #2ADSA        BB020                          Discount Taken
     C                   END
     C                   IF        #2ATXA <> *ZERO
     C     ELATXA        CABNE     #2ATXA        BB020                          Taxable Amount
     C                   END
     C                   IF        #2ATXN <> *ZERO
     C     ELATXN        CABNE     #2ATXN        BB020                          Non-Taxable Amo
     C                   END
     C                   IF        #2STAM <> *ZERO
     C     ELSTAM        CABNE     #2STAM        BB020                          Tax Amount
     C                   END
     C                   IF        #2TXA1 <> ' '
     C     ELTXA1        CABNE     #2TXA1        BB020                          Tax Rate/Area
     C                   END
     C                   IF        #2EXR1 <> ' '
     C     ELEXR1        CABNE     #2EXR1        BB020                          Tax Expl Code 1
     C                   END
     C                   IF        #2CRRM <> ' '
     C     ELCRRM        CABNE     #2CRRM        BB020                          Currency Mode
     C                   END
     C                   IF        #2CRCD <> ' '
     C     ELCRCD        CABNE     #2CRCD        BB020                          Currency Code -
     C                   END
     C                   IF        #2CRR <> *ZERO
     C     ELCRR         CABNE     #2CRR         BB020                          Currency Conver
     C                   END
     C                   IF        #2ACR <> *ZERO
     C     ELACR         CABNE     #2ACR         BB020                          Currency Amount
     C                   END
     C                   IF        #2FAP <> *ZERO
     C     ELFAP         CABNE     #2FAP         BB020                          Foreign Open Am
     C                   END
     C                   IF        #2CDS <> *ZERO
     C     ELCDS         CABNE     #2CDS         BB020                          Foreign Disc Av
     C                   END
     C                   IF        #2CDSA <> *ZERO
     C     ELCDSA        CABNE     #2CDSA        BB020                          Foreign Disc Ta
     C                   END
     C                   IF        #2CTXA <> *ZERO
     C     ELCTXA        CABNE     #2CTXA        BB020                          Foreign Taxable
     C                   END
     C                   IF        #2CTXN <> *ZERO
     C     ELCTXN        CABNE     #2CTXN        BB020                          Foreign Non-Tax
     C                   END
     C                   IF        #2CTAM <> *ZERO
     C     ELCTAM        CABNE     #2CTAM        BB020                          Foreign Tax Amo
     C                   END
     C                   IF        #2GLC <> ' '
     C     ELGLC         CABNE     #2GLC         BB020                          G/L Offset
     C                   END
     C                   IF        #2GLBA <> ' '
     C     ELGLBA        CABNE     #2GLBA        BB020                          G/L Bank Accoun
     C                   END
     C                   IF        #2POST <> ' '
     C     ELPOST        CABNE     #2POST        BB020                          G/L Posted Flag
     C                   END
     C                   IF        #2AM <> ' '
     C     ELAM          CABNE     #2AM          BB020                          Account Mode -
     C                   END
     C                   IF        #2AID2 <> ' '
     C     ELAID2        CABNE     #2AID2        BB020                          Account ID 2
     C                   END
     C                   IF        #2MCU <> ' '
     C     ELMCU         CABNE     #2MCU         BB020                          Business Unit/C
     C                   END
     C                   IF        #2OBJ <> ' '
     C     ELOBJ         CABNE     #2OBJ         BB020                          Object Account
     C                   END
     C                   IF        #2SUB <> ' '
     C     ELSUB         CABNE     #2SUB         BB020                          Subsidiary
     C                   END
     C                   IF        #2SBLT <> ' '
     C     ELSBLT        CABNE     #2SBLT        BB020                          Subledger Type
     C                   END
     C                   IF        #2SBL <> ' '
     C     ELSBL         CABNE     #2SBL         BB020                          Subledger - G/L
     C                   END
     C                   IF        #2BAID <> ' '
     C     ELBAID        CABNE     #2BAID        BB020                          Bank Transit Sh
     C                   END
     C                   IF        #2PTC <> ' '
     C     ELPTC         CABNE     #2PTC         BB020                          Payment Terms C
     C                   END
     C                   IF        #2VOD <> ' '
     C     ELVOD         CABNE     #2VOD         BB020                          Void Flag
     C                   END
     C                   IF        #2OKCO <> ' '
     C     ELOKCO        CABNE     #2OKCO        BB020                          Document Co - O
     C                   END
     C                   IF        #2ODCT <> ' '
     C     ELODCT        CABNE     #2ODCT        BB020                          Document Type -
     C                   END
     C                   IF        #2ODOC <> *ZERO
     C     ELODOC        CABNE     #2ODOC        BB020                          Document - Orig
     C                   END
     C                   IF        #2OSFX <> ' '
     C     ELOSFX        CABNE     #2OSFX        BB020                          Document Pay It
     C                   END
     C                   IF        #2CRC <> ' '
     C     ELCRC         CABNE     #2CRC         BB020                          Payment Handlin
     C                   END
     C                   IF        #2VINV <> ' '
     C     ELVINV        CABNE     #2VINV        BB020                          Supplier Invoic
     C                   END
     C                   IF        #2PKCO <> ' '
     C     ELPKCO        CABNE     #2PKCO        BB020                          Document Co - P
     C                   END
     C                   IF        #2PO <> ' '
     C     ELPO          CABNE     #2PO          BB020                          Purchase Order
     C                   END
     C                   IF        #2PDCT <> ' '
     C     ELPDCT        CABNE     #2PDCT        BB020                          Document Type -
     C                   END
     C                   IF        #2LNID <> *ZERO
     C     ELLNID        CABNE     #2LNID        BB020                          Line number
     C                   END
     C                   IF        #2SFXO <> ' '
     C     ELSFXO        CABNE     #2SFXO        BB020                          Order Suffix
     C                   END
     C                   IF        #2OPSQ <> *ZERO
     C     ELOPSQ        CABNE     #2OPSQ        BB020                          Sequence Nbr -
     C                   END
     C                   IF        #2VR01 <> ' '
     C     ELVR01        CABNE     #2VR01        BB020                          Reference
     C                   END
     C                   IF        #2UNIT <> ' '
     C     ELUNIT        CABNE     #2UNIT        BB020                          Unit
     C                   END
     C                   IF        #2MCU2 <> ' '
     C     ELMCU2        CABNE     #2MCU2        BB020                          Business Unit 2
     C                   END
     C                   IF        #2RMK <> ' '
     C     ELRMK         CABNE     #2RMK         BB020                          Name - Remark
     C                   END
     C                   IF        #2RF <> ' '
     C     ELRF          CABNE     #2RF          BB020                          Frequency - Rec
     C                   END
     C                   IF        #2DRF <> *ZERO
     C     ELDRF         CABNE     #2DRF         BB020                          Recurring Freq
     C                   END
     C                   IF        #2CTL <> ' '
     C     ELCTL         CABNE     #2CTL         BB020                          Control/Stateme
     C                   END
     C                   IF        #2FNLP <> ' '
     C     ELFNLP        CABNE     #2FNLP        BB020                          Closed Item as
     C                   END
     C                   IF        #2U <> *ZERO
     C     ELU           CABNE     #2U           BB020                          Units
     C                   END
     C                   IF        #2UM <> ' '
     C     ELUM          CABNE     #2UM          BB020                          Unit of Measure
     C                   END
     C                   IF        #2PYIN <> ' '
     C     ELPYIN        CABNE     #2PYIN        BB020                          Payment Instrum
     C                   END
     C                   IF        #2TXA3 <> ' '
     C     ELTXA3        CABNE     #2TXA3        BB020                          Tax Rate Area 3
     C                   END
     C                   IF        #2RP1 <> ' '
     C     ELRP1         CABNE     #2RP1         BB020                          A/R-A/P-Misc Co
     C                   END
     C                   IF        #2RP2 <> ' '
     C     ELRP2         CABNE     #2RP2         BB020                          A/R-A/P-Misc Co
     C                   END
     C                   IF        #2RP3 <> ' '
     C     ELRP3         CABNE     #2RP3         BB020                          A/R-A/P-Cash Rc
     C                   END
     C                   IF        #2AC07 <> ' '
     C     ELAC07        CABNE     #2AC07        BB020                          Catg Code - Add
     C                   END
     C                   IF        #2TNN <> ' '
     C     ELTNN         CABNE     #2TNN         BB020                          Flag for 1099
     C                   END
     C                   IF        #2DMCD <> ' '
     C     ELDMCD        CABNE     #2DMCD        BB020                          Dom Entry w/ Mu
     C                   END
     C                   IF        #2ITM <> *ZERO
     C     ELITM         CABNE     #2ITM         BB020                          Item Number - S
     C                   END
     C                   IF        #2HCRR <> *ZERO
     C     ELHCRR        CABNE     #2HCRR        BB020                          Historical Curr
     C                   END
     C                   IF        #2HDGJ <> *ZERO
     C     ELHDGJ        CABNE     #2HDGJ        BB020                          Historical Date
     C                   END
     C                   IF        #2URCD <> ' '
     C     ELURCD        CABNE     #2URCD        BB020                          User Reserved C
     C                   END
     C                   IF        #2URDT <> *ZERO
     C     ELURDT        CABNE     #2URDT        BB020                          User Reserved D
     C                   END
     C                   IF        #2URAT <> *ZERO
     C     ELURAT        CABNE     #2URAT        BB020                          User Reserved A
     C                   END
     C                   IF        #2URAB <> *ZERO
     C     ELURAB        CABNE     #2URAB        BB020                          User Reserved N
     C                   END
     C                   IF        #2URRF <> ' '
     C     ELURRF        CABNE     #2URRF        BB020                          User Reserved R
     C                   END
     C                   IF        #2TORG <> ' '
     C     ELTORG        CABNE     #2TORG        BB020                          Transaction Ori
     C                   END
     C                   IF        #2USER <> ' '
     C     ELUSER        CABNE     #2USER        BB020                          User ID
     C                   END
     C                   IF        #2PID <> ' '
     C     ELPID         CABNE     #2PID         BB020                          Program ID
     C                   END
     C                   IF        #2UPMJ <> *ZERO
     C     ELUPMJ        CABNE     #2UPMJ        BB020                          Date - Updated
     C                   END
     C                   IF        #2UPMT <> *ZERO
     C     ELUPMT        CABNE     #2UPMT        BB020                          Time - Last Upd
     C                   END
     C                   IF        #2JOBN <> ' '
     C     ELJOBN        CABNE     #2JOBN        BB020                          Work Station ID
     C                   END
     C                   IF        #2DIM <> *ZERO
     C     ELDIM         CABNE     #2DIM         BB020                          Invoice Date -
     C                   END
     C                   IF        #2DID <> *ZERO
     C     ELDID         CABNE     #2DID         BB020                          Invoice Date -
     C                   END
     C                   IF        #2DIY <> *ZERO
     C     ELDIY         CABNE     #2DIY         BB020                          Invoice Date -
     C                   END
     C                   IF        #2DI# <> *ZERO
     C     ELDI#         CABNE     #2DI#         BB020                          Invoice Date -
     C                   END
     C                   IF        #2DSVM <> *ZERO
     C     ELDSVM        CABNE     #2DSVM        BB020                          Service/Tax Dat
     C                   END
     C                   IF        #2DSVD <> *ZERO
     C     ELDSVD        CABNE     #2DSVD        BB020                          Service/Tax Dat
     C                   END
     C                   IF        #2DSVY <> *ZERO
     C     ELDSVY        CABNE     #2DSVY        BB020                          Service/Tax Dat
     C                   END
     C                   IF        #2DSV# <> *ZERO
     C     ELDSV#        CABNE     #2DSV#        BB020                          Service/Tax Dat
     C                   END
     C                   IF        #2DDM <> *ZERO
     C     ELDDM         CABNE     #2DDM         BB020                          Net Due Date -
     C                   END
     C                   IF        #2DDDA <> *ZERO
     C     ELDDDA        CABNE     #2DDDA        BB020                          Net Due Date -
     C                   END
     C                   IF        #2DDY <> *ZERO
     C     ELDDY         CABNE     #2DDY         BB020                          Net Due Date -
     C                   END
     C                   IF        #2DD# <> *ZERO
     C     ELDD#         CABNE     #2DD#         BB020                          Net Due Date -
     C                   END
     C                   IF        #2DDNM <> *ZERO
     C     ELDDNM        CABNE     #2DDNM        BB020                          Discount Due Da
     C                   END
     C                   IF        #2DDND <> *ZERO
     C     ELDDND        CABNE     #2DDND        BB020                          Discount Due Da
     C                   END
     C                   IF        #2DDNY <> *ZERO
     C     ELDDNY        CABNE     #2DDNY        BB020                          Discount Due Da
     C                   END
     C                   IF        #2DDN# <> *ZERO
     C     ELDDN#        CABNE     #2DDN#        BB020                          Discount Due Da
     C                   END
     C                   IF        #2DGM <> *ZERO
     C     ELDGM         CABNE     #2DGM         BB020                          G/L Date - MO
     C                   END
     C                   IF        #2DGD <> *ZERO
     C     ELDGD         CABNE     #2DGD         BB020                          G/L Date - DA
     C                   END
     C                   IF        #2DGY <> *ZERO
     C     ELDGY         CABNE     #2DGY         BB020                          G/L Date - YR
     C                   END
     C                   IF        #2DG# <> *ZERO
     C     ELDG#         CABNE     #2DG#         BB020                          G/L Date - CTRY
     C                   END
     C                   IF        #2DICM <> *ZERO
     C     ELDICM        CABNE     #2DICM        BB020                          Batch Date - MO
     C                   END
     C                   IF        #2DICD <> *ZERO
     C     ELDICD        CABNE     #2DICD        BB020                          Batch Date - DA
     C                   END
     C                   IF        #2DICY <> *ZERO
     C     ELDICY        CABNE     #2DICY        BB020                          Batch Date - YR
     C                   END
     C                   IF        #2DIC# <> *ZERO
     C     ELDIC#        CABNE     #2DIC#        BB020                          Batch Date - CT
     C                   END
     C                   IF        #2HDGM <> *ZERO
     C     ELHDGM        CABNE     #2HDGM        BB020                          Historical Date
     C                   END
     C                   IF        #2HDGD <> *ZERO
     C     ELHDGD        CABNE     #2HDGD        BB020                          Historical Date
     C                   END
     C                   IF        #2HDGY <> *ZERO
     C     ELHDGY        CABNE     #2HDGY        BB020                          Historical Date
     C                   END
     C                   IF        #2HDG# <> *ZERO
     C     ELHDG#        CABNE     #2HDG#        BB020                          Historical Date
     C                   END
     C                   IF        #2DOCM <> *ZERO
     C     ELDOCM        CABNE     #2DOCM        BB020                          Document Matchi
     C                   END
     C                   IF        #2TNST <> ' '
     C     ELTNST        CABNE     #2TNST        BB020                          Bank Transit Nu
     C                   END
     C                   IF        #2YC01 <> ' '
     C     ELYC01        CABNE     #2YC01        BB020                          Catg Code - A/P
     C                   END
     C                   IF        #2YC02 <> ' '
     C     ELYC02        CABNE     #2YC02        BB020                          Catg Code - A/P
     C                   END
     C                   IF        #2YC03 <> ' '
     C     ELYC03        CABNE     #2YC03        BB020                          Catg Code - A/P
     C                   END
     C                   IF        #2YC04 <> ' '
     C     ELYC04        CABNE     #2YC04        BB020                          Catg Code - A/P
     C                   END
     C                   IF        #2YC05 <> ' '
     C     ELYC05        CABNE     #2YC05        BB020                          Catg Code - A/P
     C                   END
     C                   IF        #2YC06 <> ' '
     C     ELYC06        CABNE     #2YC06        BB020                          Catg Code - A/P
     C                   END
     C                   IF        #2YC07 <> ' '
     C     ELYC07        CABNE     #2YC07        BB020                          Catg Code - A/P
     C                   END
     C                   IF        #2YC08 <> ' '
     C     ELYC08        CABNE     #2YC08        BB020                          Catg Code - A/P
     C                   END
     C                   IF        #2YC09 <> ' '
     C     ELYC09        CABNE     #2YC09        BB020                          Catg Code - A/P
     C                   END
     C                   IF        #2YC10 <> ' '
     C     ELYC10        CABNE     #2YC10        BB020                          Catg Code - A/P
     C                   END
     C                   IF        #2DTXS <> ' '
     C     ELDTXS        CABNE     #2DTXS        BB020                          Deferred Tax St
     C                   END
     C                   IF        #2BCRC <> ' '
     C     ELBCRC        CABNE     #2BCRC        BB020                          Base Currency C
     C                   END
     C                   IF        #2ATAD <> *ZERO
     C     ELATAD        CABNE     #2ATAD        BB020                          Amount To Distr
     C                   END
     C                   IF        #2CTAD <> *ZERO
     C     ELCTAD        CABNE     #2CTAD        BB020                          Currency to Dis
     C                   END
     C                   IF        #2NRTA <> *ZERO
     C     ELNRTA        CABNE     #2NRTA        BB020                          Non-Recoverable
     C                   END
     C                   IF        #2FNRT <> *ZERO
     C     ELFNRT        CABNE     #2FNRT        BB020                          Non-Recoverable
     C                   END
     C                   IF        #2TAXP <> ' '
     C     ELTAXP        CABNE     #2TAXP        BB020                          Purchasing Taxa
     C                   END
     C                   IF        #2PRGF <> ' '
     C     ELPRGF        CABNE     #2PRGF        BB020                          Purge Flag
     C                   END
     C                   IF        #2GFL5 <> ' '
     C     ELGFL5        CABNE     #2GFL5        BB020                          Generic Flag 5
     C                   END
     C                   IF        #2GFL6 <> ' '
     C     ELGFL6        CABNE     #2GFL6        BB020                          Generic Flag 6
     C                   END
     C                   IF        #2GAM1 <> *ZERO
     C     ELGAM1        CABNE     #2GAM1        BB020                          Generic Amount
     C                   END
     C                   IF        #2GAM2 <> *ZERO
     C     ELGAM2        CABNE     #2GAM2        BB020                          Generic Amount
     C                   END
     C                   IF        #2GEN4 <> ' '
     C     ELGEN4        CABNE     #2GEN4        BB020                          Generic String
     C                   END
     C                   IF        #2GEN5 <> ' '
     C     ELGEN5        CABNE     #2GEN5        BB020                          Generic String
     C                   END
     C                   IF        #2WTAD <> *ZERO
     C     ELWTAD        CABNE     #2WTAD        BB020                          Future W/H Tax
     C                   END
     C                   IF        #2WTAF <> *ZERO
     C     ELWTAF        CABNE     #2WTAF        BB020                          Future W/H Tax
     C                   END
     C                   IF        #2SMMF <> ' '
     C     ELSMMF        CABNE     #2SMMF        BB020                          Summarized Flag
     C                   END
     C                   IF        #2PYWP <> ' '
     C     ELPYWP        CABNE     #2PYWP        BB020                          Pay When Paid
     C                   END
     C                   IF        #2PWPG <> *ZERO
     C     ELPWPG        CABNE     #2PWPG        BB020                          Pay When Paid G
     C                   END
     C                   IF        #2NETS <> ' '
     C     ELNETS        CABNE     #2NETS        BB020                          Netting Status
     C                   END
     C                   IF        #2ATFL <> ' '
     C     ELATFL        CABNE     #2ATFL        BB020                          Automation Flag
     C                   END
     C                   IF        #2ATRL <> ' '
     C     ELATRL        CABNE     #2ATRL        BB020                          Automation Rule
     C                   END
     C                   IF        #2JOBS <> *ZERO
     C     ELJOBS        CABNE     #2JOBS        BB020                          Job Number
     C                   END
     C                   IF        #2PSTE <> ' '
     C     ELPSTE        CABNE     #2PSTE        BB020                          Process Type
     C                   END
     C                   IF        #2DWST <> ' '
     C     ELDWST        CABNE     #2DWST        BB020                          Record Status
     C                   END
     C                   IF        #2ABDT <> *ZERO
     C     ELABDT        CABNE     #2ABDT        BB020                          Create Date
     C                   END
     C                   IF        #2ABTM <> *ZERO
     C     ELABTM        CABNE     #2ABTM        BB020                          Create Time
     C                   END
     C                   IF        #2AJVN <> ' '
     C     ELAJVN        CABNE     #2AJVN        BB020                          Create User
     C                   END
     C                   IF        #2AKVN <> ' '
     C     ELAKVN        CABNE     #2AKVN        BB020                          Create Program
     C                   END
     C                   IF        #2ACDT <> *ZERO
     C     ELACDT        CABNE     #2ACDT        BB020                          Change Date
     C                   END
     C                   IF        #2ACTM <> *ZERO
     C     ELACTM        CABNE     #2ACTM        BB020                          Change Time
     C                   END
     C                   IF        #2ALVN <> ' '
     C     ELALVN        CABNE     #2ALVN        BB020                          Change User
     C                   END
     C                   IF        #2DOC <> *ZERO
     C     ELDOC         CABNE     #2DOC         BB020                          Document Number
     C                   END
     C                   IF        #2KCO <> ' '
     C     ELKCO         CABNE     #2KCO         BB020                          Document Compan
     C                   END
     C                   IF        #2EDTN = ' '
     C                   IF        #2EDLN <> *ZERO
     C     ELEDLN        CABNE     #2EDLN        BB020                          EDI - Line Numb
     C                   END
     C                   END
     C                   IF        #2EDSP <> ' '
     C     ELEDSP        CABNE     #2EDSP        BB020                          EDI - Successfu
     C                   END
     C                   IF        #2CO <> ' '
     C     ELCO          CABNE     #2CO          BB020                          Company
     C                   END
     C                   IF        #2DCT <> ' '
     C     ELDCT         CABNE     #2DCT         BB020                          Document Type
     C                   END
     C                   IF        #2DGJ <> *ZERO
     C     ELDGJ         CABNE     #2DGJ         BB020                          G/L Date
     C                   END
     C                   IF        #2AN8 <> *ZERO
     C     ELAN8         CABNE     #2AN8         BB020                          Address Number
     C                   END
      * Scan for search string
     C                   IF        #2O6TX <> ' '
     C                   CALL      'QCLSCAN'
     C                   PARM                    ELO6TX                         E1 Process Erro
      * Length
     C                   PARM      7             WQA3N
      * Start
     C                   PARM      1             WQB3N
      * Mask
     C                   PARM                    WQO6TX
      * Length
     C                   PARM      7             WQC3N
      * Translate
     C                   PARM      '1'           WQD1
      * Trim
     C                   PARM      '1'           WQE1
      * Wild
     C                   PARM      '?'           WQF1
      * Result
     C                   PARM                    WQG3N
     C     WQG3N         CABLT     1             BB020
     C                   END
      * Scan for search string
     C                   IF        #2O7TX <> ' '
     C                   CALL      'QCLSCAN'
     C                   PARM                    ELO7TX                         E1 Process Erro
      * Length
     C                   PARM      25            WQA3N
      * Start
     C                   PARM      1             WQB3N
      * Mask
     C                   PARM                    WQO7TX
      * Length
     C                   PARM      25            WQC3N
      * Translate
     C                   PARM      '1'           WQD1
      * Trim
     C                   PARM      '1'           WQE1
      * Wild
     C                   PARM      '?'           WQF1
      * Result
     C                   PARM                    WQG3N
     C     WQG3N         CABLT     1             BB020
     C                   END
      * Load SFL fields
     C                   EXSR      MBFL#1
     C                   MOVEL     'Y'           W0RSL
      * Allow for possible *Set Cursor processing
     C                   ADD       1             ##RR
      * USER: Initialize subfile record from DBF record
      * S17068 DN 06/04/21-Replaced 'USR Amount 9.2' with 'USR Amount 11.
     C                   Z-ADD     #1AG          #RCAVA                         USR Amount 11.2
     C                   Z-ADD     #1DGJ         YL0001                         USR Date Julian
      * Get MDY from JUL    X0028 - STR X* RPG Programs  * 
     C                   CALL      'E10028C'                            90      Get MDY from JU
     C                   PARM      YL0001        WQ0001                         USR Date Julian
     C     #RAFDT        PARM      *ZERO         WQ0002                         USR Date cyymmd
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'E10028C'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        98        *
     C                   END
     C                   SUB       1             ##RR
      * DBF record not selected
     C     W0RSL         CABNE     'Y'           BB020
      * Convert fields to external form
     C                   EXSR      MNCV#1
      * Output to subfile
     C                   ADD       1             ##RR
     C                   ADD       1             ##RROK               81        *
      * If SFLRCD invalid, note that errors present
     C   98
     CANN99              SETON                                        99        *
     C                   WRITE     #SFLRCD
     C     BB020         TAG
      * Increment scan check count
     C                   ADD       1             ##RRRD
     C     KRST          READE     I0411L1                                82    *82=EOF
     C                   END                                                    OD 1 - ##SFPG
      *................................................................
     C     BB900         TAG
      *................................................................
      * If no DBF records found, display error message
      * Send message '*No data to display'
     C                   IF        ##RR = *ZERO AND
     C                             *IN82
     C                   MOVEL     'Y2U0008'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END                                                    FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
      * Calculate top line
     C                   IF        ##RR > ##RRMX
     C     ##RROK        DIV       ##SFPG        ##SPG
     C                   MVR                     ##SLIN
     C                   IF        ##SLIN > 0
     C     ##RR          SUB       ##SLIN        ##SFRC
     C                   ELSE
     C     ##RR          SUB       ##SFPG        ##SFRC
     C                   END
     C                   ADD       1             ##SFRC
     C                   Z-ADD     ##RR          ##RRMX
     C                   END
      * If scan limit reached, display error message
      * Send message '*Scan limit reached'
     C                   IF        ##RRRD >= W0SLM
     C                   MOVEL     'Y2U0017'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   ELSE
     C                   Z-ADD     0             ##RROK
     C                   END
      *================================================================
     CSR   BBEXIT        ENDSR
      /EJECT
     CSR   CAEXFM        BEGSR
      *================================================================
      * Display screen
      *================================================================
     C                   DOU       W0HLP = 'N'
     C                   MOVEL     'N'           W0HLP
     C                   MOVE      *IN04         YPMT04
     C                   MOVE      *IN25         HELP25
     C                   MOVE      *ALL'0'       ##OFF
     C                   MOVEA     ##OFF         *IN(1)
     C                   MOVE      YPMT04        *IN04
     C                   MOVE      HELP25        *IN25
      * Update screen time
     C                   TIME                    ##TME
      * PUTOVR unless conditioned fields change
     C                   SETON                                        86
     C                   IF        *IN81 <> CAIN81
     C                   SETOFF                                       86
     C                   END
     C                   MOVE      *IN81         CAIN81
      * Set cursor by *SET CURSOR data
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y0SET
     C                   END
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                   MOVE      ##SFM         *IN02
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   EXFMT     #SFLCTL
      * Maintain subfile position where possible
     C                   IF        @#SFRC > *ZERO
     C                   Z-ADD     @#SFRC        ##SFRC
     C                   END
      * Test cursor
     C                   EXSR      Y8TST
      * Check if prompt requested
     C                   EXSR      ZDVPMT
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
     C                   END
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   SETOFF                                         8392    *
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y9CLR
     C                   END
      *================================================================
     CSR   CAEXIT        ENDSR
      /EJECT
     CSR   DAPR##        BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                   MOVEL     'N'           W0DCF
     C                   IF        YPMTFD <> ' ' AND
     C                             YPMRRN = *ZERO
     C                   GOTO      DAEXIT
     C                   END
     C     YPMTFD        CABNE     *BLANKS       DATAG1
      * Change of position specified
     C     WZEDTN        CASNE     #2EDTN        FBRQRL
     C     WZEDLN        CASNE     #2EDLN        FBRQRL
     C     WZEDSP        CASNE     #2EDSP        FBRQRL
     C     WZCO          CASNE     #2CO          FBRQRL
     C     WZDCT         CASNE     #2DCT         FBRQRL
     C                   END
     C     DATAG1        TAG
      * Reload subfile requested
     C                   IF        YPMTFD = ' '
     C     W0RSF         CABEQ     'Y'           DAEXIT
     C                   END
      * Process subfile records
     C                   IF        *IN81
     C                   EXSR      DBPRSF
     C                   END
     C     YPMTFD        CABNE     *BLANKS       DAEXIT
      * USER: Final processing (Pre-confirm)
     C                   MOVEL     'Y'           W0RSF                          *Reload subfile
      * If error, quit processing
     C     *IN99         CABEQ     '1'           DAEXIT
      * Defer confirm/update requested
     C     W0DCF         CABEQ     'Y'           DAEXIT
      * USER: Process command keys
      *================================================================
     CSR   DAEXIT        ENDSR
      /EJECT
     CSR   DBPRSF        BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C                   IF        YAFSCH <> *ZERO
     C     YAFSCH        CHAIN     #SFLRCD                            92        *
     C                   ELSE
     C                   READC     #SFLRCD                                92    *
     C                   END
      * Process subfile record
     C                   DOW       NOT *IN92
     C                   EXSR      DCPRSR
      * Convert fields to external form
     C                   EXSR      MNCV#1
     C                   UPDATE    #SFLRCD
     C                   READC     #SFLRCD                                92    *
     C                   END
      *================================================================
     CSR   DBEXIT        ENDSR
      /EJECT
     CSR   DCPRSR        BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                   MOVEA     WKIND0        *IN(36)
     C                   SETOFF                                       98        *
     C     YPMTFD        CABNE     *BLANKS       DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * CASE: RCD.*SFLSEL is *Display
      * Dsp E10411 Voucher Dtl DR - Run Log Vchr Dtl   F0411  * 
     C                   IF        #1SEL = '5' OR
     C                             #1SEL = ' 5'
     C                   CLEAR                   PARC
     C                   MOVEL(P)  #1EDUS        PAEDUS                         EDI - User ID
     C                   MOVEL(P)  #1EDBT        PAEDBT                         EDI - Batch Num
     C                   MOVEL(P)  #1EDTN        PAEDTN                         EDI - Transacti
     C                   Z-ADD     #1EDLN        PAEDLN                         EDI - Line Numb
      *
     C                   CALL      'E1MBD1R'                            90      Dsp E10411 Vouc
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PARC                           KEY: Run Log Vc
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'E1MBD1R'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        98        *
     C                   END
     C                   END                                                    *FI
      * SFLRCD invalid
     C                   IF        *IN98
     C  N99              Z-ADD     ##RR          ##SFRC               99        *
      * SFLNXTCHG
     C                   SETON                                        84
     C                   ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                   SETOFF                                       84
     C                   EVAL      #1SEL = ' '
     C                   END                                                    FI *IN98
      *================================================================
     CSR   DCEXIT        ENDSR
      /EJECT
     CSR   FBRQRL        BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                   MOVEL     'Y'           W0RSF
      *================================================================
     CSR   FBEXIT        ENDSR
      /EJECT
     CSR   MBFL#1        BEGSR
      *================================================================
      * Move I0411L1 fields to subfile
      *================================================================
     C                   EVAL      #1SEL = ' '
     C                   Z-ADD     ELDOC         #1DOC                          Document Number
     C                   MOVEL     ELEDTY        #1EDTY                         Type Record
     C                   Z-ADD     ELEDSQ        #1EDSQ                         Record Sequence
     C                   MOVEL     ELEDCT        #1EDCT                         EDI - Document
     C                   MOVEL     ELEDTS        #1EDTS                         EDI - Transacti
     C                   MOVEL     ELEDFT        #1EDFT                         EDI - Translati
     C                   Z-ADD     ELEDDT        #1EDDT                         EDI - Transmiss
     C                   MOVEL     ELEDER        #1EDER                         EDI - Send/Rece
     C                   Z-ADD     ELEDDL        #1EDDL                         EDI - Dtl Lines
     C                   MOVEL     ELEDTC        #1EDTC                         EDI - Transacti
     C                   MOVEL     ELEDTR        #1EDTR                         EDI - Transacti
     C                   MOVEL     ELEDGL        #1EDGL                         Batch File Crea
     C                   MOVEL     ELEDDH        #1EDDH                         Batch File Disc
     C                   Z-ADD     ELEDAN        #1EDAN                         User Address nu
     C                   MOVEL     ELKCO         #1KCO                          Document Compan
     C                   Z-ADD     ELDGJ         #1DGJ                          G/L Date
     C                   MOVEL     ELSFX         #1SFX                          Document Pay It
     C                   Z-ADD     ELSFXE        #1SFXE                         Pay Item Extens
     C                   MOVEL     ELDCTA        #1DCTA                         Document Type -
     C                   Z-ADD     ELPYE         #1PYE                          Payee Address N
     C                   Z-ADD     ELSNTO        #1SNTO                         Address Number
     C                   Z-ADD     ELDIVJ        #1DIVJ                         Invoice Date -
     C                   Z-ADD     ELDSVJ        #1DSVJ                         Service/Tax Dat
     C                   Z-ADD     ELDDJ         #1DDJ                          Date - Net Due
     C                   Z-ADD     ELDDNJ        #1DDNJ                         Discount Due Da
     C                   Z-ADD     ELFY          #1FY                           Fiscal Year
     C                   Z-ADD     ELCTRY        #1CTRY                         Century
     C                   Z-ADD     ELPN          #1PN                           Period Number -
     C                   Z-ADD     ELICU         #1ICU                          Batch Number
     C                   MOVEL     ELICUT        #1ICUT                         Batch Type
     C                   Z-ADD     ELDICJ        #1DICJ                         Batch Date
     C                   MOVEL     ELBALJ        #1BALJ                         Journal Entries
     C                   MOVEL     ELPSTC        #1PSTC                         Pay Status Code
     C                   Z-ADD     ELAG          #1AG                           Gross Amount
     C                   Z-ADD     ELAAP         #1AAP                          Open Amount
     C                   Z-ADD     ELADSC        #1ADSC                         Discount Availa
     C                   Z-ADD     ELADSA        #1ADSA                         Discount Taken
     C                   Z-ADD     ELATXA        #1ATXA                         Taxable Amount
     C                   Z-ADD     ELATXN        #1ATXN                         Non-Taxable Amo
     C                   Z-ADD     ELSTAM        #1STAM                         Tax Amount
     C                   MOVEL     ELTXA1        #1TXA1                         Tax Rate/Area
     C                   MOVEL     ELEXR1        #1EXR1                         Tax Expl Code 1
     C                   MOVEL     ELCRRM        #1CRRM                         Currency Mode
     C                   MOVEL     ELCRCD        #1CRCD                         Currency Code -
     C                   Z-ADD     ELCRR         #1CRR                          Currency Conver
     C                   Z-ADD     ELACR         #1ACR                          Currency Amount
     C                   Z-ADD     ELFAP         #1FAP                          Foreign Open Am
     C                   Z-ADD     ELCDS         #1CDS                          Foreign Disc Av
     C                   Z-ADD     ELCDSA        #1CDSA                         Foreign Disc Ta
     C                   Z-ADD     ELCTXA        #1CTXA                         Foreign Taxable
     C                   Z-ADD     ELCTXN        #1CTXN                         Foreign Non-Tax
     C                   Z-ADD     ELCTAM        #1CTAM                         Foreign Tax Amo
     C                   MOVEL     ELGLC         #1GLC                          G/L Offset
     C                   MOVEL     ELGLBA        #1GLBA                         G/L Bank Accoun
     C                   MOVEL     ELPOST        #1POST                         G/L Posted Flag
     C                   MOVEL     ELAM          #1AM                           Account Mode -
     C                   MOVEL     ELAID2        #1AID2                         Account ID 2
     C                   MOVEL     ELMCU         #1MCU                          Business Unit/C
     C                   MOVEL     ELOBJ         #1OBJ                          Object Account
     C                   MOVEL     ELSUB         #1SUB                          Subsidiary
     C                   MOVEL     ELSBLT        #1SBLT                         Subledger Type
     C                   MOVEL     ELSBL         #1SBL                          Subledger - G/L
     C                   MOVEL     ELBAID        #1BAID                         Bank Transit Sh
     C                   MOVEL     ELPTC         #1PTC                          Payment Terms C
     C                   MOVEL     ELVOD         #1VOD                          Void Flag
     C                   MOVEL     ELOKCO        #1OKCO                         Document Co - O
     C                   MOVEL     ELODCT        #1ODCT                         Document Type -
     C                   Z-ADD     ELODOC        #1ODOC                         Document - Orig
     C                   MOVEL     ELOSFX        #1OSFX                         Document Pay It
     C                   MOVEL     ELCRC         #1CRC                          Payment Handlin
     C                   MOVEL     ELPKCO        #1PKCO                         Document Co - P
     C                   MOVEL     ELPO          #1PO                           Purchase Order
     C                   MOVEL     ELPDCT        #1PDCT                         Document Type -
     C                   Z-ADD     ELLNID        #1LNID                         Line number
     C                   MOVEL     ELSFXO        #1SFXO                         Order Suffix
     C                   Z-ADD     ELOPSQ        #1OPSQ                         Sequence Nbr -
     C                   MOVEL     ELVR01        #1VR01                         Reference
     C                   MOVEL     ELUNIT        #1UNIT                         Unit
     C                   MOVEL     ELMCU2        #1MCU2                         Business Unit 2
     C                   MOVEL     ELRMK         #1RMK                          Name - Remark
     C                   MOVEL     ELRF          #1RF                           Frequency - Rec
     C                   Z-ADD     ELDRF         #1DRF                          Recurring Freq
     C                   MOVEL     ELCTL         #1CTL                          Control/Stateme
     C                   MOVEL     ELFNLP        #1FNLP                         Closed Item as
     C                   Z-ADD     ELU           #1U                            Units
     C                   MOVEL     ELUM          #1UM                           Unit of Measure
     C                   MOVEL     ELPYIN        #1PYIN                         Payment Instrum
     C                   MOVEL     ELTXA3        #1TXA3                         Tax Rate Area 3
     C                   MOVEL     ELEXR3        #1EXR3                         Tax Expl Code 3
     C                   MOVEL     ELRP1         #1RP1                          A/R-A/P-Misc Co
     C                   MOVEL     ELRP2         #1RP2                          A/R-A/P-Misc Co
     C                   MOVEL     ELRP3         #1RP3                          A/R-A/P-Cash Rc
     C                   MOVEL     ELAC07        #1AC07                         Catg Code - Add
     C                   MOVEL     ELTNN         #1TNN                          Flag for 1099
     C                   MOVEL     ELDMCD        #1DMCD                         Dom Entry w/ Mu
     C                   Z-ADD     ELITM         #1ITM                          Item Number - S
     C                   Z-ADD     ELHCRR        #1HCRR                         Historical Curr
     C                   Z-ADD     ELHDGJ        #1HDGJ                         Historical Date
     C                   MOVEL     ELURCD        #1URCD                         User Reserved C
     C                   Z-ADD     ELURDT        #1URDT                         User Reserved D
     C                   Z-ADD     ELURAT        #1URAT                         User Reserved A
     C                   Z-ADD     ELURAB        #1URAB                         User Reserved N
     C                   MOVEL     ELURRF        #1URRF                         User Reserved R
     C                   MOVEL     ELTORG        #1TORG                         Transaction Ori
     C                   MOVEL     ELUSER        #1USER                         User ID
     C                   MOVEL     ELPID         #1PID                          Program ID
     C                   Z-ADD     ELUPMJ        #1UPMJ                         Date - Updated
     C                   Z-ADD     ELUPMT        #1UPMT                         Time - Last Upd
     C                   MOVEL     ELJOBN        #1JOBN                         Work Station ID
     C                   Z-ADD     ELDIM         #1DIM                          Invoice Date -
     C                   Z-ADD     ELDID         #1DID                          Invoice Date -
     C                   Z-ADD     ELDIY         #1DIY                          Invoice Date -
     C                   Z-ADD     ELDI#         #1DI#                          Invoice Date -
     C                   Z-ADD     ELDSVM        #1DSVM                         Service/Tax Dat
     C                   Z-ADD     ELDSVD        #1DSVD                         Service/Tax Dat
     C                   Z-ADD     ELDSVY        #1DSVY                         Service/Tax Dat
     C                   Z-ADD     ELDSV#        #1DSV#                         Service/Tax Dat
     C                   Z-ADD     ELDDM         #1DDM                          Net Due Date -
     C                   Z-ADD     ELDDDA        #1DDDA                         Net Due Date -
     C                   Z-ADD     ELDDY         #1DDY                          Net Due Date -
     C                   Z-ADD     ELDD#         #1DD#                          Net Due Date -
     C                   Z-ADD     ELDDNM        #1DDNM                         Discount Due Da
     C                   Z-ADD     ELDDND        #1DDND                         Discount Due Da
     C                   Z-ADD     ELDDNY        #1DDNY                         Discount Due Da
     C                   Z-ADD     ELDDN#        #1DDN#                         Discount Due Da
     C                   Z-ADD     ELDGM         #1DGM                          G/L Date - MO
     C                   Z-ADD     ELDGD         #1DGD                          G/L Date - DA
     C                   Z-ADD     ELDGY         #1DGY                          G/L Date - YR
     C                   Z-ADD     ELDG#         #1DG#                          G/L Date - CTRY
     C                   Z-ADD     ELDICM        #1DICM                         Batch Date - MO
     C                   Z-ADD     ELDICD        #1DICD                         Batch Date - DA
     C                   Z-ADD     ELDICY        #1DICY                         Batch Date - YR
     C                   Z-ADD     ELDIC#        #1DIC#                         Batch Date - CT
     C                   Z-ADD     ELHDGM        #1HDGM                         Historical Date
     C                   Z-ADD     ELHDGD        #1HDGD                         Historical Date
     C                   Z-ADD     ELHDGY        #1HDGY                         Historical Date
     C                   Z-ADD     ELHDG#        #1HDG#                         Historical Date
     C                   Z-ADD     ELDOCM        #1DOCM                         Document Matchi
     C                   MOVEL     ELTNST        #1TNST                         Bank Transit Nu
     C                   MOVEL     ELYC01        #1YC01                         Catg Code - A/P
     C                   MOVEL     ELYC02        #1YC02                         Catg Code - A/P
     C                   MOVEL     ELYC03        #1YC03                         Catg Code - A/P
     C                   MOVEL     ELYC04        #1YC04                         Catg Code - A/P
     C                   MOVEL     ELYC05        #1YC05                         Catg Code - A/P
     C                   MOVEL     ELYC06        #1YC06                         Catg Code - A/P
     C                   MOVEL     ELYC07        #1YC07                         Catg Code - A/P
     C                   MOVEL     ELYC08        #1YC08                         Catg Code - A/P
     C                   MOVEL     ELYC09        #1YC09                         Catg Code - A/P
     C                   MOVEL     ELYC10        #1YC10                         Catg Code - A/P
     C                   MOVEL     ELDTXS        #1DTXS                         Deferred Tax St
     C                   MOVEL     ELBCRC        #1BCRC                         Base Currency C
     C                   Z-ADD     ELATAD        #1ATAD                         Amount To Distr
     C                   Z-ADD     ELCTAD        #1CTAD                         Currency to Dis
     C                   Z-ADD     ELNRTA        #1NRTA                         Non-Recoverable
     C                   Z-ADD     ELFNRT        #1FNRT                         Non-Recoverable
     C                   MOVEL     ELTAXP        #1TAXP                         Purchasing Taxa
     C                   MOVEL     ELPRGF        #1PRGF                         Purge Flag
     C                   MOVEL     ELGFL5        #1GFL5                         Generic Flag 5
     C                   MOVEL     ELGFL6        #1GFL6                         Generic Flag 6
     C                   Z-ADD     ELGAM1        #1GAM1                         Generic Amount
     C                   Z-ADD     ELGAM2        #1GAM2                         Generic Amount
     C                   MOVEL     ELGEN4        #1GEN4                         Generic String
     C                   MOVEL     ELGEN5        #1GEN5                         Generic String
     C                   Z-ADD     ELWTAD        #1WTAD                         Future W/H Tax
     C                   Z-ADD     ELWTAF        #1WTAF                         Future W/H Tax
     C                   MOVEL     ELSMMF        #1SMMF                         Summarized Flag
     C                   MOVEL     ELPYWP        #1PYWP                         Pay When Paid
     C                   Z-ADD     ELPWPG        #1PWPG                         Pay When Paid G
     C                   MOVEL     ELNETS        #1NETS                         Netting Status
     C                   MOVEL     ELATFL        #1ATFL                         Automation Flag
     C                   MOVEL     ELATRL        #1ATRL                         Automation Rule
     C                   Z-ADD     ELJOBS        #1JOBS                         Job Number
     C                   MOVEL     ELPSTE        #1PSTE                         Process Type
     C                   MOVEL     ELDWST        #1DWST                         Record Status
     C                   Z-ADD     ELABDT        #1ABDT                         Create Date
     C                   Z-ADD     ELABTM        #1ABTM                         Create Time
     C                   MOVEL     ELAJVN        #1AJVN                         Create User
     C                   MOVEL     ELAKVN        #1AKVN                         Create Program
     C                   Z-ADD     ELACDT        #1ACDT                         Change Date
     C                   Z-ADD     ELACTM        #1ACTM                         Change Time
     C                   MOVEL     ELALVN        #1ALVN                         Change User
     C                   MOVEL     ELAMVN        #1AMVN                         Change Program
     C                   MOVEL     ELEDUS        #1EDUS                         EDI - User ID
     C                   MOVEL     ELEDBT        #1EDBT                         EDI - Batch Num
     C                   MOVEL     ELEDTN        #1EDTN                         EDI - Transacti
     C                   Z-ADD     ELEDLN        #1EDLN                         EDI - Line Numb
     C                   MOVEL     ELEDSP        #1EDSP                         EDI - Successfu
     C                   MOVEL     ELCO          #1CO                           Company
     C                   MOVEL     ELDCT         #1DCT                          Document Type
     C                   Z-ADD     ELAN8         #1AN8                          Address Number
     C                   MOVEL     ELO6TX        #1O6TX                         E1 Process Erro
     C                   MOVEL     ELO7TX        #1O7TX                         E1 Process Erro
     C                   MOVEL     ELVINV        #1VINV                         Supplier Invoic
     C                   Z-ADD     *ZERO         #RK8NB                         USR Amount 9.2
     C                   EVAL      #1SEL = ' '                                  *SFLSEL
     C                   Z-ADD     *ZERO         #RAFDT                         USR Date cyymmd
      * Clear external version also
     C                   Z-ADD     *ZERO         VRAFDT
     C                   Z-ADD     *ZERO         #RCAVA                         USR Amount 11.2
      *================================================================
     CSR   MBEXIT        ENDSR
      /EJECT
     CSR   MEIZ#2        BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                   EVAL      #2SFX = ' '                                  Document Pay It
     C                   Z-ADD     *ZERO         #2SFXE                         Pay Item Extens
     C                   EVAL      #2DCTA = ' '                                 Document Type -
     C                   Z-ADD     *ZERO         #2PYE                          Payee Address N
     C                   Z-ADD     *ZERO         #2SNTO                         Address Number
     C                   Z-ADD     *ZERO         #2DIVJ                         Invoice Date -
     C                   Z-ADD     *ZERO         #2DSVJ                         Service/Tax Dat
     C                   Z-ADD     *ZERO         #2DDJ                          Date - Net Due
     C                   Z-ADD     *ZERO         #2DDNJ                         Discount Due Da
     C                   Z-ADD     *ZERO         #2FY                           Fiscal Year
     C                   Z-ADD     *ZERO         #2CTRY                         Century
     C                   Z-ADD     *ZERO         #2PN                           Period Number -
     C                   Z-ADD     *ZERO         #2ICU                          Batch Number
     C                   EVAL      #2ICUT = ' '                                 Batch Type
     C                   Z-ADD     *ZERO         #2DICJ                         Batch Date
     C                   EVAL      #2BALJ = ' '                                 Journal Entries
     C                   EVAL      #2PSTC = ' '                                 Pay Status Code
     C                   Z-ADD     *ZERO         #2AG                           Gross Amount
     C                   Z-ADD     *ZERO         #2AAP                          Open Amount
     C                   Z-ADD     *ZERO         #2ADSC                         Discount Availa
     C                   Z-ADD     *ZERO         #2ADSA                         Discount Taken
     C                   Z-ADD     *ZERO         #2ATXA                         Taxable Amount
     C                   Z-ADD     *ZERO         #2ATXN                         Non-Taxable Amo
     C                   Z-ADD     *ZERO         #2STAM                         Tax Amount
     C                   EVAL      #2TXA1 = ' '                                 Tax Rate/Area
     C                   EVAL      #2EXR1 = ' '                                 Tax Expl Code 1
     C                   EVAL      #2CRRM = ' '                                 Currency Mode
     C                   EVAL      #2CRCD = ' '                                 Currency Code -
     C                   Z-ADD     *ZERO         #2CRR                          Currency Conver
     C                   Z-ADD     *ZERO         #2ACR                          Currency Amount
     C                   Z-ADD     *ZERO         #2FAP                          Foreign Open Am
     C                   Z-ADD     *ZERO         #2CDS                          Foreign Disc Av
     C                   Z-ADD     *ZERO         #2CDSA                         Foreign Disc Ta
     C                   Z-ADD     *ZERO         #2CTXA                         Foreign Taxable
     C                   Z-ADD     *ZERO         #2CTXN                         Foreign Non-Tax
     C                   Z-ADD     *ZERO         #2CTAM                         Foreign Tax Amo
     C                   EVAL      #2GLC = ' '                                  G/L Offset
     C                   EVAL      #2GLBA = ' '                                 G/L Bank Accoun
     C                   EVAL      #2POST = ' '                                 G/L Posted Flag
     C                   EVAL      #2AM = ' '                                   Account Mode -
     C                   EVAL      #2AID2 = ' '                                 Account ID 2
     C                   EVAL      #2MCU = ' '                                  Business Unit/C
     C                   EVAL      #2OBJ = ' '                                  Object Account
     C                   EVAL      #2SUB = ' '                                  Subsidiary
     C                   EVAL      #2SBLT = ' '                                 Subledger Type
     C                   EVAL      #2SBL = ' '                                  Subledger - G/L
     C                   EVAL      #2BAID = ' '                                 Bank Transit Sh
     C                   EVAL      #2PTC = ' '                                  Payment Terms C
     C                   EVAL      #2VOD = ' '                                  Void Flag
     C                   EVAL      #2OKCO = ' '                                 Document Co - O
     C                   EVAL      #2ODCT = ' '                                 Document Type -
     C                   Z-ADD     *ZERO         #2ODOC                         Document - Orig
     C                   EVAL      #2OSFX = ' '                                 Document Pay It
     C                   EVAL      #2CRC = ' '                                  Payment Handlin
     C                   EVAL      #2VINV = ' '                                 Supplier Invoic
     C                   EVAL      #2PKCO = ' '                                 Document Co - P
     C                   EVAL      #2PO = ' '                                   Purchase Order
     C                   EVAL      #2PDCT = ' '                                 Document Type -
     C                   Z-ADD     *ZERO         #2LNID                         Line number
     C                   EVAL      #2SFXO = ' '                                 Order Suffix
     C                   Z-ADD     *ZERO         #2OPSQ                         Sequence Nbr -
     C                   EVAL      #2VR01 = ' '                                 Reference
     C                   EVAL      #2UNIT = ' '                                 Unit
     C                   EVAL      #2MCU2 = ' '                                 Business Unit 2
     C                   EVAL      #2RMK = ' '                                  Name - Remark
     C                   EVAL      #2RF = ' '                                   Frequency - Rec
     C                   Z-ADD     *ZERO         #2DRF                          Recurring Freq
     C                   EVAL      #2CTL = ' '                                  Control/Stateme
     C                   EVAL      #2FNLP = ' '                                 Closed Item as
     C                   Z-ADD     *ZERO         #2U                            Units
     C                   EVAL      #2UM = ' '                                   Unit of Measure
     C                   EVAL      #2PYIN = ' '                                 Payment Instrum
     C                   EVAL      #2TXA3 = ' '                                 Tax Rate Area 3
     C                   EVAL      #2RP1 = ' '                                  A/R-A/P-Misc Co
     C                   EVAL      #2RP2 = ' '                                  A/R-A/P-Misc Co
     C                   EVAL      #2RP3 = ' '                                  A/R-A/P-Cash Rc
     C                   EVAL      #2AC07 = ' '                                 Catg Code - Add
     C                   EVAL      #2TNN = ' '                                  Flag for 1099
     C                   EVAL      #2DMCD = ' '                                 Dom Entry w/ Mu
     C                   Z-ADD     *ZERO         #2ITM                          Item Number - S
     C                   Z-ADD     *ZERO         #2HCRR                         Historical Curr
     C                   Z-ADD     *ZERO         #2HDGJ                         Historical Date
     C                   EVAL      #2URCD = ' '                                 User Reserved C
     C                   Z-ADD     *ZERO         #2URDT                         User Reserved D
     C                   Z-ADD     *ZERO         #2URAT                         User Reserved A
     C                   Z-ADD     *ZERO         #2URAB                         User Reserved N
     C                   EVAL      #2URRF = ' '                                 User Reserved R
     C                   EVAL      #2TORG = ' '                                 Transaction Ori
     C                   EVAL      #2USER = ' '                                 User ID
     C                   EVAL      #2PID = ' '                                  Program ID
     C                   Z-ADD     *ZERO         #2UPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         #2UPMT                         Time - Last Upd
     C                   EVAL      #2JOBN = ' '                                 Work Station ID
     C                   Z-ADD     *ZERO         #2DIM                          Invoice Date -
     C                   Z-ADD     *ZERO         #2DID                          Invoice Date -
     C                   Z-ADD     *ZERO         #2DIY                          Invoice Date -
     C                   Z-ADD     *ZERO         #2DI#                          Invoice Date -
     C                   Z-ADD     *ZERO         #2DSVM                         Service/Tax Dat
     C                   Z-ADD     *ZERO         #2DSVD                         Service/Tax Dat
     C                   Z-ADD     *ZERO         #2DSVY                         Service/Tax Dat
     C                   Z-ADD     *ZERO         #2DSV#                         Service/Tax Dat
     C                   Z-ADD     *ZERO         #2DDM                          Net Due Date -
     C                   Z-ADD     *ZERO         #2DDDA                         Net Due Date -
     C                   Z-ADD     *ZERO         #2DDY                          Net Due Date -
     C                   Z-ADD     *ZERO         #2DD#                          Net Due Date -
     C                   Z-ADD     *ZERO         #2DDNM                         Discount Due Da
     C                   Z-ADD     *ZERO         #2DDND                         Discount Due Da
     C                   Z-ADD     *ZERO         #2DDNY                         Discount Due Da
     C                   Z-ADD     *ZERO         #2DDN#                         Discount Due Da
     C                   Z-ADD     *ZERO         #2DGM                          G/L Date - MO
     C                   Z-ADD     *ZERO         #2DGD                          G/L Date - DA
     C                   Z-ADD     *ZERO         #2DGY                          G/L Date - YR
     C                   Z-ADD     *ZERO         #2DG#                          G/L Date - CTRY
     C                   Z-ADD     *ZERO         #2DICM                         Batch Date - MO
     C                   Z-ADD     *ZERO         #2DICD                         Batch Date - DA
     C                   Z-ADD     *ZERO         #2DICY                         Batch Date - YR
     C                   Z-ADD     *ZERO         #2DIC#                         Batch Date - CT
     C                   Z-ADD     *ZERO         #2HDGM                         Historical Date
     C                   Z-ADD     *ZERO         #2HDGD                         Historical Date
     C                   Z-ADD     *ZERO         #2HDGY                         Historical Date
     C                   Z-ADD     *ZERO         #2HDG#                         Historical Date
     C                   Z-ADD     *ZERO         #2DOCM                         Document Matchi
     C                   EVAL      #2TNST = ' '                                 Bank Transit Nu
     C                   EVAL      #2YC01 = ' '                                 Catg Code - A/P
     C                   EVAL      #2YC02 = ' '                                 Catg Code - A/P
     C                   EVAL      #2YC03 = ' '                                 Catg Code - A/P
     C                   EVAL      #2YC04 = ' '                                 Catg Code - A/P
     C                   EVAL      #2YC05 = ' '                                 Catg Code - A/P
     C                   EVAL      #2YC06 = ' '                                 Catg Code - A/P
     C                   EVAL      #2YC07 = ' '                                 Catg Code - A/P
     C                   EVAL      #2YC08 = ' '                                 Catg Code - A/P
     C                   EVAL      #2YC09 = ' '                                 Catg Code - A/P
     C                   EVAL      #2YC10 = ' '                                 Catg Code - A/P
     C                   EVAL      #2DTXS = ' '                                 Deferred Tax St
     C                   EVAL      #2BCRC = ' '                                 Base Currency C
     C                   Z-ADD     *ZERO         #2ATAD                         Amount To Distr
     C                   Z-ADD     *ZERO         #2CTAD                         Currency to Dis
     C                   Z-ADD     *ZERO         #2NRTA                         Non-Recoverable
     C                   Z-ADD     *ZERO         #2FNRT                         Non-Recoverable
     C                   EVAL      #2TAXP = ' '                                 Purchasing Taxa
     C                   EVAL      #2PRGF = ' '                                 Purge Flag
     C                   EVAL      #2GFL5 = ' '                                 Generic Flag 5
     C                   EVAL      #2GFL6 = ' '                                 Generic Flag 6
     C                   Z-ADD     *ZERO         #2GAM1                         Generic Amount
     C                   Z-ADD     *ZERO         #2GAM2                         Generic Amount
     C                   EVAL      #2GEN4 = ' '                                 Generic String
     C                   EVAL      #2GEN5 = ' '                                 Generic String
     C                   Z-ADD     *ZERO         #2WTAD                         Future W/H Tax
     C                   Z-ADD     *ZERO         #2WTAF                         Future W/H Tax
     C                   EVAL      #2SMMF = ' '                                 Summarized Flag
     C                   EVAL      #2PYWP = ' '                                 Pay When Paid
     C                   Z-ADD     *ZERO         #2PWPG                         Pay When Paid G
     C                   EVAL      #2NETS = ' '                                 Netting Status
     C                   EVAL      #2ATFL = ' '                                 Automation Flag
     C                   EVAL      #2ATRL = ' '                                 Automation Rule
     C                   Z-ADD     *ZERO         #2JOBS                         Job Number
     C                   EVAL      #2PSTE = ' '                                 Process Type
     C                   EVAL      #2DWST = ' '                                 Record Status
     C                   Z-ADD     *ZERO         #2ABDT                         Create Date
     C                   Z-ADD     *ZERO         #2ABTM                         Create Time
     C                   EVAL      #2AJVN = ' '                                 Create User
     C                   EVAL      #2AKVN = ' '                                 Create Program
     C                   Z-ADD     *ZERO         #2ACDT                         Change Date
     C                   Z-ADD     *ZERO         #2ACTM                         Change Time
     C                   EVAL      #2ALVN = ' '                                 Change User
     C                   Z-ADD     *ZERO         #2DOC                          Document Number
     C                   EVAL      #2KCO = ' '                                  Document Compan
     C                   Z-ADD     *ZERO         #CK8NB                         USR Amount 9.2
     C                   MOVEL     P1EDUS        #2EDUS                         EDI - User ID
     C                   MOVEL     P1EDBT        #2EDBT                         EDI - Batch Num
     C                   EVAL      #2EDTN = ' '                                 EDI - Transacti
     C                   Z-ADD     *ZERO         #2EDLN                         EDI - Line Numb
     C                   EVAL      #2EDSP = ' '                                 EDI - Successfu
     C                   EVAL      #2CO = ' '                                   Company
     C                   EVAL      #2DCT = ' '                                  Document Type
     C                   Z-ADD     *ZERO         #2DGJ                          G/L Date
     C                   Z-ADD     *ZERO         #2AN8                          Address Number
     C                   Z-ADD     *ZERO         #CCAVA                         USR Amount 11.2
     C                   EVAL      #2O6TX = ' '                                 E1 Process Erro
     C                   EVAL      #2O7TX = ' '                                 E1 Process Erro
      *================================================================
     CSR   MEEXIT        ENDSR
      /EJECT
     CSR   MNCV#1        BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert USR Date cyymmdd to display format
      * Convert date
     C     1000000       ADD       #RAFDT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VRAFDT
      *================================================================
     CSR   MNEXIT        ENDSR
      /EJECT
     CSR   XDVC2T        BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                   Z-ADD     0             XDEX01                         CC
     C                   IF        XDDTFM = 'DMY'
     C                   Z-ADD     XDINDD        XDEX02                         DD
     C                   Z-ADD     XDINMM        XDEX03                         MM
     C                   Z-ADD     XDINYY        XDEX04                         YY
     C                   ELSE
     C                   IF        XDDTFM = 'MDY'
     C                   Z-ADD     XDINMM        XDEX02                         MM
     C                   Z-ADD     XDINDD        XDEX03                         DD
     C                   Z-ADD     XDINYY        XDEX04                         YY
     C                   ELSE
      * YMD format
     C                   Z-ADD     XDINYY        XDEX02                         YY
     C                   Z-ADD     XDINMM        XDEX03                         MM
     C                   Z-ADD     XDINDD        XDEX04                         DD
     C                   END
     C                   END
      *================================================================
     CSR   XDVC2E        ENDSR
      /EJECT
     CSR   Y0SET         BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y0EXIT        ENDSR
      /EJECT
     CSR   Y8TST         BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                   Z-ADD     @#RWCL        ZINPOS
     C     ZINPOS        DIV       256           W0CRW
     C                   MVR                     W0CCL
      *================================================================
     CSR   Y8EXIT        ENDSR
      /EJECT
     CSR   Y9CLR         BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y9EXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZDVPMT        BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                   EVAL      YPMTFD = ' '
     C                   Z-ADD     *ZERO         YAFSCH
     C                   Z-ADD     *ZERO         YPMRRN
      *
      *
      * Extract cursor row and column
     C                   IF        *IN04
     C     @#RWCL        DIV       256           ZHCSRW
     C                   MVR                     ZHCSCL
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
      * Save sfl rrn at top of page
     C                   Z-ADD     @#SFRC        Y#SFRC
      *
      * Initialise sfl workfields
     C                   Z-ADD     9             ZHSTRW
     C                   Z-ADD     22            ZHNDRW
     C                   IF        ##SFM = '0'
     C                   Z-ADD     2             ZHRLEN
     C                   ELSE
     C                   Z-ADD     1             ZHRLEN
     C                   ENDIF
     C                   Z-ADD     *ZERO         ZHF4RW
     C                   Z-ADD     *ZERO         ZHWK1#
      *
      * Resolve prompt row number on sfl
     C                   IF        ZHCSRW >= ZHSTRW AND
     C                             ZHCSRW <= ZHNDRW
     C     ZHCSRW        SUB       ZHSTRW        ZHWK1#
     C     ZHWK1#        DIV       ZHRLEN        ZHWK1#
     C                   Z-ADD     ZHWK1#        YZSFDL
     C     ZHWK1#        MULT      ZHRLEN        ZHWK1#
     C     ZHCSRW        SUB       ZHWK1#        ZHF4RW
     C                   END
      *
      * Error if user defined prompting is not specified.
     C                   IF        YPMTFD = ' '
     C                   IF        W0PMT = 'N'
     C                   MOVEL     '*NONE'       YPMTFD
     C                   MOVEL     'Y'           W0HLP
     C                   MOVEL     'Y'           ZAFSMS
      * Send error message.
     C                   MOVEL     'Y2U0101'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END
     C                   END
      *
      * Save first changed  rrn
      *
     C                   IF        ZHCSRW >= ZHSTRW AND
     C                             ZHCSRW <= ZHNDRW AND
     C                             YPMTFD <> '*NONE'
     C                   IF        ##RR <> *ZERO
     C                   READC     #SFLRCD                                92    *
     C                   IF        NOT *IN92
     C                   Z-ADD     ##RR          YAFSCH
     C                   SETON                                        84        *
     C                   UPDATE    #SFLRCD
     C                   END
     C                   END
      *
      * Calculate rrn for prompt slf record
     C     ZHCSRW        SUB       ZHSTRW        ZHWK1#
     C     ZHWK1#        DIV       ZHRLEN        ZHWK1#
     C     ZHWK1#        ADD       Y#SFRC        YPMRRN
      *
      * Chain to sfl record
     C     YPMRRN        CHAIN     #SFLRCD                            9292      *
     C                   IF        NOT *IN92
     C                   SETON                                        84        *
     C                   UPDATE    #SFLRCD
     C                   ELSE
     C                   Z-ADD     *ZERO         YPMRRN
     C                   END
      *
      * Test first changed rrn/prompt rrn
     C                   IF        YAFSCH = *ZERO
     C                   Z-ADD     YPMRRN        YAFSCH
     C                   END
      *
      * If prompt rrn < first changed rrn
     C                   IF        YPMRRN <> *ZERO AND
     C                             YPMRRN < YAFSCH
     C                   Z-ADD     YPMRRN        YAFSCH
     C                   END
      *
     C                   END
      *
     C                   END
      *================================================================
     CSR   ZDEXIT        ENDSR
      /EJECT
     CSR   ZHHPKY        BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                   MOVEL     'Y'           W0HLP
      *
      * Extract cursor row and column
     C     @#RWCL        DIV       256           ZHCSRW                         Row
     C                   MVR                     ZHCSCL                         Column
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
      *
     C                   CALL      'YDDSHPR'
     C                   PARM      ##PGM         W0HPMB                         Help text sourc
     C                   PARM      *BLANK        YYHPFL                         Help text file
     C                   PARM      *BLANK        YYHPLB                         Help text libra
     C                   PARM                    W0RTN
     C                   PARM      '*START'      YYHLVN                         Help label
     C                   PARM      '*NORMAL'     YYUSOP                         Options
     C                   PARM      ZHCSRW        YYRW                           Row
     C                   PARM      ZHCSCL        YYCL                           Column
     C                   PARM      *ZERO         YYLGCT                         # of grps
     C                   PARM      *BLANK        YYLGVN                         Label grps
      *
      * Clear set cursor DDS indicator
     C  N94              MOVEL     'OFF'         WCSRLC
     C  N94              SETON                                        94        *
      *================================================================
     CSR   ZHEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Clear all neither parameters
     C                   EVAL      P2LCTX = ' '                                 OMS Warehouse C
     C                   Z-ADD     *ZERO         P2GUNB                         OMS Company Num
     C                   EVAL      P2CQCD = ' '                                 OMS Application
     C                   EVAL      P2CSCD = ' '                                 OMS Salesperson
     C                   EVAL      P2I2ST = ' '                                 OMS Allow Multi
     C                   EVAL      P2LDTX = ' '                                 OMS Default Pri
     C                   EVAL      P2LETX = ' '                                 OMS NAME
     C                   EVAL      P2KRTX = ' '                                 OMS System Valu
     C                   EVAL      P2I1ST = ' '                                 OMS Access Deni
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Obtain default message file
     C     *DTAARA       DEFINE    E1MGFLA       ZADFMF
     C                   IN        ZADFMF
      * Flag no *SET CURSOR in the program
     C                   MOVE      'N'           YSETCS
     C                   EVALR     WCSRLC = ' '
      * Define *Synon program work fields
     C                   EVAL      W0CFL = ' '                                  *Cursor field
     C                   Z-ADD     *ZEROS        W0CRW                          *Cursor row
     C                   Z-ADD     *ZEROS        W0CCL                          *Cursor column
      * Move main file information to JOB context
     C                   MOVE      @1FFL         ZZFFL                          Main file name
     C                   MOVE      @1FLB         ZZFLB                          Main file lib
     C                   MOVE      @1FMB         ZZFMB                          Main file mbr
     C                   CALL      'Y2QLVNR'
     C                   PARM                    ZZFFL
     C                   PARM                    ZZFLB
     C                   PARM                    ZZFQL                          LIBRARY/FILE
     C                   MOVEL     'N'           W0PMT
      * Define local work field USR Date Julian 5.0
     C                   Z-ADD     *ZERO         YL0001
      * Obtain system date format
     C     *DTAARA       DEFINE    Y2DTFMA       XDDTFM
     C                   IN        XDDTFM
      * *DTAARA = *COMPANY N
     C     *DTAARA       DEFINE    YYCOTXA       ##CMP
     C                   IN        *DTAARA
      *................................................................
     C                   Z-ADD     14            ##SFPG                         SFLPAG
     C                   Z-ADD     1             ##SFRC
      * Maximum record number
     C                   Z-ADD     *ZERO         ##RRMX
      * Scan limit
     C                   Z-ADD     000000500     W0SLM
      * Subfile pages
     C                   Z-ADD     1             W0SPG
      * Processed Subfile record
     C                   Z-ADD     0             W0RR0
      *................................................................
     C                   EVAL      W0GRP = ' '
      * USER: Initialize program
      * Val Application/UserRP4IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                   CALL      'PDGXXFR'                            90      Val Application
     C                   PARM      *BLANK        W0RTN
     C     P2LCTX        PARM      *BLANK        WQ0003                         OMS Warehouse C
     C     P2GUNB        PARM      *ZERO         WQ0004                         OMS Company Num
     C                   PARM      'A/R'         WQ0005                         OMS Application
     C     P2CSCD        PARM      *BLANK        WQ0006                         OMS Salesperson
     C     P2I2ST        PARM      *BLANK        WQ0007                         OMS Allow Multi
     C     P2LDTX        PARM      *BLANK        WQ0008                         OMS Default Pri
     C     P2LETX        PARM      *BLANK        WQ0009                         OMS NAME
     C     P2KRTX        PARM      *BLANK        WQ0010                         OMS System Valu
     C     P2I1ST        PARM      *BLANK        WQ0011                         OMS Access Deni
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGXXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: PAR.OMS Access Denied (Y/N) is Yes
      * Send message 'Access Denied for User'
     C                   IF        P2I1ST = 'Y'
     C                   MOVEL     'E1I0112'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   ELSE
      * CASE: *OTHERWISE
      * Mov ApplN to CompanyRP4US - STR Order Management Sys  * 
     C***   MOVE USER SOURCE                      ***
     C                   movel     P2KRTX        ##CMP
     C                   END                                                    *FI
     C                   MOVEL     '1'           ##SFM                          *Subfile mode
      * Initialise subfile control
     C                   EXSR      MEIZ#2
      *================================================================
     CSR   ZZEXIT        ENDSR
