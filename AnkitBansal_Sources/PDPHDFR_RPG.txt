     H/TITLE WW Credit/Debit Memos  DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISABANS
     H* Date          : 04/24/25  Time  : 03:50:31
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDPHDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Credit/Debit Memos  DF Display file
      *
     FOPBFCPLOIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FOPBGWKLJIF  E           K        DISK
      * RSQ : Order Detail              Co/Ord/Seqs/not Canc/Cnf
      *
     FOPBFCPMDIF  E           K        DISK
      * RSQ : Order Header TRG          Claim/Co/Order
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPEYCPL0IF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FPDMKCPL0UF  E           K        DISK
      * UPD : AR Claim Header           Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 027  5 0A
     E                    W0END   7 027  5 0A
     E                    W0NAM   7 027 10
      * Long constants
     E                    @CN#    1  15  6   @CN    25
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BFCPA6
      * Order Header TRG          Claim/Co/Order
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WEAIC3
     I              EYC4NB                          WEC4NB
     I              EYQ2NB                          WEQ2NB
     I              EYJPCD                          WEJPCD
     I              EYAUC3                          WEAUC3
     I              EYQ7NB                          WEQ7NB
     I              EYOMST                          WEOMST
     I              EYD2DT                          WED2DT
     I              EYONST                          WEONST
     I              EYOOST                          WEOOST
     I              EYOPST                          WEOPST
     I              EYAWC3                          WEAWC3
     I              EYQ8NB                          WEQ8NB
     I              EYQ9NB                          WEQ9NB
     I              EYBKC7                          WEBKC7
     I              EYUVST                          WEUVST
     I              EYUWST                          WEUWST
     I              EYUXST                          WEUXST
     I              EYAATM                          WEAATM
     I              EYAYNA                          WEAYNA
     I              EYA0NA                          WEA0NA
     I              EYAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IYBRDCS      DS                            779
      * Outward parameters
     IPBRC        DS                             10
      * KEY : Order Header TRG          Co/Order Decend/Date Ord
      * I : RST Company Number
     I                                    P   1   20PBAIC3
      * I : RST Order Number
     I                                    P   3   60PBC4NB
      * I : RST Order Date
     I                                    P   7  100PBA0DT
      *
      * Outward parameters
     IPCRC        DS                             10
      * KEY : Order Header TRG          Claim/Co/Order
      * I : RST Claim Number
     I                                    P   1   40PCC0C7
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     IYCRDCS      DS                            525
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WEAIC3
     I              EYC4NB                          WEC4NB
     I              EYQ2NB                          WEQ2NB
     I              EYJPCD                          WEJPCD
     I              EYAUC3                          WEAUC3
     I              EYQ7NB                          WEQ7NB
     I              EYOMST                          WEOMST
     I              EYD2DT                          WED2DT
     I              EYONST                          WEONST
     I              EYOOST                          WEOOST
     I              EYOPST                          WEOPST
     I              EYAWC3                          WEAWC3
     I              EYQ8NB                          WEQ8NB
     I              EYQ9NB                          WEQ9NB
     I              EYBKC7                          WEBKC7
     I              EYUVST                          WEUVST
     I              EYUWST                          WEUWST
     I              EYUXST                          WEUXST
     I              EYAATM                          WEAATM
     I              EYAYNA                          WEAYNA
     I              EYA0NA                          WEA0NA
     I              EYAXDT                          WEAXDT
      *
     IYDRDCS      DS                            779
     IQPDMK1    E DSPDMKCPL0
      * UPD : AR Claim Header           Update index
      *
     IYERDCS      DS                            510
      * Outward parameters
     IPDRC        DS                             10
      * KEY : Order Header TRG          Claim/Co/Order
      * I : RST Claim Number
     I                                    P   1   40PDC0C7
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Types
      * N :  Processing Cycle Type
     I                                        1   1 P1OAST
      * I :  Billing Activity Type
     I                                        2   2 P1OBST
      * N :  Affect Inventory Default
     I                                        3   3 P1OEST
     IP2PARM      DS
      * FLD: *Arrays
      * N :  PRT Printer Device
     I                                        1  10 P2WRST
      * N :  PRT Hold Output Sts
     I                                       11  14 P2WSST
      * N :  PRT Save Output Sts
     I                                       15  18 P2WTST
      * N :  PRT Number of Copies
     I                                       19  200P2DYNB
      * N :  PRT Night Queue Run Sts
     I                                       21  21 P2WUST
      * N :  PRT Night Queue
     I                                       22  31 P2BVVN
      * N :  Company Number Pass   USR
     I                                    P  32  395P2AJAA
      * N :  Customer Number Pass  USR
     I                                    P  40  475P2AJNC
      * N :  Date 1          PASS  USR
     I                                    P  48  555P2AJAB
      * N :  Date 2          PASS  USR
     I                                    P  56  635P2AJAC
      * N :  From Date Pass        USR
     I                                    P  64  715P2AJAD
      * N :  Thru Date Pass        USR
     I                                    P  72  795P2AJAG
      * N :  Order Number 1  PASS  USR
     I                                    P  80  875P2AJAE
      * N :  Order Number 2  PASS  USR
     I                                    P  88  955P2AJAF
      * N :  System Value Numeric
     I                                    P  96 1035P2M8NB
      * N :  Status - Y or N
     I                                      104 104 P2B8ST
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P3AJCD
      * N :  Company Number
     I                                    P   4   50P3AIC3
      * N :  Application Code
     I                                        6  11 P3DNCD
      * N :  Salesperson Code
     I                                       12  14 P3BCCD
      * N :  Allow Multi_Company
     I                                       15  15 P3I6ST
      * N :  Default Printer
     I                                       16  25 P3MPNA
      * N :  First Time Flag
     I                                       26  26 P3TAST
     IP4PARM      DS
      * N :  USR Update Flag
     I                                        1   1 P4R4ST
     IP5PARM      DS
      * N :  Invoice Number PASS
     I                                    P   1   85P5
     IP6PARM      DS
      * FLD: *Arrays
      * N :  Count Records         USR
     I                                    P   1   60P6
      * N :  Cancelled Flag USR
     I                                        7   7 P6HESX
      * N :  Post Flag USR
     I                                        8   8 P6HKSX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Order in use'
      * Order Number
     I                                        1   7 ZA0001
      * Message data for 'Memo Posted'
      * *SFLSEL
     I                                        1   1 ZA0002
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0003
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0004
      * Message data for 'Memo Posted'
      * *SFLSEL
     I                                        1   1 ZA0005
      * Message data for 'Memo Posted'
      * *SFLSEL
     I                                        1   1 ZA0006
      * Message data for 'Memo Posted'
      * *SFLSEL
     I                                        1   1 ZA0007
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0008
      * Message data for 'Memo not elig. to print'
      * *SFLSEL
     I                                        1   1 ZA0009
      * Message data for 'Memo Posted'
      * *SFLSEL
     I                                        1   1 ZA0010
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0011
      * Message data for 'Memo Posted'
      * *SFLSEL
     I                                        1   1 ZA0012
      * Message data for 'Memo Not Elig. to Post-0'
      * *SFLSEL
     I                                        1   1 ZA0013
      * Message data for 'Memo Post Date Required'
      * Actual Shipped Date
     I                                    P   1   40ZA0014
      * Message data for 'Memo Post Date lt ord dt'
      * Actual Shipped Date
     I                                    P   1   40ZA0015
      * Message data for 'Memo Not Elig. to Post'
      * *SFLSEL
     I                                        1   1 ZA0016
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0017
      * Application Code
     I                                       11  16 ZA0018
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0019
      * Application Code
     I                                       11  16 ZA0020
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1OBST    PARM           WP0001  1        Billing Activit
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: PAR.First Time Flag is Yes
     C           P3TAST    IFEQ 'Y'                        *IF
     C                     Z-ADDP3AIC3    #2AIC3           Company Number
      * Set up Description
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           P1OBST    IFEQ '2'                        *IF
     C                     MOVEL*BLANK    #CAUNA           Description
     C                     MOVEL@CN,001   #CAUNA           Description
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Debit Memo
     C           P1OBST    IFEQ '3'                        *IF
     C                     MOVEL*BLANK    #CAUNA           Description
     C                     MOVEL@CN,002   #CAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CAUNA           Description
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       P3TAST           First Time Flag
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEC4NB           Order Number
     C                     KFLD           BEAIC3           Company Number
      * Setup key
     C           #2C4NB    IFEQ *ZERO
     C                     MOVEL*HIVAL    BEC4NB           Order Number
     C                     ELSE
     C                     Z-ADD#2C4NB    BEC4NB
     C                     ENDIF
     C                     Z-ADD#2AIC3    BEAIC3
     C           KPOS      SETLL@BFCPY2
     C                     READ @BFCPY2                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2GNDT    WZGNDT
     C                     MOVEL#2GNDT    WZGNDT           Actual Shipped
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type_Sale
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2BCNA    WZBCNA
     C                     MOVEL#2BCNA    WZBCNA           Customer Purcha
     C           *LIKE     DEFN #2A0DT    WZA0DT
     C                     MOVEL#2A0DT    WZA0DT           Order Date
     C           *LIKE     DEFN #2ATIN    WZATIN
     C                     MOVEL#2ATIN    WZATIN           Attach to Invoi
     C           *LIKE     DEFN #2C0C7    WZC0C7
     C                     MOVEL#2C0C7    WZC0C7           Claim Number
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2GYST    WZGYST
     C                     MOVEL#2GYST    WZGYST           Order Type Prin
     C           *LIKE     DEFN #2T3NB    WZT3NB
     C                     MOVEL#2T3NB    WZT3NB           Attach to Order
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPY2                  90*
     C  N82                READ @BFCPY2                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,42
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2C4NB    IFEQ *ZERO                      Order Number
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           BEAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C                     END
     C           #2JNCD    IFNE *BLANK                     Order Type_Sale
     C           BEJNCD    CABNE#2JNCD    BB020            Order Type_Sale
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BEBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C           #2BCNA    IFNE *BLANK                     Customer Purcha
     C           BEBCNA    CABNE#2BCNA    BB020            Customer Purcha
     C                     END
     C           #2A0DT    IFNE *ZERO                      Order Date
     C           BEA0DT    CABNE#2A0DT    BB020            Order Date
     C                     END
     C           #2ATIN    IFNE *ZERO                      Attach to Invoi
     C           BEATIN    CABNE#2ATIN    BB020            Attach to Invoi
     C                     END
     C           #2C0C7    IFNE *ZERO                      Claim Number
     C           BEC0C7    CABNE#2C0C7    BB020            Claim Number
     C                     END
     C           #2GWST    IFNE *BLANK                     Header Status
     C           BEGWST    CABNE#2GWST    BB020            Header Status
     C                     END
     C           #2GYST    IFNE *BLANK                     Order Type Prin
     C           BEGYST    CABNE#2GYST    BB020            Order Type Prin
     C                     END
     C           #2T3NB    IFNE *ZERO                      Attach to Order
     C           BET3NB    CABNE#2T3NB    BB020            Attach to Order
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * Billing Type exclusion
      * CASE: PAR.Billing Activity Type EQ WRK.BLANK
     C           P1OBST    IFEQ WUGSTX                     *IF
      * Exclude invoice/transfer types
      * CASE: DB1.Billing Activity Type is Invoice or Transfer
     C           BEOBST    IFEQ '1'                        *IF
     C           BEOBST    OREQ '4'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Match passed billing activity type
      * CASE: DB1.Billing Activity Type NE PAR.Billing Activity Type
     C           BEOBST    IFNE P1OBST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Match to CTL company (if any)
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Exclude if no match to existing CTL company
      * CASE: CTL.Company Number is not equal to zero
     C           #2AIC3    IFNE *ZERO                      *IF
      * CASE: DB1.Company Number NE CTL.Company Number
     C           BEAIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Skip cancelled memos
      * CASE: DB1.Header Status is Cancelled
     C           BEGWST    IFEQ 'X'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * ** 11/02/2007 FT133 LJB Don't restrict Credit to debit memos only
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPY2                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Order Date
      * External date
     C                     Z-ADDV2A0DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     Z-ADDXDINDT    #2A0DT
      * Validate Claim Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C0C7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C0C7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C0C7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Header Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2GWST'  IFEQ YPMTFD
      * Header Status
     C                     MOVEL#2GWST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFGWST
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZFGWST
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD2         ZFGWST
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD3         ZFGWST
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD4         ZFGWST
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD5         ZFGWST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD6         ZFGWST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD7         ZFGWST
     C           W0INVL    WHEQ 'H'                        H
     C                     Z-ADD8         ZFGWST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD9         ZFGWST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD10        ZFGWST
     C                     ENDSL
     C                     EXFMTZEGWST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFGWST    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFGWST    WHEQ 2
     C                     MOVEL'L'       W0INVL           L
     C           ZFGWST    WHEQ 3
     C                     MOVEL'A'       W0INVL           A
     C           ZFGWST    WHEQ 4
     C                     MOVEL'X'       W0INVL           X
     C           ZFGWST    WHEQ 5
     C                     MOVEL'C'       W0INVL           C
     C           ZFGWST    WHEQ 6
     C                     MOVEL'R'       W0INVL           R
     C           ZFGWST    WHEQ 7
     C                     MOVEL'E'       W0INVL           E
     C           ZFGWST    WHEQ 8
     C                     MOVEL'H'       W0INVL           H
     C           ZFGWST    WHEQ 9
     C                     MOVEL'I'       W0INVL           I
     C           ZFGWST    WHEQ 10
     C                     MOVEL'N'       W0INVL           N
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2GWST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Order Type Print Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2GYST    W0NSRQ  1        Order Type Prin
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2GYST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158374   Y2LSNO  70
     C           #2GYST    PARM #2GYST    W0EXVL 25        Order Type Prin
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Attach to Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2T3NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2T3NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2T3NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2T3NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZJNCD    CASNE#2JNCD    FBRQRL
     C           WZBKC7    CASNE#2BKC7    FBRQRL
     C           WZBCNA    CASNE#2BCNA    FBRQRL
     C           WZA0DT    CASNE#2A0DT    FBRQRL
     C           WZATIN    CASNE#2ATIN    FBRQRL
     C           WZC0C7    CASNE#2C0C7    FBRQRL
     C           WZGWST    CASNE#2GWST    FBRQRL
     C           WZGYST    CASNE#2GYST    FBRQRL
     C           WZT3NB    CASNE#2T3NB    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * Select on Company Name
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V2AIC3'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0001  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
      * Select on Shipped to Customer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V2BKC7'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #2BKC7    PARM #2BKC7    WQ0002  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     END                             *FI
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * CASE: LCL.Error Status is yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     #2GNDT           Actual Shipped
     C                     MOVEL'N'       YL0001           Error Status
     C                     END                             *FI
      * CASE: CTL.*CMD key is *Create
     C           *IN06     IFEQ '1'                        *IF
      * Create a new Memo.
     C                     EXSR UASUBR                     Create a new Me
     C                     ELSE
      * CASE: CTL.*CMD key is *Print Acknowledgements
     C           *IN13     IFEQ '1'                        *IF
      * Print Acknowledgements.
     C                     EXSR UCSUBR                     Print Acknowled
     C                     ELSE
      * CASE: CTL.*CMD key is *Pre-Invoice Report
     C           *IN14     IFEQ '1'                        *IF
      * Print Pre-Invoice Register
      * CASE: LCL.User Code Model is Credit
     C           YL0002    IFEQ @CN,004                    *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Print Pre-Invoice Register.
     C                     EXSR UDSUBR                     Print Pre-Invoi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,42
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * CASE: RCD.*SFLSEL is *Edit
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
      * Edit Memo.
     C                     EXSR UESUBR                     Edit Memo.
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Cancel
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Cancel Memo.
     C                     EXSR UGSUBR                     Cancel Memo.
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Comments
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * Edit Memo Comments.
     C                     EXSR UHSUBR                     Edit Memo Comme
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Details
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * Edit Memo Details.
     C                     EXSR UJSUBR                     Edit Memo Detai
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * Display Memo.
     C                     EXSR ULSUBR                     Display Memo.
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Print
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
      * Print Memo.
     C                     EXSR UMSUBR                     Print Memo.
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Print Acknowledgment
     C           #1SEL     IFEQ '10'                       *IF
      * Print Memo Acknowledgement.
     C                     EXSR UOSUBR                     Print Memo Ackn
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Post Cr/Dr Memo
     C           #1SEL     IFEQ '11'                       *IF
      * ** Do not allow Credit to post memos            FT133 LJB
      * CASE: LCL.User Code Model is Credit
     C           YL0002    IFEQ @CN,004                    *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0011           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Post Memo.
     C                     EXSR URSUBR                     Post Memo.
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 13
     C           #1SEL     IFEQ '13'                       *IF
      * Print Claim Form, Display, then Delete.
     C                     EXSR UTSUBR                     Print Claim For
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,42
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Delete Request.
     C                     EXSR UUSUBR                     Delete Request.
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Post Cr/Dr Memo
     C           #1SEL     IFEQ '11'                       *IF
      * ** Only prompt for print options once per Post
      * CASE: PAR.Status - Y or N is no
     C           P2B8ST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     Z-ADD1         P2DYNB           PRT Number of C
     C                     MOVEL'*YES'    P2WSST           PRT Hold Output
     C                     MOVEL'*YES'    P2WTST           PRT Save Output
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,012   WQ0113 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0114 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0115  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0116  4        PRT Save Output
     C           P2DYNB    PARM P2DYNB    WQ0117  20       PRT Number of C
     C           P2WUST    PARM P2WUST    WQ0118  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0119 10        PRT Night Queue
     C                     PARM P3DNCD    WQ0120  6        Application Cod
     C                     PARM '1'       WQ0121  1        Paper Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       P2B8ST           Status - Y or N
     C                     END                             *FI
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,013                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP2DYNB    P2M8NB           System Value Nu
      * Post Memo.
     C                     EXSR UZSUBR                     Post Memo.
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P3I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPY2 fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDBEANC7    #1ANC7           AR Customer Num
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip_Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip_Pos
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A_R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non_Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non_Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELBEJNCD    #1JNCD           Order Type_Sale
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1A0DT
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C0C7
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
      * Clear external version also
     C                     MOVEL*BLANK    V1T3NB
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADD*ZERO     #2GNDT           Actual Shipped
     C                     MOVEL*BLANK    #CS4TX           Text 9
     C                     MOVEL*BLANK    #CAUNA           Description
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #2JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #2BCNA           Customer Purcha
     C                     Z-ADD*ZERO     #2A0DT           Order Date
      * Clear external version also
     C                     Z-ADD*ZERO     V2A0DT
     C                     Z-ADD*ZERO     #2ATIN           Attach to Invoi
     C                     Z-ADD*ZERO     #2C0C7           Claim Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C0C7
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     MOVEL*BLANK    #2GYST           Order Type Prin
     C                     Z-ADD*ZERO     #2T3NB           Attach to Order
      * Clear external version also
     C                     MOVEL*BLANK    V2T3NB
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  #1A0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A0DT
      * Convert Claim Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Attach to Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1T3NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1T3NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1T3NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1T3NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  #2A0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2A0DT
      * Convert Claim Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Attach to Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2T3NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2T3NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2T3NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2T3NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NASUBR    BEGSR
      *================================================================
      * Post single memo.
      *================================================================
      * E4057 JJH 04/27/15 - New I Parm:  Attach to Order Number
      *
     C                     Z-ADD*ZERO     WN0247 155       Company Number
     C                     Z-ADD*ZERO     WN0248 155       Invoice Number
     C                     Z-ADD*ZERO     WN0249  50       Event Number
      *
      * Post Credit/Debit      IF
      * E4057 JJH 04/27/15 - New I Parm: Attach to Order Number
      * UPD Event,Sts Ship Dtl RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0006           Company Number
     C                     Z-ADD#1C4NB    WL0007           Order Number
     C                     Z-ADD*ZERO     WL0008           Order Sequence
     C                     Z-ADD*ZERO     WL0009           Order Secondary
     C                     MOVEL'R'       WL0010    P      Detail Line Sta
     C                     Z-ADD#2GNDT    WL0011           Actual Shipped
     C                     MOVEL'06'      WL0012    P      Event Code
     C                     EXSR SERVGN
     C                     Z-ADD*ZERO     WN0249           Event Number
      * RTV Next Event Number  RT - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0013           Company Number
     C                     Z-ADD#1C4NB    WL0014           Order Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    WN0249           Event Number
     C                     ADD  1         WN0249           Event Number
      * CRT OP Order Events    CR - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0016           Company Number
     C                     Z-ADD#1C4NB    WL0017           Order Number
     C                     Z-ADDWN0249    WL0018           Event Number
     C                     MOVEL'06'      WL0019    P      Event Code
     C                     Z-ADD#1AIC3    WL0020           Invoice_Memo Co
     C                     Z-ADD#1CONB    WL0021           Invoice_Memo Nu
     C                     MOVEL#1CEST    WL0022    P      Invoice_Memo Su
     C                     Z-ADD##JDT     WL0023           Event Date
     C                     MOVEL'Y'       WL0024    P      Activity Comple
     C                     MOVEL'Y'       WL0025    P      Activity Hold
     C                     MOVEL'Y'       WL0026    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0027           Cross Event Ref
     C                     Z-ADD*ZERO     WL0028           Cross Event Ref
     C                     Z-ADD*ZERO     WL0029           Cross Event Ref
     C                     Z-ADD#1BKC7    WL0030           Ship To Custome
     C                     EXSR SHCRRC
      * CHG Invc#,Dte,Evt,PrtS CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0031           Company Number
     C                     Z-ADD#1C4NB    WL0032           Order Number
     C                     Z-ADD#2GNDT    WL0033           Actual Shipped
     C                     MOVEL'R'       WL0034    P      Header Status
     C                     MOVEL#1GWST    WL0035    P      Header Status L
     C                     MOVEL*BLANK    WL0036           Order Type Prin
     C                     Z-ADD#1CONB    WL0037           Invoice Number
     C                     MOVEL#1CEST    WL0038    P      Invoice Suffix
     C                     Z-ADD#2GNDT    WL0039           Invoice Date
     C                     MOVEL'06'      WL0040    P      Event Code
     C                     EXSR SICHRC
     C                     Z-ADD#1AIC3    WN0247           Company Number
     C                     Z-ADD#1CONB    WN0248           Invoice Number
      * Order selection
      * 05/30/08 PKD/RMC FP1110 Needed to call the accruals rountine here
      * CASE: PAR.Affect Auto Accruals is Affect Auto Accruals
     C           #1WBST    IFEQ 'Y'                        *IF
      * E4057 JJH 04/23/15 - New I parm for: Attach to Order Number
      * UPD Auto Accruals      XF - Order Detail  * 
     C                     CALL 'PDT5XFR'              90  UPD Auto Accrua
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0122  30       Company Number
     C                     PARM #1C4NB    WQ0123  70       Order Number
     C                     PARM #1ANC7    WQ0124  70       AR Customer Num
     C                     PARM #1CXDT    WQ0125  70       Date of Origina
     C                     PARM #1RMNB    WQ0126  70       Load ID
     C                     PARM #1TBNB    WQ0127  52       Absorbed Freigh
     C                     PARM #1T3NB    WQ0128  70       Attach to Order
     C                     PARM #2GNDT    WQ0129  70       Invoice Date
     C                     PARM #1OBST    WQ0130  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDT5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * UPD Post InvoicesSBMCLUP - /UT User Programs  * 
     C                     CALL 'PDIPSUPR'             90  UPD Post Invoic
     C           W0RTN     PARM *BLANK    WQ0131  7        *Return code
     C                     PARM @CN,014   WQ0132 10        Program name US
     C                     PARM P3DNCD    WQ0133  6        Application Cod
     C           P2WRST    PARM P2WRST    WQ0134 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0135  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0136  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0137  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0138 10        PRT Night Queue
     C                     PARM WN0247    WQ0139 155       Company Number
     C                     PARM WN0248    WQ0140 155       Invoice Number
     C           P2M8NB    PARM P2M8NB    WQ0141 155       System Value Nu
     C                     PARM 'OR'      WQ0142  2        Process Cust Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDIPSUPR'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * Update Claim.
     C                     EXSR NBSUBR                     Update Claim.
      * Send message 'Memos submitted to Post'
     C                     MOVEL'USR2005' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBSUBR    BEGSR
      *================================================================
      * Update Claim.
      *================================================================
      * CASE: PAR.Claim Number is Not Zero
     C           #1C0C7    IFNE 0                          *IF
      * CHG Status only        CH - A/R Claim  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1C0C7    WL0041           Claim Number
     C                     MOVEL'C'       WL0042    P      Claim Status
     C                     EXSR SJCHRC
     C                     END                             *FI
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCSUBR    BEGSR
      *================================================================
      * Check for other memos on the claim, and post all of them.
      *================================================================
      * RTV cnt of ords for memo - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1C0C7    WL0004           Claim Number
     C                     Z-ADDP6        WL0005           Count Records
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P6               Count Records
      * CASE: PAR.Count Records         USR is Greater Than One
     C           P6        IFGT 1                          *IF
      * Warn the user that multiple memos exist for claim, then post.
     C                     EXSR NDSUBR                     Warn the user t
     C                     ELSE
      * CASE: *OTHERWISE
      * Post the single memo associated with the claim.
     C                     EXSR NESUBR                     Post the single
     C                     END                             *FI
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDSUBR    BEGSR
      *================================================================
      * Warn the user that multiple memos exist for claim, then post.
      *================================================================
      * DSP Post Confirm       DF - PD Order Header  * 
     C                     CLEARPDRC
     C                     Z-ADD#1C0C7    PDC0C7           Claim Number
      *
     C                     CALL 'PDXYDFR'              90  DSP Post Confir
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Order Head
     C                     PARM #2GNDT    WQ0143  70       Actual Shipped
     C           P6HKSX    PARM *BLANK    WQ0144  1        Post Flag USR
     C           P2WRST    PARM P2WRST    WQ0145 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0146  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0147  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0148  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0149 10        PRT Night Queue
     C           P2M8NB    PARM P2M8NB    WQ0150 155       System Value Nu
     C                     PARM P3DNCD    WQ0151  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXYDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PAR.Post Flag USR is Yes
     C           P6HKSX    IFEQ 'Y'                        *IF
      * Send message 'Memos submitted to Post'
     C                     MOVEL'USR2005' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NESUBR    BEGSR
      *================================================================
      * Post the single memo associated with the claim.
      *================================================================
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1T3NB' defaulted for 'Attach to Order Number'.
      *
     C                     Z-ADD*ZERO     WN0566 155       Company Number
     C                     Z-ADD*ZERO     WN0567 155       Invoice Number
     C                     Z-ADD*ZERO     WN0568  50       Event Number
      *
      * Post Credit/Debit      IF
      * E4057 JJH 04/27/15 - New I Parm: Attach to Order Number
      * UPD Event,Sts Ship Dtl RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0006           Company Number
     C                     Z-ADD#1C4NB    WL0007           Order Number
     C                     Z-ADD*ZERO     WL0008           Order Sequence
     C                     Z-ADD*ZERO     WL0009           Order Secondary
     C                     MOVEL'R'       WL0010    P      Detail Line Sta
     C                     Z-ADD#2GNDT    WL0011           Actual Shipped
     C                     MOVEL'06'      WL0012    P      Event Code
     C                     EXSR SERVGN
     C                     Z-ADD*ZERO     WN0568           Event Number
      * RTV Next Event Number  RT - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0013           Company Number
     C                     Z-ADD#1C4NB    WL0014           Order Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    WN0568           Event Number
     C                     ADD  1         WN0568           Event Number
      * CRT OP Order Events    CR - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0016           Company Number
     C                     Z-ADD#1C4NB    WL0017           Order Number
     C                     Z-ADDWN0568    WL0018           Event Number
     C                     MOVEL'06'      WL0019    P      Event Code
     C                     Z-ADD#1AIC3    WL0020           Invoice_Memo Co
     C                     Z-ADD#1CONB    WL0021           Invoice_Memo Nu
     C                     MOVEL#1CEST    WL0022    P      Invoice_Memo Su
     C                     Z-ADD##JDT     WL0023           Event Date
     C                     MOVEL'Y'       WL0024    P      Activity Comple
     C                     MOVEL'Y'       WL0025    P      Activity Hold
     C                     MOVEL'Y'       WL0026    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0027           Cross Event Ref
     C                     Z-ADD*ZERO     WL0028           Cross Event Ref
     C                     Z-ADD*ZERO     WL0029           Cross Event Ref
     C                     Z-ADD#1BKC7    WL0030           Ship To Custome
     C                     EXSR SHCRRC
      * CHG Invc#,Dte,Evt,PrtS CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0031           Company Number
     C                     Z-ADD#1C4NB    WL0032           Order Number
     C                     Z-ADD#2GNDT    WL0033           Actual Shipped
     C                     MOVEL'R'       WL0034    P      Header Status
     C                     MOVEL#1GWST    WL0035    P      Header Status L
     C                     MOVEL*BLANK    WL0036           Order Type Prin
     C                     Z-ADD#1CONB    WL0037           Invoice Number
     C                     MOVEL#1CEST    WL0038    P      Invoice Suffix
     C                     Z-ADD#2GNDT    WL0039           Invoice Date
     C                     MOVEL'06'      WL0040    P      Event Code
     C                     EXSR SICHRC
     C                     Z-ADD#1AIC3    WN0566           Company Number
     C                     Z-ADD#1CONB    WN0567           Invoice Number
      * Order selection
      * 05/30/08 PKD/RMC FP1110 Needed to call the accruals rountine here
      * CASE: PAR.Affect Auto Accruals is Affect Auto Accruals
     C           #1WBST    IFEQ 'Y'                        *IF
      * E4057 JJH 04/23/15 - New I parm for: Attach to Order Number
      * UPD Auto Accruals      XF - Order Detail  * 
     C                     CALL 'PDT5XFR'              90  UPD Auto Accrua
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0152  30       Company Number
     C                     PARM #1C4NB    WQ0153  70       Order Number
     C                     PARM #1ANC7    WQ0154  70       AR Customer Num
     C                     PARM #1CXDT    WQ0155  70       Date of Origina
     C                     PARM #1RMNB    WQ0156  70       Load ID
     C                     PARM #1TBNB    WQ0157  52       Absorbed Freigh
     C                     PARM #1T3NB    WQ0158  70       Attach to Order
     C                     PARM #2GNDT    WQ0159  70       Invoice Date
     C                     PARM #1OBST    WQ0160  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDT5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * UPD Post InvoicesSBMCLUP - /UT User Programs  * 
     C                     CALL 'PDIPSUPR'             90  UPD Post Invoic
     C           W0RTN     PARM *BLANK    WQ0161  7        *Return code
     C                     PARM @CN,014   WQ0162 10        Program name US
     C                     PARM P3DNCD    WQ0163  6        Application Cod
     C           P2WRST    PARM P2WRST    WQ0164 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0165  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0166  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0167  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0168 10        PRT Night Queue
     C                     PARM WN0566    WQ0169 155       Company Number
     C                     PARM WN0567    WQ0170 155       Invoice Number
     C           P2M8NB    PARM P2M8NB    WQ0171 155       System Value Nu
     C                     PARM 'OR'      WQ0172  2        Process Cust Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDIPSUPR'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * Update Claim.
     C                     EXSR NFSUBR                     Update Claim.
      * Send message 'Memos submitted to Post'
     C                     MOVEL'USR2005' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFSUBR    BEGSR
      *================================================================
      * Update Claim.
      *================================================================
      * CASE: PAR.Claim Number is Not Zero
     C           #1C0C7    IFNE 0                          *IF
      * CHG Status only        CH - A/R Claim  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1C0C7    WL0041           Claim Number
     C                     MOVEL'C'       WL0042    P      Claim Status
     C                     EXSR SJCHRC
     C                     END                             *FI
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * 041625 SG S020798 Passed parameter to PDJ1UPR as N
      * 041805 slm OMS012A Added new validation rules on when the user
      *            is allowed to select the option
      * 071106 slm Allow the Completed Deb/Crdd to use the 7=details
      *            also allow the Cancel
      * ** FT299 LJB 04/18/2007
      * ** For printing Acknowledgements, if the user does not have
      * ** multi-warehouse authority, then restrict to the user profile w
      * ** DLY029 RMC 09/20/07
      * ** In post-confirm, post memo, display print options prompt
      *   and user quit if F3. this way it wont be displayed from the cl
      *    after some updating has already occurred.
      * ** FT133 LJB 11/02/2007
      * ** Allow Credit to work with Memos, however, do not allow to
      * ** edit, post, update, or change the memos
      * ** Per Aubri, default print hold and save initial values to *YES
      * ** then only display print option window once per option to post
      * 031413 slm e2176 Final process will use the pmt screen to allow
      * the user to select to email the ack to the warehouse
      * The OPTION 10 do not select the email on ack         '
      * due to user is not being allowed to select to do so or not
      * E4057 JJH 04/27/15 - Price Credit Memo Fixes
      * - Pass in new parm: Attach to Order Number to Post Credit/Debit
      *   IF - Order Header TRG
      * E4057 JJH 07/08/15 - Additional Modifications
      * - Change the title from Memo Number to Order Number in CTL
      * P16169 RMC 12/01/2020 ADDED F5 REFRESH, SUBMIT MEMO POST IN PDIPS
      *   FOR ONE MEMO LIKE IT DOES WHEN THE INVOICE IS 0
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV All Dtl Price Sts  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'P'       WUU1ST           Price Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSA01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSA02           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WQSA01           Company Number
     C                     Z-ADDWUC4NB    WQSA02           Order Number
      * Establish starting position
     C           KRSSA     SETLL@BGWKKK                    *
     C           KRSSA     READE@BGWKKK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'U'       WUU1ST           Price Status
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Assumes is priced unless finds 1 item which is unpriced
      * CASE: DB1.Price Status is Unpriced
     C           OMU1ST    IFEQ 'U'                        *IF
     C                     MOVEL'U'       WUU1ST           Price Status
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSA     READE@BGWKKK                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * CHG Price Status       CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0002  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Order in Use
     C                     MOVEL*BLANK    WN0034  1        Header Status
     C                     MOVEL*BLANK    WN0035  1        Header Status L
     C                     MOVEL*BLANK    WN0036  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     Z-ADD*ZERO     WN0040 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0041 112       Order Weight To
     C                     MOVEL*BLANK    WN0042  1        Credit Hold
     C                     MOVEL*BLANK    WN0043  1        Production Hold
     C                     MOVEL*BLANK    WN0044  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0045  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0046  40       Requested Deliv
     C                     MOVEL*BLANK    WN0047  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0048 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0049  70       Load ID
     C                     Z-ADD*ZERO     WN0050  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0051 112       Rated Freight
     C                     MOVEL*BLANK    WN0052  1        LTL Flag
     C                     MOVEL*BLANK    WN0053  1        Price Audit
     C                     MOVEL*BLANK    WN0054  2        Shipping Method
     C                     MOVEL*BLANK    WN0055  1        Export Status
     C                     MOVEL*BLANK    WN0056  1        Palletize
     C                     MOVEL*BLANK    WN0057  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0058  1        Slip Sheet
     C                     MOVEL*BLANK    WN0059  1        Age Code
     C                     Z-ADD*ZERO     WN0060  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0061  1        Load Type
     C                     Z-ADD*ZERO     WN0062  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0063  1        Load Plan Order
     C                     MOVEL*BLANK    WN0064  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0065  70       Resell Referenc
     C                     MOVEL*BLANK    WN0066 30        Special Comment
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  2        Manager Level C
     C                     MOVEL*BLANK    WN0071  3        VP Level Code
     C                     Z-ADD*ZERO     WN0072  70       Attach to Order
     C                     MOVEL*BLANK    WN0073  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0074  70       Invoice Number
     C                     MOVEL*BLANK    WN0075  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0076  70       Invoice Date
     C                     MOVEL*BLANK    WN0077  2        Event Code
     C                     MOVEL*BLANK    WN0078  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0079  1        Modified Flag
     C                     Z-ADD*ZERO     WN0080 112       A_R order Value
     C                     MOVEL*BLANK    WN0081  1        Billing Activit
     C                     MOVEL*BLANK    WN0082  1        Block Order Fla
     C                     MOVEL*BLANK    WN0083  1        Order Certifica
     C                     Z-ADD*ZERO     WN0084 112       Invoice Order V
     C                     MOVEL*BLANK    WN0085  1        Process Sts for
     C                     MOVEL*BLANK    WN0086  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0087  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0088  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0089  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0090  1        Email Cust On O
     C                     MOVEL*BLANK    WN0091  1        Order Emailed
     C                     MOVEL*BLANK    WN0092  1        Export Docs Go
     C                     MOVEL*BLANK    WN0093  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0094  1        Broker Order St
     C                     MOVEL*BLANK    WN0095  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0096  2        Order Requires
     C                     MOVEL*BLANK    WN0097  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0098  2        Export USDA App
     C                     MOVEL*BLANK    WN0099  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0100  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0101  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0102  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0103  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0104  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0105  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0106  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0107  60       Time of Origina
     C                     Z-ADD*ZERO     WN0108  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0109  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0110  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0111 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0112 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0113 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0114 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0115 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0116  70       Claim Number
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#2AIC3    WAAIC3           Company Number
     C                     Z-ADDWUC4NB    WAC4NB           Order Number
      *
     C           KLCHSB    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C           KLCHSB    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWUU1ST    WAU1ST    P      Price Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWAAIC3    PAAIC3           Company Number
     C                     Z-ADDWAC4NB    PAC4NB           Order Number
     C                     MOVELWAJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWAANC7    PAANC7           AR Customer Num
     C                     Z-ADDWABKC7    PABKC7           Ship To Custome
     C                     MOVELWABRTX    PABRTX    P      Ship To Name
     C                     MOVELWAHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWAHONA    PAHONA    P      Ship To Address
     C                     MOVELWAHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWAHNNA    PAHNNA    P      Ship To City
     C                     MOVELWADBCD    PADBCD    P      Ship To State C
     C                     MOVELWACKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWAB0C7    PAB0C7           Bill to Custome
     C                     MOVELWAAETX    PAAETX    P      Bill to Name
     C                     MOVELWAB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWAB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWAB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWAB2NA    PAB2NA    P      Bill to City
     C                     MOVELWABHCD    PABHCD    P      Bill to State C
     C                     MOVELWAC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWABCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWAA0DT    PAA0DT           Order Date
     C                     Z-ADDWAA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWAGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWAACDT    PAACDT           Cancel Date
     C                     MOVELWAAQCD    PAAQCD    P      Terms Code
     C                     MOVELWAB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWABYNA    PABYNA    P      Special Instruc
     C                     MOVELWABZNA    PABZNA    P      Carrier Code
     C                     MOVELWAGTST    PAGTST    P      Comment Print A
     C                     MOVELWAGVST    PAGVST    P      Comment Print I
     C                     MOVELWAGUST    PAGUST    P      Comment Print P
     C                     MOVELWAQFST    PAQFST    P      Comment Print S
     C                     MOVELWACQCD    PACQCD    P      Reason Code
     C                     MOVELWAGJST    PAGJST    P      Order in Use
     C                     MOVELWAGWST    PAGWST    P      Header Status
     C                     MOVELWAGXST    PAGXST    P      Header Status L
     C                     MOVELWAGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWAAODT    PAAODT           Scheduled Ship
     C                     MOVELWAAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWACXDT    PACXDT           Date of Origina
     C                     Z-ADDWAJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWAA1WG    PAA1WG           Order Weight To
     C                     MOVELWAXIST    PAXIST    P      Credit Hold
     C                     MOVELWAXJST    PAXJST    P      Production Hold
     C                     MOVELWAXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWAEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWAAFTM    PAAFTM           Requested Deliv
     C                     MOVELWAE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWAE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWARMNB    PARMNB           Load ID
     C                     Z-ADDWATBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWAR1NB    PAR1NB           Rated Freight
     C                     MOVELWAPJST    PAPJST    P      LTL Flag
     C                     MOVELWAU0ST    PAU0ST    P      Price Audit
     C                     MOVELWAU1ST    PAU1ST    P      Price Status
     C                     MOVELWAQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWAU2ST    PAU2ST    P      Export Status
     C                     MOVELWAVEST    PAVEST    P      Palletize
     C                     MOVELWAVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWAVGST    PAVGST    P      Slip Sheet
     C                     MOVELWARPCD    PARPCD    P      Age Code
     C                     Z-ADDWARNNB    PARNNB           Reefer Temperat
     C                     MOVELWAVDST    PAVDST    P      Load Type
     C                     Z-ADDWAATIN    PAATIN           Attach to Invoi
     C                     MOVELWAU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWAU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWARSRN    PARSRN           Resell Referenc
     C                     MOVELWAMHNA    PAMHNA    P      Special Comment
     C                     MOVELWAMINA    PAMINA    P      Special Comment
     C                     MOVELWAWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWAR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWABFCD    PABFCD    P      Manager Level C
     C                     MOVELWAQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWAT3NB    PAT3NB           Attach to Order
     C                     MOVELWASICD    PASICD    P      Reason for Pric
     C                     Z-ADDWACONB    PACONB           Invoice Number
     C                     MOVELWACEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWAAWDT    PAAWDT           Invoice Date
     C                     MOVELWAJPCD    PAJPCD    P      Event Code
     C                     MOVELWAXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWAZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWAVRVA    PAVRVA           A_R order Value
     C                     MOVELWAOBST    PAOBST    P      Billing Activit
     C                     MOVELWABCST    PABCST    P      Block Order Fla
     C                     MOVELWABDST    PABDST    P      Order Certifica
     C                     Z-ADDWAB7VL    PAB7VL           Invoice Order V
     C                     MOVELWAGASX    PAGASX    P      Process Sts for
     C                     MOVELWAGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWAGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWAGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWAFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWAFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWAFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWAFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWAFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWAFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWAFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWAFUSX    PAFUSX    P      Order Requires
     C                     MOVELWAFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWAFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWAFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWAFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWANODT    PANODT           OH Appt Confirm
     C                     Z-ADDWANPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWANQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWANRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWANSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWABPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWABQTM    PABQTM           Time of Origina
     C                     Z-ADDWABRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWABSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWABTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWAH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWAH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWAH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWAH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWAH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWAC0C7    PAC0C7           Claim Number
     C                     MOVELWAUVST    PAUVST    P      EDI Status 1
     C                     MOVELWAUWST    PAUWST    P      EDI Status 2
     C                     MOVELWAUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWAAATM    PAAATM           Job Time
     C                     MOVELWAAYNA    PAAYNA    P      User Id
     C                     MOVELWAA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWAAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * CHG Reset Order in Use CH - PD Order Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0124  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0125  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0126  70       Ship To Custome
     C                     MOVEL*BLANK    WN0127 30        Ship To Name
     C                     MOVEL*BLANK    WN0128 30        Ship To Address
     C                     MOVEL*BLANK    WN0129 30        Ship To Address
     C                     MOVEL*BLANK    WN0130 30        Ship To Address
     C                     MOVEL*BLANK    WN0131 20        Ship To City
     C                     MOVEL*BLANK    WN0132  2        Ship To State C
     C                     MOVEL*BLANK    WN0133 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0134  70       Bill to Custome
     C                     MOVEL*BLANK    WN0135 30        Bill to Name
     C                     MOVEL*BLANK    WN0136 30        Bill to Address
     C                     MOVEL*BLANK    WN0137 30        Bill to Address
     C                     MOVEL*BLANK    WN0138 30        Bill to Address
     C                     MOVEL*BLANK    WN0139 20        Bill to City
     C                     MOVEL*BLANK    WN0140  2        Bill to State C
     C                     MOVEL*BLANK    WN0141 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0142 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0143  70       Order Date
     C                     Z-ADD*ZERO     WN0144  70       Requested Ship
     C                     Z-ADD*ZERO     WN0145  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0146  70       Cancel Date
     C                     MOVEL*BLANK    WN0147  2        Terms Code
     C                     MOVEL*BLANK    WN0148 40        Special Instruc
     C                     MOVEL*BLANK    WN0149 40        Special Instruc
     C                     MOVEL*BLANK    WN0150  3        Carrier Code
     C                     MOVEL*BLANK    WN0151  1        Comment Print A
     C                     MOVEL*BLANK    WN0152  1        Comment Print I
     C                     MOVEL*BLANK    WN0153  1        Comment Print P
     C                     MOVEL*BLANK    WN0154  1        Comment Print S
     C                     MOVEL*BLANK    WN0155  3        Reason Code
     C                     MOVEL*BLANK    WN0156  1        Header Status
     C                     MOVEL*BLANK    WN0157  1        Header Status L
     C                     MOVEL*BLANK    WN0158  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0159  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0160 10        User Original E
     C                     Z-ADD*ZERO     WN0161  70       Date of Origina
     C                     Z-ADD*ZERO     WN0162 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0163 112       Order Weight To
     C                     MOVEL*BLANK    WN0164  1        Credit Hold
     C                     MOVEL*BLANK    WN0165  1        Production Hold
     C                     MOVEL*BLANK    WN0166  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0167  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0168  40       Requested Deliv
     C                     MOVEL*BLANK    WN0169  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0170 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0171  70       Load ID
     C                     Z-ADD*ZERO     WN0172  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0173 112       Rated Freight
     C                     MOVEL*BLANK    WN0174  1        LTL Flag
     C                     MOVEL*BLANK    WN0175  1        Price Audit
     C                     MOVEL*BLANK    WN0176  1        Price Status
     C                     MOVEL*BLANK    WN0177  2        Shipping Method
     C                     MOVEL*BLANK    WN0178  1        Export Status
     C                     MOVEL*BLANK    WN0179  1        Palletize
     C                     MOVEL*BLANK    WN0180  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0181  1        Slip Sheet
     C                     MOVEL*BLANK    WN0182  1        Age Code
     C                     Z-ADD*ZERO     WN0183  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0184  1        Load Type
     C                     Z-ADD*ZERO     WN0185  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0186  1        Load Plan Order
     C                     MOVEL*BLANK    WN0187  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0188  70       Resell Referenc
     C                     MOVEL*BLANK    WN0189 30        Special Comment
     C                     MOVEL*BLANK    WN0190 30        Special Comment
     C                     MOVEL*BLANK    WN0191  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0192  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0193  2        Manager Level C
     C                     MOVEL*BLANK    WN0194  3        VP Level Code
     C                     Z-ADD*ZERO     WN0195  70       Attach to Order
     C                     MOVEL*BLANK    WN0196  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0197  70       Invoice Number
     C                     MOVEL*BLANK    WN0198  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0199  70       Invoice Date
     C                     MOVEL*BLANK    WN0200  2        Event Code
     C                     MOVEL*BLANK    WN0201  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0202  1        Modified Flag
     C                     Z-ADD*ZERO     WN0203 112       A_R order Value
     C                     MOVEL*BLANK    WN0204  1        Billing Activit
     C                     MOVEL*BLANK    WN0205  1        Block Order Fla
     C                     MOVEL*BLANK    WN0206  1        Order Certifica
     C                     Z-ADD*ZERO     WN0207 112       Invoice Order V
     C                     MOVEL*BLANK    WN0208  1        Process Sts for
     C                     MOVEL*BLANK    WN0209  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0210  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0211  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0212  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0213  1        Email Cust On O
     C                     MOVEL*BLANK    WN0214  1        Order Emailed
     C                     MOVEL*BLANK    WN0215  1        Export Docs Go
     C                     MOVEL*BLANK    WN0216  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0217  1        Broker Order St
     C                     MOVEL*BLANK    WN0218  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0219  2        Order Requires
     C                     MOVEL*BLANK    WN0220  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0221  2        Export USDA App
     C                     MOVEL*BLANK    WN0222  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0223  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0224  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0225  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0226  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0227  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0228  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0229  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0230  60       Time of Origina
     C                     Z-ADD*ZERO     WN0231  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0232  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0233  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0234 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0235 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0236 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0237 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0238 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0239  70       Claim Number
     C                     MOVEL*BLANK    WN0240  1        EDI Status 1
     C                     MOVEL*BLANK    WN0241  1        EDI Status 2
     C                     MOVEL*BLANK    WN0242  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0243  60       Job Time
     C                     MOVEL*BLANK    WN0244 10        User Id
     C                     MOVEL*BLANK    WN0245 10        Job Name
     C                     Z-ADD*ZERO     WN0246  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     Z-ADDWL0002    WAC4NB           Order Number
      *
     C           KLCHSC    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C           KLCHSC    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YBRDCS
      * USER: Processing after Data read
      * If setting order in use to YES, order can't already be in use
      * CASE: PAR.Order in Use is yes
     C           WL0003    IFEQ 'Y'                        *IF
      * CASE: DB1.Order in Use is yes
     C           WAGJST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WL0002    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWL0002    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use'
     C                     MOVEL'USR0508' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y2U0004' W0RTN            *Return code
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0003    WAGJST    P      Order in Use
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWAAIC3    PAAIC3           Company Number
     C                     Z-ADDWAC4NB    PAC4NB           Order Number
     C                     MOVELWAJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWAANC7    PAANC7           AR Customer Num
     C                     Z-ADDWABKC7    PABKC7           Ship To Custome
     C                     MOVELWABRTX    PABRTX    P      Ship To Name
     C                     MOVELWAHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWAHONA    PAHONA    P      Ship To Address
     C                     MOVELWAHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWAHNNA    PAHNNA    P      Ship To City
     C                     MOVELWADBCD    PADBCD    P      Ship To State C
     C                     MOVELWACKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWAB0C7    PAB0C7           Bill to Custome
     C                     MOVELWAAETX    PAAETX    P      Bill to Name
     C                     MOVELWAB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWAB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWAB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWAB2NA    PAB2NA    P      Bill to City
     C                     MOVELWABHCD    PABHCD    P      Bill to State C
     C                     MOVELWAC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWABCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWAA0DT    PAA0DT           Order Date
     C                     Z-ADDWAA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWAGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWAACDT    PAACDT           Cancel Date
     C                     MOVELWAAQCD    PAAQCD    P      Terms Code
     C                     MOVELWAB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWABYNA    PABYNA    P      Special Instruc
     C                     MOVELWABZNA    PABZNA    P      Carrier Code
     C                     MOVELWAGTST    PAGTST    P      Comment Print A
     C                     MOVELWAGVST    PAGVST    P      Comment Print I
     C                     MOVELWAGUST    PAGUST    P      Comment Print P
     C                     MOVELWAQFST    PAQFST    P      Comment Print S
     C                     MOVELWACQCD    PACQCD    P      Reason Code
     C                     MOVELWAGJST    PAGJST    P      Order in Use
     C                     MOVELWAGWST    PAGWST    P      Header Status
     C                     MOVELWAGXST    PAGXST    P      Header Status L
     C                     MOVELWAGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWAAODT    PAAODT           Scheduled Ship
     C                     MOVELWAAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWACXDT    PACXDT           Date of Origina
     C                     Z-ADDWAJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWAA1WG    PAA1WG           Order Weight To
     C                     MOVELWAXIST    PAXIST    P      Credit Hold
     C                     MOVELWAXJST    PAXJST    P      Production Hold
     C                     MOVELWAXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWAEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWAAFTM    PAAFTM           Requested Deliv
     C                     MOVELWAE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWAE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWARMNB    PARMNB           Load ID
     C                     Z-ADDWATBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWAR1NB    PAR1NB           Rated Freight
     C                     MOVELWAPJST    PAPJST    P      LTL Flag
     C                     MOVELWAU0ST    PAU0ST    P      Price Audit
     C                     MOVELWAU1ST    PAU1ST    P      Price Status
     C                     MOVELWAQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWAU2ST    PAU2ST    P      Export Status
     C                     MOVELWAVEST    PAVEST    P      Palletize
     C                     MOVELWAVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWAVGST    PAVGST    P      Slip Sheet
     C                     MOVELWARPCD    PARPCD    P      Age Code
     C                     Z-ADDWARNNB    PARNNB           Reefer Temperat
     C                     MOVELWAVDST    PAVDST    P      Load Type
     C                     Z-ADDWAATIN    PAATIN           Attach to Invoi
     C                     MOVELWAU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWAU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWARSRN    PARSRN           Resell Referenc
     C                     MOVELWAMHNA    PAMHNA    P      Special Comment
     C                     MOVELWAMINA    PAMINA    P      Special Comment
     C                     MOVELWAWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWAR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWABFCD    PABFCD    P      Manager Level C
     C                     MOVELWAQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWAT3NB    PAT3NB           Attach to Order
     C                     MOVELWASICD    PASICD    P      Reason for Pric
     C                     Z-ADDWACONB    PACONB           Invoice Number
     C                     MOVELWACEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWAAWDT    PAAWDT           Invoice Date
     C                     MOVELWAJPCD    PAJPCD    P      Event Code
     C                     MOVELWAXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWAZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWAVRVA    PAVRVA           A_R order Value
     C                     MOVELWAOBST    PAOBST    P      Billing Activit
     C                     MOVELWABCST    PABCST    P      Block Order Fla
     C                     MOVELWABDST    PABDST    P      Order Certifica
     C                     Z-ADDWAB7VL    PAB7VL           Invoice Order V
     C                     MOVELWAGASX    PAGASX    P      Process Sts for
     C                     MOVELWAGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWAGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWAGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWAFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWAFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWAFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWAFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWAFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWAFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWAFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWAFUSX    PAFUSX    P      Order Requires
     C                     MOVELWAFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWAFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWAFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWAFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWANODT    PANODT           OH Appt Confirm
     C                     Z-ADDWANPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWANQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWANRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWANSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWABPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWABQTM    PABQTM           Time of Origina
     C                     Z-ADDWABRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWABSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWABTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWAH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWAH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWAH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWAH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWAH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWAC0C7    PAC0C7           Claim Number
     C                     MOVELWAUVST    PAUVST    P      EDI Status 1
     C                     MOVELWAUWST    PAUWST    P      EDI Status 2
     C                     MOVELWAUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWAAATM    PAAATM           Job Time
     C                     MOVELWAAYNA    PAAYNA    P      User Id
     C                     MOVELWAA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWAAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV cnt of ords for memo - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0005           Count Records
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBC0C7    WQSD01           Claim Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Claim Number
      * Setup key
     C                     Z-ADDWL0004    WQSD01           Claim Number
      * Establish starting position
     C           KRSSD     SETLL@BFCPA6                    *
     C           KRSSD     READE@BFCPA6                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Header Status is Cancelled
     C           WBGWST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WL0005           Count Records
     C                     END                             *FI
     C           KRSSD     READE@BFCPA6                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * UPD Event,Sts Ship Dtl RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSE02           Order Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDWL0006    WQSE01           Company Number
     C                     Z-ADDWL0007    WQSE02           Order Number
     C                     Z-ADDWL0008    WCDPNB           Order Sequence
     C                     Z-ADDWL0009    WCUENB           Order Secondary
      * Establish starting position
     C           KPSSE     SETLL@BGWKAE                    *
     C           KRSSE     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Act Shp,Sts,Evt    CH - Order Detail  * 
     C                     EXSR SFCHRC
     C           KRSSE     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG Act Shp,Sts,Evt    CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0250  70       Item Code
     C                     MOVEL*BLANK    WN0251  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0252  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0253  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0254 112       Billing Detail
     C                     Z-ADD*ZERO     WN0255 112       Billing Detail
     C                     Z-ADD*ZERO     WN0256 112       Billing Detail
     C                     Z-ADD*ZERO     WN0257 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0258  1        Comment Print A
     C                     MOVEL*BLANK    WN0259  1        Comment Print I
     C                     MOVEL*BLANK    WN0260  1        Comment Print P
     C                     MOVEL*BLANK    WN0261  1        Comment Print S
     C                     Z-ADD*ZERO     WN0262 112       Extended Amount
     C                     Z-ADD*ZERO     WN0263  70       Market Pricing
     C                     MOVEL*BLANK    WN0264  3        Commodity Marke
     C                     MOVEL*BLANK    WN0265  3        Date Method Cod
     C                     MOVEL*BLANK    WN0266  3        Price Method Co
     C                     Z-ADD*ZERO     WN0267 114       Price Overage O
     C                     Z-ADD*ZERO     WN0268  70       Contract Number
     C                     MOVEL*BLANK    WN0269  1        Price Status
     C                     Z-ADD*ZERO     WN0270  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0271  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0272  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0273  1        Work Confirm St
     C                     MOVEL*BLANK    WN0274  1        Work Over_Short
     C                     MOVEL*BLANK    WN0275  1        OD Production P
     C                     MOVEL*BLANK    WN0276 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0277 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0278  1        Age Code
     C                     MOVEL*BLANK    WN0279  1        Palletize
     C                     MOVEL*BLANK    WN0280  1        Slip Sheet
     C                     MOVEL*BLANK    WN0281  1        Catch Weight St
     C                     MOVEL*BLANK    WN0282  1        Price Audit
     C                     MOVEL*BLANK    WN0283  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0284  1        Production Date
     C                     Z-ADD*ZERO     WN0285 112       Rated Freight
     C                     Z-ADD*ZERO     WN0286 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0287 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0288 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0289 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0290 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0291 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0292 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0293 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0294 114       Unit Price
     C                     Z-ADD*ZERO     WN0295 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0296 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0297 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0298 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0299  70       Requested Ship
     C                     Z-ADD*ZERO     WN0300  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0301  1        Affect Inventor
     C                     MOVEL*BLANK    WN0302  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0303  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0304  30       Item Structure
     C                     Z-ADD*ZERO     WN0305  30       Item Structure
     C                     Z-ADD*ZERO     WN0306  30       Item Structure
     C                     MOVEL*BLANK    WN0307  2        Item Level
     C                     MOVEL*BLANK    WN0308  2        Quality Level
     C                     MOVEL*BLANK    WN0309  2        Pricing Product
     C                     MOVEL*BLANK    WN0310  2        Season Product
     C                     Z-ADD*ZERO     WN0311  70       Date of Origina
     C                     MOVEL*BLANK    WN0312 10        User Profile Na
     C                     MOVEL*BLANK    WN0313  6        Country Code
     C                     MOVEL*BLANK    WN0314  3        Reason Code
     C                     MOVEL*BLANK    WN0315  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0316  1        Modified Flag
     C                     MOVEL*BLANK    WN0317  1        Substituted Fla
     C                     MOVEL*BLANK    WN0318  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0319 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0320 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0321  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0322  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0323  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0324  1        Affect Commissi
     C                     MOVEL*BLANK    WN0325  1        Affect Pricing
     C                     MOVEL*BLANK    WN0326  1        Released by Use
     C                     MOVEL*BLANK    WN0327  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0328  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0329  3        Production Ware
     C                     MOVEL*BLANK    WN0330  3        OD Price Type
     C                     Z-ADD*ZERO     WN0331  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0332  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0333  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0334  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0335  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0336  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0337  60       Price Code
     C                     Z-ADD*ZERO     WN0338  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0339  60       Substitution Li
     C                     Z-ADD*ZERO     WN0340  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0341 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0342 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0343 112       OD Item Target
     C                     Z-ADD*ZERO     WN0344 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0345 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0346 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0347 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0348 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0349 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0350 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0351 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0352 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0353 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0354  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0355  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0356  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0357 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0358  40       Item Age Days
     C                     Z-ADD*ZERO     WN0359  70       Production Ovr
     C                     Z-ADD*ZERO     WN0360  70       Production Ovr
     C                     MOVEL*BLANK    WN0361  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0362  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0363  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0364  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0365  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0366  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0367  1        EDI Status 1
     C                     MOVEL*BLANK    WN0368  1        EDI Status 2
     C                     MOVEL*BLANK    WN0369  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0370  60       Job Time
     C                     MOVEL*BLANK    WN0371 10        User Id
     C                     MOVEL*BLANK    WN0372 10        Job Name
     C                     Z-ADD*ZERO     WN0373  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCC4NB    WDC4NB           Order Number
     C                     Z-ADDWCDPNB    WDDPNB           Order Sequence
     C                     Z-ADDWCUENB    WDUENB           Order Secondary
      *
     C           KLCHSF    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C           KLCHSF    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YCRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0010    WDGMST    P      Detail Line Sta
     C                     MOVELWCGNST    WDGNST    P      Detail Line Sta
     C                     Z-ADDWL0011    WDGNDT           Actual Shipped
     C                     MOVELWL0012    WDJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Next Event Number  RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQSG01           Company Number
     C           *LIKE     DEFN EYC4NB    WQSG02           Order Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           EYQ2NB           Event Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADDWL0013    WQSG01           Company Number
     C                     Z-ADDWL0014    WQSG02           Order Number
     C                     Z-ADDWL0015    EYQ2NB           Event Number
      * Establish starting position
     C           KPSSG     SETLL@EYCPY2                    *
     C           KRSSG     READE@EYCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0015           Event Number
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDEYQ2NB    WL0015           Event Number
     C           KRSSG     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - OP Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0374  1        EDI Status 1
     C                     MOVEL*BLANK    WN0375  1        EDI Status 2
     C                     MOVEL*BLANK    WN0376  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0377  60       Job Time
     C                     MOVEL*BLANK    WN0378 10        User Id
     C                     MOVEL*BLANK    WN0379 10        Job Name
     C                     Z-ADD*ZERO     WN0380  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWL0016    WEAIC3           Company Number
     C                     Z-ADDWL0017    WEC4NB           Order Number
     C                     Z-ADDWL0018    WEQ2NB           Event Number
     C                     MOVELWL0019    WEJPCD           Event Code
     C                     Z-ADDWL0020    WEAUC3           Invoice_Memo Co
     C                     Z-ADDWL0021    WEQ7NB           Invoice_Memo Nu
     C                     MOVELWL0022    WEOMST           Invoice_Memo Su
     C                     Z-ADDWL0023    WED2DT           Event Date
     C                     MOVELWL0024    WEONST           Activity Comple
     C                     MOVELWL0025    WEOOST           Activity Hold
     C                     MOVELWL0026    WEOPST           Post Cash Compl
     C                     Z-ADDWL0027    WEAWC3           Cross Event Ref
     C                     Z-ADDWL0028    WEQ8NB           Cross Event Ref
     C                     Z-ADDWL0029    WEQ9NB           Cross Event Ref
     C                     Z-ADDWL0030    WEBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSH    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSH    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * CHG Invc#,Dte,Evt,PrtS CH - PD Order Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0381  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0382  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0383  70       Ship To Custome
     C                     MOVEL*BLANK    WN0384 30        Ship To Name
     C                     MOVEL*BLANK    WN0385 30        Ship To Address
     C                     MOVEL*BLANK    WN0386 30        Ship To Address
     C                     MOVEL*BLANK    WN0387 30        Ship To Address
     C                     MOVEL*BLANK    WN0388 20        Ship To City
     C                     MOVEL*BLANK    WN0389  2        Ship To State C
     C                     MOVEL*BLANK    WN0390 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0391  70       Bill to Custome
     C                     MOVEL*BLANK    WN0392 30        Bill to Name
     C                     MOVEL*BLANK    WN0393 30        Bill to Address
     C                     MOVEL*BLANK    WN0394 30        Bill to Address
     C                     MOVEL*BLANK    WN0395 30        Bill to Address
     C                     MOVEL*BLANK    WN0396 20        Bill to City
     C                     MOVEL*BLANK    WN0397  2        Bill to State C
     C                     MOVEL*BLANK    WN0398 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0399 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0400  70       Order Date
     C                     Z-ADD*ZERO     WN0401  70       Requested Ship
     C                     Z-ADD*ZERO     WN0402  70       Cancel Date
     C                     MOVEL*BLANK    WN0403  2        Terms Code
     C                     MOVEL*BLANK    WN0404 40        Special Instruc
     C                     MOVEL*BLANK    WN0405 40        Special Instruc
     C                     MOVEL*BLANK    WN0406  3        Carrier Code
     C                     MOVEL*BLANK    WN0407  1        Comment Print A
     C                     MOVEL*BLANK    WN0408  1        Comment Print I
     C                     MOVEL*BLANK    WN0409  1        Comment Print P
     C                     MOVEL*BLANK    WN0410  1        Comment Print S
     C                     MOVEL*BLANK    WN0411  3        Reason Code
     C                     MOVEL*BLANK    WN0412  1        Order in Use
     C                     Z-ADD*ZERO     WN0413  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0414 10        User Original E
     C                     Z-ADD*ZERO     WN0415  70       Date of Origina
     C                     Z-ADD*ZERO     WN0416 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0417 112       Order Weight To
     C                     MOVEL*BLANK    WN0418  1        Credit Hold
     C                     MOVEL*BLANK    WN0419  1        Production Hold
     C                     MOVEL*BLANK    WN0420  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0421  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0422  40       Requested Deliv
     C                     MOVEL*BLANK    WN0423  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0424 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0425  70       Load ID
     C                     Z-ADD*ZERO     WN0426  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0427 112       Rated Freight
     C                     MOVEL*BLANK    WN0428  1        LTL Flag
     C                     MOVEL*BLANK    WN0429  1        Price Audit
     C                     MOVEL*BLANK    WN0430  1        Price Status
     C                     MOVEL*BLANK    WN0431  2        Shipping Method
     C                     MOVEL*BLANK    WN0432  1        Export Status
     C                     MOVEL*BLANK    WN0433  1        Palletize
     C                     MOVEL*BLANK    WN0434  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0435  1        Slip Sheet
     C                     MOVEL*BLANK    WN0436  1        Age Code
     C                     Z-ADD*ZERO     WN0437  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0438  1        Load Type
     C                     Z-ADD*ZERO     WN0439  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0440  1        Load Plan Order
     C                     MOVEL*BLANK    WN0441  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0442  70       Resell Referenc
     C                     MOVEL*BLANK    WN0443 30        Special Comment
     C                     MOVEL*BLANK    WN0444 30        Special Comment
     C                     MOVEL*BLANK    WN0445  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0446  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0447  2        Manager Level C
     C                     MOVEL*BLANK    WN0448  3        VP Level Code
     C                     Z-ADD*ZERO     WN0449  70       Attach to Order
     C                     MOVEL*BLANK    WN0450  3        Reason for Pric
     C                     MOVEL*BLANK    WN0451  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0452  1        Modified Flag
     C                     Z-ADD*ZERO     WN0453 112       A_R order Value
     C                     MOVEL*BLANK    WN0454  1        Billing Activit
     C                     MOVEL*BLANK    WN0455  1        Block Order Fla
     C                     MOVEL*BLANK    WN0456  1        Order Certifica
     C                     Z-ADD*ZERO     WN0457 112       Invoice Order V
     C                     MOVEL*BLANK    WN0458  1        Process Sts for
     C                     MOVEL*BLANK    WN0459  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0460  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0461  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0462  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0463  1        Email Cust On O
     C                     MOVEL*BLANK    WN0464  1        Order Emailed
     C                     MOVEL*BLANK    WN0465  1        Export Docs Go
     C                     MOVEL*BLANK    WN0466  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0467  1        Broker Order St
     C                     MOVEL*BLANK    WN0468  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0469  2        Order Requires
     C                     MOVEL*BLANK    WN0470  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0471  2        Export USDA App
     C                     MOVEL*BLANK    WN0472  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0473  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0474  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0475  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0476  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0477  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0478  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0479  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0480  60       Time of Origina
     C                     Z-ADD*ZERO     WN0481  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0482  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0483  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0484 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0485 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0486 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0487 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0488 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0489  70       Claim Number
     C                     MOVEL*BLANK    WN0490  1        EDI Status 1
     C                     MOVEL*BLANK    WN0491  1        EDI Status 2
     C                     MOVEL*BLANK    WN0492  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0493  60       Job Time
     C                     MOVEL*BLANK    WN0494 10        User Id
     C                     MOVEL*BLANK    WN0495 10        Job Name
     C                     Z-ADD*ZERO     WN0496  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0031    WAAIC3           Company Number
     C                     Z-ADDWL0032    WAC4NB           Order Number
      *
     C           KLCHSI    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C           KLCHSI    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YDRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0033    WAGNDT           Actual Shipped
     C                     MOVELWL0034    WAGWST    P      Header Status
     C                     MOVELWL0035    WAGXST    P      Header Status L
     C                     MOVELWL0036    WAGYST    P      Order Type Prin
     C                     Z-ADDWL0037    WACONB           Invoice Number
     C                     MOVELWL0038    WACEST    P      Invoice Suffix
     C                     Z-ADDWL0039    WAAWDT           Invoice Date
     C                     MOVELWL0040    WAJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWAAIC3    PAAIC3           Company Number
     C                     Z-ADDWAC4NB    PAC4NB           Order Number
     C                     MOVELWAJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWAANC7    PAANC7           AR Customer Num
     C                     Z-ADDWABKC7    PABKC7           Ship To Custome
     C                     MOVELWABRTX    PABRTX    P      Ship To Name
     C                     MOVELWAHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWAHONA    PAHONA    P      Ship To Address
     C                     MOVELWAHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWAHNNA    PAHNNA    P      Ship To City
     C                     MOVELWADBCD    PADBCD    P      Ship To State C
     C                     MOVELWACKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWAB0C7    PAB0C7           Bill to Custome
     C                     MOVELWAAETX    PAAETX    P      Bill to Name
     C                     MOVELWAB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWAB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWAB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWAB2NA    PAB2NA    P      Bill to City
     C                     MOVELWABHCD    PABHCD    P      Bill to State C
     C                     MOVELWAC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWABCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWAA0DT    PAA0DT           Order Date
     C                     Z-ADDWAA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWAGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWAACDT    PAACDT           Cancel Date
     C                     MOVELWAAQCD    PAAQCD    P      Terms Code
     C                     MOVELWAB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWABYNA    PABYNA    P      Special Instruc
     C                     MOVELWABZNA    PABZNA    P      Carrier Code
     C                     MOVELWAGTST    PAGTST    P      Comment Print A
     C                     MOVELWAGVST    PAGVST    P      Comment Print I
     C                     MOVELWAGUST    PAGUST    P      Comment Print P
     C                     MOVELWAQFST    PAQFST    P      Comment Print S
     C                     MOVELWACQCD    PACQCD    P      Reason Code
     C                     MOVELWAGJST    PAGJST    P      Order in Use
     C                     MOVELWAGWST    PAGWST    P      Header Status
     C                     MOVELWAGXST    PAGXST    P      Header Status L
     C                     MOVELWAGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWAAODT    PAAODT           Scheduled Ship
     C                     MOVELWAAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWACXDT    PACXDT           Date of Origina
     C                     Z-ADDWAJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWAA1WG    PAA1WG           Order Weight To
     C                     MOVELWAXIST    PAXIST    P      Credit Hold
     C                     MOVELWAXJST    PAXJST    P      Production Hold
     C                     MOVELWAXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWAEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWAAFTM    PAAFTM           Requested Deliv
     C                     MOVELWAE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWAE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWARMNB    PARMNB           Load ID
     C                     Z-ADDWATBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWAR1NB    PAR1NB           Rated Freight
     C                     MOVELWAPJST    PAPJST    P      LTL Flag
     C                     MOVELWAU0ST    PAU0ST    P      Price Audit
     C                     MOVELWAU1ST    PAU1ST    P      Price Status
     C                     MOVELWAQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWAU2ST    PAU2ST    P      Export Status
     C                     MOVELWAVEST    PAVEST    P      Palletize
     C                     MOVELWAVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWAVGST    PAVGST    P      Slip Sheet
     C                     MOVELWARPCD    PARPCD    P      Age Code
     C                     Z-ADDWARNNB    PARNNB           Reefer Temperat
     C                     MOVELWAVDST    PAVDST    P      Load Type
     C                     Z-ADDWAATIN    PAATIN           Attach to Invoi
     C                     MOVELWAU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWAU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWARSRN    PARSRN           Resell Referenc
     C                     MOVELWAMHNA    PAMHNA    P      Special Comment
     C                     MOVELWAMINA    PAMINA    P      Special Comment
     C                     MOVELWAWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWAR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWABFCD    PABFCD    P      Manager Level C
     C                     MOVELWAQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWAT3NB    PAT3NB           Attach to Order
     C                     MOVELWASICD    PASICD    P      Reason for Pric
     C                     Z-ADDWACONB    PACONB           Invoice Number
     C                     MOVELWACEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWAAWDT    PAAWDT           Invoice Date
     C                     MOVELWAJPCD    PAJPCD    P      Event Code
     C                     MOVELWAXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWAZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWAVRVA    PAVRVA           A_R order Value
     C                     MOVELWAOBST    PAOBST    P      Billing Activit
     C                     MOVELWABCST    PABCST    P      Block Order Fla
     C                     MOVELWABDST    PABDST    P      Order Certifica
     C                     Z-ADDWAB7VL    PAB7VL           Invoice Order V
     C                     MOVELWAGASX    PAGASX    P      Process Sts for
     C                     MOVELWAGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWAGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWAGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWAFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWAFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWAFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWAFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWAFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWAFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWAFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWAFUSX    PAFUSX    P      Order Requires
     C                     MOVELWAFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWAFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWAFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWAFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWANODT    PANODT           OH Appt Confirm
     C                     Z-ADDWANPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWANQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWANRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWANSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWABPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWABQTM    PABQTM           Time of Origina
     C                     Z-ADDWABRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWABSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWABTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWAH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWAH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWAH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWAH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWAH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWAC0C7    PAC0C7           Claim Number
     C                     MOVELWAUVST    PAUVST    P      EDI Status 1
     C                     MOVELWAUWST    PAUWST    P      EDI Status 2
     C                     MOVELWAUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWAAATM    PAAATM           Job Time
     C                     MOVELWAAYNA    PAAYNA    P      User Id
     C                     MOVELWAA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWAAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * CHG Status only        CH - A/R Claim  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0497  3        Salesperson to
     C                     Z-ADD*ZERO     WN0498  30       Claim Company N
     C                     Z-ADD*ZERO     WN0499  70       Claim Order Num
     C                     Z-ADD*ZERO     WN0500  70       Load ID
     C                     Z-ADD*ZERO     WN0501  70       Claim Ship to C
     C                     MOVEL*BLANK    WN0502 30        Claim Customer
     C                     MOVEL*BLANK    WN0503  2        Claim Type
     C                     Z-ADD*ZERO     WN0504 112       Claim Amount
     C                     Z-ADD*ZERO     WN0505 112       Claim Net Loss
     C                     Z-ADD*ZERO     WN0506 112       Claim Approved
     C                     MOVEL*BLANK    WN0507 30        Claim Contact N
     C                     MOVEL*BLANK    WN0508  1        Product Inspect
     C                     MOVEL*BLANK    WN0509 25        Product Inspect
     C                     MOVEL*BLANK    WN0510  1        Rep Inspection
     C                     MOVEL*BLANK    WN0511 25        Rep Inspection
     C                     MOVEL*BLANK    WN0512  1        Lab Fee Involve
     C                     Z-ADD*ZERO     WN0513 112       Lab Fee
     C                     MOVEL*BLANK    WN0514 25        Driver Name
     C                     MOVEL*BLANK    WN0515 25        Lab Name
     C                     Z-ADD*ZERO     WN0516  70       Resolve Claim b
     C                     Z-ADD*ZERO     WN0517  70       Actual Delivery
     C                     MOVEL*BLANK    WN0518  1        Claim Called in
     C                     MOVEL*BLANK    WN0519 25        Claim Called in
     C                     Z-ADD*ZERO     WN0520  70       Claim Called in
     C                     Z-ADD*ZERO     WN0521  70       Claim Entry Dat
     C                     Z-ADD*ZERO     WN0522  60       Claim Entry Tim
     C                     MOVEL*BLANK    WN0523 10        Claim Entry Use
     C                     Z-ADD*ZERO     WN0524  70       Resale Ship to
     C                     MOVEL*BLANK    WN0525 15        Resale Purchase
     C                     Z-ADD*ZERO     WN0526  70       Sales Approved
     C                     Z-ADD*ZERO     WN0527  60       Sales Approved
     C                     MOVEL*BLANK    WN0528 10        Sales Approved
     C                     Z-ADD*ZERO     WN0529  70       Approved_Denied
     C                     Z-ADD*ZERO     WN0530  60       Approved_Denied
     C                     MOVEL*BLANK    WN0531 10        Approved_Denied
     C                     MOVEL*BLANK    WN0532  1        Memo Created
     C                     Z-ADD*ZERO     WN0533  70       Memo Created Da
     C                     Z-ADD*ZERO     WN0534  60       Memo Created Ti
     C                     MOVEL*BLANK    WN0535 10        Memo Created Us
     C                     MOVEL*BLANK    WN0536 40        Claim Resolutio
     C                     Z-ADD*ZERO     WN0537 112       Approved Net Lo
     C                     Z-ADD*ZERO     WN0538 112       Total Expense A
     C                     Z-ADD*ZERO     WN0539  70       Memo Post Date
     C                     Z-ADD*ZERO     WN0540  60       Memo Post Time
     C                     Z-ADD*ZERO     WN0541  70       TFS Batch Numbe
     C                     MOVEL*BLANK    WN0542  1        TFS Process Sta
     C                     Z-ADD*ZERO     WN0543  74       Avg TF Responsi
     C                     Z-ADD*ZERO     WN0544  74       Avg SBF Respons
     C                     Z-ADD*ZERO     WN0545  74       STF Responsibil
     C                     Z-ADD*ZERO     WN0546  92       FPR ID
     C                     Z-ADD*ZERO     WN0547  92       AC Unused Value
     C                     Z-ADD*ZERO     WN0548  92       AC Unused Value
     C                     Z-ADD*ZERO     WN0549  92       AC Unused Value
     C                     MOVEL*BLANK    WN0550  1        Claim Prod Affe
     C                     MOVEL*BLANK    WN0551  1        ARC Unused Stat
     C                     MOVEL*BLANK    WN0552  1        ARC Unused Stat
     C                     MOVEL*BLANK    WN0553  2        AC Shipping Met
     C                     MOVEL*BLANK    WN0554  2        AC Full Return
     C                     Z-ADD*ZERO     WN0555  74       AC Unused Pct 1
     C                     Z-ADD*ZERO     WN0556  74       AC Unused Pct 2
     C                     MOVEL*BLANK    WN0557  1        Record Status
     C                     Z-ADD*ZERO     WN0558  70       Create Date
     C                     Z-ADD*ZERO     WN0559  60       Create Time
     C                     MOVEL*BLANK    WN0560 10        Create User
     C                     MOVEL*BLANK    WN0561 10        Create Program
     C                     Z-ADD*ZERO     WN0562  70       Change Date
     C                     Z-ADD*ZERO     WN0563  60       Change Time
     C                     MOVEL*BLANK    WN0564 10        Change User
     C                     MOVEL*BLANK    WN0565 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @MKCPWA
     C                     Z-ADDWL0041    MKC0C7           Claim Number
      *
     C           KLCHSJ    KLIST
     C                     KFLD           MKC0C7           Claim Number
     C           KLCHSJ    CHAIN@MKCPWA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMKCPL0'MDACP
     C                     MOVEL'@MKCPWA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDMK1    YERDCS
      * USER: Processing after Data read
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Claim Status is Completed
      *   |- c2    : PAR.Claim Status NE DB1.Claim Status
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0042    IFEQ 'C'                        *IF
     C           WL0042    IFNE MKCJSX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD##JDT     MKP6DT           Memo Post Date
     C                     Z-ADD##JTM     MKCRTM           Memo Post Time
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Claim Status is Memo Processing
      *   |- c2    : PAR.Claim Status NE DB1.Claim Status
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0042    IFEQ 'M'                        *IF
     C           WL0042    IFNE MKCJSX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       MKCRSX           Memo Created
     C                     Z-ADD##JDT     MKMPDT           Memo Created Da
     C                     Z-ADD##JTM     MKBITM           Memo Created Ti
     C                     MOVEL##USR     MKCIVN           Memo Created Us
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @MKCPWA
     C                     MOVELWL0042    MKCJSX    P      Claim Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPDMK1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     MKMKDT           Change Date
     C                     Z-ADD##JTM     MKBFTM           Change Time
     C                     MOVEL##USR     MKCEVN           Change User
     C                     MOVEL##PGM     MKCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPDMK1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@MKCPWA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDMKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0569    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSK     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P3I6ST           Allow Multi_Com
     C                     MOVELDRMPNA    P3MPNA           Default Printer
     C                     MOVELDRBCCD    P3BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0003           Company Number
     C                     MOVELDRBUVN    WN0570           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0043    DTAJVN           User Profile Na
     C                     MOVELWL0044    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSL     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0045           Company Number
     C                     MOVELDTAJCD    WL0046           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSM01           Application Cod
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Application Cod
      * Setup key
     C                     MOVELP3DNCD    WQSM01           Application Cod
      * Establish starting position
     C           KRSSM     SETLL@DNRESF                    *
     C           KRSSM     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SNRVGN
     C                     END                             *FI
     C           KRSSM     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSN01           Application Cod
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSN01           Application Cod
      * Establish starting position
     C           KRSSN     SETLL@DNRESF                    *
     C           KRSSN     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSO     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           User Code Model
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRBUVN    YL0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSP     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUI8ST           Allow Multi War
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI8ST    WUI8ST           Allow Multi War
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Create a new Memo.
      *================================================================
     C                     Z-ADD*ZERO     WUC4NB           Order Number
      * Setup company number.
      * CASE: CTL.Company Number EQ WRK.ZERO
     C           #2AIC3    IFEQ WUW0NB                     *IF
     C                     Z-ADDP3AIC3    #2AIC3           Company Number
     C                     END                             *FI
      * EDT Cr/Dr Memo Header  E1 - PD Order Header  * 
     C                     CALL 'PDPIE1R'              90  EDT Cr/Dr Memo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P3I6ST    WQ0003  1        Allow Multi_Com
     C           #2AIC3    PARM #2AIC3    WQ0004  30       Company Number
     C           WUC4NB    PARM WUC4NB    WQ0005  70       Order Number
     C                     PARM P1OBST    WQ0006  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPIE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * CASE: WRK.Order Number is Not equal to zeros
     C           WUC4NB    IFNE *ZERO                      *IF
      * Credit/Debit Memo Order Created.
     C                     EXSR UBSUBR                     Credit/Debit Me
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Credit/Debit Memo Order Created.
      *================================================================
      * CLC Tot Ord Val Memo   XF - PD Order Detail  * 
     C                     CALL 'PDQEXFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0007  30       Company Number
     C                     PARM WUC4NB    WQ0008  70       Order Number
     C           WUB5VL    PARM WUB5VL    WQ0009 112       Order Value Tot
     C           WUAYWG    PARM WUAYWG    WQ0010 112       USR Order Weigh
     C           WUXPST    PARM WUXPST    WQ0011  1        USR Production
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * RTV All Dtl Price Sts  RT - PD Order Detail  * 
     C                     EXSR SARVGN
      * CASE: WRK.Price Status is Priced
     C           WUU1ST    IFEQ 'P'                        *IF
      * CHG Price Status       CH - PD Order Header  * 
     C                     EXSR SBCHRC
     C                     END                             *FI
      * CHG Reset Order in Use CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     Z-ADDWUC4NB    WL0002           Order Number
     C                     MOVEL'N'       WL0003    P      Order in Use
     C                     EXSR SCCHRC
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Print Acknowledgements.
      *================================================================
      * ** FT299 LJB 04/18/2007
      * Restrict to user profile warehouse if multi-warehouse is not Yes
      * CASE: WRK.Allow Multi Warehouse is yes
     C           WUI8ST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUCPCD           USR Warehouse C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP3AJCD    WUCPCD           USR Warehouse C
     C                     END                             *FI
      * e2176 slm 3/14/2013
      * the next program will allow user to select
      * email of acknowledgements
      * PRT Acknowledgements   PV - Order Header TRG  * 
     C                     CALL 'PDJ4PVR'              90  PRT Acknowledge
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUCPCD    WQ0012  3        Warehouse Code
     C                     PARM P1OBST    WQ0013  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJ4PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Print Pre-Invoice Register.
      *================================================================
     C                     MOVEL*BLANK    WUAASX           @Yes/No Flag
      * PRT Invoices/Pre Reg.  PV - Order Header TRG  * 
     C                     CALL 'PDTJPVR'              90  PRT Invoices/Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P3DNCD    WQ0014  6        Application Cod
     C                     PARM 'P'       WQ0015  1        Invoice/Pre-Inv
     C                     PARM P1OBST    WQ0016  1        Billing Activit
     C                     PARM 'BT'      WQ0017  2        Process Cust Ty
     C           WUAASX    PARM WUAASX    WQ0018  1        @Yes/No Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTJPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Edit Memo.
      *================================================================
      * CASE: RCD.Header Status is Confirmed & Complete
     C           #1GWST    IFEQ 'C'                        *IF
     C           #1GWST    OREQ 'R'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0002           *SFLSEL
      * Send message 'Memo Posted'
     C                     MOVEL'USR2081' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Edit Memo.
     C                     EXSR UFSUBR                     Edit Memo.
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Edit Memo.
      *================================================================
      * ** Do not allow Credit to edit memos               FT133 LJB
      * CASE: LCL.User Code Model is Credit
     C           YL0002    IFEQ @CN,004                    *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0003           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     GOTO UFEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Reset Order in Use CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1C4NB    WL0002           Order Number
     C                     MOVEL'Y'       WL0003    P      Order in Use
     C                     EXSR SCCHRC
      * CASE: PGM.*Return code is *DBF update error
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * EDT Cr/Dr Memo Header  E1 - PD Order Header  * 
     C                     CALL 'PDPIE1R'              90  EDT Cr/Dr Memo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P3I6ST    WQ0019  1        Allow Multi_Com
     C           #1AIC3    PARM #1AIC3    WQ0020  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0021  70       Order Number
     C                     PARM P1OBST    WQ0022  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPIE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Reset Order in Use CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1C4NB    WL0002           Order Number
     C                     MOVEL'N'       WL0003    P      Order in Use
     C                     EXSR SCCHRC
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Cancel Memo.
      *================================================================
      * ** Do not allow Credit to Cancel memos         FT133 LJB
      * CASE: LCL.User Code Model is Credit
     C           YL0002    IFEQ @CN,004                    *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0004           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     GOTO UGEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Header Status is Confirmed & Complete
     C           #1GWST    IFEQ 'C'                        *IF
     C           #1GWST    OREQ 'R'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0005           *SFLSEL
      * Send message 'Memo Posted'
     C                     MOVEL'USR2081' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Edit Memo Comments.
      *================================================================
      * CASE: RCD.Header Status is Confirmed & Complete
     C           #1GWST    IFEQ 'C'                        *IF
     C           #1GWST    OREQ 'R'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0006           *SFLSEL
      * Send message 'Memo Posted'
     C                     MOVEL'USR2081' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Edit Memo Comments.
     C                     EXSR UISUBR                     Edit Memo Comme
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Edit Memo Comments.
      *================================================================
      * CHG Reset Order in Use CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1C4NB    WL0002           Order Number
     C                     MOVEL'Y'       WL0003    P      Order in Use
     C                     EXSR SCCHRC
      * CASE: PGM.*Return code is *Data update error
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * EDT OP Order Comment   EF - Order Comment  * 
     C                     CALL 'PDAGEFR'              90  EDT OP Order Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0023  30       Company Number
     C                     PARM #1C4NB    WQ0024  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAGEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Reset Order in Use CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1C4NB    WL0002           Order Number
     C                     MOVEL'N'       WL0003    P      Order in Use
     C                     EXSR SCCHRC
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Edit Memo Details.
      *================================================================
      * Edit memo details
      * CASE: RCD.Header Status is Cancelled
     C           #1GWST    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0007           *SFLSEL
      * Send message 'Memo Posted'
     C                     MOVEL'USR2081' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Edit Memo Details.
     C                     EXSR UKSUBR                     Edit Memo Detai
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Edit Memo Details.
      *================================================================
      * ** Do not allow Credit to modify memos       FT133 LJB
      * CASE: LCL.User Code Model is Credit
     C           YL0002    IFEQ @CN,004                    *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0008           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     GOTO UKEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Reset Order in Use CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1C4NB    WL0002           Order Number
     C                     MOVEL'Y'       WL0003    P      Order in Use
     C                     EXSR SCCHRC
      * CASE: PGM.*Return code is *Data update error
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * EDT Cr/Dr Memo Lines   EF - Order Detail  * 
     C                     CALL 'PDPGEFR'              90  EDT Cr/Dr Memo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0025  30       Company Number
     C                     PARM #1C4NB    WQ0026  70       Order Number
     C                     PARM #1JNCD    WQ0027  2        Order Type_Sale
     C                     PARM #1BKC7    WQ0028  70       Ship To Custome
     C                     PARM #1BRTX    WQ0029 30        Ship To Name
     C                     PARM #1A0DT    WQ0030  70       Order Date
     C                     PARM #1U1ST    WQ0031  1        Price Status
     C                     PARM #1C0C7    WQ0032  70       Claim Number
     C                     PARM P3DNCD    WQ0033  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPGEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Reset Order in Use CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1C4NB    WL0002           Order Number
     C                     MOVEL'N'       WL0003    P      Order in Use
     C                     EXSR SCCHRC
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Display Memo.
      *================================================================
      * DSP Credit/Debit Memo  D1 - PD Order Header  * 
     C                     CLEARPBRC
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
     C                     Z-ADD#1A0DT    PBA0DT           Order Date
      *
     C                     CALL 'PDIXD1R'              90  DSP Credit/Debi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDIXD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Print Memo.
      *================================================================
      * CASE: RCD.Order Value Total EQ WRK.ZERO
     C           #1JZVA    IFEQ WUW0NB                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0009           *SFLSEL
      * Send message 'Memo not elig. to print'
     C                     MOVEL'USR2375' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Load Parameters.
     C                     EXSR UNSUBR                     Load Parameters
      * PRT Prmt for CM/DM's   UP - /UT User Programs  * 
     C                     CALL 'PDNUUPR'              90  PRT Prmt for CM
     C           WUH3TX    PARM *BLANK    WQ0034  7        Return Code Usr
     C                     PARM P3DNCD    WQ0035  6        Application Cod
     C                     PARM @CN,006   WQ0036 10        Program name US
     C                     PARM @CN,007   WQ0037 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0038 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0039  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0040  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0041  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0042 10        PRT Night Queue
     C           P2AJAA    PARM P2AJAA    WQ0043 155       Company Number
     C           P2AJAE    PARM P2AJAE    WQ0044 155       Order Number 1
     C           P2M8NB    PARM P2M8NB    WQ0045 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNUUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'Print has been Submitted'
     C                     MOVEL'USR1832' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Load Parameters.
      *================================================================
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
     C                     Z-ADD#1C4NB    P2AJAE           Order Number 1
     C                     Z-ADD#1C4NB    P2AJAF           Order Number 2
     C                     Z-ADD*ZERO     P2AJAB           Date 1
     C                     Z-ADD*ZERO     P2AJAC           Date 2
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Print Memo Acknowledgement.
      *================================================================
      * CASE: RCD.Header Status is Confirmed & Complete
     C           #1GWST    IFEQ 'C'                        *IF
     C           #1GWST    OREQ 'R'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0010           *SFLSEL
      * Send message 'Memo Posted'
     C                     MOVEL'USR2081' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Print Memo Acknowledgement.
     C                     EXSR UPSUBR                     Print Memo Ackn
     C                     END                             *FI
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Print Memo Acknowledgement.
      *================================================================
      * Load Parameters.
     C                     EXSR UQSUBR                     Load Parameters
      * e2176 slm 03/14/2013
      * do not send by email
      * PRT Acknowldg. CLP 1   UP - /UT User Programs  * 
     C                     CALL 'PDJ1UPR'              90  PRT Acknowldg.
     C           WUH3TX    PARM *BLANK    WQ0046  7        Return Code Usr
     C                     PARM P3DNCD    WQ0047  6        Application Cod
     C                     PARM @CN,008   WQ0048 10        Program name US
     C                     PARM @CN,009   WQ0049 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0050 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0051  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0052  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0053  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0054 10        PRT Night Queue
     C           P2AJAA    PARM P2AJAA    WQ0055 155       Company Number
     C           P2AJAB    PARM P2AJAB    WQ0056 155       Date 1
     C           P2AJAC    PARM P2AJAC    WQ0057 155       Date 2
     C           P2AJAG    PARM P2AJAG    WQ0058 155       Thru Date Pass
     C           P2AJAE    PARM P2AJAE    WQ0059 155       Order Number 1
     C           P2AJAF    PARM P2AJAF    WQ0060 155       Order Number 2
     C           P2M8NB    PARM P2M8NB    WQ0061 155       System Value Nu
     C           #1U2ST    PARM #1U2ST    WQ0062  1        Export Sales
     C           WUJNCD    PARM WUJNCD    WQ0063  2        Order Type_Sale
     C           WUQ2CD    PARM WUQ2CD    WQ0064  2        Shipping Method
     C                     PARM P1OBST    WQ0065  1        Billing Activit
     C           WUCPCD    PARM WUCPCD    WQ0066  3        USR Warehouse C
     C           WUVSCD    PARM WUVSCD    WQ0067  3        USR CDE Parm 1
     C           WUVTCD    PARM WUVTCD    WQ0068  3        USR CDE Parm 2
     C           WUVUCD    PARM WUVUCD    WQ0069  3        USR CDE Parm 3
     C           WUVVCD    PARM WUVVCD    WQ0070  3        USR CDE Parm 4
     C           WUVWCD    PARM WUVWCD    WQ0071  3        USR CDE Parm 5
     C           WUVXCD    PARM WUVXCD    WQ0072  3        USR CDE Parm 6
     C           WUVYCD    PARM WUVYCD    WQ0073  3        USR CDE Parm 7
     C           WUVZCD    PARM WUVZCD    WQ0074  3        USR CDE Parm 8
     C           WUV0CD    PARM WUV0CD    WQ0075  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0076  1        USR Select/Omit
     C           WULVNX    PARM WULVNX    WQ0077 155       Date 3
     C                     PARM 'N'       WQ0078  1        Status Flag 8
     C                     PARM *BLANK    WQ0079  3        Warehouse Code
     C                     PARM 'N'       WQ0080  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJ1UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'Print has been Submitted'
     C                     MOVEL'USR1832' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Load Parameters.
      *================================================================
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
     C                     Z-ADD#1C4NB    P2AJAE           Order Number 1
     C                     Z-ADD#1C4NB    P2AJAF           Order Number 2
     C                     Z-ADD*ZERO     P2AJAC           Date 2
     C                     Z-ADD*ZERO     P2AJAG           Thru Date Pass
     C                     Z-ADD*ZERO     P2AJAB           Date 1
     C                     Z-ADD*ZERO     WULVNX           Date 3
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Post Memo.
      *================================================================
      * CASE: RCD.Header Status is Confirmed & Complete
     C           #1GWST    IFEQ 'C'                        *IF
     C           #1GWST    OREQ 'R'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0012           *SFLSEL
      * Send message 'Memo Posted'
     C                     MOVEL'USR2081' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Post Memo.
     C                     EXSR USSUBR                     Post Memo.
     C                     END                             *FI
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Post Memo.
      *================================================================
      * CASE: RCD.Order Value Total EQ WRK.ZERO
     C           #1JZVA    IFEQ WUW0NB                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0013           *SFLSEL
      * Send message 'Memo Not Elig. to Post-0'
     C                     MOVEL'USR2376' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: RCD.Order Type Print Status is yes
     C           #1GYST    IFEQ 'Y'                        *IF
      * Post date required
      * CASE: CTL.Actual Shipped Date EQ WRK.ZERO
     C           #2GNDT    IFEQ WUW0NB                     *IF
      * SEL Actual Shipped Dte PV - PD Order Header  * 
     C                     CALL 'PDV4PVR'              90  SEL Actual Ship
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0081  30       Company Number
     C           #2GNDT    PARM #2GNDT    WQ0082  70       Actual Shipped
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV4PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: CTL.Actual Shipped Date EQ WRK.ZERO
     C           #2GNDT    IFEQ WUW0NB                     *IF
      * Setup message data for message
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  WUGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0014
      * Send message 'Memo Post Date Required'
     C                     MOVEL'USR2090' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * E00473 RMC 8/12/09 Post date must be >= Order date
      * CASE: CTL.Actual Shipped Date LT RCD.Order Date
     C           #2GNDT    IFLT #1A0DT                     *IF
      * new validation per alice/leanner/tim w     RMC 8/12/09 E00473
      * Setup message data for message
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #2GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0015
      * Send message 'Memo Post Date lt ord dt'
     C                     MOVEL'USR4185' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       YL0001           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0016           *SFLSEL
      * Send message 'Memo Not Elig. to Post'
     C                     MOVEL'USR2003' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Print Claim Form, Display, then Delete.
      *================================================================
      * Prt Claim-Claim All   XF - A/R Claim  * 
     C                     CALL 'PPL7XFR'              90  Prt Claim-Claim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C0C7    WQ0083  70       Claim Number
     C                     PARM #1AIC3    WQ0084  30       Claim Company N
     C                     PARM @CN,010   WQ0085 10        PRT Printer Dev
     C                     PARM '*YES'    WQ0086  4        PRT Hold Output
     C                     PARM '*NO'     WQ0087  4        PRT Save Output
     C                     PARM 1         WQ0088  20       PRT Number of C
     C                     PARM P2B8ST    WQ0089  1        Status - Y or N
     C                     PARM 'Y'       WQ0090  1        Online Report U
     C                     PARM *BLANK    WQ0091  1        Email Selection
     C                     PARM *BLANK    WQ0092  3        Approval Title
     C                     PARM *ZERO     WQ0093  30       Sequence Number
     C                     PARM *BLANK    WQ0094 50        Approval Person
     C                     PARM *BLANK    WQ0095  1        Claim Audit Sel
     C                     PARM *BLANK    WQ0096 10        Claim Audit Co
     C                     PARM *BLANK    WQ0097 50        Approval Claim
     C                     PARM '*NO'     WQ0098  4        Claim Prt Audit
     C                     PARM '*NO'     WQ0099  4        Claim Prt Intrl
     C                     PARM 'R'       WQ0100  1        Claim Print Typ
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPL7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * DSP&DLT Spool File     UP - /UT User Programs  * 
     C                     CALL 'PDP5UPR'              90  DSP&DLT Spool F
     C                     PARM @CN,011   WQ0101 10        File Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Delete Request.
      *================================================================
      * CASE: RCD.Claim Number is Zero
     C           #1C0C7    IFEQ *ZERO                      *IF
      * Delete single memo.
     C                     EXSR UVSUBR                     Delete single m
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for other memos on the claim, and delete all of them.
     C                     EXSR UWSUBR                     Check for other
     C                     END                             *FI
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Delete single memo.
      *================================================================
      * UPD Cancel Order       XF - PD Order Header  * 
     C                     CALL 'OPV9XFR'              90  UPD Cancel Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0102  30       Company Number
     C                     PARM #1C4NB    WQ0103  70       Order Number
     C                     PARM #1ANC7    WQ0104  70       AR Customer Num
     C                     PARM #1BKC7    WQ0105  70       Ship To Custome
     C                     PARM P1OBST    WQ0106  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPV9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Check for other memos on the claim, and delete all of them.
      *================================================================
      * RTV cnt of ords for memo - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1C0C7    WL0004           Claim Number
     C                     Z-ADDP6        WL0005           Count Records
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P6               Count Records
      * CASE: PAR.Count Records         USR is Greater Than One
     C           P6        IFGT 1                          *IF
      * Warn the user that multiple memos exist for claim, then delete.
     C                     EXSR UXSUBR                     Warn the user t
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete the single memo associated with the claim.
     C                     EXSR UYSUBR                     Delete the sing
     C                     END                             *FI
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * Warn the user that multiple memos exist for claim, then delete.
      *================================================================
      * DSP Cancel Confirm     DF - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADD#1C0C7    PCC0C7           Claim Number
      *
     C                     CALL 'PDXXDFR'              90  Zzz Cancel Conf
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Order Head
     C           P6HESX    PARM *BLANK    WQ0107  1        Cancelled Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXXDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PAR.Cancelled Flag USR is Yes
     C           P6HESX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * Delete the single memo associated with the claim.
      *================================================================
      * UPD Cancel Order       XF - PD Order Header  * 
     C                     CALL 'OPV9XFR'              90  UPD Cancel Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0108  30       Company Number
     C                     PARM #1C4NB    WQ0109  70       Order Number
     C                     PARM #1ANC7    WQ0110  70       AR Customer Num
     C                     PARM #1BKC7    WQ0111  70       Ship To Custome
     C                     PARM P1OBST    WQ0112  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPV9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * Post Memo.
      *================================================================
      * CASE: RCD.Claim Number is Zero
     C           #1C0C7    IFEQ *ZERO                      *IF
      * Post single memo.
     C                     EXSR NASUBR                     Post single mem
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for other memos on the claim, and post all of them.
     C                     EXSR NCSUBR                     Check for other
     C                     END                             *FI
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03072
     C           ZINPOS    ANDLE05632
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  12        W0CSRR  50
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ADD  12        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD12        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ072
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2GWST'  YPMTFD           Header Status
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ076
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2GYST'  YPMTFD           Order Type Prin
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1OAST           Processing Cycl
     C                     MOVEL*BLANK    P1OEST           Affect Inventor
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     Z-ADD*ZERO     P2DYNB           PRT Number of C
     C                     MOVEL*BLANK    P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P2AJAA           Company Number
     C                     Z-ADD*ZERO     P2AJNC           Customer Number
     C                     Z-ADD*ZERO     P2AJAB           Date 1
     C                     Z-ADD*ZERO     P2AJAC           Date 2
     C                     Z-ADD*ZERO     P2AJAD           From Date Pass
     C                     Z-ADD*ZERO     P2AJAG           Thru Date Pass
     C                     Z-ADD*ZERO     P2AJAE           Order Number 1
     C                     Z-ADD*ZERO     P2AJAF           Order Number 2
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     MOVEL*BLANK    P2B8ST           Status - Y or N
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P3AIC3           Company Number
     C                     MOVEL*BLANK    P3DNCD           Application Cod
     C                     MOVEL*BLANK    P3BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P3I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P3MPNA           Default Printer
     C                     MOVEL*BLANK    P3TAST           First Time Flag
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4R4ST           USR Update Flag
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P5               Invoice Number
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6               Count Records
     C                     MOVEL*BLANK    P6HESX           Cancelled Flag
     C                     MOVEL*BLANK    P6HKSX           Post Flag USR
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Order Number
     C                     Z-ADD*ZERO     WUC4NB  70
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Unused Parm - Value   USR
     C                     Z-ADD*ZERO     WUB5VL 112
      * Define work field USR Order Weight
     C                     Z-ADD*ZERO     WUAYWG 112
      * Define work field USR Production
     C                     MOVEL*BLANK    WUXPST  1
      * Define work field Price Status
     C                     MOVEL*BLANK    WUU1ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A_R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Allow Multi Warehouse
     C                     MOVEL*BLANK    WUI8ST  1
      * Define work field USR Warehouse Code
     C                     MOVEL*BLANK    WUCPCD  3
      * Define work field @Yes/No Flag
     C                     MOVEL*BLANK    WUAASX  1
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Define work field Date 3          PASS  USR
     C                     Z-ADD*ZERO     WULVNX 155
      * Define work field Order Type_Sales
     C                     MOVEL*BLANK    WUJNCD  2
      * Define work field Shipping Method
     C                     MOVEL*BLANK    WUQ2CD  2
      * Define work field USR CDE Parm 1
     C                     MOVEL*BLANK    WUVSCD  3
      * Define work field USR CDE Parm 2
     C                     MOVEL*BLANK    WUVTCD  3
      * Define work field USR CDE Parm 3
     C                     MOVEL*BLANK    WUVUCD  3
      * Define work field USR CDE Parm 4
     C                     MOVEL*BLANK    WUVVCD  3
      * Define work field USR CDE Parm 5
     C                     MOVEL*BLANK    WUVWCD  3
      * Define work field USR CDE Parm 6
     C                     MOVEL*BLANK    WUVXCD  3
      * Define work field USR CDE Parm 7
     C                     MOVEL*BLANK    WUVYCD  3
      * Define work field USR CDE Parm 8
     C                     MOVEL*BLANK    WUVZCD  3
      * Define work field USR CDE Parm 9
     C                     MOVEL*BLANK    WUV0CD  3
      * Define work field USR Select/Omit Flag
     C                     MOVEL*BLANK    WUCYST  1
      * Define work field Actual Shipped Date
     C                     Z-ADD*ZERO     WUGNDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEQ2NB           Event Number
     C                     Z-ADD*ZERO     WEAUC3           Invoice_Memo Co
     C                     Z-ADD*ZERO     WEQ7NB           Invoice_Memo Nu
     C                     Z-ADD*ZERO     WED2DT           Event Date
     C                     Z-ADD*ZERO     WEAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WEQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WEQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SCCHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005 110
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010  1
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  2
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  50
      * Define local variables for subroutine SHCRRC.
     C                     Z-ADD*ZERO     WL0016  30
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  50
     C                     MOVEL*BLANK    WL0019  2
     C                     Z-ADD*ZERO     WL0020  30
     C                     Z-ADD*ZERO     WL0021  70
     C                     MOVEL*BLANK    WL0022  2
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  50
     C                     Z-ADD*ZERO     WL0030  70
      * Define local variables for subroutine SICHRC.
     C                     Z-ADD*ZERO     WL0031  30
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  70
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     MOVEL*BLANK    WL0036  1
     C                     Z-ADD*ZERO     WL0037  70
     C                     MOVEL*BLANK    WL0038  2
     C                     Z-ADD*ZERO     WL0039  70
     C                     MOVEL*BLANK    WL0040  2
      * Define local variables for subroutine SJCHRC.
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  1
      * Define local variables for subroutine SLRVGN.
     C                     MOVEL*BLANK    WL0043 10
     C                     MOVEL*BLANK    WL0044  6
     C                     Z-ADD*ZERO     WL0045  30
     C                     MOVEL*BLANK    WL0046  3
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field User Code Model
     C                     MOVEL*BLANK    YL0002 10
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0004  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD05        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * ***** Change Log and Comments
     C                     EXSR NGSUBR                     ***** Change Lo
      * Set Application Code by Billing Type input parm
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           P1OBST    IFEQ '2'                        *IF
     C                     MOVEL*BLANK    P3DNCD           Application Cod
     C                     MOVEL'C/M'     P3DNCD           Application Cod
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Debit Memo
     C           P1OBST    IFEQ '3'                        *IF
     C                     MOVEL*BLANK    P3DNCD           Application Cod
     C                     MOVEL'D/M'     P3DNCD           Application Cod
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P3DNCD           Application Cod
     C                     MOVEL'MEMO'    P3DNCD           Application Cod
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0569 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0569           User Profile Na
      *
     C                     MOVEL*BLANK    WN0570 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SKRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,015                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0569    ZA0017           User Profile Na
     C                     MOVELP3DNCD    ZA0018           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0570    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0569    WL0043    P      User Profile Na
     C                     MOVELP3DNCD    WL0044    P      Application Cod
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    P3AIC3           Company Number
     C                     MOVELWL0046    YL0004    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0570    WL0043    P      User Profile Na
     C                     MOVELP3DNCD    WL0044    P      Application Cod
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    P3AIC3           Company Number
     C                     MOVELWL0046    YL0004    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0004    P3AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0569    ZA0019           User Profile Na
     C                     MOVELP3DNCD    ZA0020           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0003    IFNE 0                          *IF
     C                     Z-ADDYL0003    P3AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0004    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P3AJCD    PARM *BLANK    WQ0173  3        Warehouse Code
     C                     PARM YL0003    WQ0174  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SMRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       P3TAST           First Time Flag
      * ** Set default options             FT133 LJB 11/06/2007
     C                     MOVEL'N'       P2B8ST           Status - Y or N
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     Z-ADD1         P2DYNB           PRT Number of C
     C                     MOVEL'*YES'    P2WSST           PRT Hold Output
     C                     MOVEL'*YES'    P2WTST           PRT Save Output
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR SORVGN
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
     C                     EXSR SPRVGN
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
00792010260128202565025730257702580
02588026040261502623026320263602871
03074030770308503089030920310003116
031270313503144031480334803383
** W0END
00821011030135902571025750257802586
02602026110262102629026320263602877
03075030830308703090030980311403123
031330314103144031480337003389
** W0NAM
#CAUNA    **SPT     #2ST1     V2C4NB    V2AIC3    #2JNCD    V2BKC7
#2BCNA    V2A0DT    #2ATIN    V2C0C7    #2GWST    #2GYST    V2T3NB
#1SEL     V1C4NB    V1AIC3    #1JNCD    V1BKC7    #1BCNA    V1A0DT
#1ATIN    V1C0C7    #1GWST    #1GYST    #1BRTX    V1T3NB
** @CN
00001 *** Credit Memos Only ***
00002 *** Debit Memos Only ***
00003 USR0752
00004 PORKCRDT
00005 Y2U0004
00006 PDQYPCLP
00007 Print Memo
00008 PDJWPCLP
00009 Print Acknowledgement
00010 QPRINT
00011 PPL4PFR$
00012 Post Memo Reports
00013 Y2U9999
00014 PDIPSPCL
00015 Y2U0005
