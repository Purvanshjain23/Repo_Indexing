// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDINXFR
// ?Date: 14.08.2025 Time: 03:31:58
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(UPD A/R Year End       RT) TYPE(RTVOBJ) FILE(ARBCREP)          AC1396212;
PARAMETER(PAR.Company_Number);
{
 //?USER: Processing if Data record not found

 QUIT;

 //?USER: Process Data record

 CASE;

 // IF PAR.Company Number EQ DB1.Company Number
 IF PAR.Company_Number = DB1.Company_Number;

 //?Clear Parameters to Zero for fields that are to be cleared of data.
 // PAR.Number of Invoices YTD = CND.Equal zero
 PAR.Number_of_Invoices_YTD = *ZERO;

 // PAR.Number of Orders YTD = CND.Equal zero
 PAR.Number_of_Orders_YTD = *ZERO;

 // PAR.Number of Credits YTD = CND.Equal zero
 PAR.Number_of_Credits_YTD = *ZERO;

 // PAR.Number of Payments = CND.Equal zero
 PAR.Number_of_Payments = *ZERO;

 //?12/31/96 removed fields from update (may want rolling year)
 //?mtd/ytd invoices paid, mtd/ytd days paid, Date/Amt Hi A/R Bal
 // PAR.YTD Sales Invoiced = CND.equal to zero
 PAR.YTD_Sales_Invoiced = *ZERO;

 //?Move This YTD to Last YTD fields
 // PAR.Last YTD Nbr of Orders = DB1.Number of Orders YTD
 PAR.Last_YTD_Nbr_of_Orders = DB1.Number_of_Orders_YTD;

 // PAR.Last YTD Nbr of Credits = DB1.Number of Credits YTD
 PAR.Last_YTD_Nbr_of_Credits = DB1.Number_of_Credits_YTD;

 // PAR.Last YTD Nbr of Payments = DB1.Number of Payments
 PAR.Last_YTD_Nbr_of_Payments = DB1.Number_of_Payments;

 // PAR.Last YTD Nbr of Invoices = DB1.Number of Invoices YTD
 PAR.Last_YTD_Nbr_of_Invoices = DB1.Number_of_Invoices_YTD;

 // PAR.Last Year Sales Invoiced = DB1.YTD Sales Invoiced
 PAR.Last_Year_Sales_Invoiced = DB1.YTD_Sales_Invoiced;

 EXECUTE FUNCTION(UPD A/R Year End       CH) TYPE(CHGOBJ) FILE(ARBCREP)          AC1396213;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.AR_Customer_Number);
 PARAMETER(DB1.Date_of_Highest_A_R_Bal);
 PARAMETER(DB1.Amount_of_Highest_A_R_Bal);
 PARAMETER(PAR.Number_of_Invoices_YTD);
 PARAMETER(PAR.Number_of_Orders_YTD);
 PARAMETER(PAR.Number_of_Credits_YTD);
 PARAMETER(PAR.Number_of_Payments);
 PARAMETER(PAR.Last_YTD_Nbr_of_Orders);
 PARAMETER(PAR.Last_YTD_Nbr_of_Credits);
 PARAMETER(PAR.Last_YTD_Nbr_of_Payments);
 PARAMETER(PAR.Last_YTD_Nbr_of_Invoices);
 PARAMETER(DB1.MTD_Invoices_Paid);
 PARAMETER(DB1.YTD_Invoices_Paid);
 PARAMETER(DB1.MTD_Days_Paid);
 PARAMETER(DB1.YTD_Days_Paid);
 PARAMETER(PAR.YTD_Sales_Invoiced);
 PARAMETER(PAR.Last_Year_Sales_Invoiced);
 ENDIF;

}


