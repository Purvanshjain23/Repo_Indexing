     H/TITLE Bld Exp Rate HPE Sum  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:09:08
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKAZREL1IF  E           K        DISK
      * RTV : Company Control HPE       Retrieval index
      *
     FPKCPCPLEIF  E           K        DISK
      * RSQ : Eval Trans UPL            Co/KDate/Tattoo
      *
     FPKA1CPLAIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Kill/Tattoo Active
      *
     FPKFDCPL1IF  E           K        DISK
      * RTV : Export Rate HPE Summary   Retrieval index
      *
     FPKFDCPL0UF  E           K        DISK                      A
      * UPD : Export Rate HPE Summary   Update index
      *
     I@AZCPCN
      * Company Control HPE       Retrieval index
      * Renamed input format fields
     I              AZHONB                          WAHONB
     I              AZBSNB                          WABSNB
     I              AZB1DT                          WAB1DT
     I              AZB2DT                          WAB2DT
     I              AZH4NB                          WAH4NB
     I              AZK3NB                          WAK3NB
     I              AZCDDT                          WACDDT
     I              AZCEDT                          WACEDT
     I              AZAAVN                          WAAAVN
     I              AZAADT                          WAAADT
     I              AZAMTM                          WAAMTM
     I              AZAJST                          WAAJST
     I              AZAHVN                          WAAHVN
     I              AZAGVN                          WAAGVN
     I              AZABVN                          WAABVN
     I              AZABDT                          WAABDT
     I              AZABTM                          WAABTM
      *
     I@CPCPG7
      * Eval Trans UPL            Co/KDate/Tattoo
      * Renamed input format fields
     I              CPHKST                          WBHKST
     I              CPB7DT                          WBB7DT
     I              CPKINB                          WBKINB
     I              CPKHNB                          WBKHNB
     I              CPLNNB                          WBLNNB
     I              CPHLST                          WBHLST
     I              CPKJNB                          WBKJNB
     I              CPKKNB                          WBKKNB
     I              CPBQPC                          WBBQPC
     I              CPBRPC                          WBBRPC
     I              CPHMST                          WBHMST
     I              CPHNST                          WBHNST
     I              CPHTST                          WBHTST
     I              CPHUST                          WBHUST
     I              CPX6NB                          WBX6NB
     I              CPFQPC                          WBFQPC
     I              CPFRPC                          WBFRPC
     I              CPM7CD                          WBM7CD
     I              CPX7ST                          WBX7ST
     I              CPX8ST                          WBX8ST
     I              CPX9ST                          WBX9ST
     I              CPYAST                          WBYAST
     I              CPYBST                          WBYBST
     I              CPYCST                          WBYCST
     I              CPZJST                          WBZJST
     I              CPZKST                          WBZKST
     I              CPZLST                          WBZLST
     I              CPB8DT                          WBB8DT
     I              CPAOTM                          WBAOTM
      *
     I@A1CPL0
      * Tattoo Header             Co/Kill/Tattoo Active
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
     I@FDCPG6
      * Export Rate HPE Summary   Retrieval index
      * Renamed input format fields
     I              FDHONB                          WDHONB
     I              FDB0DT                          WDB0DT
     I              FDFXA1                          WDFXA1
     I              FDFYA1                          WDFYA1
     I              FDFZA1                          WDFZA1
     I              FDG0A1                          WDG0A1
     I              FDGLA1                          WDGLA1
     I              FDF0A1                          WDF0A1
     I              FDGKA1                          WDGKA1
     I              FDF1A1                          WDF1A1
     I              FDF2A1                          WDF2A1
     I              FDF3A1                          WDF3A1
     I              FDG2A1                          WDG2A1
     I              FDGNA1                          WDGNA1
     I              FDF4A1                          WDF4A1
     I              FDGPA1                          WDGPA1
     I              FDF5A1                          WDF5A1
     I              FDGQA1                          WDGQA1
     I              FDJSA1                          WDJSA1
     I              FDF7A1                          WDF7A1
     I              FDF8A1                          WDF8A1
     I              FDF9A1                          WDF9A1
     I              FDG1A1                          WDG1A1
     I              FDGMA1                          WDGMA1
     I              FDGAA1                          WDGAA1
     I              FDGRA1                          WDGRA1
     I              FDGBA1                          WDGBA1
     I              FDGCA1                          WDGCA1
     I              FDGDA1                          WDGDA1
     I              FDG3A1                          WDG3A1
     I              FDGOA1                          WDGOA1
     I              FDGEA1                          WDGEA1
     I              FDGSA1                          WDGSA1
     I              FDGFA1                          WDGFA1
     I              FDGTA1                          WDGTA1
     I              FDJTA1                          WDJTA1
     I              FDGHA1                          WDGHA1
     I              FDGUA1                          WDGUA1
     I              FDGIA1                          WDGIA1
     I              FDGWA1                          WDGWA1
     I              FDGJA1                          WDGJA1
     I              FDGVA1                          WDGVA1
     I              FDJUA1                          WDJUA1
     I              FDEVDT                          WDEVDT
     I              FDAAVN                          WDAAVN
     I              FDAADT                          WDAADT
     I              FDAMTM                          WDAMTM
     I              FDAJST                          WDAJST
     I              FDAHVN                          WDAHVN
     I              FDAGVN                          WDAGVN
     I              FDABVN                          WDABVN
     I              FDABDT                          WDABDT
     I              FDABTM                          WDABTM
      *
     I@FDCPG5
      * Export Rate HPE Summary   Update index
      * Renamed input format fields
     I              FDHONB                          WEHONB
     I              FDB0DT                          WEB0DT
     I              FDFXA1                          WEFXA1
     I              FDFYA1                          WEFYA1
     I              FDFZA1                          WEFZA1
     I              FDG0A1                          WEG0A1
     I              FDGLA1                          WEGLA1
     I              FDF0A1                          WEF0A1
     I              FDGKA1                          WEGKA1
     I              FDF1A1                          WEF1A1
     I              FDF2A1                          WEF2A1
     I              FDF3A1                          WEF3A1
     I              FDG2A1                          WEG2A1
     I              FDGNA1                          WEGNA1
     I              FDF4A1                          WEF4A1
     I              FDGPA1                          WEGPA1
     I              FDF5A1                          WEF5A1
     I              FDGQA1                          WEGQA1
     I              FDJSA1                          WEJSA1
     I              FDF7A1                          WEF7A1
     I              FDF8A1                          WEF8A1
     I              FDF9A1                          WEF9A1
     I              FDG1A1                          WEG1A1
     I              FDGMA1                          WEGMA1
     I              FDGAA1                          WEGAA1
     I              FDGRA1                          WEGRA1
     I              FDGBA1                          WEGBA1
     I              FDGCA1                          WEGCA1
     I              FDGDA1                          WEGDA1
     I              FDG3A1                          WEG3A1
     I              FDGOA1                          WEGOA1
     I              FDGEA1                          WEGEA1
     I              FDGSA1                          WEGSA1
     I              FDGFA1                          WEGFA1
     I              FDGTA1                          WEGTA1
     I              FDJTA1                          WEJTA1
     I              FDGHA1                          WEGHA1
     I              FDGUA1                          WEGUA1
     I              FDGIA1                          WEGIA1
     I              FDGWA1                          WEGWA1
     I              FDGJA1                          WEGJA1
     I              FDGVA1                          WEGVA1
     I              FDJUA1                          WEJUA1
     I              FDEVDT                          WEEVDT
     I              FDAAVN                          WEAAVN
     I              FDAADT                          WEAADT
     I              FDAMTM                          WEAMTM
     I              FDAJST                          WEAJST
     I              FDAHVN                          WEAHVN
     I              FDAGVN                          WEAGVN
     I              FDABVN                          WEABVN
     I              FDABDT                          WEABDT
     I              FDABTM                          WEABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKFD1    E DSPKFDCPL0
      * UPD : Export Rate HPE Summary   Update index
      * Renamed input format fields
     I              FDHONB                          WEHONB
     I              FDB0DT                          WEB0DT
     I              FDFXA1                          WEFXA1
     I              FDFYA1                          WEFYA1
     I              FDFZA1                          WEFZA1
     I              FDG0A1                          WEG0A1
     I              FDGLA1                          WEGLA1
     I              FDF0A1                          WEF0A1
     I              FDGKA1                          WEGKA1
     I              FDF1A1                          WEF1A1
     I              FDF2A1                          WEF2A1
     I              FDF3A1                          WEF3A1
     I              FDG2A1                          WEG2A1
     I              FDGNA1                          WEGNA1
     I              FDF4A1                          WEF4A1
     I              FDGPA1                          WEGPA1
     I              FDF5A1                          WEF5A1
     I              FDGQA1                          WEGQA1
     I              FDJSA1                          WEJSA1
     I              FDF7A1                          WEF7A1
     I              FDF8A1                          WEF8A1
     I              FDF9A1                          WEF9A1
     I              FDG1A1                          WEG1A1
     I              FDGMA1                          WEGMA1
     I              FDGAA1                          WEGAA1
     I              FDGRA1                          WEGRA1
     I              FDGBA1                          WEGBA1
     I              FDGCA1                          WEGCA1
     I              FDGDA1                          WEGDA1
     I              FDG3A1                          WEG3A1
     I              FDGOA1                          WEGOA1
     I              FDGEA1                          WEGEA1
     I              FDGSA1                          WEGSA1
     I              FDGFA1                          WEGFA1
     I              FDGTA1                          WEGTA1
     I              FDJTA1                          WEJTA1
     I              FDGHA1                          WEGHA1
     I              FDGUA1                          WEGUA1
     I              FDGIA1                          WEGIA1
     I              FDGWA1                          WEGWA1
     I              FDGJA1                          WEGJA1
     I              FDGVA1                          WEGVA1
     I              FDJUA1                          WEJUA1
     I              FDEVDT                          WEEVDT
     I              FDAAVN                          WEAAVN
     I              FDAADT                          WEAADT
     I              FDAMTM                          WEAMTM
     I              FDAJST                          WEAJST
     I              FDAHVN                          WEAHVN
     I              FDAGVN                          WEAGVN
     I              FDABVN                          WEABVN
     I              FDABDT                          WEABDT
     I              FDABTM                          WEABTM
      *
     IYARDCS      DS                            232
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            232
     IYCRDCS      DS                            232
     IYDRDCS      DS                            232
     IYERDCS      DS                            232
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Export Rate HPE Summary
      * I :  CC Company Number
     I                                    P   1   20P1HONB
      * I :  TH Kill Date
     I                                    P   3   60P1B0DT
      * N :  Production Date
     I                                    P   7  100P1EVDT
     IP2PARM      DS
      * I :  Export Rate Calc STS USR
     I                                        1   1 P2WJST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Bld Rest Time Eval'
      * PRT Printer Device
     I                                        1  10 ZA0001
      * PRT Hold Output Sts
     I                                       11  14 ZA0002
      * PRT Save Output Sts
     I                                       15  18 ZA0003
      * PRT Copies
     I                                    P  19  200ZA0004
      * PRT Night Queue
     I                                       21  30 ZA0005
      * Company Number Alpha Usr
     I                                       31  33 ZA0006
      * Date Alpha USR
     I                                       34  40 ZA0007
      * TH Source Type
     I                                       41  41 ZA0008
      * Pen Number
     I                                       42  44 ZA0009
      * TH Schedule Kill Shift
     I                                       45  45 ZA0010
      * Tattoo Nbr Alpha Usr
     I                                       46  50 ZA0011
      * Date Alpha Usr 2
     I                                       51  57 ZA0012
      * Document Name USR
     I                                       58  63 ZA0013
      * Process Type USR
     I                                       64  64 ZA0014
      * Oms System Value Alpha
     I                                       65 104 ZA0015
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P1B0DT    PARM           WP0002  70       TH Kill Date
     C           P2WJST    PARM           WP0003  1        Export Rate Cal
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Exp Rate HPE Sum  XF
      * H16853 ISE 11/05/2020-Recompiled due to change in Buy Order Numbe
     C                     Z-ADDP1B0DT    YL0001           TH Kill Date
      * CASE: PAR.TH Kill Date is Not Found Kill Date
     C           P1B0DT    IFEQ *ZERO                      *IF
      * Rtv Current Kill Dt   RT - Company Control HPE  * 
     C                     EXSR SARVGN
      * Rtv Prev Kill Date    XF - STR Order Management Sys  * 
     C                     CALL 'PDRUXFR'              90  Rtv Prev Kill D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0001  30       BOH Company Num
     C                     PARM YL0002    WQ0002  70       Cut Date
     C           YL0001    PARM *ZERO     WQ0003  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Next Prod Date    XF - STR Order Management Sys  * 
     C                     CALL 'PDITXFR'              90  Rtv Next Prod D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0004  30       BOH Company Num
     C                     PARM YL0001    WQ0005  70       Cut Date
     C           P1EVDT    PARM *ZERO     WQ0006  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDITXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Next Prod Date    XF - STR Order Management Sys  * 
     C                     CALL 'PDITXFR'              90  Rtv Next Prod D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0007  30       BOH Company Num
     C                     PARM P1B0DT    WQ0008  70       Cut Date
     C           P1EVDT    PARM *ZERO     WQ0009  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDITXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Bld Exp Rate HPE Sum  RT - Eval Trans UPL  * 
     C                     EXSR SBRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Current Kill Dt   RT - Company Control HPE  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHONB           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WAHONB           CC Company Numb
      * Establish starting position
     C           KRSSA     CHAIN@AZCPCN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0055' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Current Kill Da
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAB1DT    YL0002           Current Kill Da
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Bld Exp Rate HPE Sum  RT - Eval Trans UPL  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 111       Shift A Int Adj
     C                     Z-ADD*ZERO     WN0002 111       Shift A Int Hot
     C                     Z-ADD*ZERO     WN0003  50       Shift A Int Hd
     C                     Z-ADD*ZERO     WN0004  50       Shift A Int Hd
     C                     Z-ADD*ZERO     WN0005  50       Shift A Int Hd
     C                     Z-ADD*ZERO     WN0006  95       Shift A Int Hot
     C                     Z-ADD*ZERO     WN0007  52       Shift A Int Rat
     C                     Z-ADD*ZERO     WN0008 111       Shift A Ext Adj
     C                     Z-ADD*ZERO     WN0009 111       Shift A Ext Hot
     C                     Z-ADD*ZERO     WN0010  50       Shift A Ext Hd
     C                     Z-ADD*ZERO     WN0011  50       Shift A Ext Hd
     C                     Z-ADD*ZERO     WN0012  50       Shift A Ext Hd
     C                     Z-ADD*ZERO     WN0013  95       Shift A Ext Hot
     C                     Z-ADD*ZERO     WN0014  52       Shift A Ext Rat
     C                     Z-ADD*ZERO     WN0015  95       Shift A Tot Hot
     C                     Z-ADD*ZERO     WN0016  52       Shift A Tot Rat
     C                     Z-ADD*ZERO     WN0017 111       Shift B Int Adj
     C                     Z-ADD*ZERO     WN0018 111       Shift B Int Hot
     C                     Z-ADD*ZERO     WN0019  50       Shift B Int Hd
     C                     Z-ADD*ZERO     WN0020  50       Shift B Int Hd
     C                     Z-ADD*ZERO     WN0021  50       Shift B Int Hd
     C                     Z-ADD*ZERO     WN0022  95       Shift B Int Hot
     C                     Z-ADD*ZERO     WN0023  52       Shift B Int Rat
     C                     Z-ADD*ZERO     WN0024 111       Shift B Ext Adj
     C                     Z-ADD*ZERO     WN0025 111       Shift B Ext Hot
     C                     Z-ADD*ZERO     WN0026  50       Shift B Ext Hd
     C                     Z-ADD*ZERO     WN0027  50       Shift B Ext Hd
     C                     Z-ADD*ZERO     WN0028  50       Shift B Ext Hd
     C                     Z-ADD*ZERO     WN0029  95       Shift B Ext Hot
     C                     Z-ADD*ZERO     WN0030  52       Shift B Ext Rat
     C                     Z-ADD*ZERO     WN0031  95       Shift B Tot Hot
     C                     Z-ADD*ZERO     WN0032  52       Shift B Tot Rat
     C                     Z-ADD*ZERO     WN0033  95       Total Int Hot W
     C                     Z-ADD*ZERO     WN0034  52       Total Int Rate
     C                     Z-ADD*ZERO     WN0035  95       Total Ext Hot W
     C                     Z-ADD*ZERO     WN0036  52       Total Ext Rate
     C                     Z-ADD*ZERO     WN0037  95       Total Hot Wgt S
     C                     Z-ADD*ZERO     WN0038  52       Total Rate Adj
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Shift A Int Adj
     C                     Z-ADD*ZERO     WN0002           Shift A Int Hot
     C                     Z-ADD*ZERO     WN0003           Shift A Int Hd
     C                     Z-ADD*ZERO     WN0004           Shift A Int Hd
     C                     Z-ADD*ZERO     WN0005           Shift A Int Hd
     C                     Z-ADD*ZERO     WN0006           Shift A Int Hot
     C                     Z-ADD*ZERO     WN0007           Shift A Int Rat
     C                     Z-ADD*ZERO     WN0008           Shift A Ext Adj
     C                     Z-ADD*ZERO     WN0009           Shift A Ext Hot
     C                     Z-ADD*ZERO     WN0010           Shift A Ext Hd
     C                     Z-ADD*ZERO     WN0011           Shift A Ext Hd
     C                     Z-ADD*ZERO     WN0012           Shift A Ext Hd
     C                     Z-ADD*ZERO     WN0013           Shift A Ext Hot
     C                     Z-ADD*ZERO     WN0014           Shift A Ext Rat
     C                     Z-ADD*ZERO     WN0015           Shift A Tot Hot
     C                     Z-ADD*ZERO     WN0016           Shift A Tot Rat
     C                     Z-ADD*ZERO     WN0017           Shift B Int Adj
     C                     Z-ADD*ZERO     WN0018           Shift B Int Hot
     C                     Z-ADD*ZERO     WN0019           Shift B Int Hd
     C                     Z-ADD*ZERO     WN0020           Shift B Int Hd
     C                     Z-ADD*ZERO     WN0021           Shift B Int Hd
     C                     Z-ADD*ZERO     WN0022           Shift B Int Hot
     C                     Z-ADD*ZERO     WN0023           Shift B Int Rat
     C                     Z-ADD*ZERO     WN0024           Shift B Ext Adj
     C                     Z-ADD*ZERO     WN0025           Shift B Ext Hot
     C                     Z-ADD*ZERO     WN0026           Shift B Ext Hd
     C                     Z-ADD*ZERO     WN0027           Shift B Ext Hd
     C                     Z-ADD*ZERO     WN0028           Shift B Ext Hd
     C                     Z-ADD*ZERO     WN0029           Shift B Ext Hot
     C                     Z-ADD*ZERO     WN0030           Shift B Ext Rat
     C                     Z-ADD*ZERO     WN0031           Shift B Tot Hot
     C                     Z-ADD*ZERO     WN0032           Shift B Tot Rat
     C                     Z-ADD*ZERO     WN0033           Total Int Hot W
     C                     Z-ADD*ZERO     WN0034           Total Int Rate
     C                     Z-ADD*ZERO     WN0035           Total Ext Hot W
     C                     Z-ADD*ZERO     WN0036           Total Ext Rate
     C                     Z-ADD*ZERO     WN0037           Total Hot Wgt S
     C                     Z-ADD*ZERO     WN0038           Total Rate Adj
     C                     Z-ADD*ZERO     YL0003           EA Tattoo Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHKST    WQSB01           EA Company Numb
     C           *LIKE     DEFN WBB7DT    WQSB02           EA Kill Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           EA Company Numb
     C                     KFLD           WQSB02           EA Kill Date
      * Setup key
     C                     Z-ADDP1HONB    WQSB01           EA Company Numb
     C                     Z-ADDYL0001    WQSB02           EA Kill Date
      * Establish starting position
     C           KRSSB     SETLL@CPCPG7                    *
     C           KRSSB     READE@CPCPG7                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Retrieve Source Type
      * CASE: LCL.EA Tattoo Number NE DB1.EA Tattoo Number
     C           YL0003    IFNE WBKHNB                     *IF
      * Rtv Source Type       RT - Tattoo Header  * 
     C                     EXSR SCRVGN
     C                     Z-ADDWBKHNB    YL0003           EA Tattoo Numbe
     C                     END                             *FI
      * Valid Source Type
      * CASE: LCL.TH Source Type is *ALL values
     C           YL0004    IFEQ 'E'                        *IF
     C           YL0004    OREQ 'I'
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Export Rate Calc STS USR is All
      *   |- c2    : PAR.Export Rate Calc STS USR is HPE Summary
      *   '-
     C           P2WJST    IFEQ *BLANK                     *IF
     C           P2WJST    OREQ 'H'                        *OR
      * CASE: HotWgt > 0 & BackFat > 0 & LoinEye > 0
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.EA Hot Weight is Not Zero
      *   |- c2    : DB1.EA Backfat MM is GT Zero
      *   |- c3    : DB1.EA LoinEye MM is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBKJNB    IFNE 0                          *IF
     C           WBX6NB    IFGT 0                          *IF
     C           WBFQPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.EA Hot Weight is Between 130 & 310
     C           WBKJNB    IFGE 130                        *IF
     C           WBKJNB    ANDLE310
      * COMPUTE LEAN % Morrison Hot Scale
     C                     EXSR UASUBR                     COMPUTE LEAN %
      * CASE: LCL.ET Lean Percent NPPC is Between 42 & 62
     C           YL0015    IFGE 42                         *IF
     C           YL0015    ANDLE62
      * Clc Live Weight       XF - STR Order Management Sys  * 
     C                     CALL 'PDO1XFR'              90  Clc Live Weight
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHKST    WQ0010  30       CC Company Numb
     C                     PARM WBKJNB    WQ0011 112       Hot Weight 11.2
     C                     PARM *ZERO     WQ0012 112       Live Weight 11.
     C           YL0016    PARM *ZERO     WQ0013 111       Live wgt total
     C                     PARM *ZERO     WQ0014  50       Live Weight 5.0
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDO1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Live Weight, Hot Weight, Head Killed
      * CASE: LCL.TH Source Type is Internal
     C           YL0004    IFEQ 'I'                        *IF
      * CASE: DB1.EA Shift is Shift 1
     C           WBHLST    IFEQ '1'                        *IF
     C                     ADD  YL0016    WN0001           Shift A Int Adj
     C                     ADD  WBKJNB    WN0002           Shift A Int Hot
     C                     ADD  1         WN0003           Shift A Int Hd
     C                     ELSE
      * CASE: DB1.EA Shift is Shift 2
     C           WBHLST    IFEQ '2'                        *IF
     C                     ADD  YL0016    WN0017           Shift B Int Adj
     C                     ADD  WBKJNB    WN0018           Shift B Int Hot
     C                     ADD  1         WN0019           Shift B Int Hd
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.TH Source Type is External
     C           YL0004    IFEQ 'E'                        *IF
      * CASE: DB1.EA Shift is Shift 1
     C           WBHLST    IFEQ '1'                        *IF
     C                     ADD  YL0016    WN0008           Shift A Ext Adj
     C                     ADD  WBKJNB    WN0009           Shift A Ext Hot
     C                     ADD  1         WN0010           Shift A Ext Hd
     C                     ELSE
      * CASE: DB1.EA Shift is Shift 2
     C           WBHLST    IFEQ '2'                        *IF
     C                     ADD  YL0016    WN0024           Shift B Ext Adj
     C                     ADD  WBKJNB    WN0025           Shift B Ext Hot
     C                     ADD  1         WN0026           Shift B Ext Hd
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@CPCPG7                  90*
     C                     ENDDO
      * USER: Exit processing
      * Calculate Standard Deviation
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Export Rate Calc STS USR is All
      *   |- c2    : PAR.Export Rate Calc STS USR is Standard Deviation
      *   '-
     C           P2WJST    IFEQ *BLANK                     *IF
     C           P2WJST    OREQ 'S'                        *OR
      * Clc Std Deviation     CL - Export Rate HPE Summary  * Shift 1 Int
     C                     CALL 'PKX6UPC'              90  Clc Std Deviati
     C                     PARM 'A'       WQ0015  1        SDev Level USR
     C                     PARM P1HONB    WQ0016  30       CC Company Numb
     C                     PARM YL0001    WQ0017  70       TH Kill Date
     C                     PARM '1'       WQ0018  1        EA Shift
     C                     PARM 'I'       WQ0019  1        TH Source Type
     C           WN0006    PARM *ZERO     WQ0020  95       Standard Deviat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Clc Std Deviation     CL - Export Rate HPE Summary  * Shift 2 Int
     C                     CALL 'PKX6UPC'              90  Clc Std Deviati
     C                     PARM 'A'       WQ0021  1        SDev Level USR
     C                     PARM P1HONB    WQ0022  30       CC Company Numb
     C                     PARM YL0001    WQ0023  70       TH Kill Date
     C                     PARM '2'       WQ0024  1        EA Shift
     C                     PARM 'I'       WQ0025  1        TH Source Type
     C           WN0022    PARM *ZERO     WQ0026  95       Standard Deviat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Clc Std Deviation     CL - Export Rate HPE Summary  * Shift 1 Ext
     C                     CALL 'PKX6UPC'              90  Clc Std Deviati
     C                     PARM 'A'       WQ0027  1        SDev Level USR
     C                     PARM P1HONB    WQ0028  30       CC Company Numb
     C                     PARM YL0001    WQ0029  70       TH Kill Date
     C                     PARM '1'       WQ0030  1        EA Shift
     C                     PARM 'E'       WQ0031  1        TH Source Type
     C           WN0013    PARM *ZERO     WQ0032  95       Standard Deviat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Clc Std Deviation     CL - Export Rate HPE Summary  * Shift 2 Ext
     C                     CALL 'PKX6UPC'              90  Clc Std Deviati
     C                     PARM 'A'       WQ0033  1        SDev Level USR
     C                     PARM P1HONB    WQ0034  30       CC Company Numb
     C                     PARM YL0001    WQ0035  70       TH Kill Date
     C                     PARM '2'       WQ0036  1        EA Shift
     C                     PARM 'E'       WQ0037  1        TH Source Type
     C           WN0029    PARM *ZERO     WQ0038  95       Standard Deviat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Clc Std Deviation     CL - Export Rate HPE Summary  * Shift 1 Tot
     C                     CALL 'PKX6UPC'              90  Clc Std Deviati
     C                     PARM 'B'       WQ0039  1        SDev Level USR
     C                     PARM P1HONB    WQ0040  30       CC Company Numb
     C                     PARM YL0001    WQ0041  70       TH Kill Date
     C                     PARM '1'       WQ0042  1        EA Shift
     C                     PARM YL0004    WQ0043  1        TH Source Type
     C           WN0015    PARM *ZERO     WQ0044  95       Standard Deviat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Clc Std Deviation     CL - Export Rate HPE Summary  * Shift 2 Tot
     C                     CALL 'PKX6UPC'              90  Clc Std Deviati
     C                     PARM 'B'       WQ0045  1        SDev Level USR
     C                     PARM P1HONB    WQ0046  30       CC Company Numb
     C                     PARM YL0001    WQ0047  70       TH Kill Date
     C                     PARM '2'       WQ0048  1        EA Shift
     C                     PARM YL0004    WQ0049  1        TH Source Type
     C           WN0031    PARM *ZERO     WQ0050  95       Standard Deviat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Clc Std Deviation     CL - Export Rate HPE Summary  * Internal
     C                     CALL 'PKX6UPC'              90  Clc Std Deviati
     C                     PARM 'D'       WQ0051  1        SDev Level USR
     C                     PARM P1HONB    WQ0052  30       CC Company Numb
     C                     PARM YL0001    WQ0053  70       TH Kill Date
     C                     PARM YL0017    WQ0054  1        EA Shift
     C                     PARM 'I'       WQ0055  1        TH Source Type
     C           WN0033    PARM *ZERO     WQ0056  95       Standard Deviat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Clc Std Deviation     CL - Export Rate HPE Summary  * External
     C                     CALL 'PKX6UPC'              90  Clc Std Deviati
     C                     PARM 'D'       WQ0057  1        SDev Level USR
     C                     PARM P1HONB    WQ0058  30       CC Company Numb
     C                     PARM YL0001    WQ0059  70       TH Kill Date
     C                     PARM YL0017    WQ0060  1        EA Shift
     C                     PARM 'E'       WQ0061  1        TH Source Type
     C           WN0035    PARM *ZERO     WQ0062  95       Standard Deviat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Clc Std Deviation     CL - Export Rate HPE Summary  * Total
     C                     CALL 'PKX6UPC'              90  Clc Std Deviati
     C                     PARM 'C'       WQ0063  1        SDev Level USR
     C                     PARM P1HONB    WQ0064  30       CC Company Numb
     C                     PARM YL0001    WQ0065  70       TH Kill Date
     C                     PARM YL0017    WQ0066  1        EA Shift
     C                     PARM YL0004    WQ0067  1        TH Source Type
     C           WN0037    PARM *ZERO     WQ0068  95       Standard Deviat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Calculate Head w/2 Hours Rest
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Export Rate Calc STS USR is All
      *   |- c2    : PAR.Export Rate Calc STS USR is 2Hr Rest
      *   '-
     C           P2WJST    IFEQ *BLANK                     *IF
     C           P2WJST    OREQ '2'                        *OR
     C                     MOVEL*BLANK    YL0018           Company Number
     C                     MOVELP1HONB    YL0018           Company Number
     C                     MOVEL*BLANK    YL0019           Date Alpha USR
     C                     MOVELYL0001    YL0019           Date Alpha USR
     C                     MOVEL*BLANK    YL0020           Tattoo Nbr Alph
     C                     MOVELWUCVNB    YL0020           Tattoo Nbr Alph
     C                     MOVEL*BLANK    YL0021           Date Alpha Usr
     C                     MOVELYL0001    YL0021           Date Alpha Usr
      * Setup message data for message
     C                     MOVEL*BLANK    ZA0001           PRT Printer Dev
     C                     MOVELWUAKST    ZA0002           PRT Hold Output
     C                     MOVELWUAMST    ZA0003           PRT Save Output
     C                     Z-ADD*ZERO     ZA0004           PRT Copies
     C                     MOVEL*BLANK    ZA0005           PRT Night Queue
     C                     MOVELYL0018    ZA0006           Company Number
     C                     MOVELYL0019    ZA0007           Date Alpha USR
     C                     MOVELWUKAST    ZA0008           TH Source Type
     C                     MOVEL*BLANK    ZA0009           Pen Number
     C                     MOVELWULIST    ZA0010           TH Schedule Kil
     C                     MOVELYL0020    ZA0011           Tattoo Nbr Alph
     C                     MOVELYL0021    ZA0012           Date Alpha Usr
     C                     MOVEL*BLANK    ZA0013           Document Name U
     C                     MOVEL'B'       ZA0014           Process Type US
     C                     MOVEL*BLANK    ZA0015           Oms System Valu
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0998' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
      * Rtv >2hr Rest Head    XF - W001 Rest Time Eval Workf  * 
     C                     CALL 'PKX7XFR'              90  Rtv >2hr Rest H
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0069  30       BOH Company Num
     C                     PARM YL0001    WQ0070  70       TH Kill Date
     C           WN0004    PARM WN0004    WQ0071  50       Shift A Int Hd
     C           WN0005    PARM WN0005    WQ0072  50       Shift A Int Hd
     C           WN0011    PARM WN0011    WQ0073  50       Shift A Ext Hd
     C           WN0012    PARM WN0012    WQ0074  50       Shift A Ext Hd
     C           WN0020    PARM WN0020    WQ0075  50       Shift B Int Hd
     C           WN0021    PARM WN0021    WQ0076  50       Shift B Int Hd
     C           WN0027    PARM WN0027    WQ0077  50       Shift B Ext Hd
     C           WN0028    PARM WN0028    WQ0078  50       Shift B Ext Hd
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKX7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Retrieve Export Rate Adjustment
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Export Rate Calc STS USR is All
      *   |- c2    : PAR.Export Rate Calc STS USR is Rate Adjustment
      *   '-
     C           P2WJST    IFEQ *BLANK                     *IF
     C           P2WJST    OREQ 'R'                        *OR
      * Shift A Internal
      * CASE: PAR.Shift A Int Hd Killed is Not Zero
     C           WN0003    IFNE 0                          *IF
     C           WN0002    DIV  WN0003    YL0022    H      Avg Hot Wgt 7.4
      * Rtv Export Rate Adj   XF - STR Order Management Sys  * 
     C                     CALL 'POPAXFR'              90  Rtv Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0079  30       Company Number
     C                     PARM YL0001    WQ0080  70       Kill Date Usr
     C                     PARM '1'       WQ0081  1        EA Shift
     C                     PARM WN0006    WQ0082  95       Standard Deviat
     C                     PARM YL0022    WQ0083  74       Avg Hot Wgt 7.4
     C           WN0007    PARM *ZERO     WQ0084  52       Rate Adjustment
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Shift A External
      * CASE: PAR.Shift A Ext Hd Killed is Not Zero
     C           WN0010    IFNE 0                          *IF
     C           WN0009    DIV  WN0010    YL0022    H      Avg Hot Wgt 7.4
      * Rtv Export Rate Adj   XF - STR Order Management Sys  * 
     C                     CALL 'POPAXFR'              90  Rtv Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0085  30       Company Number
     C                     PARM YL0001    WQ0086  70       Kill Date Usr
     C                     PARM '1'       WQ0087  1        EA Shift
     C                     PARM WN0013    WQ0088  95       Standard Deviat
     C                     PARM YL0022    WQ0089  74       Avg Hot Wgt 7.4
     C           WN0014    PARM *ZERO     WQ0090  52       Rate Adjustment
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Shift A
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Shift A Int Hd Killed is Not Zero
      *   |- c2    : PAR.Shift A Ext Hd Killed is Not Zero
      *   '-
     C           WN0003    IFNE 0                          *IF
     C           WN0010    ORNE 0                          *OR
      * Avg Hot Wgt
      * LCL.Avg Hot Wgt 7.4 USR =
      *    *COMPUTE ((x1 + x2) / (x3 + x4))
      * x1    : PAR.Shift A Int Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.Shift A Ext Hot Wgt
      * /     : LCL.Avg Hot Wgt 7.4 USR *Rounded
      * x3    : PAR.Shift A Int Hd Killed
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.Shift A Ext Hd Killed
     C           WN0002    ADD  WN0009    W0WA00           *Synon (15,2) w
     C           WN0003    ADD  WN0010    W0WJ01           *Synon (15,0) w
     C           W0WA00    DIV  W0WJ01    YL0022    H      Avg Hot Wgt 7.4
     C                     Z-ADDYL0022    YL0022           Avg Hot Wgt 7.4
      * Rtv Export Rate Adj   XF - STR Order Management Sys  * 
     C                     CALL 'POPAXFR'              90  Rtv Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0091  30       Company Number
     C                     PARM YL0001    WQ0092  70       Kill Date Usr
     C                     PARM '1'       WQ0093  1        EA Shift
     C                     PARM WN0015    WQ0094  95       Standard Deviat
     C                     PARM YL0022    WQ0095  74       Avg Hot Wgt 7.4
     C           WN0016    PARM *ZERO     WQ0096  52       Rate Adjustment
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Shift B Internal
      * CASE: PAR.Shift B Int Hd Killed is Not Zero
     C           WN0019    IFNE 0                          *IF
     C           WN0018    DIV  WN0019    YL0022    H      Avg Hot Wgt 7.4
      * Rtv Export Rate Adj   XF - STR Order Management Sys  * 
     C                     CALL 'POPAXFR'              90  Rtv Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0097  30       Company Number
     C                     PARM YL0001    WQ0098  70       Kill Date Usr
     C                     PARM '2'       WQ0099  1        EA Shift
     C                     PARM WN0022    WQ0100  95       Standard Deviat
     C                     PARM YL0022    WQ0101  74       Avg Hot Wgt 7.4
     C           WN0023    PARM *ZERO     WQ0102  52       Rate Adjustment
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Shift B External
      * CASE: PAR.Shift B Ext Hd Killed is Not Zero
     C           WN0026    IFNE 0                          *IF
     C           WN0025    DIV  WN0026    YL0022    H      Avg Hot Wgt 7.4
      * Rtv Export Rate Adj   XF - STR Order Management Sys  * 
     C                     CALL 'POPAXFR'              90  Rtv Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0103  30       Company Number
     C                     PARM YL0001    WQ0104  70       Kill Date Usr
     C                     PARM '2'       WQ0105  1        EA Shift
     C                     PARM WN0029    WQ0106  95       Standard Deviat
     C                     PARM YL0022    WQ0107  74       Avg Hot Wgt 7.4
     C           WN0030    PARM *ZERO     WQ0108  52       Rate Adjustment
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Shift B
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Shift B Int Hd Killed is Not Zero
      *   |- c2    : PAR.Shift B Ext Hd Killed is Not Zero
      *   '-
     C           WN0019    IFNE 0                          *IF
     C           WN0026    ORNE 0                          *OR
      * Avg Hot Wgt
      * LCL.Avg Hot Wgt 7.4 USR =
      *    *COMPUTE ((x1 + x2) / (x3 + x4))
      * x1    : PAR.Shift B Int Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.Shift B Ext Hot Wgt
      * /     : LCL.Avg Hot Wgt 7.4 USR *Rounded
      * x3    : PAR.Shift B Int Hd Killed
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.Shift B Ext Hd Killed
     C           WN0018    ADD  WN0025    W0WA00           *Synon (15,2) w
     C           WN0019    ADD  WN0026    W0WJ01           *Synon (15,0) w
     C           W0WA00    DIV  W0WJ01    YL0022    H      Avg Hot Wgt 7.4
     C                     Z-ADDYL0022    YL0022           Avg Hot Wgt 7.4
      * Rtv Export Rate Adj   XF - STR Order Management Sys  * 
     C                     CALL 'POPAXFR'              90  Rtv Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0109  30       Company Number
     C                     PARM YL0001    WQ0110  70       Kill Date Usr
     C                     PARM '2'       WQ0111  1        EA Shift
     C                     PARM WN0031    WQ0112  95       Standard Deviat
     C                     PARM YL0022    WQ0113  74       Avg Hot Wgt 7.4
     C           WN0032    PARM *ZERO     WQ0114  52       Rate Adjustment
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Total Internal
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Shift A Int Hd Killed is Not Zero
      *   |- c2    : PAR.Shift B Int Hd Killed is Not Zero
      *   '-
     C           WN0003    IFNE 0                          *IF
     C           WN0019    ORNE 0                          *OR
      * Avg Hot Wgt
      * LCL.Avg Hot Wgt 7.4 USR =
      *    *COMPUTE ((x1 + x2) / (x3 + x4))
      * x1    : PAR.Shift A Int Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.Shift B Int Hot Wgt
      * /     : LCL.Avg Hot Wgt 7.4 USR *Rounded
      * x3    : PAR.Shift A Int Hd Killed
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.Shift B Int Hd Killed
     C           WN0002    ADD  WN0018    W0WA00           *Synon (15,2) w
     C           WN0003    ADD  WN0019    W0WJ01           *Synon (15,0) w
     C           W0WA00    DIV  W0WJ01    YL0022    H      Avg Hot Wgt 7.4
     C                     Z-ADDYL0022    YL0022           Avg Hot Wgt 7.4
      * Rtv Export Rate Adj   XF - STR Order Management Sys  * 
     C                     CALL 'POPAXFR'              90  Rtv Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0115  30       Company Number
     C                     PARM YL0001    WQ0116  70       Kill Date Usr
     C                     PARM WUHLST    WQ0117  1        EA Shift
     C                     PARM WN0033    WQ0118  95       Standard Deviat
     C                     PARM YL0022    WQ0119  74       Avg Hot Wgt 7.4
     C           WN0034    PARM *ZERO     WQ0120  52       Rate Adjustment
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Total External
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Shift A Ext Hd Killed is Not Zero
      *   |- c2    : PAR.Shift B Ext Hd Killed is Not Zero
      *   '-
     C           WN0010    IFNE 0                          *IF
     C           WN0026    ORNE 0                          *OR
      * Avg Hot Wgt
      * LCL.Avg Hot Wgt 7.4 USR =
      *    *COMPUTE ((x1 + x2) / (x3 + x4))
      * x1    : PAR.Shift A Ext Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.Shift B Ext Hot Wgt
      * /     : LCL.Avg Hot Wgt 7.4 USR *Rounded
      * x3    : PAR.Shift A Ext Hd Killed
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.Shift B Ext Hd Killed
     C           WN0009    ADD  WN0025    W0WA00           *Synon (15,2) w
     C           WN0010    ADD  WN0026    W0WJ01           *Synon (15,0) w
     C           W0WA00    DIV  W0WJ01    YL0022    H      Avg Hot Wgt 7.4
     C                     Z-ADDYL0022    YL0022           Avg Hot Wgt 7.4
      * Rtv Export Rate Adj   XF - STR Order Management Sys  * 
     C                     CALL 'POPAXFR'              90  Rtv Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0121  30       Company Number
     C                     PARM YL0001    WQ0122  70       Kill Date Usr
     C                     PARM WUHLST    WQ0123  1        EA Shift
     C                     PARM WN0035    WQ0124  95       Standard Deviat
     C                     PARM YL0022    WQ0125  74       Avg Hot Wgt 7.4
     C           WN0036    PARM *ZERO     WQ0126  52       Rate Adjustment
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Total
      * CASE:
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : PAR.Shift A Int Hd Killed is Not Zero
      *   |- c2    : PAR.Shift B Int Hd Killed is Not Zero
      *   |- c3    : PAR.Shift A Ext Hd Killed is Not Zero
      *   |- c4    : PAR.Shift B Ext Hd Killed is Not Zero
      *   '-
     C           WN0003    IFNE 0                          *IF
     C           WN0019    ORNE 0                          *OR
     C           WN0010    ORNE 0                          *OR
     C           WN0026    ORNE 0                          *OR
      * **  There can't be an adjustment, how do I know the max piece. **
      * Avg Hot Wgt
      * LCL.Avg Hot Wgt 7.4 USR =
      *    *COMPUTE ((x1 + x2 + x5 + x6 ) / (x3 + x4 + x7 + x8))
      * x1    : PAR.Shift A Int Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.Shift A Ext Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x5    : PAR.Shift B Int Hot Wgt
      * +     : PGM.*Synon (15,2) work field
      * x6    : PAR.Shift B Ext Hot Wgt
      * /     : LCL.Avg Hot Wgt 7.4 USR *Rounded
      * x3    : PAR.Shift A Int Hd Killed
      * +     : PGM.*Synon (15,0) work field
      * x4    : PAR.Shift A Ext Hd Killed
      * +     : PGM.*Synon (15,0) work field
      * x7    : PAR.Shift B Int Hd Killed
      * +     : PGM.*Synon (15,0) work field
      * x8    : PAR.Shift B Ext Hd Killed
     C           WN0002    ADD  WN0009    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WN0018    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WN0025    W0WA00           *Synon (15,2) w
     C           WN0003    ADD  WN0010    W0WJ05           *Synon (15,0) w
     C           W0WJ05    ADD  WN0019    W0WJ04           *Synon (15,0) w
     C           W0WJ04    ADD  WN0026    W0WJ03           *Synon (15,0) w
     C           W0WA00    DIV  W0WJ03    YL0022    H      Avg Hot Wgt 7.4
     C                     Z-ADDYL0022    YL0022           Avg Hot Wgt 7.4
     C                     MOVELWUCRTX    WUHLST           EA Shift
      * Rtv Export Rate Adj   XF - STR Order Management Sys  * 
     C                     CALL 'POPAXFR'              90  Rtv Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0127  30       Company Number
     C                     PARM YL0001    WQ0128  70       Kill Date Usr
     C                     PARM WUHLST    WQ0129  1        EA Shift
     C                     PARM WN0037    WQ0130  95       Standard Deviat
     C                     PARM YL0022    WQ0131  74       Avg Hot Wgt 7.4
     C           WN0038    PARM *ZERO     WQ0132  52       Rate Adjustment
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Upd Exp Rate HPE Sum  RT - Export Rate HPE Summary  * 
     C                     EXSR SDRVGN
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCB0DT    WQSC02           TH Kill Date
     C           *LIKE     DEFN WCCVNB    WQSC03           TH Tattoo Numbe
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           TH Kill Date
     C                     KFLD           WQSC03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHKST    WQSC01           BOH Company Num
     C                     Z-ADDWBB7DT    WQSC02           TH Kill Date
     C                     Z-ADDWBKHNB    WQSC03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSC     SETLL@A1CPL0                    *
     C           KRSSC     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           TH Source Type
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCKAST    YL0004           TH Source Type
     C           KRSSC     READE@A1CPL0                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Upd Exp Rate HPE Sum  RT - Export Rate HPE Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHONB           CC Company Numb
     C                     KFLD           WDB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HONB    WDHONB           CC Company Numb
     C                     Z-ADDYL0001    WDB0DT           TH Kill Date
      * Establish starting position
     C           KRSSD     CHAIN@FDCPG6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0996' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Exp Rate HPE Sum  CR - Export Rate HPE Summary  * 
     C                     EXSR SECRRC
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: PAR.Export Rate Calc STS USR is All
     C           P2WJST    IFEQ *BLANK                     *IF
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
     C                     EXSR SFCHRC
     C                     ELSE
      * CASE: PAR.Export Rate Calc STS USR is HPE Summary
     C           P2WJST    IFEQ 'H'                        *IF
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
     C                     EXSR SGCHRC
     C                     ELSE
      * CASE: PAR.Export Rate Calc STS USR is Standard Deviation
     C           P2WJST    IFEQ 'S'                        *IF
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
     C                     EXSR SHCHRC
     C                     ELSE
      * CASE: PAR.Export Rate Calc STS USR is 2Hr Rest
     C           P2WJST    IFEQ '2'                        *IF
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
     C                     EXSR SICHRC
     C                     ELSE
      * CASE: PAR.Export Rate Calc STS USR is Rate Adjustment
     C           P2WJST    IFEQ 'R'                        *IF
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
     C                     EXSR SJCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Exp Rate HPE Sum  CR - Export Rate HPE Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FDCPG5
     C                     Z-ADDP1HONB    WEHONB           CC Company Numb
     C                     Z-ADDYL0001    WEB0DT           TH Kill Date
     C                     Z-ADDWN0001    WEFXA1           Shift A Int Adj
     C                     Z-ADDWN0002    WEFYA1           Shift A Int Hot
     C                     Z-ADDWN0003    WEFZA1           Shift A Int Hd
     C                     Z-ADDWN0004    WEG0A1           Shift A Int Hd
     C                     Z-ADDWN0005    WEGLA1           Shift A Int Hd
     C                     Z-ADDWN0006    WEF0A1           Shift A Int Hot
     C                     Z-ADDWN0007    WEGKA1           Shift A Int Rat
     C                     Z-ADDWN0008    WEF1A1           Shift A Ext Adj
     C                     Z-ADDWN0009    WEF2A1           Shift A Ext Hot
     C                     Z-ADDWN0010    WEF3A1           Shift A Ext Hd
     C                     Z-ADDWN0011    WEG2A1           Shift A Ext Hd
     C                     Z-ADDWN0012    WEGNA1           Shift A Ext Hd
     C                     Z-ADDWN0013    WEF4A1           Shift A Ext Hot
     C                     Z-ADDWN0014    WEGPA1           Shift A Ext Rat
     C                     Z-ADDWN0015    WEF5A1           Shift A Tot Hot
     C                     Z-ADDWN0016    WEGQA1           Shift A Tot Rat
     C                     Z-ADD*ZERO     WEJSA1           Shift A Kill to
     C                     Z-ADDWN0017    WEF7A1           Shift B Int Adj
     C                     Z-ADDWN0018    WEF8A1           Shift B Int Hot
     C                     Z-ADDWN0019    WEF9A1           Shift B Int Hd
     C                     Z-ADDWN0020    WEG1A1           Shift B Int Hd
     C                     Z-ADDWN0021    WEGMA1           Shift B Int Hd
     C                     Z-ADDWN0022    WEGAA1           Shift B Int Hot
     C                     Z-ADDWN0023    WEGRA1           Shift B Int Rat
     C                     Z-ADDWN0024    WEGBA1           Shift B Ext Adj
     C                     Z-ADDWN0025    WEGCA1           Shift B Ext Hot
     C                     Z-ADDWN0026    WEGDA1           Shift B Ext Hd
     C                     Z-ADDWN0027    WEG3A1           Shift B Ext Hd
     C                     Z-ADDWN0028    WEGOA1           Shift B Ext Hd
     C                     Z-ADDWN0029    WEGEA1           Shift B Ext Hot
     C                     Z-ADDWN0030    WEGSA1           Shift B Ext Rat
     C                     Z-ADDWN0031    WEGFA1           Shift B Tot Hot
     C                     Z-ADDWN0032    WEGTA1           Shift B Tot Rat
     C                     Z-ADD*ZERO     WEJTA1           Shift B Kill to
     C                     Z-ADDWN0033    WEGHA1           Total Int Hot W
     C                     Z-ADDWN0034    WEGUA1           Total Int Rate
     C                     Z-ADDWN0035    WEGIA1           Total Ext Hot W
     C                     Z-ADDWN0036    WEGWA1           Total Ext Rate
     C                     Z-ADDWN0037    WEGJA1           Total Hot Wgt S
     C                     Z-ADDWN0038    WEGVA1           Total Rate Adj
     C                     Z-ADD*ZERO     WEJUA1           Total Kill to C
     C                     Z-ADDP1EVDT    WEEVDT           Production Date
     C                     MOVEL*BLANK    WEAAVN           RS User Changed
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     MOVELWUAJST    WEAJST           RS Record Statu
     C                     MOVEL*BLANK    WEAHVN           RS Job
     C                     MOVEL*BLANK    WEAGVN           RS Program
     C                     MOVEL*BLANK    WEABVN           RS User Added
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEABDT    PARM *ZERO     WQ0133  70       *DATE
     C           WEABTM    PARM *ZERO     WQ0134  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRSE    SETLL@FDCPG5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0997' W0RTN   7
      * Send message 'Export Rate HPE Summar EX'
     C                     MOVEL'PRK0997' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@FDCPG5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0039 10        RS User Changed
     C                     Z-ADD*ZERO     WN0040  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0041  60       RS Time Changed
     C                     MOVEL*BLANK    WN0042  1        RS Record Statu
     C                     MOVEL*BLANK    WN0043 10        RS Job
     C                     MOVEL*BLANK    WN0044 10        RS Program
     C                     MOVEL*BLANK    WN0045 10        RS User Added
     C                     Z-ADD*ZERO     WN0046  70       RS Date Added
     C                     Z-ADD*ZERO     WN0047  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FDCPG5
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSF    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSF    CHAIN@FDCPG5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFDCPL0'MDACP
     C                     MOVEL'@FDCPG5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFD1    YARDCS
      * Move non-key fields to @FDCPG5
     C                     Z-ADDWN0001    WEFXA1           Shift A Int Adj
     C                     Z-ADDWN0002    WEFYA1           Shift A Int Hot
     C                     Z-ADDWN0003    WEFZA1           Shift A Int Hd
     C                     Z-ADDWN0004    WEG0A1           Shift A Int Hd
     C                     Z-ADDWN0005    WEGLA1           Shift A Int Hd
     C                     Z-ADDWN0006    WEF0A1           Shift A Int Hot
     C                     Z-ADDWN0007    WEGKA1           Shift A Int Rat
     C                     Z-ADDWN0008    WEF1A1           Shift A Ext Adj
     C                     Z-ADDWN0009    WEF2A1           Shift A Ext Hot
     C                     Z-ADDWN0010    WEF3A1           Shift A Ext Hd
     C                     Z-ADDWN0011    WEG2A1           Shift A Ext Hd
     C                     Z-ADDWN0012    WEGNA1           Shift A Ext Hd
     C                     Z-ADDWN0013    WEF4A1           Shift A Ext Hot
     C                     Z-ADDWN0014    WEGPA1           Shift A Ext Rat
     C                     Z-ADDWN0015    WEF5A1           Shift A Tot Hot
     C                     Z-ADDWN0016    WEGQA1           Shift A Tot Rat
     C                     Z-ADDWDJSA1    WEJSA1           Shift A Kill to
     C                     Z-ADDWN0017    WEF7A1           Shift B Int Adj
     C                     Z-ADDWN0018    WEF8A1           Shift B Int Hot
     C                     Z-ADDWN0019    WEF9A1           Shift B Int Hd
     C                     Z-ADDWN0020    WEG1A1           Shift B Int Hd
     C                     Z-ADDWN0021    WEGMA1           Shift B Int Hd
     C                     Z-ADDWN0022    WEGAA1           Shift B Int Hot
     C                     Z-ADDWN0023    WEGRA1           Shift B Int Rat
     C                     Z-ADDWN0024    WEGBA1           Shift B Ext Adj
     C                     Z-ADDWN0025    WEGCA1           Shift B Ext Hot
     C                     Z-ADDWN0026    WEGDA1           Shift B Ext Hd
     C                     Z-ADDWN0027    WEG3A1           Shift B Ext Hd
     C                     Z-ADDWN0028    WEGOA1           Shift B Ext Hd
     C                     Z-ADDWN0029    WEGEA1           Shift B Ext Hot
     C                     Z-ADDWN0030    WEGSA1           Shift B Ext Rat
     C                     Z-ADDWN0031    WEGFA1           Shift B Tot Hot
     C                     Z-ADDWN0032    WEGTA1           Shift B Tot Rat
     C                     Z-ADDWDJTA1    WEJTA1           Shift B Kill to
     C                     Z-ADDWN0033    WEGHA1           Total Int Hot W
     C                     Z-ADDWN0034    WEGUA1           Total Int Rate
     C                     Z-ADDWN0035    WEGIA1           Total Ext Hot W
     C                     Z-ADDWN0036    WEGWA1           Total Ext Rate
     C                     Z-ADDWN0037    WEGJA1           Total Hot Wgt S
     C                     Z-ADDWN0038    WEGVA1           Total Rate Adj
     C                     Z-ADDWDJUA1    WEJUA1           Total Kill to C
     C                     Z-ADDP1EVDT    WEEVDT           Production Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WEAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEAADT    PARM *ZERO     WQ0135  70       *DATE
     C           WEAMTM    PARM *ZERO     WQ0136  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FDCPG5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0048 10        RS User Changed
     C                     Z-ADD*ZERO     WN0049  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0050  60       RS Time Changed
     C                     MOVEL*BLANK    WN0051  1        RS Record Statu
     C                     MOVEL*BLANK    WN0052 10        RS Job
     C                     MOVEL*BLANK    WN0053 10        RS Program
     C                     MOVEL*BLANK    WN0054 10        RS User Added
     C                     Z-ADD*ZERO     WN0055  70       RS Date Added
     C                     Z-ADD*ZERO     WN0056  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FDCPG5
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSG    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSG    CHAIN@FDCPG5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFDCPL0'MDACP
     C                     MOVEL'@FDCPG5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFD1    YBRDCS
      * Move non-key fields to @FDCPG5
     C                     Z-ADDWN0001    WEFXA1           Shift A Int Adj
     C                     Z-ADDWN0002    WEFYA1           Shift A Int Hot
     C                     Z-ADDWN0003    WEFZA1           Shift A Int Hd
     C                     Z-ADDWDG0A1    WEG0A1           Shift A Int Hd
     C                     Z-ADDWDGLA1    WEGLA1           Shift A Int Hd
     C                     Z-ADDWDF0A1    WEF0A1           Shift A Int Hot
     C                     Z-ADDWDGKA1    WEGKA1           Shift A Int Rat
     C                     Z-ADDWN0008    WEF1A1           Shift A Ext Adj
     C                     Z-ADDWN0009    WEF2A1           Shift A Ext Hot
     C                     Z-ADDWN0010    WEF3A1           Shift A Ext Hd
     C                     Z-ADDWDG2A1    WEG2A1           Shift A Ext Hd
     C                     Z-ADDWDGNA1    WEGNA1           Shift A Ext Hd
     C                     Z-ADDWDF4A1    WEF4A1           Shift A Ext Hot
     C                     Z-ADDWDGPA1    WEGPA1           Shift A Ext Rat
     C                     Z-ADDWDF5A1    WEF5A1           Shift A Tot Hot
     C                     Z-ADDWDGQA1    WEGQA1           Shift A Tot Rat
     C                     Z-ADDWDJSA1    WEJSA1           Shift A Kill to
     C                     Z-ADDWN0017    WEF7A1           Shift B Int Adj
     C                     Z-ADDWN0018    WEF8A1           Shift B Int Hot
     C                     Z-ADDWN0019    WEF9A1           Shift B Int Hd
     C                     Z-ADDWDG1A1    WEG1A1           Shift B Int Hd
     C                     Z-ADDWDGMA1    WEGMA1           Shift B Int Hd
     C                     Z-ADDWDGAA1    WEGAA1           Shift B Int Hot
     C                     Z-ADDWDGRA1    WEGRA1           Shift B Int Rat
     C                     Z-ADDWN0024    WEGBA1           Shift B Ext Adj
     C                     Z-ADDWN0025    WEGCA1           Shift B Ext Hot
     C                     Z-ADDWN0026    WEGDA1           Shift B Ext Hd
     C                     Z-ADDWDG3A1    WEG3A1           Shift B Ext Hd
     C                     Z-ADDWDGOA1    WEGOA1           Shift B Ext Hd
     C                     Z-ADDWDGEA1    WEGEA1           Shift B Ext Hot
     C                     Z-ADDWDGSA1    WEGSA1           Shift B Ext Rat
     C                     Z-ADDWDGFA1    WEGFA1           Shift B Tot Hot
     C                     Z-ADDWDGTA1    WEGTA1           Shift B Tot Rat
     C                     Z-ADDWDJTA1    WEJTA1           Shift B Kill to
     C                     Z-ADDWDGHA1    WEGHA1           Total Int Hot W
     C                     Z-ADDWDGUA1    WEGUA1           Total Int Rate
     C                     Z-ADDWDGIA1    WEGIA1           Total Ext Hot W
     C                     Z-ADDWDGWA1    WEGWA1           Total Ext Rate
     C                     Z-ADDWDGJA1    WEGJA1           Total Hot Wgt S
     C                     Z-ADDWDGVA1    WEGVA1           Total Rate Adj
     C                     Z-ADDWDJUA1    WEJUA1           Total Kill to C
     C                     Z-ADDP1EVDT    WEEVDT           Production Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WEAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEAADT    PARM *ZERO     WQ0137  70       *DATE
     C           WEAMTM    PARM *ZERO     WQ0138  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FDCPG5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0057 10        RS User Changed
     C                     Z-ADD*ZERO     WN0058  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0059  60       RS Time Changed
     C                     MOVEL*BLANK    WN0060  1        RS Record Statu
     C                     MOVEL*BLANK    WN0061 10        RS Job
     C                     MOVEL*BLANK    WN0062 10        RS Program
     C                     MOVEL*BLANK    WN0063 10        RS User Added
     C                     Z-ADD*ZERO     WN0064  70       RS Date Added
     C                     Z-ADD*ZERO     WN0065  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FDCPG5
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSH    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSH    CHAIN@FDCPG5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFDCPL0'MDACP
     C                     MOVEL'@FDCPG5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFD1    YCRDCS
      * Move non-key fields to @FDCPG5
     C                     Z-ADDWDFXA1    WEFXA1           Shift A Int Adj
     C                     Z-ADDWDFYA1    WEFYA1           Shift A Int Hot
     C                     Z-ADDWDFZA1    WEFZA1           Shift A Int Hd
     C                     Z-ADDWDG0A1    WEG0A1           Shift A Int Hd
     C                     Z-ADDWDGLA1    WEGLA1           Shift A Int Hd
     C                     Z-ADDWN0006    WEF0A1           Shift A Int Hot
     C                     Z-ADDWDGKA1    WEGKA1           Shift A Int Rat
     C                     Z-ADDWDF1A1    WEF1A1           Shift A Ext Adj
     C                     Z-ADDWDF2A1    WEF2A1           Shift A Ext Hot
     C                     Z-ADDWDF3A1    WEF3A1           Shift A Ext Hd
     C                     Z-ADDWDG2A1    WEG2A1           Shift A Ext Hd
     C                     Z-ADDWDGNA1    WEGNA1           Shift A Ext Hd
     C                     Z-ADDWN0013    WEF4A1           Shift A Ext Hot
     C                     Z-ADDWDGPA1    WEGPA1           Shift A Ext Rat
     C                     Z-ADDWN0015    WEF5A1           Shift A Tot Hot
     C                     Z-ADDWDGQA1    WEGQA1           Shift A Tot Rat
     C                     Z-ADDWDJSA1    WEJSA1           Shift A Kill to
     C                     Z-ADDWDF7A1    WEF7A1           Shift B Int Adj
     C                     Z-ADDWDF8A1    WEF8A1           Shift B Int Hot
     C                     Z-ADDWDF9A1    WEF9A1           Shift B Int Hd
     C                     Z-ADDWDG1A1    WEG1A1           Shift B Int Hd
     C                     Z-ADDWDGMA1    WEGMA1           Shift B Int Hd
     C                     Z-ADDWN0022    WEGAA1           Shift B Int Hot
     C                     Z-ADDWDGRA1    WEGRA1           Shift B Int Rat
     C                     Z-ADDWDGBA1    WEGBA1           Shift B Ext Adj
     C                     Z-ADDWDGCA1    WEGCA1           Shift B Ext Hot
     C                     Z-ADDWDGDA1    WEGDA1           Shift B Ext Hd
     C                     Z-ADDWDG3A1    WEG3A1           Shift B Ext Hd
     C                     Z-ADDWDGOA1    WEGOA1           Shift B Ext Hd
     C                     Z-ADDWN0029    WEGEA1           Shift B Ext Hot
     C                     Z-ADDWDGSA1    WEGSA1           Shift B Ext Rat
     C                     Z-ADDWN0031    WEGFA1           Shift B Tot Hot
     C                     Z-ADDWDGTA1    WEGTA1           Shift B Tot Rat
     C                     Z-ADDWDJTA1    WEJTA1           Shift B Kill to
     C                     Z-ADDWN0033    WEGHA1           Total Int Hot W
     C                     Z-ADDWDGUA1    WEGUA1           Total Int Rate
     C                     Z-ADDWN0035    WEGIA1           Total Ext Hot W
     C                     Z-ADDWDGWA1    WEGWA1           Total Ext Rate
     C                     Z-ADDWN0037    WEGJA1           Total Hot Wgt S
     C                     Z-ADDWDGVA1    WEGVA1           Total Rate Adj
     C                     Z-ADDWDJUA1    WEJUA1           Total Kill to C
     C                     Z-ADDP1EVDT    WEEVDT           Production Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WEAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEAADT    PARM *ZERO     WQ0139  70       *DATE
     C           WEAMTM    PARM *ZERO     WQ0140  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FDCPG5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0066 10        RS User Changed
     C                     Z-ADD*ZERO     WN0067  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0068  60       RS Time Changed
     C                     MOVEL*BLANK    WN0069  1        RS Record Statu
     C                     MOVEL*BLANK    WN0070 10        RS Job
     C                     MOVEL*BLANK    WN0071 10        RS Program
     C                     MOVEL*BLANK    WN0072 10        RS User Added
     C                     Z-ADD*ZERO     WN0073  70       RS Date Added
     C                     Z-ADD*ZERO     WN0074  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FDCPG5
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSI    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSI    CHAIN@FDCPG5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFDCPL0'MDACP
     C                     MOVEL'@FDCPG5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFD1    YDRDCS
      * Move non-key fields to @FDCPG5
     C                     Z-ADDWDFXA1    WEFXA1           Shift A Int Adj
     C                     Z-ADDWDFYA1    WEFYA1           Shift A Int Hot
     C                     Z-ADDWDFZA1    WEFZA1           Shift A Int Hd
     C                     Z-ADDWN0004    WEG0A1           Shift A Int Hd
     C                     Z-ADDWN0005    WEGLA1           Shift A Int Hd
     C                     Z-ADDWDF0A1    WEF0A1           Shift A Int Hot
     C                     Z-ADDWDGKA1    WEGKA1           Shift A Int Rat
     C                     Z-ADDWDF1A1    WEF1A1           Shift A Ext Adj
     C                     Z-ADDWDF2A1    WEF2A1           Shift A Ext Hot
     C                     Z-ADDWDF3A1    WEF3A1           Shift A Ext Hd
     C                     Z-ADDWN0011    WEG2A1           Shift A Ext Hd
     C                     Z-ADDWN0012    WEGNA1           Shift A Ext Hd
     C                     Z-ADDWDF4A1    WEF4A1           Shift A Ext Hot
     C                     Z-ADDWDGPA1    WEGPA1           Shift A Ext Rat
     C                     Z-ADDWDF5A1    WEF5A1           Shift A Tot Hot
     C                     Z-ADDWDGQA1    WEGQA1           Shift A Tot Rat
     C                     Z-ADDWDJSA1    WEJSA1           Shift A Kill to
     C                     Z-ADDWDF7A1    WEF7A1           Shift B Int Adj
     C                     Z-ADDWDF8A1    WEF8A1           Shift B Int Hot
     C                     Z-ADDWDF9A1    WEF9A1           Shift B Int Hd
     C                     Z-ADDWN0020    WEG1A1           Shift B Int Hd
     C                     Z-ADDWN0021    WEGMA1           Shift B Int Hd
     C                     Z-ADDWDGAA1    WEGAA1           Shift B Int Hot
     C                     Z-ADDWDGRA1    WEGRA1           Shift B Int Rat
     C                     Z-ADDWDGBA1    WEGBA1           Shift B Ext Adj
     C                     Z-ADDWDGCA1    WEGCA1           Shift B Ext Hot
     C                     Z-ADDWDGDA1    WEGDA1           Shift B Ext Hd
     C                     Z-ADDWN0027    WEG3A1           Shift B Ext Hd
     C                     Z-ADDWN0028    WEGOA1           Shift B Ext Hd
     C                     Z-ADDWDGEA1    WEGEA1           Shift B Ext Hot
     C                     Z-ADDWDGSA1    WEGSA1           Shift B Ext Rat
     C                     Z-ADDWDGFA1    WEGFA1           Shift B Tot Hot
     C                     Z-ADDWDGTA1    WEGTA1           Shift B Tot Rat
     C                     Z-ADDWDJTA1    WEJTA1           Shift B Kill to
     C                     Z-ADDWDGHA1    WEGHA1           Total Int Hot W
     C                     Z-ADDWDGUA1    WEGUA1           Total Int Rate
     C                     Z-ADDWDGIA1    WEGIA1           Total Ext Hot W
     C                     Z-ADDWDGWA1    WEGWA1           Total Ext Rate
     C                     Z-ADDWDGJA1    WEGJA1           Total Hot Wgt S
     C                     Z-ADDWDGVA1    WEGVA1           Total Rate Adj
     C                     Z-ADDWDJUA1    WEJUA1           Total Kill to C
     C                     Z-ADDP1EVDT    WEEVDT           Production Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WEAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEAADT    PARM *ZERO     WQ0141  70       *DATE
     C           WEAMTM    PARM *ZERO     WQ0142  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FDCPG5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Exp Rate HPE Sum  CH - Export Rate HPE Summary  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0075 10        RS User Changed
     C                     Z-ADD*ZERO     WN0076  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0077  60       RS Time Changed
     C                     MOVEL*BLANK    WN0078  1        RS Record Statu
     C                     MOVEL*BLANK    WN0079 10        RS Job
     C                     MOVEL*BLANK    WN0080 10        RS Program
     C                     MOVEL*BLANK    WN0081 10        RS User Added
     C                     Z-ADD*ZERO     WN0082  70       RS Date Added
     C                     Z-ADD*ZERO     WN0083  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FDCPG5
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSJ    CHAIN@FDCPG5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFDCPL0'MDACP
     C                     MOVEL'@FDCPG5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFD1    YERDCS
      * Move non-key fields to @FDCPG5
     C                     Z-ADDWDFXA1    WEFXA1           Shift A Int Adj
     C                     Z-ADDWDFYA1    WEFYA1           Shift A Int Hot
     C                     Z-ADDWDFZA1    WEFZA1           Shift A Int Hd
     C                     Z-ADDWDG0A1    WEG0A1           Shift A Int Hd
     C                     Z-ADDWDGLA1    WEGLA1           Shift A Int Hd
     C                     Z-ADDWDF0A1    WEF0A1           Shift A Int Hot
     C                     Z-ADDWN0007    WEGKA1           Shift A Int Rat
     C                     Z-ADDWDF1A1    WEF1A1           Shift A Ext Adj
     C                     Z-ADDWDF2A1    WEF2A1           Shift A Ext Hot
     C                     Z-ADDWDF3A1    WEF3A1           Shift A Ext Hd
     C                     Z-ADDWDG2A1    WEG2A1           Shift A Ext Hd
     C                     Z-ADDWDGNA1    WEGNA1           Shift A Ext Hd
     C                     Z-ADDWDF4A1    WEF4A1           Shift A Ext Hot
     C                     Z-ADDWN0014    WEGPA1           Shift A Ext Rat
     C                     Z-ADDWDF5A1    WEF5A1           Shift A Tot Hot
     C                     Z-ADDWN0016    WEGQA1           Shift A Tot Rat
     C                     Z-ADDWDJSA1    WEJSA1           Shift A Kill to
     C                     Z-ADDWDF7A1    WEF7A1           Shift B Int Adj
     C                     Z-ADDWDF8A1    WEF8A1           Shift B Int Hot
     C                     Z-ADDWDF9A1    WEF9A1           Shift B Int Hd
     C                     Z-ADDWDG1A1    WEG1A1           Shift B Int Hd
     C                     Z-ADDWDGMA1    WEGMA1           Shift B Int Hd
     C                     Z-ADDWDGAA1    WEGAA1           Shift B Int Hot
     C                     Z-ADDWN0023    WEGRA1           Shift B Int Rat
     C                     Z-ADDWDGBA1    WEGBA1           Shift B Ext Adj
     C                     Z-ADDWDGCA1    WEGCA1           Shift B Ext Hot
     C                     Z-ADDWDGDA1    WEGDA1           Shift B Ext Hd
     C                     Z-ADDWDG3A1    WEG3A1           Shift B Ext Hd
     C                     Z-ADDWDGOA1    WEGOA1           Shift B Ext Hd
     C                     Z-ADDWDGEA1    WEGEA1           Shift B Ext Hot
     C                     Z-ADDWN0030    WEGSA1           Shift B Ext Rat
     C                     Z-ADDWDGFA1    WEGFA1           Shift B Tot Hot
     C                     Z-ADDWN0032    WEGTA1           Shift B Tot Rat
     C                     Z-ADDWDJTA1    WEJTA1           Shift B Kill to
     C                     Z-ADDWDGHA1    WEGHA1           Total Int Hot W
     C                     Z-ADDWN0034    WEGUA1           Total Int Rate
     C                     Z-ADDWDGIA1    WEGIA1           Total Ext Hot W
     C                     Z-ADDWN0036    WEGWA1           Total Ext Rate
     C                     Z-ADDWDGJA1    WEGJA1           Total Hot Wgt S
     C                     Z-ADDWN0038    WEGVA1           Total Rate Adj
     C                     Z-ADDWDJUA1    WEJUA1           Total Kill to C
     C                     Z-ADDP1EVDT    WEEVDT           Production Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WEAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEAADT    PARM *ZERO     WQ0143  70       *DATE
     C           WEAMTM    PARM *ZERO     WQ0144  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFD1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FDCPG5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * COMPUTE LEAN % Morrison Hot Scale
      *================================================================
      * Calculate Lean % per Pork Rules
      * Backfat/loin are in inches
      * 2.827
      * + (0.469 * Carcass Weight)
      * - (0.7271657 * Backfat MM)
      * + (0.3867718 * Loin Eye MM)
      * -----------------------------
      * / Carcass Weight
      * * 100
     C           1         MULT 2.827     YL0005           Lean % Fld 1 Us
     C           1         MULT 0.469     YL0006           Lean % Fld 2 Us
     C                     Z-ADD0.7271657 YL0007           Lean % Fld 3 Us
     C                     Z-ADD0.3867718 YL0008           Lean % Fld 4 Us
      * CASE: DB1.EA Hot Weight NE WRK.Zero USR
     C           WBKJNB    IFNE WUE9NB                     *IF
      * LEAN % COMPUTE
      * LCL.Lean % Fld 5 Usr =
      *    *COMPUTE (((x1 + (x2 * x5) - (x3 * x6) + (x4 * x7)) / x5 * x8
      *    ))
      * x1    : LCL.Lean % Fld 1 Usr
      * +     : LCL.Lean @ Ext 4 Usr
      * x2    : LCL.Lean % Fld 2 Usr
      * *     : LCL.Lean @ Ext 1 Usr *
      * x5    : DB1.EA Hot Weight
      * -     : LCL.Lean @ Ext 4 Usr
      * x3    : LCL.Lean % Fld 3 Usr
      * *     : LCL.Lean @ Ext 2 Usr *
      * x6    : DB1.EA Backfat MM
      * +     : LCL.Lean @ Ext 4 Usr
      * x4    : LCL.Lean % Fld 4 Usr
      * *     : LCL.Lean @ Ext 3 Usr *
      * x7    : DB1.EA LoinEye MM
      * /     : LCL.Lean % Fld 5 Usr *
      * x5    : DB1.EA Hot Weight
      * *     : LCL.Lean @ Ext 5 Usr *
      * x8    : CON.100
     C           YL0006    MULT WBKJNB    YL0009           Lean @ Ext 1 Us
     C           YL0005    ADD  YL0009    YL0010           Lean @ Ext 4 Us
     C           YL0007    MULT WBX6NB    YL0011           Lean @ Ext 2 Us
     C                     SUB  YL0011    YL0010           Lean @ Ext 4 Us
     C           YL0008    MULT WBFQPC    YL0012           Lean @ Ext 3 Us
     C                     ADD  YL0012    YL0010           Lean @ Ext 4 Us
     C           YL0010    DIV  WBKJNB    YL0013           Lean % Fld 5 Us
     C           YL0013    MULT 100       YL0014           Lean @ Ext 5 Us
     C                     Z-ADDYL0014    YL0013           Lean % Fld 5 Us
     C                     END                             *FI
     C           YL0013    MULT 1         YL0015    H      ET Lean Percent
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1EVDT           Production Date
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WABSNB           Next Buy Order
     C                     Z-ADD*ZERO     WAB1DT           Current Kill Da
     C                     Z-ADD*ZERO     WAB2DT           Next Kill Date
     C                     Z-ADD*ZERO     WAH4NB           Last Drive Card
     C                     Z-ADD*ZERO     WAK3NB           Last Tattoo Nbr
     C                     Z-ADD*ZERO     WACDDT           Current Product
     C                     Z-ADD*ZERO     WACEDT           Next Production
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHKST           EA Company Numb
     C                     Z-ADD*ZERO     WBB7DT           EA Kill Date
     C                     Z-ADD*ZERO     WBKINB           EA Scale Sequen
     C                     Z-ADD*ZERO     WBKHNB           EA Tattoo Numbe
     C                     Z-ADD*ZERO     WBLNNB           EA Lot
     C                     Z-ADD*ZERO     WBKJNB           EA Hot Weight
     C                     Z-ADD*ZERO     WBKKNB           EA Backfat Thic
     C                     Z-ADD*ZERO     WBBQPC           EA Loin-Eye Dep
     C                     Z-ADD*ZERO     WBBRPC           EA Light Reflec
     C                     Z-ADD*ZERO     WBX6NB           EA Backfat MM
     C                     Z-ADD*ZERO     WBFQPC           EA LoinEye MM
     C                     Z-ADD*ZERO     WBFRPC           EA Light Refl M
     C                     Z-ADD*ZERO     WBB8DT           RU Date
     C                     Z-ADD*ZERO     WBAOTM           RU Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WCACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WCB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WCCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WCAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WCA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WCCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WCCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WCFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WCH9NB           TH Held Over
     C                     Z-ADD*ZERO     WCFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WCFENB           TH Head Killed
     C                     Z-ADD*ZERO     WCHENB           TH Head Adds
     C                     Z-ADD*ZERO     WCHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WCCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WCLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WCE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WCA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WCFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WCA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WCF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WCHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WCF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WCF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WCAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WCAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WCCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WCA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WCA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WCB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WCAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WCAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WCAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WCAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WCAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WCASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WCA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WCATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WCA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WCCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WCCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WCLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WCCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WCA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WCA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WCBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     Z-ADD*ZERO     WCBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WCHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WCHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCHINB           TH FFLI
     C                     Z-ADD*ZERO     WCA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WCA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WCA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WCJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WCD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WCD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WCD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WCD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WCEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WCEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WCECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WCEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WCEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WCEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WCOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WCTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WCT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WCTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WCT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WCOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WCKOER           TH Head Identif
     C                     Z-ADD*ZERO     WCOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WCOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WCIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WCOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WCHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WCS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WCTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WCTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WCJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WCKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WCKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WCKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WCKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WCOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WCIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WCIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WCIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WCKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WCKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WCORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WCOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WCMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WCNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WCNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WCIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WCEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCECDT           TH Head LFT
     C                     Z-ADD*ZERO     WCEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WCEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field TH Tattoo Number
     C                     Z-ADD*ZERO     WUCVNB  50
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUAKST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUAMST  4
      * Define work field TH Source Type
     C                     MOVEL*BLANK    WUKAST  1
      * Define work field TH Schedule Kill Shift
     C                     MOVEL*BLANK    WULIST  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field EA Shift
     C                     MOVEL*BLANK    WUHLST  1
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHONB           CC Company Numb
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDFXA1           Shift A Int Adj
     C                     Z-ADD*ZERO     WDFYA1           Shift A Int Hot
     C                     Z-ADD*ZERO     WDFZA1           Shift A Int Hd
     C                     Z-ADD*ZERO     WDG0A1           Shift A Int Hd
     C                     Z-ADD*ZERO     WDGLA1           Shift A Int Hd
     C                     Z-ADD*ZERO     WDF0A1           Shift A Int Hot
     C                     Z-ADD*ZERO     WDGKA1           Shift A Int Rat
     C                     Z-ADD*ZERO     WDF1A1           Shift A Ext Adj
     C                     Z-ADD*ZERO     WDF2A1           Shift A Ext Hot
     C                     Z-ADD*ZERO     WDF3A1           Shift A Ext Hd
     C                     Z-ADD*ZERO     WDG2A1           Shift A Ext Hd
     C                     Z-ADD*ZERO     WDGNA1           Shift A Ext Hd
     C                     Z-ADD*ZERO     WDF4A1           Shift A Ext Hot
     C                     Z-ADD*ZERO     WDGPA1           Shift A Ext Rat
     C                     Z-ADD*ZERO     WDF5A1           Shift A Tot Hot
     C                     Z-ADD*ZERO     WDGQA1           Shift A Tot Rat
     C                     Z-ADD*ZERO     WDJSA1           Shift A Kill to
     C                     Z-ADD*ZERO     WDF7A1           Shift B Int Adj
     C                     Z-ADD*ZERO     WDF8A1           Shift B Int Hot
     C                     Z-ADD*ZERO     WDF9A1           Shift B Int Hd
     C                     Z-ADD*ZERO     WDG1A1           Shift B Int Hd
     C                     Z-ADD*ZERO     WDGMA1           Shift B Int Hd
     C                     Z-ADD*ZERO     WDGAA1           Shift B Int Hot
     C                     Z-ADD*ZERO     WDGRA1           Shift B Int Rat
     C                     Z-ADD*ZERO     WDGBA1           Shift B Ext Adj
     C                     Z-ADD*ZERO     WDGCA1           Shift B Ext Hot
     C                     Z-ADD*ZERO     WDGDA1           Shift B Ext Hd
     C                     Z-ADD*ZERO     WDG3A1           Shift B Ext Hd
     C                     Z-ADD*ZERO     WDGOA1           Shift B Ext Hd
     C                     Z-ADD*ZERO     WDGEA1           Shift B Ext Hot
     C                     Z-ADD*ZERO     WDGSA1           Shift B Ext Rat
     C                     Z-ADD*ZERO     WDGFA1           Shift B Tot Hot
     C                     Z-ADD*ZERO     WDGTA1           Shift B Tot Rat
     C                     Z-ADD*ZERO     WDJTA1           Shift B Kill to
     C                     Z-ADD*ZERO     WDGHA1           Total Int Hot W
     C                     Z-ADD*ZERO     WDGUA1           Total Int Rate
     C                     Z-ADD*ZERO     WDGIA1           Total Ext Hot W
     C                     Z-ADD*ZERO     WDGWA1           Total Ext Rate
     C                     Z-ADD*ZERO     WDGJA1           Total Hot Wgt S
     C                     Z-ADD*ZERO     WDGVA1           Total Rate Adj
     C                     Z-ADD*ZERO     WDJUA1           Total Kill to C
     C                     Z-ADD*ZERO     WDEVDT           Production Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ05 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ04 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ03 150       *Synon (15,0) w
     C                     MOVEL'N'       W0PMT   1
      * Define local work field TH Kill Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Current Kill Date
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field EA Tattoo Number
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field TH Source Type
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Lean % Fld 1 Usr
     C                     Z-ADD*ZERO     YL0005 177
      * Define local work field Lean % Fld 2 Usr
     C                     Z-ADD*ZERO     YL0006 177
      * Define local work field Lean % Fld 3 Usr
     C                     Z-ADD*ZERO     YL0007 177
      * Define local work field Lean % Fld 4 Usr
     C                     Z-ADD*ZERO     YL0008 177
      * Define local work field Lean @ Ext 1 Usr
     C                     Z-ADD*ZERO     YL0009 177
      * Define local work field Lean @ Ext 4 Usr
     C                     Z-ADD*ZERO     YL0010 177
      * Define local work field Lean @ Ext 2 Usr
     C                     Z-ADD*ZERO     YL0011 177
      * Define local work field Lean @ Ext 3 Usr
     C                     Z-ADD*ZERO     YL0012 177
      * Define local work field Lean % Fld 5 Usr
     C                     Z-ADD*ZERO     YL0013 177
      * Define local work field Lean @ Ext 5 Usr
     C                     Z-ADD*ZERO     YL0014 177
      * Define local work field ET Lean Percent NPPC
     C                     Z-ADD*ZERO     YL0015  31
      * Define null work field Live Weight 11.2 Usr
     C                     Z-ADD*ZERO     YN0001 112
      * Define local work field Live wgt total 11.1   USR
     C                     Z-ADD*ZERO     YL0016 111
      * Define null work field Live Weight 5.0 USR
     C                     Z-ADD*ZERO     YN0002  50
      * Define local work field EA Shift
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Company Number Alpha Usr
     C                     MOVEL*BLANK    YL0018  3
      * Define local work field Date Alpha USR
     C                     MOVEL*BLANK    YL0019  7
      * Define local work field Tattoo Nbr Alpha Usr
     C                     MOVEL*BLANK    YL0020  5
      * Define local work field Date Alpha Usr 2
     C                     MOVEL*BLANK    YL0021  7
      * Define local work field Avg Hot Wgt 7.4 USR
     C                     Z-ADD*ZERO     YL0022  74
      *================================================================
     CSR         ZZEXIT    ENDSR
