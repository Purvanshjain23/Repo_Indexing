     H/TITLE EDT Order Header       E1 Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME) TGTRLS(*PRV)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 05/21/09  Time  : 08:23:42
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDSRE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Order Header       E1 Edit record(1 screen)
      *
     FOPBFCPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FCAEOREL2IF  E           K        DISK
      * RTV : Company Customer          Active Records         N
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBGWKLJIF  E           K        DISK
      * RSQ : Order Detail              Co/Ord/Seqs/not Canc/Cnf
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FCAEOREL5IF  E           K        DISK
      * RSQ : Company Customer          Customer
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPDJEREL4IF  E           K        DISK
      * RSQ : Sales Route               Salesprsn/Route;Active
      *
     FCAALREL1IF  E           K        DISK
      * RTV : Manager Level             Retrieval index       NV
      *
     FOPEXREL1IF  E           K        DISK
      * RTV : Order Types               Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FOPBFCPLMIF  E           K        DISK
      * RSQ : Order Header TRG          RSQ Co/Cust/PO
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country                   Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAACREL2IF  E           K        DISK
      * RTV : State                     Active only
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAAOREL2IF  E           K        DISK
      * RTV : Terms                     Retrieve Active Records
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier                   Active records
      *
     FOPCXREL2IF  E           K        DISK
      * RTV : OP Reason Codes           Active Records Only
      *
     FCADSREL1IF  E           K        DISK
      * RTV : Enterprise Master         Retrieval index       NV
      *
     FCAALREL3IF  E           K        DISK
      * RTV : Manager Level             Active Only
      *
     FPDIFREL2IF  E           K        DISK
      * RTV : VP Level                  Active Only
      *
     FPDJHREL1IF  E           K        DISK
      * RTV : Internal Reason           Retrieval index
      *
     FOPEZREL1IF  E           K        DISK
      * RTV : Event Types               Retrieval index       NV
      *
     FPDMKCPL1IF  E           K        DISK
      * RTV : A/R Claim                 Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : Application Profile       Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : Entry Control             Retrieval index       NV
      *
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPEYCPL0IF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   3 003  5 0A
     E                    W0END   3 003  5 0A
     E                    W0NAM   3 003 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 049  5 0A
     E                    W1END   7 049  5 0A
     E                    W1NAM   7 049 10
      * Long constants
     E                    @CN#    1   5  6   @CN    25
     I@BGWKKK
      * Order Detail              Co/Ord/Seqs/not Canc/Cnf
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WBAIC3
     I              EOBKC7                          WBBKC7
     I              EOAQCD                          WBAQCD
     I              EOR4CD                          WBR4CD
     I              EOBYNA                          WBBYNA
     I              EOB6NA                          WBB6NA
     I              EOBZNA                          WBBZNA
     I              EOLLST                          WBLLST
     I              EOPPST                          WBPPST
     I              EOR5NB                          WBR5NB
     I              EOR6NB                          WBR6NB
     I              EOQGST                          WBQGST
     I              EOBOCD                          WBBOCD
     I              EOTBNB                          WBTBNB
     I              EOMTCU                          WBMTCU
     I              EOW2NB                          WBW2NB
     I              EORPCD                          WBRPCD
     I              EOAJCD                          WBAJCD
     I              EOX9ST                          WBX9ST
     I              EOT9CD                          WBT9CD
     I              EOUBCD                          WBUBCD
     I              EOISTX                          WBISTX
     I              EOLQCD                          WBLQCD
     I              EONJNA                          WBNJNA
     I              EOI0TX                          WBI0TX
     I              EONKNA                          WBNKNA
     I              EOI1TX                          WBI1TX
     I              EOVLST                          WBVLST
     I              EORLST                          WBRLST
     I              EOMMTX                          WBMMTX
     I              EOOHNA                          WBOHNA
     I              EOQ6ST                          WBQ6ST
     I              EOQ8ST                          WBQ8ST
     I              EORBST                          WBRBST
     I              EOREST                          WBREST
     I              EOUVST                          WBUVST
     I              EOUWST                          WBUWST
     I              EOUXST                          WBUXST
     I              EOVSST                          WBVSST
     I              EOAATM                          WBAATM
     I              EOAYNA                          WBAYNA
     I              EOA0NA                          WBA0NA
     I              EOAXDT                          WBAXDT
      *
     I@EOREIQ
      * Company Customer          Customer
      * Renamed input format fields
     I              EOAIC3                          WCAIC3
     I              EOBKC7                          WCBKC7
     I              EOAQCD                          WCAQCD
     I              EOR4CD                          WCR4CD
     I              EOBYNA                          WCBYNA
     I              EOB6NA                          WCB6NA
     I              EOBZNA                          WCBZNA
     I              EOLLST                          WCLLST
     I              EOPPST                          WCPPST
     I              EOR5NB                          WCR5NB
     I              EOR6NB                          WCR6NB
     I              EOQGST                          WCQGST
     I              EOBOCD                          WCBOCD
     I              EOTBNB                          WCTBNB
     I              EOMTCU                          WCMTCU
     I              EOW2NB                          WCW2NB
     I              EORPCD                          WCRPCD
     I              EOAJCD                          WCAJCD
     I              EOX9ST                          WCX9ST
     I              EOT9CD                          WCT9CD
     I              EOUBCD                          WCUBCD
     I              EOISTX                          WCISTX
     I              EOLQCD                          WCLQCD
     I              EONJNA                          WCNJNA
     I              EOI0TX                          WCI0TX
     I              EONKNA                          WCNKNA
     I              EOI1TX                          WCI1TX
     I              EOVLST                          WCVLST
     I              EORLST                          WCRLST
     I              EOMMTX                          WCMMTX
     I              EOOHNA                          WCOHNA
     I              EOQ6ST                          WCQ6ST
     I              EOQ8ST                          WCQ8ST
     I              EORBST                          WCRBST
     I              EOREST                          WCREST
     I              EOUVST                          WCUVST
     I              EOUWST                          WCUWST
     I              EOUXST                          WCUXST
     I              EOVSST                          WCVSST
     I              EOAATM                          WCAATM
     I              EOAYNA                          WCAYNA
     I              EOA0NA                          WCA0NA
     I              EOAXDT                          WCAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WDBKC7
     I              BBAYTX                          WDAYTX
     I              BBACNA                          WDACNA
     I              BBADNA                          WDADNA
     I              BBAENA                          WDAENA
     I              BBAJNA                          WDAJNA
     I              BBBGCD                          WDBGCD
     I              BBG5CD                          WDG5CD
     I              BBBTTX                          WDBTTX
     I              BBBVTX                          WDBVTX
     I              BBBWTX                          WDBWTX
     I              BBABTX                          WDABTX
     I              BBA2NA                          WDA2NA
     I              BBCBST                          WDCBST
     I              BBB0NA                          WDB0NA
     I              BBP3NB                          WDP3NB
     I              BBAXNA                          WDAXNA
     I              BBI6DT                          WDI6DT
     I              BBAYDT                          WDAYDT
     I              BBANC7                          WDANC7
     I              BBBTC7                          WDBTC7
     I              BBK6ST                          WDK6ST
     I              BBUZST                          WDUZST
     I              BBKXCD                          WDKXCD
     I              BBLTCD                          WDLTCD
     I              BBQNST                          WDQNST
     I              BBS2NB                          WDS2NB
     I              BBVHVA                          WDVHVA
     I              BBI7DT                          WDI7DT
     I              BBRJST                          WDRJST
     I              BBRKST                          WDRKST
     I              BBQWST                          WDQWST
     I              BBQXST                          WDQXST
     I              BBQYST                          WDQYST
     I              BBUNCS                          WDUNCS
     I              BBUVST                          WDUVST
     I              BBUWST                          WDUWST
     I              BBUXST                          WDUXST
     I              BBVSST                          WDVSST
     I              BBAATM                          WDAATM
     I              BBAYNA                          WDAYNA
     I              BBA0NA                          WDA0NA
     I              BBAXDT                          WDAXDT
      *
     I@ABREUA
      * Company Name and Address  Active records
      * Renamed input format fields
     I              ABAIC3                          WEAIC3
     I              ABADTX                          WEADTX
     I              ABACNA                          WEACNA
     I              ABADNA                          WEADNA
     I              ABAENA                          WEAENA
     I              ABAJNA                          WEAJNA
     I              ABBTTX                          WEBTTX
     I              ABBVTX                          WEBVTX
     I              ABBWTX                          WEBWTX
     I              ABA2NA                          WEA2NA
     I              ABABTX                          WEABTX
     I              ABBGCD                          WEBGCD
     I              ABKXCD                          WEKXCD
     I              ABUVST                          WEUVST
     I              ABUWST                          WEUWST
     I              ABUXST                          WEUXST
     I              ABVSST                          WEVSST
     I              ABAATM                          WEAATM
     I              ABAYNA                          WEAYNA
     I              ABA0NA                          WEA0NA
     I              ABAXDT                          WEAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WGRMNB
     I              FJAIC3                          WGAIC3
     I              FJAODT                          WGAODT
     I              FJPJST                          WGPJST
     I              FJPKST                          WGPKST
     I              FJRNNB                          WGRNNB
     I              FJDMTX                          WGDMTX
     I              FJDNTX                          WGDNTX
     I              FJDOTX                          WGDOTX
     I              FJWTTX                          WGWTTX
     I              FJWUTX                          WGWUTX
     I              FJRPNB                          WGRPNB
     I              FJFLAM                          WGFLAM
     I              FJXQST                          WGXQST
     I              FJRRNB                          WGRRNB
     I              FJDXTX                          WGDXTX
     I              FJDYTX                          WGDYTX
     I              FJSBNB                          WGSBNB
     I              FJBZNA                          WGBZNA
     I              FJRONB                          WGRONB
     I              FJSQNB                          WGSQNB
     I              FJR1NB                          WGR1NB
     I              FJVCST                          WGVCST
     I              FJVDST                          WGVDST
     I              FJSDNB                          WGSDNB
     I              FJPAOU                          WGPAOU
     I              FJDGWG                          WGDGWG
     I              FJSXNB                          WGSXNB
     I              FJHADT                          WGHADT
     I              FJAART                          WGAART
     I              FJDHWG                          WGDHWG
     I              FJDIWG                          WGDIWG
     I              FJAQDT                          WGAQDT
     I              FJS6NB                          WGS6NB
     I              FJT4NB                          WGT4NB
     I              FJPRTM                          WGPRTM
     I              FJNPSV                          WGNPSV
     I              FJJ8TX                          WGJ8TX
     I              FJTLMI                          WGTLMI
     I              FJJ9TX                          WGJ9TX
     I              FJQ2CD                          WGQ2CD
     I              FJVPCD                          WGVPCD
     I              FJDBCD                          WGDBCD
     I              FJGRWE                          WGGRWE
     I              FJXCCD                          WGXCCD
     I              FJU2ST                          WGU2ST
     I              FJF9DT                          WGF9DT
     I              FJONTM                          WGONTM
     I              FJJ4DT                          WGJ4DT
     I              FJTRTM                          WGTRTM
     I              FJJ5DT                          WGJ5DT
     I              FJSPTM                          WGSPTM
     I              FJJ6DT                          WGJ6DT
     I              FJLFTM                          WGLFTM
     I              FJJ7DT                          WGJ7DT
     I              FJBOTM                          WGBOTM
     I              FJJ8DT                          WGJ8DT
     I              FJBLTM                          WGBLTM
     I              FJKIDT                          WGKIDT
     I              FJASTM                          WGASTM
     I              FJKADT                          WGKADT
     I              FJAJCM                          WGAJCM
     I              FJXACD                          WGXACD
     I              FJOANA                          WGOANA
     I              FJK4TX                          WGK4TX
     I              FJVOAG                          WGVOAG
     I              FJKBDT                          WGKBDT
     I              FJNBBO                          WGNBBO
     I              FJW4CD                          WGW4CD
     I              FJEFDT                          WGEFDT
     I              FJCNTN                          WGCNTN
     I              FJKCDT                          WGKCDT
     I              FJTMIN                          WGTMIN
     I              FJKDDT                          WGKDDT
     I              FJVMNB                          WGVMNB
     I              FJOCFR                          WGOCFR
     I              FJKJDT                          WGKJDT
     I              FJATTM                          WGATTM
     I              FJOTRS                          WGOTRS
     I              FJRNST                          WGRNST
     I              FJBRBK                          WGBRBK
     I              FJEIDT                          WGEIDT
     I              FJRMST                          WGRMST
     I              FJAJCD                          WGAJCD
     I              FJKKDT                          WGKKDT
     I              FJAVTM                          WGAVTM
     I              FJKZDT                          WGKZDT
     I              FJAXTM                          WGAXTM
     I              FJLHOS                          WGLHOS
     I              FJLHOR                          WGLHOR
     I              FJWNTX                          WGWNTX
     I              FJOITX                          WGOITX
     I              FJOJTX                          WGOJTX
     I              FJLLDT                          WGLLDT
     I              FJLSHG                          WGLSHG
     I              FJYPST                          WGYPST
     I              FJK0DT                          WGK0DT
     I              FJAYTM                          WGAYTM
     I              FJKNNX                          WGKNNX
     I              FJICWG                          WGICWG
     I              FJIDWG                          WGIDWG
     I              FJH9SX                          WGH9SX
     I              FJWOTX                          WGWOTX
     I              FJK1DT                          WGK1DT
     I              FJAZTM                          WGAZTM
     I              FJK2DT                          WGK2DT
     I              FJA0TM                          WGA0TM
     I              FJROST                          WGROST
     I              FJRPST                          WGRPST
     I              FJRQST                          WGRQST
     I              FJRRST                          WGRRST
     I              FJZBVA                          WGZBVA
     I              FJWPTX                          WGWPTX
     I              FJWQTX                          WGWQTX
     I              FJWRTX                          WGWRTX
     I              FJWSTX                          WGWSTX
     I              FJRVSX                          WGRVSX
     I              FJRUSX                          WGRUSX
     I              FJRWSX                          WGRWSX
     I              FJRXSX                          WGRXSX
     I              FJRYSX                          WGRYSX
     I              FJRZSX                          WGRZSX
     I              FJR0SX                          WGR0SX
     I              FJR1SX                          WGR1SX
     I              FJR2SX                          WGR2SX
     I              FJR3SX                          WGR3SX
     I              FJR4SX                          WGR4SX
     I              FJPYDT                          WGPYDT
     I              FJCKTM                          WGCKTM
     I              FJPZDT                          WGPZDT
     I              FJCLTM                          WGCLTM
     I              FJP0DT                          WGP0DT
     I              FJCMTM                          WGCMTM
     I              FJP1DT                          WGP1DT
     I              FJCNTM                          WGCNTM
     I              FJP2DT                          WGP2DT
     I              FJCOTM                          WGCOTM
     I              FJP3DT                          WGP3DT
     I              FJCQTM                          WGCQTM
     I              FJUVST                          WGUVST
     I              FJUWST                          WGUWST
     I              FJUXST                          WGUXST
     I              FJAATM                          WGAATM
     I              FJAYNA                          WGAYNA
     I              FJA0NA                          WGA0NA
     I              FJAXDT                          WGAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WHRMNB
     I              FLRUNB                          WHRUNB
     I              FLRVNB                          WHRVNB
     I              FLDQTX                          WHDQTX
     I              FLRWNB                          WHRWNB
     I              FLRXNB                          WHRXNB
     I              FLSQNB                          WHSQNB
     I              FLT0NB                          WHT0NB
     I              FLT1NB                          WHT1NB
     I              FLR1NB                          WHR1NB
     I              FLAIC3                          WHAIC3
     I              FLC4NB                          WHC4NB
     I              FLVCST                          WHVCST
     I              FLKEDT                          WHKEDT
     I              FLSXNB                          WHSXNB
     I              FLKFDT                          WHKFDT
     I              FLACTM                          WHACTM
     I              FLK5TX                          WHK5TX
     I              FLW5CD                          WHW5CD
     I              FLEJDT                          WHEJDT
     I              FLAGTM                          WHAGTM
     I              FLKJDT                          WHKJDT
     I              FLATTM                          WHATTM
     I              FLHDDT                          WHHDDT
     I              FLAUTM                          WHAUTM
     I              FLKKDT                          WHKKDT
     I              FLAVTM                          WHAVTM
     I              FLZ4NB                          WHZ4NB
     I              FLY7ST                          WHY7ST
     I              FLY2ST                          WHY2ST
     I              FLWHTX                          WHWHTX
     I              FLWITX                          WHWITX
     I              FLWJTX                          WHWJTX
     I              FLWKTX                          WHWKTX
     I              FLWLTX                          WHWLTX
     I              FLN7DT                          WHN7DT
     I              FLN8DT                          WHN8DT
     I              FLN9DT                          WHN9DT
     I              FLB3TM                          WHB3TM
     I              FLB4TM                          WHB4TM
     I              FLB5TM                          WHB5TM
     I              FLIASX                          WHIASX
     I              FLIBSX                          WHIBSX
     I              FLICSX                          WHICSX
     I              FLWVTX                          WHWVTX
     I              FLWWTX                          WHWWTX
     I              FLWXTX                          WHWXTX
     I              FLUVST                          WHUVST
     I              FLUWST                          WHUWST
     I              FLUXST                          WHUXST
     I              FLAATM                          WHAATM
     I              FLAYNA                          WHAYNA
     I              FLA0NA                          WHA0NA
     I              FLAXDT                          WHAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WIRMNB
     I              FLRUNB                          WIRUNB
     I              FLRVNB                          WIRVNB
     I              FLDQTX                          WIDQTX
     I              FLRWNB                          WIRWNB
     I              FLRXNB                          WIRXNB
     I              FLSQNB                          WISQNB
     I              FLT0NB                          WIT0NB
     I              FLT1NB                          WIT1NB
     I              FLR1NB                          WIR1NB
     I              FLAIC3                          WIAIC3
     I              FLC4NB                          WIC4NB
     I              FLVCST                          WIVCST
     I              FLKEDT                          WIKEDT
     I              FLSXNB                          WISXNB
     I              FLKFDT                          WIKFDT
     I              FLACTM                          WIACTM
     I              FLK5TX                          WIK5TX
     I              FLW5CD                          WIW5CD
     I              FLEJDT                          WIEJDT
     I              FLAGTM                          WIAGTM
     I              FLKJDT                          WIKJDT
     I              FLATTM                          WIATTM
     I              FLHDDT                          WIHDDT
     I              FLAUTM                          WIAUTM
     I              FLKKDT                          WIKKDT
     I              FLAVTM                          WIAVTM
     I              FLZ4NB                          WIZ4NB
     I              FLY7ST                          WIY7ST
     I              FLY2ST                          WIY2ST
     I              FLWHTX                          WIWHTX
     I              FLWITX                          WIWITX
     I              FLWJTX                          WIWJTX
     I              FLWKTX                          WIWKTX
     I              FLWLTX                          WIWLTX
     I              FLN7DT                          WIN7DT
     I              FLN8DT                          WIN8DT
     I              FLN9DT                          WIN9DT
     I              FLB3TM                          WIB3TM
     I              FLB4TM                          WIB4TM
     I              FLB5TM                          WIB5TM
     I              FLIASX                          WIIASX
     I              FLIBSX                          WIIBSX
     I              FLICSX                          WIICSX
     I              FLWVTX                          WIWVTX
     I              FLWWTX                          WIWWTX
     I              FLWXTX                          WIWXTX
     I              FLUVST                          WIUVST
     I              FLUWST                          WIUWST
     I              FLUXST                          WIUXST
     I              FLAATM                          WIAATM
     I              FLAYNA                          WIAYNA
     I              FLA0NA                          WIA0NA
     I              FLAXDT                          WIAXDT
      *
     I@JEREZ3
      * Sales Route               Salesprsn/Route;Active
      * Renamed input format fields
     I              JER4CD                          WJR4CD
     I              JEMZNA                          WJMZNA
     I              JEBCCD                          WJBCCD
     I              JEBFCD                          WJBFCD
     I              JEQ4CD                          WJQ4CD
     I              JEWOST                          WJWOST
     I              JER8CD                          WJR8CD
     I              JEUVST                          WJUVST
     I              JEUWST                          WJUWST
     I              JEUXST                          WJUXST
     I              JEVSST                          WJVSST
     I              JEAATM                          WJAATM
     I              JEAYNA                          WJAYNA
     I              JEA0NA                          WJA0NA
     I              JEAXDT                          WJAXDT
      *
     I@EXREYP
      * Order Types               Retrieval index
      * Renamed input format fields
     I              EXJNCD                          WKJNCD
     I              EXJVNA                          WKJVNA
     I              EXOAST                          WKOAST
     I              EXOBST                          WKOBST
     I              EXOEST                          WKOEST
     I              EXOFST                          WKOFST
     I              EXVBST                          WKVBST
     I              EXPYST                          WKPYST
     I              EXX8ST                          WKX8ST
     I              EXISTX                          WKISTX
     I              EXUVST                          WKUVST
     I              EXUWST                          WKUWST
     I              EXUXST                          WKUXST
     I              EXVSST                          WKVSST
     I              EXAATM                          WKAATM
     I              EXAYNA                          WKAYNA
     I              EXA0NA                          WKA0NA
     I              EXAXDT                          WKAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WLAJCD
     I              ADF8NA                          WLF8NA
     I              ADACNA                          WLACNA
     I              ADADNA                          WLADNA
     I              ADAENA                          WLAENA
     I              ADAJNA                          WLAJNA
     I              ADBTTX                          WLBTTX
     I              ADAOCD                          WLAOCD
     I              ADBGCD                          WLBGCD
     I              ADVHST                          WLVHST
     I              ADMPNA                          WLMPNA
     I              ADWPST                          WLWPST
     I              ADXUST                          WLXUST
     I              ADT0ST                          WLT0ST
     I              ADT1ST                          WLT1ST
     I              ADDBNB                          WLDBNB
     I              ADT2ST                          WLT2ST
     I              ADT3ST                          WLT3ST
     I              ADT4ST                          WLT4ST
     I              ADT6ST                          WLT6ST
     I              ADBWC3                          WLBWC3
     I              ADBTC3                          WLBTC3
     I              ADBUC3                          WLBUC3
     I              ADBVC3                          WLBVC3
     I              ADFCAA                          WLFCAA
     I              ADRQSX                          WLRQSX
     I              ADRRSX                          WLRRSX
     I              ADRSSX                          WLRSSX
     I              ADRTSX                          WLRTSX
     I              ADT7ST                          WLT7ST
     I              ADT8ST                          WLT8ST
     I              ADRNSX                          WLRNSX
     I              ADROSX                          WLROSX
     I              ADRPSX                          WLRPSX
     I              ADUVST                          WLUVST
     I              ADUWST                          WLUWST
     I              ADUXST                          WLUXST
     I              ADVSST                          WLVSST
     I              ADAATM                          WLAATM
     I              ADAYNA                          WLAYNA
     I              ADA0NA                          WLA0NA
     I              ADAXDT                          WLAXDT
      *
     I@BFCPXD
      * Order Header TRG          RSQ Co/Cust/PO
      * Renamed input format fields
     I              BEAIC3                          WMAIC3
     I              BEC4NB                          WMC4NB
     I              BEJNCD                          WMJNCD
     I              BEANC7                          WMANC7
     I              BEBKC7                          WMBKC7
     I              BEBRTX                          WMBRTX
     I              BEHMNA                          WMHMNA
     I              BEHONA                          WMHONA
     I              BEHPNA                          WMHPNA
     I              BEHNNA                          WMHNNA
     I              BEDBCD                          WMDBCD
     I              BECKTX                          WMCKTX
     I              BEB0C7                          WMB0C7
     I              BEAETX                          WMAETX
     I              BEB1NA                          WMB1NA
     I              BEB3NA                          WMB3NA
     I              BEB4NA                          WMB4NA
     I              BEB2NA                          WMB2NA
     I              BEBHCD                          WMBHCD
     I              BEC8TX                          WMC8TX
     I              BEBCNA                          WMBCNA
     I              BEA0DT                          WMA0DT
     I              BEA5DT                          WMA5DT
     I              BEGNDT                          WMGNDT
     I              BEACDT                          WMACDT
     I              BEAQCD                          WMAQCD
     I              BEB6NA                          WMB6NA
     I              BEBYNA                          WMBYNA
     I              BEBZNA                          WMBZNA
     I              BEGTST                          WMGTST
     I              BEGVST                          WMGVST
     I              BEGUST                          WMGUST
     I              BEQFST                          WMQFST
     I              BECQCD                          WMCQCD
     I              BEGJST                          WMGJST
     I              BEGWST                          WMGWST
     I              BEGXST                          WMGXST
     I              BEGYST                          WMGYST
     I              BEAODT                          WMAODT
     I              BEAIVN                          WMAIVN
     I              BECXDT                          WMCXDT
     I              BEJZVA                          WMJZVA
     I              BEA1WG                          WMA1WG
     I              BEXIST                          WMXIST
     I              BEXJST                          WMXJST
     I              BEXKST                          WMXKST
     I              BEEIDT                          WMEIDT
     I              BEAFTM                          WMAFTM
     I              BEE8CD                          WME8CD
     I              BEE9CD                          WME9CD
     I              BERMNB                          WMRMNB
     I              BETBNB                          WMTBNB
     I              BER1NB                          WMR1NB
     I              BEPJST                          WMPJST
     I              BEU0ST                          WMU0ST
     I              BEU1ST                          WMU1ST
     I              BEQ2CD                          WMQ2CD
     I              BEU2ST                          WMU2ST
     I              BEVEST                          WMVEST
     I              BEVFST                          WMVFST
     I              BEVGST                          WMVGST
     I              BERPCD                          WMRPCD
     I              BERNNB                          WMRNNB
     I              BEVDST                          WMVDST
     I              BEATIN                          WMATIN
     I              BEU4ST                          WMU4ST
     I              BEU5ST                          WMU5ST
     I              BERSRN                          WMRSRN
     I              BEMHNA                          WMMHNA
     I              BEMINA                          WMMINA
     I              BEWBST                          WMWBST
     I              BER4CD                          WMR4CD
     I              BEBFCD                          WMBFCD
     I              BEQ4CD                          WMQ4CD
     I              BET3NB                          WMT3NB
     I              BESICD                          WMSICD
     I              BECONB                          WMCONB
     I              BECEST                          WMCEST
     I              BEAWDT                          WMAWDT
     I              BEJPCD                          WMJPCD
     I              BEXUST                          WMXUST
     I              BEZ1ST                          WMZ1ST
     I              BEVRVA                          WMVRVA
     I              BEOBST                          WMOBST
     I              BEBCST                          WMBCST
     I              BEBDST                          WMBDST
     I              BEB7VL                          WMB7VL
     I              BEGASX                          WMGASX
     I              BEGBSX                          WMGBSX
     I              BEGCSX                          WMGCSX
     I              BEGDSX                          WMGDSX
     I              BEFNSX                          WMFNSX
     I              BEFOSX                          WMFOSX
     I              BEFPSX                          WMFPSX
     I              BEFQSX                          WMFQSX
     I              BEFRSX                          WMFRSX
     I              BEFSSX                          WMFSSX
     I              BEFTSX                          WMFTSX
     I              BEFUSX                          WMFUSX
     I              BEFVSX                          WMFVSX
     I              BEFWSX                          WMFWSX
     I              BEFXSX                          WMFXSX
     I              BEFYSX                          WMFYSX
     I              BENODT                          WMNODT
     I              BENPDT                          WMNPDT
     I              BENQDT                          WMNQDT
     I              BENRDT                          WMNRDT
     I              BENSDT                          WMNSDT
     I              BEBPTM                          WMBPTM
     I              BEBQTM                          WMBQTM
     I              BEBRTM                          WMBRTM
     I              BEBSTM                          WMBSTM
     I              BEBTTM                          WMBTTM
     I              BEH0NX                          WMH0NX
     I              BEH1NX                          WMH1NX
     I              BEH2NX                          WMH2NX
     I              BEH3NX                          WMH3NX
     I              BEH4NX                          WMH4NX
     I              BEC0C7                          WMC0C7
     I              BEUVST                          WMUVST
     I              BEUWST                          WMUWST
     I              BEUXST                          WMUXST
     I              BEAATM                          WMAATM
     I              BEAYNA                          WMAYNA
     I              BEA0NA                          WMA0NA
     I              BEAXDT                          WMAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WOAIC3
     I              OMC4NB                          WOC4NB
     I              OMDPNB                          WODPNB
     I              OMUENB                          WOUENB
     I              OMHGCD                          WOHGCD
     I              OMAJCD                          WOAJCD
     I              OMBKC7                          WOBKC7
     I              OMCFC7                          WOCFC7
     I              OMGMST                          WOGMST
     I              OMGNST                          WOGNST
     I              OMMAVA                          WOMAVA
     I              OMKDVA                          WOKDVA
     I              OML8VA                          WOL8VA
     I              OML9VA                          WOL9VA
     I              OMGTST                          WOGTST
     I              OMGVST                          WOGVST
     I              OMGUST                          WOGUST
     I              OMQFST                          WOQFST
     I              OMAYVA                          WOAYVA
     I              OMEXDT                          WOEXDT
     I              OMLQCD                          WOLQCD
     I              OMRDCD                          WORDCD
     I              OMQ7CD                          WOQ7CD
     I              OMBZPR                          WOBZPR
     I              OML6NB                          WOL6NB
     I              OMU1ST                          WOU1ST
     I              OMGIDT                          WOGIDT
     I              OMCRCD                          WOCRCD
     I              OMAGCD                          WOAGCD
     I              OMRZST                          WORZST
     I              OMR0ST                          WOR0ST
     I              OMR1ST                          WOR1ST
     I              OMG7NA                          WOG7NA
     I              OMG8NA                          WOG8NA
     I              OMRPCD                          WORPCD
     I              OMVEST                          WOVEST
     I              OMVGST                          WOVGST
     I              OMAVST                          WOAVST
     I              OMU0ST                          WOU0ST
     I              OMRFCD                          WORFCD
     I              OMFZST                          WOFZST
     I              OMR1NB                          WOR1NB
     I              OMAVQT                          WOAVQT
     I              OMD0WG                          WOD0WG
     I              OMCCQT                          WOCCQT
     I              OMAUWG                          WOAUWG
     I              OMCBQT                          WOCBQT
     I              OMATWG                          WOATWG
     I              OMAQCS                          WOAQCS
     I              OMAGCS                          WOAGCS
     I              OMAKPR                          WOAKPR
     I              OMALPR                          WOALPR
     I              OMAUPR                          WOAUPR
     I              OMAVWG                          WOAVWG
     I              OMA4WG                          WOA4WG
     I              OMA5DT                          WOA5DT
     I              OMAODT                          WOAODT
     I              OMGNDT                          WOGNDT
     I              OMAMST                          WOAMST
     I              OMANST                          WOANST
     I              OMVAST                          WOVAST
     I              OMRGNB                          WORGNB
     I              OMRHNB                          WORHNB
     I              OMRINB                          WORINB
     I              OMRBCD                          WORBCD
     I              OMHICD                          WOHICD
     I              OMRNCD                          WORNCD
     I              OMROCD                          WOROCD
     I              OMCXDT                          WOCXDT
     I              OMAJVN                          WOAJVN
     I              OMKXCD                          WOKXCD
     I              OMJPCD                          WOJPCD
     I              OMCQCD                          WOCQCD
     I              OMR4CD                          WOR4CD
     I              OMZ1ST                          WOZ1ST
     I              OMZ3ST                          WOZ3ST
     I              OMZ4ST                          WOZ4ST
     I              OMDUPR                          WODUPR
     I              OMB6VL                          WOB6VL
     I              OMA1AA                          WOA1AA
     I              OMFZSX                          WOFZSX
     I              OMF0SX                          WOF0SX
     I              OMF1SX                          WOF1SX
     I              OMF2SX                          WOF2SX
     I              OMF3SX                          WOF3SX
     I              OMF4SX                          WOF4SX
     I              OMF5SX                          WOF5SX
     I              OMF6SX                          WOF6SX
     I              OMF7SX                          WOF7SX
     I              OMNTDT                          WONTDT
     I              OMNUDT                          WONUDT
     I              OMNVDT                          WONVDT
     I              OMNWDT                          WONWDT
     I              OMNXDT                          WONXDT
     I              OMBUTM                          WOBUTM
     I              OMBVTM                          WOBVTM
     I              OMBWTM                          WOBWTM
     I              OMBXTM                          WOBXTM
     I              OMBYTM                          WOBYTM
     I              OMH5NX                          WOH5NX
     I              OMH6NX                          WOH6NX
     I              OMH7NX                          WOH7NX
     I              OMH8NX                          WOH8NX
     I              OMH9NX                          WOH9NX
     I              OMDVPR                          WODVPR
     I              OMDWPR                          WODWPR
     I              OMDXPR                          WODXPR
     I              OMDYPR                          WODYPR
     I              OMDZPR                          WODZPR
     I              OMUVST                          WOUVST
     I              OMUWST                          WOUWST
     I              OMUXST                          WOUXST
     I              OMAATM                          WOAATM
     I              OMAYNA                          WOAYNA
     I              OMA0NA                          WOA0NA
     I              OMAXDT                          WOAXDT
      *
     I@ALREVE
      * Manager Level             Active Only
      * Renamed input format fields
     I              ALBFCD                          WRBFCD
     I              ALAUNA                          WRAUNA
     I              ALQ4CD                          WRQ4CD
     I              ALUVST                          WRUVST
     I              ALUWST                          WRUWST
     I              ALUXST                          WRUXST
     I              ALVSST                          WRVSST
     I              ALAATM                          WRAATM
     I              ALAYNA                          WRAYNA
     I              ALA0NA                          WRA0NA
     I              ALAXDT                          WRAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WSAIC3
     I              OMC4NB                          WSC4NB
     I              OMDPNB                          WSDPNB
     I              OMUENB                          WSUENB
     I              OMHGCD                          WSHGCD
     I              OMAJCD                          WSAJCD
     I              OMBKC7                          WSBKC7
     I              OMCFC7                          WSCFC7
     I              OMGMST                          WSGMST
     I              OMGNST                          WSGNST
     I              OMMAVA                          WSMAVA
     I              OMKDVA                          WSKDVA
     I              OML8VA                          WSL8VA
     I              OML9VA                          WSL9VA
     I              OMGTST                          WSGTST
     I              OMGVST                          WSGVST
     I              OMGUST                          WSGUST
     I              OMQFST                          WSQFST
     I              OMAYVA                          WSAYVA
     I              OMEXDT                          WSEXDT
     I              OMLQCD                          WSLQCD
     I              OMRDCD                          WSRDCD
     I              OMQ7CD                          WSQ7CD
     I              OMBZPR                          WSBZPR
     I              OML6NB                          WSL6NB
     I              OMU1ST                          WSU1ST
     I              OMGIDT                          WSGIDT
     I              OMCRCD                          WSCRCD
     I              OMAGCD                          WSAGCD
     I              OMRZST                          WSRZST
     I              OMR0ST                          WSR0ST
     I              OMR1ST                          WSR1ST
     I              OMG7NA                          WSG7NA
     I              OMG8NA                          WSG8NA
     I              OMRPCD                          WSRPCD
     I              OMVEST                          WSVEST
     I              OMVGST                          WSVGST
     I              OMAVST                          WSAVST
     I              OMU0ST                          WSU0ST
     I              OMRFCD                          WSRFCD
     I              OMFZST                          WSFZST
     I              OMR1NB                          WSR1NB
     I              OMAVQT                          WSAVQT
     I              OMD0WG                          WSD0WG
     I              OMCCQT                          WSCCQT
     I              OMAUWG                          WSAUWG
     I              OMCBQT                          WSCBQT
     I              OMATWG                          WSATWG
     I              OMAQCS                          WSAQCS
     I              OMAGCS                          WSAGCS
     I              OMAKPR                          WSAKPR
     I              OMALPR                          WSALPR
     I              OMAUPR                          WSAUPR
     I              OMAVWG                          WSAVWG
     I              OMA4WG                          WSA4WG
     I              OMA5DT                          WSA5DT
     I              OMAODT                          WSAODT
     I              OMGNDT                          WSGNDT
     I              OMAMST                          WSAMST
     I              OMANST                          WSANST
     I              OMVAST                          WSVAST
     I              OMRGNB                          WSRGNB
     I              OMRHNB                          WSRHNB
     I              OMRINB                          WSRINB
     I              OMRBCD                          WSRBCD
     I              OMHICD                          WSHICD
     I              OMRNCD                          WSRNCD
     I              OMROCD                          WSROCD
     I              OMCXDT                          WSCXDT
     I              OMAJVN                          WSAJVN
     I              OMKXCD                          WSKXCD
     I              OMJPCD                          WSJPCD
     I              OMCQCD                          WSCQCD
     I              OMR4CD                          WSR4CD
     I              OMZ1ST                          WSZ1ST
     I              OMZ3ST                          WSZ3ST
     I              OMZ4ST                          WSZ4ST
     I              OMDUPR                          WSDUPR
     I              OMB6VL                          WSB6VL
     I              OMA1AA                          WSA1AA
     I              OMFZSX                          WSFZSX
     I              OMF0SX                          WSF0SX
     I              OMF1SX                          WSF1SX
     I              OMF2SX                          WSF2SX
     I              OMF3SX                          WSF3SX
     I              OMF4SX                          WSF4SX
     I              OMF5SX                          WSF5SX
     I              OMF6SX                          WSF6SX
     I              OMF7SX                          WSF7SX
     I              OMNTDT                          WSNTDT
     I              OMNUDT                          WSNUDT
     I              OMNVDT                          WSNVDT
     I              OMNWDT                          WSNWDT
     I              OMNXDT                          WSNXDT
     I              OMBUTM                          WSBUTM
     I              OMBVTM                          WSBVTM
     I              OMBWTM                          WSBWTM
     I              OMBXTM                          WSBXTM
     I              OMBYTM                          WSBYTM
     I              OMH5NX                          WSH5NX
     I              OMH6NX                          WSH6NX
     I              OMH7NX                          WSH7NX
     I              OMH8NX                          WSH8NX
     I              OMH9NX                          WSH9NX
     I              OMDVPR                          WSDVPR
     I              OMDWPR                          WSDWPR
     I              OMDXPR                          WSDXPR
     I              OMDYPR                          WSDYPR
     I              OMDZPR                          WSDZPR
     I              OMUVST                          WSUVST
     I              OMUWST                          WSUWST
     I              OMUXST                          WSUXST
     I              OMAATM                          WSAATM
     I              OMAYNA                          WSAYNA
     I              OMA0NA                          WSA0NA
     I              OMAXDT                          WSAXDT
      *
     I@ADREWA
      * Warehouse                 ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WTAJCD
     I              ADF8NA                          WTF8NA
     I              ADACNA                          WTACNA
     I              ADADNA                          WTADNA
     I              ADAENA                          WTAENA
     I              ADAJNA                          WTAJNA
     I              ADBTTX                          WTBTTX
     I              ADAOCD                          WTAOCD
     I              ADBGCD                          WTBGCD
     I              ADVHST                          WTVHST
     I              ADMPNA                          WTMPNA
     I              ADWPST                          WTWPST
     I              ADXUST                          WTXUST
     I              ADT0ST                          WTT0ST
     I              ADT1ST                          WTT1ST
     I              ADDBNB                          WTDBNB
     I              ADT2ST                          WTT2ST
     I              ADT3ST                          WTT3ST
     I              ADT4ST                          WTT4ST
     I              ADT6ST                          WTT6ST
     I              ADBWC3                          WTBWC3
     I              ADBTC3                          WTBTC3
     I              ADBUC3                          WTBUC3
     I              ADBVC3                          WTBVC3
     I              ADFCAA                          WTFCAA
     I              ADRQSX                          WTRQSX
     I              ADRRSX                          WTRRSX
     I              ADRSSX                          WTRSSX
     I              ADRTSX                          WTRTSX
     I              ADT7ST                          WTT7ST
     I              ADT8ST                          WTT8ST
     I              ADRNSX                          WTRNSX
     I              ADROSX                          WTROSX
     I              ADRPSX                          WTRPSX
     I              ADUVST                          WTUVST
     I              ADUWST                          WTUWST
     I              ADUXST                          WTUXST
     I              ADVSST                          WTVSST
     I              ADAATM                          WTAATM
     I              ADAYNA                          WTAYNA
     I              ADA0NA                          WTA0NA
     I              ADAXDT                          WTAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            779
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Invoice Price Type
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Signal Demand Send Sts
     I                                      663 664 PAFUSX
      * I :  EDI Nistevo Select Sts
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  Unused OH Code
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Unused Date 1
     I                                    P 675 6780PANODT
      * I :  OH Unused Date 2
     I                                    P 679 6820PANPDT
      * I :  OH Unused Date 3
     I                                    P 683 6860PANQDT
      * I :  OH Unused Date 4
     I                                    P 687 6900PANRDT
      * I :  OH Unused Date 5
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Unused Time 3
     I                                    P 703 7060PABRTM
      * I :  OH Unused Time 4
     I                                    P 707 7100PABSTM
      * I :  OH Unused Time 5
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop/Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WGRMNB
     I              FJAIC3                          WGAIC3
     I              FJAODT                          WGAODT
     I              FJPJST                          WGPJST
     I              FJPKST                          WGPKST
     I              FJRNNB                          WGRNNB
     I              FJDMTX                          WGDMTX
     I              FJDNTX                          WGDNTX
     I              FJDOTX                          WGDOTX
     I              FJWTTX                          WGWTTX
     I              FJWUTX                          WGWUTX
     I              FJRPNB                          WGRPNB
     I              FJFLAM                          WGFLAM
     I              FJXQST                          WGXQST
     I              FJRRNB                          WGRRNB
     I              FJDXTX                          WGDXTX
     I              FJDYTX                          WGDYTX
     I              FJSBNB                          WGSBNB
     I              FJBZNA                          WGBZNA
     I              FJRONB                          WGRONB
     I              FJSQNB                          WGSQNB
     I              FJR1NB                          WGR1NB
     I              FJVCST                          WGVCST
     I              FJVDST                          WGVDST
     I              FJSDNB                          WGSDNB
     I              FJPAOU                          WGPAOU
     I              FJDGWG                          WGDGWG
     I              FJSXNB                          WGSXNB
     I              FJHADT                          WGHADT
     I              FJAART                          WGAART
     I              FJDHWG                          WGDHWG
     I              FJDIWG                          WGDIWG
     I              FJAQDT                          WGAQDT
     I              FJS6NB                          WGS6NB
     I              FJT4NB                          WGT4NB
     I              FJPRTM                          WGPRTM
     I              FJNPSV                          WGNPSV
     I              FJJ8TX                          WGJ8TX
     I              FJTLMI                          WGTLMI
     I              FJJ9TX                          WGJ9TX
     I              FJQ2CD                          WGQ2CD
     I              FJVPCD                          WGVPCD
     I              FJDBCD                          WGDBCD
     I              FJGRWE                          WGGRWE
     I              FJXCCD                          WGXCCD
     I              FJU2ST                          WGU2ST
     I              FJF9DT                          WGF9DT
     I              FJONTM                          WGONTM
     I              FJJ4DT                          WGJ4DT
     I              FJTRTM                          WGTRTM
     I              FJJ5DT                          WGJ5DT
     I              FJSPTM                          WGSPTM
     I              FJJ6DT                          WGJ6DT
     I              FJLFTM                          WGLFTM
     I              FJJ7DT                          WGJ7DT
     I              FJBOTM                          WGBOTM
     I              FJJ8DT                          WGJ8DT
     I              FJBLTM                          WGBLTM
     I              FJKIDT                          WGKIDT
     I              FJASTM                          WGASTM
     I              FJKADT                          WGKADT
     I              FJAJCM                          WGAJCM
     I              FJXACD                          WGXACD
     I              FJOANA                          WGOANA
     I              FJK4TX                          WGK4TX
     I              FJVOAG                          WGVOAG
     I              FJKBDT                          WGKBDT
     I              FJNBBO                          WGNBBO
     I              FJW4CD                          WGW4CD
     I              FJEFDT                          WGEFDT
     I              FJCNTN                          WGCNTN
     I              FJKCDT                          WGKCDT
     I              FJTMIN                          WGTMIN
     I              FJKDDT                          WGKDDT
     I              FJVMNB                          WGVMNB
     I              FJOCFR                          WGOCFR
     I              FJKJDT                          WGKJDT
     I              FJATTM                          WGATTM
     I              FJOTRS                          WGOTRS
     I              FJRNST                          WGRNST
     I              FJBRBK                          WGBRBK
     I              FJEIDT                          WGEIDT
     I              FJRMST                          WGRMST
     I              FJAJCD                          WGAJCD
     I              FJKKDT                          WGKKDT
     I              FJAVTM                          WGAVTM
     I              FJKZDT                          WGKZDT
     I              FJAXTM                          WGAXTM
     I              FJLHOS                          WGLHOS
     I              FJLHOR                          WGLHOR
     I              FJWNTX                          WGWNTX
     I              FJOITX                          WGOITX
     I              FJOJTX                          WGOJTX
     I              FJLLDT                          WGLLDT
     I              FJLSHG                          WGLSHG
     I              FJYPST                          WGYPST
     I              FJK0DT                          WGK0DT
     I              FJAYTM                          WGAYTM
     I              FJKNNX                          WGKNNX
     I              FJICWG                          WGICWG
     I              FJIDWG                          WGIDWG
     I              FJH9SX                          WGH9SX
     I              FJWOTX                          WGWOTX
     I              FJK1DT                          WGK1DT
     I              FJAZTM                          WGAZTM
     I              FJK2DT                          WGK2DT
     I              FJA0TM                          WGA0TM
     I              FJROST                          WGROST
     I              FJRPST                          WGRPST
     I              FJRQST                          WGRQST
     I              FJRRST                          WGRRST
     I              FJZBVA                          WGZBVA
     I              FJWPTX                          WGWPTX
     I              FJWQTX                          WGWQTX
     I              FJWRTX                          WGWRTX
     I              FJWSTX                          WGWSTX
     I              FJRVSX                          WGRVSX
     I              FJRUSX                          WGRUSX
     I              FJRWSX                          WGRWSX
     I              FJRXSX                          WGRXSX
     I              FJRYSX                          WGRYSX
     I              FJRZSX                          WGRZSX
     I              FJR0SX                          WGR0SX
     I              FJR1SX                          WGR1SX
     I              FJR2SX                          WGR2SX
     I              FJR3SX                          WGR3SX
     I              FJR4SX                          WGR4SX
     I              FJPYDT                          WGPYDT
     I              FJCKTM                          WGCKTM
     I              FJPZDT                          WGPZDT
     I              FJCLTM                          WGCLTM
     I              FJP0DT                          WGP0DT
     I              FJCMTM                          WGCMTM
     I              FJP1DT                          WGP1DT
     I              FJCNTM                          WGCNTM
     I              FJP2DT                          WGP2DT
     I              FJCOTM                          WGCOTM
     I              FJP3DT                          WGP3DT
     I              FJCQTM                          WGCQTM
     I              FJUVST                          WGUVST
     I              FJUWST                          WGUWST
     I              FJUXST                          WGUXST
     I              FJAATM                          WGAATM
     I              FJAYNA                          WGAYNA
     I              FJA0NA                          WGA0NA
     I              FJAXDT                          WGAXDT
      *
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WHRMNB
     I              FLRUNB                          WHRUNB
     I              FLRVNB                          WHRVNB
     I              FLDQTX                          WHDQTX
     I              FLRWNB                          WHRWNB
     I              FLRXNB                          WHRXNB
     I              FLSQNB                          WHSQNB
     I              FLT0NB                          WHT0NB
     I              FLT1NB                          WHT1NB
     I              FLR1NB                          WHR1NB
     I              FLAIC3                          WHAIC3
     I              FLC4NB                          WHC4NB
     I              FLVCST                          WHVCST
     I              FLKEDT                          WHKEDT
     I              FLSXNB                          WHSXNB
     I              FLKFDT                          WHKFDT
     I              FLACTM                          WHACTM
     I              FLK5TX                          WHK5TX
     I              FLW5CD                          WHW5CD
     I              FLEJDT                          WHEJDT
     I              FLAGTM                          WHAGTM
     I              FLKJDT                          WHKJDT
     I              FLATTM                          WHATTM
     I              FLHDDT                          WHHDDT
     I              FLAUTM                          WHAUTM
     I              FLKKDT                          WHKKDT
     I              FLAVTM                          WHAVTM
     I              FLZ4NB                          WHZ4NB
     I              FLY7ST                          WHY7ST
     I              FLY2ST                          WHY2ST
     I              FLWHTX                          WHWHTX
     I              FLWITX                          WHWITX
     I              FLWJTX                          WHWJTX
     I              FLWKTX                          WHWKTX
     I              FLWLTX                          WHWLTX
     I              FLN7DT                          WHN7DT
     I              FLN8DT                          WHN8DT
     I              FLN9DT                          WHN9DT
     I              FLB3TM                          WHB3TM
     I              FLB4TM                          WHB4TM
     I              FLB5TM                          WHB5TM
     I              FLIASX                          WHIASX
     I              FLIBSX                          WHIBSX
     I              FLICSX                          WHICSX
     I              FLWVTX                          WHWVTX
     I              FLWWTX                          WHWWTX
     I              FLWXTX                          WHWXTX
     I              FLUVST                          WHUVST
     I              FLUWST                          WHUWST
     I              FLUXST                          WHUXST
     I              FLAATM                          WHAATM
     I              FLAYNA                          WHAYNA
     I              FLA0NA                          WHA0NA
     I              FLAXDT                          WHAXDT
      *
     IYBRDCS      DS                            793
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WSAIC3
     I              OMC4NB                          WSC4NB
     I              OMDPNB                          WSDPNB
     I              OMUENB                          WSUENB
     I              OMHGCD                          WSHGCD
     I              OMAJCD                          WSAJCD
     I              OMBKC7                          WSBKC7
     I              OMCFC7                          WSCFC7
     I              OMGMST                          WSGMST
     I              OMGNST                          WSGNST
     I              OMMAVA                          WSMAVA
     I              OMKDVA                          WSKDVA
     I              OML8VA                          WSL8VA
     I              OML9VA                          WSL9VA
     I              OMGTST                          WSGTST
     I              OMGVST                          WSGVST
     I              OMGUST                          WSGUST
     I              OMQFST                          WSQFST
     I              OMAYVA                          WSAYVA
     I              OMEXDT                          WSEXDT
     I              OMLQCD                          WSLQCD
     I              OMRDCD                          WSRDCD
     I              OMQ7CD                          WSQ7CD
     I              OMBZPR                          WSBZPR
     I              OML6NB                          WSL6NB
     I              OMU1ST                          WSU1ST
     I              OMGIDT                          WSGIDT
     I              OMCRCD                          WSCRCD
     I              OMAGCD                          WSAGCD
     I              OMRZST                          WSRZST
     I              OMR0ST                          WSR0ST
     I              OMR1ST                          WSR1ST
     I              OMG7NA                          WSG7NA
     I              OMG8NA                          WSG8NA
     I              OMRPCD                          WSRPCD
     I              OMVEST                          WSVEST
     I              OMVGST                          WSVGST
     I              OMAVST                          WSAVST
     I              OMU0ST                          WSU0ST
     I              OMRFCD                          WSRFCD
     I              OMFZST                          WSFZST
     I              OMR1NB                          WSR1NB
     I              OMAVQT                          WSAVQT
     I              OMD0WG                          WSD0WG
     I              OMCCQT                          WSCCQT
     I              OMAUWG                          WSAUWG
     I              OMCBQT                          WSCBQT
     I              OMATWG                          WSATWG
     I              OMAQCS                          WSAQCS
     I              OMAGCS                          WSAGCS
     I              OMAKPR                          WSAKPR
     I              OMALPR                          WSALPR
     I              OMAUPR                          WSAUPR
     I              OMAVWG                          WSAVWG
     I              OMA4WG                          WSA4WG
     I              OMA5DT                          WSA5DT
     I              OMAODT                          WSAODT
     I              OMGNDT                          WSGNDT
     I              OMAMST                          WSAMST
     I              OMANST                          WSANST
     I              OMVAST                          WSVAST
     I              OMRGNB                          WSRGNB
     I              OMRHNB                          WSRHNB
     I              OMRINB                          WSRINB
     I              OMRBCD                          WSRBCD
     I              OMHICD                          WSHICD
     I              OMRNCD                          WSRNCD
     I              OMROCD                          WSROCD
     I              OMCXDT                          WSCXDT
     I              OMAJVN                          WSAJVN
     I              OMKXCD                          WSKXCD
     I              OMJPCD                          WSJPCD
     I              OMCQCD                          WSCQCD
     I              OMR4CD                          WSR4CD
     I              OMZ1ST                          WSZ1ST
     I              OMZ3ST                          WSZ3ST
     I              OMZ4ST                          WSZ4ST
     I              OMDUPR                          WSDUPR
     I              OMB6VL                          WSB6VL
     I              OMA1AA                          WSA1AA
     I              OMFZSX                          WSFZSX
     I              OMF0SX                          WSF0SX
     I              OMF1SX                          WSF1SX
     I              OMF2SX                          WSF2SX
     I              OMF3SX                          WSF3SX
     I              OMF4SX                          WSF4SX
     I              OMF5SX                          WSF5SX
     I              OMF6SX                          WSF6SX
     I              OMF7SX                          WSF7SX
     I              OMNTDT                          WSNTDT
     I              OMNUDT                          WSNUDT
     I              OMNVDT                          WSNVDT
     I              OMNWDT                          WSNWDT
     I              OMNXDT                          WSNXDT
     I              OMBUTM                          WSBUTM
     I              OMBVTM                          WSBVTM
     I              OMBWTM                          WSBWTM
     I              OMBXTM                          WSBXTM
     I              OMBYTM                          WSBYTM
     I              OMH5NX                          WSH5NX
     I              OMH6NX                          WSH6NX
     I              OMH7NX                          WSH7NX
     I              OMH8NX                          WSH8NX
     I              OMH9NX                          WSH9NX
     I              OMDVPR                          WSDVPR
     I              OMDWPR                          WSDWPR
     I              OMDXPR                          WSDXPR
     I              OMDYPR                          WSDYPR
     I              OMDZPR                          WSDZPR
     I              OMUVST                          WSUVST
     I              OMUWST                          WSUWST
     I              OMUXST                          WSUXST
     I              OMAATM                          WSAATM
     I              OMAYNA                          WSAYNA
     I              OMA0NA                          WSA0NA
     I              OMAXDT                          WSAXDT
      *
     IYCRDCS      DS                            469
     IYDRDCS      DS                            469
     IYERDCS      DS                            779
     IYFRDCS      DS                            469
     IYGRDCS      DS                            793
     IYHRDCS      DS                            793
     IYIRDCS      DS                            793
      * Outward parameters
     IPCRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PCRMNB
      *
      * Outward parameters
     IPDRC        DS                              8
      * KEY : Shipping Instructions     Retrieval index
      * I : RST Company Number
     I                                    P   1   20PDAIC3
      * I : RST Order Number
     I                                    P   3   60PDC4NB
      * I :  Sequence Number
     I                                    P   7   80PDDXNB
      *
      * Outward parameters
     IPERC        DS                              9
      * KEY : Customer Comment          Retrieval index
      * I : RST Ship To Customer
     I                                    P   1   40PEBKC7
      * I : MAP Comment Type
     I                                        5   6 PEI1SX
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * B : MAP Company Number
     I                                    P   1   20P1AIC3
      * B : MAP Order Number
     I                                    P   3   60P1C4NB
      * B : MAP Ship To Customer
     I                                    P   7  100P1BKC7
      * N : MAP Ship To Name
     I                                       11  40 P1BRTX
      * N :  Customer Purchase Order #
     I                                       41  55 P1BCNA
      * N :  Requested Delivery Date
     I                                    P  56  590P1EIDT
      * N :  Load ID
     I                                    P  60  630P1RMNB
      * N :  Shipping Method
     I                                       64  65 P1Q2CD
      * N :  Export Status
     I                                       66  66 P1U2ST
      * N :  Reefer Temperature
     I                                    P  67  692P1RNNB
      * N :  Trans Contol AS400/Plant
     I                                       70  70 P1XUST
      * N :  Shipping Temp Code C/F
     I                                       71  71 P1FRSX
      * N :  Air Freight Order
     I                                       72  72 P1FTSX
     IP2PARM      DS
      * FLD: *Arrays
      * B :  Next Program Name
     I                                        1  10 P2BYVN
      * B :  USR Change existing order
     I                                       11  11 P2G6ST
      * N : MAP Company Name
     I                                       12  41 P2APTX
      * N :  First Time Flag
     I                                       42  42 P2TAST
      * N :  Ship Method           USR
     I                                       43  44 P2G7SX
      * N :  Country Code          USR
     I                                       45  50 P2A5AA
      * N :  User Access
     I                                       51  51 P2OPSX
     IP3PARM      DS
      * FLD: Company Defaults Internal
      * N :  Shipping Method Dft
     I                                        1   2 P3Z9ST
      * N :  Load Type Dft
     I                                        3   3 P3CSST
      * N :  LTL Flag Dft
     I                                        4   4 P3Z8ST
      * N :  Export Status Dft
     I                                        5   5 P3CXST
      * N :  Shrink Wrap Dft
     I                                        6   6 P3SWST
      * N :  Departure Time DFT
     I                                    P   7   90P3XXTM
      * N :  Export Code Dft
     I                                       10  15 P3UECD
      * N :  Allow Mult Whse to Order
     I                                       16  16 P3HSST
      * N :  Allow Multi Export On Ord
     I                                       17  17 P3AMEO
      * N :  Slip Sheet Dft
     I                                       18  18 P3SSDF
      * N :  Palletize Dft
     I                                       19  19 P3PDFT
      * N :  Company Organization
     I                                       20  20 P3YJSX
     IP4PARM      DS
      * FLD: Order Types
      * N :  Processing Cycle Type
     I                                        1   1 P4OAST
      * N :  Billing Activity Type
     I                                        2   2 P4OBST
      * N :  Affect Inventory Default
     I                                        3   3 P4OEST
      * N :  Affect Sales Doll Default
     I                                        4   4 P4OFST
     IP5PARM      DS
      * FLD: Order Detail
      * B :  Warehouse Code
     I                                        1   3 P5AJCD
      * B :  Country Code
     I                                        4   9 P5KXCD
     IP6PARM      DS
      * FLD: Warehouse Type-Internal
      * N :  Reefer Temperature Dft
     I                                    P   1   32P6STTP
      * N :  Temperature Code C/F
     I                                        4   4 P6MLSX
     IP7PARM      DS
      * FLD: Company Customer
      * N :  Outside Warehouse Flag
     I                                        1   1 P7X9ST
     IP8PARM      DS
      * B :  STATUS
     I                                        1   1 P8ATUS
     IP9PARM      DS
      * FLD: Warehouse
      * N :  Default Printer
     I                                        1  10 P9MPNA
      * N :  Warehouse Type
     I                                       11  12 P9WPST
      * N :  Warehouse Location
     I                                       13  13 P9T0ST
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(ORDER-    1 256 #S0001
     I              '_ACK)               '
     I            DS
     I I            'SBMJOB     JOB(GETRE-    1 256 #S0002
     I              'ADY) JOBD(*USRPRF)  '
     I            DS
     I I            'SBMJOB     JOB(FAXOR-    1 256 #S0003
     I              'DACK) JOBD(*USRPRF) '
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Company Customer       NF'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Order Cannot be Canc-Load'
      * Order Number
     I                                        1   7 ZA0001
      * Load ID
     I                                    P   8  110ZA0002
      * Message data for 'Ship to Customer Flag 'N''
      * Ship To Customer
     I                                        1   7 ZA0003
      * Message data for 'Customer not found'
      * Message data for 'Customer               NF'
      * Ship To Customer
     I                                        1   7 ZA0004
      * Message data for 'Salesperson not on route'
      * Salesperson Code
     I                                        1   3 ZA0005
      * Message data for 'Order type invalid'
      * Order Type Description
     I                                        1  30 ZA0006
      * Order Type - Sales
     I                                       31  32 ZA0007
      * Message data for 'Order Type Whse/Cust not'
      * Order Type - Sales
     I                                        1   2 ZA0008
      * Message data for 'Cust Whse/Order Type not'
      * Order Type - Sales
     I                                        1   2 ZA0009
      * Message data for 'P/O Number is a duplicate'
      * Customer Purchase Order #
     I                                        1  15 ZA0010
      * Message data for 'Country Code           NX'
      * Country Code
     I                                        1   6 ZA0011
      * Message data for 'Export Code Required'
      * Country Code
     I                                        1   6 ZA0012
      * Message data for 'Date Must Be GE Job Date'
      * Date                  USR
     I                                    P   1   40ZA0013
      * Message data for 'Time Field GT 24 Hours'
      * Requested Delivery Time
     I                                    P   1   30ZA0014
      * Message data for 'Time cannot be negative'
      * Requested Delivery Time
     I                                    P   1   30ZA0015
      * Message data for 'Time Required'
      * @Time 4.0
     I                                    P   1   30ZA0016
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0017
      * Message data for 'Date Must Be GE Job Date'
      * Date                  USR
     I                                    P   1   40ZA0018
      * Message data for 'Delivery Date < Ship Date'
      * Requested Delivery Date
     I                                    P   1   40ZA0019
      * Message data for 'Ship Date after Deliv Dt'
      * Scheduled Ship Date
     I                                    P   1   40ZA0020
      * Message data for 'Requested Ship Date can n'
      * Must Ship Date        USR
     I                                    P   1   40ZA0021
      * Message data for 'Req Deliv dt is afte ship'
      * Requested Ship Date USR
     I                                    P   1   40ZA0022
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0023
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0024
      * Message data for 'Warehouse must differ tr.'
      * Message data for 'Warehouse fr/to comp err'
      * Warehouse Code
     I                                        1   3 ZA0025
      * USR Warehouse Code
     I                                        4   6 ZA0026
      * Message data for 'Warehouse cant ship f/co'
      * Warehouse Code
     I                                        1   3 ZA0027
      * Company Number
     I                                        4   6 ZA0028
      * Message data for 'Warehouse cant ship f/co'
      * Warehouse Code
     I                                        1   3 ZA0029
      * Company Number
     I                                        4   6 ZA0030
      * Message data for 'P.O. Required'
      * Customer Purchase Order #
     I                                        1  15 ZA0031
      * Message data for 'Transfer In Storage must'
      * Shipping Method
     I                                        1   2 ZA0032
      * Message data for 'IC Item Balance Not Fnd E'
      * Warehouse Code
     I                                        1   3 ZA0033
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0034
      * Application Code
     I                                       11  16 ZA0035
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0036
      * Application Code
     I                                       11  16 ZA0037
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM P1AIC3    WP0001  30       Company Number
     C           P1C4NB    PARM P1C4NB    WP0002  70       Order Number
     C           P1BKC7    PARM P1BKC7    WP0003  70       Ship To Custome
     C           P2BYVN    PARM P2BYVN    WP0004 10        Next Program Na
     C           P2G6ST    PARM P2G6ST    WP0005  1        USR Change exis
     C           P5AJCD    PARM P5AJCD    WP0006  3        Warehouse Code
     C           P5KXCD    PARM P5KXCD    WP0007  6        Country Code
     C           P8ATUS    PARM P8ATUS    WP0008  1        STATUS
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C  N09                EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1C4NB    OREQ *ZERO                      Order Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KRTV      CHAIN@BECPFK              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * Verify record existence against program mode
     C           W0PMD     IFNE 'ADD'
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     9931  *
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * USER: Initialize detail screen (existing record)
      * ** Save the Carrier, & other 1st time stuff
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
      * ** Save original carrier code to test for change  FT686 LJB 01/03
     C                     MOVEL#1BZNA    YL0001           Carrier Code Ch
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
      * 06/12/08 PKD Added parms to XF. Receiving into NLL.
      * RTV Co. Dflt Int All   XF - Company Defaults Internal  * 
     C                     CALL 'PDSTXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C           P3Z9ST    PARM *BLANK    WQ0002  2        Shipping Method
     C           P3CSST    PARM *BLANK    WQ0003  1        Load Type Dft
     C           P3Z8ST    PARM *BLANK    WQ0004  1        LTL Flag Dft
     C           P3CXST    PARM *BLANK    WQ0005  1        Export Status D
     C           P3SWST    PARM *BLANK    WQ0006  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0007  40       Departure Time
     C           P3UECD    PARM *BLANK    WQ0008  6        Export Code Dft
     C           P3HSST    PARM *BLANK    WQ0009  1        Allow Mult Whse
     C           P3AMEO    PARM *BLANK    WQ0010  1        Allow Multi Exp
     C           P3SSDF    PARM *BLANK    WQ0011  1        Slip Sheet Dft
     C           P3PDFT    PARM *BLANK    WQ0012  1        Palletize Dft
     C                     PARM *BLANK    WQ0013  1        Plant Company S
     C                     PARM *BLANK    WQ0014  1        Company Organiz
     C                     PARM *BLANK    WQ0015  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0016  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0017  2        CDI Shipper
     C                     PARM *BLANK    WQ0018  2        CDI Produced by
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL@CN,01    #DVR01           Reference. . .
     C                     MOVELP5KXCD    #DKXCD           Country Code
     C                     Z-ADDP1AIC3    #DFKNB           USR Company Num
      * RTV Salesman Code      RT - PD Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELBER4CD    WL0001    P      Sales Route Cod
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DBCCD    P      Salesperson Cod
      * RTV Salesperson Name   RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBCCD    WL0003    P      Salesperson Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    #DBCCD    P      Salesperson Cod
     C                     MOVELWL0004    #DALTX    P      Salesperson Nam
      * RTV 1st Warehouse/Ctl  RT - PD Order Detail  * 
     C                     EXSR SCRVGN
      * RTV Telephone Number   RT - Customer  * 
     C                     EXSR SERVGN
      * RTV Cust Ordering Dflt RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0005           Company Number
     C                     Z-ADDBEBKC7    WL0006           Ship To Custome
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WUG0TX    P      Terms Code
     C                     MOVELWL0008    WUG0TX    P      Sales Route Cod
     C                     MOVELWL0009    WUG0TX    P      Special Instruc
     C                     MOVELWL0010    WUG0TX    P      Special Instruc
     C                     MOVELWL0011    YL0002    P      Carrier Code
     C                     MOVELWL0012    WUPPST    P      P.O. Required F
     C                     Z-ADDWL0013    WUNFNN           Deliver after t
     C                     MOVELWL0014    WUBOCD    P      Type Code
     C                     Z-ADDWL0015    WUNFNN           Absorbed Freigh
     C                     Z-ADDWL0016    WUNFNN           Mileage To Cust
     C                     MOVELWL0017    WUG0TX    P      Age Code
     C                     MOVELWL0018    WUCPCD    P      Warehouse Code
     C                     MOVELWL0019    P7X9ST    P      Outside Warehou
     C                     MOVELWL0020    WUG0TX    P      Customer Group
     C                     MOVELWL0021    WUG0TX    P      Customer Group
      * Populate warehouse code
      * CASE: DTL.Warehouse Code EQ WRK.BLANK
     C           #DAJCD    IFEQ WUGSTX                     *IF
      * Order:  From detail, passed (PAR), from Company/Customer, from Us
      * CASE: PAR.Warehouse Code EQ WRK.BLANK
     C           P5AJCD    IFEQ WUGSTX                     *IF
      * CASE: DB1.Billing Activity Type is Warehouse Transfer
     C           BEOBST    IFEQ '4'                        *IF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0022           Company Number
     C                     MOVEL'WHSEXFER'WL0023    P      Company Value C
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0024    #DAJCD    P      System Value Al
     C                     ELSE
      * CASE: WRK.USR Warehouse Code EQ WRK.BLANK
     C           WUCPCD    IFEQ WUGSTX                     *IF
     C                     MOVELWUAJCD    #DAJCD           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCPCD    #DAJCD           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP5AJCD    #DAJCD           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#DAJCD    #DCPCD           USR Warehouse C
     C                     MOVEL#DKXCD    #DUFCD           USR Export Code
     C                     Z-ADDBEA5DT    #DCZDT           USR Requested s
     C                     Z-ADDBEAODT    #DHODT           Scheduled Ship
      * ** Save the Shipping Method for testing later
     C                     MOVELBEQ2CD    P1Q2CD           Shipping Method
     C                     Z-ADDBERNNB    P1RNNB           Reefer Temperat
     C                     MOVELBEFRSX    P1FRSX           Shipping Temp C
     C                     Z-ADDBEEIDT    WUAYDZ           Requested Deliv
     C                     Z-ADDBEAFTM    #DT4TM           USR Time 4.0
     C                     Z-ADD#DT4TM    #1AFTM           Requested Deliv
      * RTV Ord Hdr Val/Wgt    rt - PD Order Detail  * 
     C                     EXSR SHRVGN
      * Determine if Ship Method should be output only
      * CASE: DB1.Load ID NE WRK.ZERO
     C           BERMNB    IFNE WUW0NB                     *IF
      * RTV Nbr of Orders/Load RT - OM Load Detail  * 
     C                     EXSR SIRVGN
      * If > 1 order on load, cannot change ship method
      * CASE: WRK.Number of Orders is Greater Than 1
     C           WUMCNB    IFGT 1                          *IF
     C                     MOVEL'Y'       WUE5ST           USR Output Only
     C                     END                             *FI
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 If collect, default carrier to BUY
      * CASE: DTL.Shipping Method is Collect Truck
     C           #1Q2CD    IFEQ 'CT'                       *IF
     C                     MOVEL'BUY'     #1BZNA           Carrier Code
     C                     ELSE
      * CASE: DTL.Shipping Method is Collect Rail
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C                     MOVEL'BUY'     #1BZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
      * Only allow update to Block Order Flag until order has been posted
      * CASE: DB1.Header Status is Entered
     C           BEGWST    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Block Order Flag is Firm Order
     C           BEBCST    IFEQ 'F'                        *IF
     C                     MOVEL'N'       WUTJST           USR Display 2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     END                             *FI
     C                     END                             *FI
      * Set Email cust if blank
      * CASE: DTL.Email Cust On Order Ship is No
     C           #1FOSX    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Email Cust On Order Ship is Yes
     C           #1FOSX    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #1FOSX           Email Cust On O
     C                     END                             *FI
     C                     END                             *FI
      * ** Save Customer PO# and Load ID                          E00139
     C                     MOVEL#1BCNA    P1BCNA           Customer Purcha
     C                     Z-ADD#1RMNB    P1RMNB           Load ID
      * **  PK0093
     C                     MOVEL#1U2ST    P1U2ST           Export Status
      * ** PK0519  10/20/03  RMC
      * air freight
      * CASE: DTL.Air Freight Order is blank
     C           #1FTSX    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1FTSX           Air Freight Ord
     C                     END                             *FI
      * ** 10/23/2007 LJB Support
      * ** Lock dates if order is already assigned to a load
      * CASE: DTL.Load ID is NE Blank
     C           #1RMNB    IFNE *ZERO                      *IF
     C                     MOVEL'L'       WUF4ST           Lock/Unlock
     C                     END                             *FI
      * ** RTV the delivery p.o. from OHE file, if one exists       FP130
      * RTV OHE Delivery PO #  XF - Order Header Extension  * 
     C                     CALL 'PMDBXFR'              90  RTV OHE Deliver
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEAIC3    WQ0019  30       Company Number
     C                     PARM BEC4NB    WQ0020  70       Order Number
     C           WULMT1    PARM WULMT1    WQ0021 38        Delivery P.O. N
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Put OHE deliv po on screen, first time only           FP1303
      * CASE:
      *  - c1 AND c2 ANDc3
      *   |- c1    : DTL.USR 15 Text           USR is Blanks
      *   |- c2    : WRK.Delivery P.O. Number is Not Blank
      *   |- c3    : LCL.Delivery P.O. Number is Eq Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DNLTX    IFEQ *BLANK                     *IF
     C           WULMT1    IFNE *BLANK                     *IF
     C           YL0003    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWULMT1    #DNLTX           USR 15 Text
     C                     MOVEL*BLANK    YL0003           Delivery P.O. N
     C                     MOVEL#DNLTX    YL0003           Delivery P.O. N
     C                     END                             *FI
      * **
      * *Set Cursor: DTL.Requested Ship Date  (*Override=*YES)
     C                     Z-ADD013       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
      * CASE: PAR.Outside Warehouse Flag is yes
     C           P7X9ST    IFEQ 'Y'                        *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0025           Company Number
     C                     Z-ADD#1BKC7    WL0026           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0027    #DWKCD    P      Warehouse Code
     C                     END                             *FI
     C                     END
      *
     C                     ELSE
      * If record already exists, error
     C           *IN90     IFEQ '0'
     C                     SETON                     9931  *
      * Send message 'Order Header TRG       EX'
     C                     MOVEL'USR0177' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
      * USER: Initialize detail screen (new record)
     C                     MOVEL@CN,02    #DVR01           Reference. . .
      * Get Shipping Co dft for ship to    7/27/04
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Ship To Customer is not equal to zero
      *   |- c2    : DTL.USR Company Number is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BKC7    IFNE *ZERO                      *IF
     C           #DFKNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Company Number is not equal to zero
     C           P1AIC3    IFNE *ZERO                      *IF
     C                     Z-ADDP1AIC3    WUBQC3           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Shipping Co Dft    RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0029           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    WUBQC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
      * Multi-co processing
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Allow Multi-Company is yes
      *   |- c2    : PAR.Ship To Customer is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUI6ST    IFEQ 'Y'                        *IF
     C           P1BKC7    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PKTR01 RMC 07/21/04  Dont def. company if allow multi co is Y
      *  and ship to is blank    -- allow entry of co
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUBQC3    P1AIC3           Company Number
     C                     Z-ADDWUBQC3    #DFKNB           USR Company Num
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DFKNB    WL0030           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    #PAPTX    P      Name
     C                     END                             *FI
     C                     MOVELWUJNCD    #1JNCD           Order Type - Sa
      * DTL = PAR By name
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     MOVELP2APTX    #PAPTX           Company Name
     C                     Z-ADDP1BKC7    #1BKC7           Ship To Custome
     C                     MOVELP1BRTX    #1BRTX           Ship To Name
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     Z-ADDP1EIDT    #1EIDT           Requested Deliv
     C                     MOVELP5AJCD    #DAJCD           Warehouse Code
     C                     Z-ADDP1RNNB    #1RNNB           Reefer Temperat
     C                     MOVELP1FRSX    #1FRSX           Shipping Temp C
     C                     MOVELP1Q2CD    #1Q2CD           Shipping Method
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
     C                     MOVELP1BCNA    #1BCNA           Customer Purcha
     C                     MOVELP1U2ST    #1U2ST           Export Status
     C                     MOVELP5KXCD    #DKXCD           Country Code
     C                     MOVELP1FTSX    #1FTSX           Air Freight Ord
     C                     MOVELP1XUST    #1XUST           Trans Contol AS
     C                     MOVELP4OBST    #1OBST           Billing Activit
     C                     Z-ADD*ZERO     WUAADT           @Date - ATR
      * RTV Billing Type       RT - Order Types  * 
     C                     EXSR SMRVGN
      * Ship to and Bill to information
      * CASE: PAR.Ship To Customer NE WRK.ZERO
     C           P1BKC7    IFNE WUW0NB                     *IF
      * RTV Cust Addr, A/R Cst RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0032           Ship To Custome
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    #1BRTX    P      Customer Name
     C                     MOVELWL0034    #1HMNA    P      Address Line 1
     C                     MOVELWL0035    #1HONA    P      Address Line 2
     C                     MOVELWL0036    #1HPNA    P      Address Line 3
     C                     MOVELWL0037    #1HNNA    P      City
     C                     MOVELWL0038    #1DBCD    P      State Code
     C                     MOVELWL0039    #1CKTX    P      Zip/Postal Code
     C                     Z-ADDWL0040    #1ANC7           A/R Customer Nu
     C                     MOVELWL0041    #1FOSX    P      Email When Orde
     C                     Z-ADD#1ANC7    #1B0C7           Bill to Custome
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ANC7    WL0042           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0043    #1AETX    P      Customer Name
     C                     MOVELWL0044    #1B1NA    P      Address Line 1
     C                     MOVELWL0045    #1B3NA    P      Address Line 2
     C                     MOVELWL0046    #1B4NA    P      Address Line 3
     C                     MOVELWL0047    #1B2NA    P      City
     C                     MOVELWL0048    #1BHCD    P      State Code
     C                     MOVELWL0049    #1C8TX    P      Zip/Postal Code
     C                     END                             *FI
      * RTV Co. Dflt Int All,O XF - Company Defaults Internal  * 
     C                     CALL 'PMRMXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0022  30       Company Number
     C           P3Z9ST    PARM *BLANK    WQ0023  2        Shipping Method
     C           P3CSST    PARM *BLANK    WQ0024  1        Load Type Dft
     C           P3Z8ST    PARM *BLANK    WQ0025  1        LTL Flag Dft
     C           P3CXST    PARM *BLANK    WQ0026  1        Export Status D
     C           P3SWST    PARM *BLANK    WQ0027  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0028  40       Departure Time
     C           P3UECD    PARM *BLANK    WQ0029  6        Export Code Dft
     C           P3HSST    PARM *BLANK    WQ0030  1        Allow Mult Whse
     C           P3AMEO    PARM *BLANK    WQ0031  1        Allow Multi Exp
     C           P3SSDF    PARM *BLANK    WQ0032  1        Slip Sheet Dft
     C           P3PDFT    PARM *BLANK    WQ0033  1        Palletize Dft
     C           P3YJSX    PARM *BLANK    WQ0034  1        Company Organiz
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Company/customer defaults
      * CASE: PAR.Ship To Customer NE WRK.ZERO
     C           P1BKC7    IFNE WUW0NB                     *IF
      * RTV Cust Ordering Dflt RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0005           Company Number
     C                     Z-ADD#1BKC7    WL0006           Ship To Custome
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    #1AQCD    P      Terms Code
     C                     MOVELWL0008    #1R4CD    P      Sales Route Cod
     C                     MOVELWL0009    #1BYNA    P      Special Instruc
     C                     MOVELWL0010    #1B6NA    P      Special Instruc
     C                     MOVELWL0011    YL0002    P      Carrier Code
     C                     MOVELWL0012    WUPPST    P      P.O. Required F
     C                     Z-ADDWL0013    #1AFTM           Deliver after t
     C                     MOVELWL0014    WUBOCD    P      Type Code
     C                     Z-ADDWL0015    #1TBNB           Absorbed Freigh
     C                     Z-ADDWL0016    WUNFNN           Mileage To Cust
     C                     MOVELWL0017    #1RPCD    P      Age Code
     C                     MOVELWL0018    #DAJCD    P      Warehouse Code
     C                     MOVELWL0019    P7X9ST    P      Outside Warehou
     C                     MOVELWL0020    WUG0TX    P      Customer Group
     C                     MOVELWL0021    WUG0TX    P      Customer Group
      * Validate Co/Cust exists
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL#DAJCD    WUCPCD           USR Warehouse C
      * CASE: LCL.Carrier Code is Buyer's Truck
     C           YL0002    IFEQ 'BUY'                      *IF
     C                     MOVEL'CT'      P3Z9ST           Shipping Method
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     P1C4NB           Order Number
      * Setup message data for message
      * Send message 'Company Customer       NF'
     C                     MOVEL'USR1007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO BEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Billing Activity type reset for transfer
      * CASE: PAR.Outside Warehouse Flag is yes
     C           P7X9ST    IFEQ 'Y'                        *IF
     C                     MOVEL'4'       #1OBST           Billing Activit
     C                     END                             *FI
      * Populate warehouse code
      * CASE: DTL.Billing Activity Type is Warehouse Transfer
     C           #1OBST    IFEQ '4'                        *IF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0022           Company Number
     C                     MOVEL'WHSEXFER'WL0023    P      Company Value C
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0024    #DAJCD    P      System Value Al
     C                     ELSE
      * CASE: DTL.Warehouse Code EQ WRK.BLANK
     C           #DAJCD    IFEQ WUGSTX                     *IF
     C                     MOVELWUAJCD    #DAJCD           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
      * RTV Salesman Code      RT - PD Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1R4CD    WL0001    P      Sales Route Cod
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DBCCD    P      Salesperson Cod
      * RTV Salesperson Name   RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBCCD    WL0003    P      Salesperson Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    #DBCCD    P      Salesperson Cod
     C                     MOVELWL0004    #DALTX    P      Salesperson Nam
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SPRVGN
      * First time processing
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     MOVEL'E'       #1GWST           Header Status
     C                     MOVEL'Y'       #1U4ST           Load Plan Order
      * FP1110 - RMC 01/14/08  Print Pick Slip - dft to NO for HPB
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P3YJSX    IFEQ 'H'                        *IF
     C                     MOVEL'N'       #1U5ST           Print Pick Slip
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #1U5ST           Print Pick Slip
     C                     END                             *FI
     C                     MOVEL'Y'       #1WBST           Affect Auto Acc
     C                     MOVEL'01'      #1JPCD           Event Code
     C                     MOVELP3PDFT    #1VEST           Palletize
     C                     MOVELP3SSDF    #1VGST           Slip Sheet
     C                     MOVELP3SWST    #1VFST           Shrink Wrap
     C                     MOVELP3Z9ST    #1Q2CD           Shipping Method
     C                     MOVELP3Z8ST    #1PJST           LTL Flag
     C                     MOVELP3UECD    #DKXCD           Country Code
      * Check Company/customer for EXport Type Code
      * CASE: PAR.Ship To Customer NE WRK.ZERO
     C           P1BKC7    IFNE WUW0NB                     *IF
      * CASE: WRK.Type Code is Export
     C           WUBOCD    IFEQ 'EX'                       *IF
     C                     MOVEL'Y'       #1U2ST           Export Status
     C                     MOVELP2A5AA    #DKXCD           Country Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP3CXST    #1U2ST           Export Status
     C                     END                             *FI
     C                     END                             *FI
      * ** Save original carrier code to test for change  FT686 LJB 01/03
     C                     MOVEL#1BZNA    YL0001           Carrier Code Ch
     C                     MOVELP3CSST    #1VDST           Load Type
     C                     Z-ADD##JDT     #1EIDT           Requested Deliv
     C                     Z-ADD##JDT     #1AODT           Scheduled Ship
     C                     Z-ADD##JDT     #1A0DT           Order Date
     C                     Z-ADD##JDT     #1CXDT           Date of Origina
     C                     MOVEL##USR     #1AIVN           User Original E
      * RTV Shipping Temp      XF - Warehouse Type-Internal  * 
     C                     CALL 'PDSSXFR'              90  RTV Shipping Te
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUWPST    WQ0035  2        Warehouse Type
     C           #1RNNB    PARM *ZERO     WQ0036  52       Reefer Temperat
     C           #1FRSX    PARM *BLANK    WQ0037  1        Temperature Cod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993839*
     C                     END
      * Rtv Customer Air Frt  RT - Customer EXT  * 
     C                     EXSR SQRVGN
      * Rtv Cust Shipping Tmp XF - Comp Cust Extension  * 
     C                     CALL 'POPRXFR'              90  Rtv Cust Shippi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DFKNB    WQ0038  30       Company Number
     C                     PARM #1BKC7    WQ0039  70       Ship To Custome
     C           YL0004    PARM *ZERO     WQ0040  52       Cust Shipping T
     C           YL0005    PARM *BLANK    WQ0041  1        Cust Shipping T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
      * CASE: LCL.Cust Shipping Temp is Entered
     C           YL0004    IFNE *ZERO                      *IF
     C                     Z-ADDYL0004    #1RNNB           Reefer Temperat
     C                     MOVELYL0005    #1FRSX           Shipping Temp C
     C                     END                             *FI
     C                     Z-ADD#1RNNB    P1RNNB           Reefer Temperat
     C                     MOVEL#1FRSX    P1FRSX           Shipping Temp C
     C                     END                             *FI
     C                     MOVEL#1Q2CD    P1Q2CD           Shipping Method
     C                     MOVEL'F'       #1BCST           Block Order Fla
     C                     MOVEL'N'       #1BDST           Order Certifica
     C                     MOVEL'N'       #1FNSX           Transfer in Sto
     C                     MOVELP1FTSX    #1FTSX           Air Freight Ord
     C                     MOVEL'Y'       WUTJST           USR Display 2
      * update exception status used to get 1 time *ADD mode msg for dup.
     C                     MOVEL'N'       WUF6ST           Update Exceptio
      * Position cursor
      * CASE: DTL.Ship To Customer EQ WRK.ZERO
     C           #1BKC7    IFEQ WUW0NB                     *IF
      * *Set Cursor: DTL.Ship To Customer  (*Override=*YES)
     C                     Z-ADD005       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * *Set Cursor: DTL.Requested Delivery Date  (*Override=*YES)
     C                     Z-ADD012       W0ROW1
     C                     Z-ADD023       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     END                             *FI
      * Set Email cust if blank
      * CASE: DTL.Email Cust On Order Ship is No
     C           #1FOSX    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Email Cust On Order Ship is Yes
     C           #1FOSX    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #1FOSX           Email Cust On O
     C                     END                             *FI
     C                     END                             *FI
      * *-------------------------------------------------------------*
      * * 08/16/00 PKP Default flag to N when creating a new order.
      * Export Doc go w/ Driver
      * CASE: DTL.Export Docs Go w/Driver is Blank
     C           #1FQSX    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1FQSX           Export Docs Go
     C                     END                             *FI
      * CASE: PAR.Outside Warehouse Flag is yes
     C           P7X9ST    IFEQ 'Y'                        *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0025           Company Number
     C                     Z-ADD#1BKC7    WL0026           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0027    #DWKCD    P      Warehouse Code
     C                     END                             *FI
     C                     END
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Company Name and Address
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Validate USR Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELVDFKNB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVDFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #DFKNB           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #DFKNB           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Requested Delivery Date
      * External date
     C                     Z-ADDV1EIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     Z-ADDXDINDT    #1EIDT
      * Validate Requested Ship Date
      * External date
     C                     Z-ADDV1A5DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     Z-ADDXDINDT    #1A5DT
      * Validate Shipping Temp Code C/F
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1FRSX'  IFEQ YPMTFD
      * Shipping Temp Code C/F
     C                     MOVEL#1FRSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHFRSX
     C                     SELEC
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD1         ZHFRSX
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD2         ZHFRSX
     C                     ENDSL
     C                     EXFMTZGFRSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHFRSX    WHEQ 1
     C                     MOVEL'C'       W0INVL           C
     C           ZHFRSX    WHEQ 2
     C                     MOVEL'F'       W0INVL           F
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1FRSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Shipping Method
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1Q2CD'  IFEQ YPMTFD
      * Shipping Method
     C                     MOVEL#1Q2CD    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHQ2CD
     C                     SELEC
     C           W0INVL    WHEQ 'CR'                       CR
     C                     Z-ADD1         ZHQ2CD
     C           W0INVL    WHEQ 'CT'                       CT
     C                     Z-ADD2         ZHQ2CD
     C           W0INVL    WHEQ 'PR'                       PR
     C                     Z-ADD3         ZHQ2CD
     C           W0INVL    WHEQ 'PT'                       PT
     C                     Z-ADD4         ZHQ2CD
     C                     ENDSL
     C                     EXFMTZGQ2CD
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHQ2CD    WHEQ 1
     C                     MOVEL'CR'      W0INVL           CR
     C           ZHQ2CD    WHEQ 2
     C                     MOVEL'CT'      W0INVL           CT
     C           ZHQ2CD    WHEQ 3
     C                     MOVEL'PR'      W0INVL           PR
     C           ZHQ2CD    WHEQ 4
     C                     MOVEL'PT'      W0INVL           PT
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1Q2CD
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Export Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1U2ST'  IFEQ YPMTFD
      * Export Status
     C                     MOVEL#1U2ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHU2ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHU2ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHU2ST
     C                     ENDSL
     C                     EXFMTZGU2ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHU2ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHU2ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1U2ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Export Docs Go w/Driver
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1FQSX'  IFEQ YPMTFD
      * Export Docs Go w/Driver
     C                     MOVEL#1FQSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHFQSX
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHFQSX
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHFQSX
     C                     ENDSL
     C                     EXFMTZGFQSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHFQSX    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHFQSX    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1FQSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Block Order Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1BCST'  IFEQ YPMTFD
      * Block Order Flag
     C                     MOVEL#1BCST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHBCST
     C                     SELEC
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD1         ZHBCST
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD2         ZHBCST
     C                     ENDSL
     C                     EXFMTZGBCST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHBCST    WHEQ 1
     C                     MOVEL'B'       W0INVL           B
     C           ZHBCST    WHEQ 2
     C                     MOVEL'F'       W0INVL           F
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1BCST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate LTL Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1PJST'  IFEQ YPMTFD
      * LTL Flag
     C                     MOVEL#1PJST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHPJST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHPJST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHPJST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHPJST
     C                     ENDSL
     C                     EXFMTZGPJST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHPJST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHPJST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHPJST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1PJST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Order Certification Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1BDST'  IFEQ YPMTFD
      * Order Certification Flag
     C                     MOVEL#1BDST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHBDST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHBDST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHBDST
     C                     ENDSL
     C                     EXFMTZGBDST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHBDST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHBDST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1BDST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Transfer in Storage Ind
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1FNSX'  IFEQ YPMTFD
      * Transfer in Storage Ind
     C                     MOVEL#1FNSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHFNSX
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHFNSX
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHFNSX
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHFNSX
     C                     ENDSL
     C                     EXFMTZGFNSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHFNSX    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHFNSX    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHFNSX    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1FNSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Claim Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1C0C7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1C0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1C0C7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1C0C7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * Cancel Order
      * CASE: DTL.*CMD key is *Cancel
     C           *IN11     IFEQ '1'                        *IF
      * Edit for Cancel
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load is not zero check load Sts of E or C else cancel order
      * CASE: DTL.Load ID NE WRK.ZERO
     C           #1RMNB    IFNE WUW0NB                     *IF
      * RTV Load Status        RT - Load Header  * 
     C                     EXSR SRRVGN
      * If load status is U,L,S or I then can't cancel, else cancel order
      * CASE: WRK.Load Status is Unlocked thru Invoiced
     C           WUPKST    IFEQ 'I'                        *IF
     C           WUPKST    OREQ 'L'
     C           WUPKST    OREQ 'S'
     C           WUPKST    OREQ 'U'
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD#1RMNB    ZA0002           Load ID
      * Send message 'Order Cannot be Canc-Load'
     C                     MOVEL'USR2363' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Cancel Order that has been assigned to a load
      * CASE: DTL.*CMD key is *Cancel
     C           *IN11     IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVEL'N'       WUQ2ST           Status Flag 2
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'N'       WUFMST           Status Flag 4
     C                     MOVEL'N'       WUAJTX           Status Flag 5
     C                     MOVEL'N'       WUACTX           Status Flag 6
     C                     MOVEL'N'       WUAKTX           Status Flag 7
     C                     MOVEL'N'       WUDXSX           Display Flag 1
      * SEL Confirm Prompt     PV - Order Header TRG  * 
     C                     CALL 'PDS0PVR'              90  SEL Confirm Pro
     C                     PARM *BLANK    W0RTN   7
     C           WUB8ST    PARM WUB8ST    WQ0045  1        Status - Y or N
     C                     PARM #1AIC3    WQ0046  30       Company Number
     C                     PARM #1C4NB    WQ0047  70       Order Number
     C                     PARM #1BKC7    WQ0048  70       Ship To Custome
     C                     PARM 'N'       WQ0049  1        Broker Order St
     C           WUDTSX    PARM WUDTSX    WQ0050  1        Print (Yes/No)
     C           WUQ2ST    PARM WUQ2ST    WQ0051  1        Status Flag 2
     C           WUQ3ST    PARM WUQ3ST    WQ0052  1        Status Flag 3
     C           WUFMST    PARM WUFMST    WQ0053  1        Status Flag 4
     C           WUAJTX    PARM WUAJTX    WQ0054  1        Status Flag 5
     C           WUACTX    PARM WUACTX    WQ0055  1        Status Flag 6
     C           WUAKTX    PARM WUAKTX    WQ0056  1        Status Flag 7
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDS0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * CASE: WRK.Status - Y or N is no
     C           WUB8ST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Remove load ID from canceled order
      * CHG Load ID            CH - PD Order Header  * 
     C                     EXSR SSCHRC
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
      * UPD Cancel Order       XF - PD Order Header  * 
     C                     CALL 'OPV9XFR'              90  UPD Cancel Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0057  30       Company Number
     C                     PARM #1C4NB    WQ0058  70       Order Number
     C                     PARM #1ANC7    WQ0059  70       A/R Customer Nu
     C                     PARM #1BKC7    WQ0060  70       Ship To Custome
     C                     PARM #1OBST    WQ0061  1        Billing Activit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPV9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'CANORD'  WURVST           Load Change Typ
     C                     MOVEL'X'       WUHSUS           Header Status U
      * NOTE:  Will only write log if order on load and load not in E sta
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVEL#1GWST    PBMNTX    P      Change Log Prio
     C                     MOVELWUHSUS    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * VAL Load ID on Orders  RT - PD Order Header  * 
     C                     EXSR STRVGN
      * If no other orders on load then delete the load else change load
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * ** E-TRANS47 LJB 01/03/2008  Reverse FP1061 per Gary Martin. If a
      * ** Load ID is cancelled then the carrier needs to be notified.
      * ** Traffic will do this.
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'DELOAD'  WURVST           Load Change Typ
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWUPKST    PBMNTX    P      Change Log Prio
     C                     MOVEL'Deleted' PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * NOTE:  Will only write log if order on load and load not in E sta
      * DLT Load Header        DL - Load Header  * 
     C                     EXSR SUDLRC
      * DLT Load Detail       RT - OM Load Detail  * 
     C                     EXSR SVRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Sub Weight & Stop  RT - Load Header  * 
     C                     EXSR SXRVGN
      * CHG Del Order Off load RT - Load Detail  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Cancel Order that has not yet been assigned to a load
      * CASE: DTL.*CMD key is *Cancel
     C           *IN11     IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVEL'N'       WUQ2ST           Status Flag 2
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'N'       WUFMST           Status Flag 4
     C                     MOVEL'N'       WUAJTX           Status Flag 5
     C                     MOVEL'N'       WUACTX           Status Flag 6
     C                     MOVEL'N'       WUAKTX           Status Flag 7
      * SEL Confirm Prompt     PV - Order Header TRG  * 
     C                     CALL 'PDS0PVR'              90  SEL Confirm Pro
     C                     PARM *BLANK    W0RTN   7
     C           WUB8ST    PARM WUB8ST    WQ0062  1        Status - Y or N
     C                     PARM #1AIC3    WQ0063  30       Company Number
     C                     PARM #1C4NB    WQ0064  70       Order Number
     C                     PARM #1BKC7    WQ0065  70       Ship To Custome
     C                     PARM 'N'       WQ0066  1        Broker Order St
     C           WUDTSX    PARM WUDTSX    WQ0067  1        Print (Yes/No)
     C           WUQ2ST    PARM WUQ2ST    WQ0068  1        Status Flag 2
     C           WUQ3ST    PARM WUQ3ST    WQ0069  1        Status Flag 3
     C           WUFMST    PARM WUFMST    WQ0070  1        Status Flag 4
     C           WUAJTX    PARM WUAJTX    WQ0071  1        Status Flag 5
     C           WUACTX    PARM WUACTX    WQ0072  1        Status Flag 6
     C           WUAKTX    PARM WUAKTX    WQ0073  1        Status Flag 7
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDS0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * CASE: WRK.Status - Y or N is no
     C           WUB8ST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'CANORD'  WURVST           Load Change Typ
     C                     MOVEL'X'       WUHSUS           Header Status U
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVEL#1GWST    PBMNTX    P      Change Log Prio
     C                     MOVELWUHSUS    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * NOTE:  Will only write log if order on load and load not in E sta
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
      * UPD Cancel Order       XF - PD Order Header  * 
     C                     CALL 'OPV9XFR'              90  UPD Cancel Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0074  30       Company Number
     C                     PARM #1C4NB    WQ0075  70       Order Number
     C                     PARM #1ANC7    WQ0076  70       A/R Customer Nu
     C                     PARM #1BKC7    WQ0077  70       Ship To Custome
     C                     PARM #1OBST    WQ0078  1        Billing Activit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPV9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Add error
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * RTV OE Hold/ShipTo FlagRT - Customer  * 
     C                     EXSR TARVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Order Entry Hold
      * CASE: WRK.Order Entry Hold is New Order Hold
     C           WUQNST    IFEQ 'Y'                        *IF
      * Send message 'Customer hold status'
     C                     MOVEL'USR1025' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Ship to Customer = N
      * CASE: WRK.Ship To Customer Flag is No Use as Ship to Cust
     C           WURJST    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Ship to Customer Flag 'N''
     C                     MOVEL'USR2482' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Customer not found'
     C                     MOVEL'USR0525' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Select company
      * CASE: Select on Company
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.USR Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'VDFKNB'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #DFKNB    PARM #DFKNB    WQ0079  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
      * Select customer
      * CASE: Select on Ship to Customer
      *  - c1 AND c2 AND c3
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Ship To Customer
      *   |- c3    : PGM.*Program mode is *ADD
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V1BKC7'                   *IF
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0080  70       Ship To Custome
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * Change to customer
      * CASE: DTL.Ship To Customer NE WRK.ZERO
     C           #1BKC7    IFNE WUW0NB                     *IF
     C                     Z-ADD#DFKNB    P1AIC3           Company Number
     C                     Z-ADD#1BKC7    P1BKC7           Ship To Custome
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
     C                     MOVEL'PDSRE1R' P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
      * Change to company number
      * CASE: DTL.USR Company Number NE PAR.Company Number
     C           #DFKNB    IFNE P1AIC3                     *IF
     C                     Z-ADD#DFKNB    P1AIC3           Company Number
     C                     Z-ADD#1BKC7    P1BKC7           Ship To Custome
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
     C                     MOVEL'PDSRE1R' P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Change to customer
      * CASE: DTL.Ship To Customer NE PAR.Ship To Customer
     C           #1BKC7    IFNE P1BKC7                     *IF
      * Validate customer
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * VAL Check Exists       RT - Customer  * 
     C                     EXSR TBRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     Z-ADD#DFKNB    P1AIC3           Company Number
     C                     Z-ADD#1BKC7    P1BKC7           Ship To Custome
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
     C                     MOVEL'PDSRE1R' P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0004           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
     C                     MOVEL'PDSRE1R' P2BYVN           Next Program Na
      * Selects - Warehouse, Salesperson, Country
      * CASE: Select on Salesperson
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Salesperson Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DBCCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Salesperson SR - Salesperson  * 
     C                     CALL 'CABYSRR'              90  SEL Active Sale
     C                     PARM *BLANK    W0RTN   7
     C           #DBCCD    PARM #DBCCD    WQ0081  3        Salesperson Cod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     ELSE
      * CASE: Select on Warehouse
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Warehouse Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DAJCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL ShipCo/Warehouse   SR - Warehouse  * 
     C                     CALL 'PPHQSRR'              90  SEL ShipCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #DAJCD    PARM #DAJCD    WQ0082  3        Warehouse Code
     C                     PARM #DFKNB    WQ0083  30       Shipping Compan
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPHQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993731*
     C                     END
     C                     ELSE
      * CASE: Select on Country (Export) Code
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Country Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DKXCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Country Active     SR - OM Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DKXCD    PARM #DKXCD    WQ0084  6        Country Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9945  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Sls Route by Slsp  RT - PD Sales Route  * 
     C                     EXSR TCRVGN
      * Sales route required
      * CASE: DTL.Sales Route Code EQ WRK.BLANK
     C           #1R4CD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#DBCCD    ZA0005           Salesperson Cod
      * Send message 'Salesperson not on route'
     C                     MOVEL'USR2029' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
      * VP Level
      * CASE: DTL.VP Level Code EQ WRK.BLANK
     C           #1Q4CD    IFEQ WUGSTX                     *IF
      * RTV Mgr Desc,VP Level  RT - Manager Level  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
      * RTV Order Types        RT - OP Order Types  * 
     C                     EXSR TERVGN
      * Validate Order type
      * CASE: DTL.Billing Activity Type is Credit or Debit Memo
     C           #1OBST    IFEQ '2'                        *IF
     C           #1OBST    OREQ '3'
      * Setup message data for message
     C                     MOVEL@CN,03    ZA0006           Order Type Desc
     C                     MOVEL#1JNCD    ZA0007           Order Type - Sa
      * Send message 'Order type invalid'
     C                     MOVEL'USR1895' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: DTL.Billing Activity Type is Warehouse Transfer
     C           #1OBST    IFEQ '4'                        *IF
      * CASE: PAR.Outside Warehouse Flag is Not Yes
     C           P7X9ST    IFEQ *BLANK                     *IF
     C           P7X9ST    OREQ 'N'
      * Setup message data for message
     C                     MOVEL#1JNCD    ZA0008           Order Type - Sa
      * Send message 'Order Type Whse/Cust not'
     C                     MOVEL'USR0610' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Billing Activity Type is Invoice
     C           #1OBST    IFEQ '1'                        *IF
      * CASE: PAR.Outside Warehouse Flag is yes
     C           P7X9ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1JNCD    ZA0009           Order Type - Sa
      * Send message 'Cust Whse/Order Type not'
     C                     MOVEL'USR2259' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Fill Warehouse Control
      * CASE: DTL.Warehouse Code NE WRK.BLANK
     C           #DAJCD    IFNE WUGSTX                     *IF
      * RTV Whse Type,Control  RT - Warehouse  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
      * Clear warehouse if multiple warehouses per order
      * CASE: PAR.Allow Mult Whse to Order is yes
     C           P3HSST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    #DAJCD           Warehouse Code
     C                     END                             *FI
      * Add mode processing
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * RTV Cust Addr, A/R Cst RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0032           Ship To Custome
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    #1BRTX    P      Customer Name
     C                     MOVELWL0034    #1HMNA    P      Address Line 1
     C                     MOVELWL0035    #1HONA    P      Address Line 2
     C                     MOVELWL0036    #1HPNA    P      Address Line 3
     C                     MOVELWL0037    #1HNNA    P      City
     C                     MOVELWL0038    #1DBCD    P      State Code
     C                     MOVELWL0039    #1CKTX    P      Zip/Postal Code
     C                     Z-ADDWL0040    #1ANC7           A/R Customer Nu
     C                     MOVELWL0041    #1FOSX    P      Email When Orde
     C                     Z-ADD#1ANC7    #1B0C7           Bill to Custome
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1B0C7    WL0042           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0043    #1AETX    P      Customer Name
     C                     MOVELWL0044    #1B1NA    P      Address Line 1
     C                     MOVELWL0045    #1B3NA    P      Address Line 2
     C                     MOVELWL0046    #1B4NA    P      Address Line 3
     C                     MOVELWL0047    #1B2NA    P      City
     C                     MOVELWL0048    #1BHCD    P      State Code
     C                     MOVELWL0049    #1C8TX    P      Zip/Postal Code
      * Check for duplicate P.O #
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Customer Purchase Order # NE WRK.BLANK
      *   |- c2    : WRK.Update Exception Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BCNA    IFNE WUGSTX                     *IF
     C           WUF6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Co,Cust,PO         RT - Order Header TRG  * 
     C                     EXSR TGRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
      * informational message was getting lost; get error message 1st tim
      *     allow update
      * Setup message data for message
     C                     MOVEL#1BCNA    ZA0010           Customer Purcha
      * Send message 'P/O Number is a duplicate'
     C                     MOVEL'USR2439' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     MOVEL'Y'       WUF6ST           Update Exceptio
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** No way to correct shp dt<ord dt, so I commented it out.
      * Validate country code     (moved to before ship date tests)
      * CASE: DTL.Country Code NE WRK.BLANK
     C           #DKXCD    IFNE WUGSTX                     *IF
      * RTV Chk if valid Cntry RT - OM Country  * 
     C                     EXSR THRVGN
      * Error if country not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DKXCD    ZA0011           Country Code
      * Send message 'Country Code           NX'
     C                     MOVEL'USR2030' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       #1U2ST           Export Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Error if export status = Y
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DKXCD    ZA0012           Country Code
      * Send message 'Export Code Required'
     C                     MOVEL'USR2034' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Date Tests:
      * Requested Ship date change
      * CASE: DTL.Requested Ship Date NE DTL.USR Requested ship date s
     C           #1A5DT    IFNE #DCZDT                     *IF
      * Val Day Prior Ship    RT - Order Detail  * 
     C                     EXSR TIRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Record Found USR is Record Found
      *   |- c2    : LCL.Display Flag is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0006    IFEQ 'Y'                        *IF
     C           YL0007    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Modify Market Price Date'
     C                     MOVEL'USR2964' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       YL0007           Display Flag
     C                     END                             *FI
     C                     END                             *FI
     C           #1AFTM    MULT 100       WUAPTM           Time
      * ** Requested Ship Date cannot be before today (test only if chang
      * CASE: DTL.Requested Ship Date NE DTL.USR Requested ship date s
     C           #1A5DT    IFNE #DCZDT                     *IF
      * CASE: DTL.Requested Ship Date LT JOB.*Job date
     C           #1A5DT    IFLT ##JDT                      *IF
      * Setup message data for message
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0013
      * Send message 'Date Must Be GE Job Date'
     C                     MOVEL'USR3927' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
      * Edit Delivery Time
      * CASE: DTL.Requested Delivery Time is GT 24 Hour Day
     C           #1AFTM    IFGT 2400                       *IF
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0014           Requested Deliv
      * Send message 'Time Field GT 24 Hours'
     C                     MOVEL'USR1712' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     ELSE
      * CASE: DTL.Requested Delivery Time is LT 0
     C           #1AFTM    IFLT 0                          *IF
      * RMC 01/23/07 added err for time < 0 (& unlock field LJB 5/16/08)
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0015           Requested Deliv
      * Send message 'Time cannot be negative'
     C                     MOVEL'USR3682' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: DTL.Requested Delivery Time is Zero
     C           #1AFTM    IFEQ *ZERO                      *IF
      * LJB 05/16/08 Time cannot be zeros  (& unlock field)
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0016           Requested Deliv
      * Send message 'Time Required'
     C                     MOVEL'USR2333' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: *OTHERWISE
     C           #1AFTM    DIV  100       YRWF00           *Modulo work fi
     C                     MVR            WURDNB           USR Remainder
      * CASE: WRK.USR Remainder is GT 59 Minutes
     C           WURDNB    IFGT 59                         *IF
      * Setup message data for message
     C                     Z-ADD#1AFTM    ZA0017           Requested Deliv
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Scheduled ship date = requested ship date if order sts is entered
      * CASE: DTL.Header Status is Entered
     C           #1GWST    IFEQ 'E'                        *IF
     C                     Z-ADD#1A5DT    #1AODT           Scheduled Ship
     C                     END                             *FI
      * ** Validate delivery date if it has changed or if it is new
      * CASE:
      *  - (c1 AND c2) OR c3
      *   |- c1    : DTL.Requested Delivery Date NE WRK.Requested Deliver
      *   |- c2    : WRK.Requested Delivery Dt is Entered
      *   |- c3    : WRK.Requested Delivery Dt is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1EIDT    IFNE WUAYDZ                     *IF
     C           WUAYDZ    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WUAYDZ    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Requested Delivery Date cannot be before today or now
      * CASE:
      *  - c1 OR (c2 AND c3)
      *   |- c1    : DTL.Requested Delivery Date LT JOB.*Job date
      *   |- c2    : DTL.Requested Delivery Date EQ JOB.*Job date
      *   |- c3    : WRK.Time LE JOB.*Job time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1EIDT    IFLT ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1EIDT    IFEQ ##JDT                      *IF
     C           WUAPTM    IFLE ##JTM                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Send message 'Date Must Be GE Job Date'
     C                     MOVEL'USR3927' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
      * ** Delivery Date cannot be before Scheduled Ship Date      FP1251
      * CASE: DTL.Requested Delivery Date LT DTL.Scheduled Ship Date
     C           #1EIDT    IFLT #1AODT                     *IF
      * ** Do not allow the Delivery date to be before the Ship Date. Unl
      * ** the field if there is an error so it can be corrected.   FP125
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0019
      * Send message 'Delivery Date < Ship Date'
     C                     MOVEL'USR2063' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
      * ** Delivery Date cannot be before Requested Ship Date      E00147
      * CASE: DTL.Requested Delivery Date LT DTL.Requested Ship Date
     C           #1EIDT    IFLT #1A5DT                     *IF
      * Setup message data for message
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0020
      * Send message 'Ship Date after Deliv Dt'
     C                     MOVEL'USR3881' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
      * ** Check Must Ship Date in order if Whse, SSD, or RSD changed
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      *        don't edit dates for buyers truck orders/loads
     C                     ELSE
      * CASE: Whse, SSD, RDD/RDT, RSD changed
      *  - c1 OR c2 OR c5 OR c6 OR c7
      *   |- c1    : DTL.Warehouse Code NE DTL.USR Warehouse Code
      *   |- c2    : DTL.Scheduled Ship Date NE DTL.Scheduled Ship Date U
      *   |- c5    : DTL.Requested Delivery Date NE WRK.Requested Deliver
      *   |- c6    : DTL.Requested Delivery Time NE DTL.USR Time 4.0
      *   |- c7    : DTL.Requested Ship Date NE DTL.USR Requested ship da
      *   '-
     C           #DAJCD    IFNE #DCPCD                     *IF
     C           #1AODT    ORNE #DHODT                     *OR
     C           #1EIDT    ORNE WUAYDZ                     *OR
     C           #1AFTM    ORNE #DT4TM                     *OR
     C           #1A5DT    ORNE #DCZDT                     *OR
      * ** Must Ship Date will be zeros and error if no Miles Between Cit
      * CLC Must Ship 4 Req DlvXF - Order Header TRG  * 
     C                     CALL 'PMUSXFR'              90  CLC Must Ship 4
     C                     PARM *BLANK    W0RTN   7
     C           WUB7SX    PARM *BLANK    WQ0085  3        Must Ship Error
     C                     PARM #1C4NB    WQ0086  70       Order Number
     C                     PARM #1A5DT    WQ0087  70       Requested Ship
     C                     PARM #1HNNA    WQ0088 20        Ship To City
     C                     PARM #1DBCD    WQ0089  2        Ship To State C
     C                     PARM #1AIC3    WQ0090  30       Company Number
     C                     PARM #1AFTM    WQ0091  40       Requested Deliv
     C                     PARM #1AODT    WQ0092  70       Scheduled Ship
     C                     PARM #1EIDT    WQ0093  70       Requested Deliv
     C           #DAJCD    PARM #DAJCD    WQ0094  3        Warehouse Code
     C           YL0008    PARM YL0008    WQ0095  70       Must Ship Date
     C           YL0009    PARM YL0009    WQ0096  60       Must Ship Time
     C                     PARM WUMPNB    WQ0097  70       USR Order Numbe
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMUSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993635*
     C                     SETON                     3437  *
     C                     END
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0098  30       Company Number
     C                     PARM *BLANK    WQ0099  1        Plant Company S
     C           P3YJSX    PARM *BLANK    WQ0100  1        Company Organiz
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Process date order error for must ship
      * CASE:
      *  - c1 OR c2 OR (c4 AND c3)
      *   |- c1    : WRK.Must Ship Error is No Error
      *   |- c2    : PAR.Company Organization is Not Seaboard
      *   |- c4    : PAR.Country Code          USR is Entered
      *   |- c3    : PAR.Country Code          USR is Not USA
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB7SX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P3YJSX    IFEQ 'D'                        *IF
     C           P3YJSX    OREQ 'H'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2A5AA    IFNE *BLANK                     *IF
     C           P2A5AA    IFNE 'USA'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *                do nothing
      *     if Dailys or High Plains Diesel or international account
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Load ID EQ WRK.ZERO
     C           #1RMNB    IFEQ WUW0NB                     *IF
      * ** If not yet assigned to a load, allow to accept the invalid dat
      * PMT Must Ship Dt Accpt IF - Order Header TRG  * 
     C                     EXSR TJINFN
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Error if assigned to a load and has an invalid date
      * ** Unlock the date field so it can be changed       E00147 LJB 4/
      * PMT Must Ship Dt NotifyPV - Order Header TRG  * 
     C                     CALL 'PDKLPVR'              90  PMT Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1EIDT    WQ0109  70       Requested Deliv
     C                     PARM YL0008    WQ0110  70       Must Ship Date
     C                     PARM #1A5DT    WQ0111  70       Requested Ship
     C                     PARM YL0009    WQ0112  60       Must Ship Time
     C                     PARM #1AFTM    WQ0113  40       Requested Deliv
     C                     PARM WUB7SX    WQ0114  3        Must Ship Error
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKLPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993436*
     C                     SETON                     35    *
     C                     END
      * RTV Stop Number       RT - Load Detail          TRG  * 
     C                     EXSR TKRVGN
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADDWURVNB    PBRVNB           Stop/Drop
     C                     MOVEL'DEADLN'  PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVEL*BLANK    PBMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * NOTE:  Will only write log if order on load and load not in E sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Delivery Date cannot be before Requested Ship Date      S00346
      * CASE: DTL.Requested Delivery Date LT DTL.Requested Ship Date
     C           #1EIDT    IFLT #1A5DT                     *IF
      * ** Do not allow the Delivery date to be before the Ship Date. Unl
      * ** the field if there is an error so it can be corrected.   FP125
      * Setup message data for message
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0022
      * Send message 'Req Deliv dt is afte ship'
     C                     MOVEL'USR3963' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
      * Validate warehouse code
      * CASE: DTL.Warehouse Code EQ WRK.BLANK
     C           #DAJCD    IFEQ WUGSTX                     *IF
      * Error if 1 whse per order
      * CASE: PAR.Allow Mult Whse to Order is no
     C           P3HSST    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0023           Warehouse Code
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse Exists   RT - Warehouse  * 
     C                     EXSR TLRVGN
      * Error if warehouse not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0024           Warehouse Code
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Acct&Ship Co      RT - Warehouse  * 
     C                     EXSR TMRVGN
      * CASE: DTL.Billing Activity Type is Warehouse Transfer
     C           #1OBST    IFEQ '4'                        *IF
      * Screen warehouse (from) = warehouse in co/cust file (to)
      * CASE: DTL.Warehouse Code EQ WRK.USR Warehouse Code
     C           #DAJCD    IFEQ WUCPCD                     *IF
      * Setup message data for message
      * Send message 'Warehouse must differ tr.'
     C                     MOVEL'USR0433' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR TNRVGN
      * Val Acctg Co on from whse on screen must = acctg Co on to whse on
      * CASE: WRK.Accounting Company NE WRK.Company Number Select
     C           WUBTC3    IFNE WUAOC3                     *IF
      * This validation added 08/01/07 RMC
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0025           Warehouse Code
     C                     MOVELWUCPCD    ZA0026           USR Warehouse C
      * Send message 'Warehouse fr/to comp err'
     C                     MOVEL'USR3772' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
      * CASE: WRK.Shipping Company NE DTL.Company Number
     C           WUBWC3    IFNE #1AIC3                     *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0027           Warehouse Code
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0028           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0028           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Warehouse cant ship f/co'
     C                     MOVEL'USR3362' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * PKTR01 Validate Whse with Shipping Co               7/27/04
      * CASE: WRK.Shipping Company NE DTL.Company Number
     C           WUBWC3    IFNE #1AIC3                     *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0029           Warehouse Code
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0030           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0030           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Warehouse cant ship f/co'
     C                     MOVEL'USR3362' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate P.O requirement
      * CASE: P.O. Required, not entered
      *  - c1 AND c2
      *   |- c1    : WRK.P.O. Required Flag is yes
      *   |- c2    : DTL.Customer Purchase Order # EQ WRK.BLANK
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUPPST    IFEQ 'Y'                        *IF
     C           #1BCNA    IFEQ WUGSTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.Block Order Flag is Firm Order
     C           #1BCST    IFEQ 'F'                        *IF
      * Setup message data for message
     C                     MOVEL#1BCNA    ZA0031           Customer Purcha
      * Send message 'P.O. Required'
     C                     MOVEL'USR1243' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate absorbed freight rate
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Absorbed Freight Rate is EQ Zeros
     C           #1TBNB    IFEQ *ZERO                      *IF
      * RTV Abs Freight Rate   RT - Company/Customer  * 
     C                     EXSR TORVGN
     C                     END                             *FI
     C                     END                             *FI
      * Determine Carrier - If ship method is collect then carrier must b
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      * ** Change carrier to BUY if collect   FT686 LJB 01/03/2008
     C                     MOVEL'BUY'     #1BZNA           Carrier Code
     C                     END                             *FI
      * ** If Collect Truck or Rail then default carrier to "BUY"
      * CASE: PAR.Shipping Method is Collect
     C           P1Q2CD    IFEQ 'CR'                       *IF
     C           P1Q2CD    OREQ 'CT'
      * CASE: DTL.Shipping Method is Collect
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      * ** 11/16/2007 LJB FP1251 Carrier must be BUY if ship meth = colle
     C                     MOVEL'BUY'     #1BZNA           Carrier Code
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If Ship Method changed from Collect to Prepaid
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
      * ** If changed from Collect to Prepaid, blank out the carrier code
      * CASE: PAR.Shipping Method is Collect
     C           P1Q2CD    IFEQ 'CR'                       *IF
     C           P1Q2CD    OREQ 'CT'
      * CASE: DTL.Shipping Method is Prepaid
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'
      * ** If Ship Method changed from Collect to Prepaid   E00127 LJB 04
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
      * Edit for Transfer In Storage
      * CASE: DTL.Transfer in Storage Ind is Yes
     C           #1FNSX    IFEQ 'Y'                        *IF
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1Q2CD    ZA0032           Shipping Method
      * Send message 'Transfer In Storage must'
     C                     MOVEL'USR2866' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Export Status
      * CASE: PAR.Export Status is yes
     C           P1U2ST    IFEQ 'Y'                        *IF
      * CASE: DTL.Export Status is no
     C           #1U2ST    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    #DKXCD           Country Code
     C                     END                             *FI
     C                     END                             *FI
      * Export Docs Go w/Driver
      * CASE: DTL.Export Status is no
     C           #1U2ST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       #1FQSX           Export Docs Go
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Order Types
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9933  *
     C                     END
      * Check reference to Customer
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9936  *
     C                     END
      * Check reference to Calendar
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Terms
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Carrier
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to OP Reason Codes
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9934  *
     C                     END
      * Check reference to Enterprise Master
     C                     EXSR VQCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Load Header
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Sales Route
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Manager Level
     C                     EXSR VTCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to VP Level
     C                     EXSR VUCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Order Header TRG
     C                     EXSR VVCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Internal Reason
     C                     EXSR VWCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VXCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Event Types
     C                     EXSR VYCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to A/R Claim
     C                     EXSR VZCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9952  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * Change mode processing
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * Validate item balances exist if change warehouse
      * CASE: DTL.Warehouse Code NE DTL.USR Warehouse Code
     C           #DAJCD    IFNE #DCPCD                     *IF
      * VAL Itm Bals-Whs Chg   XF - OP Order Header  * 
     C                     CALL 'PDG3XFR'              90  VAL Itm Bals-Wh
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0139  30       Company Number
     C                     PARM #1C4NB    WQ0140  70       Order Number
     C                     PARM #DAJCD    WQ0141  3        Warehouse Code
     C           WUECST    PARM *BLANK    WQ0142  1        Error Status
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DAJCD    ZA0033           Warehouse Code
      * Send message 'IC Item Balance Not Fnd E'
     C                     MOVEL'USR2261' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** If changed from Collect to Prepaid, blank out the carrier code
      * CASE: PAR.Shipping Method is Collect
     C           P1Q2CD    IFEQ 'CR'                       *IF
     C           P1Q2CD    OREQ 'CT'
      * CASE: DTL.Shipping Method is Prepaid
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'
      * ** If Ship Method changed from Collect to Prepaid   E00127 LJB 04
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
      * F16=Load Planning
      * CASE: DTL.*CMD key is *Work With Loads
     C           *IN16     IFEQ '1'                        *IF
      * RTV Chk Detail Exists  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0052           Company Number
     C                     Z-ADD#1C4NB    WL0053           Order Number
     C                     EXSR TPRVGN
      * Msg 'Order has no line items' E00180 RMC 7/08/08
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Send message 'Order has no line items!'
     C                     MOVEL'USR3962' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * call load plan pgm in command key section
     C                     END                             *FI
     C                     END                             *FI
      * 10/16/08 PKD Added to default Y for Docs go with Driver if
      *              export and air frieght.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Air Freight Order is yes
      *   |- c2    : DTL.Export Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FTSX    IFEQ 'Y'                        *IF
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       #1FQSX           Export Docs Go
     C                     END                             *FI
     C                     END
      * USR Company Number required
     C           #DFKNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Type - Sales required
     C           #1JNCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Requested Delivery Date required
     C           #1EIDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Requested Delivery Time required
     C           #1AFTM    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Requested Ship Date required
     C           #1A5DT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9936  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Shipping Temp Code C/F required
     C           #1FRSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9939  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Shipping Method required
     C           #1Q2CD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9940  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Salesperson Code required
     C           #DBCCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9941  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Export Status required
     C           #1U2ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9944  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Export Docs Go w/Driver required
     C           #1FQSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9946  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Block Order Flag required
     C           #1BCST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9947  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * LTL Flag required
     C           #1PJST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9948  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Certification Flag required
     C           #1BDST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9949  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Transfer in Storage Ind required
     C           #1FNSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9950  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * Increment # Orders YTD on Add - Create Events record
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     EXSR TQCRRC
     C                     END                             *FI
      * Dealloc/Allocate details and Load/Order Change Log if whse change
      * CASE: Warehouse change
      *  - c3 AND c1
      *   |- c3    : PGM.*Program mode is *CHANGE
      *   |- c1    : DTL.Warehouse Code NE DTL.USR Warehouse Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0PMD     IFEQ 'CHG'                      *IF
     C           #DAJCD    IFNE #DCPCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Download Delete    XF - AS Order Header  * 
     C                     CALL 'PDCFXFR'              90  UPD Download De
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0143  70       Load ID
     C                     PARM #1AIC3    WQ0144  30       Company Number
     C                     PARM #1C4NB    WQ0145  70       Order Number
     C                     PARM #DAJCD    WQ0146  3        Warehouse Code
     C                     PARM #DCPCD    WQ0147  3        USR Warehouse C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
      * UPD Dealloc/Allocate   XF - PD Order Header  * 
     C                     CALL 'PDPJXFR'              90  UPD Dealloc/All
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0148  30       Company Number
     C                     PARM #1C4NB    WQ0149  70       Order Number
     C                     PARM *ZERO     WQ0150  30       Order Sequence
     C                     PARM *ZERO     WQ0151  30       Order Secondary
     C                     PARM #DAJCD    WQ0152  3        Warehouse Code
     C                     PARM #DHODT    WQ0153  70       Deallocate Date
     C                     PARM #1AODT    WQ0154  70       Allocate Date U
     C           WUG0TX    PARM WUG0TX    WQ0155  1        Production Hold
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     MOVEL'CHGWHS'  WURVST           Load Change Typ
      * ** Reverse FP1061 - Department control code MUST be Traffic
      * ** Do not change this per Gary Martin.     E-TRANS47 LJB 01/03/20
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVEL#DCPCD    PBMNTX    P      Change Log Prio
     C                     MOVEL#DAJCD    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
      * NOTE:  Will only write log if order on load and load not in E sta
     C                     MOVEL#DAJCD    #DCPCD           USR Warehouse C
     C                     END                             *FI
      * Ship date change
      * CASE: DTL.Requested Ship Date NE DTL.USR Requested ship date s
     C           #1A5DT    IFNE #DCZDT                     *IF
      * If header sts is entered then reallocate else just change req shi
      * CASE: DTL.Header Status is Entered
     C           #1GWST    IFEQ 'E'                        *IF
      * CHG Rqs Ship Dte/Alloc RT - PD Order Detail  * 
     C                     EXSR TRRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Requested Ship Dt  RT - Order Detail  * 
     C                     EXSR TTRVGN
     C                     END                             *FI
     C                     END                             *FI
      * *********
      * E00180 RMC 8/05/08 moved here so it will be done before F16 Load
      * CLC Tot Ord Val Ship   XF - PD Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0164  30       Company Number
     C                     PARM #1C4NB    WQ0165  70       Order Number
     C           #1JZVA    PARM #1JZVA    WQ0166 112       USR Order Value
     C           #1A1WG    PARM #1A1WG    WQ0167 112       USR Order Weigh
     C           WUG0TX    PARM WUG0TX    WQ0168  1        USR Production
     C           WUG0TX    PARM WUG0TX    WQ0169  1        USR Update Flag
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Order Value,Wgt    CH - PD Order Header  * 
     C                     EXSR TVCHRC
      * Update load with order's weight; update load's total miles, ship
      * CASE: DTL.Load ID NE WRK.ZERO
     C           #1RMNB    IFNE WUW0NB                     *IF
      * RTV UPD Ld Abs.Frt/Wgt XF - Order Header TRG  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0170  70       Load ID
     C           WURPNB    PARM WURPNB    WQ0171  70       Total Load Orde
     C           WURQNB    PARM WURQNB    WQ0172 112       Total Freight
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *********
      * Update details with changed export code
      * CASE: Country code changed
      *  - c1 AND c2
      *   |- c1    : PGM.*Program mode is *CHANGE
      *   |- c2    : DTL.Country Code NE DTL.USR Export Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0PMD     IFEQ 'CHG'                      *IF
     C           #DKXCD    IFNE #DUFCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Export Code        RT - PD Order Detail  * 
     C                     EXSR TWRVGN
     C                     END                             *FI
      * Update load header if shipping temperature changed
      * CASE: Ship Temp Changed and order on a load
      *  - (c1 OR c3 ) AND c2
      *   |- c1    : DTL.Reefer Temperature NE PAR.Reefer Temperature
      *   |- c3    : DTL.Shipping Temp Code C/F NE PAR.Shipping Temp Code
      *   |- c2    : DTL.Load ID NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1RNNB    IFNE P1RNNB                     *IF
     C           #1FRSX    ORNE P1FRSX                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1RMNB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Min Temp for Load RT - Order Header TRG  * 
     C                     EXSR TYRVGN
      * CHG Shipping Temp      CH - Load Header  * 
     C                     EXSR TZCHRC
     C                     Z-ADD#1RNNB    P1RNNB           Reefer Temperat
     C                     MOVEL#1FRSX    P1FRSX           Shipping Temp C
     C                     END                             *FI
      * Update Load Header Shipping Method if Load ID is not blank
      * CASE: DTL.Load ID is Blank
     C           #1RMNB    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If shipping method was Collect and now is Prepaid
      * CASE: PAR.Shipping Method is Buyers Truck
     C           P1Q2CD    IFEQ 'CR'                       *IF
     C           P1Q2CD    OREQ 'CT'
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
     C                     ELSE
      * CASE: *OTHERWISE
      * If shipping method changed to prepaid and carrier is blank
      * CASE: DTL.Carrier Code is not entered
     C           #1BZNA    IFEQ *BLANK                     *IF
      * ** E-TRANS47 - Report carrier changes to Traffic (do not change t
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'SHPMTH'  YL0013           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELYL0013    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELP1Q2CD    PBMNTX    P      Change Log Prio
     C                     MOVEL#1Q2CD    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
      * ** This CHGOBJ writes the carrier change to the load order chg lo
      * ** Change the Shipping Method if Changed from CT to PT     FP1251
      * CHG Carrier/Broker     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0054           Load ID
     C                     MOVEL#1BZNA    WL0055    P      Carrier Code
     C                     MOVEL#1BZNA    WL0056    P      Carrier Broker
     C                     Z-ADD#1C4NB    WL0057           Order Number
     C                     MOVELWUUJST    WL0058    P      Department Cont
     C                     EXSR NACHRC
      * CHG Ship Method        CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0059           Load ID
     C                     MOVEL#1Q2CD    WL0060    P      Shipping Method
     C                     EXSR NBCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Log entry if carrier code has changed
      * CASE: DTL.Carrier Code NE LCL.Carrier Code Chg Usr 1
     C           #1BZNA    IFNE YL0001                     *IF
      * ** E-TRANS47 - Report carrier changes to Traffic (do not change t
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'SHPMTH'  YL0013           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELYL0013    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELP1Q2CD    PBMNTX    P      Change Log Prio
     C                     MOVEL#1Q2CD    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
      * ** This CHGOBJ writes the carrier change to the load order chg lo
      * ** Change the Shipping Method if Changed from CT to PT   FP1251
      * CHG Carrier/Broker     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0054           Load ID
     C                     MOVEL#1BZNA    WL0055    P      Carrier Code
     C                     MOVEL#1BZNA    WL0056    P      Carrier Broker
     C                     Z-ADD#1C4NB    WL0057           Order Number
     C                     MOVELWUUJST    WL0058    P      Department Cont
     C                     EXSR NACHRC
      * CHG Ship Method        CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0059           Load ID
     C                     MOVEL#1Q2CD    WL0060    P      Shipping Method
     C                     EXSR NBCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If shipping method was prepaid and changed to collect
      * CASE: DTL.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      * ** FT686 - Report carrier changes to Traffic (do not change this)
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL'SHPMTH'  YL0013           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELYL0013    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELP1Q2CD    PBMNTX    P      Change Log Prio
     C                     MOVEL#1Q2CD    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
      * CHG Carrier/Broker     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0054           Load ID
     C                     MOVEL#1BZNA    WL0055    P      Carrier Code
     C                     MOVEL#1BZNA    WL0056    P      Carrier Broker
     C                     Z-ADD#1C4NB    WL0057           Order Number
     C                     MOVELWUUJST    WL0058    P      Department Cont
     C                     EXSR NACHRC
      * ** Change the Shipping Method if Changed from PT to CT
      * CHG Ship Method        CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0059           Load ID
     C                     MOVEL#1Q2CD    WL0060    P      Shipping Method
     C                     EXSR NBCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update Load/Order Change Log if requested delivery date/time chan
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Program mode is *CHANGE
      *   |- c2    : DTL.Requested Delivery Date NE WRK.Requested Deliver
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0PMD     IFEQ 'CHG'                      *IF
     C           #1EIDT    IFNE WUAYDZ                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'RQSDLV'  WURVST           Load Change Typ
      * ** Reverse FP1061 - All date changes are to be reported to
      * ** Traffic per Gary Martin. Do Not Change this. E-TRANS47 LJB 01/
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUMNTX           Change Log Prio
     C                     MOVELWUAYDZ    WUMNTX           Change Log Prio
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVEL#1EIDT    WUMOTX           Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWUMNTX    PBMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * NOTE:  Will only write log if order on load and load not in E sta
      * CASE: DTL.Load ID is NE Blank
     C           #1RMNB    IFNE *ZERO                      *IF
      * UPD Rqs Deliv Date/1st XF - OM Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADD#1RMNB    PCRMNB           Load ID
      *
     C                     CALL 'PDFFXFR'              90  UPD Rqs Deliv D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     Z-ADD#1EIDT    WUAYDZ           Requested Deliv
     C                     END                             *FI
     C                     Z-ADD#1C4NB    P1C4NB           Order Number
     C                     MOVEL#1BCNA    P1BCNA           Customer Purcha
     C                     MOVEL#DAJCD    P5AJCD           Warehouse Code
     C                     MOVEL#DKXCD    P5KXCD           Country Code
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * F13=Shipping Instructions
      * CASE: DTL.*CMD key is *Shipping Instructions
     C           *IN13     IFEQ '1'                        *IF
      * EDT Shipping Inst.     EF - PD Shipping Instructions  * 
     C                     CLEARPDRC
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
     C                     Z-ADD*ZERO     PDDXNB           Sequence Number
      *
     C                     CALL 'PDAEEFR'              90  EDT Shipping In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Shipping I
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAEEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F14=Header Comments
      * CASE: DTL.*CMD key is *Header Comments
     C           *IN14     IFEQ '1'                        *IF
      * EDT OP Order Comment   EF - OP Order Comment  * 
     C                     CALL 'PDAGEFR'              90  EDT OP Order Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0173  30       Company Number
     C                     PARM #1C4NB    WQ0174  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAGEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F15=More Header
      * CASE: DTL.*CMD key is *Order Header
     C           *IN15     IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
     C                     MOVEL'PDSVE1R' P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F16=Load Planning
      * CASE: DTL.*CMD key is *Work With Loads
     C           *IN16     IFEQ '1'                        *IF
      * RTV Chk Detail Exists  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0052           Company Number
     C                     Z-ADD#1C4NB    WL0053           Order Number
     C                     EXSR TPRVGN
      * Msg 'Order has no line items' E00180 RMC 7/08/08
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * error msg wont work here. its in the detail screen relations sect
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Add company# and order# to parms being passed    LJB 08/31/06
      * WW Loads Order Entry   DF - Load Header  * 
     C                     CALL 'PDFKDFR'              90  WW Loads Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0175  70       USR Load ID
     C                     PARM #1AIC3    WQ0176  30       Company Number
     C                     PARM #1C4NB    WQ0177  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFKDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * F17=Export Doc
      * CASE: DTL.*CMD key is CF17
     C           *IN17     IFEQ '1'                        *IF
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
     C                     MOVEL'POIRXFR' P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Export document not allwd'
     C                     MOVEL'USR3026' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * F18=Details
      * CASE: DTL.*CMD key is *Order Details
     C           *IN18     IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
     C                     MOVEL'PDN9EFR' P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F19=Pick Comments
      * CASE: DTL.*CMD key is CF19
     C           *IN19     IFEQ '1'                        *IF
      * Edt Customer Comment  EF - Customer Comment  * 
     C                     CLEARPERC
     C                     Z-ADD#1BKC7    PEBKC7           Ship To Custome
     C                     MOVEL'PI'      PEI1SX    P      Comment Type
      *
     C                     CALL 'POF9EFR'              90  Edt Customer Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Customer C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POF9EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
      * F20=Post Order
      * CASE: DTL.*CMD key is *Post/Update Open Order
     C           *IN20     IFEQ '1'                        *IF
      * Post Order.
     C                     EXSR UCSUBR                     Post Order.
     C                     END                             *FI
     C           W0PMD     IFEQ 'ADD'
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
     C                     END
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * CRT Order Header&DlvPO XF - Order Header TRG  * 
     C                     CALL 'PMDIXFR'              90  CRT Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0218  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0219  70       Order Number
     C                     PARM #1JNCD    WQ0220  2        Order Type - Sa
     C                     PARM #1ANC7    WQ0221  70       A/R Customer Nu
     C                     PARM #1BKC7    WQ0222  70       Ship To Custome
     C                     PARM WUBTC7    WQ0223  70       Parent Customer
     C                     PARM #1BRTX    WQ0224 30        Ship To Name
     C                     PARM #1HMNA    WQ0225 30        Ship To Address
     C                     PARM #1HONA    WQ0226 30        Ship To Address
     C                     PARM #1HPNA    WQ0227 30        Ship To Address
     C                     PARM #1HNNA    WQ0228 20        Ship To City
     C                     PARM #1DBCD    WQ0229  2        Ship To State C
     C                     PARM #1CKTX    WQ0230 11        Ship To Zip/Pos
     C                     PARM #1B0C7    WQ0231  70       Bill to Custome
     C                     PARM #1AETX    WQ0232 30        Bill to Name
     C                     PARM #1B1NA    WQ0233 30        Bill to Address
     C                     PARM #1B3NA    WQ0234 30        Bill to Address
     C                     PARM #1B4NA    WQ0235 30        Bill to Address
     C                     PARM #1B2NA    WQ0236 20        Bill to City
     C                     PARM #1BHCD    WQ0237  2        Bill to State C
     C                     PARM #1C8TX    WQ0238 11        Bill to Zip/Pos
     C                     PARM #1BCNA    WQ0239 15        Customer Purcha
     C                     PARM #1A0DT    WQ0240  70       Order Date
     C                     PARM #1A5DT    WQ0241  70       Requested Ship
     C                     PARM #1GNDT    WQ0242  70       Actual Shipped
     C                     PARM *ZERO     WQ0243  70       Cancel Date
     C                     PARM #1AQCD    WQ0244  2        Terms Code
     C                     PARM #1B6NA    WQ0245 40        Special Instruc
     C                     PARM #1BYNA    WQ0246 40        Special Instruc
     C                     PARM #1BZNA    WQ0247  3        Carrier Code
     C                     PARM #1GTST    WQ0248  1        Comment Print A
     C                     PARM #1GVST    WQ0249  1        Comment Print I
     C                     PARM #1GUST    WQ0250  1        Comment Print P
     C                     PARM #1QFST    WQ0251  1        Comment Print S
     C                     PARM #1CQCD    WQ0252  3        Reason Code
     C                     PARM 'Y'       WQ0253  1        Order in Use
     C                     PARM #1GWST    WQ0254  1        Header Status
     C                     PARM #1GXST    WQ0255  1        Header Status L
     C                     PARM 'N'       WQ0256  1        Order Type Prin
     C                     PARM #1AODT    WQ0257  70       Scheduled Ship
     C                     PARM #1AIVN    WQ0258 10        User Original E
     C                     PARM #1CXDT    WQ0259  70       Date of Origina
     C                     PARM #1JZVA    WQ0260 112       Order Value Tot
     C                     PARM #1A1WG    WQ0261 112       Order Weight To
     C                     PARM 'N'       WQ0262  1        Credit Hold
     C                     PARM 'N'       WQ0263  1        Production Hold
     C                     PARM 'N'       WQ0264  1        New Customer Ho
     C                     PARM #1EIDT    WQ0265  70       Requested Deliv
     C                     PARM #1AFTM    WQ0266  40       Requested Deliv
     C                     PARM #1E8CD    WQ0267  4        Accounts Receiv
     C                     PARM #1E9CD    WQ0268 12        Accounts Receiv
     C                     PARM #1RMNB    WQ0269  70       Load ID
     C                     PARM #1TBNB    WQ0270  52       Absorbed Freigh
     C                     PARM #1R1NB    WQ0271 112       Rated Freight
     C                     PARM #1PJST    WQ0272  1        LTL Flag
     C                     PARM *BLANK    WQ0273  1        Price Audit
     C                     PARM 'U'       WQ0274  1        Price Status
     C                     PARM #1Q2CD    WQ0275  2        Shipping Method
     C                     PARM #1U2ST    WQ0276  1        Export Status
     C                     PARM #1VEST    WQ0277  1        Palletize
     C                     PARM #1VFST    WQ0278  1        Shrink Wrap
     C                     PARM #1VGST    WQ0279  1        Slip Sheet
     C                     PARM #1RPCD    WQ0280  1        Age Code
     C                     PARM #1RNNB    WQ0281  52       Reefer Temperat
     C                     PARM #1VDST    WQ0282  1        Load Type
     C                     PARM #1ATIN    WQ0283  70       Attach to Invoi
     C                     PARM #1U4ST    WQ0284  1        Load Plan Order
     C                     PARM #1U5ST    WQ0285  1        Print Pick Slip
     C                     PARM #1RSRN    WQ0286  70       Resell Referenc
     C                     PARM #1MHNA    WQ0287 30        Special Comment
     C                     PARM #1MINA    WQ0288 30        Special Comment
     C                     PARM #1WBST    WQ0289  1        Affect Auto Acc
     C                     PARM #1R4CD    WQ0290  3        Sales Route Cod
     C                     PARM #1BFCD    WQ0291  2        Manager Level C
     C                     PARM #1Q4CD    WQ0292  3        VP Level Code
     C                     PARM #1T3NB    WQ0293  70       Attach to Order
     C                     PARM #1SICD    WQ0294  3        Reason for Pric
     C                     PARM #1CONB    WQ0295  70       Invoice Number
     C                     PARM #1CEST    WQ0296  2        Invoice Suffix
     C                     PARM #1AWDT    WQ0297  70       Invoice Date
     C                     PARM #1JPCD    WQ0298  2        Event Code
     C                     PARM #1XUST    WQ0299  1        Trans Contol AS
     C                     PARM #1Z1ST    WQ0300  1        Modified Flag
     C                     PARM #1VRVA    WQ0301 112       A/R order Value
     C                     PARM #1OBST    WQ0302  1        Billing Activit
     C                     PARM #1BCST    WQ0303  1        Block Order Fla
     C                     PARM #1BDST    WQ0304  1        Order Certifica
     C                     PARM #1B7VL    WQ0305 112       Invoice Order V
     C                     PARM #1GASX    WQ0306  1        Invoice Price T
     C                     PARM #1GBSX    WQ0307  1        Order Conf Fax
     C                     PARM #1GCSX    WQ0308  1        Manifest Fax St
     C                     PARM #1GDSX    WQ0309  1        Invoice Fax Sts
     C                     PARM #1FNSX    WQ0310  1        Transfer in Sto
     C                     PARM #1FOSX    WQ0311  1        Email Cust On O
     C                     PARM #1FPSX    WQ0312  1        Order Emailed
     C                     PARM #1FQSX    WQ0313  1        Export Docs Go
     C                     PARM #1FRSX    WQ0314  1        Shipping Temp C
     C                     PARM #1FSSX    WQ0315  1        Broker Order St
     C                     PARM #1FTSX    WQ0316  1        Air Freight Ord
     C                     PARM #1FUSX    WQ0317  2        Signal Demand S
     C                     PARM #1FVSX    WQ0318  2        EDI Nistevo Sel
     C                     PARM #1FWSX    WQ0319  2        Export USDA App
     C                     PARM #1FXSX    WQ0320  3        Unused OH Code
     C                     PARM #1FYSX    WQ0321  3        OH TF Exempt Co
     C                     PARM #1NODT    WQ0322  70       OH Unused Date
     C                     PARM #1NPDT    WQ0323  70       OH Unused Date
     C                     PARM #1NQDT    WQ0324  70       OH Unused Date
     C                     PARM #1NRDT    WQ0325  70       OH Unused Date
     C                     PARM #1NSDT    WQ0326  70       OH Unused Date
     C                     PARM #1BPTM    WQ0327  60       Maximum Gross W
     C                     PARM #1BQTM    WQ0328  60       Time of Origina
     C                     PARM #1BRTM    WQ0329  60       OH Unused Time
     C                     PARM #1BSTM    WQ0330  60       OH Unused Time
     C                     PARM #1BTTM    WQ0331  60       OH Unused Time
     C                     PARM #1H0NX    WQ0332 112       Act Frt Referen
     C                     PARM #1H1NX    WQ0333 112       Act Non-Ref Frt
     C                     PARM #1H2NX    WQ0334 112       OH Fuel Surchar
     C                     PARM #1H3NX    WQ0335 112       OH Total Non-Re
     C                     PARM #1H4NX    WQ0336 112       OH Total Ref Fr
     C                     PARM #1C0C7    WQ0337  70       Claim Number
     C                     PARM #1UVST    WQ0338  1        EDI Status 1
     C                     PARM #1UWST    WQ0339  1        EDI Status 2
     C                     PARM #1UXST    WQ0340  1        EDI Status 3
     C           #DNLTX    PARM #DNLTX    WQ0341 38        Delivery P.O. N
     C                     PARM WUCHST    WQ0342  1        Auto Order Numb
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993332*
     C                     SETON                     433651*
     C                     SETON                     533435*
     C                     SETON                     484044*
     C                     SETON                     384749*
     C                     END
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Order Header&DlvPO XF - Order Header TRG  * 
     C                     CALL 'PMDHXFR'              90  Chg Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0343  30       Company Number
     C                     PARM #1C4NB    WQ0344  70       Order Number
     C                     PARM #1JNCD    WQ0345  2        Order Type - Sa
     C                     PARM #1ANC7    WQ0346  70       A/R Customer Nu
     C                     PARM #1BKC7    WQ0347  70       Ship To Custome
     C                     PARM WUBTC7    WQ0348  70       Parent Customer
     C                     PARM #1BRTX    WQ0349 30        Ship To Name
     C                     PARM #1HMNA    WQ0350 30        Ship To Address
     C                     PARM #1HONA    WQ0351 30        Ship To Address
     C                     PARM #1HPNA    WQ0352 30        Ship To Address
     C                     PARM #1HNNA    WQ0353 20        Ship To City
     C                     PARM #1DBCD    WQ0354  2        Ship To State C
     C                     PARM #1CKTX    WQ0355 11        Ship To Zip/Pos
     C                     PARM #1B0C7    WQ0356  70       Bill to Custome
     C                     PARM #1AETX    WQ0357 30        Bill to Name
     C                     PARM #1B1NA    WQ0358 30        Bill to Address
     C                     PARM #1B3NA    WQ0359 30        Bill to Address
     C                     PARM #1B4NA    WQ0360 30        Bill to Address
     C                     PARM #1B2NA    WQ0361 20        Bill to City
     C                     PARM #1BHCD    WQ0362  2        Bill to State C
     C                     PARM #1C8TX    WQ0363 11        Bill to Zip/Pos
     C                     PARM #1BCNA    WQ0364 15        Customer Purcha
     C                     PARM #1A0DT    WQ0365  70       Order Date
     C                     PARM #1A5DT    WQ0366  70       Requested Ship
     C                     PARM #1GNDT    WQ0367  70       Actual Shipped
     C                     PARM #1ACDT    WQ0368  70       Cancel Date
     C                     PARM #1AQCD    WQ0369  2        Terms Code
     C                     PARM #1B6NA    WQ0370 40        Special Instruc
     C                     PARM #1BYNA    WQ0371 40        Special Instruc
     C                     PARM #1BZNA    WQ0372  3        Carrier Code
     C                     PARM #1GTST    WQ0373  1        Comment Print A
     C                     PARM #1GVST    WQ0374  1        Comment Print I
     C                     PARM #1GUST    WQ0375  1        Comment Print P
     C                     PARM #1QFST    WQ0376  1        Comment Print S
     C                     PARM #1CQCD    WQ0377  3        Reason Code
     C                     PARM #1GJST    WQ0378  1        Order in Use
     C                     PARM #1GWST    WQ0379  1        Header Status
     C                     PARM #1GXST    WQ0380  1        Header Status L
     C                     PARM #1GYST    WQ0381  1        Order Type Prin
     C                     PARM #1AODT    WQ0382  70       Scheduled Ship
     C                     PARM #1AIVN    WQ0383 10        User Original E
     C                     PARM #1CXDT    WQ0384  70       Date of Origina
     C                     PARM #1JZVA    WQ0385 112       Order Value Tot
     C                     PARM #1A1WG    WQ0386 112       Order Weight To
     C                     PARM #1XIST    WQ0387  1        Credit Hold
     C                     PARM #1XJST    WQ0388  1        Production Hold
     C                     PARM #1XKST    WQ0389  1        New Customer Ho
     C                     PARM #1EIDT    WQ0390  70       Requested Deliv
     C                     PARM #1AFTM    WQ0391  40       Requested Deliv
     C                     PARM #1E8CD    WQ0392  4        Accounts Receiv
     C                     PARM #1E9CD    WQ0393 12        Accounts Receiv
     C                     PARM #1RMNB    WQ0394  70       Load ID
     C                     PARM #1TBNB    WQ0395  52       Absorbed Freigh
     C                     PARM #1R1NB    WQ0396 112       Rated Freight
     C                     PARM #1PJST    WQ0397  1        LTL Flag
     C                     PARM #1U0ST    WQ0398  1        Price Audit
     C                     PARM #1U1ST    WQ0399  1        Price Status
     C                     PARM #1Q2CD    WQ0400  2        Shipping Method
     C                     PARM #1U2ST    WQ0401  1        Export Status
     C                     PARM #1VEST    WQ0402  1        Palletize
     C                     PARM #1VFST    WQ0403  1        Shrink Wrap
     C                     PARM #1VGST    WQ0404  1        Slip Sheet
     C                     PARM #1RPCD    WQ0405  1        Age Code
     C                     PARM #1RNNB    WQ0406  52       Reefer Temperat
     C                     PARM #1VDST    WQ0407  1        Load Type
     C                     PARM #1ATIN    WQ0408  70       Attach to Invoi
     C                     PARM #1U4ST    WQ0409  1        Load Plan Order
     C                     PARM #1U5ST    WQ0410  1        Print Pick Slip
     C                     PARM #1RSRN    WQ0411  70       Resell Referenc
     C                     PARM #1MHNA    WQ0412 30        Special Comment
     C                     PARM #1MINA    WQ0413 30        Special Comment
     C                     PARM #1WBST    WQ0414  1        Affect Auto Acc
     C                     PARM #1R4CD    WQ0415  3        Sales Route Cod
     C                     PARM #1BFCD    WQ0416  2        Manager Level C
     C                     PARM #1Q4CD    WQ0417  3        VP Level Code
     C                     PARM #1T3NB    WQ0418  70       Attach to Order
     C                     PARM #1SICD    WQ0419  3        Reason for Pric
     C                     PARM #1CONB    WQ0420  70       Invoice Number
     C                     PARM #1CEST    WQ0421  2        Invoice Suffix
     C                     PARM #1AWDT    WQ0422  70       Invoice Date
     C                     PARM #1JPCD    WQ0423  2        Event Code
     C                     PARM #1XUST    WQ0424  1        Trans Contol AS
     C                     PARM #1Z1ST    WQ0425  1        Modified Flag
     C                     PARM #1VRVA    WQ0426 112       A/R order Value
     C                     PARM #1OBST    WQ0427  1        Billing Activit
     C                     PARM #1BCST    WQ0428  1        Block Order Fla
     C                     PARM #1BDST    WQ0429  1        Order Certifica
     C                     PARM #1B7VL    WQ0430 112       Invoice Order V
     C                     PARM #1GASX    WQ0431  1        Invoice Price T
     C                     PARM #1GBSX    WQ0432  1        Order Conf Fax
     C                     PARM #1GCSX    WQ0433  1        Manifest Fax St
     C                     PARM #1GDSX    WQ0434  1        Invoice Fax Sts
     C                     PARM #1FNSX    WQ0435  1        Transfer in Sto
     C                     PARM #1FOSX    WQ0436  1        Email Cust On O
     C                     PARM #1FPSX    WQ0437  1        Order Emailed
     C                     PARM #1FQSX    WQ0438  1        Export Docs Go
     C                     PARM #1FRSX    WQ0439  1        Shipping Temp C
     C                     PARM #1FSSX    WQ0440  1        Broker Order St
     C                     PARM #1FTSX    WQ0441  1        Air Freight Ord
     C                     PARM #1FUSX    WQ0442  2        Signal Demand S
     C                     PARM #1FVSX    WQ0443  2        EDI Nistevo Sel
     C                     PARM #1FWSX    WQ0444  2        Export USDA App
     C                     PARM #1FXSX    WQ0445  3        Unused OH Code
     C                     PARM #1FYSX    WQ0446  3        OH TF Exempt Co
     C                     PARM #1NODT    WQ0447  70       OH Unused Date
     C                     PARM #1NPDT    WQ0448  70       OH Unused Date
     C                     PARM #1NQDT    WQ0449  70       OH Unused Date
     C                     PARM #1NRDT    WQ0450  70       OH Unused Date
     C                     PARM #1NSDT    WQ0451  70       OH Unused Date
     C                     PARM #1BPTM    WQ0452  60       Maximum Gross W
     C                     PARM #1BQTM    WQ0453  60       Time of Origina
     C                     PARM #1BRTM    WQ0454  60       OH Unused Time
     C                     PARM #1BSTM    WQ0455  60       OH Unused Time
     C                     PARM #1BTTM    WQ0456  60       OH Unused Time
     C                     PARM #1H0NX    WQ0457 112       Act Frt Referen
     C                     PARM #1H1NX    WQ0458 112       Act Non-Ref Frt
     C                     PARM #1H2NX    WQ0459 112       OH Fuel Surchar
     C                     PARM #1H3NX    WQ0460 112       OH Total Non-Re
     C                     PARM #1H4NX    WQ0461 112       OH Total Ref Fr
     C                     PARM #1C0C7    WQ0462  70       Claim Number
     C                     PARM #1UVST    WQ0463  1        EDI Status 1
     C                     PARM #1UWST    WQ0464  1        EDI Status 2
     C                     PARM #1UXST    WQ0465  1        EDI Status 3
     C                     PARM #DNLTX    WQ0466 38        Delivery P.O. N
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993332*
     C                     SETON                     433651*
     C                     SETON                     533435*
     C                     SETON                     484044*
     C                     SETON                     384749*
     C                     END
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YIRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1AIC3    IFEQ *ZERO                      Company Number
     C           P1C4NB    OREQ *ZERO                      Order Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           WUTIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           #1BCST    IFEQ *BLANK                     *IF
     C           #1BCST    OREQ 'F'
     C           #1BCST    OREQ 'N'
     C           #1BCST    OREQ 'Y'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUTIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C                     MOVEL'0'       *IN75
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'1'       *IN77
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           WUF4ST    IFEQ 'L'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           P3HSST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           #DWKCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           WUE5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           WUTJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     Z-ADD*ZERO     #DT4TM           USR Time 4.0
     C                     Z-ADD*ZERO     #DCZDT           USR Requested s
     C                     Z-ADD*ZERO     #DHODT           Scheduled Ship
     C                     MOVEL*BLANK    #DCPCD           USR Warehouse C
     C                     MOVEL*BLANK    #1FSSX           Broker Order St
     C                     MOVEL*BLANK    #DC4T1           Broker Name
     C                     Z-ADD*ZERO     #1ANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     #1B7VL           Invoice Order V
     C                     MOVEL*BLANK    #1GASX           Invoice Price T
     C                     MOVEL*BLANK    #1GBSX           Order Conf Fax
     C                     MOVEL*BLANK    #1GCSX           Manifest Fax St
     C                     MOVEL*BLANK    #1GDSX           Invoice Fax Sts
     C                     MOVEL*BLANK    #1FOSX           Email Cust On O
     C                     MOVEL*BLANK    #1FPSX           Order Emailed
     C                     MOVEL*BLANK    #1FTSX           Air Freight Ord
     C                     MOVEL*BLANK    #1FUSX           Signal Demand S
     C                     MOVEL*BLANK    #1FVSX           EDI Nistevo Sel
     C                     MOVEL*BLANK    #1FWSX           Export USDA App
     C                     MOVEL*BLANK    #1FXSX           Unused OH Code
     C                     MOVEL*BLANK    #1FYSX           OH TF Exempt Co
     C                     Z-ADD*ZERO     #1NODT           OH Unused Date
     C                     Z-ADD*ZERO     #1NPDT           OH Unused Date
     C                     Z-ADD*ZERO     #1NQDT           OH Unused Date
     C                     Z-ADD*ZERO     #1NRDT           OH Unused Date
     C                     Z-ADD*ZERO     #1NSDT           OH Unused Date
     C                     Z-ADD*ZERO     #1BPTM           Maximum Gross W
     C                     Z-ADD*ZERO     #1BQTM           Time of Origina
     C                     Z-ADD*ZERO     #1BRTM           OH Unused Time
     C                     Z-ADD*ZERO     #1BSTM           OH Unused Time
     C                     Z-ADD*ZERO     #1BTTM           OH Unused Time
     C                     Z-ADD*ZERO     #1H0NX           Act Frt Referen
     C                     Z-ADD*ZERO     #1H1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     #1H2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     #1H3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     #1H4NX           OH Total Ref Fr
     C                     MOVEL*BLANK    #DUFCD           USR Export Code
     C                     Z-ADD*ZERO     #1A0DT           Order Date
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     Z-ADD*ZERO     #1ACDT           Cancel Date
     C                     MOVEL*BLANK    #1AQCD           Terms Code
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #1GTST           Comment Print A
     C                     MOVEL*BLANK    #1GVST           Comment Print I
     C                     MOVEL*BLANK    #1GUST           Comment Print P
     C                     MOVEL*BLANK    #1QFST           Comment Print S
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1GJST           Order in Use
     C                     MOVEL*BLANK    #1GWST           Header Status
     C                     MOVEL*BLANK    #1GXST           Header Status L
     C                     MOVEL*BLANK    #1GYST           Order Type Prin
     C                     MOVEL*BLANK    #1AIVN           User Original E
     C                     Z-ADD*ZERO     #1CXDT           Date of Origina
     C                     MOVEL*BLANK    #1XIST           Credit Hold
     C                     MOVEL*BLANK    #1XJST           Production Hold
     C                     MOVEL*BLANK    #1XKST           New Customer Ho
     C                     MOVEL*BLANK    #1E8CD           Accounts Receiv
     C                     MOVEL*BLANK    #1E9CD           Accounts Receiv
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1U0ST           Price Audit
     C                     MOVEL*BLANK    #1U1ST           Price Status
     C                     MOVEL*BLANK    #1VEST           Palletize
     C                     MOVEL*BLANK    #1VFST           Shrink Wrap
     C                     MOVEL*BLANK    #1VGST           Slip Sheet
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     Z-ADD*ZERO     #1ATIN           Attach to Invoi
     C                     MOVEL*BLANK    #1U4ST           Load Plan Order
     C                     MOVEL*BLANK    #1U5ST           Print Pick Slip
     C                     Z-ADD*ZERO     #1RSRN           Resell Referenc
     C                     MOVEL*BLANK    #1MHNA           Special Comment
     C                     MOVEL*BLANK    #1MINA           Special Comment
     C                     MOVEL*BLANK    #1WBST           Affect Auto Acc
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1BFCD           Manager Level C
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     Z-ADD*ZERO     #1T3NB           Attach to Order
     C                     MOVEL*BLANK    #1SICD           Reason for Pric
     C                     Z-ADD*ZERO     #1CONB           Invoice Number
     C                     MOVEL*BLANK    #1CEST           Invoice Suffix
     C                     Z-ADD*ZERO     #1AWDT           Invoice Date
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     MOVEL*BLANK    #1XUST           Trans Contol AS
     C                     MOVEL*BLANK    #1Z1ST           Modified Flag
     C                     Z-ADD*ZERO     #1VRVA           A/R order Value
     C                     MOVEL*BLANK    #1OBST           Billing Activit
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #DFKNB           USR Company Num
      * Clear external version also
     C                     MOVEL*BLANK    VDFKNB
     C                     Z-ADDP1BKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     Z-ADD*ZERO     #1B0C7           Bill to Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1B0C7
     C                     MOVEL*BLANK    #1AETX           Bill to Name
     C                     MOVEL*BLANK    #1HMNA           Ship To Address
     C                     MOVEL*BLANK    #1B1NA           Bill to Address
     C                     MOVEL*BLANK    #1HONA           Ship To Address
     C                     MOVEL*BLANK    #1B3NA           Bill to Address
     C                     MOVEL*BLANK    #1HPNA           Ship To Address
     C                     MOVEL*BLANK    #1B4NA           Bill to Address
     C                     MOVEL*BLANK    #1HNNA           Ship To City
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     MOVEL*BLANK    #1CKTX           Ship To Zip/Pos
     C                     MOVEL*BLANK    #1B2NA           Bill to City
     C                     MOVEL*BLANK    #1BHCD           Bill to State C
     C                     MOVEL*BLANK    #1C8TX           Bill to Zip/Pos
     C                     MOVEL*BLANK    #DBVTX           Telephone Numbe
     C                     MOVEL*BLANK    #DVR01           Reference. . .
     C                     MOVEL*BLANK    #1JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     Z-ADD*ZERO     #1AFTM           Requested Deliv
     C                     Z-ADD*ZERO     #1A5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1A5DT
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     MOVEL*BLANK    #DAJCD           Warehouse Code
     C                     MOVEL*BLANK    #DWKCD           To Warehouse Co
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #1FRSX           Shipping Temp C
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     MOVEL*BLANK    #DBCCD           Salesperson Cod
     C                     MOVEL*BLANK    #DALTX           Salesperson Nam
     C                     MOVEL*BLANK    #DNLTX           USR 15 Text
     C                     MOVEL*BLANK    #1BCNA           Customer Purcha
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     MOVEL*BLANK    #DKXCD           Country Code
     C                     MOVEL*BLANK    #1FQSX           Export Docs Go
     C                     MOVEL*BLANK    #1BCST           Block Order Fla
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     MOVEL*BLANK    #1BDST           Order Certifica
     C                     MOVEL*BLANK    #1FNSX           Transfer in Sto
     C                     MOVEL*BLANK    #1B6NA           Special Instruc
     C                     Z-ADD*ZERO     #1C0C7           Claim Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C0C7
     C                     MOVEL*BLANK    #1BYNA           Special Instruc
     C                     Z-ADD*ZERO     #1JZVA           Order Value Tot
     C                     Z-ADD*ZERO     #1A1WG           Order Weight To
     C                     Z-ADD*ZERO     #DCDWG           USR Weight Accu
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BECPFK fields to screen
      *================================================================
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Invoice Price T
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Signal Demand S
     C                     MOVELBEFVSX    #1FVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           Unused OH Code
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Unused Date
     C                     Z-ADDBENPDT    #1NPDT           OH Unused Date
     C                     Z-ADDBENQDT    #1NQDT           OH Unused Date
     C                     Z-ADDBENRDT    #1NRDT           OH Unused Date
     C                     Z-ADDBENSDT    #1NSDT           OH Unused Date
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Unused Time
     C                     Z-ADDBEBSTM    #1BSTM           OH Unused Time
     C                     Z-ADDBEBTTM    #1BTTM           OH Unused Time
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELP2APTX    #PAPTX           Company Name
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
      * USER: Initialize key screen
      * CASE: WRK.Allow Multi-Company is no
     C           WUI6ST    IFEQ 'N'                        *IF
     C                     Z-ADDWUAIC3    #1AIC3           Company Number
     C                     ELSE
      * CASE: WRK.Allow Multi-Company is yes
     C           WUI6ST    IFEQ 'Y'                        *IF
      * CASE: KEY.Company Number is Equal to zero
     C           #1AIC3    IFEQ *ZERO                      *IF
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * CASE: KEY.Company Number is Equal to zero
     C           #1AIC3    IFEQ *ZERO                      *IF
     C                     Z-ADDWUAIC3    #1AIC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0030           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    #PAPTX    P      Name
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert USR Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #DFKNB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#DFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VDFKNB           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDFKNB           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1B0C7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1B0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1B0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A5DT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Claim Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C0C7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C0C7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * CHG Carrier/Broker     CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0774  30       Company Number
     C                     Z-ADD*ZERO     WN0775  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0776  1        LTL Flag
     C                     MOVEL*BLANK    WN0777  1        Load Status
     C                     Z-ADD*ZERO     WN0778  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0779 15        Seal 1
     C                     MOVEL*BLANK    WN0780 15        Seal 2
     C                     MOVEL*BLANK    WN0781 15        Seal 3
     C                     MOVEL*BLANK    WN0782 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0783 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0784  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0785 112       Flat Amount
     C                     MOVEL*BLANK    WN0786  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0787  50       Total Stops
     C                     MOVEL*BLANK    WN0788 20        Trailer Id
     C                     MOVEL*BLANK    WN0789  3        Initials of Con
     C                     Z-ADD*ZERO     WN0790  40       BOL Time
     C                     MOVEL*BLANK    WN0791  7        Truck Size
     C                     Z-ADD*ZERO     WN0792  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0793 112       Rated Freight
     C                     MOVEL*BLANK    WN0794  1        Ship Status
     C                     MOVEL*BLANK    WN0795  1        Load Type
     C                     Z-ADD*ZERO     WN0796  50       Number Pallets
     C                     Z-ADD*ZERO     WN0797  50       Number Pallets
     C                     Z-ADD*ZERO     WN0798 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0799  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0800  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0801  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0802 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0803 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0804  70       Actual Departur
     C                     Z-ADD*ZERO     WN0805  40       Departure Time
     C                     Z-ADD*ZERO     WN0806  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0807  52       Product Tempera
     C                     Z-ADD*ZERO     WN0808  50       Number Pallets
     C                     MOVEL*BLANK    WN0809 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0810  70       Total Load Mile
     C                     MOVEL*BLANK    WN0811 12        Recorder ID
     C                     MOVEL*BLANK    WN0812  2        Shipping Method
     C                     MOVEL*BLANK    WN0813  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0814  2        Ship To State C
     C                     Z-ADD*ZERO     WN0815  70       Gross Weight
     C                     MOVEL*BLANK    WN0816  1        Export Status
     C                     Z-ADD*ZERO     WN0817  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0818  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0819  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0820  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0821  70       Spotted Date
     C                     Z-ADD*ZERO     WN0822  60       Spotted Time
     C                     Z-ADD*ZERO     WN0823  70       Load Finished D
     C                     Z-ADD*ZERO     WN0824  60       Load Finished T
     C                     Z-ADD*ZERO     WN0825  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0826  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0827  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0828  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0829  70       Truck Departure
     C                     Z-ADD*ZERO     WN0830  60       Truck Departure
     C                     Z-ADD*ZERO     WN0831  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0832  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0833  3        Shipping Line
     C                     MOVEL*BLANK    WN0834 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0835 30        Vessel Name
     C                     Z-ADD*ZERO     WN0836  50       Voyage
     C                     Z-ADD*ZERO     WN0837  70       Sail Date
     C                     MOVEL*BLANK    WN0838 12        Booking Number
     C                     MOVEL*BLANK    WN0839 20        Discharge Port
     C                     Z-ADD*ZERO     WN0840  70       Arrival Date
     C                     MOVEL*BLANK    WN0841 12        Container Numbe
     C                     Z-ADD*ZERO     WN0842  70       Date In
     C                     Z-ADD*ZERO     WN0843  60       Time In
     C                     Z-ADD*ZERO     WN0844  70       Date Out
     C                     Z-ADD*ZERO     WN0845  60       Time Out
     C                     Z-ADD*ZERO     WN0846 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0847  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0848  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0849  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0850  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0851  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0852  70       Requested Deliv
     C                     MOVEL*BLANK    WN0853  1        Load Acceptance
     C                     MOVEL*BLANK    WN0854  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0855  70       On Yard Date
     C                     Z-ADD*ZERO     WN0856  60       On Yard Time
     C                     Z-ADD*ZERO     WN0857  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0858  60       Deadline Depart
     C                     MOVEL*BLANK    WN0859  1        Load Held Over
     C                     MOVEL*BLANK    WN0860  1        Load Held Over
     C                     MOVEL*BLANK    WN0861 15        Load Held Over
     C                     MOVEL*BLANK    WN0862 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0863 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0864  70       Express Mail Da
     C                     MOVEL*BLANK    WN0865  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0866  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0867  70       Product Complet
     C                     Z-ADD*ZERO     WN0868  60       Product Complet
     C                     Z-ADD*ZERO     WN0869  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0870  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0871  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0872  1        Load Confirmed
     C                     MOVEL*BLANK    WN0873 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0874  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0875  60       Load Door 1
     C                     Z-ADD*ZERO     WN0876  70       Override Total
     C                     Z-ADD*ZERO     WN0877  60       Load Door 2
     C                     MOVEL*BLANK    WN0878  1        Partial Load
     C                     MOVEL*BLANK    WN0879  1        Load Confirmati
     C                     MOVEL*BLANK    WN0880  1        Export Load USD
     C                     MOVEL*BLANK    WN0881  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0882 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0883 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0884 15        Late Billing Em
     C                     MOVEL*BLANK    WN0885 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0886 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0887  1        Multi Company L
     C                     MOVEL*BLANK    WN0888  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0889  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0890  1        LH Unused Sts 3
     C                     MOVEL*BLANK    WN0891  1        LH Unused Sts 4
     C                     MOVEL*BLANK    WN0892  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0893  2        Load U/M
     C                     MOVEL*BLANK    WN0894  2        LH Unused Sts 7
     C                     MOVEL*BLANK    WN0895  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0896  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0897  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0898  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0899  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0900  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0901  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0902  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0903  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0904  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0905  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0906  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0907  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0908  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0909  60       LH Unused Time
     C                     MOVEL*BLANK    WN0910  1        EDI Status 1
     C                     MOVEL*BLANK    WN0911  1        EDI Status 2
     C                     MOVEL*BLANK    WN0912  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0913  60       Job Time
     C                     MOVEL*BLANK    WN0914 10        User Id
     C                     MOVEL*BLANK    WN0915 10        Job Name
     C                     Z-ADD*ZERO     WN0916  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0054    WGRMNB           Load ID
      *
     C           KLCHNA    KLIST
     C                     KFLD           WGRMNB           Load ID
     C           KLCHNA    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YHRDCS
      * USER: Processing after Data read
      * Save copy of fields written to Load Order Change Log
      * CASE: *OTHERWISE
     C                     MOVELWGBZNA    YL0014           Carrier Code
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0055    WGBZNA    P      Carrier Code
     C                     MOVELWL0056    WGXCCD    P      Carrier Broker
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Check for carrier change for Load Order Header Change Log
      * CASE: *OTHERWISE
      * 10/17/2007 change to put in the job user and job program name
      * Carrier Code
      * CASE: PAR.Carrier Code NE LCL.Carrier Code
     C           WL0055    IFNE YL0014                     *IF
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWGRMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVEL'CARCHG'  PBRVST    P      Load Change Typ
     C                     MOVELWL0058    PBUJST    P      Department Cont
     C                     MOVELYL0014    PBMNTX    P      Change Log Prio
     C                     MOVELWL0055    PBMOTX    P      Change Log New
     C                     MOVEL##JOB     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELWGBZNA    PBBZNA    P      Carrier Code
     C                     Z-ADDWGAIC3    PBAIC3           Company Number
     C                     Z-ADDWL0057    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBCHRC    BEGSR
      *================================================================
      * CHG Ship Method        CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0917  30       Company Number
     C                     Z-ADD*ZERO     WN0918  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0919  1        LTL Flag
     C                     MOVEL*BLANK    WN0920  1        Load Status
     C                     Z-ADD*ZERO     WN0921  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0922 15        Seal 1
     C                     MOVEL*BLANK    WN0923 15        Seal 2
     C                     MOVEL*BLANK    WN0924 15        Seal 3
     C                     MOVEL*BLANK    WN0925 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0926 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0927  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0928 112       Flat Amount
     C                     MOVEL*BLANK    WN0929  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0930  50       Total Stops
     C                     MOVEL*BLANK    WN0931 20        Trailer Id
     C                     MOVEL*BLANK    WN0932  3        Initials of Con
     C                     Z-ADD*ZERO     WN0933  40       BOL Time
     C                     MOVEL*BLANK    WN0934  3        Carrier Code
     C                     MOVEL*BLANK    WN0935  7        Truck Size
     C                     Z-ADD*ZERO     WN0936  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0937 112       Rated Freight
     C                     MOVEL*BLANK    WN0938  1        Ship Status
     C                     MOVEL*BLANK    WN0939  1        Load Type
     C                     Z-ADD*ZERO     WN0940  50       Number Pallets
     C                     Z-ADD*ZERO     WN0941  50       Number Pallets
     C                     Z-ADD*ZERO     WN0942 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0943  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0944  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0945  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0946 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0947 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0948  70       Actual Departur
     C                     Z-ADD*ZERO     WN0949  40       Departure Time
     C                     Z-ADD*ZERO     WN0950  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0951  52       Product Tempera
     C                     Z-ADD*ZERO     WN0952  50       Number Pallets
     C                     MOVEL*BLANK    WN0953 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0954  70       Total Load Mile
     C                     MOVEL*BLANK    WN0955 12        Recorder ID
     C                     MOVEL*BLANK    WN0956  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0957  2        Ship To State C
     C                     Z-ADD*ZERO     WN0958  70       Gross Weight
     C                     MOVEL*BLANK    WN0959  3        Carrier Broker
     C                     MOVEL*BLANK    WN0960  1        Export Status
     C                     Z-ADD*ZERO     WN0961  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0962  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0963  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0964  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0965  70       Spotted Date
     C                     Z-ADD*ZERO     WN0966  60       Spotted Time
     C                     Z-ADD*ZERO     WN0967  70       Load Finished D
     C                     Z-ADD*ZERO     WN0968  60       Load Finished T
     C                     Z-ADD*ZERO     WN0969  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0970  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0971  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0972  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0973  70       Truck Departure
     C                     Z-ADD*ZERO     WN0974  60       Truck Departure
     C                     Z-ADD*ZERO     WN0975  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0976  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0977  3        Shipping Line
     C                     MOVEL*BLANK    WN0978 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0979 30        Vessel Name
     C                     Z-ADD*ZERO     WN0980  50       Voyage
     C                     Z-ADD*ZERO     WN0981  70       Sail Date
     C                     MOVEL*BLANK    WN0982 12        Booking Number
     C                     MOVEL*BLANK    WN0983 20        Discharge Port
     C                     Z-ADD*ZERO     WN0984  70       Arrival Date
     C                     MOVEL*BLANK    WN0985 12        Container Numbe
     C                     Z-ADD*ZERO     WN0986  70       Date In
     C                     Z-ADD*ZERO     WN0987  60       Time In
     C                     Z-ADD*ZERO     WN0988  70       Date Out
     C                     Z-ADD*ZERO     WN0989  60       Time Out
     C                     Z-ADD*ZERO     WN0990 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0991  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0992  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0993  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0994  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0995  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0996  70       Requested Deliv
     C                     MOVEL*BLANK    WN0997  1        Load Acceptance
     C                     MOVEL*BLANK    WN0998  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0999  70       On Yard Date
     C                     Z-ADD*ZERO     WN1000  60       On Yard Time
     C                     Z-ADD*ZERO     WN1001  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1002  60       Deadline Depart
     C                     MOVEL*BLANK    WN1003  1        Load Held Over
     C                     MOVEL*BLANK    WN1004  1        Load Held Over
     C                     MOVEL*BLANK    WN1005 15        Load Held Over
     C                     MOVEL*BLANK    WN1006 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1007 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1008  70       Express Mail Da
     C                     MOVEL*BLANK    WN1009  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1010  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1011  70       Product Complet
     C                     Z-ADD*ZERO     WN1012  60       Product Complet
     C                     Z-ADD*ZERO     WN1013  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1014  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1015  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1016  1        Load Confirmed
     C                     MOVEL*BLANK    WN1017 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1018  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1019  60       Load Door 1
     C                     Z-ADD*ZERO     WN1020  70       Override Total
     C                     Z-ADD*ZERO     WN1021  60       Load Door 2
     C                     MOVEL*BLANK    WN1022  1        Partial Load
     C                     MOVEL*BLANK    WN1023  1        Load Confirmati
     C                     MOVEL*BLANK    WN1024  1        Export Load USD
     C                     MOVEL*BLANK    WN1025  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1026 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1027 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1028 15        Late Billing Em
     C                     MOVEL*BLANK    WN1029 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1030 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1031  1        Multi Company L
     C                     MOVEL*BLANK    WN1032  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1033  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1034  1        LH Unused Sts 3
     C                     MOVEL*BLANK    WN1035  1        LH Unused Sts 4
     C                     MOVEL*BLANK    WN1036  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1037  2        Load U/M
     C                     MOVEL*BLANK    WN1038  2        LH Unused Sts 7
     C                     MOVEL*BLANK    WN1039  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1040  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1041  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1042  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1043  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1044  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1045  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1046  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1047  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1048  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1049  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1050  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1051  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1052  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1053  60       LH Unused Time
     C                     MOVEL*BLANK    WN1054  1        EDI Status 1
     C                     MOVEL*BLANK    WN1055  1        EDI Status 2
     C                     MOVEL*BLANK    WN1056  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1057  60       Job Time
     C                     MOVEL*BLANK    WN1058 10        User Id
     C                     MOVEL*BLANK    WN1059 10        Job Name
     C                     Z-ADD*ZERO     WN1060  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0059    WGRMNB           Load ID
      *
     C           KLCHNB    KLIST
     C                     KFLD           WGRMNB           Load ID
     C           KLCHNB    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YIRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0060    WGQ2CD    P      Shipping Method
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * Val Order Hdr Exists   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSNC     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN1061    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSND     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WUI6ST           Allow Multi-Com
     C                     MOVELDRMPNA    WUMPNA           Default Printer
     C                     MOVELDRBCCD    WUBCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0015           Company Number
     C                     MOVELDRBUVN    WN1062           User Code Model
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0061    DTAJVN           User Profile Na
     C                     MOVELWL0062    DTDNCD           Application Cod
      * Establish starting position
     C           KRSNE     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0063           Company Number
     C                     MOVELDTAJCD    WL0064           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTBWC3    WQNF01           Shipping Compan
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF01           Shipping Compan
      * Setup key
     C                     Z-ADDYL0015    WQNF01           Shipping Compan
      * Establish starting position
     C           KRSNF     SETLL@ADREWA                    *
     C           KRSNF     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAJCD           Warehouse Code
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WTVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WTAOCD    IFNE *BLANK                     *IF
     C                     MOVELWTAOCD    WUAJCD           Warehouse Code
     C                     GOTO NFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNF     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNG01           Application Cod
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           WQNG01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQNG01           Application Cod
     C                     MOVEL'OMS'     WQNG01           Application Cod
      * Establish starting position
     C           KRSNG     SETLL@DNRESF                    *
     C           KRSNG     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR NHRVGN
     C                     END                             *FI
     C           KRSNG     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNH01           Application Cod
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WQNH01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQNH01           Application Cod
      * Establish starting position
     C           KRSNH     SETLL@DNRESF                    *
     C           KRSNH     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSNH     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * RTV Dflt Type for Co   RT - Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           C0AJVN           User Profile Na
     C                     KFLD           C0DNCD           Application Cod
     C                     KFLD           C0AIC3           Company Number
      * Setup key
     C                     MOVEL##USR     C0AJVN           User Profile Na
     C                     MOVE *BLANK    C0DNCD           Application Cod
     C                     MOVEL'O/P'     C0DNCD           Application Cod
     C                     Z-ADDP1AIC3    C0AIC3           Company Number
      * Establish starting position
     C           KRSNI     CHAIN@C0REO4              90    *
      * Data record not found
     C   90                MOVEL'USR0527' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC0JNCD    WUJNCD           Order Type - Sa
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * RTV OP status          RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    ASAIC3           Company Number
      * Establish starting position
     C           KRSNJ     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELASCHST    WUCHST           Auto Order Numb
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * RTV Next Order Number  RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADD*ZERO     ASAIC3           Company Number
      * Establish starting position
     C           KRSNK     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDASC5NB    P1C4NB           Next Order Numb
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - PD Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELWL0001    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSA     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Salesperson Cod
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEBCCD    WL0002           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVELWL0003    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSB     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Salesperson Cod
     C                     MOVEL*BLANK    WL0004           Salesperson Nam
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPBCCD    WL0003           Salesperson Cod
     C                     MOVELAPALTX    WL0004           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSC01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSC02           Order Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSC01           Company Number
     C                     Z-ADDBEC4NB    WQSC02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSC     SETLL@BGWKAE                    *
     C           KRSSC     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAJCD           Warehouse Code
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SDRVGN
      * PAR = DB1 By name
     C                     MOVELOMAJCD    #DAJCD           Warehouse Code
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Telephone Number   RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDBEBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@BBREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBVTX           Telephone Numbe
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBBVTX    #DBVTX           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Cust Ordering Dflt RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0005    EOAIC3           Company Number
     C                     Z-ADDWL0006    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@EOREUB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Terms Code
     C                     MOVEL*BLANK    WL0008           Sales Route Cod
     C                     MOVEL*BLANK    WL0009           Special Instruc
     C                     MOVEL*BLANK    WL0010           Special Instruc
     C                     MOVEL*BLANK    WL0011           Carrier Code
     C                     MOVEL*BLANK    WL0012           P.O. Required F
     C                     Z-ADD*ZERO     WL0013           Deliver after t
     C                     MOVEL*BLANK    WL0014           Type Code
     C                     Z-ADD*ZERO     WL0015           Absorbed Freigh
     C                     Z-ADD*ZERO     WL0016           Mileage To Cust
     C                     MOVEL*BLANK    WL0017           Age Code
     C                     MOVEL*BLANK    WL0018           Warehouse Code
     C                     MOVEL*BLANK    WL0019           Outside Warehou
     C                     MOVEL*BLANK    WL0020           Customer Group
     C                     MOVEL*BLANK    WL0021           Customer Group
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOAQCD    WL0007           Terms Code
     C                     MOVELEOR4CD    WL0008           Sales Route Cod
     C                     MOVELEOBYNA    WL0009           Special Instruc
     C                     MOVELEOB6NA    WL0010           Special Instruc
     C                     MOVELEOBZNA    WL0011           Carrier Code
     C                     MOVELEOPPST    WL0012           P.O. Required F
     C                     Z-ADDEOR5NB    WL0013           Deliver after t
     C                     MOVELEOBOCD    WL0014           Type Code
     C                     Z-ADDEOTBNB    WL0015           Absorbed Freigh
     C                     Z-ADDEOMTCU    WL0016           Mileage To Cust
     C                     MOVELEORPCD    WL0017           Age Code
     C                     MOVELEOAJCD    WL0018           Warehouse Code
     C                     MOVELEOX9ST    WL0019           Outside Warehou
     C                     MOVELEOT9CD    WL0020           Customer Group
     C                     MOVELEOUBCD    WL0021           Customer Group
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0022    KMAIC3           Company Number
     C                     MOVELWL0023    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSG     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    WL0024           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Ord Hdr Val/Wgt    rt - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSH02           Order Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSH01           Company Number
     C                     Z-ADD#1C4NB    WQSH02           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
      * Establish starting position
     C           KPSSH     SETLL@BGWKKK                    *
     C           KRSSH     READE@BGWKKK                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WAD0WG    #DCDWG           USR Order Weigh
     C           KRSSH     READE@BGWKKK                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Nbr of Orders/Load RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUMCNB           Number of Order
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSI01           Load ID
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Load ID
      * Setup key
     C                     Z-ADDBERMNB    WQSI01           Load ID
      * Establish starting position
     C           KRSSI     SETLL@FLCPBW                    *
     C           KRSSI     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUMCNB           Number of Order
     C           KRSSI     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0025    WBAIC3           Company Number
     C                     Z-ADDWL0026    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSJ     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0027           Warehouse Code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAJCD    WL0027           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Shipping Co Dft    RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCBKC7    WQSK01           Ship To Custome
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Ship To Custome
      * Setup key
     C                     Z-ADDWL0029    WQSK01           Ship To Custome
      * Establish starting position
     C           KRSSK     SETLL@EOREIQ                    *
     C           KRSSK     READE@EOREIQ                  90*
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Default Shipping Co Sts is Yes
     C           WCQ8ST    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDWCAIC3    WL0028           Company Number
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@EOREIQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0030    ABAIC3           Company Number
      * Establish starting position
     C           KRSSL     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0031           Name
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0031           Name
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           EXJNCD           Order Type - Sa
      * Setup key
     C                     MOVEL#1JNCD    EXJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSM     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEXOBST    #1OBST           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Cust Addr, A/R Cst RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0032    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSN     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAYTX    WL0033           Customer Name
     C                     MOVELWDACNA    WL0034           Address Line 1
     C                     MOVELWDADNA    WL0035           Address Line 2
     C                     MOVELWDAENA    WL0036           Address Line 3
     C                     MOVELWDAJNA    WL0037           City
     C                     MOVELWDBGCD    WL0038           State Code
     C                     MOVELWDBTTX    WL0039           Zip/Postal Code
     C                     Z-ADDWDANC7    WL0040           A/R Customer Nu
     C                     MOVELWDQWST    WL0041           Email When Orde
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Cust Name/Addr     RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0042    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSO     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAYTX    WL0043           Customer Name
     C                     MOVELWDACNA    WL0044           Address Line 1
     C                     MOVELWDADNA    WL0045           Address Line 2
     C                     MOVELWDAENA    WL0046           Address Line 3
     C                     MOVELWDAJNA    WL0047           City
     C                     MOVELWDBGCD    WL0048           State Code
     C                     MOVELWDBTTX    WL0049           Zip/Postal Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUWPST           Warehouse Type
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WUWPST           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Customer Air Frt  RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSQ     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P1FTSX           Air Freight Ord
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNEP0SX    P1FTSX           Air Freight Ord
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSR     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUPKST           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    WUPKST           Load Status
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * CHG Load ID            CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0002  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Order in Use
     C                     MOVEL*BLANK    WN0034  1        Header Status
     C                     MOVEL*BLANK    WN0035  1        Header Status L
     C                     MOVEL*BLANK    WN0036  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     Z-ADD*ZERO     WN0040 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0041 112       Order Weight To
     C                     MOVEL*BLANK    WN0042  1        Credit Hold
     C                     MOVEL*BLANK    WN0043  1        Production Hold
     C                     MOVEL*BLANK    WN0044  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0045  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0046  40       Requested Deliv
     C                     MOVEL*BLANK    WN0047  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0048 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0049  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0050 112       Rated Freight
     C                     MOVEL*BLANK    WN0051  1        LTL Flag
     C                     MOVEL*BLANK    WN0052  1        Price Audit
     C                     MOVEL*BLANK    WN0053  1        Price Status
     C                     MOVEL*BLANK    WN0054  2        Shipping Method
     C                     MOVEL*BLANK    WN0055  1        Export Status
     C                     MOVEL*BLANK    WN0056  1        Palletize
     C                     MOVEL*BLANK    WN0057  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0058  1        Slip Sheet
     C                     MOVEL*BLANK    WN0059  1        Age Code
     C                     Z-ADD*ZERO     WN0060  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0061  1        Load Type
     C                     Z-ADD*ZERO     WN0062  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0063  1        Load Plan Order
     C                     MOVEL*BLANK    WN0064  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0065  70       Resell Referenc
     C                     MOVEL*BLANK    WN0066 30        Special Comment
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  2        Manager Level C
     C                     MOVEL*BLANK    WN0071  3        VP Level Code
     C                     Z-ADD*ZERO     WN0072  70       Attach to Order
     C                     MOVEL*BLANK    WN0073  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0074  70       Invoice Number
     C                     MOVEL*BLANK    WN0075  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0076  70       Invoice Date
     C                     MOVEL*BLANK    WN0077  2        Event Code
     C                     MOVEL*BLANK    WN0078  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0079  1        Modified Flag
     C                     Z-ADD*ZERO     WN0080 112       A/R order Value
     C                     MOVEL*BLANK    WN0081  1        Billing Activit
     C                     MOVEL*BLANK    WN0082  1        Block Order Fla
     C                     MOVEL*BLANK    WN0083  1        Order Certifica
     C                     Z-ADD*ZERO     WN0084 112       Invoice Order V
     C                     MOVEL*BLANK    WN0085  1        Invoice Price T
     C                     MOVEL*BLANK    WN0086  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0087  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0088  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0089  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0090  1        Email Cust On O
     C                     MOVEL*BLANK    WN0091  1        Order Emailed
     C                     MOVEL*BLANK    WN0092  1        Export Docs Go
     C                     MOVEL*BLANK    WN0093  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0094  1        Broker Order St
     C                     MOVEL*BLANK    WN0095  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0096  2        Signal Demand S
     C                     MOVEL*BLANK    WN0097  2        EDI Nistevo Sel
     C                     MOVEL*BLANK    WN0098  2        Export USDA App
     C                     MOVEL*BLANK    WN0099  3        Unused OH Code
     C                     MOVEL*BLANK    WN0100  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0101  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0102  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0103  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0104  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0105  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0106  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0107  60       Time of Origina
     C                     Z-ADD*ZERO     WN0108  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0109  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0110  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0111 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0112 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0113 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0114 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0115 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0116  70       Claim Number
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      *
     C           KLCHSS    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHSS    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     BERMNB           Load ID
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##PGM     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDBEAIC3    PAAIC3           Company Number
     C                     Z-ADDBEC4NB    PAC4NB           Order Number
     C                     MOVELBEJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDBEANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    PABKC7           Ship To Custome
     C                     MOVELBEBRTX    PABRTX    P      Ship To Name
     C                     MOVELBEHMNA    PAHMNA    P      Ship To Address
     C                     MOVELBEHONA    PAHONA    P      Ship To Address
     C                     MOVELBEHPNA    PAHPNA    P      Ship To Address
     C                     MOVELBEHNNA    PAHNNA    P      Ship To City
     C                     MOVELBEDBCD    PADBCD    P      Ship To State C
     C                     MOVELBECKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDBEB0C7    PAB0C7           Bill to Custome
     C                     MOVELBEAETX    PAAETX    P      Bill to Name
     C                     MOVELBEB1NA    PAB1NA    P      Bill to Address
     C                     MOVELBEB3NA    PAB3NA    P      Bill to Address
     C                     MOVELBEB4NA    PAB4NA    P      Bill to Address
     C                     MOVELBEB2NA    PAB2NA    P      Bill to City
     C                     MOVELBEBHCD    PABHCD    P      Bill to State C
     C                     MOVELBEC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELBEBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDBEA0DT    PAA0DT           Order Date
     C                     Z-ADDBEA5DT    PAA5DT           Requested Ship
     C                     Z-ADDBEGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDBEACDT    PAACDT           Cancel Date
     C                     MOVELBEAQCD    PAAQCD    P      Terms Code
     C                     MOVELBEB6NA    PAB6NA    P      Special Instruc
     C                     MOVELBEBYNA    PABYNA    P      Special Instruc
     C                     MOVELBEBZNA    PABZNA    P      Carrier Code
     C                     MOVELBEGTST    PAGTST    P      Comment Print A
     C                     MOVELBEGVST    PAGVST    P      Comment Print I
     C                     MOVELBEGUST    PAGUST    P      Comment Print P
     C                     MOVELBEQFST    PAQFST    P      Comment Print S
     C                     MOVELBECQCD    PACQCD    P      Reason Code
     C                     MOVELBEGJST    PAGJST    P      Order in Use
     C                     MOVELBEGWST    PAGWST    P      Header Status
     C                     MOVELBEGXST    PAGXST    P      Header Status L
     C                     MOVELBEGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDBEAODT    PAAODT           Scheduled Ship
     C                     MOVELBEAIVN    PAAIVN    P      User Original E
     C                     Z-ADDBECXDT    PACXDT           Date of Origina
     C                     Z-ADDBEJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    PAA1WG           Order Weight To
     C                     MOVELBEXIST    PAXIST    P      Credit Hold
     C                     MOVELBEXJST    PAXJST    P      Production Hold
     C                     MOVELBEXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDBEEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    PAAFTM           Requested Deliv
     C                     MOVELBEE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELBEE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDBERMNB    PARMNB           Load ID
     C                     Z-ADDBETBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    PAR1NB           Rated Freight
     C                     MOVELBEPJST    PAPJST    P      LTL Flag
     C                     MOVELBEU0ST    PAU0ST    P      Price Audit
     C                     MOVELBEU1ST    PAU1ST    P      Price Status
     C                     MOVELBEQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELBEU2ST    PAU2ST    P      Export Status
     C                     MOVELBEVEST    PAVEST    P      Palletize
     C                     MOVELBEVFST    PAVFST    P      Shrink Wrap
     C                     MOVELBEVGST    PAVGST    P      Slip Sheet
     C                     MOVELBERPCD    PARPCD    P      Age Code
     C                     Z-ADDBERNNB    PARNNB           Reefer Temperat
     C                     MOVELBEVDST    PAVDST    P      Load Type
     C                     Z-ADDBEATIN    PAATIN           Attach to Invoi
     C                     MOVELBEU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELBEU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDBERSRN    PARSRN           Resell Referenc
     C                     MOVELBEMHNA    PAMHNA    P      Special Comment
     C                     MOVELBEMINA    PAMINA    P      Special Comment
     C                     MOVELBEWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELBER4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELBEBFCD    PABFCD    P      Manager Level C
     C                     MOVELBEQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDBET3NB    PAT3NB           Attach to Order
     C                     MOVELBESICD    PASICD    P      Reason for Pric
     C                     Z-ADDBECONB    PACONB           Invoice Number
     C                     MOVELBECEST    PACEST    P      Invoice Suffix
     C                     Z-ADDBEAWDT    PAAWDT           Invoice Date
     C                     MOVELBEJPCD    PAJPCD    P      Event Code
     C                     MOVELBEXUST    PAXUST    P      Trans Contol AS
     C                     MOVELBEZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDBEVRVA    PAVRVA           A/R order Value
     C                     MOVELBEOBST    PAOBST    P      Billing Activit
     C                     MOVELBEBCST    PABCST    P      Block Order Fla
     C                     MOVELBEBDST    PABDST    P      Order Certifica
     C                     Z-ADDBEB7VL    PAB7VL           Invoice Order V
     C                     MOVELBEGASX    PAGASX    P      Invoice Price T
     C                     MOVELBEGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELBEGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELBEGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELBEFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELBEFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELBEFPSX    PAFPSX    P      Order Emailed
     C                     MOVELBEFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELBEFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELBEFSSX    PAFSSX    P      Broker Order St
     C                     MOVELBEFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELBEFUSX    PAFUSX    P      Signal Demand S
     C                     MOVELBEFVSX    PAFVSX    P      EDI Nistevo Sel
     C                     MOVELBEFWSX    PAFWSX    P      Export USDA App
     C                     MOVELBEFXSX    PAFXSX    P      Unused OH Code
     C                     MOVELBEFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDBENODT    PANODT           OH Unused Date
     C                     Z-ADDBENPDT    PANPDT           OH Unused Date
     C                     Z-ADDBENQDT    PANQDT           OH Unused Date
     C                     Z-ADDBENRDT    PANRDT           OH Unused Date
     C                     Z-ADDBENSDT    PANSDT           OH Unused Date
     C                     Z-ADDBEBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    PABQTM           Time of Origina
     C                     Z-ADDBEBRTM    PABRTM           OH Unused Time
     C                     Z-ADDBEBSTM    PABSTM           OH Unused Time
     C                     Z-ADDBEBTTM    PABTTM           OH Unused Time
     C                     Z-ADDBEH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    PAC0C7           Claim Number
     C                     MOVELBEUVST    PAUVST    P      EDI Status 1
     C                     MOVELBEUWST    PAUWST    P      EDI Status 2
     C                     MOVELBEUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDBEAATM    PAAATM           Job Time
     C                     MOVELBEAYNA    PAAYNA    P      User Id
     C                     MOVELBEA0NA    PAA0NA    P      Job Name
     C                     Z-ADDBEAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * VAL Load ID on Orders  RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQST02           Load ID
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQST02           Load ID
      * Establish starting position
     C           KRSST     SETLL@BFCPD9                    *
     C           KRSST     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUDLRC    BEGSR
      *================================================================
      * DLT Load Header        DL - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WGRMNB           Load ID
      *
     C           KLDLSU    KLIST
     C                     KFLD           WGRMNB           Load ID
     C           KLDLSU    CHAIN@FJCPBO              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FJCPBO                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * DLT Load Detail       RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSV01           Load ID
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSV01           Load ID
      * Establish starting position
     C           KRSSV     SETLL@FLCPBW                    *
     C           KRSSV     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Load Detail        DL - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLRMNB    WL0050           Load ID
     C                     Z-ADDFLRUNB    WL0051           Stop/Drop Seque
     C                     EXSR SWDLRC
     C           KRSSV     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWDLRC    BEGSR
      *================================================================
      * DLT Load Detail        DL - Load Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FLCPBM
     C                     Z-ADDWL0050    WHRMNB           Load ID
     C                     Z-ADDWL0051    WHRUNB           Stop/Drop Seque
      *
     C           KLDLSW    KLIST
     C                     KFLD           WHRMNB           Load ID
     C                     KFLD           WHRUNB           Stop/Drop Seque
     C           KLDLSW    CHAIN@FLCPBM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FLCPBM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * CHG Sub Weight & Stop  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0124  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0125  50       Total Stops
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSX     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           FJRPNB    SUB  #1A1WG    WN0124           Total Load Orde
     C           FJRRNB    SUB  1         WN0125           Total Stops
      * CHG Load Header        CH - Load Header  * 
     C                     EXSR SYCHRC
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * CHG Load Header        CH - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0126 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0127 15        Seal 2 Unused
     C                     MOVEL*BLANK    WN0128 15        Load Held Over
     C                     Z-ADD*ZERO     WN0129  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0130  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0131  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0132  1        Load Confirmed
     C                     MOVEL*BLANK    WN0133 25        Load Confirmed
     C                     MOVEL*BLANK    WN0134 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0135 15        Late Billing Em
     C                     MOVEL*BLANK    WN0136 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0137 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0138  1        Multi Company L
     C                     MOVEL*BLANK    WN0139  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0140  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0141  1        LH Unused Sts 3
     C                     MOVEL*BLANK    WN0142  1        LH Unused Sts 4
     C                     MOVEL*BLANK    WN0143  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0144  2        Load U/M
     C                     MOVEL*BLANK    WN0145  2        LH Unused Sts 7
     C                     MOVEL*BLANK    WN0146  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0147  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0148  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0149  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0150  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0151  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0152  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0153  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0154  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0155  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0156  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0157  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0158  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0159  60       LH Unused Time
     C                     MOVEL*BLANK    WN0160  1        EDI Status 1
     C                     MOVEL*BLANK    WN0161  1        EDI Status 2
     C                     MOVEL*BLANK    WN0162  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0163  60       Job Time
     C                     MOVEL*BLANK    WN0164 10        User Id
     C                     MOVEL*BLANK    WN0165 10        Job Name
     C                     Z-ADD*ZERO     WN0166  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDFJRMNB    WGRMNB           Load ID
      *
     C           KLCHSY    KLIST
     C                     KFLD           WGRMNB           Load ID
     C           KLCHSY    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDFJAIC3    WGAIC3           Company Number
     C                     Z-ADDFJAODT    WGAODT           Scheduled Ship
     C                     MOVELFJPJST    WGPJST    P      LTL Flag
     C                     MOVELFJPKST    WGPKST    P      Load Status
     C                     Z-ADDFJRNNB    WGRNNB           Reefer Temperat
     C                     MOVELFJDMTX    WGDMTX    P      Seal 1
     C                     MOVELFJDNTX    WGDNTX    P      Seal 2
     C                     MOVELFJDOTX    WGDOTX    P      Seal 3
     C                     Z-ADDWN0124    WGRPNB           Total Load Orde
     C                     Z-ADDFJFLAM    WGFLAM           Flat Amount
     C                     MOVELFJXQST    WGXQST    P      Allocate Pounds
     C                     Z-ADDWN0125    WGRRNB           Total Stops
     C                     MOVELFJDXTX    WGDXTX    P      Trailer Id
     C                     MOVELFJDYTX    WGDYTX    P      Initials of Con
     C                     Z-ADDFJSBNB    WGSBNB           BOL Time
     C                     MOVELFJBZNA    WGBZNA    P      Carrier Code
     C                     MOVELFJRONB    WGRONB    P      Truck Size
     C                     Z-ADDFJSQNB    WGSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    WGR1NB           Rated Freight
     C                     MOVELFJVCST    WGVCST    P      Ship Status
     C                     MOVELFJVDST    WGVDST    P      Load Type
     C                     Z-ADDFJSDNB    WGSDNB           Number Pallets
     C                     Z-ADDFJPAOU    WGPAOU           Number Pallets
     C                     Z-ADDFJDGWG    WGDGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    WGSXNB           Estimated Arriv
     C                     Z-ADDFJHADT    WGHADT           Actual Arrival
     C                     Z-ADDFJAART    WGAART           Actual Arrival
     C                     Z-ADDFJDHWG    WGDHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    WGDIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    WGAQDT           Actual Departur
     C                     Z-ADDFJS6NB    WGS6NB           Departure Time
     C                     Z-ADDFJT4NB    WGT4NB           Schedule Sequen
     C                     Z-ADDFJPRTM    WGPRTM           Product Tempera
     C                     Z-ADDFJNPSV    WGNPSV           Number Pallets
     C                     MOVELFJJ8TX    WGJ8TX    P      Car/Veh. Initia
     C                     Z-ADDFJTLMI    WGTLMI           Total Load Mile
     C                     MOVELFJJ9TX    WGJ9TX    P      Recorder ID
     C                     MOVELFJQ2CD    WGQ2CD    P      Shipping Method
     C                     MOVELFJVPCD    WGVPCD    P      Ship From Wareh
     C                     MOVELFJDBCD    WGDBCD    P      Ship To State C
     C                     Z-ADDFJGRWE    WGGRWE           Gross Weight
     C                     MOVELFJXCCD    WGXCCD    P      Carrier Broker
     C                     MOVELFJU2ST    WGU2ST    P      Export Status
     C                     Z-ADDFJF9DT    WGF9DT           Actual Ship Dat
     C                     MOVELFJONTM    WGONTM    P      On Time - (Y/N)
     C                     Z-ADDFJJ4DT    WGJ4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    WGTRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WGJ5DT           Spotted Date
     C                     Z-ADDFJSPTM    WGSPTM           Spotted Time
     C                     Z-ADDFJJ6DT    WGJ6DT           Load Finished D
     C                     Z-ADDFJLFTM    WGLFTM           Load Finished T
     C                     Z-ADDFJJ7DT    WGJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    WGBOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WGJ8DT           BOL Received Da
     C                     Z-ADDFJBLTM    WGBLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    WGKIDT           Truck Departure
     C                     Z-ADDFJASTM    WGASTM           Truck Departure
     C                     Z-ADDFJKADT    WGKADT           Adjusted Depart
     C                     Z-ADDFJAJCM    WGAJCM           Adjusted Depart
     C                     MOVELFJXACD    WGXACD    P      Shipping Line
     C                     MOVELFJOANA    WGOANA    P      Port Delv Termi
     C                     MOVELFJK4TX    WGK4TX    P      Vessel Name
     C                     Z-ADDFJVOAG    WGVOAG           Voyage
     C                     Z-ADDFJKBDT    WGKBDT           Sail Date
     C                     MOVELFJNBBO    WGNBBO    P      Booking Number
     C                     MOVELFJW4CD    WGW4CD    P      Discharge Port
     C                     Z-ADDFJEFDT    WGEFDT           Arrival Date
     C                     MOVELFJCNTN    WGCNTN    P      Container Numbe
     C                     Z-ADDFJKCDT    WGKCDT           Date In
     C                     Z-ADDFJTMIN    WGTMIN           Time In
     C                     Z-ADDFJKDDT    WGKDDT           Date Out
     C                     Z-ADDFJVMNB    WGVMNB           Time Out
     C                     Z-ADDFJOCFR    WGOCFR           Load Total Frei
     C                     Z-ADDFJKJDT    WGKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    WGATTM           Scheduled Deliv
     C                     MOVELFJOTRS    WGOTRS    P      LH Unused Sts
     C                     MOVELFJRNST    WGRNST    P      LH Carrier Paym
     C                     Z-ADDFJBRBK    WGBRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    WGEIDT           Requested Deliv
     C                     MOVELFJRMST    WGRMST    P      Load Acceptance
     C                     MOVELFJAJCD    WGAJCD    P      Warehouse Code
     C                     Z-ADDFJKKDT    WGKKDT           On Yard Date
     C                     Z-ADDFJAVTM    WGAVTM           On Yard Time
     C                     Z-ADDFJKZDT    WGKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    WGAXTM           Deadline Depart
     C                     MOVELFJLHOS    WGLHOS    P      Load Held Over
     C                     MOVELFJLHOR    WGLHOR    P      Load Held Over
     C                     MOVELFJOITX    WGOITX    P      Ocean BOL Numbe
     C                     MOVELFJOJTX    WGOJTX    P      Express Mail Nu
     C                     Z-ADDFJLLDT    WGLLDT           Express Mail Da
     C                     MOVELFJLSHG    WGLSHG    P      Load Shag Flag
     C                     MOVELFJYPST    WGYPST    P      Load Wash Flag
     C                     Z-ADDFJK0DT    WGK0DT           Product Complet
     C                     Z-ADDFJAYTM    WGAYTM           Product Complet
     C                     Z-ADDFJK1DT    WGK1DT           Load Confirmati
     C                     Z-ADDFJAZTM    WGAZTM           Load Door 1
     C                     Z-ADDFJK2DT    WGK2DT           Override Total
     C                     Z-ADDFJA0TM    WGA0TM           Load Door 2
     C                     MOVELFJROST    WGROST    P      Partial Load
     C                     MOVELFJRPST    WGRPST    P      Load Confirmati
     C                     MOVELFJRQST    WGRQST    P      Export Load USD
     C                     MOVELFJRRST    WGRRST    P      Late Delivery E
     C                     Z-ADDFJZBVA    WGZBVA           Load Actual Fre
     C                     MOVELFJR3SX    WGR3SX    P      LH On-Time Reas
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WGAATM' defaulted for 'Job Time'.
      * Field '(DB1) WGAYNA' defaulted for 'User Id'.
      * Field '(DB1) WGA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WGAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * CHG Del Order Off load RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQSZ02           Load ID
     C           *LIKE     DEFN WIC4NB    WQSZ03           Order Number
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ02           Load ID
     C                     KFLD           WQSZ03           Order Number
      * Setup key
     C                     Z-ADD#1RMNB    WQSZ02           Load ID
     C                     Z-ADD#1C4NB    WQSZ03           Order Number
      * Establish starting position
     C           KRSSZ     SETLL@FLCPKF                    *
     C           KRSSZ     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Load Detail        DL - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIRMNB    WL0050           Load ID
     C                     Z-ADDWIRUNB    WL0051           Stop/Drop Seque
     C                     EXSR SWDLRC
     C           KRSSZ     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV OE Hold/ShipTo FlagRT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSTA     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUQNST           Order Entry Hol
     C                     MOVEL*BLANK    WURJST           Ship To Custome
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDQNST    WUQNST           Order Entry Hol
     C                     MOVELWDRJST    WURJST           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * VAL Check Exists       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSTB     CHAIN@BBREWG              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Sls Route by Slsp  RT - PD Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJBCCD    WQTC01           Salesperson Cod
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Salesperson Cod
      * Setup key
     C                     MOVEL#DBCCD    WQTC01           Salesperson Cod
      * Establish starting position
     C           KRSTC     SETLL@JEREZ3                    *
     C           KRSTC     READE@JEREZ3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1BFCD           Manager Level C
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJR4CD    #1R4CD           Sales Route Cod
     C                     MOVELWJBFCD    #1BFCD           Manager Level C
     C                     MOVELWJQ4CD    #1Q4CD           VP Level Code
     C           KRSTC     READE@JEREZ3                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Mgr Desc,VP Level  RT - Manager Level  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           ALBFCD           Manager Level C
      * Setup key
     C                     MOVEL#1BFCD    ALBFCD           Manager Level C
      * Establish starting position
     C           KRSTD     CHAIN@ALREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Description
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELALAUNA    WUG0TX           Description
     C                     MOVELALQ4CD    #1Q4CD           VP Level Code
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Order Types        RT - OP Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WKJNCD           Order Type - Sa
      * Setup key
     C                     MOVEL#1JNCD    WKJNCD           Order Type - Sa
      * Establish starting position
     C           KRSTE     CHAIN@EXREYP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1063' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Order Type Desc
     C                     MOVEL*BLANK    WUG0TX           Processing Cycl
     C                     MOVEL*BLANK    #1OBST           Billing Activit
     C                     MOVEL*BLANK    P4OEST           Affect Inventor
     C                     MOVEL*BLANK    WUG0TX           Affect Sales Do
     C                     MOVEL*BLANK    WUG0TX           Affect Sales Pn
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKJVNA    WUG0TX           Order Type Desc
     C                     MOVELWKOAST    WUG0TX           Processing Cycl
     C                     MOVELWKOBST    #1OBST           Billing Activit
     C                     MOVELWKOEST    P4OEST           Affect Inventor
     C                     MOVELWKOFST    WUG0TX           Affect Sales Do
     C                     MOVELWKVBST    WUG0TX           Affect Sales Pn
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Whse Type,Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WLAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    WLAJCD           Warehouse Code
      * Establish starting position
     C           KRSTF     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WUWPST           Warehouse Type
     C                     MOVEL*BLANK    #1XUST           Trans Contol AS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLWPST    WUWPST           Warehouse Type
     C                     MOVELWLXUST    #1XUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Co,Cust,PO         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQTG01           Company Number
     C           *LIKE     DEFN WMBKC7    WQTG02           Ship To Custome
     C           *LIKE     DEFN WMBCNA    WQTG03           Customer Purcha
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WQTG02           Ship To Custome
     C                     KFLD           WQTG03           Customer Purcha
      * Setup key
     C                     Z-ADD#1AIC3    WQTG01           Company Number
     C                     Z-ADD#1BKC7    WQTG02           Ship To Custome
     C                     MOVEL#1BCNA    WQTG03           Customer Purcha
      * Establish starting position
     C           KRSTG     SETLL@BFCPXD                    *
     C           KRSTG     READE@BFCPXD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSTG     READE@BFCPXD                  90*
     C                     ENDDO
      * USER: Exit processing
      * PAR = DB1 By name
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Chk if valid Cntry RT - OM Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVEL#DKXCD    E5KXCD           Country Code
      * Establish starting position
     C           KRSTH     CHAIN@E5REB8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1158' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO THEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Val Day Prior Ship    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0006           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQTI01           Company Number
     C           *LIKE     DEFN WOC4NB    WQTI02           Order Number
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
      * Setup key
     C                     Z-ADD#DFKNB    WQTI01           Company Number
     C                     Z-ADD#1C4NB    WQTI02           Order Number
      * Establish starting position
     C           KRSTI     SETLL@BGWKL1                    *
     C           KRSTI     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Date Method Code is Day Prior Ship
     C           WORDCD    IFEQ 'DPS'                      *IF
     C                     MOVEL'Y'       YL0006           Record Found US
     C                     GOTO TIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJINFN    BEGSR
      *================================================================
      * PMT Must Ship Dt Accpt IF - Order Header TRG  * 
      *================================================================
      * PMT Must Ship Dt Accpt IF
      * PMT Must Ship Dt Accpt PV - Order Header TRG  * 
     C                     CALL 'PDJFPVR'              90  PMT Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1EIDT    WQ0101  70       Requested Deliv
     C                     PARM YL0008    WQ0102  70       Must Ship Date
     C                     PARM #1A5DT    WQ0103  70       Requested Ship
     C           P8ATUS    PARM P8ATUS    WQ0104  1        STATUS
     C                     PARM YL0009    WQ0105  60       Must Ship Time
     C                     PARM #1AFTM    WQ0106  40       Requested Deliv
     C                     PARM WUB7SX    WQ0107  3        Must Ship Error
     C                     PARM #1C4NB    WQ0108  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJFPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993436*
     C                     SETON                     35    *
     C                     END
      * CASE: PAR.STATUS is No
     C           P8ATUS    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Must Ship Date        USR to display format
      * Convert date
     C           1000000   ADD  YL0008    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0021
      * Send message 'Requested Ship Date can n'
     C                     MOVEL'USR2662' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Stop Number       RT - Load Detail          TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WURVNB           Stop/Drop
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTK01           Load ID
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTK01           Load ID
      * Establish starting position
     C           KRSTK     SETLL@FLCPBW                    *
     C           KRSTK     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WURVNB           Stop/Drop
     C                     Z-ADD*ZERO     WUNFNN           Appointment Con
     C                     Z-ADD*ZERO     WUNFNN           Appointment Con
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If order number is found, retrieve stop number
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           #1C4NB    IFEQ FLC4NB                     *IF
     C                     Z-ADDFLRVNB    WURVNB           Stop/Drop
      * PAR = DB1 By name
     C                     Z-ADDFLRVNB    WURVNB           Stop/Drop
     C                     Z-ADDFLKFDT    WUNFNN           Appointment Con
     C                     Z-ADDFLACTM    WUNFNN           Appointment Con
     C                     GOTO TKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTK     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTL     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv Acct&Ship Co      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTM     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WUBTC3           Accounting Comp
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBWC3    WUBWC3           Shipping Compan
     C                     Z-ADDADBTC3    WUBTC3           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWUCPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAOC3           Accounting Comp
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    WUAOC3           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Abs Freight Rate   RT - Company/Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     Z-ADD#1BKC7    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSTO     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBTBNB    #1TBNB           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * RTV Chk Detail Exists  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTP01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTP02           Order Number
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Company Number
     C                     KFLD           WQTP02           Order Number
      * Setup key
     C                     Z-ADDWL0052    WQTP01           Company Number
     C                     Z-ADDWL0053    WQTP02           Order Number
      * Establish starting position
     C           KRSTP     SETLL@BGWKAE                    *
     C           KRSTP     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSTP     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - OP Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0167  1        EDI Status 1
     C                     MOVEL*BLANK    WN0168  1        EDI Status 2
     C                     MOVEL*BLANK    WN0169  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0170  60       Job Time
     C                     MOVEL*BLANK    WN0171 10        User Id
     C                     MOVEL*BLANK    WN0172 10        Job Name
     C                     Z-ADD*ZERO     WN0173  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADD#1AIC3    EYAIC3           Company Number
     C                     Z-ADD#1C4NB    EYC4NB           Order Number
     C                     Z-ADD1         EYQ2NB           Event Number
     C                     MOVEL'01'      EYJPCD           Event Code
     C                     Z-ADD*ZERO     EYAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     EYQ7NB           Invoice/Memo Nu
     C                     MOVEL*BLANK    EYOMST           Invoice/Memo Su
     C                     Z-ADD##JDT     EYD2DT           Event Date
     C                     MOVEL'Y'       EYONST           Activity Comple
     C                     MOVEL'N'       EYOOST           Activity Hold
     C                     MOVEL*BLANK    EYOPST           Post Cash Compl
     C                     Z-ADD*ZERO     EYAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     EYQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     EYQ9NB           Cross Event Ref
     C                     Z-ADD#1BKC7    EYBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     EYAATM           Job Time
     C                     MOVEL##USR     EYAYNA           User Id
     C                     MOVEL##JOB     EYA0NA           Job Name
     C                     Z-ADD##JDT     EYAXDT           Job Date
     C           KLCRTQ    KLIST
     C                     KFLD           EYAIC3           Company Number
     C                     KFLD           EYC4NB           Order Number
     C                     KFLD           EYQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRTQ    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * CHG Rqs Ship Dte/Alloc RT - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0174 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0175 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0176  70       Scheduled Ship
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQTR01           Company Number
     C           *LIKE     DEFN WAC4NB    WQTR02           Order Number
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Company Number
     C                     KFLD           WQTR02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTR01           Company Number
     C                     Z-ADD#1C4NB    WQTR02           Order Number
      * Establish starting position
     C           KRSTR     SETLL@BGWKKK                    *
     C           KRSTR     READE@BGWKKK                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWACCQT    WN0174           Quantity Schedu
     C                     Z-ADDWAAUWG    WN0175           Weight Schedule
     C                     Z-ADDWAAODT    WN0176           Scheduled Ship
      * Deallocate/Allocate detail if order is not on load
      * CASE: PAR.Load ID is Blank
     C           #1RMNB    IFEQ *ZERO                      *IF
      * UPD Dealloc/Allocate   XF - PD Order Header  * 
     C                     CALL 'PDPJXFR'              90  UPD Dealloc/All
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0156  30       Company Number
     C                     PARM WAC4NB    WQ0157  70       Order Number
     C                     PARM WADPNB    WQ0158  30       Order Sequence
     C                     PARM WAUENB    WQ0159  30       Order Secondary
     C                     PARM WAAJCD    WQ0160  3        Warehouse Code
     C                     PARM WAAODT    WQ0161  70       Deallocate Date
     C                     PARM #1A5DT    WQ0162  70       Allocate Date U
     C           WUG0TX    PARM WUG0TX    WQ0163  1        Production Hold
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     Z-ADD*ZERO     WN0174           Quantity Schedu
     C                     Z-ADD*ZERO     WN0175           Weight Schedule
     C                     Z-ADD#1A5DT    WN0176           Scheduled Ship
     C                     END                             *FI
      * CHG Rqs/Sched Ship Dte CH - PD Order Detail  * 
     C                     EXSR TSCHRC
     C           KRSTR     READE@BGWKKK                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSCHRC    BEGSR
      *================================================================
      * CHG Rqs/Sched Ship Dte CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0177  70       Item Code
     C                     MOVEL*BLANK    WN0178  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0179  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0180  70       Order Group Cod
     C                     MOVEL*BLANK    WN0181  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0182  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0183 112       Billing Detail
     C                     Z-ADD*ZERO     WN0184 112       Billing Detail
     C                     Z-ADD*ZERO     WN0185 112       Billing Detail
     C                     Z-ADD*ZERO     WN0186 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0187  1        Comment Print A
     C                     MOVEL*BLANK    WN0188  1        Comment Print I
     C                     MOVEL*BLANK    WN0189  1        Comment Print P
     C                     MOVEL*BLANK    WN0190  1        Comment Print S
     C                     Z-ADD*ZERO     WN0191 112       Extended Amount
     C                     Z-ADD*ZERO     WN0192  70       Market Pricing
     C                     MOVEL*BLANK    WN0193  3        Commodity Marke
     C                     MOVEL*BLANK    WN0194  3        Date Method Cod
     C                     MOVEL*BLANK    WN0195  3        Price Method Co
     C                     Z-ADD*ZERO     WN0196 114       Price Overage O
     C                     Z-ADD*ZERO     WN0197  70       Contract Number
     C                     MOVEL*BLANK    WN0198  1        Price Status
     C                     Z-ADD*ZERO     WN0199  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0200  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0201  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0202  1        Work Confirm St
     C                     MOVEL*BLANK    WN0203  1        Work Over/Short
     C                     MOVEL*BLANK    WN0204  1        OD Production P
     C                     MOVEL*BLANK    WN0205 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0206 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0207  1        Age Code
     C                     MOVEL*BLANK    WN0208  1        Palletize
     C                     MOVEL*BLANK    WN0209  1        Slip Sheet
     C                     MOVEL*BLANK    WN0210  1        Catch Weight St
     C                     MOVEL*BLANK    WN0211  1        Price Audit
     C                     MOVEL*BLANK    WN0212  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0213  1        Production Date
     C                     Z-ADD*ZERO     WN0214 112       Rated Freight
     C                     Z-ADD*ZERO     WN0215 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0216 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0217 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0218 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0219 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0220 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0221 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0222 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0223 114       Unit Price
     C                     Z-ADD*ZERO     WN0224 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0225 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0226 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0227 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0228  70       Actual Shipped
     C                     MOVEL*BLANK    WN0229  1        Affect Inventor
     C                     MOVEL*BLANK    WN0230  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0231  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0232  30       Item Structure
     C                     Z-ADD*ZERO     WN0233  30       Item Structure
     C                     Z-ADD*ZERO     WN0234  30       Item Structure
     C                     MOVEL*BLANK    WN0235  2        Item Level
     C                     MOVEL*BLANK    WN0236  2        Quality Level
     C                     MOVEL*BLANK    WN0237  2        Pricing Product
     C                     MOVEL*BLANK    WN0238  2        Season Product
     C                     Z-ADD*ZERO     WN0239  70       Date of Origina
     C                     MOVEL*BLANK    WN0240 10        User Profile Na
     C                     MOVEL*BLANK    WN0241  6        Country Code
     C                     MOVEL*BLANK    WN0242  2        Event Code
     C                     MOVEL*BLANK    WN0243  3        Reason Code
     C                     MOVEL*BLANK    WN0244  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0245  1        Modified Flag
     C                     MOVEL*BLANK    WN0246  1        Substituted Fla
     C                     MOVEL*BLANK    WN0247  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0248 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0249 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0250  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0251  1        OD Schedule Sho
     C                     MOVEL*BLANK    WN0252  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0253  1        Affect Commissi
     C                     MOVEL*BLANK    WN0254  1        Affect Pricing
     C                     MOVEL*BLANK    WN0255  1        Released by Use
     C                     MOVEL*BLANK    WN0256  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0257  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0258  3        Production Ware
     C                     MOVEL*BLANK    WN0259  3        OD Price Type
     C                     Z-ADD*ZERO     WN0260  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0261  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0262  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0263  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0264  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0265  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0266  60       Price Code
     C                     Z-ADD*ZERO     WN0267  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0268  60       Substitution Li
     C                     Z-ADD*ZERO     WN0269  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0270 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0271 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0272 112       OD Item Target
     C                     Z-ADD*ZERO     WN0273 112       OD Minimum Unit
     C                     Z-ADD*ZERO     WN0274 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0275 114       Order Gate Pric
     C                     Z-ADD*ZERO     WN0276 114       OD Unused Prc 2
     C                     Z-ADD*ZERO     WN0277 114       OD Unused Prc 3
     C                     Z-ADD*ZERO     WN0278 114       OD Unused Prc 4
     C                     Z-ADD*ZERO     WN0279 114       OD Unused Prc 5
     C                     MOVEL*BLANK    WN0280  1        EDI Status 1
     C                     MOVEL*BLANK    WN0281  1        EDI Status 2
     C                     MOVEL*BLANK    WN0282  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0283  60       Job Time
     C                     MOVEL*BLANK    WN0284 10        User Id
     C                     MOVEL*BLANK    WN0285 10        Job Name
     C                     Z-ADD*ZERO     WN0286  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWAAIC3    WSAIC3           Company Number
     C                     Z-ADDWAC4NB    WSC4NB           Order Number
     C                     Z-ADDWADPNB    WSDPNB           Order Sequence
     C                     Z-ADDWAUENB    WSUENB           Order Secondary
      *
     C           KLCHTS    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
     C                     KFLD           WSDPNB           Order Sequence
     C                     KFLD           WSUENB           Order Secondary
     C           KLCHTS    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YCRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#1A5DT    WSA5DT           Requested Ship
     C                     Z-ADDWN0176    WSAODT           Scheduled Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##PGM     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * CHG Requested Ship Dt  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQTT01           Company Number
     C           *LIKE     DEFN WOC4NB    WQTT02           Order Number
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WQTT01           Company Number
     C                     KFLD           WQTT02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTT01           Company Number
     C                     Z-ADD#1C4NB    WQTT02           Order Number
      * Establish starting position
     C           KRSTT     SETLL@BGWKL1                    *
     C           KRSTT     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * This will change the requested ship date only
      * Chg Requested Ship Dt CH - Order Detail  * 
     C                     EXSR TUCHRC
     C           KRSTT     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCHRC    BEGSR
      *================================================================
      * Chg Requested Ship Dt CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0287  70       Item Code
     C                     MOVEL*BLANK    WN0288  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0289  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0290  70       Order Group Cod
     C                     MOVEL*BLANK    WN0291  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0292  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0293 112       Billing Detail
     C                     Z-ADD*ZERO     WN0294 112       Billing Detail
     C                     Z-ADD*ZERO     WN0295 112       Billing Detail
     C                     Z-ADD*ZERO     WN0296 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0297  1        Comment Print A
     C                     MOVEL*BLANK    WN0298  1        Comment Print I
     C                     MOVEL*BLANK    WN0299  1        Comment Print P
     C                     MOVEL*BLANK    WN0300  1        Comment Print S
     C                     Z-ADD*ZERO     WN0301 112       Extended Amount
     C                     Z-ADD*ZERO     WN0302  70       Market Pricing
     C                     MOVEL*BLANK    WN0303  3        Commodity Marke
     C                     MOVEL*BLANK    WN0304  3        Date Method Cod
     C                     MOVEL*BLANK    WN0305  3        Price Method Co
     C                     Z-ADD*ZERO     WN0306 114       Price Overage O
     C                     Z-ADD*ZERO     WN0307  70       Contract Number
     C                     MOVEL*BLANK    WN0308  1        Price Status
     C                     Z-ADD*ZERO     WN0309  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0310  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0311  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0312  1        Work Confirm St
     C                     MOVEL*BLANK    WN0313  1        Work Over/Short
     C                     MOVEL*BLANK    WN0314  1        OD Production P
     C                     MOVEL*BLANK    WN0315 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0316 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0317  1        Age Code
     C                     MOVEL*BLANK    WN0318  1        Palletize
     C                     MOVEL*BLANK    WN0319  1        Slip Sheet
     C                     MOVEL*BLANK    WN0320  1        Catch Weight St
     C                     MOVEL*BLANK    WN0321  1        Price Audit
     C                     MOVEL*BLANK    WN0322  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0323  1        Production Date
     C                     Z-ADD*ZERO     WN0324 112       Rated Freight
     C                     Z-ADD*ZERO     WN0325 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0326 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0327 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0328 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0329 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0330 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0331 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0332 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0333 114       Unit Price
     C                     Z-ADD*ZERO     WN0334 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0335 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0336 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0337 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0338  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0339  70       Actual Shipped
     C                     MOVEL*BLANK    WN0340  1        Affect Inventor
     C                     MOVEL*BLANK    WN0341  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0342  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0343  30       Item Structure
     C                     Z-ADD*ZERO     WN0344  30       Item Structure
     C                     Z-ADD*ZERO     WN0345  30       Item Structure
     C                     MOVEL*BLANK    WN0346  2        Item Level
     C                     MOVEL*BLANK    WN0347  2        Quality Level
     C                     MOVEL*BLANK    WN0348  2        Pricing Product
     C                     MOVEL*BLANK    WN0349  2        Season Product
     C                     Z-ADD*ZERO     WN0350  70       Date of Origina
     C                     MOVEL*BLANK    WN0351 10        User Profile Na
     C                     MOVEL*BLANK    WN0352  6        Country Code
     C                     MOVEL*BLANK    WN0353  2        Event Code
     C                     MOVEL*BLANK    WN0354  3        Reason Code
     C                     MOVEL*BLANK    WN0355  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0356  1        Modified Flag
     C                     MOVEL*BLANK    WN0357  1        Substituted Fla
     C                     MOVEL*BLANK    WN0358  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0359 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0360 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0361  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0362  1        OD Schedule Sho
     C                     MOVEL*BLANK    WN0363  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0364  1        Affect Commissi
     C                     MOVEL*BLANK    WN0365  1        Affect Pricing
     C                     MOVEL*BLANK    WN0366  1        Released by Use
     C                     MOVEL*BLANK    WN0367  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0368  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0369  3        Production Ware
     C                     MOVEL*BLANK    WN0370  3        OD Price Type
     C                     Z-ADD*ZERO     WN0371  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0372  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0373  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0374  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0375  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0376  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0377  60       Price Code
     C                     Z-ADD*ZERO     WN0378  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0379  60       Substitution Li
     C                     Z-ADD*ZERO     WN0380  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0381 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0382 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0383 112       OD Item Target
     C                     Z-ADD*ZERO     WN0384 112       OD Minimum Unit
     C                     Z-ADD*ZERO     WN0385 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0386 114       Order Gate Pric
     C                     Z-ADD*ZERO     WN0387 114       OD Unused Prc 2
     C                     Z-ADD*ZERO     WN0388 114       OD Unused Prc 3
     C                     Z-ADD*ZERO     WN0389 114       OD Unused Prc 4
     C                     Z-ADD*ZERO     WN0390 114       OD Unused Prc 5
     C                     MOVEL*BLANK    WN0391  1        EDI Status 1
     C                     MOVEL*BLANK    WN0392  1        EDI Status 2
     C                     MOVEL*BLANK    WN0393  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0394  60       Job Time
     C                     MOVEL*BLANK    WN0395 10        User Id
     C                     MOVEL*BLANK    WN0396 10        Job Name
     C                     Z-ADD*ZERO     WN0397  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWOAIC3    WSAIC3           Company Number
     C                     Z-ADDWOC4NB    WSC4NB           Order Number
     C                     Z-ADDWODPNB    WSDPNB           Order Sequence
     C                     Z-ADDWOUENB    WSUENB           Order Secondary
      *
     C           KLCHTU    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
     C                     KFLD           WSDPNB           Order Sequence
     C                     KFLD           WSUENB           Order Secondary
     C           KLCHTU    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YDRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#1A5DT    WSA5DT           Requested Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVCHRC    BEGSR
      *================================================================
      * CHG Order Value,Wgt    CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0398  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0399  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0400  70       Ship To Custome
     C                     MOVEL*BLANK    WN0401 30        Ship To Name
     C                     MOVEL*BLANK    WN0402 30        Ship To Address
     C                     MOVEL*BLANK    WN0403 30        Ship To Address
     C                     MOVEL*BLANK    WN0404 30        Ship To Address
     C                     MOVEL*BLANK    WN0405 20        Ship To City
     C                     MOVEL*BLANK    WN0406  2        Ship To State C
     C                     MOVEL*BLANK    WN0407 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0408  70       Bill to Custome
     C                     MOVEL*BLANK    WN0409 30        Bill to Name
     C                     MOVEL*BLANK    WN0410 30        Bill to Address
     C                     MOVEL*BLANK    WN0411 30        Bill to Address
     C                     MOVEL*BLANK    WN0412 30        Bill to Address
     C                     MOVEL*BLANK    WN0413 20        Bill to City
     C                     MOVEL*BLANK    WN0414  2        Bill to State C
     C                     MOVEL*BLANK    WN0415 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0416 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0417  70       Order Date
     C                     Z-ADD*ZERO     WN0418  70       Requested Ship
     C                     Z-ADD*ZERO     WN0419  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0420  70       Cancel Date
     C                     MOVEL*BLANK    WN0421  2        Terms Code
     C                     MOVEL*BLANK    WN0422 40        Special Instruc
     C                     MOVEL*BLANK    WN0423 40        Special Instruc
     C                     MOVEL*BLANK    WN0424  3        Carrier Code
     C                     MOVEL*BLANK    WN0425  1        Comment Print A
     C                     MOVEL*BLANK    WN0426  1        Comment Print I
     C                     MOVEL*BLANK    WN0427  1        Comment Print P
     C                     MOVEL*BLANK    WN0428  1        Comment Print S
     C                     MOVEL*BLANK    WN0429  3        Reason Code
     C                     MOVEL*BLANK    WN0430  1        Order in Use
     C                     MOVEL*BLANK    WN0431  1        Header Status
     C                     MOVEL*BLANK    WN0432  1        Header Status L
     C                     MOVEL*BLANK    WN0433  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0434  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0435 10        User Original E
     C                     Z-ADD*ZERO     WN0436  70       Date of Origina
     C                     MOVEL*BLANK    WN0437  1        Credit Hold
     C                     MOVEL*BLANK    WN0438  1        Production Hold
     C                     MOVEL*BLANK    WN0439  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0440  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0441  40       Requested Deliv
     C                     MOVEL*BLANK    WN0442  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0443 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0444  70       Load ID
     C                     Z-ADD*ZERO     WN0445  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0446 112       Rated Freight
     C                     MOVEL*BLANK    WN0447  1        LTL Flag
     C                     MOVEL*BLANK    WN0448  1        Price Audit
     C                     MOVEL*BLANK    WN0449  1        Price Status
     C                     MOVEL*BLANK    WN0450  2        Shipping Method
     C                     MOVEL*BLANK    WN0451  1        Export Status
     C                     MOVEL*BLANK    WN0452  1        Palletize
     C                     MOVEL*BLANK    WN0453  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0454  1        Slip Sheet
     C                     MOVEL*BLANK    WN0455  1        Age Code
     C                     Z-ADD*ZERO     WN0456  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0457  1        Load Type
     C                     Z-ADD*ZERO     WN0458  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0459  1        Load Plan Order
     C                     MOVEL*BLANK    WN0460  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0461  70       Resell Referenc
     C                     MOVEL*BLANK    WN0462 30        Special Comment
     C                     MOVEL*BLANK    WN0463 30        Special Comment
     C                     MOVEL*BLANK    WN0464  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0465  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0466  2        Manager Level C
     C                     MOVEL*BLANK    WN0467  3        VP Level Code
     C                     Z-ADD*ZERO     WN0468  70       Attach to Order
     C                     MOVEL*BLANK    WN0469  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0470  70       Invoice Number
     C                     MOVEL*BLANK    WN0471  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0472  70       Invoice Date
     C                     MOVEL*BLANK    WN0473  2        Event Code
     C                     MOVEL*BLANK    WN0474  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0475  1        Modified Flag
     C                     Z-ADD*ZERO     WN0476 112       A/R order Value
     C                     MOVEL*BLANK    WN0477  1        Billing Activit
     C                     MOVEL*BLANK    WN0478  1        Block Order Fla
     C                     MOVEL*BLANK    WN0479  1        Order Certifica
     C                     Z-ADD*ZERO     WN0480 112       Invoice Order V
     C                     MOVEL*BLANK    WN0481  1        Invoice Price T
     C                     MOVEL*BLANK    WN0482  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0483  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0484  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0485  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0486  1        Email Cust On O
     C                     MOVEL*BLANK    WN0487  1        Order Emailed
     C                     MOVEL*BLANK    WN0488  1        Export Docs Go
     C                     MOVEL*BLANK    WN0489  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0490  1        Broker Order St
     C                     MOVEL*BLANK    WN0491  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0492  2        Signal Demand S
     C                     MOVEL*BLANK    WN0493  2        EDI Nistevo Sel
     C                     MOVEL*BLANK    WN0494  2        Export USDA App
     C                     MOVEL*BLANK    WN0495  3        Unused OH Code
     C                     MOVEL*BLANK    WN0496  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0497  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0498  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0499  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0500  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0501  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0502  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0503  60       Time of Origina
     C                     Z-ADD*ZERO     WN0504  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0505  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0506  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0507 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0508 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0509 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0510 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0511 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0512  70       Claim Number
     C                     MOVEL*BLANK    WN0513  1        EDI Status 1
     C                     MOVEL*BLANK    WN0514  1        EDI Status 2
     C                     MOVEL*BLANK    WN0515  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0516  60       Job Time
     C                     MOVEL*BLANK    WN0517 10        User Id
     C                     MOVEL*BLANK    WN0518 10        Job Name
     C                     Z-ADD*ZERO     WN0519  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      *
     C           KLCHTV    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHTV    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YERDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD#1JZVA    BEJZVA           Order Value Tot
     C                     Z-ADD#1A1WG    BEA1WG           Order Weight To
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##PGM     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDBEAIC3    PAAIC3           Company Number
     C                     Z-ADDBEC4NB    PAC4NB           Order Number
     C                     MOVELBEJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDBEANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    PABKC7           Ship To Custome
     C                     MOVELBEBRTX    PABRTX    P      Ship To Name
     C                     MOVELBEHMNA    PAHMNA    P      Ship To Address
     C                     MOVELBEHONA    PAHONA    P      Ship To Address
     C                     MOVELBEHPNA    PAHPNA    P      Ship To Address
     C                     MOVELBEHNNA    PAHNNA    P      Ship To City
     C                     MOVELBEDBCD    PADBCD    P      Ship To State C
     C                     MOVELBECKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDBEB0C7    PAB0C7           Bill to Custome
     C                     MOVELBEAETX    PAAETX    P      Bill to Name
     C                     MOVELBEB1NA    PAB1NA    P      Bill to Address
     C                     MOVELBEB3NA    PAB3NA    P      Bill to Address
     C                     MOVELBEB4NA    PAB4NA    P      Bill to Address
     C                     MOVELBEB2NA    PAB2NA    P      Bill to City
     C                     MOVELBEBHCD    PABHCD    P      Bill to State C
     C                     MOVELBEC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELBEBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDBEA0DT    PAA0DT           Order Date
     C                     Z-ADDBEA5DT    PAA5DT           Requested Ship
     C                     Z-ADDBEGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDBEACDT    PAACDT           Cancel Date
     C                     MOVELBEAQCD    PAAQCD    P      Terms Code
     C                     MOVELBEB6NA    PAB6NA    P      Special Instruc
     C                     MOVELBEBYNA    PABYNA    P      Special Instruc
     C                     MOVELBEBZNA    PABZNA    P      Carrier Code
     C                     MOVELBEGTST    PAGTST    P      Comment Print A
     C                     MOVELBEGVST    PAGVST    P      Comment Print I
     C                     MOVELBEGUST    PAGUST    P      Comment Print P
     C                     MOVELBEQFST    PAQFST    P      Comment Print S
     C                     MOVELBECQCD    PACQCD    P      Reason Code
     C                     MOVELBEGJST    PAGJST    P      Order in Use
     C                     MOVELBEGWST    PAGWST    P      Header Status
     C                     MOVELBEGXST    PAGXST    P      Header Status L
     C                     MOVELBEGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDBEAODT    PAAODT           Scheduled Ship
     C                     MOVELBEAIVN    PAAIVN    P      User Original E
     C                     Z-ADDBECXDT    PACXDT           Date of Origina
     C                     Z-ADDBEJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    PAA1WG           Order Weight To
     C                     MOVELBEXIST    PAXIST    P      Credit Hold
     C                     MOVELBEXJST    PAXJST    P      Production Hold
     C                     MOVELBEXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDBEEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    PAAFTM           Requested Deliv
     C                     MOVELBEE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELBEE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDBERMNB    PARMNB           Load ID
     C                     Z-ADDBETBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    PAR1NB           Rated Freight
     C                     MOVELBEPJST    PAPJST    P      LTL Flag
     C                     MOVELBEU0ST    PAU0ST    P      Price Audit
     C                     MOVELBEU1ST    PAU1ST    P      Price Status
     C                     MOVELBEQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELBEU2ST    PAU2ST    P      Export Status
     C                     MOVELBEVEST    PAVEST    P      Palletize
     C                     MOVELBEVFST    PAVFST    P      Shrink Wrap
     C                     MOVELBEVGST    PAVGST    P      Slip Sheet
     C                     MOVELBERPCD    PARPCD    P      Age Code
     C                     Z-ADDBERNNB    PARNNB           Reefer Temperat
     C                     MOVELBEVDST    PAVDST    P      Load Type
     C                     Z-ADDBEATIN    PAATIN           Attach to Invoi
     C                     MOVELBEU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELBEU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDBERSRN    PARSRN           Resell Referenc
     C                     MOVELBEMHNA    PAMHNA    P      Special Comment
     C                     MOVELBEMINA    PAMINA    P      Special Comment
     C                     MOVELBEWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELBER4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELBEBFCD    PABFCD    P      Manager Level C
     C                     MOVELBEQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDBET3NB    PAT3NB           Attach to Order
     C                     MOVELBESICD    PASICD    P      Reason for Pric
     C                     Z-ADDBECONB    PACONB           Invoice Number
     C                     MOVELBECEST    PACEST    P      Invoice Suffix
     C                     Z-ADDBEAWDT    PAAWDT           Invoice Date
     C                     MOVELBEJPCD    PAJPCD    P      Event Code
     C                     MOVELBEXUST    PAXUST    P      Trans Contol AS
     C                     MOVELBEZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDBEVRVA    PAVRVA           A/R order Value
     C                     MOVELBEOBST    PAOBST    P      Billing Activit
     C                     MOVELBEBCST    PABCST    P      Block Order Fla
     C                     MOVELBEBDST    PABDST    P      Order Certifica
     C                     Z-ADDBEB7VL    PAB7VL           Invoice Order V
     C                     MOVELBEGASX    PAGASX    P      Invoice Price T
     C                     MOVELBEGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELBEGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELBEGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELBEFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELBEFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELBEFPSX    PAFPSX    P      Order Emailed
     C                     MOVELBEFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELBEFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELBEFSSX    PAFSSX    P      Broker Order St
     C                     MOVELBEFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELBEFUSX    PAFUSX    P      Signal Demand S
     C                     MOVELBEFVSX    PAFVSX    P      EDI Nistevo Sel
     C                     MOVELBEFWSX    PAFWSX    P      Export USDA App
     C                     MOVELBEFXSX    PAFXSX    P      Unused OH Code
     C                     MOVELBEFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDBENODT    PANODT           OH Unused Date
     C                     Z-ADDBENPDT    PANPDT           OH Unused Date
     C                     Z-ADDBENQDT    PANQDT           OH Unused Date
     C                     Z-ADDBENRDT    PANRDT           OH Unused Date
     C                     Z-ADDBENSDT    PANSDT           OH Unused Date
     C                     Z-ADDBEBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    PABQTM           Time of Origina
     C                     Z-ADDBEBRTM    PABRTM           OH Unused Time
     C                     Z-ADDBEBSTM    PABSTM           OH Unused Time
     C                     Z-ADDBEBTTM    PABTTM           OH Unused Time
     C                     Z-ADDBEH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    PAC0C7           Claim Number
     C                     MOVELBEUVST    PAUVST    P      EDI Status 1
     C                     MOVELBEUWST    PAUWST    P      EDI Status 2
     C                     MOVELBEUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDBEAATM    PAAATM           Job Time
     C                     MOVELBEAYNA    PAAYNA    P      User Id
     C                     MOVELBEA0NA    PAA0NA    P      Job Name
     C                     Z-ADDBEAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * CHG Export Code        RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQTW01           Company Number
     C           *LIKE     DEFN WAC4NB    WQTW02           Order Number
      * Define keylist
     C           KPSTW     KLIST
     C                     KFLD           WQTW01           Company Number
     C                     KFLD           WQTW02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WQTW01           Company Number
     C                     KFLD           WQTW02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTW01           Company Number
     C                     Z-ADD#1C4NB    WQTW02           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
      * Establish starting position
     C           KPSTW     SETLL@BGWKKK                    *
     C           KRSTW     READE@BGWKKK                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Export Code        CH - PD Order Detail  * 
     C                     EXSR TXCHRC
     C           KRSTW     READE@BGWKKK                  90*
     C                     ENDDO
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXCHRC    BEGSR
      *================================================================
      * CHG Export Code        CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0520  70       Item Code
     C                     MOVEL*BLANK    WN0521  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0522  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0523  70       Order Group Cod
     C                     MOVEL*BLANK    WN0524  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0525  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0526 112       Billing Detail
     C                     Z-ADD*ZERO     WN0527 112       Billing Detail
     C                     Z-ADD*ZERO     WN0528 112       Billing Detail
     C                     Z-ADD*ZERO     WN0529 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0530  1        Comment Print A
     C                     MOVEL*BLANK    WN0531  1        Comment Print I
     C                     MOVEL*BLANK    WN0532  1        Comment Print P
     C                     MOVEL*BLANK    WN0533  1        Comment Print S
     C                     Z-ADD*ZERO     WN0534 112       Extended Amount
     C                     Z-ADD*ZERO     WN0535  70       Market Pricing
     C                     MOVEL*BLANK    WN0536  3        Commodity Marke
     C                     MOVEL*BLANK    WN0537  3        Date Method Cod
     C                     MOVEL*BLANK    WN0538  3        Price Method Co
     C                     Z-ADD*ZERO     WN0539 114       Price Overage O
     C                     Z-ADD*ZERO     WN0540  70       Contract Number
     C                     MOVEL*BLANK    WN0541  1        Price Status
     C                     Z-ADD*ZERO     WN0542  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0543  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0544  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0545  1        Work Confirm St
     C                     MOVEL*BLANK    WN0546  1        Work Over/Short
     C                     MOVEL*BLANK    WN0547  1        OD Production P
     C                     MOVEL*BLANK    WN0548 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0549 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0550  1        Age Code
     C                     MOVEL*BLANK    WN0551  1        Palletize
     C                     MOVEL*BLANK    WN0552  1        Slip Sheet
     C                     MOVEL*BLANK    WN0553  1        Catch Weight St
     C                     MOVEL*BLANK    WN0554  1        Price Audit
     C                     MOVEL*BLANK    WN0555  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0556  1        Production Date
     C                     Z-ADD*ZERO     WN0557 112       Rated Freight
     C                     Z-ADD*ZERO     WN0558 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0559 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0560 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0561 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0562 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0563 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0564 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0565 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0566 114       Unit Price
     C                     Z-ADD*ZERO     WN0567 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0568 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0569 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0570 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0571  70       Requested Ship
     C                     Z-ADD*ZERO     WN0572  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0573  70       Actual Shipped
     C                     MOVEL*BLANK    WN0574  1        Affect Inventor
     C                     MOVEL*BLANK    WN0575  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0576  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0577  30       Item Structure
     C                     Z-ADD*ZERO     WN0578  30       Item Structure
     C                     Z-ADD*ZERO     WN0579  30       Item Structure
     C                     MOVEL*BLANK    WN0580  2        Item Level
     C                     MOVEL*BLANK    WN0581  2        Quality Level
     C                     MOVEL*BLANK    WN0582  2        Pricing Product
     C                     MOVEL*BLANK    WN0583  2        Season Product
     C                     Z-ADD*ZERO     WN0584  70       Date of Origina
     C                     MOVEL*BLANK    WN0585 10        User Profile Na
     C                     MOVEL*BLANK    WN0586  2        Event Code
     C                     MOVEL*BLANK    WN0587  3        Reason Code
     C                     MOVEL*BLANK    WN0588  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0589  1        Modified Flag
     C                     MOVEL*BLANK    WN0590  1        Substituted Fla
     C                     MOVEL*BLANK    WN0591  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0592 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0593 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0594  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0595  1        OD Schedule Sho
     C                     MOVEL*BLANK    WN0596  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0597  1        Affect Commissi
     C                     MOVEL*BLANK    WN0598  1        Affect Pricing
     C                     MOVEL*BLANK    WN0599  1        Released by Use
     C                     MOVEL*BLANK    WN0600  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0601  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0602  3        Production Ware
     C                     MOVEL*BLANK    WN0603  3        OD Price Type
     C                     Z-ADD*ZERO     WN0604  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0605  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0606  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0607  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0608  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0609  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0610  60       Price Code
     C                     Z-ADD*ZERO     WN0611  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0612  60       Substitution Li
     C                     Z-ADD*ZERO     WN0613  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0614 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0615 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0616 112       OD Item Target
     C                     Z-ADD*ZERO     WN0617 112       OD Minimum Unit
     C                     Z-ADD*ZERO     WN0618 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0619 114       Order Gate Pric
     C                     Z-ADD*ZERO     WN0620 114       OD Unused Prc 2
     C                     Z-ADD*ZERO     WN0621 114       OD Unused Prc 3
     C                     Z-ADD*ZERO     WN0622 114       OD Unused Prc 4
     C                     Z-ADD*ZERO     WN0623 114       OD Unused Prc 5
     C                     MOVEL*BLANK    WN0624  1        EDI Status 1
     C                     MOVEL*BLANK    WN0625  1        EDI Status 2
     C                     MOVEL*BLANK    WN0626  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0627  60       Job Time
     C                     MOVEL*BLANK    WN0628 10        User Id
     C                     MOVEL*BLANK    WN0629 10        Job Name
     C                     Z-ADD*ZERO     WN0630  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWAAIC3    WSAIC3           Company Number
     C                     Z-ADDWAC4NB    WSC4NB           Order Number
     C                     Z-ADDWADPNB    WSDPNB           Order Sequence
     C                     Z-ADDWAUENB    WSUENB           Order Secondary
      *
     C           KLCHTX    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
     C                     KFLD           WSDPNB           Order Sequence
     C                     KFLD           WSUENB           Order Secondary
     C           KLCHTX    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YFRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#DKXCD    WSKXCD    P      Country Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Rtv Min Temp for Load RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     Z-ADD-99       WUPCNX           USR Temperature
     C                     MOVELWUOTTX    WUFRSX           Shipping Temp C
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQTY02           Load ID
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WQTY02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTY02           Load ID
      * Establish starting position
     C           KRSTY     SETLL@BFCPD9                    *
     C           KRSTY     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * **** new 7/19/02
      * If db1 doesnt match par, convert db1 temp to par temp C or F
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Shipping Temp Code C/F NE WRK.Blank for 4
      *   |- c2    : PAR.Shipping Temp Code C/F NE DB1.Shipping Temp Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUFRSX    IFNE WUOTTX                     *IF
     C           WUFRSX    IFNE WFFRSX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Shipping Temp Code C/F is Celsius
     C           WUFRSX    IFEQ 'C'                        *IF
      * Convert DB1 to Celsius
      * Compute Cels from Fahr
      * LCL.USR Temperature 3.1 =
      *    *COMPUTE (((x1 - x2) * x3) / x4)
      * x1    : DB1.Reefer Temperature
      * -     : PGM.*Synon (17,7) work field
      * x2    : CON.32
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.5
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.9
     C           WFRNNB    SUB  32        W0WD02           *Synon (17,7) w
     C           W0WD02    MULT 5         W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  9         W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           USR Temperature
     C                     ELSE
      * CASE: *OTHERWISE
      * Convert DB1 to Fahr
      * Compute Fahr from Cels
      * LCL.USR Temperature 3.1 =
      *    *COMPUTE (((x1 * x3) / x4) + x2)
      * x1    : DB1.Reefer Temperature
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.9
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.5
      * +     : PGM.*Synon (17,7) work field
      * x2    : CON.32
     C           WFRNNB    MULT 9         W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  5         W0WD01    H      *Synon (17,7) w
     C           W0WD01    ADD  32        W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0012           USR Temperature
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWFRNNB    YL0012           USR Temperature
     C                     END                             *FI
      * CASE: LCL.USR Temperature 3.1 GT PAR.USR Temperature 3.1
     C           YL0012    IFGT WUPCNX                     *IF
     C                     Z-ADDWFRNNB    WUPCNX           USR Temperature
     C                     MOVELWFFRSX    WUFRSX           Shipping Temp C
     C                     END                             *FI
     C           KRSTY     READE@BFCPD9                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Temperature 3.1 is Low
     C           WUPCNX    IFEQ -99                        *IF
     C                     Z-ADD*ZERO     WUPCNX           USR Temperature
     C                     END                             *FI
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCHRC    BEGSR
      *================================================================
      * CHG Shipping Temp      CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0631  30       Company Number
     C                     Z-ADD*ZERO     WN0632  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0633  1        LTL Flag
     C                     MOVEL*BLANK    WN0634  1        Load Status
     C                     MOVEL*BLANK    WN0635 15        Seal 1
     C                     MOVEL*BLANK    WN0636 15        Seal 2
     C                     MOVEL*BLANK    WN0637 15        Seal 3
     C                     MOVEL*BLANK    WN0638 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0639 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0640  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0641 112       Flat Amount
     C                     MOVEL*BLANK    WN0642  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0643  50       Total Stops
     C                     MOVEL*BLANK    WN0644 20        Trailer Id
     C                     MOVEL*BLANK    WN0645  3        Initials of Con
     C                     Z-ADD*ZERO     WN0646  40       BOL Time
     C                     MOVEL*BLANK    WN0647  3        Carrier Code
     C                     MOVEL*BLANK    WN0648  7        Truck Size
     C                     Z-ADD*ZERO     WN0649  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0650 112       Rated Freight
     C                     MOVEL*BLANK    WN0651  1        Ship Status
     C                     MOVEL*BLANK    WN0652  1        Load Type
     C                     Z-ADD*ZERO     WN0653  50       Number Pallets
     C                     Z-ADD*ZERO     WN0654  50       Number Pallets
     C                     Z-ADD*ZERO     WN0655 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0656  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0657  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0658  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0659 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0660 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0661  70       Actual Departur
     C                     Z-ADD*ZERO     WN0662  40       Departure Time
     C                     Z-ADD*ZERO     WN0663  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0664  52       Product Tempera
     C                     Z-ADD*ZERO     WN0665  50       Number Pallets
     C                     MOVEL*BLANK    WN0666 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0667  70       Total Load Mile
     C                     MOVEL*BLANK    WN0668 12        Recorder ID
     C                     MOVEL*BLANK    WN0669  2        Shipping Method
     C                     MOVEL*BLANK    WN0670  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0671  2        Ship To State C
     C                     Z-ADD*ZERO     WN0672  70       Gross Weight
     C                     MOVEL*BLANK    WN0673  3        Carrier Broker
     C                     MOVEL*BLANK    WN0674  1        Export Status
     C                     Z-ADD*ZERO     WN0675  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0676  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0677  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0678  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0679  70       Spotted Date
     C                     Z-ADD*ZERO     WN0680  60       Spotted Time
     C                     Z-ADD*ZERO     WN0681  70       Load Finished D
     C                     Z-ADD*ZERO     WN0682  60       Load Finished T
     C                     Z-ADD*ZERO     WN0683  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0684  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0685  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0686  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0687  70       Truck Departure
     C                     Z-ADD*ZERO     WN0688  60       Truck Departure
     C                     Z-ADD*ZERO     WN0689  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0690  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0691  3        Shipping Line
     C                     MOVEL*BLANK    WN0692 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0693 30        Vessel Name
     C                     Z-ADD*ZERO     WN0694  50       Voyage
     C                     Z-ADD*ZERO     WN0695  70       Sail Date
     C                     MOVEL*BLANK    WN0696 12        Booking Number
     C                     MOVEL*BLANK    WN0697 20        Discharge Port
     C                     Z-ADD*ZERO     WN0698  70       Arrival Date
     C                     MOVEL*BLANK    WN0699 12        Container Numbe
     C                     Z-ADD*ZERO     WN0700  70       Date In
     C                     Z-ADD*ZERO     WN0701  60       Time In
     C                     Z-ADD*ZERO     WN0702  70       Date Out
     C                     Z-ADD*ZERO     WN0703  60       Time Out
     C                     Z-ADD*ZERO     WN0704 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0705  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0706  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0707  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0708  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0709  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0710  70       Requested Deliv
     C                     MOVEL*BLANK    WN0711  1        Load Acceptance
     C                     MOVEL*BLANK    WN0712  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0713  70       On Yard Date
     C                     Z-ADD*ZERO     WN0714  60       On Yard Time
     C                     Z-ADD*ZERO     WN0715  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0716  60       Deadline Depart
     C                     MOVEL*BLANK    WN0717  1        Load Held Over
     C                     MOVEL*BLANK    WN0718  1        Load Held Over
     C                     MOVEL*BLANK    WN0719 15        Load Held Over
     C                     MOVEL*BLANK    WN0720 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0721 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0722  70       Express Mail Da
     C                     MOVEL*BLANK    WN0723  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0724  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0725  70       Product Complet
     C                     Z-ADD*ZERO     WN0726  60       Product Complet
     C                     Z-ADD*ZERO     WN0727  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0728  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0729  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0730  1        Load Confirmed
     C                     MOVEL*BLANK    WN0731 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0732  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0733  60       Load Door 1
     C                     Z-ADD*ZERO     WN0734  70       Override Total
     C                     Z-ADD*ZERO     WN0735  60       Load Door 2
     C                     MOVEL*BLANK    WN0736  1        Partial Load
     C                     MOVEL*BLANK    WN0737  1        Load Confirmati
     C                     MOVEL*BLANK    WN0738  1        Export Load USD
     C                     MOVEL*BLANK    WN0739  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0740 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0741 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0742 15        Late Billing Em
     C                     MOVEL*BLANK    WN0743 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0744  1        Multi Company L
     C                     MOVEL*BLANK    WN0745  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0746  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0747  1        LH Unused Sts 3
     C                     MOVEL*BLANK    WN0748  1        LH Unused Sts 4
     C                     MOVEL*BLANK    WN0749  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0750  2        Load U/M
     C                     MOVEL*BLANK    WN0751  2        LH Unused Sts 7
     C                     MOVEL*BLANK    WN0752  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0753  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0754  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0755  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0756  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0757  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0758  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0759  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0760  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0761  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0762  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0763  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0764  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0765  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0766  60       LH Unused Time
     C                     MOVEL*BLANK    WN0767  1        EDI Status 1
     C                     MOVEL*BLANK    WN0768  1        EDI Status 2
     C                     MOVEL*BLANK    WN0769  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0770  60       Job Time
     C                     MOVEL*BLANK    WN0771 10        User Id
     C                     MOVEL*BLANK    WN0772 10        Job Name
     C                     Z-ADD*ZERO     WN0773  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WGRMNB           Load ID
      *
     C           KLCHTZ    KLIST
     C                     KFLD           WGRMNB           Load ID
     C           KLCHTZ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YGRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWUPCNX    WGRNNB           Reefer Temperat
     C                     MOVELWUFRSX    WGWRTX    P      Shipping Temp C
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * 06/28/2006 LJB TRF011
      * ** Added 3 char LH On-Time Reason Code as an input parm to
      * ** replace the 1 char On Time Reason parm
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * FP1061
      * TCJ 10/03/07 - Load Order Change Log created if Carrier Code or
      *                Scheduled Delivery Date changes
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Post Order.
      *================================================================
      * RTV Chk Detail Exists  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0052           Company Number
     C                     Z-ADD#1C4NB    WL0053           Order Number
     C                     EXSR TPRVGN
      * Msg 'Order has no line items'
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Send message 'Order has no line items'
     C                     MOVEL'USR2058' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
     C                     MOVEL'N'       WUQ2ST           Status Flag 2
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'N'       WUFMST           Status Flag 4
     C                     MOVEL'Y'       WUAJTX           Status Flag 5
      * 8/28/08 SAZ add parm for EDI ACK to cust
     C                     MOVEL'Y'       WUACTX           Status Flag 6
      * ** 12/01/08 LJB E00255 Default Fax to Cust parm
     C                     MOVEL'N'       WUAKTX           Status Flag 7
      * SEL Confirm Prompt     PV - Order Header TRG  * 
     C                     CALL 'PDS0PVR'              90  SEL Confirm Pro
     C                     PARM *BLANK    W0RTN   7
     C           WUB8ST    PARM WUB8ST    WQ0178  1        Status - Y or N
     C                     PARM #1AIC3    WQ0179  30       Company Number
     C                     PARM #1C4NB    WQ0180  70       Order Number
     C                     PARM #1BKC7    WQ0181  70       Ship To Custome
     C                     PARM 'N'       WQ0182  1        Broker Order St
     C           WUDTSX    PARM WUDTSX    WQ0183  1        Print (Yes/No)
     C           WUQ2ST    PARM WUQ2ST    WQ0184  1        Status Flag 2
     C           WUQ3ST    PARM WUQ3ST    WQ0185  1        Status Flag 3
     C           WUFMST    PARM WUFMST    WQ0186  1        Status Flag 4
     C           WUAJTX    PARM WUAJTX    WQ0187  1        Status Flag 5
     C           WUACTX    PARM WUACTX    WQ0188  1        Status Flag 6
     C           WUAKTX    PARM WUAKTX    WQ0189  1        Status Flag 7
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDS0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * Post and Print Acknowledgement and Get Rdy Rpt
      * CASE: WRK.Status - Y or N is no
     C           WUB8ST    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
     C                     MOVEL'PDSRE1R' P2BYVN           Next Program Na
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
      * EDT Post Open Orders 2 XF - Order Header TRG  * 
     C                     CALL 'POI4XFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0190  30       Company Number
     C                     PARM #1C4NB    WQ0191  70       Order Number
     C                     PARM #1BKC7    WQ0192  70       Ship To Custome
     C           #1JZVA    PARM #1JZVA    WQ0193 112       Order Value Tot
     C           #1A1WG    PARM *ZERO     WQ0194 112       Order Weight To
     C                     PARM #DKXCD    WQ0195  6        USR Country Cod
     C                     PARM #DAJCD    WQ0196  3        USR Warehouse C
     C                     PARM 'OE'      WQ0197  3        Pricing Event C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993245*
     C                     SETON                     37    *
     C                     END
      * Print Acknowledgement if flag is yes from the confirm prompt
      * CASE: WRK.Print (Yes/No) USR is Yes
     C           WUDTSX    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUWUST           PRT Night Queue
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,04    WQ0198 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0199 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0200  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0201  4        PRT Save Output
     C           WUDYNB    PARM WUDYNB    WQ0202  20       PRT Number of C
     C           WUWUST    PARM WUWUST    WQ0203  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0204 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0205  6        Application Cod
     C                     PARM WUA7ST    WQ0206  1        Paper Type USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * SBMJOB: PRT Acknowledgements UP - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PDJWPCLP'#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#DFKNB    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1C4NB    #SPAK  309       Order Number 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1C4NB    #SPAK  309       Order Number 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Thru Date Pass
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Order Type - Sa
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUOTTX    #SSTR     P      Shipping Method
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'1'       #SSTR     P      Billing Activit
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'A'       #SSTR     P      Export Sales
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR Warehouse C
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 1
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 2
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 3
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 4
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 5
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 6
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 7
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 8
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 9
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'S'       #SSTR     P      USR Select/Omit
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWRST    #SSTR     P      PRT Printer Dev
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWSST    #SSTR     P      PRT Hold Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWTST    #SSTR     P      PRT Save Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUDYNB    #SPAK  309       System Value Nu
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'*JOBD'   #SSTR     P      PRT Night Queue
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 3
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PDJWPCLP'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Print Get Ready Report if flag is yes from the confirm prompt
      * CASE: WRK.Status Flag 5  Y/N is Yes
     C           WUAJTX    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUWUST           PRT Night Queue
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,05    WQ0207 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0208 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0209  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0210  4        PRT Save Output
     C           WUDYNB    PARM WUDYNB    WQ0211  20       PRT Number of C
     C           WUWUST    PARM WUWUST    WQ0212  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0213 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0214  6        Application Cod
     C                     PARM WUA7ST    WQ0215  1        Paper Type USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * SBMJOB: PRT Get Ready Report   UP - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0002    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PMH5UPC '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#DFKNB    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1C4NB    #SPAK  309       Order Number 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1C4NB    #SPAK  309       Order Number 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWRST    #SSTR     P      PRT Printer Dev
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWSST    #SSTR     P      PRT Hold Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWTST    #SSTR     P      PRT Save Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUDYNB    #SPAK  309       System Value Nu
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'*JOBD'   #SSTR     P      PRT Night Queue
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Department Code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 6         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PMH5UPC 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMH5UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * EDI Acknowledgement to customer if flag is yes
      * CASE: WRK.Status Flag 6  Y/N is Yes
     C           WUACTX    IFEQ 'Y'                        *IF
      * RTV EDI PO Ack        XF - Order Header TRG  * 
     C                     CALL 'PMXJXFR'              90  RTV EDI PO Ack
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0216  30       Company
     C                     PARM #1C4NB    WQ0217  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMXJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Fax Acknwlgmnt to buyer/fld/brkr/cust if flag=yes f/confirm pmt
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : WRK.Status Flag 2  Y/N is Yes
      *   |- c2    : WRK.Status Flag 3  Y/N is Yes
      *   |- c3    : WRK.Status Flag 4  Y/N is yes
      *   |- c4    : WRK.Status Flag 7  Y/N is Yes
      *   '-
     C           WUQ2ST    IFEQ 'Y'                        *IF
     C           WUQ3ST    OREQ 'Y'                        *OR
     C           WUFMST    OREQ 'Y'                        *OR
     C           WUAKTX    OREQ 'Y'                        *OR
      * ** Status Flag 2=Buyer Fax, Status Flag 3=Regional Sales Manager
      * ** Status Flag 4=Broker Fax-which is not used at this level
      * ** Status Flag 7=Customer Fax
      * SBMJOB: EXC Fax Acknwgmnt     XF - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0003    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PPFDXFR '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     MOVELW0RTN     #SSTR     P      *Return code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1AIC3    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1C4NB    #SPAK  309       Order Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#1BKC7    #SPAK  309       Ship To Custome
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL#1FXSX    #SSTR     P      Unused OH Code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUQ2ST    #SSTR     P      USR Update Flag
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUQ3ST    #SSTR     P      USR Check Y/N S
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUFMST    #SSTR     P      Status - Y or N
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUAKTX    #SSTR     P      Status Flag 7
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PPFDXFR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPFDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****************************************************************
      * *****  Special note *****
      * ** Any changes that affect the movement of trucks needs to be
      * ** given the department control code of TRF (Transportation)
      * ** not SLS (Sales), and a Load Order Change Log record is to be w
      * **   a. All Date changes   b. Warehouse change   c. Shipping meth
      * **   d. any change that affects the movement of a truck (not cont
      * ** This way Traffic will be notified that a change has been made
      * ** and they can notify the correct carriers (both the old and new
      * ***** Status Flags:
      * ** Print (Yes/No) USR=Print Acknowledgement,
      * ** Status Flag 2=Buyer Fax, Status Flag 3=Regional Sales Manager
      * ** Status Flag 4=Broker Fax-which is not used at this level
      * ** Status Flag 5=Print Get Ready Rpt, Status Flag 6=EDI Ack to Cu
      * ** Status Flag 7=Fax Ack to Customer
      * *****************************************************************
      * ** FP1303 LJB 01/15/09  RTV the delivery p.o. from OHE file
      * ** If Delivery P.O. has changed then update the OHE file
      * *****
      * ** 12/01/2008 LJB E00255 - Added Fax Ack to customer in F20
      * ** 9/23/2008 SAZ E00178 - Added code to EDI the Acknowledgement t
      * ** 8/05/2008 RMC E00180 - in Command Key section, moved update
      * ** of Order Header outside of CASE stmts to make sure its done
      * ** before the F16.  Loads were getting planned and flagged as und
      * ** because the order header weight wasnt updated yet.
      * *****
      * ** 7/08/2008 RMC E00180 - dont allow F16 if ordered weight is -0-
      * ** need this because of the underweight load change log creation
      * *****
      * ** 6/25/2008 LJB FP1098
      * ** Retrieve Export Defaults from Co/Cust for existing record
      * ** update country code if type code is "EX"port for existing rec
      * *****
      * ** 6/05/2008 LJB E00139
      * ** Save PO# and Load ID.
      * *****
      * ** 05/16/2008 LJB
      * ** Time field cannot be zeros on an existing record. Unlock the
      * ** field and send error message.
      * *****
      * ** 04/28/2008 LJB E00147
      * ** Test dates to see if they have been changed. if not, don't
      * ** send error messages.
      * *****
      * ** 04/22/2008 LJB E00147
      * ** Requested Ship Date cannot be after Requested Delivery Date
      * *****
      * ** 04/04/2008 LJB E00127
      * ** If Ship Method changed from Collect to Prepaid, blank
      * ** out the carrier code
      * *****
      * ** 03/04/2008 LJB FP1251
      * ** If the Shipping Method changes in the order header and the
      * ** order is tied to a load, change the shipping method in
      * ** the Load Header as well.
      * *****
      * ** 02/21/2008 LJB FP1251
      * ** Add Requested Ship Date to the tests in the Must Ship Date
      * ** routine.
      * *****
      * ** 01/14/2008 RMC FP1100 HPB
      * ** If company org is "H"PB default Print Pick Slip to "N"o.
      * *****
      * ** 01/03/2008 LJB E-OMS23
      * ** Do not allow the Ship Date to be before the Delivery Date. Unl
      * ** the field if there is an error so it can be corrected.
      * *****
      * ** 01/03/2008 LJB E-TRANS47 (Reverse FP1061)
      * ** Change the department code back to Traffic (from Sales) if the
      * ** Shipping Method changes. This will notify traffic that the ori
      * ** shipping company needs to be notified of a delete.
      * *****
      * ** 12/14/2007 RMC FP1110 HPB
      * ** If order is on a HPB Batch, then Retire all the RINS when del
      * ** the order off of a load. they may exist if the order was shipp
      * *****
      * ** 11/16/2007 LJB FP1251
      * ** If shipping method is CR or CT, default carrier to "BUY"
      * ** and protect from change until shipping method is changed
      * ** If this changes the carrier then write a record to
      * ** the Load Order Change Log so Traffic sees the change
      * *****
      * ** 10/23/2007 LJB Support
      * ** Change the test on Requested Delivery date: Use WRK field to l
      * ** instead of Load ID *ne blanks, Unlock and allow change if
      * ** it is before the scheduled delivery date
      * *****
      * 8/01/07 RMC - for TR orders, Acct Co of whse on screen must eq
      *   the To Whse on the Transfer customer number
      * *****
      * 6/20/07 Added Get Ready Report JRB DLY0129 in > F20=Post Order
      * *****
      * ** 05/24/2007 RMC DLY029
      * ** Broker not in OH so dont validate here;take broker order sts o
      * *****
      * ** 05/21/2007 LJB DLY029
      * ** Change parms to Fax Acknowledgements to accommodate additional
      * ** parms required for new companies.
      * *****
      * PKTR01: Output air freight order sts from cust ext    08/09/06 RM
      * *****
      * workin: Add company# and order# to parms being passed  08/31/06 L
      *         to WW Loads Order Entry (F16)
      * *****
      * 01/23/07 Added error if Req Delv time < 0
      * *****
      * PK0519: Changes for Broker Order              10/20/03 RMC
      * *****
      * PKTR01: Changes for new Plant                 07/21/04 RMC
      * *****
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0042  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0043  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0044  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWE    KLIST
     C                     KFLD           WEAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3
     C           KLVBWE    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Order Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Order Type - Sa
     C           YPMTFD    OREQ '#1JNCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JNCD' defaulted for 'Order Type - Sales'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1OBST' defaulted for 'Billing Activity Type'.
     C                     CALL 'PDG1SRR'              90  SEL By Billing
     C                     PARM *BLANK    W0RTN   7
     C           #1JNCD    PARM #1JNCD    WQ0115  2        Order Type - Sa
     C                     PARM #1OBST    WQ0116  1        Billing Activit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9933  *
     C                     END
      *
     C           #1JNCD    IFNE *BLANK                     Order Type - Sa
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JNCD    IFEQ *BLANK                     Order Type - Sa
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCEX    KLIST
     C                     KFLD           EXJNCD           Order Type - Sa
      * Setup key
     C                     MOVEL#1JNCD    EXJNCD
     C           KLVCEX    CHAIN@EXRETY              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Order Types            NF'
     C                     MOVEL'USR1063' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1063' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1ANC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ANC7' defaulted for 'A/R Customer Number'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1ANC7    PARM #1ANC7    WQ0117  70       Ship To Custome
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ANC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ANC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1ANC7    BBBKC7
     C           KLVDBB    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1DBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1DBCD' defaulted for 'Ship To State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1DBCD    PARM #1DBCD    WQ0118  2        State Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1DBCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DBCD    IFEQ *BLANK                     State Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1DBCD    ACBGCD
     C           KLVEAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1B0C7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Ship To Custome
     C           YPMTFD    OREQ '#1B0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1B0C7' defaulted for 'Bill to Customer'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1B0C7    PARM #1B0C7    WQ0119  70       Ship To Custome
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1B0C7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1B0C7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1B0C7    BBBKC7
     C           KLVFBB    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BHCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1BHCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BHCD' defaulted for 'Bill to State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1BHCD    PARM #1BHCD    WQ0120  2        State Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BHCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BHCD    IFEQ *BLANK                     State Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1BHCD    ACBGCD
     C           KLVGAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A0DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A0DT    AFBCDT
     C           KLVHAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A5DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A5DT    AFBCDT
     C           KLVIAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1GNDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1GNDT    AFBCDT
     C           KLVJAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ACDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1ACDT    AFBCDT
     C           KLVKAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Terms
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AQCD    WK1X02  1
     C           YPMTFD    IFEQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Terms Code
     C           YPMTFD    OREQ '#1AQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1AQCD' defaulted for 'Terms Code'.
     C                     CALL 'PDDMSRR'              90  SEL Active Term
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0121  30       Company Number
     C           #1AQCD    PARM #1AQCD    WQ0122  2        Terms Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AQCD    IFNE *BLANK                     Terms Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VLEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AQCD    IFEQ *BLANK                     Terms Code
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLAO    KLIST
     C                     KFLD           AOAIC3           Company Number
     C                     KFLD           AOAQCD           Terms Code
      * Setup key
     C                     Z-ADD#1AIC3    AOAIC3
     C                     MOVEL#1AQCD    AOAQCD
     C           KLVLAO    CHAIN@AOREU1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Terms                  NF'
     C                     MOVEL'USR0037' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0037' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Carrier
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BZNA    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1BZNA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0123  3        Carrier Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BZNA    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BZNA    IFEQ *BLANK                     Carrier Code
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMFF    KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    FFBZNA
     C           KLVMFF    CHAIN@FFREUG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Carrier                NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to OP Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CQCD' defaulted for 'Reason Code'.
     C                     CALL 'OPTNSRR'              90  SEL Order Reaso
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0124  3        Reason Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPTNSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNCX    KLIST
     C                     KFLD           CXCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    CXCQCD
     C           KLVNCX    CHAIN@CXRET4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'OP Reason Codes        NF'
     C                     MOVEL'USR0504' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0504' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AODT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AODT    AFBCDT
     C           KLVOAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VOEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1EIDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1EIDT    AFBCDT
     C           KLVPAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VPEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to Enterprise Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1E8CD    WK1X02  1
     C                     MOVEL#1E9CD    WK1X03  1
     C           YPMTFD    IFEQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Enterprise Code
     C           YPMTFD    OREQ '#1E8CD'
     C           WK1X03    OREQ '?'                        Enterprise Code
     C           YPMTFD    OREQ '#1E9CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1E8CD' defaulted for 'Accounts Receiv. Ent 1'.
      * Field '(DTL) #1E9CD' defaulted for 'Accounts Receiv. Ent 2'.
     C                     CALL 'CAXTSRR'              90  SEL Enterprise
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0125  30       Company Number
     C           #1E8CD    PARM #1E8CD    WQ0126  4        Enterprise Code
     C           #1E9CD    PARM #1E9CD    WQ0127 12        Enterprise Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAXTSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1E8CD    IFNE *BLANK                     Enterprise Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1E9CD    IFNE *BLANK                     Enterprise Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VQEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1E8CD    IFEQ *BLANK                     Enterprise Code
     C           #1E9CD    ANDEQ*BLANK                     Enterprise Code
     C                     GOTO VQEXIT
     C                     END
      *
     C           KLVQDS    KLIST
     C                     KFLD           DSAIC3           Company Number
     C                     KFLD           DSDQCD           Enterprise Code
     C                     KFLD           DSDRCD           Enterprise Code
      * Setup key
     C                     Z-ADD#1AIC3    DSAIC3
     C                     MOVEL#1E8CD    DSDQCD
     C                     MOVEL#1E9CD    DSDRCD
     C           KLVQDS    CHAIN@DSRETN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VQEXIT
     C                     END
      * Send message 'Enterprise Master      NF'
     C                     MOVEL'USR0765' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0765' W0RTN
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to Load Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #1RMNB    PARM #1RMNB    WQ0128  70       Load ID
     C           #1AIC3    PARM #1AIC3    WQ0129  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VREXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RMNB    IFEQ *ZERO                      Load ID
     C                     GOTO VREXIT
     C                     END
      *
     C           KLVRFJ    KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB
     C           KLVRFJ    CHAIN@FJCPBN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VREXIT
     C                     END
      * Send message 'Load Header            NF'
     C                     MOVEL'USR1188' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1188' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Sales Route Cod
     C           YPMTFD    OREQ '#1R4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0130  3        Sales Route Cod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1R4CD    IFNE *BLANK                     Sales Route Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VSEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R4CD    IFEQ *BLANK                     Sales Route Cod
     C                     GOTO VSEXIT
     C                     END
      *
     C           KLVSJE    KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD
     C           KLVSJE    CHAIN@JEREWS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VSEXIT
     C                     END
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1800' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         VTCKRL    BEGSR
      *================================================================
      * Check reference to Manager Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BFCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Manager Level C
     C           YPMTFD    OREQ '#1BFCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BFCD' defaulted for 'Manager Level Code'.
     C                     CALL 'CABRSRR'              90  SEL Manager Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1BFCD    PARM #1BFCD    WQ0131  2        Manager Level C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BFCD    IFNE *BLANK                     Manager Level C
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VTEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BFCD    IFEQ *BLANK                     Manager Level C
     C                     GOTO VTEXIT
     C                     END
      *
     C           KLVTWR    KLIST
     C                     KFLD           WRBFCD           Manager Level C
      * Setup key
     C                     MOVEL#1BFCD    WRBFCD
     C           KLVTWR    CHAIN@ALREVE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VTEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VTEXIT
     C                     END
      * Send message 'Manager Level          NF'
     C                     MOVEL'USR0030' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0030' W0RTN
      *================================================================
     CSR         VTEXIT    ENDSR
      /EJECT
     CSR         VUCKRL    BEGSR
      *================================================================
      * Check reference to VP Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        VP Level Code
     C           YPMTFD    OREQ '#1Q4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1Q4CD' defaulted for 'VP Level Code'.
     C                     CALL 'PDE0SRR'              90  SEL VP Level Ac
     C                     PARM *BLANK    W0RTN   7
     C           #1Q4CD    PARM #1Q4CD    WQ0132  3        VP Level Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1Q4CD    IFNE *BLANK                     VP Level Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VUEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q4CD    IFEQ *BLANK                     VP Level Code
     C                     GOTO VUEXIT
     C                     END
      *
     C           KLVUIF    KLIST
     C                     KFLD           IFQ4CD           VP Level Code
      * Setup key
     C                     MOVEL#1Q4CD    IFQ4CD
     C           KLVUIF    CHAIN@IFREWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VUEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VUEXIT
     C                     END
      * Send message 'VP Level               NF'
     C                     MOVEL'USR1661' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1661' W0RTN
      *================================================================
     CSR         VUEXIT    ENDSR
      /EJECT
     CSR         VVCKRL    BEGSR
      *================================================================
      * Check reference to Order Header TRG
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1AIC3'
     C           YPMTFD    OREQ '#1T3NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1T3NB' defaulted for 'Attach to Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0133  30       Company Number
     C           #1T3NB    PARM #1T3NB    WQ0134  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1T3NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VVEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1T3NB    IFEQ *ZERO                      Order Number
     C                     GOTO VVEXIT
     C                     END
      *
     C           KLVVBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1T3NB    BEC4NB
     C           KLVVBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VVEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VVEXIT
     C                     END
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' W0RTN
      *================================================================
     CSR         VVEXIT    ENDSR
      /EJECT
     CSR         VWCKRL    BEGSR
      *================================================================
      * Check reference to Internal Reason
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1SICD    IFEQ *BLANK                     Internal Reason
     C                     GOTO VWEXIT
     C                     END
      *
     C           KLVWJH    KLIST
     C                     KFLD           JHSGCD           Internal Reason
      * Setup key
     C                     MOVEL#1SICD    JHSGCD
     C           KLVWJH    CHAIN@JHREXO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VWEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VWEXIT
     C                     END
      * Send message 'Internal Reason        NF'
     C                     MOVEL'USR1835' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1835' W0RTN
      *================================================================
     CSR         VWEXIT    ENDSR
      /EJECT
     CSR         VXCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AWDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VXEXIT
     C                     END
      *
     C           KLVXAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AWDT    AFBCDT
     C           KLVXAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VXEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VXEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VXEXIT    ENDSR
      /EJECT
     CSR         VYCKRL    BEGSR
      *================================================================
      * Check reference to Event Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Event Code
     C           YPMTFD    OREQ '#1JPCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JPCD' defaulted for 'Event Code'.
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #1JPCD    PARM #1JPCD    WQ0135  2        Event Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1JPCD    IFNE *BLANK                     Event Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VYEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JPCD    IFEQ *BLANK                     Event Code
     C                     GOTO VYEXIT
     C                     END
      *
     C           KLVYEZ    KLIST
     C                     KFLD           EZJPCD           Event Code
      * Setup key
     C                     MOVEL#1JPCD    EZJPCD
     C           KLVYEZ    CHAIN@EZREYT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VYEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VYEXIT
     C                     END
      * Send message 'Event Types            NF'
     C                     MOVEL'USR1076' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1076' W0RTN
      *================================================================
     CSR         VYEXIT    ENDSR
      /EJECT
     CSR         VZCKRL    BEGSR
      *================================================================
      * Check reference to A/R Claim
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1C0C7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Claim Number
     C           YPMTFD    OREQ '#1C0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1C0C7' defaulted for 'Claim Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0010' defaulted for 'Claim Company Number'.
      * Field '(LCL) YL0011' defaulted for 'Claim Ship to Customer'.
     C                     CALL 'PMCSSRR'              90  Sel A/R Claim
     C                     PARM *BLANK    W0RTN   7
     C           #1C0C7    PARM #1C0C7    WQ0136  70       Claim Number
     C           YL0010    PARM YL0010    WQ0137  30       Claim Company N
     C           YL0011    PARM YL0011    WQ0138  70       Claim Ship to C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9952  *
     C                     END
      *
     C           #1C0C7    IFNE *ZERO                      Claim Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VZEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1C0C7    IFEQ *ZERO                      Claim Number
     C                     GOTO VZEXIT
     C                     END
      *
     C           KLVZMK    KLIST
     C                     KFLD           MKC0C7           Claim Number
      * Setup key
     C                     Z-ADD#1C0C7    MKC0C7
     C           KLVZMK    CHAIN@MKCPWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VZEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VZEXIT
     C                     END
      * Send message 'A/R Claim              NF'
     C                     MOVEL'USR2729' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2729' W0RTN
      *================================================================
     CSR         VZEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR1    IFEQ '1'
     C           W0OVR1    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C                     Z-ADDW0ROW1    ZZCSRW
     C                     Z-ADDW0COL1    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0ROW1  30
     C                     Z-ADD0         W0COL1  30
     C                     MOVE '2'       W0OVR1  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE019
     C           ZHCSCL    ANDLE021
     C           @#DFMT    ANDEQ'#RCDKEY'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE073
     C           ZHCSCL    ANDLE074
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN77     ANDEQ'0'
     C                     MOVEL'#1JNCD'  YPMTFD           Order Type - Sa
     C                     END
      *
     C           ZHCSRW    IFEQ 014
     C           ZHCSCL    ANDEQ073
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1FRSX'  YPMTFD           Shipping Temp C
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDGE023
     C           ZHCSCL    ANDLE024
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN71     ANDEQ'0'
     C                     MOVEL'#1Q2CD'  YPMTFD           Shipping Method
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDEQ048
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1U2ST'  YPMTFD           Export Status
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDEQ077
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1FQSX'  YPMTFD           Export Docs Go
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ023
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN70     ANDEQ'0'
     C                     MOVEL'#1BCST'  YPMTFD           Block Order Fla
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ033
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1PJST'  YPMTFD           LTL Flag
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ058
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1BDST'  YPMTFD           Order Certifica
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ077
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1FNSX'  YPMTFD           Transfer in Sto
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDGE071
     C           ZHCSCL    ANDLE077
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1C0C7'  YPMTFD           Claim Number
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * Val Order Hdr Exists   RT - PD Order Header  * 
     C                     EXSR NCRVGN
      * Only allow F3 if order doesn't exist (no processing has been done
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO ZXEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     MOVEL'NOUPD'   P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO ZXEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1BRTX           Ship To Name
     C                     MOVEL*BLANK    P1BCNA           Customer Purcha
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     MOVEL*BLANK    P1Q2CD           Shipping Method
     C                     MOVEL*BLANK    P1U2ST           Export Status
     C                     Z-ADD*ZERO     P1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     MOVEL*BLANK    P1FRSX           Shipping Temp C
     C                     MOVEL*BLANK    P1FTSX           Air Freight Ord
     C                     MOVEL*BLANK    P2APTX           Company Name
     C                     MOVEL*BLANK    P2TAST           First Time Flag
     C                     MOVEL*BLANK    P2G7SX           Ship Method
     C                     MOVEL*BLANK    P2A5AA           Country Code
     C                     MOVEL*BLANK    P2OPSX           User Access
     C                     MOVEL*BLANK    P3Z9ST           Shipping Method
     C                     MOVEL*BLANK    P3CSST           Load Type Dft
     C                     MOVEL*BLANK    P3Z8ST           LTL Flag Dft
     C                     MOVEL*BLANK    P3CXST           Export Status D
     C                     MOVEL*BLANK    P3SWST           Shrink Wrap Dft
     C                     Z-ADD*ZERO     P3XXTM           Departure Time
     C                     MOVEL*BLANK    P3UECD           Export Code Dft
     C                     MOVEL*BLANK    P3HSST           Allow Mult Whse
     C                     MOVEL*BLANK    P3AMEO           Allow Multi Exp
     C                     MOVEL*BLANK    P3SSDF           Slip Sheet Dft
     C                     MOVEL*BLANK    P3PDFT           Palletize Dft
     C                     MOVEL*BLANK    P3YJSX           Company Organiz
     C                     MOVEL*BLANK    P4OAST           Processing Cycl
     C                     MOVEL*BLANK    P4OBST           Billing Activit
     C                     MOVEL*BLANK    P4OEST           Affect Inventor
     C                     MOVEL*BLANK    P4OFST           Affect Sales Do
     C                     Z-ADD*ZERO     P6STTP           Reefer Temperat
     C                     MOVEL*BLANK    P6MLSX           Temperature Cod
     C                     MOVEL*BLANK    P7X9ST           Outside Warehou
     C                     MOVEL*BLANK    P9MPNA           Default Printer
     C                     MOVEL*BLANK    P9WPST           Warehouse Type
     C                     MOVEL*BLANK    P9T0ST           Warehouse Locat
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field P.O. Required Flag
     C                     MOVEL*BLANK    WUPPST  1
      * Define work field Type Code
     C                     MOVEL*BLANK    WUBOCD  2
      * Define work field USR Warehouse Code
     C                     MOVEL*BLANK    WUCPCD  3
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Requested Delivery Dt
     C                     Z-ADD*ZERO     WUAYDZ  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Unused Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WADWPR           OD Unused Prc 2
     C                     Z-ADD*ZERO     WADXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WADYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WADZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Number of Orders
     C                     Z-ADD*ZERO     WUMCNB  50
      * Define work field USR Output Only Status
     C                     MOVEL*BLANK    WUE5ST  1
      * Define work field USR Display 2
     C                     MOVEL*BLANK    WUTJST  1
      * Define work field Lock/Unlock
     C                     MOVEL*BLANK    WUF4ST  1
      * Define work field Delivery P.O. Number
     C                     MOVEL*BLANK    WULMT1 38
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBR5NB           Deliver after t
     C                     Z-ADD*ZERO     WBR6NB           Deliver before
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WBW2NB           Freight Overage
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Company Number     041405
     C                     Z-ADD*ZERO     WUBQC3  30
      * Define work field Allow Multi-Company
     C                     MOVEL*BLANK    WUI6ST  1
      * Define work field USR Display 1
     C                     MOVEL*BLANK    WUTIST  1
      * Define work field Order Type - Sales
     C                     MOVEL*BLANK    WUJNCD  2
      * Define work field @Date - ATR
     C                     Z-ADD*ZERO     WUAADT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDP3NB           D & B Number
     C                     Z-ADD*ZERO     WDI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WDAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBTC7           Parent Customer
     C                     Z-ADD*ZERO     WDS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WDVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WDI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Update Exception Status
     C                     MOVEL*BLANK    WUF6ST  1
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Status Flag 2  Y/N
     C                     MOVEL*BLANK    WUQ2ST  1
      * Define work field Status Flag 3  Y/N
     C                     MOVEL*BLANK    WUQ3ST  1
      * Define work field Status Flag 4  Y/N
     C                     MOVEL*BLANK    WUFMST  1
      * Define work field Status Flag 5  Y/N
     C                     MOVEL*BLANK    WUAJTX  1
      * Define work field Status Flag 6  Y/N
     C                     MOVEL*BLANK    WUACTX  1
      * Define work field Status Flag 7  Y/N
     C                     MOVEL*BLANK    WUAKTX  1
      * Define work field Display Flag 1 USR
     C                     MOVEL*BLANK    WUDXSX  1
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Header Status USR
     C                     MOVEL*BLANK    WUHSUS  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WFA0DT           Order Date
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFACDT           Cancel Date
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WFA1WG           Order Weight To
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WFRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WFT3NB           Attach to Order
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFAWDT           Invoice Date
     C                     Z-ADD*ZERO     WFVRVA           A/R order Value
     C                     Z-ADD*ZERO     WFB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WFNODT           OH Unused Date
     C                     Z-ADD*ZERO     WFNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WFNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WFNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WFNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WFBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WFBQTM           Time of Origina
     C                     Z-ADD*ZERO     WFBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WFBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WFBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WFH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WFH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WFH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WFH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WFH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WFC0C7           Claim Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WGRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WGFLAM           Flat Amount
     C                     Z-ADD*ZERO     WGRRNB           Total Stops
     C                     Z-ADD*ZERO     WGSBNB           BOL Time
     C                     Z-ADD*ZERO     WGSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGSDNB           Number Pallets
     C                     Z-ADD*ZERO     WGPAOU           Number Pallets
     C                     Z-ADD*ZERO     WGDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WGSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WGHADT           Actual Arrival
     C                     Z-ADD*ZERO     WGAART           Actual Arrival
     C                     Z-ADD*ZERO     WGDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WGDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WGAQDT           Actual Departur
     C                     Z-ADD*ZERO     WGS6NB           Departure Time
     C                     Z-ADD*ZERO     WGT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WGPRTM           Product Tempera
     C                     Z-ADD*ZERO     WGNPSV           Number Pallets
     C                     Z-ADD*ZERO     WGTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WGGRWE           Gross Weight
     C                     Z-ADD*ZERO     WGF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WGJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WGTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WGJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WGSPTM           Spotted Time
     C                     Z-ADD*ZERO     WGJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WGLFTM           Load Finished T
     C                     Z-ADD*ZERO     WGJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WGBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WGJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WGBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WGKIDT           Truck Departure
     C                     Z-ADD*ZERO     WGASTM           Truck Departure
     C                     Z-ADD*ZERO     WGKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WGAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WGVOAG           Voyage
     C                     Z-ADD*ZERO     WGKBDT           Sail Date
     C                     Z-ADD*ZERO     WGEFDT           Arrival Date
     C                     Z-ADD*ZERO     WGKCDT           Date In
     C                     Z-ADD*ZERO     WGTMIN           Time In
     C                     Z-ADD*ZERO     WGKDDT           Date Out
     C                     Z-ADD*ZERO     WGVMNB           Time Out
     C                     Z-ADD*ZERO     WGOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WGKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WGATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WGBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WGEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WGKKDT           On Yard Date
     C                     Z-ADD*ZERO     WGAVTM           On Yard Time
     C                     Z-ADD*ZERO     WGKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WGAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WGLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WGK0DT           Product Complet
     C                     Z-ADD*ZERO     WGAYTM           Product Complet
     C                     Z-ADD*ZERO     WGKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WGICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WGIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WGK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WGAZTM           Load Door 1
     C                     Z-ADD*ZERO     WGK2DT           Override Total
     C                     Z-ADD*ZERO     WGA0TM           Load Door 2
     C                     Z-ADD*ZERO     WGZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WGPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WGCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WGPZDT           LH Unused Date
     C                     Z-ADD*ZERO     WGCLTM           LH Unused Time
     C                     Z-ADD*ZERO     WGP0DT           LH Unused Date
     C                     Z-ADD*ZERO     WGCMTM           LH Unused Time
     C                     Z-ADD*ZERO     WGP1DT           LH Unused Date
     C                     Z-ADD*ZERO     WGCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WGP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WGCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WGP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WGCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WHRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WHRWNB           Miles to next s
     C                     Z-ADD*ZERO     WHRXNB           Freight Charge
     C                     Z-ADD*ZERO     WHSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WHT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WHT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WHSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WHKFDT           Appointment Con
     C                     Z-ADD*ZERO     WHACTM           Appointment Con
     C                     Z-ADD*ZERO     WHEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WHAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WHKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WHATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WHHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WHAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WHKKDT           On Yard Date
     C                     Z-ADD*ZERO     WHAVTM           On Yard Time
     C                     Z-ADD*ZERO     WHZ4NB           MPC Number
     C                     Z-ADD*ZERO     WHN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WHN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WHN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WHB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WHB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WHB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Order Entry Hold
     C                     MOVEL*BLANK    WUQNST  1
      * Define work field Ship To Customer Flag
     C                     MOVEL*BLANK    WURJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WLBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WLBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WLBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WLBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field Time
     C                     Z-ADD*ZERO     WUAPTM  60
      * Define work field USR Remainder
     C                     Z-ADD*ZERO     WURDNB  40
      * Define work field Must Ship Error
     C                     MOVEL*BLANK    WUB7SX  3
      * Define work field USR Order Number
     C                     Z-ADD*ZERO     WUMPNB  70
      * Define work field Stop/Drop
     C                     Z-ADD*ZERO     WURVNB  50
      * Define work field Shipping Company
     C                     Z-ADD*ZERO     WUBWC3  30
      * Define work field Accounting Company
     C                     Z-ADD*ZERO     WUBTC3  30
      * Define work field Company Number Select
     C                     Z-ADD*ZERO     WUAOC3  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Clear all neither parameters
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     Z-ADD*ZERO     EYAATM           Job Time
     C                     Z-ADD*ZERO     EYAXDT           Job Date
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Freight
     C                     Z-ADD*ZERO     WURQNB 112
      * Define work field Shipping Temp Code C/F
     C                     MOVEL*BLANK    WUFRSX  1
      * Define work field USR Temperature 3.1
     C                     Z-ADD*ZERO     WUPCNX  31
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Change Log Prior Value
     C                     MOVEL*BLANK    WUMNTX 12
      * Define work field Change Log New Value
     C                     MOVEL*BLANK    WUMOTX 12
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Number of Copies
     C                     Z-ADD*ZERO     WUDYNB  20
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field Paper Type USR
     C                     MOVEL*BLANK    WUA7ST  1
      * Define work field Parent Customer
     C                     Z-ADD*ZERO     WUBTC7  70
      * Define work field Auto Order Numbering?
     C                     MOVEL*BLANK    WUCHST  1
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Default Printer
     C                     MOVEL*BLANK    WUMPNA 10
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRWF00  40       Requested Deliv
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local variables for subroutine SARVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004 30
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  2
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009 40
     C                     MOVEL*BLANK    WL0010 40
     C                     MOVEL*BLANK    WL0011  3
     C                     MOVEL*BLANK    WL0012  1
     C                     Z-ADD*ZERO     WL0013  40
     C                     MOVEL*BLANK    WL0014  2
     C                     Z-ADD*ZERO     WL0015  52
     C                     Z-ADD*ZERO     WL0016  92
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  3
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  3
     C                     MOVEL*BLANK    WL0021  3
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0022  30
     C                     MOVEL*BLANK    WL0023 10
     C                     MOVEL*BLANK    WL0024 40
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0025  30
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  3
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  70
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0030  30
     C                     MOVEL*BLANK    WL0031 30
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033 30
     C                     MOVEL*BLANK    WL0034 30
     C                     MOVEL*BLANK    WL0035 30
     C                     MOVEL*BLANK    WL0036 30
     C                     MOVEL*BLANK    WL0037 20
     C                     MOVEL*BLANK    WL0038  2
     C                     MOVEL*BLANK    WL0039 11
     C                     Z-ADD*ZERO     WL0040  70
     C                     MOVEL*BLANK    WL0041  1
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0042  70
     C                     MOVEL*BLANK    WL0043 30
     C                     MOVEL*BLANK    WL0044 30
     C                     MOVEL*BLANK    WL0045 30
     C                     MOVEL*BLANK    WL0046 30
     C                     MOVEL*BLANK    WL0047 20
     C                     MOVEL*BLANK    WL0048  2
     C                     MOVEL*BLANK    WL0049 11
      * Define local variables for subroutine SWDLRC.
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051  50
      * Define local variables for subroutine TPRVGN.
     C                     Z-ADD*ZERO     WL0052  30
     C                     Z-ADD*ZERO     WL0053  70
      * Define local variables for subroutine NACHRC.
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055  3
     C                     MOVEL*BLANK    WL0056  3
     C                     Z-ADD*ZERO     WL0057  70
     C                     MOVEL*BLANK    WL0058  3
      * Define local variables for subroutine NBCHRC.
     C                     Z-ADD*ZERO     WL0059  70
     C                     MOVEL*BLANK    WL0060  2
      * Define local variables for subroutine NERVGN.
     C                     MOVEL*BLANK    WL0061 10
     C                     MOVEL*BLANK    WL0062  6
     C                     Z-ADD*ZERO     WL0063  30
     C                     MOVEL*BLANK    WL0064  3
      * Define local work field Carrier Code Chg Usr 1
     C                     MOVEL*BLANK    YL0001  3
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Company Organization
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field CDI Unused Sts 2
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field CDI Unused Sts 3
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field CDI Shipper
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field CDI Produced by co
     C                     MOVEL*BLANK    YN0006  2
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Delivery P.O. Number
     C                     MOVEL*BLANK    YL0003 38
      * Define local work field Cust Shipping Temp
     C                     Z-ADD*ZERO     YL0004  52
      * Define local work field Cust Shipping Temp C/F
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Display Flag
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Must Ship Date        USR
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Must Ship Time        USR
     C                     Z-ADD*ZERO     YL0009  60
      * Define local work field Claim Company Number
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field Claim Ship to Customer
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field USR Temperature 3.1
     C                     Z-ADD*ZERO     YL0012  31
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0013  6
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0015  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0016  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * ***  Note: Files have maxed out at 50. Use XF if adding a new fun
      *
     C                     MOVEL*BLANK    WN1061 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN1061           User Profile Na
      *
     C                     MOVEL*BLANK    WN1062 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR NDRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN1061    ZA0034           User Profile Na
     C                     MOVEL'OMS'     ZA0035           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN1062    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1061    WL0061    P      User Profile Na
     C                     MOVEL'OMS'     WL0062    P      Application Cod
     C                     EXSR NERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0063    WUAIC3           Company Number
     C                     MOVELWL0064    YL0016    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1062    WL0061    P      User Profile Na
     C                     MOVEL'OMS'     WL0062    P      Application Cod
     C                     EXSR NERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0063    WUAIC3           Company Number
     C                     MOVELWL0064    YL0016    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0016    WUAJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN1061    ZA0036           User Profile Na
     C                     MOVEL'OMS'     ZA0037           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0015    IFNE *ZERO                      *IF
     C                     Z-ADDYL0015    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0016    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
     C                     EXSR NFRVGN
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR NGRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * PKTR01 Get default shipping co for customer
      * CASE: PAR.Ship To Customer is not equal to zero
     C           P1BKC7    IFNE *ZERO                      *IF
      * RTV Shipping Co Dft    RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0029           Ship To Custome
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    WUBQC3           Company Number
      * Set PAR company
      * CASE: PAR.Company Number EQ WRK.ZERO
     C           P1AIC3    IFEQ WUW0NB                     *IF
     C                     Z-ADDWUBQC3    P1AIC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
      * new 1/6/05  - use user's co if their multi-co = No
      * CASE: WRK.Allow Multi-Company is no
     C           WUI6ST    IFEQ 'N'                        *IF
     C                     Z-ADDWUAIC3    WUBQC3           Company Number
      * Set PAR company
      * CASE: PAR.Company Number EQ WRK.ZERO
     C           P1AIC3    IFEQ WUW0NB                     *IF
     C                     Z-ADDWUBQC3    P1AIC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       WUTIST           USR Display 1
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
      * RTV Dflt Type for Co   RT - Entry Control  * 
     C                     EXSR NIRVGN
      * Auto order numbering for new order
      * CASE: PAR.Order Number EQ WRK.ZERO
     C           P1C4NB    IFEQ WUW0NB                     *IF
     C                     MOVEL'ADD'     W0PMD            *Program mode
      * CASE: WRK.Allow Multi-Company is yes
     C           WUI6ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     END                             *FI
      * RTV OP status          RT - Company Control  * 
     C                     EXSR NJRVGN
      * CASE: WRK.Auto Order Numbering? is yes
     C           WUCHST    IFEQ 'Y'                        *IF
      * PKTR01 - 7/21/04 Use company 000 for next order nbr
      *  (was using Par.Company Number)
      * RTV Next Order Number  RT - Company Control  * 
     C                     EXSR NKRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     END                             *FI
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'N'       WUE5ST           USR Output Only
     C                     MOVEL'Y'       YL0007           Display Flag
     C                     MOVEL'N'       P2OPSX           User Access
      * User access update?
      * CASE: JOB.*USER is All IS DEV/PRD & Prktest
     C           ##USR     IFEQ 'ALICEB'                   *IF
     C           ##USR     OREQ 'ISALICEB'
     C           ##USR     OREQ 'PRKTEST'
     C           ##USR     OREQ 'ISPURVAP'
     C           ##USR     OREQ 'ISPPATE'
     C           ##USR     OREQ 'ISROSEM'
     C           ##USR     OREQ 'ISRCENT'
     C           ##USR     OREQ 'ISSMASO'
     C           ##USR     OREQ 'ISSUSANM'
     C           ##USR     OREQ 'ISLBUSE'
     C           ##USR     OREQ 'ISLARAB'
     C                     MOVEL'U'       P2OPSX           User Access
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
010430105201299
** W0END
010450108101305
** W0NAM
V1AIC3    #PAPTX    V1C4NB
** W1BEG
01047010540130301340015380157501794
01831020500208702306023430256202583
02586025990262002623028280285502880
02889030950313703351033930360703621
03649036570386303905041190412504161
04375044000440404429046310464104666
04685048870493505143053890541705444
** W1END
01049010830130901346015670160401823
01860020790211602335023720258102584
02596026180262102633028520287802886
02890031020314103358034000360903623
03655036570386403911041210413404175
04389044000440904429046310464104666
04685049260494105182054010542905455
** W1NAM
VDFKNB    #PAPTX    V1BKC7    V1B0C7    #1BRTX    #1AETX    #1HMNA
#1B1NA    #1HONA    #1B3NA    #1HPNA    #1B4NA    #1HNNA    #1DBCD
#1CKTX    #1B2NA    #1BHCD    #1C8TX    #DBVTX    #DVR01    V1C4NB
#1JNCD    V1EIDT    #1AFTM    V1A5DT    V1AODT    #DAJCD    #DWKCD
#1RNNB    #1FRSX    #1Q2CD    #1RMNB    #DBCCD    #DALTX    #DNLTX
#1BCNA    #1U2ST    #DKXCD    #1FQSX    #1BCST    #1PJST    #1BDST
#1FNSX    #1B6NA    V1C0C7    #1BYNA    #1JZVA    #1A1WG    #DCDWG
** @CN
00001 Order Number . . . . :
00002 Order Type . . . . . :
00003 Sales Orders
00004 Print Acknowledgement
00005 Print Get Ready Report
