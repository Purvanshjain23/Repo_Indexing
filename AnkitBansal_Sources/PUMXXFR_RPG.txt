     H/TITLE Exc TRG OMHSTPP ProcessXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJBADE
     H* Date          : 08/13/19  Time  : 16:15:37
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUBHCPL0  IF A E           K DISK
      * UPD : BI Sales History TRG      Update index
      *
      * Long constants
     D @CN#            S              6    DIM(01)CTDATA PERRCD(1)
     D @CN             S             25    DIM(01) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPUBH1        E DS                  EXTNAME(PUBHCPL0)
      * UPD : BI Sales History TRG      Update index
      * Renamed input format fields
     D  WAAIC3       E                     EXTFLD(BHAIC3)
     D  WAC4NB       E                     EXTFLD(BHC4NB)
     D  WADPNB       E                     EXTFLD(BHDPNB)
     D  WAUENB       E                     EXTFLD(BHUENB)
     D  WAA1TS       E                     EXTFLD(BHA1TS)
     D  WAJPSC       E                     EXTFLD(BHJPSC)
     D  WAJQSC       E                     EXTFLD(BHJQSC)
     D  WABCDX       E                     EXTFLD(BHBCDX)
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  XDTSDL         S             26
     D  WL0001         S              3  0
     D  WL0002         S              7  0
     D  WL0003         S              3  0
     D  WL0004         S              3  0
     D  WL0005         S              1
     D  WL0006         S              2
     D  WL0007         S              8  0
     D  WN0001         S             26
     D  ##TMS          S             26
     D  ZADFMF         S             10
     D  YL0001         S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS           792
      * RCD: Sales History             Retrieval index
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Order Number
     D  P1C4NB                 3      6P 0
      * I :  Order Sequence Number
     D  P1DPNB                 7      8P 0
      * I :  Order Secondary Line Seq
     D  P1UENB                 9     10P 0
      * I :  A/R City
     D  P1MONA                11     30
      * I :  A/R State
     D  P1RJCD                31     32
      * I :  A/R County Code
     D  P1RKCD                33     38
      * I :  A/R Zip/Postal Code
     D  P1GPTX                39     49
      * I :  Alpha Search
     D  P1ABTX                50     74
      * I :  Country Code
     D  P1KXCD                75     80
      * I :  Type Code
     D  P1BOCD                81     82
      * I :  Parent Customer
     D  P1BTC7                83     86P 0
      * I :  A/R Customer Number
     D  P1ANC7                87     90P 0
      * I :  A/R Customer Name
     D  P1AQTX                91    120
      * I :  Ship To Customer
     D  P1BKC7               121    124P 0
      * I :  Ship To Name
     D  P1BRTX               125    154
      * I :  Ship To City
     D  P1HNNA               155    174
      * I :  Ship To State Code
     D  P1DBCD               175    176
      * I :  Ship To Zip/Postal Code
     D  P1CKTX               177    187
      * I :  Customer Purchase Order #
     D  P1BCNA               188    202
      * I :  Order Date
     D  P1A0DT               203    206P 0
      * I :  Cancel Date
     D  P1ACDT               207    210P 0
      * I :  Sales Route Code
     D  P1R4CD               211    213
      * I :  Original Salesperson
     D  P1R5CD               214    216
      * I :  Manager Level Code
     D  P1BFCD               217    218
      * I :  VP Level Code
     D  P1Q4CD               219    221
      * I :  Terms Code
     D  P1AQCD               222    223
      * I :  Absorbed Freight Rate CWT
     D  P1TBNB               224    226P 2
      * I :  Carrier Code
     D  P1BZNA               227    229
      * I :  Order Header Reason
     D  P1RLCD               230    232
      * I :  Order Type - Sales
     D  P1JNCD               233    234
      * I :  Shipping Method
     D  P1Q2CD               235    236
      * I :  Export Status
     D  P1U2ST               237    237
      * I :  Attach to Invoice Number
     D  P1ATIN               238    241P 0
      * I :  Attach to Order Number
     D  P1T3NB               242    245P 0
      * I :  Resell Reference Number
     D  P1RSRN               246    249P 0
      * I :  Original Item
     D  P1ORIT               250    253P 0
      * I :  Warehouse Code
     D  P1AJCD               254    256
      * I :  Quantity Ordered
     D  P1AVQT               257    262P 2
      * I :  Weight Ordered
     D  P1D0WG               263    268P 2
      * I :  Quantity Scheduled
     D  P1CCQT               269    274P 2
      * I :  Weight Scheduled
     D  P1AUWG               275    280P 2
      * I :  U/M - Ordered
     D  P1AGCD               281    282
      * I :  Unit Price
     D  P1AKPR               283    288P 4
      * I :  Unit Price Ordered U/M
     D  P1AUPR               289    294P 4
      * I :  U/M - Base Price
     D  P1CRCD               295    296
      * I :  Requested Ship Date
     D  P1A5DT               297    300P 0
      * I :  Invoice Date
     D  P1AWDT               301    304P 0
      * I :  Deadline Depart DT    HDR
     D  P1HDDT               305    308P 0
      * I :  Unit Cost Per Pound
     D  P1AGCS               309    314P 4
      * I :  Unit Cost Pricing U/M
     D  P1AQCS               315    320P 4
      * I :  Unit Weight Ordered U/M
     D  P1AVWG               321    326P 2
      * I :  Extended Amount
     D  P1AYVA               327    332P 2
      * I :  Affect Inventory Status
     D  P1AMST               333    333
      * I :  Affect Sales Doll Status
     D  P1ANST               334    334
      * I :  Affect Sales Pnds Status
     D  P1VAST               335    335
      * I :  Contract Number
     D  P1L6NB               336    339P 0
      * I :  Export Country Code
     D  P1UMCD               340    345
      * I :  LD Arrival Date
     D  P1HCDT               346    349P 0
      * I :  Accounting Year Code
     D  P1ESNB               350    352P 0
      * I :  Accounting Period Code
     D  P1ETNB               353    354P 0
      * I :  OM Week
     D  P1BZNB               355    356P 0
      * I :  Quantity Billed
     D  P1EXQT               357    362P 2
      * I :  Weight Billed
     D  P1BYWG               363    368P 2
      * I :  Shipped Item Code
     D  P1S5NB               369    372P 0
      * I :  Billing Detail Cost Dol.
     D  P1MAVA               373    378P 2
      * I :  Billing Detail Gross Dol.
     D  P1KDVA               379    384P 2
      * I :  FOB Gross Amount
     D  P1USVA               385    390P 2
      * I :  Standard Overage Amount
     D  P1UTVA               391    396P 2
      * I :  Tare Weight Total
     D  P1A4WG               397    402P 2
      * I :  G/L Document Number
     D  P1CKNB               403    407P 0
      * I :  G/L Update Status
     D  P1BMST               408    408
      * I :  Shipping Company Number
     D  P1R8NB               409    410P 0
      * I :  Order Detail Reason
     D  P1RMCD               411    413
      * I :  Price Overage Override
     D  P1BZPR               414    419P 4
      * I :  Date Method Code
     D  P1RDCD               420    422
      * I :  Price Method Code
     D  P1Q7CD               423    425
      * I :  Market Pricing Date
     D  P1EXDT               426    429P 0
      * I :  Commodity Market Code
     D  P1LQCD               430    432
      * I :  Quality Level
     D  P1HICD               433    434
      * I :  Item Level
     D  P1RBCD               435    436
      * I :  Item Structure Type Code
     D  P1RGNB               437    438P 0
      * I :  Item Structure Group Code
     D  P1RHNB               439    440P 0
      * I :  Item Structure Class Code
     D  P1RINB               441    442P 0
      * I :  Rated Freight
     D  P1R1NB               443    448P 2
      * I :  Invoice Number
     D  P1CONB               449    452P 0
      * I :  Invoice Suffix
     D  P1CEST               453    454
      * I :  Actual Shipped Date
     D  P1GNDT               455    458P 0
      * I :  Load ID
     D  P1RMNB               459    462P 0
      * I :  Scheduled Ship Date
     D  P1AODT               463    466P 0
      * I :  Packaging Code
     D  P1LLCD               467    469
      * I :  Item Market Code
     D  P1LMCD               470    472
      * I :  Agrimetrics group
     D  P1SKNB               473    474P 0
      * I :  Agrimetrics pack
     D  P1SLNB               475    475P 0
      * I :  Agrimetrics grade
     D  P1SMNB               476    477P 0
      * I :  Order Desc. Line One
     D  P1G7NA               478    507
      * I :  Actual Freight Amount
     D  P1ONVA               508    513P 2
      * I :  Item Type Code
     D  P1N0CD               514    516
      * I :  PM R/M Type Code
     D  P1B4NB               517    518P 0
      * I :  PM Line Number
     D  P1B5NB               519    521P 0
      * I :  SH Unused (was broker)
     D  P1N1CD               522    524
      * I :  Pricing Date Used
     D  P1GIDT               525    528P 0
      * I :  Modified Flag
     D  P1Z1ST               529    529
      * I :  Absorbed Freight Amount
     D  P1ULVA               530    535P 2
      * I :  Ledgrd Trd Fund Accrl Amt
     D  P1UNVA               536    541P 2
      * I :  Commission Amount
     D  P1UOVA               542    547P 2
      * I :  Financials Amount - Spec
     D  P1UPVA               548    553P 2
      * I :  Financials Amount - Frght
     D  P1UQVA               554    559P 2
      * I :  Group for Packaging
     D  P1SDCD               560    560
      * I :  Base/Conv/Loss Item
     D  P1QZCD               561    562
      * I :  Variety/Rendered/Cut
     D  P1XWST               563    563
      * I :  Customer Group Code
     D  P1T9CD               564    566
      * I :  Customer Group Code 2
     D  P1UBCD               567    569
      * I :  Order Group Code
     D  P1CFC7               570    573P 0
      * I :  Shipping Zone Code
     D  P1X1CD               574    577
      * I :  Process Sts for 3C
     D  P1GASX               578    578
      * I :  Invoice Unit Price
     D  P1DUPR               579    584P 4
      * I :  Invoice Extended Amt
     D  P1B6VL               585    590P 2
      * I :  Req Shipping Temp
     D  P1IANX               591    592P 0
      * I :  Actual Shipping Temp
     D  P1IBNX               593    594P 0
      * I :  Age Code
     D  P1RPCD               595    595
      * I :  Req Delivery Date
     D  P1NYDT               596    599P 0
      * I :  Req Delivery Time
     D  P1BZTM               600    603P 0
      * I :  MPC Number
     D  P1Z4NB               604    607P 0
      * I :  Shipping Line
     D  P1XACD               608    610
      * I :  Port Delv Terminal
     D  P1OANA               611    630
      * I :  Port City
     D  P1OKTX               631    655
      * I :  Vessel Name
     D  P1K4TX               656    685
      * I :  Booking Number
     D  P1NBBO               686    697
      * I :  Load Total Freight
     D  P1OCFR               698    703P 2
      * I :  Claim Number
     D  P1C0C7               704    707P 0
      * I :  Ham Group Number
     D  P1A1AA               708    709P 0
      * I :  Palletize
     D  P1VEST               710    710
      * I :  Commodity Market Price
     D  P1A5PR               711    716P 4
      * I :  Market Value
     D  P1CDPR               717    722P 4
      * I :  Default Cmdty Mkt Price
     D  P1D0PR               723    728P 4
      * I :  Raw Material Cost /LB
     D  P1D0VL               729    734P 4
      * I :  Sales Expense Process Sts
     D  P1IRSX               735    735
      * I :  Sales Expense Total
     D  P1CEVL               736    741P 2
      * I :  Data Mart Process Sts
     D  P1ISSX               742    742
      * I :  LH Load Type
     D  P1ITSX               743    743
      * I :  Order TF Exempt Code
     D  P1IUSX               744    745
      * I :  LD Sail Date
     D  P1OHDT               746    749P 0
      * I :  NonLedgrd TrdFnd Acrl Amt
     D  P1D9PR               750    755P 4
      * I :  HST Item Target Price
     D  P1CFVL               756    761P 2
      * I :  EDI Status 1
     D  P1UVST               762    762
      * I :  EDI Status 2
     D  P1UWST               763    763
      * I :  EDI Status 3
     D  P1UXST               764    764
      * I :  Job Time
     D  P1AATM               765    768P 0
      * I :  User Id
     D  P1AYNA               769    778
      * I :  Job Name
     D  P1A0NA               779    788
      * I :  Job Date
     D  P1AXDT               789    792P 0
     D P2PARM          DS           792
      * RCD: Sales History             Retrieval index
      * I :  Company Number
     D  P2AIC3                 1      2P 0
      * I :  Order Number
     D  P2C4NB                 3      6P 0
      * I :  Order Sequence Number
     D  P2DPNB                 7      8P 0
      * I :  Order Secondary Line Seq
     D  P2UENB                 9     10P 0
      * I :  A/R City
     D  P2MONA                11     30
      * I :  A/R State
     D  P2RJCD                31     32
      * I :  A/R County Code
     D  P2RKCD                33     38
      * I :  A/R Zip/Postal Code
     D  P2GPTX                39     49
      * I :  Alpha Search
     D  P2ABTX                50     74
      * I :  Country Code
     D  P2KXCD                75     80
      * I :  Type Code
     D  P2BOCD                81     82
      * I :  Parent Customer
     D  P2BTC7                83     86P 0
      * I :  A/R Customer Number
     D  P2ANC7                87     90P 0
      * I :  A/R Customer Name
     D  P2AQTX                91    120
      * I :  Ship To Customer
     D  P2BKC7               121    124P 0
      * I :  Ship To Name
     D  P2BRTX               125    154
      * I :  Ship To City
     D  P2HNNA               155    174
      * I :  Ship To State Code
     D  P2DBCD               175    176
      * I :  Ship To Zip/Postal Code
     D  P2CKTX               177    187
      * I :  Customer Purchase Order #
     D  P2BCNA               188    202
      * I :  Order Date
     D  P2A0DT               203    206P 0
      * I :  Cancel Date
     D  P2ACDT               207    210P 0
      * I :  Sales Route Code
     D  P2R4CD               211    213
      * I :  Original Salesperson
     D  P2R5CD               214    216
      * I :  Manager Level Code
     D  P2BFCD               217    218
      * I :  VP Level Code
     D  P2Q4CD               219    221
      * I :  Terms Code
     D  P2AQCD               222    223
      * I :  Absorbed Freight Rate CWT
     D  P2TBNB               224    226P 2
      * I :  Carrier Code
     D  P2BZNA               227    229
      * I :  Order Header Reason
     D  P2RLCD               230    232
      * I :  Order Type - Sales
     D  P2JNCD               233    234
      * I :  Shipping Method
     D  P2Q2CD               235    236
      * I :  Export Status
     D  P2U2ST               237    237
      * I :  Attach to Invoice Number
     D  P2ATIN               238    241P 0
      * I :  Attach to Order Number
     D  P2T3NB               242    245P 0
      * I :  Resell Reference Number
     D  P2RSRN               246    249P 0
      * I :  Original Item
     D  P2ORIT               250    253P 0
      * I :  Warehouse Code
     D  P2AJCD               254    256
      * I :  Quantity Ordered
     D  P2AVQT               257    262P 2
      * I :  Weight Ordered
     D  P2D0WG               263    268P 2
      * I :  Quantity Scheduled
     D  P2CCQT               269    274P 2
      * I :  Weight Scheduled
     D  P2AUWG               275    280P 2
      * I :  U/M - Ordered
     D  P2AGCD               281    282
      * I :  Unit Price
     D  P2AKPR               283    288P 4
      * I :  Unit Price Ordered U/M
     D  P2AUPR               289    294P 4
      * I :  U/M - Base Price
     D  P2CRCD               295    296
      * I :  Requested Ship Date
     D  P2A5DT               297    300P 0
      * I :  Invoice Date
     D  P2AWDT               301    304P 0
      * I :  Deadline Depart DT    HDR
     D  P2HDDT               305    308P 0
      * I :  Unit Cost Per Pound
     D  P2AGCS               309    314P 4
      * I :  Unit Cost Pricing U/M
     D  P2AQCS               315    320P 4
      * I :  Unit Weight Ordered U/M
     D  P2AVWG               321    326P 2
      * I :  Extended Amount
     D  P2AYVA               327    332P 2
      * I :  Affect Inventory Status
     D  P2AMST               333    333
      * I :  Affect Sales Doll Status
     D  P2ANST               334    334
      * I :  Affect Sales Pnds Status
     D  P2VAST               335    335
      * I :  Contract Number
     D  P2L6NB               336    339P 0
      * I :  Export Country Code
     D  P2UMCD               340    345
      * I :  LD Arrival Date
     D  P2HCDT               346    349P 0
      * I :  Accounting Year Code
     D  P2ESNB               350    352P 0
      * I :  Accounting Period Code
     D  P2ETNB               353    354P 0
      * I :  OM Week
     D  P2BZNB               355    356P 0
      * I :  Quantity Billed
     D  P2EXQT               357    362P 2
      * I :  Weight Billed
     D  P2BYWG               363    368P 2
      * I :  Shipped Item Code
     D  P2S5NB               369    372P 0
      * I :  Billing Detail Cost Dol.
     D  P2MAVA               373    378P 2
      * I :  Billing Detail Gross Dol.
     D  P2KDVA               379    384P 2
      * I :  FOB Gross Amount
     D  P2USVA               385    390P 2
      * I :  Standard Overage Amount
     D  P2UTVA               391    396P 2
      * I :  Tare Weight Total
     D  P2A4WG               397    402P 2
      * I :  G/L Document Number
     D  P2CKNB               403    407P 0
      * I :  G/L Update Status
     D  P2BMST               408    408
      * I :  Shipping Company Number
     D  P2R8NB               409    410P 0
      * I :  Order Detail Reason
     D  P2RMCD               411    413
      * I :  Price Overage Override
     D  P2BZPR               414    419P 4
      * I :  Date Method Code
     D  P2RDCD               420    422
      * I :  Price Method Code
     D  P2Q7CD               423    425
      * I :  Market Pricing Date
     D  P2EXDT               426    429P 0
      * I :  Commodity Market Code
     D  P2LQCD               430    432
      * I :  Quality Level
     D  P2HICD               433    434
      * I :  Item Level
     D  P2RBCD               435    436
      * I :  Item Structure Type Code
     D  P2RGNB               437    438P 0
      * I :  Item Structure Group Code
     D  P2RHNB               439    440P 0
      * I :  Item Structure Class Code
     D  P2RINB               441    442P 0
      * I :  Rated Freight
     D  P2R1NB               443    448P 2
      * I :  Invoice Number
     D  P2CONB               449    452P 0
      * I :  Invoice Suffix
     D  P2CEST               453    454
      * I :  Actual Shipped Date
     D  P2GNDT               455    458P 0
      * I :  Load ID
     D  P2RMNB               459    462P 0
      * I :  Scheduled Ship Date
     D  P2AODT               463    466P 0
      * I :  Packaging Code
     D  P2LLCD               467    469
      * I :  Item Market Code
     D  P2LMCD               470    472
      * I :  Agrimetrics group
     D  P2SKNB               473    474P 0
      * I :  Agrimetrics pack
     D  P2SLNB               475    475P 0
      * I :  Agrimetrics grade
     D  P2SMNB               476    477P 0
      * I :  Order Desc. Line One
     D  P2G7NA               478    507
      * I :  Actual Freight Amount
     D  P2ONVA               508    513P 2
      * I :  Item Type Code
     D  P2N0CD               514    516
      * I :  PM R/M Type Code
     D  P2B4NB               517    518P 0
      * I :  PM Line Number
     D  P2B5NB               519    521P 0
      * I :  SH Unused (was broker)
     D  P2N1CD               522    524
      * I :  Pricing Date Used
     D  P2GIDT               525    528P 0
      * I :  Modified Flag
     D  P2Z1ST               529    529
      * I :  Absorbed Freight Amount
     D  P2ULVA               530    535P 2
      * I :  Ledgrd Trd Fund Accrl Amt
     D  P2UNVA               536    541P 2
      * I :  Commission Amount
     D  P2UOVA               542    547P 2
      * I :  Financials Amount - Spec
     D  P2UPVA               548    553P 2
      * I :  Financials Amount - Frght
     D  P2UQVA               554    559P 2
      * I :  Group for Packaging
     D  P2SDCD               560    560
      * I :  Base/Conv/Loss Item
     D  P2QZCD               561    562
      * I :  Variety/Rendered/Cut
     D  P2XWST               563    563
      * I :  Customer Group Code
     D  P2T9CD               564    566
      * I :  Customer Group Code 2
     D  P2UBCD               567    569
      * I :  Order Group Code
     D  P2CFC7               570    573P 0
      * I :  Shipping Zone Code
     D  P2X1CD               574    577
      * I :  Process Sts for 3C
     D  P2GASX               578    578
      * I :  Invoice Unit Price
     D  P2DUPR               579    584P 4
      * I :  Invoice Extended Amt
     D  P2B6VL               585    590P 2
      * I :  Req Shipping Temp
     D  P2IANX               591    592P 0
      * I :  Actual Shipping Temp
     D  P2IBNX               593    594P 0
      * I :  Age Code
     D  P2RPCD               595    595
      * I :  Req Delivery Date
     D  P2NYDT               596    599P 0
      * I :  Req Delivery Time
     D  P2BZTM               600    603P 0
      * I :  MPC Number
     D  P2Z4NB               604    607P 0
      * I :  Shipping Line
     D  P2XACD               608    610
      * I :  Port Delv Terminal
     D  P2OANA               611    630
      * I :  Port City
     D  P2OKTX               631    655
      * I :  Vessel Name
     D  P2K4TX               656    685
      * I :  Booking Number
     D  P2NBBO               686    697
      * I :  Load Total Freight
     D  P2OCFR               698    703P 2
      * I :  Claim Number
     D  P2C0C7               704    707P 0
      * I :  Ham Group Number
     D  P2A1AA               708    709P 0
      * I :  Palletize
     D  P2VEST               710    710
      * I :  Commodity Market Price
     D  P2A5PR               711    716P 4
      * I :  Market Value
     D  P2CDPR               717    722P 4
      * I :  Default Cmdty Mkt Price
     D  P2D0PR               723    728P 4
      * I :  Raw Material Cost /LB
     D  P2D0VL               729    734P 4
      * I :  Sales Expense Process Sts
     D  P2IRSX               735    735
      * I :  Sales Expense Total
     D  P2CEVL               736    741P 2
      * I :  Data Mart Process Sts
     D  P2ISSX               742    742
      * I :  LH Load Type
     D  P2ITSX               743    743
      * I :  Order TF Exempt Code
     D  P2IUSX               744    745
      * I :  LD Sail Date
     D  P2OHDT               746    749P 0
      * I :  NonLedgrd TrdFnd Acrl Amt
     D  P2D9PR               750    755P 4
      * I :  HST Item Target Price
     D  P2CFVL               756    761P 2
      * I :  EDI Status 1
     D  P2UVST               762    762
      * I :  EDI Status 2
     D  P2UWST               763    763
      * I :  EDI Status 3
     D  P2UXST               764    764
      * I :  Job Time
     D  P2AATM               765    768P 0
      * I :  User Id
     D  P2AYNA               769    778
      * I :  Job Name
     D  P2A0NA               779    788
      * I :  Job Date
     D  P2AXDT               789    792P 0
     D P3PARM          DS
      * I :  TRG Database Event
     D  P3D8SC                 1      1
     D                 DS
     D  ZAMSDA                 1    132
     I@BHCPE3
      * BI Sales History TRG      Update index
      * Renamed input format fields
     I              BHAIC3                      WAAIC3
     I              BHC4NB                      WAC4NB
     I              BHDPNB                      WADPNB
     I              BHUENB                      WAUENB
     I              BHA1TS                      WAA1TS
     I              BHJPSC                      WAJPSC
     I              BHJQSC                      WAJQSC
     I              BHBCDX                      WABCDX
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         RCD: Sales Hist
     C                   PARM                    P2PARM                         RCD: Sales Hist
     C     P3D8SC        PARM                    WP0001                         TRG Database Ev
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc TRG OMHSTPP ProcessXF
      * *****************************************************************
      * ** PR1 Parms Represent Old Record Fields (Will be blank for Inser
      * ** PR2 Parms Represent New Record Fields (Will be blank for Delet
      * *****************************************************************
      * Trigger Processing for Insert Event.
      * CASE: PR3.TRG Database Event is Insert
      * Crt BI Sales History TRG - BI Sales History TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '1'
     C                   Z-ADD     P2AIC3        WL0001                         Company Number
     C                   Z-ADD     P2C4NB        WL0002                         Order Number
     C                   Z-ADD     P2DPNB        WL0003                         Order Sequence
     C                   Z-ADD     P2UENB        WL0004                         Order Secondary
     C                   MOVEL(P)  P3D8SC        WL0005                         BISH TRG Databa
     C                   MOVEL(P)  '0'           WL0006                         BISH Process St
     C                   Z-ADD     0             WL0007                         BISH Process Da
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      * Trigger Processing for Update Event.
      * CASE: PR3.TRG Database Event is Update
     C                   IF        P3D8SC = '3'
     C                   MOVEL     'N'           YL0001                         Update Record U
      * Set update flag if any of the fields change value
     C                   EXSR      UASUBR                                       Set update flag
      * Update Record?
      * CASE: LCL.Update Record USR is Yes
      * Crt BI Sales History TRG - BI Sales History TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0001 = 'Y'
     C                   Z-ADD     P2AIC3        WL0001                         Company Number
     C                   Z-ADD     P2C4NB        WL0002                         Order Number
     C                   Z-ADD     P2DPNB        WL0003                         Order Sequence
     C                   Z-ADD     P2UENB        WL0004                         Order Secondary
     C                   MOVEL(P)  P3D8SC        WL0005                         BISH TRG Databa
     C                   MOVEL(P)  '0'           WL0006                         BISH Process St
     C                   Z-ADD     0             WL0007                         BISH Process Da
     C                   EXSR      SACRRC
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Trigger Processing for Delete Event.
      * CASE: PR3.TRG Database Event is Delete
      * Crt BI Sales History TRG - BI Sales History TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '2'
     C                   Z-ADD     P1AIC3        WL0001                         Company Number
     C                   Z-ADD     P1C4NB        WL0002                         Order Number
     C                   Z-ADD     P1DPNB        WL0003                         Order Sequence
     C                   Z-ADD     P1UENB        WL0004                         Order Secondary
     C                   MOVEL(P)  P3D8SC        WL0005                         BISH TRG Databa
     C                   MOVEL(P)  '0'           WL0006                         BISH Process St
     C                   Z-ADD     0             WL0007                         BISH Process Da
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SACRRC        BEGSR
      *================================================================
      * Crt BI Sales History TRG - BI Sales History TRG  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0001                         BISH Timestamp
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @BHCPE3
     C                   Z-ADD     WL0001        WAAIC3                         Company Number
     C                   Z-ADD     WL0002        WAC4NB                         Order Number
     C                   Z-ADD     WL0003        WADPNB                         Order Sequence
     C                   Z-ADD     WL0004        WAUENB                         Order Secondary
     C                   MOVEL     WL0005        WAJPSC                         BISH TRG Databa
     C                   MOVEL     WL0006        WAJQSC                         BISH Process St
     C                   Z-ADD     WL0007        WABCDX                         BISH Process Da
      *
      * USER: Processing before Data update
      * Set Timestamp TS#     IF
      * PAR.@Timestamp TS# = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WAA1TS                         @Timestamp TS#
     C     KLCRSA        KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAC4NB                         Order Number
     C                   KFLD                    WADPNB                         Order Sequence
     C                   KFLD                    WAUENB                         Order Secondary
     C                   KFLD                    WAA1TS                         BISH Timestamp
      * Check for duplicate primary key
     C     KLCRSA        SETLL     @BHCPE3                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5126'     W0RTN
      * Send message 'BI Sales History TRG   EX'
     C                   MOVEL     'USR5126'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
     C                   WRITE     @BHCPE3                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Set update flag if any of the fields change value
      *================================================================
      * Set Update Flag If Any 1st 50 Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24ORc25ORc26OR
      *  - c27ORc28ORc29ORc30ORc31ORc32ORc33ORc34OR c35ORc36ORc37ORc38OR
      *  - c39ORc40ORc41ORc42ORc43ORc44ORc45ORc46ORc47ORc48ORc49ORc50
      *   |- c1    : PR1.A/R City NE PR2.A/R City
      *   |- c2    : PR1.A/R State NE PR2.A/R State
      *   |- c3    : PR1.A/R County Code NE PR2.A/R County Code
      *   |- c4    : PR1.A/R Zip/Postal Code NE PR2.A/R Zip/Postal Code
      *   |- c5    : PR1.Alpha Search NE PR2.Alpha Search
      *   |- c6    : PR1.Country Code NE PR2.Country Code
      *   |- c7    : PR1.Type Code NE PR2.Type Code
      *   |- c8    : PR1.Parent Customer NE PR2.Parent Customer
      *   |- c9    : PR1.A/R Customer Number NE PR2.A/R Customer Number
      *   |- c10   : PR1.A/R Customer Name NE PR2.A/R Customer Name
      *   |- c11   : PR1.Ship To Customer NE PR2.Ship To Customer
      *   |- c12   : PR1.Ship To Name NE PR2.Ship To Name
      *   |- c13   : PR1.Ship To City NE PR2.Ship To City
      *   |- c14   : PR1.Ship To State Code NE PR2.Ship To State Code
      *   |- c15   : PR1.Ship To Zip/Postal Code NE PR2.Ship To Zip/Posta
      *   |- c16   : PR1.Customer Purchase Order # NE PR2.Customer Purcha
      *   |- c17   : PR1.Order Date NE PR2.Order Date
      *   |- c18   : PR1.Cancel Date NE PR2.Cancel Date
      *   |- c19   : PR1.Sales Route Code NE PR2.Sales Route Code
      *   |- c20   : PR1.Original Salesperson NE PR2.Original Salesperson
      *   |- c21   : PR1.Manager Level Code NE PR2.Manager Level Code
      *   |- c22   : PR1.VP Level Code NE PR2.VP Level Code
      *   |- c23   : PR1.Terms Code NE PR2.Terms Code
      *   |- c24   : PR1.Absorbed Freight Rate CWT NE PR2.Absorbed Freigh
      *   |- c25   : PR1.Carrier Code NE PR2.Carrier Code
      *   |- c26   : PR1.Order Header Reason NE PR2.Order Header Reason
      *   |- c27   : PR1.Order Type - Sales NE PR2.Order Type - Sales
      *   |- c28   : PR1.Shipping Method NE PR2.Shipping Method
      *   |- c29   : PR1.Export Status NE PR2.Export Status
      *   |- c30   : PR1.Attach to Invoice Number NE PR2.Attach to Invoic
      *   |- c31   : PR1.Attach to Order Number NE PR2.Attach to Order Nu
      *   |- c32   : PR1.Resell Reference Number NE PR2.Resell Reference
      *   |- c33   : PR1.Original Item NE PR2.Original Item
      *   |- c34   : PR1.Warehouse Code NE PR2.Warehouse Code
      *   |- c35   : PR1.Quantity Ordered NE PR2.Quantity Ordered
      *   |- c36   : PR1.Weight Ordered NE PR2.Weight Ordered
      *   |- c37   : PR1.Quantity Scheduled NE PR2.Quantity Scheduled
      *   |- c38   : PR1.Weight Scheduled NE PR2.Weight Scheduled
      *   |- c39   : PR1.U/M - Ordered NE PR2.U/M - Ordered
      *   |- c40   : PR1.Unit Price NE PR2.Unit Price
      *   |- c41   : PR1.Unit Price Ordered U/M NE PR2.Unit Price Ordered
      *   |- c42   : PR1.U/M - Base Price NE PR2.U/M - Base Price
      *   |- c43   : PR1.Requested Ship Date NE PR2.Requested Ship Date
      *   |- c44   : PR1.Invoice Date NE PR2.Invoice Date
      *   |- c45   : PR1.Deadline Depart DT    HDR NE PR2.Deadline Depart
      *   |- c46   : PR1.Unit Cost Per Pound NE PR2.Unit Cost Per Pound
      *   |- c47   : PR1.Unit Cost Pricing U/M NE PR2.Unit Cost Pricing U
      *   |- c48   : PR1.Unit Weight Ordered U/M NE PR2.Unit Weight Order
      *   |- c49   : PR1.Extended Amount NE PR2.Extended Amount
      *   |- c50   : PR1.Affect Inventory Status NE PR2.Affect Inventory
      *   '-
     C                   IF        P1MONA <> P2MONA OR
     C                             P1RJCD <> P2RJCD OR
     C                             P1RKCD <> P2RKCD OR
     C                             P1GPTX <> P2GPTX OR
     C                             P1ABTX <> P2ABTX OR
     C                             P1KXCD <> P2KXCD OR
     C                             P1BOCD <> P2BOCD OR
     C                             P1BTC7 <> P2BTC7 OR
     C                             P1ANC7 <> P2ANC7 OR
     C                             P1AQTX <> P2AQTX OR
     C                             P1BKC7 <> P2BKC7 OR
     C                             P1BRTX <> P2BRTX OR
     C                             P1HNNA <> P2HNNA OR
     C                             P1DBCD <> P2DBCD OR
     C                             P1CKTX <> P2CKTX OR
     C                             P1BCNA <> P2BCNA OR
     C                             P1A0DT <> P2A0DT OR
     C                             P1ACDT <> P2ACDT OR
     C                             P1R4CD <> P2R4CD OR
     C                             P1R5CD <> P2R5CD OR
     C                             P1BFCD <> P2BFCD OR
     C                             P1Q4CD <> P2Q4CD OR
     C                             P1AQCD <> P2AQCD OR
     C                             P1TBNB <> P2TBNB OR
     C                             P1BZNA <> P2BZNA OR
     C                             P1RLCD <> P2RLCD OR
     C                             P1JNCD <> P2JNCD OR
     C                             P1Q2CD <> P2Q2CD OR
     C                             P1U2ST <> P2U2ST OR
     C                             P1ATIN <> P2ATIN OR
     C                             P1T3NB <> P2T3NB OR
     C                             P1RSRN <> P2RSRN OR
     C                             P1ORIT <> P2ORIT OR
     C                             P1AJCD <> P2AJCD OR
     C                             P1AVQT <> P2AVQT OR
     C                             P1D0WG <> P2D0WG OR
     C                             P1CCQT <> P2CCQT OR
     C                             P1AUWG <> P2AUWG OR
     C                             P1AGCD <> P2AGCD OR
     C                             P1AKPR <> P2AKPR OR
     C                             P1AUPR <> P2AUPR OR
     C                             P1CRCD <> P2CRCD OR
     C                             P1A5DT <> P2A5DT OR
     C                             P1AWDT <> P2AWDT OR
     C                             P1HDDT <> P2HDDT OR
     C                             P1AGCS <> P2AGCS OR
     C                             P1AQCS <> P2AQCS OR
     C                             P1AVWG <> P2AVWG OR
     C                             P1AYVA <> P2AYVA OR
     C                             P1AMST <> P2AMST
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   GOTO      UAEXIT                                       *QUIT
     C                   END                                                    *FI
      * Set Update Flag If Any 2nd 50 Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24ORc25ORc26OR
      *  - c27ORc28ORc29ORc30ORc31ORc32ORc33ORc34OR c35ORc36ORc37ORc38OR
      *  - c39ORc40ORc41ORc42ORc43ORc44ORc45ORc46ORc47ORc48ORc49ORc50
      *   |- c1    : PR1.Affect Sales Doll Status NE PR2.Affect Sales Dol
      *   |- c2    : PR1.Affect Sales Pnds Status NE PR2.Affect Sales Pnd
      *   |- c3    : PR1.Contract Number NE PR2.Contract Number
      *   |- c4    : PR1.Export Country Code NE PR2.Export Country Code
      *   |- c5    : PR1.LD Arrival Date NE PR2.LD Arrival Date
      *   |- c6    : PR1.Accounting Year Code NE PR2.Accounting Year Code
      *   |- c7    : PR1.Accounting Period Code NE PR2.Accounting Period
      *   |- c8    : PR1.OM Week NE PR2.OM Week
      *   |- c9    : PR1.Quantity Billed NE PR2.Quantity Billed
      *   |- c10   : PR1.Weight Billed NE PR2.Weight Billed
      *   |- c11   : PR1.Shipped Item Code NE PR2.Shipped Item Code
      *   |- c12   : PR1.Billing Detail Cost Dol. NE PR2.Billing Detail C
      *   |- c13   : PR1.Billing Detail Gross Dol. NE PR2.Billing Detail
      *   |- c14   : PR1.FOB Gross Amount NE PR2.FOB Gross Amount
      *   |- c15   : PR1.Standard Overage Amount NE PR2.Standard Overage
      *   |- c16   : PR1.Tare Weight Total NE PR2.Tare Weight Total
      *   |- c17   : PR1.G/L Document Number NE PR2.G/L Document Number
      *   |- c18   : PR1.G/L Update Status NE PR2.G/L Update Status
      *   |- c19   : PR1.Shipping Company Number NE PR2.Shipping Company
      *   |- c20   : PR1.Order Detail Reason NE PR2.Order Detail Reason
      *   |- c21   : PR1.Price Overage Override NE PR2.Price Overage Over
      *   |- c22   : PR1.Date Method Code NE PR2.Date Method Code
      *   |- c23   : PR1.Price Method Code NE PR2.Price Method Code
      *   |- c24   : PR1.Market Pricing Date NE PR2.Market Pricing Date
      *   |- c25   : PR1.Commodity Market Code NE PR2.Commodity Market Co
      *   |- c26   : PR1.Quality Level NE PR2.Quality Level
      *   |- c27   : PR1.Item Level NE PR2.Item Level
      *   |- c28   : PR1.Item Structure Type Code NE PR2.Item Structure T
      *   |- c29   : PR1.Item Structure Group Code NE PR2.Item Structure
      *   |- c30   : PR1.Item Structure Class Code NE PR2.Item Structure
      *   |- c31   : PR1.Rated Freight NE PR2.Rated Freight
      *   |- c32   : PR1.Invoice Number NE PR2.Invoice Number
      *   |- c33   : PR1.Invoice Suffix NE PR2.Invoice Suffix
      *   |- c34   : PR1.Actual Shipped Date NE PR2.Actual Shipped Date
      *   |- c35   : PR1.Load ID NE PR2.Load ID
      *   |- c36   : PR1.Scheduled Ship Date NE PR2.Scheduled Ship Date
      *   |- c37   : PR1.Packaging Code NE PR2.Packaging Code
      *   |- c38   : PR1.Item Market Code NE PR2.Item Market Code
      *   |- c39   : PR1.Agrimetrics group NE PR2.Agrimetrics group
      *   |- c40   : PR1.Agrimetrics pack NE PR2.Agrimetrics pack
      *   |- c41   : PR1.Agrimetrics grade NE PR2.Agrimetrics grade
      *   |- c42   : PR1.Order Desc. Line One NE PR2.Order Desc. Line One
      *   |- c43   : PR1.Actual Freight Amount NE PR2.Actual Freight Amou
      *   |- c44   : PR1.Item Type Code NE PR2.Item Type Code
      *   |- c45   : PR1.PM R/M Type Code NE PR2.PM R/M Type Code
      *   |- c46   : PR1.PM Line Number NE PR2.PM Line Number
      *   |- c47   : PR1.SH Unused (was broker) NE PR2.SH Unused (was bro
      *   |- c48   : PR1.Pricing Date Used NE PR2.Pricing Date Used
      *   |- c49   : PR1.Modified Flag NE PR2.Modified Flag
      *   |- c50   : PR1.Absorbed Freight Amount NE PR2.Absorbed Freight
      *   '-
     C                   IF        P1ANST <> P2ANST OR
     C                             P1VAST <> P2VAST OR
     C                             P1L6NB <> P2L6NB OR
     C                             P1UMCD <> P2UMCD OR
     C                             P1HCDT <> P2HCDT OR
     C                             P1ESNB <> P2ESNB OR
     C                             P1ETNB <> P2ETNB OR
     C                             P1BZNB <> P2BZNB OR
     C                             P1EXQT <> P2EXQT OR
     C                             P1BYWG <> P2BYWG OR
     C                             P1S5NB <> P2S5NB OR
     C                             P1MAVA <> P2MAVA OR
     C                             P1KDVA <> P2KDVA OR
     C                             P1USVA <> P2USVA OR
     C                             P1UTVA <> P2UTVA OR
     C                             P1A4WG <> P2A4WG OR
     C                             P1CKNB <> P2CKNB OR
     C                             P1BMST <> P2BMST OR
     C                             P1R8NB <> P2R8NB OR
     C                             P1RMCD <> P2RMCD OR
     C                             P1BZPR <> P2BZPR OR
     C                             P1RDCD <> P2RDCD OR
     C                             P1Q7CD <> P2Q7CD OR
     C                             P1EXDT <> P2EXDT OR
     C                             P1LQCD <> P2LQCD OR
     C                             P1HICD <> P2HICD OR
     C                             P1RBCD <> P2RBCD OR
     C                             P1RGNB <> P2RGNB OR
     C                             P1RHNB <> P2RHNB OR
     C                             P1RINB <> P2RINB OR
     C                             P1R1NB <> P2R1NB OR
     C                             P1CONB <> P2CONB OR
     C                             P1CEST <> P2CEST OR
     C                             P1GNDT <> P2GNDT OR
     C                             P1RMNB <> P2RMNB OR
     C                             P1AODT <> P2AODT OR
     C                             P1LLCD <> P2LLCD OR
     C                             P1LMCD <> P2LMCD OR
     C                             P1SKNB <> P2SKNB OR
     C                             P1SLNB <> P2SLNB OR
     C                             P1SMNB <> P2SMNB OR
     C                             P1G7NA <> P2G7NA OR
     C                             P1ONVA <> P2ONVA OR
     C                             P1N0CD <> P2N0CD OR
     C                             P1B4NB <> P2B4NB OR
     C                             P1B5NB <> P2B5NB OR
     C                             P1N1CD <> P2N1CD OR
     C                             P1GIDT <> P2GIDT OR
     C                             P1Z1ST <> P2Z1ST OR
     C                             P1ULVA <> P2ULVA
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   GOTO      UAEXIT                                       *QUIT
     C                   END                                                    *FI
      * Set Update Flag If Any Remaining Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24ORc25ORc26ORc27OR
      *  - c28ORc29ORc30ORc31ORc32ORc33ORc34ORc35ORc36ORc37ORc38ORc39ORc
      *  - 40ORc41ORc42ORc43ORc44ORc45
      *   |- c1    : PR1.Ledgrd Trd Fund Accrl Amt NE PR2.Ledgrd Trd Fund
      *   |- c2    : PR1.Commission Amount NE PR2.Commission Amount
      *   |- c3    : PR1.Financials Amount - Spec NE PR2.Financials Amoun
      *   |- c4    : PR1.Financials Amount - Frght NE PR2.Financials Amou
      *   |- c5    : PR1.Group for Packaging NE PR2.Group for Packaging
      *   |- c6    : PR1.Base/Conv/Loss Item NE PR2.Base/Conv/Loss Item
      *   |- c7    : PR1.Variety/Rendered/Cut NE PR2.Variety/Rendered/Cut
      *   |- c8    : PR1.Customer Group Code NE PR2.Customer Group Code
      *   |- c9    : PR1.Customer Group Code 2 NE PR2.Customer Group Code
      *   |- c10   : PR1.Order Group Code NE PR2.Order Group Code
      *   |- c11   : PR1.Shipping Zone Code NE PR2.Shipping Zone Code
      *   |- c12   : PR1.Process Sts for 3C NE PR2.Process Sts for 3C
      *   |- c13   : PR1.Invoice Unit Price NE PR2.Invoice Unit Price
      *   |- c14   : PR1.Invoice Extended Amt NE PR2.Invoice Extended Amt
      *   |- c16   : PR1.Req Shipping Temp NE PR2.Req Shipping Temp
      *   |- c17   : PR1.Actual Shipping Temp NE PR2.Actual Shipping Temp
      *   |- c18   : PR1.Age Code NE PR2.Age Code
      *   |- c19   : PR1.Req Delivery Date NE PR2.Req Delivery Date
      *   |- c20   : PR1.Req Delivery Time NE PR2.Req Delivery Time
      *   |- c21   : PR1.MPC Number NE PR2.MPC Number
      *   |- c22   : PR1.Shipping Line NE PR2.Shipping Line
      *   |- c23   : PR1.Port Delv Terminal NE PR2.Port Delv Terminal
      *   |- c24   : PR1.Port City NE PR2.Port City
      *   |- c25   : PR1.Vessel Name NE PR2.Vessel Name
      *   |- c26   : PR1.Booking Number NE PR2.Booking Number
      *   |- c27   : PR1.Load Total Freight NE PR2.Load Total Freight
      *   |- c28   : PR1.Claim Number NE PR2.Claim Number
      *   |- c29   : PR1.Ham Group Number NE PR2.Ham Group Number
      *   |- c30   : PR1.Palletize NE PR2.Palletize
      *   |- c31   : PR1.Commodity Market Price NE PR2.Commodity Market P
      *   |- c32   : PR1.Market Value NE PR2.Market Value
      *   |- c33   : PR1.Default Cmdty Mkt Price NE PR2.Default Cmdty Mkt
      *   |- c34   : PR1.Raw Material Cost /LB NE PR2.Raw Material Cost /
      *   |- c35   : PR1.Sales Expense Process Sts NE PR2.Sales Expense P
      *   |- c36   : PR1.Sales Expense Total NE PR2.Sales Expense Total
      *   |- c37   : PR1.Data Mart Process Sts NE PR2.Data Mart Process S
      *   |- c38   : PR1.LH Load Type NE PR2.LH Load Type
      *   |- c39   : PR1.Order TF Exempt Code NE PR1.Order TF Exempt Code
      *   |- c40   : PR1.LD Sail Date NE PR2.LD Sail Date
      *   |- c41   : PR1.NonLedgrd TrdFnd Acrl Amt NE PR2.NonLedgrd TrdFn
      *   |- c42   : PR1.HST Item Target Price NE PR2.HST Item Target Pri
      *   |- c43   : PR1.EDI Status 1 NE PR2.EDI Status 1
      *   |- c44   : PR1.EDI Status 2 NE PR2.EDI Status 2
      *   |- c45   : PR1.EDI Status 3 NE PR2.EDI Status 3
      *   '-
     C                   IF        P1UNVA <> P2UNVA OR
     C                             P1UOVA <> P2UOVA OR
     C                             P1UPVA <> P2UPVA OR
     C                             P1UQVA <> P2UQVA OR
     C                             P1SDCD <> P2SDCD OR
     C                             P1QZCD <> P2QZCD OR
     C                             P1XWST <> P2XWST OR
     C                             P1T9CD <> P2T9CD OR
     C                             P1UBCD <> P2UBCD OR
     C                             P1CFC7 <> P2CFC7 OR
     C                             P1X1CD <> P2X1CD OR
     C                             P1GASX <> P2GASX OR
     C                             P1DUPR <> P2DUPR OR
     C                             P1B6VL <> P2B6VL OR
     C                             P1IANX <> P2IANX OR
     C                             P1IBNX <> P2IBNX OR
     C                             P1RPCD <> P2RPCD OR
     C                             P1NYDT <> P2NYDT OR
     C                             P1BZTM <> P2BZTM OR
     C                             P1Z4NB <> P2Z4NB OR
     C                             P1XACD <> P2XACD OR
     C                             P1OANA <> P2OANA OR
     C                             P1OKTX <> P2OKTX OR
     C                             P1K4TX <> P2K4TX OR
     C                             P1NBBO <> P2NBBO OR
     C                             P1OCFR <> P2OCFR OR
     C                             P1C0C7 <> P2C0C7 OR
     C                             P1A1AA <> P2A1AA OR
     C                             P1VEST <> P2VEST OR
     C                             P1A5PR <> P2A5PR OR
     C                             P1CDPR <> P2CDPR OR
     C                             P1D0PR <> P2D0PR OR
     C                             P1D0VL <> P2D0VL OR
     C                             P1IRSX <> P2IRSX OR
     C                             P1CEVL <> P2CEVL OR
     C                             P1ISSX <> P2ISSX OR
     C                             P1ITSX <> P2ITSX OR
     C                             P1IUSX <> P1IUSX OR
     C                             P1OHDT <> P2OHDT OR
     C                             P1D9PR <> P2D9PR OR
     C                             P1CFVL <> P2CFVL OR
     C                             P1UVST <> P2UVST OR
     C                             P1UWST <> P2UWST OR
     C                             P1UXST <> P2UXST
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   END                                                    *FI
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   XSTMS         BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                   CALL      'Y2RTTSK'
     C                   PARM                    ##TMS                          System timestam
      *================================================================
     CSR   XSTMSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WADPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WAUENB                         Order Secondary
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
     C                   MOVEL     XDTSDL        WAA1TS                         BISH Timestamp
     C                   Z-ADD     *ZERO         WABCDX                         BISH Process Da
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SACRRC.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   Z-ADD     *ZERO         WL0003
     C                   Z-ADD     *ZERO         WL0004
     C                   EVAL      WL0005 = ' '
     C                   EVAL      WL0006 = ' '
     C                   Z-ADD     *ZERO         WL0007
      * Define local work field Update Record USR
     C                   EVAL      YL0001 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
