     H/TITLE EDT Cr/Dr Memo Lines   EF Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated
     H* - Key changes are not allowed
     H* - Program functions in two modes : *ADD and *CHANGE
     H* - Multiple new records may be added by changing to add mode
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 03/19/25  Time  : 04:17:28
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDPGEFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: EDT Cr/Dr Memo Lines   EF Edit file
      *
     FOPBGWKLAIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Detail              co/
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOPCIREL7IF  E           K        DISK
      * RSQ : OPP Item Contract         RSQ Cont#/Co/Cust/Item
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FPDK0REL1IF  E           K        DISK
      * RTV : Order Group               Retrieval index
      *
     FOMFYREL0IF  E           K        DISK
      * RTV : Commodity Markets         Retrieval index
      *
     FPDIPREL0IF  E           K        DISK
      * RTV : Market Date Method        Retrieval index
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FPDIRREL0IF  E           K        DISK
      * RTV : Price Audit Reason Cd     Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FOME8REL0IF  E           K        DISK
      * RTV : Item Structure Type       Retrieval index
      *
     FOME9REL0IF  E           K        DISK
      * RTV : Item Structure Group      Retrieval index
      *
     FOMFAREL1IF  E           K        DISK
      * RTV : Item Structure Class      Retrieval index
      *
     FPDILREL0IF  E           K        DISK
      * RTV : Item Level Codes          Retrieval index
      *
     FCAAIREL1IF  E           K        DISK
      * RTV : Quality Level             Retrieval index       NV
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country Master            Retrieval index
      *
     FOPEZREL1IF  E           K        DISK
      * RTV : Event Types               Retrieval index       NV
      *
     FOPCXREL1IF  E           K        DISK
      * RTV : OP Reason Codes           Retrieval index
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FPDM0REL1IF  E           K        DISK
      * RTV : Ham Group Master          Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAAQREL1IF  E           K        DISK
      * RTV : Company Defaults          Retrieval index       NV
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK                      A
      * UPD : Order Detail              Update index
      *
     FOMHSTPL0UF  E           K        DISK
      * UPD : Sales History             Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
     I              ADQDSC                          WBQDSC
      *
     I@FHSTD2
      * Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WCAIC3
     I              F4C4NB                          WCC4NB
     I              F4DPNB                          WCDPNB
     I              F4UENB                          WCUENB
     I              F4MONA                          WCMONA
     I              F4RJCD                          WCRJCD
     I              F4RKCD                          WCRKCD
     I              F4GPTX                          WCGPTX
     I              F4ABTX                          WCABTX
     I              F4KXCD                          WCKXCD
     I              F4BOCD                          WCBOCD
     I              F4BTC7                          WCBTC7
     I              F4ANC7                          WCANC7
     I              F4AQTX                          WCAQTX
     I              F4BKC7                          WCBKC7
     I              F4BRTX                          WCBRTX
     I              F4HNNA                          WCHNNA
     I              F4DBCD                          WCDBCD
     I              F4CKTX                          WCCKTX
     I              F4BCNA                          WCBCNA
     I              F4A0DT                          WCA0DT
     I              F4ACDT                          WCACDT
     I              F4R4CD                          WCR4CD
     I              F4R5CD                          WCR5CD
     I              F4BFCD                          WCBFCD
     I              F4Q4CD                          WCQ4CD
     I              F4AQCD                          WCAQCD
     I              F4TBNB                          WCTBNB
     I              F4BZNA                          WCBZNA
     I              F4RLCD                          WCRLCD
     I              F4JNCD                          WCJNCD
     I              F4Q2CD                          WCQ2CD
     I              F4U2ST                          WCU2ST
     I              F4ATIN                          WCATIN
     I              F4T3NB                          WCT3NB
     I              F4RSRN                          WCRSRN
     I              F4ORIT                          WCORIT
     I              F4AJCD                          WCAJCD
     I              F4AVQT                          WCAVQT
     I              F4D0WG                          WCD0WG
     I              F4CCQT                          WCCCQT
     I              F4AUWG                          WCAUWG
     I              F4AGCD                          WCAGCD
     I              F4AKPR                          WCAKPR
     I              F4AUPR                          WCAUPR
     I              F4CRCD                          WCCRCD
     I              F4A5DT                          WCA5DT
     I              F4AWDT                          WCAWDT
     I              F4HDDT                          WCHDDT
     I              F4AGCS                          WCAGCS
     I              F4AQCS                          WCAQCS
     I              F4AVWG                          WCAVWG
     I              F4AYVA                          WCAYVA
     I              F4AMST                          WCAMST
     I              F4ANST                          WCANST
     I              F4VAST                          WCVAST
     I              F4L6NB                          WCL6NB
     I              F4UMCD                          WCUMCD
     I              F4HCDT                          WCHCDT
     I              F4ESNB                          WCESNB
     I              F4ETNB                          WCETNB
     I              F4BZNB                          WCBZNB
     I              F4EXQT                          WCEXQT
     I              F4BYWG                          WCBYWG
     I              F4S5NB                          WCS5NB
     I              F4MAVA                          WCMAVA
     I              F4KDVA                          WCKDVA
     I              F4USVA                          WCUSVA
     I              F4UTVA                          WCUTVA
     I              F4A4WG                          WCA4WG
     I              F4CKNB                          WCCKNB
     I              F4BMST                          WCBMST
     I              F4R8NB                          WCR8NB
     I              F4RMCD                          WCRMCD
     I              F4BZPR                          WCBZPR
     I              F4RDCD                          WCRDCD
     I              F4Q7CD                          WCQ7CD
     I              F4EXDT                          WCEXDT
     I              F4LQCD                          WCLQCD
     I              F4HICD                          WCHICD
     I              F4RBCD                          WCRBCD
     I              F4RGNB                          WCRGNB
     I              F4RHNB                          WCRHNB
     I              F4RINB                          WCRINB
     I              F4R1NB                          WCR1NB
     I              F4CONB                          WCCONB
     I              F4CEST                          WCCEST
     I              F4GNDT                          WCGNDT
     I              F4RMNB                          WCRMNB
     I              F4AODT                          WCAODT
     I              F4LLCD                          WCLLCD
     I              F4LMCD                          WCLMCD
     I              F4SKNB                          WCSKNB
     I              F4SLNB                          WCSLNB
     I              F4SMNB                          WCSMNB
     I              F4G7NA                          WCG7NA
     I              F4ONVA                          WCONVA
     I              F4N0CD                          WCN0CD
     I              F4B4NB                          WCB4NB
     I              F4B5NB                          WCB5NB
     I              F4N1CD                          WCN1CD
     I              F4GIDT                          WCGIDT
     I              F4Z1ST                          WCZ1ST
     I              F4ULVA                          WCULVA
     I              F4UNVA                          WCUNVA
     I              F4UOVA                          WCUOVA
     I              F4UPVA                          WCUPVA
     I              F4UQVA                          WCUQVA
     I              F4SDCD                          WCSDCD
     I              F4QZCD                          WCQZCD
     I              F4XWST                          WCXWST
     I              F4T9CD                          WCT9CD
     I              F4UBCD                          WCUBCD
     I              F4CFC7                          WCCFC7
     I              F4X1CD                          WCX1CD
     I              F4GASX                          WCGASX
     I              F4DUPR                          WCDUPR
     I              F4B6VL                          WCB6VL
     I              F4IANX                          WCIANX
     I              F4IBNX                          WCIBNX
     I              F4RPCD                          WCRPCD
     I              F4NYDT                          WCNYDT
     I              F4BZTM                          WCBZTM
     I              F4Z4NB                          WCZ4NB
     I              F4XACD                          WCXACD
     I              F4OANA                          WCOANA
     I              F4OKTX                          WCOKTX
     I              F4K4TX                          WCK4TX
     I              F4NBBO                          WCNBBO
     I              F4OCFR                          WCOCFR
     I              F4C0C7                          WCC0C7
     I              F4A1AA                          WCA1AA
     I              F4VEST                          WCVEST
     I              F4A5PR                          WCA5PR
     I              F4CDPR                          WCCDPR
     I              F4D0PR                          WCD0PR
     I              F4D0VL                          WCD0VL
     I              F4IRSX                          WCIRSX
     I              F4CEVL                          WCCEVL
     I              F4ISSX                          WCISSX
     I              F4ITSX                          WCITSX
     I              F4IUSX                          WCIUSX
     I              F4OHDT                          WCOHDT
     I              F4D9PR                          WCD9PR
     I              F4CFVL                          WCCFVL
     I              F4UVST                          WCUVST
     I              F4UWST                          WCUWST
     I              F4UXST                          WCUXST
     I              F4AATM                          WCAATM
     I              F4AYNA                          WCAYNA
     I              F4A0NA                          WCA0NA
     I              F4AXDT                          WCAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Current/previous master file format fields for change control
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      * Outward parameters
     IPARC        DS                             12
      * KEY : Order Detail Accrual      Retrieval index
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Order Number
     I                                    P   3   60PAC4NB
      * I : RST Order Sequence Number
     I                                    P   7   80PADPNB
      * I : RST Order Secondary Line Seq
     I                                    P   9  100PAUENB
      *
     IYBRDCS      DS                            525
     IYCRDCS      DS                            525
     IYDRDCS      DS                            525
     IQOMHS1    E DSOMHSTPL0
      * UPD : Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WCAIC3
     I              F4C4NB                          WCC4NB
     I              F4DPNB                          WCDPNB
     I              F4UENB                          WCUENB
     I              F4MONA                          WCMONA
     I              F4RJCD                          WCRJCD
     I              F4RKCD                          WCRKCD
     I              F4GPTX                          WCGPTX
     I              F4ABTX                          WCABTX
     I              F4KXCD                          WCKXCD
     I              F4BOCD                          WCBOCD
     I              F4BTC7                          WCBTC7
     I              F4ANC7                          WCANC7
     I              F4AQTX                          WCAQTX
     I              F4BKC7                          WCBKC7
     I              F4BRTX                          WCBRTX
     I              F4HNNA                          WCHNNA
     I              F4DBCD                          WCDBCD
     I              F4CKTX                          WCCKTX
     I              F4BCNA                          WCBCNA
     I              F4A0DT                          WCA0DT
     I              F4ACDT                          WCACDT
     I              F4R4CD                          WCR4CD
     I              F4R5CD                          WCR5CD
     I              F4BFCD                          WCBFCD
     I              F4Q4CD                          WCQ4CD
     I              F4AQCD                          WCAQCD
     I              F4TBNB                          WCTBNB
     I              F4BZNA                          WCBZNA
     I              F4RLCD                          WCRLCD
     I              F4JNCD                          WCJNCD
     I              F4Q2CD                          WCQ2CD
     I              F4U2ST                          WCU2ST
     I              F4ATIN                          WCATIN
     I              F4T3NB                          WCT3NB
     I              F4RSRN                          WCRSRN
     I              F4ORIT                          WCORIT
     I              F4AJCD                          WCAJCD
     I              F4AVQT                          WCAVQT
     I              F4D0WG                          WCD0WG
     I              F4CCQT                          WCCCQT
     I              F4AUWG                          WCAUWG
     I              F4AGCD                          WCAGCD
     I              F4AKPR                          WCAKPR
     I              F4AUPR                          WCAUPR
     I              F4CRCD                          WCCRCD
     I              F4A5DT                          WCA5DT
     I              F4AWDT                          WCAWDT
     I              F4HDDT                          WCHDDT
     I              F4AGCS                          WCAGCS
     I              F4AQCS                          WCAQCS
     I              F4AVWG                          WCAVWG
     I              F4AYVA                          WCAYVA
     I              F4AMST                          WCAMST
     I              F4ANST                          WCANST
     I              F4VAST                          WCVAST
     I              F4L6NB                          WCL6NB
     I              F4UMCD                          WCUMCD
     I              F4HCDT                          WCHCDT
     I              F4ESNB                          WCESNB
     I              F4ETNB                          WCETNB
     I              F4BZNB                          WCBZNB
     I              F4EXQT                          WCEXQT
     I              F4BYWG                          WCBYWG
     I              F4S5NB                          WCS5NB
     I              F4MAVA                          WCMAVA
     I              F4KDVA                          WCKDVA
     I              F4USVA                          WCUSVA
     I              F4UTVA                          WCUTVA
     I              F4A4WG                          WCA4WG
     I              F4CKNB                          WCCKNB
     I              F4BMST                          WCBMST
     I              F4R8NB                          WCR8NB
     I              F4RMCD                          WCRMCD
     I              F4BZPR                          WCBZPR
     I              F4RDCD                          WCRDCD
     I              F4Q7CD                          WCQ7CD
     I              F4EXDT                          WCEXDT
     I              F4LQCD                          WCLQCD
     I              F4HICD                          WCHICD
     I              F4RBCD                          WCRBCD
     I              F4RGNB                          WCRGNB
     I              F4RHNB                          WCRHNB
     I              F4RINB                          WCRINB
     I              F4R1NB                          WCR1NB
     I              F4CONB                          WCCONB
     I              F4CEST                          WCCEST
     I              F4GNDT                          WCGNDT
     I              F4RMNB                          WCRMNB
     I              F4AODT                          WCAODT
     I              F4LLCD                          WCLLCD
     I              F4LMCD                          WCLMCD
     I              F4SKNB                          WCSKNB
     I              F4SLNB                          WCSLNB
     I              F4SMNB                          WCSMNB
     I              F4G7NA                          WCG7NA
     I              F4ONVA                          WCONVA
     I              F4N0CD                          WCN0CD
     I              F4B4NB                          WCB4NB
     I              F4B5NB                          WCB5NB
     I              F4N1CD                          WCN1CD
     I              F4GIDT                          WCGIDT
     I              F4Z1ST                          WCZ1ST
     I              F4ULVA                          WCULVA
     I              F4UNVA                          WCUNVA
     I              F4UOVA                          WCUOVA
     I              F4UPVA                          WCUPVA
     I              F4UQVA                          WCUQVA
     I              F4SDCD                          WCSDCD
     I              F4QZCD                          WCQZCD
     I              F4XWST                          WCXWST
     I              F4T9CD                          WCT9CD
     I              F4UBCD                          WCUBCD
     I              F4CFC7                          WCCFC7
     I              F4X1CD                          WCX1CD
     I              F4GASX                          WCGASX
     I              F4DUPR                          WCDUPR
     I              F4B6VL                          WCB6VL
     I              F4IANX                          WCIANX
     I              F4IBNX                          WCIBNX
     I              F4RPCD                          WCRPCD
     I              F4NYDT                          WCNYDT
     I              F4BZTM                          WCBZTM
     I              F4Z4NB                          WCZ4NB
     I              F4XACD                          WCXACD
     I              F4OANA                          WCOANA
     I              F4OKTX                          WCOKTX
     I              F4K4TX                          WCK4TX
     I              F4NBBO                          WCNBBO
     I              F4OCFR                          WCOCFR
     I              F4C0C7                          WCC0C7
     I              F4A1AA                          WCA1AA
     I              F4VEST                          WCVEST
     I              F4A5PR                          WCA5PR
     I              F4CDPR                          WCCDPR
     I              F4D0PR                          WCD0PR
     I              F4D0VL                          WCD0VL
     I              F4IRSX                          WCIRSX
     I              F4CEVL                          WCCEVL
     I              F4ISSX                          WCISSX
     I              F4ITSX                          WCITSX
     I              F4IUSX                          WCIUSX
     I              F4OHDT                          WCOHDT
     I              F4D9PR                          WCD9PR
     I              F4CFVL                          WCCFVL
     I              F4UVST                          WCUVST
     I              F4UWST                          WCUWST
     I              F4UXST                          WCUXST
     I              F4AATM                          WCAATM
     I              F4AYNA                          WCAYNA
     I              F4A0NA                          WCA0NA
     I              F4AXDT                          WCAXDT
      *
     IYERDCS      DS                            792
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I : MAP Order Type_Sales
     I                                        7   8 P1JNCD
      * I : MAP Ship To Customer
     I                                    P   9  120P1BKC7
      * I : MAP Ship To Name
     I                                       13  42 P1BRTX
      * I : MAP Order Date
     I                                    P  43  460P1A0DT
      * N :  Requested Ship Date
     I                                    P  47  500P1A5DT
      * N :  Comment Print Acknowledge
     I                                       51  51 P1GTST
      * N :  Comment Print Inv_Cr_Memo
     I                                       52  52 P1GVST
      * N :  Comment Print Pick Slip
     I                                       53  53 P1GUST
      * N :  Comment Print Ship Doc
     I                                       54  54 P1QFST
      * N : MAP Order Value Total
     I                                    P  55  602P1JZVA
      * N : MAP Order Weight Total
     I                                    P  61  662P1A1WG
      * I :  Price Status
     I                                       67  67 P1U1ST
      * N :  Palletize
     I                                       68  68 P1VEST
      * N :  Slip Sheet
     I                                       69  69 P1VGST
      * N :  Age Code
     I                                       70  70 P1RPCD
      * N :  Reefer Temperature
     I                                    P  71  732P1RNNB
      * N :  Load Type
     I                                       74  74 P1VDST
      * N :  Event Code
     I                                       75  76 P1JPCD
      * N :  Trans Contol AS400_Plant
     I                                       77  77 P1XUST
      * N :  Broker Order Status
     I                                       78  78 P1FSSX
      * I : MAP Claim Number
     I                                    P  79  820P1C0C7
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * I :  Application Code
     I                                        4   9 P2DNCD
      * N :  Enterprise Code 1
     I                                       10  13 P2DQCD
      * N :  Enterprise Code 2
     I                                       14  25 P2DRCD
      * N :  Salesperson Code
     I                                       26  28 P2BCCD
      * N :  System Date Format
     I                                       29  31 P2B8NA
      * N :  User Profile Name
     I                                       32  41 P2AJVN
      * N :  Allow Multi_Company
     I                                       42  42 P2I6ST
      * N :  Default Printer
     I                                       43  52 P2MPNA
      * N :  Access Denied (Y/N)
     I                                       53  53 P2WVST
     IP3PARM      DS
      * FLD: *Arrays
      * N :  USR Update Flag
     I                                        1   1 P3R4ST
      * N :  USR First Time
     I                                        2   2 P3TMST
      * N :  USR Display field
     I                                        3   3 P3GGST
      * N :  Display Flag
     I                                        4   4 P3QKST
      * N :  Calc Work Field 15,6 USR
     I                                    P   5  126P3JYNX
     IP4PARM      DS
      * FLD: OPP Item Contract
      * N :  Effective Date
     I                                    P   1   40P4AUDT
      * N :  End Date Effective
     I                                    P   5   80P4CWDT
      * N :  Maximum Quantity
     I                                    P   9  142P4DQQT
      * N :  Quantity Sold
     I                                    P  15  202P4HFQT
      * N :  Contract Mkt Price Date
     I                                    P  21  240P4GBDT
     IP5PARM      DS
      * FLD: *Arrays
      * N :  Cntrt Enter no QT Price
     I                                        1   1 P5WDST
      * N :  Cntrt.# does not Exit
     I                                        2   2 P5WEST
      * N :  Qty ordered > Contract
     I                                        3   3 P5WFST
      * N :  Contract Expired
     I                                        4   4 P5WGST
      * N :  Price Override Required
     I                                        5   5 P5WHST
      * N :  Price Method QT & Cntrt 0
     I                                        6   6 P5WIST
      * N :  Prc Code FRM or MKT
     I                                        7   7 P5WJST
      * N :  Mkt Pricing Date not 0
     I                                        8   8 P5WKST
      * N :  Mkt Meth. and Date both
     I                                        9   9 P5WLST
      * N :  Price Override Req. EXT
     I                                       10  10 P5WMST
      * N :  Contract Exists for Item
     I                                       11  11 P5XSST
      * N :  Price Override not Allowd
     I                                       12  12 P5YXST
     IP6PARM      DS
      * FLD: Price Method Header
      * N :  Price Method Type
     I                                        1   1 P6V8ST
     IP7PARM      DS
      * FLD: Order Types
      * N :  Billing Activity Type
     I                                        1   1 P7OBST
     IP8PARM      DS
      * N :  USR Pounds
     I                                    P   1   62P8MHNB
     IP9PARM      DS
      * FLD: Company Defaults
      * N :  Price Method Default C_M
     I                                        1   3 P9TOCD
      * N :  Price Method Default D_M
     I                                        4   6 P9TPCD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Memo/Claim Can't Delete'
      * *SFLSEL
     I                                        1   1 ZA0001
      * Message data for 'Memo/Claim Can't Delete'
      * *SFLSEL
     I                                        1   1 ZA0002
      * Message data for 'Company Item           NF'
      * Company Number CDE
     I                                    P   1   20ZA0003
      * Item Code Number 7.0  USR
     I                                    P   3   60ZA0004
      * Message data for 'Itm/Customer MB Exempt'
      * Item Code
     I                                        1   7 ZA0005
      * Ship To Customer
     I                                        8  14 ZA0006
      * Message data for 'Warehouse Codes        NF'
      * Warehouse Code
     I                                        1   3 ZA0007
      * Message data for 'Item Balance           NF'
      * Company Number
     I                                        1   3 ZA0008
      * Item Code
     I                                        4  10 ZA0009
      * Warehouse Code
     I                                       11  13 ZA0010
      * Message data for 'Item must be Finished Gd'
      * Item Code
     I                                        1   7 ZA0011
      * Message data for 'OPP Contract Error'
      * Contract Number
     I                                    P   1   40ZA0012
      * Message data for 'Price Meth inv with 0 qty'
      * Price Method Code
     I                                        1   3 ZA0013
      * Message data for 'Price Meth Invalid-Cr/Dr'
      * Price Method Code
     I                                        1   3 ZA0014
      * Message data for 'Pounds is Required'
      * Weight Ordered
     I                                    P   1   62ZA0015
      * Message data for 'Error in Pricing Routine'
      * Market Pricing Date
     I                                    P   1   40ZA0016
      * Date Method Code
     I                                        5   7 ZA0017
      * Price Method Code
     I                                        8  10 ZA0018
      * Commodity Market Code
     I                                       11  13 ZA0019
      * Error Return
     I                                       14  18 ZA0020
      * Message data for 'Error in Pricing Routine'
      * Market Pricing Date
     I                                    P   1   40ZA0021
      * Date Method Code
     I                                        5   7 ZA0022
      * Price Method Code
     I                                        8  10 ZA0023
      * Commodity Market Code
     I                                       11  13 ZA0024
      * Error Return
     I                                       14  18 ZA0025
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1JNCD    PARM           WP0003  2        Order Type_Sale
     C           P1BKC7    PARM           WP0004  70       Ship To Custome
     C           P1BRTX    PARM           WP0005 30        Ship To Name
     C           P1A0DT    PARM           WP0006  70       Order Date
     C           P1U1ST    PARM           WP0007  1        Price Status
     C           P1C0C7    PARM           WP0008  70       Claim Number
     C           P2DNCD    PARM           WP0009  6        Application Cod
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
      * 07/11/06 Get the header Status for Complete & Confirmed
     C                     MOVEL*BLANK    YL0001           Display Flag 1
      * CASE: PAR.USR First Time is Yes
     C           P3TMST    IFEQ 'Y'                        *IF
      * Perform first time processing.
     C                     EXSR UASUBR                     Perform first t
     C                     END                             *FI
      * 07/11/06 Add the Completed/Confirmed logic on only allow of Aff
      *          flags for update
      * CASE: LCL.Header Status is Confirmed & Complete
     C           YL0002    IFEQ 'C'                        *IF
     C           YL0002    OREQ 'R'
     C                     MOVEL'N'       P3QKST           Display Flag
     C                     MOVEL'N'       YL0001           Display Flag 1
      * Add mode is not valid if claim memo.
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'CHG'     W0PMD            *Program mode
      * Send message 'Memo/Claim No Add All C/R'
     C                     MOVEL'USR3644' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If claim memo, then make screen fields output onlu.
     C                     EXSR UBSUBR                     If claim memo,
     C                     END                             *FI
      * Vry TFExmp - Customer - Customer EXT  * 
     C                     EXSR SCRVGN
      * CASE: LCL.Customer TF Exempt Code is Exempt Customer
     C           YL0003    IFEQ 'EC'                       *IF
     C                     MOVEL*BLANK    YL0004           OH TF Exempt Co
     C                     MOVELYL0003    YL0004           OH TF Exempt Co
     C                     ELSE
      * CASE: LCL.Customer TF Exempt Code is Not Exempt
     C           YL0003    IFEQ 'NE'                       *IF
     C                     MOVEL*BLANK    YL0004           OH TF Exempt Co
     C                     MOVEL'EP'      YL0004           OH TF Exempt Co
     C                     END                             *FI
     C                     END                             *FI
      * CTL.TF Exempt Code Desc Usr = Condition name of LCL.OH TF Exempt
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1575067   Y2LSNO  70       List number
     C                     PARM YL0004    W0INVL 25        OH TF Exempt Co
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CHET1    PARM           W0CNNM 25        TF Exempt Code
      *
     C                     END
      *................................................................
      * If CHANGE mode, then position file:
     C           W0PMD     IFNE 'ADD'
     C           KPOS      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C                     Z-ADD#2DPNB    OMDPNB
     C                     Z-ADD#2UENB    OMUENB
      * 82=EOF
     C           KPOS      SETLL@BGWKAE              82    *
      * 82=EOF
     C           KRST      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C  N82      KRST      READE@BGWKAE                9182*
     C                     ELSE
     C                     SETOF                     82    *
     C                     END
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page (write empty page if add mode)
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27      W0PMD     IFNE 'ADD'
     C  N82                READP@BGWKAE                  90*
     C  N82                READ @BGWKAE                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0 12
     C                     MOVE *ALL'1'   WKIND1 12
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * If CHANGE mode, load subfile fields
     C           W0PMD     IFNE 'ADD'
     C                     EXSR MBFL#1
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
     C                     Z-ADDOMD0WG    #RMHNB           USR Pounds
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
      * E3387 JJH 09/12/14 - Display Shipping Method
     C                     MOVEL*BLANK    #CDGU1           ACR Shipping Me
      * ACR Shipping Method DRV
      * PAR.ACR Shipping Method DRV = Condition name of PAR.ACR Shipping
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #CQ2CD    W0INVL 25        ACR Shipping Me
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CDGU1    PARM           W0CNNM 25        ACR Shipping Me
      *
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
     C                     ELSE
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile record (new record)
     C                     MOVEL'E'       #1GMST           Detail Line Sta
     C                     MOVEL'P'       #1U1ST           Price Status
     C                     Z-ADD*ZERO     #1DPNB           Order Sequence
     C                     Z-ADD1         #1UENB           Order Secondary
     C                     Z-ADD##JDT     #1CXDT           Date of Origina
      * RTV Affect Inv/Sls     RT - OP Order Types  * 
     C                     EXSR SDRVGN
      * CASE: PAR.Broker Order Status is yes
     C           P1FSSX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0005           Affect Commissi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0005           Affect Commissi
     C                     END                             *FI
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     END
     C                     END
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
     C           W0PMD     IFNE 'ADD'
      * 82=EOF
     C           KRST      READE@BGWKAE                  82*
     C                     END
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
     C                     MOVEL*BLANK    #CDGU1           ACR Shipping Me
      * ACR Shipping Method DRV
      * PAR.ACR Shipping Method DRV = Condition name of PAR.ACR Shipping
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #CQ2CD    W0INVL 25        ACR Shipping Me
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CDGU1    PARM           W0CNNM 25        ACR Shipping Me
      *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile control
      * CASE: CTL.*CMD key is CF13
     C           *IN13     IFEQ '1'                        *IF
      * Prt Claim-Claim All   XF - A/R Claim  * 
     C                     CALL 'PPL7XFR'              90  Prt Claim-Claim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #PC0C7    WQ0001  70       Claim Number
     C                     PARM #2AIC3    WQ0002  30       Claim Company N
     C                     PARM @CN,001   WQ0003 10        PRT Printer Dev
     C                     PARM '*YES'    WQ0004  4        PRT Hold Output
     C                     PARM '*NO'     WQ0005  4        PRT Save Output
     C                     PARM 1         WQ0006  20       PRT Number of C
     C                     PARM 'N'       WQ0007  1        Status - Y or N
     C                     PARM 'N'       WQ0008  1        Online Report U
     C                     PARM *BLANK    WQ0009  1        Email Selection
     C                     PARM *BLANK    WQ0010  3        Approval Title
     C                     PARM *ZERO     WQ0011  30       Sequence Number
     C                     PARM *BLANK    WQ0012 50        Approval Person
     C                     PARM *BLANK    WQ0013  1        Claim Audit Sel
     C                     PARM *BLANK    WQ0014 10        Claim Audit Co
     C                     PARM *BLANK    WQ0015 50        Approval Claim
     C                     PARM '*NO'     WQ0016  4        Claim Prt Audit
     C                     PARM '*NO'     WQ0017  4        Claim Prt Intrl
     C                     PARM 'R'       WQ0018  1        Claim Print Typ
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPL7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * DSP&DLT Spool File     UP - /UT User Programs  * 
     C                     CALL 'PDP5UPR'              90  DSP&DLT Spool F
     C                     PARM @CN,002   WQ0019 10        File Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
      * Switch between *ADD/*CHANGE modes
     C   09                EXSR FACHMD
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * CASE: LCL.Header Status is Confirmed & Complete
     C           YL0002    IFEQ 'C'                        *IF
     C           YL0002    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.USR Update Flag is Yes
     C           P3R4ST    IFEQ 'Y'                        *IF
      * did call UPD Sum Cr/Dr Memo Tot XF  (all parms CTL)
      * CLC Tot Ord Val Memo   XF - Order Detail  * 
     C                     CALL 'PDQEXFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0020  30       Company Number
     C                     PARM #2C4NB    WQ0021  70       Order Number
     C           #PJZVA    PARM #PJZVA    WQ0022 112       Order Value Tot
     C           #PA1WG    PARM #PA1WG    WQ0023 112       USR Order Weigh
     C           WUXPST    PARM WUXPST    WQ0024  1        USR Production
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: CTL.Claim Number is Claim Process
     C           #PC0C7    IFGT *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg TF Exempt         CH - Order Header TRG  * 
     C                     EXSR SECHRC
     C                     END                             *FI
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
      * No errors
     C                     SETOF                     98
      * No SFLNXTCHG
     C                     SETOF                     84
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           W0PMD     IFEQ 'ADD'
      * Check for null record
     C                     EXSR DDNLRC
     C           W0NLR     IFEQ 'Y'
     C           ##RR      ANDNEYPMRRN
      * Clear all record fields
     C                     EXSR MAIZ#1
     C                     GOTO DCEXIT
     C                     END
      * If not null record, continue
     C                     END
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DDNLRC    BEGSR
      *================================================================
      * Check for null record
      *================================================================
     C                     MOVEL'N'       W0NLR   1
     C           V1HGCD    CABNE*BLANK    DDEXIT           Item Code
     C           #1AVQT    CABNE*ZERO     DDEXIT           Quantity Ordere
     C           #1BZPR    CABNE*ZERO     DDEXIT           Price Overage O
     C           #RMHNB    CABNE*ZERO     DDEXIT           USR Pounds
     C           #1Q7CD    CABNE*BLANK    DDEXIT           Price Method Co
     C           #1AJCD    CABNE*BLANK    DDEXIT           Warehouse Code
     C           #1L6NB    CABNE*ZERO     DDEXIT           Contract Number
     C           #1CQCD    CABNE*BLANK    DDEXIT           Reason Code
     C           #1AMST    CABNE*BLANK    DDEXIT           Affect Inventor
     C           #1ANST    CABNE*BLANK    DDEXIT           Affect Sales Do
     C           #1VAST    CABNE*BLANK    DDEXIT           Affect Sales Pn
     C                     MOVEL'Y'       W0NLR
      *================================================================
     CSR         DDEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
      * Validate Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1HGCD    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     Z-ADD*ZERO     #1HGCD           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1HGCD           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Affect Inventory Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1AMST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * Affect Inventory Status
     C                     MOVEL#1AMST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHAMST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHAMST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHAMST
     C                     ENDSL
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD14        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD75        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG01RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG01CL
     C                     EXFMTZGAMST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHAMST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHAMST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1AMST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Affect Sales Doll Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1ANST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * Affect Sales Doll Status
     C                     MOVEL#1ANST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHANST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHANST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHANST
     C                     ENDSL
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD14        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD77        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG02RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG02CL
     C                     EXFMTZGANST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHANST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHANST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1ANST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Affect Sales Pnds Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VAST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * Affect Sales Pnds Status
     C                     MOVEL#1VAST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVAST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHVAST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHVAST
     C                     ENDSL
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD14        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD79        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG03RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG03CL
     C                     EXFMTZGVAST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVAST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHVAST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VAST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * Validate Delete Request.
     C                     EXSR UCSUBR                     Validate Delete
      * Calculate next order sequence number.
     C                     EXSR UDSUBR                     Calculate next
      * Get defaults values from Company/Item.
     C                     EXSR UESUBR                     Get defaults va
      * Validate Warehouse.
     C                     EXSR UFSUBR                     Validate Wareho
      * Validate Item Type Code.
     C                     EXSR UJSUBR                     Validate Item T
      * Validate Contract Number.
     C                     EXSR UKSUBR                     Validate Contra
      * Validate Price Method.
     C                     EXSR ULSUBR                     Validate Price
      * Validate Weight (Pounds).
     C                     EXSR UPSUBR                     Validate Weight
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * *** errors found stop validations. ***
     C                     ELSE
      * CASE: *OTHERWISE
      * Continue Validations.
     C                     EXSR UTSUBR                     Continue Valida
     C                     END                             *FI
      * CASE: CTL.Claim Number is Claim Process
     C           #PC0C7    IFGT *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Customer TF Exempt Code is Exempt Customer
     C           YL0003    IFEQ 'EC'                       *IF
      * CASE: LCL.Item TF Exempt Code is Not Exempt
     C           YL0006    IFEQ 'NE'                       *IF
     C                     MOVEL'EC'      #1F4SX           Ord TF Exempt C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EP'      #1F4SX           Ord TF Exempt C
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Customer TF Exempt Code is Not Exempt
     C           YL0003    IFEQ 'NE'                       *IF
     C                     MOVEL'EP'      #1F4SX           Ord TF Exempt C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Item Code required
     C           #1HGCD    IFEQ *ZERO                      IF
     C           *IN77     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9832  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Price Overage Override required
     C           #1BZPR    IFEQ *ZERO                      IF
     C           *IN76     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9834  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Price Method Code required
     C           #1Q7CD    IFEQ *BLANK                     IF
     C           *IN76     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9836  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Warehouse Code required
     C           #1AJCD    IFEQ *BLANK                     IF
     C           *IN75     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9837  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Reason Code required
     C           #1CQCD    IFEQ *BLANK                     IF
     C           *IN76     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9839  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Affect Inventory Status required
     C           #1AMST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9840  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Affect Sales Doll Status required
     C           #1ANST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9841  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Affect Sales Pnds Status required
     C           #1VAST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9842  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      * Check reference to Company Item
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9832  *
     C                     END
      * Check reference to Warehouse Codes
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9837  *
     C                     END
      * Check reference to Customer Master
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Order Group
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Commodity Markets
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Market Date Method
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Price Method Header
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9836  *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Price Audit Reason Cd
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Calendar Master
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Item Structure Type
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Item Structure Group
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Item Structure Class
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Item Level Codes
     C                     EXSR VQCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VTCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to User Profile Control
     C                     EXSR VUCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Country Master
     C                     EXSR VVCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Event Types
     C                     EXSR VWCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to OP Reason Codes
     C                     EXSR VXCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9839  *
     C                     END
      * Check reference to Sales Route
     C                     EXSR VYCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Ham Group Master
     C                     EXSR VZCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record relations
      * CASE: RCD.*SFLSEL is *Comments
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * Edit Memo Comments.
     C                     EXSR NASUBR                     Edit Memo Comme
     C                     END                             *FI
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * Edt Ord Dtl Accr      EF - Order Detail Accrual  * 
     C                     CLEARPARC
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1C4NB    PAC4NB           Order Number
     C                     Z-ADD#1DPNB    PADPNB           Order Sequence
     C                     Z-ADD#1UENB    PAUENB           Order Secondary
      *
     C                     CALL 'PNL9EFR'              90  Edt Ord Dtl Acc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Deta
     C                     PARM #1HGCD    WQ0135  70       Item Code
     C                     PARM #1AJCD    WQ0136  3        Warehouse Code
     C                     PARM #1BKC7    WQ0137  70       Ship To Custome
     C                     PARM #2HNNA    WQ0138 20        Ship To City
     C                     PARM #2DBCD    WQ0139  2        Ship To State C
     C                     PARM YL0010    WQ0140  2        Shipping Method
     C                     PARM P7OBST    WQ0141  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNL9EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983237*
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'Y'       W0RSF
     C                     ELSE
     C                     MOVEL'N'       W0RSF
     C                     END
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     MOVEL*BLANK    #1SEL
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98
      *
     C           W0PMD     IFEQ 'ADD'
      * Process add request
     C                     EXSR DDNLRC
     C           W0NLR     IFNE 'Y'
     C                     EXSR ECADRQ
     C                     END
     C                     ELSE
      * Process change request
     C                     EXSR EECHRQ
     C                     END
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     ELSE
      * USER: Extra processing after DBF update
      * CASE: LCL.Header Status is Confirmed & Complete
     C           YL0002    IFEQ 'C'                        *IF
     C           YL0002    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Cancel Order Detail.
     C                     EXSR NBSUBR                     Cancel Order De
     C                     ELSE
      * CASE: *OTHERWISE
      * After update processing.
     C                     EXSR NCSUBR                     After update pr
     C                     END                             *FI
     C                     END                             *FI
      * Updates occurred set flags to "Yes".
     C                     EXSR NDSUBR                     Updates occurre
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * CRT PD Order Detail    CR - Order Detail  * 
     C                     EXSR SKCRRC
     C           W0RTN     IFNE *BLANK
      * Write error detected
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
     C                     ELSE
      * DBF write successful
      * disable entry
     C                     SETON                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG Order Detail SpcAffIF - Order Detail  * 
     C                     EXSR SMINFN
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFNE 'ADD'
     C                     MOVEL'ADD'     W0PMD
     C                     ELSE
     C                     MOVEL'CHG'     W0PMD
     C                     END
     C                     EXSR FBRQRL
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
     C                     MOVEL*IN87     *IN77
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL*IN87     *IN76
     C           P3QKST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL*IN87     *IN75
     C           YL0001    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           #PC0C7    IFGT *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     Z-ADD*ZERO     #1DPNB           Order Sequence
     C                     Z-ADD*ZERO     #1UENB           Order Secondary
     C                     Z-ADDP1BKC7    #1BKC7           Ship To Custome
     C                     Z-ADD*ZERO     #1CFC7           Order Group Cod
     C                     MOVEL*BLANK    #1GMST           Detail Line Sta
     C                     MOVEL*BLANK    #1GNST           Detail Line Sta
     C                     Z-ADD*ZERO     #1MAVA           Billing Detail
     C                     Z-ADD*ZERO     #1KDVA           Billing Detail
     C                     Z-ADD*ZERO     #1L8VA           Billing Detail
     C                     Z-ADD*ZERO     #1L9VA           Quantity to Sub
     C                     MOVEL*BLANK    #1GTST           Comment Print A
     C                     MOVEL*BLANK    #1GVST           Comment Print I
     C                     MOVEL*BLANK    #1GUST           Comment Print P
     C                     MOVEL*BLANK    #1QFST           Comment Print S
     C                     Z-ADD*ZERO     #1EXDT           Market Pricing
     C                     MOVEL*BLANK    #1LQCD           Commodity Marke
     C                     MOVEL*BLANK    #1RDCD           Date Method Cod
     C                     MOVEL*BLANK    #1U1ST           Price Status
     C                     Z-ADD*ZERO     #1GIDT           Pricing Date Us
     C                     MOVEL*BLANK    #1RZST           Work Confirm St
     C                     MOVEL*BLANK    #1R0ST           Work Over_Short
     C                     MOVEL*BLANK    #1R1ST           OD Production P
     C                     MOVEL*BLANK    #RS9ST           Item TF Exempt
     C                     MOVEL*BLANK    #1G8NA           Order Desc_Line
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     MOVEL*BLANK    #1VEST           Palletize
     C                     MOVEL*BLANK    #1VGST           Slip Sheet
     C                     MOVEL*BLANK    #1AVST           Catch Weight St
     C                     MOVEL*BLANK    #1U0ST           Price Audit
     C                     MOVEL*BLANK    #1RFCD           Price Audit Rea
     C                     MOVEL*BLANK    #1FZST           Production Date
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     Z-ADD*ZERO     #1D0WG           Weight Ordered
     C                     Z-ADD*ZERO     #1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     #1AUWG           Weight Schedule
     C                     Z-ADD*ZERO     #1CBQT           Quantity Shippe
     C                     Z-ADD*ZERO     #1ATWG           Weight Shipped
     C                     Z-ADD*ZERO     #1AQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     #1AGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     #1ALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     #1AUPR           Unit Price Orde
     C                     Z-ADD*ZERO     #1AVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     #1A4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     #1A5DT           Requested Ship
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     Z-ADD*ZERO     #1RGNB           Item Structure
     C                     Z-ADD*ZERO     #1RHNB           Item Structure
     C                     Z-ADD*ZERO     #1RINB           Item Structure
     C                     MOVEL*BLANK    #1RBCD           Item Level
     C                     MOVEL*BLANK    #1HICD           Quality Level
     C                     MOVEL*BLANK    #1RNCD           Pricing Product
     C                     MOVEL*BLANK    #1ROCD           Season Product
     C                     Z-ADD*ZERO     #1CXDT           Date of Origina
     C                     MOVEL*BLANK    #1AJVN           User Profile Na
     C                     MOVEL*BLANK    #1KXCD           Country Code
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1Z1ST           Modified Flag
     C                     MOVEL*BLANK    #1Z3ST           Substituted Fla
     C                     MOVEL*BLANK    #1Z4ST           OD Schedule Ove
     C                     Z-ADD*ZERO     #1DUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     #1B6VL           Invoice Extende
     C                     Z-ADD*ZERO     #1A1AA           Ham Group Numbe
     C                     MOVEL*BLANK    #1FZSX           OD Adj Type Ove
     C                     MOVEL*BLANK    #1F0SX           Affect Trade Fu
     C                     MOVEL*BLANK    #1F1SX           Affect Commissi
     C                     MOVEL*BLANK    #1F2SX           Affect Pricing
     C                     MOVEL*BLANK    #1F3SX           Released by Use
     C                     MOVEL*BLANK    #1F5SX           OD Pallet Type
     C                     MOVEL*BLANK    #1F6SX           Production Ware
     C                     MOVEL*BLANK    #1F7SX           OD Price Type
     C                     Z-ADD*ZERO     #1NTDT           Warehouse Palle
     C                     Z-ADD*ZERO     #1NUDT           Consumed Item C
     C                     Z-ADD*ZERO     #1NVDT           Deadline Depart
     C                     Z-ADD*ZERO     #1NWDT           OD Price Type R
     C                     Z-ADD*ZERO     #1NXDT           OD Firm Date
     C                     Z-ADD*ZERO     #1BUTM           Deadline Depart
     C                     Z-ADD*ZERO     #1BVTM           Price Code
     C                     Z-ADD*ZERO     #1BWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     #1BXTM           Substitution Li
     C                     Z-ADD*ZERO     #1BYTM           Max Qty to sche
     C                     Z-ADD*ZERO     #1H5NX           Warehouse Palle
     C                     Z-ADD*ZERO     #1H6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     #1H7NX           OD Item Target
     C                     Z-ADD*ZERO     #1H8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     #1H9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     #1DVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     #1DXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     #1DYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     #1DZPR           OD Original Ord
     C                     Z-ADD*ZERO     #1GSPR           OD Cancel Date
     C                     Z-ADD*ZERO     #1GTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     #1GUPR           OD Unused Prc 8
     C                     MOVEL*BLANK    #1HOST           OD MPR Sent to
     C                     MOVEL*BLANK    #1HPST           OD MPR Prc Read
     C                     MOVEL*BLANK    #1IOST           OD UnUsed Price
     C                     Z-ADD*ZERO     #1PEWG           Weight Amount E
     C                     Z-ADD*ZERO     #1RINY           Item Age Days
     C                     Z-ADD*ZERO     #1TIDT           Production Ovr
     C                     Z-ADD*ZERO     #1TJDT           Production Ovr
     C                     MOVEL*BLANK    #1H2ST           OD Spot Buy
     C                     MOVEL*BLANK    #1H0ST           OD Clm Full Ret
     C                     MOVEL*BLANK    #1H1ST           Order Line Erro
     C                     Z-ADD*ZERO     #1TKDT           OD Market Begin
     C                     Z-ADD*ZERO     #1TLDT           OD Market Endin
     C                     Z-ADD*ZERO     #1TMDT           OD Atch to Ord
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     Z-ADD*ZERO     #1AVQT           Quantity Ordere
     C                     MOVEL*BLANK    #1AGCD           U_M_Ordered
     C                     Z-ADD*ZERO     #1BZPR           Price Overage O
     C                     Z-ADD*ZERO     #RMHNB           USR Pounds
     C                     MOVEL*BLANK    #1Q7CD           Price Method Co
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #1L6NB           Contract Number
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1AMST           Affect Inventor
     C                     MOVEL*BLANK    #1ANST           Affect Sales Do
     C                     MOVEL*BLANK    #1VAST           Affect Sales Pn
     C                     MOVEL*BLANK    #1G7NA           Order Desc_Line
     C                     Z-ADD*ZERO     #1AKPR           Unit Price
     C                     MOVEL*BLANK    #1CRCD           U_M_Base Price
     C                     Z-ADD*ZERO     #1AYVA           Extended Amount
     C                     MOVEL*BLANK    #1F4SX           Ord TF Exempt C
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BGWKAE fields to subfile
      *================================================================
     C                     Z-ADDOMAIC3    #1AIC3           Company Number
     C                     Z-ADDOMC4NB    #1C4NB           Order Number
     C                     Z-ADDOMDPNB    #1DPNB           Order Sequence
     C                     Z-ADDOMUENB    #1UENB           Order Secondary
     C                     Z-ADDOMBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDOMCFC7    #1CFC7           Order Group Cod
     C                     MOVELOMGMST    #1GMST           Detail Line Sta
     C                     MOVELOMGNST    #1GNST           Detail Line Sta
     C                     Z-ADDOMMAVA    #1MAVA           Billing Detail
     C                     Z-ADDOMKDVA    #1KDVA           Billing Detail
     C                     Z-ADDOML8VA    #1L8VA           Billing Detail
     C                     Z-ADDOML9VA    #1L9VA           Quantity to Sub
     C                     MOVELOMGTST    #1GTST           Comment Print A
     C                     MOVELOMGVST    #1GVST           Comment Print I
     C                     MOVELOMGUST    #1GUST           Comment Print P
     C                     MOVELOMQFST    #1QFST           Comment Print S
     C                     Z-ADDOMEXDT    #1EXDT           Market Pricing
     C                     MOVELOMLQCD    #1LQCD           Commodity Marke
     C                     MOVELOMRDCD    #1RDCD           Date Method Cod
     C                     MOVELOMU1ST    #1U1ST           Price Status
     C                     Z-ADDOMGIDT    #1GIDT           Pricing Date Us
     C                     MOVELOMRZST    #1RZST           Work Confirm St
     C                     MOVELOMR0ST    #1R0ST           Work Over_Short
     C                     MOVELOMR1ST    #1R1ST           OD Production P
     C                     MOVELOMG8NA    #1G8NA           Order Desc_Line
     C                     MOVELOMRPCD    #1RPCD           Age Code
     C                     MOVELOMVEST    #1VEST           Palletize
     C                     MOVELOMVGST    #1VGST           Slip Sheet
     C                     MOVELOMAVST    #1AVST           Catch Weight St
     C                     MOVELOMU0ST    #1U0ST           Price Audit
     C                     MOVELOMRFCD    #1RFCD           Price Audit Rea
     C                     MOVELOMFZST    #1FZST           Production Date
     C                     Z-ADDOMR1NB    #1R1NB           Rated Freight
     C                     Z-ADDOMD0WG    #1D0WG           Weight Ordered
     C                     Z-ADDOMCCQT    #1CCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    #1AUWG           Weight Schedule
     C                     Z-ADDOMCBQT    #1CBQT           Quantity Shippe
     C                     Z-ADDOMATWG    #1ATWG           Weight Shipped
     C                     Z-ADDOMAQCS    #1AQCS           Unit Cost Prici
     C                     Z-ADDOMAGCS    #1AGCS           Unit Cost Per P
     C                     Z-ADDOMALPR    #1ALPR           Unit Price_Cred
     C                     Z-ADDOMAUPR    #1AUPR           Unit Price Orde
     C                     Z-ADDOMAVWG    #1AVWG           Unit Weight Ord
     C                     Z-ADDOMA4WG    #1A4WG           Tare Weight Tot
     C                     Z-ADDOMA5DT    #1A5DT           Requested Ship
     C                     Z-ADDOMAODT    #1AODT           Scheduled Ship
     C                     Z-ADDOMGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDOMRGNB    #1RGNB           Item Structure
     C                     Z-ADDOMRHNB    #1RHNB           Item Structure
     C                     Z-ADDOMRINB    #1RINB           Item Structure
     C                     MOVELOMRBCD    #1RBCD           Item Level
     C                     MOVELOMHICD    #1HICD           Quality Level
     C                     MOVELOMRNCD    #1RNCD           Pricing Product
     C                     MOVELOMROCD    #1ROCD           Season Product
     C                     Z-ADDOMCXDT    #1CXDT           Date of Origina
     C                     MOVELOMAJVN    #1AJVN           User Profile Na
     C                     MOVELOMKXCD    #1KXCD           Country Code
     C                     MOVELOMJPCD    #1JPCD           Event Code
     C                     MOVELOMR4CD    #1R4CD           Sales Route Cod
     C                     MOVELOMZ1ST    #1Z1ST           Modified Flag
     C                     MOVELOMZ3ST    #1Z3ST           Substituted Fla
     C                     MOVELOMZ4ST    #1Z4ST           OD Schedule Ove
     C                     Z-ADDOMDUPR    #1DUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    #1B6VL           Invoice Extende
     C                     Z-ADDOMA1AA    #1A1AA           Ham Group Numbe
     C                     MOVELOMFZSX    #1FZSX           OD Adj Type Ove
     C                     MOVELOMF0SX    #1F0SX           Affect Trade Fu
     C                     MOVELOMF1SX    #1F1SX           Affect Commissi
     C                     MOVELOMF2SX    #1F2SX           Affect Pricing
     C                     MOVELOMF3SX    #1F3SX           Released by Use
     C                     MOVELOMF5SX    #1F5SX           OD Pallet Type
     C                     MOVELOMF6SX    #1F6SX           Production Ware
     C                     MOVELOMF7SX    #1F7SX           OD Price Type
     C                     Z-ADDOMNTDT    #1NTDT           Warehouse Palle
     C                     Z-ADDOMNUDT    #1NUDT           Consumed Item C
     C                     Z-ADDOMNVDT    #1NVDT           Deadline Depart
     C                     Z-ADDOMNWDT    #1NWDT           OD Price Type R
     C                     Z-ADDOMNXDT    #1NXDT           OD Firm Date
     C                     Z-ADDOMBUTM    #1BUTM           Deadline Depart
     C                     Z-ADDOMBVTM    #1BVTM           Price Code
     C                     Z-ADDOMBWTM    #1BWTM           Maximum Net Wei
     C                     Z-ADDOMBXTM    #1BXTM           Substitution Li
     C                     Z-ADDOMBYTM    #1BYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    #1H5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    #1H6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    #1H7NX           OD Item Target
     C                     Z-ADDOMH8NX    #1H8NX           OD Estimated Gr
     C                     Z-ADDOMH9NX    #1H9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    #1DVPR           Order Gate_Fina
     C                     Z-ADDOMDWPR    #1DWPR           OD Ceiling Pric
     C                     Z-ADDOMDXPR    #1DXPR           OD Gate_Final P
     C                     Z-ADDOMDYPR    #1DYPR           OD Weighted Avg
     C                     Z-ADDOMDZPR    #1DZPR           OD Original Ord
     C                     Z-ADDOMGSPR    #1GSPR           OD Cancel Date
     C                     Z-ADDOMGTPR    #1GTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    #1GUPR           OD Unused Prc 8
     C                     MOVELOMHOST    #1HOST           OD MPR Sent to
     C                     MOVELOMHPST    #1HPST           OD MPR Prc Read
     C                     MOVELOMIOST    #1IOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    #1PEWG           Weight Amount E
     C                     Z-ADDOMRINY    #1RINY           Item Age Days
     C                     Z-ADDOMTIDT    #1TIDT           Production Ovr
     C                     Z-ADDOMTJDT    #1TJDT           Production Ovr
     C                     MOVELOMH2ST    #1H2ST           OD Spot Buy
     C                     MOVELOMH0ST    #1H0ST           OD Clm Full Ret
     C                     MOVELOMH1ST    #1H1ST           Order Line Erro
     C                     Z-ADDOMTKDT    #1TKDT           OD Market Begin
     C                     Z-ADDOMTLDT    #1TLDT           OD Market Endin
     C                     Z-ADDOMTMDT    #1TMDT           OD Atch to Ord
     C                     MOVELOMUVST    #1UVST           EDI Status 1
     C                     MOVELOMUWST    #1UWST           EDI Status 2
     C                     MOVELOMUXST    #1UXST           EDI Status 3
     C                     Z-ADDOMAATM    #1AATM           Job Time
     C                     MOVELOMAYNA    #1AYNA           User Id
     C                     MOVELOMA0NA    #1A0NA           Job Name
     C                     Z-ADDOMAXDT    #1AXDT           Job Date
     C                     Z-ADDOMHGCD    #1HGCD           Item Code
     C                     Z-ADDOMAVQT    #1AVQT           Quantity Ordere
     C                     MOVELOMAGCD    #1AGCD           U_M_Ordered
     C                     Z-ADDOMBZPR    #1BZPR           Price Overage O
     C                     MOVELOMQ7CD    #1Q7CD           Price Method Co
     C                     MOVELOMAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDOML6NB    #1L6NB           Contract Number
     C                     MOVELOMCQCD    #1CQCD           Reason Code
     C                     MOVELOMAMST    #1AMST           Affect Inventor
     C                     MOVELOMANST    #1ANST           Affect Sales Do
     C                     MOVELOMVAST    #1VAST           Affect Sales Pn
     C                     MOVELOMG7NA    #1G7NA           Order Desc_Line
     C                     Z-ADDOMAKPR    #1AKPR           Unit Price
     C                     MOVELOMCRCD    #1CRCD           U_M_Base Price
     C                     Z-ADDOMAYVA    #1AYVA           Extended Amount
     C                     MOVELOMF4SX    #1F4SX           Ord TF Exempt C
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #2XIST           Credit Hold
     C                     MOVEL*BLANK    #2XJST           Production Hold
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     MOVELP1JNCD    #2JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #2U2ST           Export Status
     C                     MOVEL*BLANK    #2HNNA           Ship To City
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
     C                     Z-ADD*ZERO     #2AFTM           Requested Deliv
     C                     MOVEL*BLANK    #2GJST           Order in Use
     C                     Z-ADD*ZERO     #2DPNB           Order Sequence
     C                     Z-ADD*ZERO     #2UENB           Order Secondary
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CAGTX           USR Company Nam
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADDP1BKC7    #PBKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    VPBKC7
     C                     MOVELP1BRTX    #PBRTX           Ship To Name
     C                     Z-ADDP1A0DT    #PA0DT           Order Date
      * Clear external version also
     C                     Z-ADD*ZERO     VPA0DT
     C                     Z-ADDP1JZVA    #PJZVA           Order Value Tot
     C                     Z-ADDP1A1WG    #PA1WG           Order Weight To
     C                     Z-ADDP1C0C7    #PC0C7           Claim Number
      * Clear external version also
     C                     MOVEL*BLANK    VPC0C7
     C                     MOVEL*BLANK    #CQ2CD           Shipping Method
     C                     MOVEL*BLANK    #CDGU1           ACR Shipping Me
     C                     MOVEL*BLANK    #CHET1           TF Exempt Code
      * Check restriction within
     C                     EXSR WACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  #PA0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPA0DT
      * Convert Claim Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PC0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PC0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPC0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPC0C7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NASUBR    BEGSR
      *================================================================
      * Edit Memo Comments.
      *================================================================
      * EDT Detail Comments    EF - OP Order Detail Comment  * 
     C                     CALL 'PDDWEFR'              90  EDT Detail Comm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0128  30       Company Number
     C                     PARM #1C4NB    WQ0129  70       Order Number
     C                     PARM #1DPNB    WQ0130  30       Order Sequence
     C                     PARM #1UENB    WQ0131  30       Order Secondary
     C                     PARM #1HGCD    WQ0132  70       Item Code
     C                     PARM #PBRTX    WQ0133 30        Ship To Name
     C                     PARM #1A5DT    WQ0134  70       Requested Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDWEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBSUBR    BEGSR
      *================================================================
      * Cancel Order Detail.
      *================================================================
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#1GMST    #1GNST           Detail Line Sta
     C                     MOVEL'X'       #1GMST           Detail Line Sta
      * CHG Detail Status      CH - Order Detail  * 
     C                     EXSR SICHRC
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCSUBR    BEGSR
      *================================================================
      * After update processing.
      *================================================================
      * CLC Price Item         XF - Price Method Header  * 
     C                     CALL 'PDG9XFR'              90  CLC Price Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0142  30       Company Number
     C                     PARM #1Q7CD    WQ0143  3        Price Method Co
     C                     PARM #1BKC7    WQ0144  70       Ship To Custome
     C                     PARM #1GNDT    WQ0145  70       Actual Shipped
     C                     PARM #1AGCD    WQ0146  2        U_M_Ordered
     C                     PARM #1AVQT    WQ0147 112       Quantity Ordere
     C                     PARM #PA0DT    WQ0148  70       Requested Ship
     C           #1AKPR    PARM #1AKPR    WQ0149 114       Unit Price
     C           #1AUPR    PARM #1AUPR    WQ0150 114       Unit Price Orde
     C                     PARM #1HGCD    WQ0151  70       Item Code
     C                     PARM #1CXDT    WQ0152  70       Date of Orig. E
     C                     PARM #1LQCD    WQ0153  3        Commodity Marke
     C                     PARM #1EXDT    WQ0154  70       Market Pricing
     C           #1U1ST    PARM #1U1ST    WQ0155  1        Price Status
     C                     PARM #1RDCD    WQ0156  3        Date Method Cod
     C                     PARM #1BZPR    WQ0157 114       Price Overage O
     C           #1GIDT    PARM #1GIDT    WQ0158  70       Pricing Date Us
     C                     PARM '02'      WQ0159  2        Event Called Fr
     C                     PARM #1DWPR    WQ0160 114       OD Ceiling Pric
     C                     PARM #1TKDT    WQ0161  70       OD Market Begin
     C                     PARM #1TLDT    WQ0162  70       OD Market Endin
     C                     PARM #1C4NB    WQ0163  70       Order Number
     C                     PARM #2EIDT    WQ0164  70       Requested Deliv
     C                     PARM #1DPNB    WQ0165  30       Order Sequence
     C                     PARM *ZERO     WQ0166  30       Order Secondary
     C           WUWZST    PARM WUWZST    WQ0167  5        Error Return
     C                     PARM 'S'       WQ0168  1        Price Type Stat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983633*
     C                     SETON                     3234  *
     C                     END
      * CASE: WRK.Error Return is All Entered Values
     C           WUWZST    IFEQ 'CFR'                      *IF
     C           WUWZST    OREQ 'CID'
     C           WUWZST    OREQ 'CIF'
     C           WUWZST    OREQ 'CIO'
     C           WUWZST    OREQ 'QPE'
     C           WUWZST    OREQ 'EXT'
     C           WUWZST    OREQ 'XPE'
     C           WUWZST    OREQ 'FPE'
     C           WUWZST    OREQ 'IOM'
     C           WUWZST    OREQ 'IOV'
     C           WUWZST    OREQ 'MPE'
     C           WUWZST    OREQ 'KPE'
     C           WUWZST    OREQ 'MKT'
     C           WUWZST    OREQ 'MSC'
     C           WUWZST    OREQ 'OVR'
     C           WUWZST    OREQ 'STR'
     C           WUWZST    OREQ 'SUB'
     C           WUWZST    OREQ 'TRC'
     C           WUWZST    OREQ 'WPA'
     C           WUWZST    OREQ 'RWB'
     C           WUWZST    OREQ 'ITERR'
     C           WUWZST    OREQ 'CRD'
     C           WUWZST    OREQ 'MSL'
     C           WUWZST    OREQ 'GAT'
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0021
     C                     MOVEL#1RDCD    ZA0022           Date Method Cod
     C                     MOVEL#1Q7CD    ZA0023           Price Method Co
     C                     MOVEL#1LQCD    ZA0024           Commodity Marke
     C                     MOVELWUWZST    ZA0025           Error Return
      * Send message 'Error in Pricing Routine'
     C                     MOVEL'USR1850' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Set status to available if entered
      * CASE: RCD.Detail Line Status is Entered
     C           #1GMST    IFEQ 'E'                        *IF
     C                     MOVEL#1GMST    #1GNST           Detail Line Sta
     C                     MOVEL'A'       #1GMST           Detail Line Sta
      * CHG Detail Status      CH - Order Detail  * 
     C                     EXSR SJCHRC
     C                     END                             *FI
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDSUBR    BEGSR
      *================================================================
      * Updates occurred set flags to "Yes".
      *================================================================
     C                     MOVEL'Y'       P2WVST           Access Denied (
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NESUBR    BEGSR
      *================================================================
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt fun
      *================================================================
      * Rtv Tare Weight        XF - Company Item  * 
     C                     CALL 'PBI3XFR'              90  Rtv Tare Weight
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0172  30       Company Number
     C                     PARM OMHGCD    WQ0173  70       Item Code
     C           YL0011    PARM YL0011    WQ0174  52       Misc Tare Weigh
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * wi464
      * RTV Itm BxID & Tares  XF - Item Bill Of Material  * 
     C                     CALL 'PBI4XFR'              90  RTV Itm BxID &
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0175  30       Company Number
     C                     PARM OMHGCD    WQ0176  70       Item Code
     C           YL0012    PARM *ZERO     WQ0177  52       Box Weight
     C           YL0013    PARM *ZERO     WQ0178  50       Number Cases On
     C           YL0014    PARM *ZERO     WQ0179  52       Pallet Tare Wei
     C           YL0015    PARM *ZERO     WQ0180  70       Box iD
     C                     PARM OMF5SX    WQ0181  2        OD Pallet Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           YL0012    ADD  YL0011    YL0016           Total Tare USR
      * Box + Misc Tare
      * LCL.Weight 1.1             .U =
      *    *COMPUTE ((x1 + x2) * x3)
      * x1    : LCL.Box Weight
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Misc Tare Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Quantity Ordered
     C           YL0012    ADD  YL0011    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT OMAVQT    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0017           Weight 1.1
      * Pallet Tare
      * CASE: DB1.Palletize is yes
     C           OMVEST    IFEQ 'Y'                        *IF
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C           YL0013    IFGT 0                          *IF
      * Pallet Weight
      * LCL.Weight 1.2             .U =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Number Cases On A Pallet
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Pallet Tare Weight
     C           OMAVQT    DIV  YL0013    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT YL0014    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0018           Weight 1.2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0018           Weight 1.2
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0018           Weight 1.2
     C                     END                             *FI
      * Estimated Gross
      * DB1.OD Minimum Unit Weight =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : DB1.Weight Ordered
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Weight 1.1             .U
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.Weight 1.2             .U
     C           OMD0WG    ADD  YL0017    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0018    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    OMH8NX           OD Estimated Gr
      * E00196 RMC 8/24/12 chk pfs interface SHPTRN too
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFSUBR    BEGSR
      *================================================================
      * Verify If Change and Update the Affect Flags in Sales History
      *================================================================
      * CASE: LCL.Upd/Del Sts USR is Update
     C           YL0027    IFEQ 'U'                        *IF
      * CASE: LCL.Affect Inventory Sts Usr NE PR1.Affect Inventory Status
     C           YL0024    IFNE #1AMST                     *IF
      * Update the sales history or
     C                     ELSE
      * CASE: LCL.Affect Sales Doll Sts Usr NE PR1.Affect Sales Doll Stat
     C           YL0025    IFNE #1ANST                     *IF
      * Update the sales history or
     C                     ELSE
      * CASE: LCL.Affect Sales Pnds Sts Usr NE PR1.Affect Sales Pnds Stat
     C           YL0026    IFNE #1VAST                     *IF
      * Update the sales history or
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO NFEXIT                     *QUIT
      * no update to the sales history
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chg Affect Flags      RT - Sales History  * 
     C                     EXSR SPRVGN
     C                     MOVEL*BLANK    W0RTN            *Return code
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * WI642   JM-02/19/25 USDA FAS 98 and FAS99
      * - Create load order change log when adding new item lines.
      * - Changes are inside 'CRT PD Order Detail    CR'.
      * 7/11/06 slm - Allow Completed Credit/Debit Memo to be displayed
      *               and only allow the ISS fields to be maintenance on
      *               screen.
      * E3387 JJH 09/14/14 - Display Shipping Method.
      * E4057 JJH 06/05/15 - Add option 9=Edit Deducitons/Additions
      *   NOTE:  This was previously a hidden option
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHSUBR    BEGSR
      *================================================================
      * Change to ADD mode if no records exists.
      *================================================================
      * RTV Last Seq 1 Nbr     RT - PD Order Detail  * 
     C                     EXSR STRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     END                             *FI
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NISUBR    BEGSR
      *================================================================
      * Initialize flags and get company defaults.
      *================================================================
     C                     MOVEL'Y'       P3TMST           USR First Time
     C                     MOVEL'N'       P2WVST           Access Denied (
      * RTV Cr/Dr Prc Meth     RT - Company Defaults  * 
     C                     EXSR SURVGN
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CAGTX           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #CAGTX           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Order Header CR/DR RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3           Company Number
     C                     Z-ADD#2C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #2JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     P1A5DT           Requested Ship
     C                     MOVEL*BLANK    P1GTST           Comment Print A
     C                     MOVEL*BLANK    P1GVST           Comment Print I
     C                     MOVEL*BLANK    P1GUST           Comment Print P
     C                     MOVEL*BLANK    P1QFST           Comment Print S
     C                     MOVEL*BLANK    YL0002           Header Status
     C                     Z-ADD*ZERO     #PJZVA           Order Value Tot
     C                     Z-ADD*ZERO     #PA1WG           Order Weight To
     C                     MOVEL*BLANK    #CQ2CD           Shipping Method
     C                     MOVEL*BLANK    P1VEST           Palletize
     C                     MOVEL*BLANK    P1VGST           Slip Sheet
     C                     MOVEL*BLANK    P1RPCD           Age Code
     C                     MOVEL*BLANK    P7OBST           Billing Activit
     C                     MOVEL*BLANK    P1FSSX           Broker Order St
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEJNCD    #2JNCD           Order Type_Sale
     C                     Z-ADDBEA5DT    P1A5DT           Requested Ship
     C                     MOVELBEGTST    P1GTST           Comment Print A
     C                     MOVELBEGVST    P1GVST           Comment Print I
     C                     MOVELBEGUST    P1GUST           Comment Print P
     C                     MOVELBEQFST    P1QFST           Comment Print S
     C                     MOVELBEGWST    YL0002           Header Status
     C                     Z-ADDBEJZVA    #PJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #PA1WG           Order Weight To
     C                     MOVELBEQ2CD    #CQ2CD           Shipping Method
     C                     MOVELBEVEST    P1VEST           Palletize
     C                     MOVELBEVGST    P1VGST           Slip Sheet
     C                     MOVELBERPCD    P1RPCD           Age Code
     C                     MOVELBEOBST    P7OBST           Billing Activit
     C                     MOVELBEFSSX    P1FSSX           Broker Order St
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Vry TFExmp - Customer - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#PBKC7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Customer TF Exe
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNEP3SX    YL0003           Customer TF Exe
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Affect Inv/Sls     RT - OP Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           EXJNCD           Order Type_Sale
      * Setup key
     C                     MOVEL#2JNCD    EXJNCD           Order Type_Sale
      * Establish starting position
     C           KRSSD     CHAIN@EXRETY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1063' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1AMST           Affect Inventor
     C                     MOVEL*BLANK    #1ANST           Affect Sales Do
     C                     MOVEL*BLANK    #1VAST           Affect Sales Pn
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEXOEST    #1AMST           Affect Inventor
     C                     MOVELEXOFST    #1ANST           Affect Sales Do
     C                     MOVELEXVBST    #1VAST           Affect Sales Pn
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg TF Exempt         CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0002  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Order in Use
     C                     MOVEL*BLANK    WN0034  1        Header Status
     C                     MOVEL*BLANK    WN0035  1        Header Status L
     C                     MOVEL*BLANK    WN0036  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     Z-ADD*ZERO     WN0040 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0041 112       Order Weight To
     C                     MOVEL*BLANK    WN0042  1        Credit Hold
     C                     MOVEL*BLANK    WN0043  1        Production Hold
     C                     MOVEL*BLANK    WN0044  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0045  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0046  40       Requested Deliv
     C                     MOVEL*BLANK    WN0047  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0048 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0049  70       Load ID
     C                     Z-ADD*ZERO     WN0050  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0051 112       Rated Freight
     C                     MOVEL*BLANK    WN0052  1        LTL Flag
     C                     MOVEL*BLANK    WN0053  1        Price Audit
     C                     MOVEL*BLANK    WN0054  1        Price Status
     C                     MOVEL*BLANK    WN0055  2        Shipping Method
     C                     MOVEL*BLANK    WN0056  1        Export Status
     C                     MOVEL*BLANK    WN0057  1        Palletize
     C                     MOVEL*BLANK    WN0058  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0059  1        Slip Sheet
     C                     MOVEL*BLANK    WN0060  1        Age Code
     C                     Z-ADD*ZERO     WN0061  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0062  1        Load Type
     C                     Z-ADD*ZERO     WN0063  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0064  1        Load Plan Order
     C                     MOVEL*BLANK    WN0065  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0066  70       Resell Referenc
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068 30        Special Comment
     C                     MOVEL*BLANK    WN0069  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0070  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0071  2        Manager Level C
     C                     MOVEL*BLANK    WN0072  3        VP Level Code
     C                     Z-ADD*ZERO     WN0073  70       Attach to Order
     C                     MOVEL*BLANK    WN0074  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0075  70       Invoice Number
     C                     MOVEL*BLANK    WN0076  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0077  70       Invoice Date
     C                     MOVEL*BLANK    WN0078  2        Event Code
     C                     MOVEL*BLANK    WN0079  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0080  1        Modified Flag
     C                     Z-ADD*ZERO     WN0081 112       A_R order Value
     C                     MOVEL*BLANK    WN0082  1        Billing Activit
     C                     MOVEL*BLANK    WN0083  1        Block Order Fla
     C                     MOVEL*BLANK    WN0084  1        Order Certifica
     C                     Z-ADD*ZERO     WN0085 112       Invoice Order V
     C                     MOVEL*BLANK    WN0086  1        Process Sts for
     C                     MOVEL*BLANK    WN0087  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0088  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0089  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0090  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0091  1        Email Cust On O
     C                     MOVEL*BLANK    WN0092  1        Order Emailed
     C                     MOVEL*BLANK    WN0093  1        Export Docs Go
     C                     MOVEL*BLANK    WN0094  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0095  1        Broker Order St
     C                     MOVEL*BLANK    WN0096  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0097  2        Order Requires
     C                     MOVEL*BLANK    WN0098  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0099  2        Export USDA App
     C                     MOVEL*BLANK    WN0100  3        HPB Ship to War
     C                     Z-ADD*ZERO     WN0101  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0102  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0103  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0104  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0105  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0106  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0107  60       Time of Origina
     C                     Z-ADD*ZERO     WN0108  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0109  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0110  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0111 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0112 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0113 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0114 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0115 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0116  70       Claim Number
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#2AIC3    WAAIC3           Company Number
     C                     Z-ADD#2C4NB    WAC4NB           Order Number
      *
     C           KLCHSE    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C           KLCHSE    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELYL0004    WAFYSX    P      OH TF Exempt Co
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * VAL Warehouse          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Val. Contract #    RT - OPP Item Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CIL6NB    WQSG01           Contract Number
     C           *LIKE     DEFN CIAIC3    WQSG02           Company Number
     C           *LIKE     DEFN CIBKC7    WQSG03           Ship To Custome
     C           *LIKE     DEFN CIHGCD    WQSG04           Item Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Contract Number
     C                     KFLD           WQSG02           Company Number
     C                     KFLD           WQSG03           Ship To Custome
     C                     KFLD           WQSG04           Item Code
      * Setup key
     C                     Z-ADD#1L6NB    WQSG01           Contract Number
     C                     Z-ADDP1AIC3    WQSG02           Company Number
     C                     Z-ADDP1BKC7    WQSG03           Ship To Custome
     C                     Z-ADD#1HGCD    WQSG04           Item Code
      * Establish starting position
     C           KRSSG     SETLL@CIREWO                    *
     C           KRSSG     READE@CIREWO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0463' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDCIAUDT    P4AUDT           Effective Date
     C                     Z-ADDCICWDT    P4CWDT           End Date Effect
     C                     Z-ADDCIDQQT    P4DQQT           Maximum Quantit
     C                     Z-ADDCIHFQT    P4HFQT           Quantity Sold
     C           KRSSG     READE@CIREWO                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Price Meth Type    RT - PD Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    IHAIC3           Company Number
     C                     MOVEL#1Q7CD    IHQ7CD           Price Method Co
      * Establish starting position
     C           KRSSH     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P6V8ST           Price Method Ty
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIHV8ST    P6V8ST           Price Method Ty
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * CHG Detail Status      CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0124  70       Item Code
     C                     MOVEL*BLANK    WN0125  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0126  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0127  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0128 112       Billing Detail
     C                     Z-ADD*ZERO     WN0129 112       Billing Detail
     C                     Z-ADD*ZERO     WN0130 112       Billing Detail
     C                     Z-ADD*ZERO     WN0131 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0132  1        Comment Print A
     C                     MOVEL*BLANK    WN0133  1        Comment Print I
     C                     MOVEL*BLANK    WN0134  1        Comment Print P
     C                     MOVEL*BLANK    WN0135  1        Comment Print S
     C                     Z-ADD*ZERO     WN0136 112       Extended Amount
     C                     Z-ADD*ZERO     WN0137  70       Market Pricing
     C                     MOVEL*BLANK    WN0138  3        Commodity Marke
     C                     MOVEL*BLANK    WN0139  3        Date Method Cod
     C                     MOVEL*BLANK    WN0140  3        Price Method Co
     C                     Z-ADD*ZERO     WN0141 114       Price Overage O
     C                     Z-ADD*ZERO     WN0142  70       Contract Number
     C                     MOVEL*BLANK    WN0143  1        Price Status
     C                     Z-ADD*ZERO     WN0144  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0145  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0146  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0147  1        Work Confirm St
     C                     MOVEL*BLANK    WN0148  1        Work Over_Short
     C                     MOVEL*BLANK    WN0149  1        OD Production P
     C                     MOVEL*BLANK    WN0150 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0151 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0152  1        Age Code
     C                     MOVEL*BLANK    WN0153  1        Palletize
     C                     MOVEL*BLANK    WN0154  1        Slip Sheet
     C                     MOVEL*BLANK    WN0155  1        Catch Weight St
     C                     MOVEL*BLANK    WN0156  1        Price Audit
     C                     MOVEL*BLANK    WN0157  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0158  1        Production Date
     C                     Z-ADD*ZERO     WN0159 112       Rated Freight
     C                     Z-ADD*ZERO     WN0160 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0161 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0162 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0163 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0164 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0165 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0166 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0167 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0168 114       Unit Price
     C                     Z-ADD*ZERO     WN0169 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0170 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0171 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0172 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0173  70       Requested Ship
     C                     Z-ADD*ZERO     WN0174  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0175  70       Actual Shipped
     C                     MOVEL*BLANK    WN0176  1        Affect Inventor
     C                     MOVEL*BLANK    WN0177  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0178  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0179  30       Item Structure
     C                     Z-ADD*ZERO     WN0180  30       Item Structure
     C                     Z-ADD*ZERO     WN0181  30       Item Structure
     C                     MOVEL*BLANK    WN0182  2        Item Level
     C                     MOVEL*BLANK    WN0183  2        Quality Level
     C                     MOVEL*BLANK    WN0184  2        Pricing Product
     C                     MOVEL*BLANK    WN0185  2        Season Product
     C                     Z-ADD*ZERO     WN0186  70       Date of Origina
     C                     MOVEL*BLANK    WN0187 10        User Profile Na
     C                     MOVEL*BLANK    WN0188  6        Country Code
     C                     MOVEL*BLANK    WN0189  2        Event Code
     C                     MOVEL*BLANK    WN0190  3        Reason Code
     C                     MOVEL*BLANK    WN0191  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0192  1        Modified Flag
     C                     MOVEL*BLANK    WN0193  1        Substituted Fla
     C                     MOVEL*BLANK    WN0194  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0195 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0196 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0197  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0198  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0199  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0200  1        Affect Commissi
     C                     MOVEL*BLANK    WN0201  1        Affect Pricing
     C                     MOVEL*BLANK    WN0202  1        Released by Use
     C                     MOVEL*BLANK    WN0203  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0204  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0205  3        Production Ware
     C                     MOVEL*BLANK    WN0206  3        OD Price Type
     C                     Z-ADD*ZERO     WN0207  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0208  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0209  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0210  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0211  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0212  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0213  60       Price Code
     C                     Z-ADD*ZERO     WN0214  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0215  60       Substitution Li
     C                     Z-ADD*ZERO     WN0216  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0217 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0218 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0219 112       OD Item Target
     C                     Z-ADD*ZERO     WN0220 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0221 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0222 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0223 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0224 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0225 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0226 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0227 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0228 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0229 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0230  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0231  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0232  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0233 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0234  40       Item Age Days
     C                     Z-ADD*ZERO     WN0235  70       Production Ovr
     C                     Z-ADD*ZERO     WN0236  70       Production Ovr
     C                     MOVEL*BLANK    WN0237  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0238  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0239  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0240  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0241  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0242  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0243  1        EDI Status 1
     C                     MOVEL*BLANK    WN0244  1        EDI Status 2
     C                     MOVEL*BLANK    WN0245  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0246  60       Job Time
     C                     MOVEL*BLANK    WN0247 10        User Id
     C                     MOVEL*BLANK    WN0248 10        Job Name
     C                     Z-ADD*ZERO     WN0249  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#1AIC3    OMAIC3           Company Number
     C                     Z-ADD#1C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#1UENB    OMUENB           Order Secondary
      *
     C           KLCHSI    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHSI    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#1GMST    OMGMST    P      Detail Line Sta
     C                     MOVEL#1GNST    OMGNST    P      Detail Line Sta
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##PGM     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * CHG Detail Status      CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0250  70       Item Code
     C                     MOVEL*BLANK    WN0251  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0252  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0253  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0254 112       Billing Detail
     C                     Z-ADD*ZERO     WN0255 112       Billing Detail
     C                     Z-ADD*ZERO     WN0256 112       Billing Detail
     C                     Z-ADD*ZERO     WN0257 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0258  1        Comment Print A
     C                     MOVEL*BLANK    WN0259  1        Comment Print I
     C                     MOVEL*BLANK    WN0260  1        Comment Print P
     C                     MOVEL*BLANK    WN0261  1        Comment Print S
     C                     Z-ADD*ZERO     WN0262 112       Extended Amount
     C                     Z-ADD*ZERO     WN0263  70       Market Pricing
     C                     MOVEL*BLANK    WN0264  3        Commodity Marke
     C                     MOVEL*BLANK    WN0265  3        Date Method Cod
     C                     MOVEL*BLANK    WN0266  3        Price Method Co
     C                     Z-ADD*ZERO     WN0267 114       Price Overage O
     C                     Z-ADD*ZERO     WN0268  70       Contract Number
     C                     MOVEL*BLANK    WN0269  1        Price Status
     C                     Z-ADD*ZERO     WN0270  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0271  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0272  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0273  1        Work Confirm St
     C                     MOVEL*BLANK    WN0274  1        Work Over_Short
     C                     MOVEL*BLANK    WN0275  1        OD Production P
     C                     MOVEL*BLANK    WN0276 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0277 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0278  1        Age Code
     C                     MOVEL*BLANK    WN0279  1        Palletize
     C                     MOVEL*BLANK    WN0280  1        Slip Sheet
     C                     MOVEL*BLANK    WN0281  1        Catch Weight St
     C                     MOVEL*BLANK    WN0282  1        Price Audit
     C                     MOVEL*BLANK    WN0283  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0284  1        Production Date
     C                     Z-ADD*ZERO     WN0285 112       Rated Freight
     C                     Z-ADD*ZERO     WN0286 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0287 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0288 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0289 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0290 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0291 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0292 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0293 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0294 114       Unit Price
     C                     Z-ADD*ZERO     WN0295 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0296 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0297 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0298 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0299  70       Requested Ship
     C                     Z-ADD*ZERO     WN0300  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0301  70       Actual Shipped
     C                     MOVEL*BLANK    WN0302  1        Affect Inventor
     C                     MOVEL*BLANK    WN0303  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0304  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0305  30       Item Structure
     C                     Z-ADD*ZERO     WN0306  30       Item Structure
     C                     Z-ADD*ZERO     WN0307  30       Item Structure
     C                     MOVEL*BLANK    WN0308  2        Item Level
     C                     MOVEL*BLANK    WN0309  2        Quality Level
     C                     MOVEL*BLANK    WN0310  2        Pricing Product
     C                     MOVEL*BLANK    WN0311  2        Season Product
     C                     Z-ADD*ZERO     WN0312  70       Date of Origina
     C                     MOVEL*BLANK    WN0313 10        User Profile Na
     C                     MOVEL*BLANK    WN0314  6        Country Code
     C                     MOVEL*BLANK    WN0315  2        Event Code
     C                     MOVEL*BLANK    WN0316  3        Reason Code
     C                     MOVEL*BLANK    WN0317  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0318  1        Modified Flag
     C                     MOVEL*BLANK    WN0319  1        Substituted Fla
     C                     MOVEL*BLANK    WN0320  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0321 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0322 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0323  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0324  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0325  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0326  1        Affect Commissi
     C                     MOVEL*BLANK    WN0327  1        Affect Pricing
     C                     MOVEL*BLANK    WN0328  1        Released by Use
     C                     MOVEL*BLANK    WN0329  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0330  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0331  3        Production Ware
     C                     MOVEL*BLANK    WN0332  3        OD Price Type
     C                     Z-ADD*ZERO     WN0333  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0334  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0335  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0336  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0337  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0338  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0339  60       Price Code
     C                     Z-ADD*ZERO     WN0340  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0341  60       Substitution Li
     C                     Z-ADD*ZERO     WN0342  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0343 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0344 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0345 112       OD Item Target
     C                     Z-ADD*ZERO     WN0346 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0347 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0348 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0349 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0350 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0351 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0352 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0353 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0354 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0355 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0356  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0357  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0358  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0359 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0360  40       Item Age Days
     C                     Z-ADD*ZERO     WN0361  70       Production Ovr
     C                     Z-ADD*ZERO     WN0362  70       Production Ovr
     C                     MOVEL*BLANK    WN0363  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0364  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0365  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0366  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0367  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0368  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0369  1        EDI Status 1
     C                     MOVEL*BLANK    WN0370  1        EDI Status 2
     C                     MOVEL*BLANK    WN0371  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0372  60       Job Time
     C                     MOVEL*BLANK    WN0373 10        User Id
     C                     MOVEL*BLANK    WN0374 10        Job Name
     C                     Z-ADD*ZERO     WN0375  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#1AIC3    OMAIC3           Company Number
     C                     Z-ADD#1C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#1UENB    OMUENB           Order Secondary
      *
     C           KLCHSJ    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHSJ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#1GMST    OMGMST    P      Detail Line Sta
     C                     MOVEL#1GNST    OMGNST    P      Detail Line Sta
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##PGM     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT PD Order Detail    CR - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0376  60       Job Time
     C                     MOVEL*BLANK    WN0377 10        User Id
     C                     MOVEL*BLANK    WN0378 10        Job Name
     C                     Z-ADD*ZERO     WN0379  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BGWKL0
     C                     Z-ADD#2AIC3    OMAIC3           Company Number
     C                     Z-ADD#2C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#1UENB    OMUENB           Order Secondary
     C                     Z-ADD#1HGCD    OMHGCD           Item Code
     C                     MOVEL#1AJCD    OMAJCD           Warehouse Code
     C                     Z-ADDP1BKC7    OMBKC7           Ship To Custome
     C                     Z-ADD#1CFC7    OMCFC7           Order Group Cod
     C                     MOVEL'A'       OMGMST           Detail Line Sta
     C                     MOVEL*BLANK    OMGNST           Detail Line Sta
     C                     Z-ADD#1MAVA    OMMAVA           Billing Detail
     C                     Z-ADD#1KDVA    OMKDVA           Billing Detail
     C                     Z-ADD#1L8VA    OML8VA           Billing Detail
     C                     Z-ADD#1L9VA    OML9VA           Quantity to Sub
     C                     MOVELP1GTST    OMGTST           Comment Print A
     C                     MOVELP1GVST    OMGVST           Comment Print I
     C                     MOVELP1GUST    OMGUST           Comment Print P
     C                     MOVELP1QFST    OMQFST           Comment Print S
     C                     Z-ADD#1AYVA    OMAYVA           Extended Amount
     C                     Z-ADD#1EXDT    OMEXDT           Market Pricing
     C                     MOVEL#1LQCD    OMLQCD           Commodity Marke
     C                     MOVEL#1RDCD    OMRDCD           Date Method Cod
     C                     MOVEL#1Q7CD    OMQ7CD           Price Method Co
     C                     Z-ADD#1BZPR    OMBZPR           Price Overage O
     C                     Z-ADD#1L6NB    OML6NB           Contract Number
     C                     MOVEL#1U1ST    OMU1ST           Price Status
     C                     Z-ADD#1GIDT    OMGIDT           Pricing Date Us
     C                     MOVEL#1CRCD    OMCRCD           U_M_Base Price
     C                     MOVEL#1AGCD    OMAGCD           U_M_Ordered
     C                     MOVEL#1RZST    OMRZST           Work Confirm St
     C                     MOVEL#1R0ST    OMR0ST           Work Over_Short
     C                     MOVEL#1R1ST    OMR1ST           OD Production P
     C                     MOVEL#1G7NA    OMG7NA           Order Desc_Line
     C                     MOVEL#1G8NA    OMG8NA           Order Desc_Line
     C                     MOVELP1RPCD    OMRPCD           Age Code
     C                     MOVELP1VEST    OMVEST           Palletize
     C                     MOVELP1VGST    OMVGST           Slip Sheet
     C                     MOVEL#1AVST    OMAVST           Catch Weight St
     C                     MOVEL*BLANK    OMU0ST           Price Audit
     C                     MOVEL*BLANK    OMRFCD           Price Audit Rea
     C                     MOVEL#1FZST    OMFZST           Production Date
     C                     Z-ADD#1R1NB    OMR1NB           Rated Freight
     C                     Z-ADD#1AVQT    OMAVQT           Quantity Ordere
     C                     Z-ADD#RMHNB    OMD0WG           Weight Ordered
     C                     Z-ADD#1CCQT    OMCCQT           Quantity Schedu
     C                     Z-ADD#1AUWG    OMAUWG           Weight Schedule
     C                     Z-ADD#1AVQT    OMCBQT           Quantity Shippe
     C                     Z-ADD#RMHNB    OMATWG           Weight Shipped
     C                     Z-ADD#1AQCS    OMAQCS           Unit Cost Prici
     C                     Z-ADD#1AGCS    OMAGCS           Unit Cost Per P
     C                     Z-ADD#1AKPR    OMAKPR           Unit Price
     C                     Z-ADD#1ALPR    OMALPR           Unit Price_Cred
     C                     Z-ADD#1AUPR    OMAUPR           Unit Price Orde
     C                     Z-ADD#1AVWG    OMAVWG           Unit Weight Ord
     C                     Z-ADD#1A4WG    OMA4WG           Tare Weight Tot
     C                     Z-ADD#1A5DT    OMA5DT           Requested Ship
     C                     Z-ADD#1AODT    OMAODT           Scheduled Ship
     C                     Z-ADD#1GNDT    OMGNDT           Actual Shipped
     C                     MOVEL#1AMST    OMAMST           Affect Inventor
     C                     MOVEL#1ANST    OMANST           Affect Sales Do
     C                     MOVEL#1VAST    OMVAST           Affect Sales Pn
     C                     Z-ADD#1RGNB    OMRGNB           Item Structure
     C                     Z-ADD#1RHNB    OMRHNB           Item Structure
     C                     Z-ADD#1RINB    OMRINB           Item Structure
     C                     MOVEL#1RBCD    OMRBCD           Item Level
     C                     MOVEL#1HICD    OMHICD           Quality Level
     C                     MOVEL#1RNCD    OMRNCD           Pricing Product
     C                     MOVEL#1ROCD    OMROCD           Season Product
     C                     Z-ADD##JDT     OMCXDT           Date of Origina
     C                     MOVEL##USR     OMAJVN           User Profile Na
     C                     MOVEL#1KXCD    OMKXCD           Country Code
     C                     MOVEL'01'      OMJPCD           Event Code
     C                     MOVEL#1CQCD    OMCQCD           Reason Code
     C                     MOVEL#1R4CD    OMR4CD           Sales Route Cod
     C                     MOVEL#1Z1ST    OMZ1ST           Modified Flag
     C                     MOVEL#1Z3ST    OMZ3ST           Substituted Fla
     C                     MOVEL#1Z4ST    OMZ4ST           OD Schedule Ove
     C                     Z-ADD#1DUPR    OMDUPR           Invoice Unit Pr
     C                     Z-ADD#1B6VL    OMB6VL           Invoice Extende
     C                     Z-ADD#1A1AA    OMA1AA           Ham Group Numbe
     C                     MOVEL#1FZSX    OMFZSX           OD Adj Type Ove
     C                     MOVEL'N'       OMF0SX           Affect Trade Fu
     C                     MOVELYL0005    OMF1SX           Affect Commissi
     C                     MOVEL'N'       OMF2SX           Affect Pricing
     C                     MOVEL#1F3SX    OMF3SX           Released by Use
     C                     MOVEL#1F4SX    OMF4SX           Ord TF Exempt C
     C                     MOVEL#1F5SX    OMF5SX           OD Pallet Type
     C                     MOVEL#1F6SX    OMF6SX           Production Ware
     C                     MOVEL#1F7SX    OMF7SX           OD Price Type
     C                     Z-ADD#1NTDT    OMNTDT           Warehouse Palle
     C                     Z-ADD#1NUDT    OMNUDT           Consumed Item C
     C                     Z-ADD#1NVDT    OMNVDT           Deadline Depart
     C                     Z-ADD#1NWDT    OMNWDT           OD Price Type R
     C                     Z-ADD#1NXDT    OMNXDT           OD Firm Date
     C                     Z-ADD#1BUTM    OMBUTM           Deadline Depart
     C                     Z-ADD#1BVTM    OMBVTM           Price Code
     C                     Z-ADD#1BWTM    OMBWTM           Maximum Net Wei
     C                     Z-ADD#1BXTM    OMBXTM           Substitution Li
     C                     Z-ADD#1BYTM    OMBYTM           Max Qty to sche
     C                     Z-ADD#1H5NX    OMH5NX           Warehouse Palle
     C                     Z-ADD#1H6NX    OMH6NX           Warehouse Avg P
     C                     Z-ADD#1H7NX    OMH7NX           OD Item Target
     C                     Z-ADD#1H8NX    OMH8NX           OD Estimated Gr
     C                     Z-ADD#1H9NX    OMH9NX           OD Maximum Unit
     C                     Z-ADD#1DVPR    OMDVPR           Order Gate_Fina
     C                     Z-ADD#1DWPR    OMDWPR           OD Ceiling Pric
     C                     Z-ADD#1DXPR    OMDXPR           OD Gate_Final P
     C                     Z-ADD#1DYPR    OMDYPR           OD Weighted Avg
     C                     Z-ADD#1DZPR    OMDZPR           OD Original Ord
     C                     Z-ADD#1GSPR    OMGSPR           OD Cancel Date
     C                     Z-ADD#1GTPR    OMGTPR           OD Unused Prc 7
     C                     Z-ADD#1GUPR    OMGUPR           OD Unused Prc 8
     C                     MOVEL#1HOST    OMHOST           OD MPR Sent to
     C                     MOVEL#1HPST    OMHPST           OD MPR Prc Read
     C                     MOVEL#1IOST    OMIOST           OD UnUsed Price
     C                     Z-ADD#1PEWG    OMPEWG           Weight Amount E
     C                     Z-ADD#1RINY    OMRINY           Item Age Days
     C                     Z-ADD#1TIDT    OMTIDT           Production Ovr
     C                     Z-ADD#1TJDT    OMTJDT           Production Ovr
     C                     MOVEL#1H2ST    OMH2ST           OD Spot Buy
     C                     MOVEL#1H0ST    OMH0ST           OD Clm Full Ret
     C                     MOVEL#1H1ST    OMH1ST           Order Line Erro
     C                     Z-ADD#1TKDT    OMTKDT           OD Market Begin
     C                     Z-ADD#1TLDT    OMTLDT           OD Market Endin
     C                     Z-ADD#1TMDT    OMTMDT           OD Atch to Ord
     C                     MOVEL#1UVST    OMUVST           EDI Status 1
     C                     MOVEL#1UWST    OMUWST           EDI Status 2
     C                     MOVEL#1UXST    OMUXST           EDI Status 3
      *
      * USER: Processing before Data update
     C                     MOVEL*BLANK    OMRPCD           Age Code
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##PGM     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                     CALL 'POP1XFR'              90  Rtv First Consu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0169  30       Company Number
     C                     PARM OMHGCD    WQ0170  70       Item Code
     C           OMNUDT    PARM *ZERO     WQ0171  70       Component Item
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SLRVGN
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt func
     C                     EXSR NESUBR                     Calc Gross Weig
     C           KLCRSK    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Check for duplicate primary key
     C           KLCRSK    SETLL@BGWKL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1310' W0RTN   7
      * Send message 'Order Detail           EX'
     C                     MOVEL'USR1310' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@BGWKL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * WI642   JM-02/19/25-Crt chg log if dtl has been sent to MPR USDA
      * CASE: DB1.OD MPR Prc Ready to Send is yes
     C           OMHPST    IFEQ 'Y'                        *IF
      * Always create price type log ORDPRT
     C                     MOVELOMDPNB    YL0019           Text 3 Length U
     C                     Z-ADD1         ZQ      50
     C           YL0019    CAT  ' ':ZQ    YL0020    P      Change Log Prio
     C                     MOVEL*BLANK    YL0021           Change Log New
     C                     MOVEL#1F7SX    YL0021           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0182  70       Load ID
     C                     PARM 'ORDPRT'  WQ0183  6        Load Change Typ
     C                     PARM 'SLS'     WQ0184  3        Department Cont
     C                     PARM YL0020    WQ0185 12        Change Log Prio
     C                     PARM YL0021    WQ0186 12        Change Log New
     C                     PARM OMAIC3    WQ0187  30       Company Number
     C                     PARM OMC4NB    WQ0188  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * WI642   JM-02/19/25-If not the transfer order nbr 9999999->crt ch
      * CASE: DB1.Order Number is ne 9999999
     C           OMC4NB    IFNE 9999999                    *IF
     C                     MOVELOMDPNB    YL0019           Text 3 Length U
     C                     Z-ADD*ZERO     YL0022           Weight Beg Inv
     C                     MOVELYL0022    YL0023           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0019    CAT  YL0023:ZQ YL0020    P      Change Log Prio
     C                     Z-ADD#RMHNB    YL0022           Weight Beg Inv
     C                     MOVEL*BLANK    YL0021           Change Log New
     C                     MOVELYL0022    YL0021           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0189  70       Load ID
     C                     PARM 'ORDWGT'  WQ0190  6        Load Change Typ
     C                     PARM 'SLS'     WQ0191  3        Department Cont
     C                     PARM YL0020    WQ0192 12        Change Log Prio
     C                     PARM YL0021    WQ0193 12        Change Log New
     C                     PARM OMAIC3    WQ0194  30       Company Number
     C                     PARM OMC4NB    WQ0195  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD*ZERO     YL0022           Weight Beg Inv
     C                     MOVELYL0022    YL0023           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0019    CAT  YL0023:ZQ YL0020    P      Change Log Prio
     C                     Z-ADD#1AVQT    YL0022           Weight Beg Inv
     C                     MOVEL*BLANK    YL0021           Change Log New
     C                     MOVELYL0022    YL0021           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0196  70       Load ID
     C                     PARM 'ORDQTY'  WQ0197  6        Load Change Typ
     C                     PARM 'SLS'     WQ0198  3        Department Cont
     C                     PARM YL0020    WQ0199 12        Change Log Prio
     C                     PARM YL0021    WQ0200 12        Change Log New
     C                     PARM OMAIC3    WQ0201  30       Company Number
     C                     PARM OMC4NB    WQ0202  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    OMF6SX           Production Ware
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAOCD    OMF6SX           Production Ware
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMINFN    BEGSR
      *================================================================
      * CHG Order Detail SpcAffIF - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0380  60       Job Time
     C                     MOVEL*BLANK    WN0381 10        User Id
     C                     MOVEL*BLANK    WN0382 10        Job Name
     C                     Z-ADD*ZERO     WN0383  70       Job Date
      *
      * CHG Order Detail SpcAffIF
      * Update the Order Detail, bring back the before pic of the
      *         affect flags.
      * CHG Order Detail SpcAffCH - Order Detail  * 
     C                     EXSR SNCHRC
      * CASE: PR3.Header Status is Confirmed & Complete
     C           YL0002    IFEQ 'C'                        *IF
     C           YL0002    OREQ 'R'
      * Order Detail was Update now let see if the Affect flags were
      * changed.  If so then go to the Sales History and update
      * the Affect Flags in the Sales History.
      * Verify If Change and Update the Affect Flags in Sales History
     C                     EXSR NFSUBR                     Verify If Chang
     C                     END                             *FI
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * CHG Order Detail SpcAffCH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0384  60       Job Time
     C                     MOVEL*BLANK    WN0385 10        User Id
     C                     MOVEL*BLANK    WN0386 10        Job Name
     C                     Z-ADD*ZERO     WN0387  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL*BLANK    YL0024           Affect Inventor
     C                     MOVEL*BLANK    YL0025           Affect Sales Do
     C                     MOVEL*BLANK    YL0026           Affect Sales Pn
     C                     MOVELWUOTTX    YL0027           Upd/Del Sts USR
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#1AIC3    OMAIC3           Company Number
     C                     Z-ADD#1C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#1UENB    OMUENB           Order Secondary
      *
     C           KLCHSN    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHSN    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YDRDCS
      * USER: Processing after Data read
     C                     MOVELOMAMST    YL0024           Affect Inventor
     C                     MOVELOMANST    YL0025           Affect Sales Do
     C                     MOVELOMVAST    YL0026           Affect Sales Pn
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#1HGCD    OMHGCD           Item Code
     C                     MOVEL#1AJCD    OMAJCD    P      Warehouse Code
     C                     Z-ADD#1BKC7    OMBKC7           Ship To Custome
     C                     Z-ADD#1CFC7    OMCFC7           Order Group Cod
     C                     MOVEL#1GMST    OMGMST    P      Detail Line Sta
     C                     MOVEL#1GNST    OMGNST    P      Detail Line Sta
     C                     Z-ADD#1MAVA    OMMAVA           Billing Detail
     C                     Z-ADD#1KDVA    OMKDVA           Billing Detail
     C                     Z-ADD#1L8VA    OML8VA           Billing Detail
     C                     Z-ADD#1L9VA    OML9VA           Quantity to Sub
     C                     MOVEL#1GTST    OMGTST    P      Comment Print A
     C                     MOVEL#1GVST    OMGVST    P      Comment Print I
     C                     MOVEL#1GUST    OMGUST    P      Comment Print P
     C                     MOVEL#1QFST    OMQFST    P      Comment Print S
     C                     Z-ADD#1AYVA    OMAYVA           Extended Amount
     C                     Z-ADD#1EXDT    OMEXDT           Market Pricing
     C                     MOVEL#1LQCD    OMLQCD    P      Commodity Marke
     C                     MOVEL#1RDCD    OMRDCD    P      Date Method Cod
     C                     MOVEL#1Q7CD    OMQ7CD    P      Price Method Co
     C                     Z-ADD#1BZPR    OMBZPR           Price Overage O
     C                     Z-ADD#1L6NB    OML6NB           Contract Number
     C                     MOVEL#1U1ST    OMU1ST    P      Price Status
     C                     Z-ADD#1GIDT    OMGIDT           Pricing Date Us
     C                     MOVEL#1CRCD    OMCRCD    P      U_M_Base Price
     C                     MOVEL#1AGCD    OMAGCD    P      U_M_Ordered
     C                     MOVEL#1RZST    OMRZST    P      Work Confirm St
     C                     MOVEL#1R0ST    OMR0ST    P      Work Over_Short
     C                     MOVEL#1R1ST    OMR1ST    P      OD Production P
     C                     MOVEL#1G7NA    OMG7NA    P      Order Desc_Line
     C                     MOVEL#1G8NA    OMG8NA    P      Order Desc_Line
     C                     MOVEL#1RPCD    OMRPCD    P      Age Code
     C                     MOVEL#1VEST    OMVEST    P      Palletize
     C                     MOVEL#1VGST    OMVGST    P      Slip Sheet
     C                     MOVEL#1AVST    OMAVST    P      Catch Weight St
     C                     MOVEL#1U0ST    OMU0ST    P      Price Audit
     C                     MOVEL#1RFCD    OMRFCD    P      Price Audit Rea
     C                     MOVEL#1FZST    OMFZST    P      Production Date
     C                     Z-ADD#1R1NB    OMR1NB           Rated Freight
     C                     Z-ADD#1AVQT    OMAVQT           Quantity Ordere
     C                     Z-ADD#RMHNB    OMD0WG           Weight Ordered
     C                     Z-ADD#1CCQT    OMCCQT           Quantity Schedu
     C                     Z-ADD#1AUWG    OMAUWG           Weight Schedule
     C                     Z-ADD#1AVQT    OMCBQT           Quantity Shippe
     C                     Z-ADD#RMHNB    OMATWG           Weight Shipped
     C                     Z-ADD#1AQCS    OMAQCS           Unit Cost Prici
     C                     Z-ADD#1AGCS    OMAGCS           Unit Cost Per P
     C                     Z-ADD#1AKPR    OMAKPR           Unit Price
     C                     Z-ADD#1ALPR    OMALPR           Unit Price_Cred
     C                     Z-ADD#1AUPR    OMAUPR           Unit Price Orde
     C                     Z-ADD#1AVWG    OMAVWG           Unit Weight Ord
     C                     Z-ADD#1A4WG    OMA4WG           Tare Weight Tot
     C                     Z-ADD#1A5DT    OMA5DT           Requested Ship
     C                     Z-ADD#1AODT    OMAODT           Scheduled Ship
     C                     Z-ADD#1GNDT    OMGNDT           Actual Shipped
     C                     MOVEL#1AMST    OMAMST    P      Affect Inventor
     C                     MOVEL#1ANST    OMANST    P      Affect Sales Do
     C                     MOVEL#1VAST    OMVAST    P      Affect Sales Pn
     C                     Z-ADD#1RGNB    OMRGNB           Item Structure
     C                     Z-ADD#1RHNB    OMRHNB           Item Structure
     C                     Z-ADD#1RINB    OMRINB           Item Structure
     C                     MOVEL#1RBCD    OMRBCD    P      Item Level
     C                     MOVEL#1HICD    OMHICD    P      Quality Level
     C                     MOVEL#1RNCD    OMRNCD    P      Pricing Product
     C                     MOVEL#1ROCD    OMROCD    P      Season Product
     C                     Z-ADD#1CXDT    OMCXDT           Date of Origina
     C                     MOVEL#1AJVN    OMAJVN    P      User Profile Na
     C                     MOVEL#1KXCD    OMKXCD    P      Country Code
     C                     MOVEL#1JPCD    OMJPCD    P      Event Code
     C                     MOVEL#1CQCD    OMCQCD    P      Reason Code
     C                     MOVEL#1R4CD    OMR4CD    P      Sales Route Cod
     C                     MOVEL#1Z1ST    OMZ1ST    P      Modified Flag
     C                     MOVEL#1Z3ST    OMZ3ST    P      Substituted Fla
     C                     MOVEL#1Z4ST    OMZ4ST    P      OD Schedule Ove
     C                     Z-ADD#1DUPR    OMDUPR           Invoice Unit Pr
     C                     Z-ADD#1B6VL    OMB6VL           Invoice Extende
     C                     Z-ADD#1A1AA    OMA1AA           Ham Group Numbe
     C                     MOVEL#1FZSX    OMFZSX    P      OD Adj Type Ove
     C                     MOVEL#1F0SX    OMF0SX    P      Affect Trade Fu
     C                     MOVEL#1F1SX    OMF1SX    P      Affect Commissi
     C                     MOVEL#1F2SX    OMF2SX    P      Affect Pricing
     C                     MOVEL#1F3SX    OMF3SX    P      Released by Use
     C                     MOVEL#1F4SX    OMF4SX    P      Ord TF Exempt C
     C                     MOVEL#1F5SX    OMF5SX    P      OD Pallet Type
     C                     MOVEL#1F6SX    OMF6SX    P      Production Ware
     C                     MOVEL#1F7SX    OMF7SX    P      OD Price Type
     C                     Z-ADD#1NTDT    OMNTDT           Warehouse Palle
     C                     Z-ADD#1NUDT    OMNUDT           Consumed Item C
     C                     Z-ADD#1NVDT    OMNVDT           Deadline Depart
     C                     Z-ADD#1NWDT    OMNWDT           OD Price Type R
     C                     Z-ADD#1NXDT    OMNXDT           OD Firm Date
     C                     Z-ADD#1BUTM    OMBUTM           Deadline Depart
     C                     Z-ADD#1BVTM    OMBVTM           Price Code
     C                     Z-ADD#1BWTM    OMBWTM           Maximum Net Wei
     C                     Z-ADD#1BXTM    OMBXTM           Substitution Li
     C                     Z-ADD#1BYTM    OMBYTM           Max Qty to sche
     C                     Z-ADD#1H5NX    OMH5NX           Warehouse Palle
     C                     Z-ADD#1H6NX    OMH6NX           Warehouse Avg P
     C                     Z-ADD#1H7NX    OMH7NX           OD Item Target
     C                     Z-ADD#1H8NX    OMH8NX           OD Estimated Gr
     C                     Z-ADD#1H9NX    OMH9NX           OD Maximum Unit
     C                     Z-ADD#1DVPR    OMDVPR           Order Gate_Fina
     C                     Z-ADD#1DWPR    OMDWPR           OD Ceiling Pric
     C                     Z-ADD#1DXPR    OMDXPR           OD Gate_Final P
     C                     Z-ADD#1DYPR    OMDYPR           OD Weighted Avg
     C                     Z-ADD#1DZPR    OMDZPR           OD Original Ord
     C                     Z-ADD#1GSPR    OMGSPR           OD Cancel Date
     C                     Z-ADD#1GTPR    OMGTPR           OD Unused Prc 7
     C                     Z-ADD#1GUPR    OMGUPR           OD Unused Prc 8
     C                     MOVEL#1HOST    OMHOST    P      OD MPR Sent to
     C                     MOVEL#1HPST    OMHPST    P      OD MPR Prc Read
     C                     MOVEL#1IOST    OMIOST    P      OD UnUsed Price
     C                     Z-ADD#1PEWG    OMPEWG           Weight Amount E
     C                     Z-ADD#1RINY    OMRINY           Item Age Days
     C                     Z-ADD#1TIDT    OMTIDT           Production Ovr
     C                     Z-ADD#1TJDT    OMTJDT           Production Ovr
     C                     MOVEL#1H2ST    OMH2ST    P      OD Spot Buy
     C                     MOVEL#1H0ST    OMH0ST    P      OD Clm Full Ret
     C                     MOVEL#1H1ST    OMH1ST    P      Order Line Erro
     C                     Z-ADD#1TKDT    OMTKDT           OD Market Begin
     C                     Z-ADD#1TLDT    OMTLDT           OD Market Endin
     C                     Z-ADD#1TMDT    OMTMDT           OD Atch to Ord
     C                     MOVEL#1UVST    OMUVST    P      EDI Status 1
     C                     MOVEL#1UWST    OMUWST    P      EDI Status 2
     C                     MOVEL#1UXST    OMUXST    P      EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##PGM     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
     C                     EXSR SORVGN
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
     C                     MOVEL'U'       YL0027           Upd/Del Sts USR
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDOMAIC3    BZAIC3           Company Number
     C                     Z-ADDOMHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSO     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZRINB    OMRINB           Item Structure
     C                     Z-ADDBZRHNB    OMRHNB           Item Structure
     C                     Z-ADDBZRGNB    OMRGNB           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Chg Affect Flags      RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           F4AIC3           Company Number
     C                     KFLD           F4C4NB           Order Number
     C                     KFLD           F4DPNB           Order Sequence
     C                     KFLD           F4UENB           Order Secondary
      * Setup key
     C                     Z-ADD#1AIC3    F4AIC3           Company Number
     C                     Z-ADD#1C4NB    F4C4NB           Order Number
     C                     Z-ADD#1DPNB    F4DPNB           Order Sequence
     C                     Z-ADD#1UENB    F4UENB           Order Secondary
      * Establish starting position
     C           KRSSP     CHAIN@FHSTD3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1241' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT                     *QUIT
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Affect Flags       CH - Sales History  * 
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG Affect Flags       CH - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0388 20        A_R City
     C                     MOVEL*BLANK    WN0389  2        A_R State
     C                     MOVEL*BLANK    WN0390  6        A_R County Code
     C                     MOVEL*BLANK    WN0391 11        A_R Zip_Postal
     C                     MOVEL*BLANK    WN0392 25        Alpha Search
     C                     MOVEL*BLANK    WN0393  6        Country Code
     C                     MOVEL*BLANK    WN0394  2        Type Code
     C                     Z-ADD*ZERO     WN0395  70       Parent Customer
     C                     Z-ADD*ZERO     WN0396  70       AR Customer Num
     C                     MOVEL*BLANK    WN0397 30        AR Customer Nam
     C                     Z-ADD*ZERO     WN0398  70       Ship To Custome
     C                     MOVEL*BLANK    WN0399 30        Ship To Name
     C                     MOVEL*BLANK    WN0400 20        Ship To City
     C                     MOVEL*BLANK    WN0401  2        Ship To State C
     C                     MOVEL*BLANK    WN0402 11        Ship To Zip_Pos
     C                     MOVEL*BLANK    WN0403 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0404  70       Order Date
     C                     Z-ADD*ZERO     WN0405  70       Cancel Date
     C                     MOVEL*BLANK    WN0406  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0407  3        Original Salesp
     C                     MOVEL*BLANK    WN0408  2        Manager Level C
     C                     MOVEL*BLANK    WN0409  3        VP Level Code
     C                     MOVEL*BLANK    WN0410  2        Terms Code
     C                     Z-ADD*ZERO     WN0411  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0412  3        Carrier Code
     C                     MOVEL*BLANK    WN0413  3        Order Header Re
     C                     MOVEL*BLANK    WN0414  2        Order Type_Sale
     C                     MOVEL*BLANK    WN0415  2        Shipping Method
     C                     MOVEL*BLANK    WN0416  1        Export Status
     C                     Z-ADD*ZERO     WN0417  70       Attach to Invoi
     C                     Z-ADD*ZERO     WN0418  70       Attach to Order
     C                     Z-ADD*ZERO     WN0419  70       Resell Referenc
     C                     Z-ADD*ZERO     WN0420  70       Original Item
     C                     MOVEL*BLANK    WN0421  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0422 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0423 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0424 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0425 112       Weight Schedule
     C                     MOVEL*BLANK    WN0426  2        U_M_Ordered
     C                     Z-ADD*ZERO     WN0427 114       Unit Price
     C                     Z-ADD*ZERO     WN0428 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0429  2        U_M_Base Price
     C                     Z-ADD*ZERO     WN0430  70       Requested Ship
     C                     Z-ADD*ZERO     WN0431  70       Invoice Date
     C                     Z-ADD*ZERO     WN0432  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0433 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0434 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0435 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0436 112       Extended Amount
     C                     Z-ADD*ZERO     WN0437  70       Contract Number
     C                     MOVEL*BLANK    WN0438  6        Export Country
     C                     Z-ADD*ZERO     WN0439  70       LD Arrival Date
     C                     Z-ADD*ZERO     WN0440  40       Accounting Year
     C                     Z-ADD*ZERO     WN0441  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0442  30       OM Week
     C                     Z-ADD*ZERO     WN0443 112       Quantity Billed
     C                     Z-ADD*ZERO     WN0444 112       Weight Billed
     C                     Z-ADD*ZERO     WN0445  70       Shipped Item Co
     C                     Z-ADD*ZERO     WN0446 112       Billing Detail
     C                     Z-ADD*ZERO     WN0447 112       Billing Detail
     C                     Z-ADD*ZERO     WN0448 112       FOB Gross Amoun
     C                     Z-ADD*ZERO     WN0449 112       Standard Overag
     C                     Z-ADD*ZERO     WN0450 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0451  80       GL Document Num
     C                     MOVEL*BLANK    WN0452  1        GL Update Statu
     C                     Z-ADD*ZERO     WN0453  30       Shipping Compan
     C                     MOVEL*BLANK    WN0454  3        Order Detail Re
     C                     Z-ADD*ZERO     WN0455 114       Price Overage O
     C                     MOVEL*BLANK    WN0456  3        Date Method Cod
     C                     MOVEL*BLANK    WN0457  3        Price Method Co
     C                     Z-ADD*ZERO     WN0458  70       Market Pricing
     C                     MOVEL*BLANK    WN0459  3        Commodity Marke
     C                     MOVEL*BLANK    WN0460  2        Quality Level
     C                     MOVEL*BLANK    WN0461  2        Item Level
     C                     Z-ADD*ZERO     WN0462  30       Item Structure
     C                     Z-ADD*ZERO     WN0463  30       Item Structure
     C                     Z-ADD*ZERO     WN0464  30       Item Structure
     C                     Z-ADD*ZERO     WN0465 112       Rated Freight
     C                     Z-ADD*ZERO     WN0466  70       Invoice Number
     C                     MOVEL*BLANK    WN0467  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0468  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0469  70       Load ID
     C                     Z-ADD*ZERO     WN0470  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0471  3        Packaging Code
     C                     MOVEL*BLANK    WN0472  3        Item Market Cod
     C                     Z-ADD*ZERO     WN0473  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0474  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0475  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0476 30        Order Desc_Line
     C                     Z-ADD*ZERO     WN0477 112       Actual Freight
     C                     MOVEL*BLANK    WN0478  3        Item Type Code
     C                     Z-ADD*ZERO     WN0479  30       PM Raw Material
     C                     Z-ADD*ZERO     WN0480  50       PM Line Number
     C                     MOVEL*BLANK    WN0481  3        SH Unused_was b
     C                     Z-ADD*ZERO     WN0482  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0483  1        Modified Flag
     C                     Z-ADD*ZERO     WN0484 112       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0485 112       Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WN0486 112       Commission Amou
     C                     Z-ADD*ZERO     WN0487 112       Financials Amou
     C                     Z-ADD*ZERO     WN0488 112       Financials Amou
     C                     MOVEL*BLANK    WN0489  1        Group for Packa
     C                     MOVEL*BLANK    WN0490  2        Base_Conv_Loss
     C                     MOVEL*BLANK    WN0491  1        Variety_Rendere
     C                     MOVEL*BLANK    WN0492  3        Customer Group
     C                     MOVEL*BLANK    WN0493  3        Customer Group
     C                     Z-ADD*ZERO     WN0494  70       Order Group Cod
     C                     MOVEL*BLANK    WN0495  4        Shipping Zone C
     C                     MOVEL*BLANK    WN0496  1        Process Sts for
     C                     Z-ADD*ZERO     WN0497 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0498 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0499  30       Req Shipping Te
     C                     Z-ADD*ZERO     WN0500  30       Actual Shipping
     C                     MOVEL*BLANK    WN0501  1        Age Code
     C                     Z-ADD*ZERO     WN0502  70       Req Delivery Da
     C                     Z-ADD*ZERO     WN0503  60       Req Delivery Ti
     C                     Z-ADD*ZERO     WN0504  70       MPC Number
     C                     MOVEL*BLANK    WN0505  3        Shipping Line
     C                     MOVEL*BLANK    WN0506 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0507 25        Port City
     C                     MOVEL*BLANK    WN0508 30        Vessel Name
     C                     MOVEL*BLANK    WN0509 12        Booking Number
     C                     Z-ADD*ZERO     WN0510 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0511  70       Claim Number
     C                     Z-ADD*ZERO     WN0512  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0513  1        Palletize
     C                     Z-ADD*ZERO     WN0514 114       Commodity Marke
     C                     Z-ADD*ZERO     WN0515 114       Market Value
     C                     Z-ADD*ZERO     WN0516 114       Default Cmdty M
     C                     Z-ADD*ZERO     WN0517 114       Raw Material Co
     C                     MOVEL*BLANK    WN0518  1        Sales Expense P
     C                     Z-ADD*ZERO     WN0519 112       Sales Expense T
     C                     MOVEL*BLANK    WN0520  1        Data Mart Proce
     C                     MOVEL*BLANK    WN0521  1        LH Load Type
     C                     MOVEL*BLANK    WN0522  2        Order TF Exempt
     C                     Z-ADD*ZERO     WN0523  70       LD Sail Date
     C                     Z-ADD*ZERO     WN0524 114       NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WN0525 112       HST Item Target
     C                     MOVEL*BLANK    WN0526  1        EDI Status 1
     C                     MOVEL*BLANK    WN0527  1        EDI Status 2
     C                     MOVEL*BLANK    WN0528  1        EDI Status 3
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FHSTD2
     C                     Z-ADDF4AIC3    WCAIC3           Company Number
     C                     Z-ADDF4C4NB    WCC4NB           Order Number
     C                     Z-ADDF4DPNB    WCDPNB           Order Sequence
     C                     Z-ADDF4UENB    WCUENB           Order Secondary
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C           KLCHSQ    CHAIN@FHSTD2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHSTPL0'MDACP
     C                     MOVEL'@FHSTD2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHS1    YERDCS
      * USER: Processing after Data read
     C                     MOVEL'N'       WCISSX           Data Mart Proce
     C                     MOVEL'N'       WCGASX           Process Sts for
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Move non-key fields to @FHSTD2
     C                     MOVEL#1AMST    WCAMST    P      Affect Inventor
     C                     MOVEL#1ANST    WCANST    P      Affect Sales Do
     C                     MOVEL#1VAST    WCVAST    P      Affect Sales Pn
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA    P      User Id
     C                     MOVEL##JOB     WCA0NA    P      Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FHSTD2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHSTPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSR01           Application Cod
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSR01           Application Cod
     C                     MOVEL'OMS'     WQSR01           Application Cod
      * Establish starting position
     C           KRSSR     SETLL@DNRESF                    *
     C           KRSSR     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C           KRSSR     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSS01           Application Cod
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSS01           Application Cod
      * Establish starting position
     C           KRSSS     SETLL@DNRESF                    *
     C           KRSSS     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSS     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Last Seq 1 Nbr     RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQST01           Company Number
     C           *LIKE     DEFN WDC4NB    WQST02           Order Number
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQST01           Company Number
     C                     Z-ADDP1C4NB    WQST02           Order Number
     C                     Z-ADDWUDPNB    WDDPNB           Order Sequence
     C                     Z-ADDWUUENB    WDUENB           Order Secondary
      * Establish starting position
     C           KPSST     SETLL@BGWKL1                    *
     C           KRSST     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO STEXIT                     *QUIT
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDDPNB    WUDPNB           Order Sequence
     C                     Z-ADDWDUENB    WUUENB           Order Secondary
     C           KRSST     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Cr/Dr Prc Meth     RT - Company Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           AQAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    AQAIC3           Company Number
      * Establish starting position
     C           KRSSU     CHAIN@AQREB9              90    *
      * Data record not found
     C   90                MOVEL'USR0041' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAQTOCD    P9TOCD           Price Method De
     C                     MOVELAQTPCD    P9TPCD           Price Method De
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Perform first time processing.
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SARVGN
      * E3387 JJH 09/12/14 - Display Shipping Method
      * RTV Order Header CR/DR RT - Order Header TRG  * 
     C                     EXSR SBRVGN
     C                     MOVEL'N'       P3TMST           USR First Time
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * If claim memo, then make screen fields output onlu.
      *================================================================
      * CASE: CTL.Claim Number is Zero
     C           #PC0C7    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       P3QKST           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3QKST           Display Flag
      * Add mode is not valid if claim memo.
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'CHG'     W0PMD            *Program mode
      * Send message 'Memo/Claim Can't Add'
     C                     MOVEL'USR2894' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Validate Delete Request.
      *================================================================
      * 7/12/2006 Slm Delete not allowed added logic
      * CASE: RCD.Detail Line Status is Confirmed & Complete
     C           #1GMST    IFEQ 'C'                        *IF
     C           #1GMST    OREQ 'R'
      * CASE: RCD.*SFLSEL is *Delete
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0001           *SFLSEL
      * Send message 'Memo/Claim Can't Delete'
     C                     MOVEL'USR2893' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9831  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.*SFLSEL is *Delete
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * CASE: CTL.Claim Number is Zero
     C           #PC0C7    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0002           *SFLSEL
      * Send message 'Memo/Claim Can't Delete'
     C                     MOVEL'USR2893' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9831  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Calculate next order sequence number.
      *================================================================
      * CASE: RCD.Order Sequence Number is Equal to zero
     C           #1DPNB    IFEQ *ZERO                      *IF
     C           WUDPNB    ADD  1         #1DPNB           Order Sequence
     C                     Z-ADD#1DPNB    WUDPNB           Order Sequence
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Get defaults values from Company/Item.
      *================================================================
      * RTV For Ord Dtl 2      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDG8XFR'              90  RTV For Ord Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0025  30       Company Number
     C                     PARM #1HGCD    WQ0026  70       Item Code
     C           #1G7NA    PARM *BLANK    WQ0027 30        Description Lin
     C           #1G8NA    PARM *BLANK    WQ0028 30        Description Lin
     C           #1AGCD    PARM *BLANK    WQ0029  2        UOM Primary
     C           #1CRCD    PARM *BLANK    WQ0030  2        UOM Pricing
     C           #1AVWG    PARM *ZERO     WQ0031 112       Unit Weight
     C           #1RBCD    PARM *BLANK    WQ0032  2        Item Level
     C           #1FZST    PARM *BLANK    WQ0033  1        Production Date
     C           #1AVST    PARM *BLANK    WQ0034  1        Catch Weight St
     C           #1RINB    PARM *ZERO     WQ0035  30       Item Structure
     C           #1RHNB    PARM *ZERO     WQ0036  30       Item Structure
     C           #1RGNB    PARM *ZERO     WQ0037  30       Item Structure
     C           WUN0CD    PARM *BLANK    WQ0038  3        Item Type Code
     C           WUAJCD    PARM *BLANK    WQ0039  3        Default Warehou
     C           #1H7NX    PARM *ZERO     WQ0040 112       Item Target Pri
     C           YL0006    PARM *BLANK    WQ0041  2        Item TF Exempt
     C           WUECST    PARM *BLANK    WQ0042  1        Error Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0003           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0004           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Company Item           NF'
     C                     MOVEL'USR0326' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     ELSE
      * CASE: LCL.Customer TF Exempt Code is Exempt Customer
     C           YL0003    IFEQ 'EC'                       *IF
      * Either the Customer must be exempt or each line item must be
      * This pass the exempt so no more validation
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Claim Number is Claim Process
     C           #PC0C7    IFGT *ZERO                      *IF
     C                     ELSE
      * CASE: LCL.Item TF Exempt Code is Exempt Product
     C           YL0006    IFEQ 'EP'                       *IF
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Delete#1
     C           #1SEL     IFEQ '4'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0005           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0006           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Itm/Customer MB Exempt'
     C                     MOVEL'USR3611' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Validate Warehouse.
      *================================================================
      * If warehouse not entered by user, then load default.
     C                     EXSR UGSUBR                     If warehouse no
      * Validate Warehouse Code.
     C                     EXSR UHSUBR                     Validate Wareho
      * Validate Item/Warehouse --> IC Item Balance.
     C                     EXSR UISUBR                     Validate Item/W
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * If warehouse not entered by user, then load default.
      *================================================================
      * CASE: RCD.Warehouse Code is Warehouse Code Blank
     C           #1AJCD    IFEQ *BLANK                     *IF
     C                     MOVELWUAJCD    #1AJCD           Warehouse Code
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Validate Warehouse Code.
      *================================================================
      * VAL Warehouse          RT - Warehouse  * 
     C                     EXSR SFRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0007           Warehouse Code
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Validate Item/Warehouse --> IC Item Balance.
      *================================================================
      * VAL Itm Bal. Exists    XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDCUXFR'              90  VAL Itm Bal. Ex
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0043  30       Company Number
     C                     PARM #1HGCD    WQ0044  70       Item Code
     C                     PARM #1AJCD    WQ0045  3        Warehouse Code
     C           WUECST    PARM *BLANK    WQ0046  1        Error Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983237*
     C                     END
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0008           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0008           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0009           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0009           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1AJCD    ZA0010           Warehouse Code
      * Send message 'Item Balance           NF'
     C                     MOVEL'USR0328' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983237*
      *
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Validate Item Type Code.
      *================================================================
      * CASE: WRK.Item Type Code is Not Finished Good
     C           WUN0CD    IFNE 'FG'                       *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0011           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0011           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item must be Finished Gd'
     C                     MOVEL'USR1941' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Validate Contract Number.
      *================================================================
      * CASE: RCD.Contract Number is Entered
     C           #1L6NB    IFGT *ZERO                      *IF
      * RTV Val. Contract #    RT - OPP Item Contract  * 
     C                     EXSR SGRVGN
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : PAR.Order Date GE PAR.Effective Date
      *   |- c3    : PAR.Order Date LE PAR.End Date Effective
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           P1A0DT    IFGE P4AUDT                     *IF
     C           P1A0DT    IFLE P4CWDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1L6NB    ZA0012           Contract Number
      * Send message 'OPP Contract Error'
     C                     MOVEL'USR1803' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Validate Price Method.
      *================================================================
      * If price method not entered by user, then load default.
     C                     EXSR UMSUBR                     If price method
      * RTV Price Meth Type    RT - PD Price Method Header  * 
     C                     EXSR SHRVGN
      * CASE: PAR.Price Method Type is Extended or Manual
     C           P6V8ST    IFEQ 'X'                        *IF
     C           P6V8ST    OREQ 'M'
      * Price Method must be extended or manual.
     C                     EXSR UNSUBR                     Price Method mu
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1Q7CD    ZA0014           Price Method Co
      * Send message 'Price Meth Invalid-Cr/Dr'
     C                     MOVEL'USR1971' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * If price method not entered by user, then load default.
      *================================================================
      * CASE: RCD.Price Method Code is Blank
     C           #1Q7CD    IFEQ *BLANK                     *IF
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           P7OBST    IFEQ '2'                        *IF
     C                     MOVELP9TOCD    #1Q7CD           Price Method Co
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP9TPCD    #1Q7CD           Price Method Co
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Price Method must be extended or manual.
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Type is Manual Pricing
      *   |- c2    : RCD.Quantity Ordered is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6V8ST    IFEQ 'M'                        *IF
     C           #1AVQT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * When Price Method is Extended, Qty Ordered must be entered.
     C                     EXSR UOSUBR                     When Price Meth
     C                     END                             *FI
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * When Price Method is Extended, Qty Ordered must be entered.
      *================================================================
      * Setup message data for message
     C                     MOVEL#1Q7CD    ZA0013           Price Method Co
      * Send message 'Price Meth inv with 0 qty'
     C                     MOVEL'USR1975' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Validate Weight (Pounds).
      *================================================================
      * CASE: PAR.Display Flag is No
     C           P3QKST    IFEQ 'N'                        *IF
      * *** Memo was created from a claim, skip calculations.
     C                     ELSE
      * CASE: *OTHERWISE
      * Not a claim memo.
     C                     EXSR UQSUBR                     Not a claim mem
     C                     END                             *FI
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Not a claim memo.
      *================================================================
      * CASE: RCD.USR Pounds is Zero
     C           #RMHNB    IFEQ *ZERO                      *IF
      * Weight not entered by user, load default.
     C                     EXSR URSUBR                     Weight not ente
     C                     END                             *FI
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.USR Pounds is Zero
      *   |- c2    : PAR.Price Method Type is Manual Pricing
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RMHNB    IFEQ *ZERO                      *IF
     C           P6V8ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pounds is required if Manual price method.
     C                     EXSR USSUBR                     Pounds is requi
     C                     END                             *FI
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Weight not entered by user, load default.
      *================================================================
      * CASE: PAR.Price Method Type is Extended Pricing
     C           P6V8ST    IFEQ 'X'                        *IF
      * *** extended price method, do not change pounds ***
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Quantity Ordered is Equal to zero
     C           #1AVQT    IFEQ *ZERO                      *IF
      * *** load default pounds for item ***
     C                     Z-ADD#1AVWG    #RMHNB           USR Pounds
     C                     ELSE
      * CASE: *OTHERWISE
      * *** total default pounds = qty * default pounds ***
     C           #1AVQT    MULT #1AVWG    #RMHNB           USR Pounds
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Pounds is required if Manual price method.
      *================================================================
      * Setup message data for message
     C                     Z-ADD#1D0WG    ZA0015           Weight Ordered
      * Send message 'Pounds is Required'
     C                     MOVEL'USR2255' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       WUECST           Error Status
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Continue Validations.
      *================================================================
      * CASE: PAR.Display Flag is No
     C           P3QKST    IFEQ 'N'                        *IF
      * *** Memo was created from a claim, skip calculations.
     C                     ELSE
      * CASE: *OTHERWISE
      * Not a claim memo.
     C                     EXSR UUSUBR                     Not a claim mem
     C                     END                             *FI
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Not a claim memo.
      *================================================================
      * CASE: PAR.Price Method Type is Extended Pricing
     C           P6V8ST    IFEQ 'X'                        *IF
      * Extended Pricing, USR Quantity = Pounds / Default Item Qty.
     C                     EXSR UVSUBR                     Extended Pricin
     C                     ELSE
      * CASE: *OTHERWISE
      * Manual Pricing, USR Quantity = Quantity Ordered.
     C                     EXSR UWSUBR                     Manual Pricing,
     C                     END                             *FI
      * CLC Price Item         XF - Price Method Header  * 
     C                     CALL 'PDG9XFR'              90  CLC Price Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0047  30       Company Number
     C                     PARM #1Q7CD    WQ0048  3        Price Method Co
     C                     PARM #PBKC7    WQ0049  70       Ship To Custome
     C                     PARM #1GNDT    WQ0050  70       Actual Shipped
     C                     PARM #1AGCD    WQ0051  2        U_M_Ordered
     C                     PARM WUBAQT    WQ0052 112       Quantity Ordere
     C                     PARM #PA0DT    WQ0053  70       Requested Ship
     C           #1AKPR    PARM #1AKPR    WQ0054 114       Unit Price
     C           #1AUPR    PARM #1AUPR    WQ0055 114       Unit Price Orde
     C                     PARM #1HGCD    WQ0056  70       Item Code
     C                     PARM #1CXDT    WQ0057  70       Date of Orig. E
     C                     PARM #1LQCD    WQ0058  3        Commodity Marke
     C                     PARM #1EXDT    WQ0059  70       Market Pricing
     C           #1U1ST    PARM #1U1ST    WQ0060  1        Price Status
     C                     PARM #1RDCD    WQ0061  3        Date Method Cod
     C                     PARM #1BZPR    WQ0062 114       Price Overage O
     C           #1GIDT    PARM #1GIDT    WQ0063  70       Pricing Date Us
     C                     PARM '**'      WQ0064  2        Event Called Fr
     C                     PARM #1DWPR    WQ0065 114       OD Ceiling Pric
     C                     PARM #1TKDT    WQ0066  70       OD Market Begin
     C                     PARM #1TLDT    WQ0067  70       OD Market Endin
     C                     PARM #1C4NB    WQ0068  70       Order Number
     C                     PARM #2EIDT    WQ0069  70       Requested Deliv
     C                     PARM #1DPNB    WQ0070  30       Order Sequence
     C                     PARM *ZERO     WQ0071  30       Order Secondary
     C           WUWZST    PARM WUWZST    WQ0072  5        Error Return
     C                     PARM 'S'       WQ0073  1        Price Type Stat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983632*
     C                     SETON                     34    *
     C                     END
      * Calculate for pricing by the pound calculations
     C                     EXSR UXSUBR                     Calculate for p
      * Pricing error message
      * CASE: WRK.Error Return is All Entered Values
     C           WUWZST    IFEQ 'CFR'                      *IF
     C           WUWZST    OREQ 'CID'
     C           WUWZST    OREQ 'CIF'
     C           WUWZST    OREQ 'CIO'
     C           WUWZST    OREQ 'QPE'
     C           WUWZST    OREQ 'EXT'
     C           WUWZST    OREQ 'XPE'
     C           WUWZST    OREQ 'FPE'
     C           WUWZST    OREQ 'IOM'
     C           WUWZST    OREQ 'IOV'
     C           WUWZST    OREQ 'MPE'
     C           WUWZST    OREQ 'KPE'
     C           WUWZST    OREQ 'MKT'
     C           WUWZST    OREQ 'MSC'
     C           WUWZST    OREQ 'OVR'
     C           WUWZST    OREQ 'STR'
     C           WUWZST    OREQ 'SUB'
     C           WUWZST    OREQ 'TRC'
     C           WUWZST    OREQ 'WPA'
     C           WUWZST    OREQ 'RWB'
     C           WUWZST    OREQ 'ITERR'
     C           WUWZST    OREQ 'CRD'
     C           WUWZST    OREQ 'MSL'
     C           WUWZST    OREQ 'GAT'
      * Setup message data for message
      * Convert Market Pricing Date to display format
      * Convert date
     C           1000000   ADD  #1EXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0016
     C                     MOVEL#1RDCD    ZA0017           Date Method Cod
     C                     MOVEL#1Q7CD    ZA0018           Price Method Co
     C                     MOVEL#1LQCD    ZA0019           Commodity Marke
     C                     MOVELWUWZST    ZA0020           Error Return
      * Send message 'Error in Pricing Routine'
     C                     MOVEL'USR1850' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
      * Extended Amount
      * CASE: RCD.Quantity Ordered is Equal to zero
     C           #1AVQT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1BZPR    #1AYVA           Extended Amount
     C                     Z-ADD*ZERO     #1AKPR           Unit Price
     C                     Z-ADD*ZERO     #1ALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     #1AUPR           Unit Price Orde
     C                     MOVEL*BLANK    #1CRCD           U_M_Base Price
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Price Method Type is Extended Pricing
     C           P6V8ST    IFEQ 'X'                        *IF
     C                     Z-ADD#1BZPR    #1AYVA           Extended Amount
     C                     ELSE
      * CASE: *OTHERWISE
     C           #1AVQT    MULT #1AUPR    #1AYVA    H      Extended Amount
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       W0DCF            *Defer confirm
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Extended Pricing, USR Quantity = Pounds / Default Item Qty.
      *================================================================
     C           #RMHNB    DIV  #1AVWG    WUUQ17           USR Quantity 17
     C           WUUQ17    MULT 1         WUBAQT           USR Quantity
      * CASE: WRK.USR Quantity is Equal to zero
     C           WUBAQT    IFEQ *ZERO                      *IF
     C                     Z-ADD1         WUBAQT           USR Quantity
     C                     END                             *FI
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Manual Pricing, USR Quantity = Quantity Ordered.
      *================================================================
     C                     Z-ADD#1AVQT    WUBAQT           USR Quantity
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * Calculate for pricing by the pound calculations
      *================================================================
      * CASE: PAR.Price Method Type is Extended Pricing
     C           P6V8ST    IFEQ 'X'                        *IF
      * Price Method is Extended Pricing.
     C                     EXSR UYSUBR                     Price Method is
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.U/M - Base Price is Gallon
     C           #1CRCD    IFEQ 'GL'                       *IF
      * 5/30/08
      * RMC FP1110 added for HPB which is in gallons, lbs is per a densit
     C                     ELSE
      * CASE: *OTHERWISE
      * Price Method is Manual.
     C                     EXSR UZSUBR                     Price Method is
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * Price Method is Extended Pricing.
      *================================================================
      * RTV Item Details       XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKAXFR'              90  RTV Item Detail
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0074  30       Company Number
     C                     PARM #1HGCD    WQ0075  70       Item Code
     C           WUADCD    PARM *BLANK    WQ0076  2        UOM Primary
     C           WUAWPC    PARM *ZERO     WQ0077  94       Conversion Fact
     C           WULXST    PARM *BLANK    WQ0078  1        Operation Facto
     C           WUAECD    PARM *BLANK    WQ0079  2        UOM Second
     C           WUAXPC    PARM *ZERO     WQ0080  94       Conversion Fact
     C           WULYST    PARM *BLANK    WQ0081  1        Operation Facto
     C           WUAFCD    PARM *BLANK    WQ0082  2        UOM Third
     C           WUAICD    PARM *BLANK    WQ0083  2        UOM Pricing
     C           WUAIWG    PARM *ZERO     WQ0084 112       Unit Weight
     C           WUBLPR    PARM *ZERO     WQ0085 114       Market Overage
     C           WUBMPR    PARM *ZERO     WQ0086 114       Standard Overag
     C           WUA6AA    PARM *BLANK    WQ0087  7        Commodity Price
     C           WUU9ST    PARM *BLANK    WQ0088  1        Item Pricing Op
     C           WUCMCO    PARM *ZERO     WQ0089 114       Item Pricing Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
      * CASE: WRK.USR Quantity 17,9 is NE Zeros
     C           WUUQ17    IFNE *ZERO                      *IF
     C           #1BZPR    DIV  WUUQ17    WUTPVA    H      Pricing Retriev
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1BZPR    WUTPVA           Pricing Retriev
     C                     END                             *FI
      * CLC Convert Price Qtys XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKGXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0090  30       Company Number
     C                     PARM #1HGCD    WQ0091  70       Item Code
     C           #1AGCD    PARM #1AGCD    WQ0092  2        UOM Pricing
     C           WUAPPR    PARM WUAPPR    WQ0093 114       Price based on
     C           WUAQPR    PARM WUAQPR    WQ0094 114       Price based on
     C           WUARPR    PARM WUARPR    WQ0095 114       Price based on
     C                     PARM WUTPVA    WQ0096 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
      * If U/M Priced = Primary then execute
      * CASE: RCD.U/M - Base Price EQ WRK.U/M - Primary
     C           #1CRCD    IFEQ WUADCD                     *IF
     C                     Z-ADDWUAPPR    #1AKPR           Unit Price
     C                     END                             *FI
      * If U/M Priced = Secondary then execute
      * CASE: RCD.U/M - Base Price EQ WRK.U/M - Second
     C           #1CRCD    IFEQ WUAECD                     *IF
     C                     Z-ADDWUAQPR    #1AKPR           Unit Price
     C                     END                             *FI
      * If U/M Priced = Third then execute
      * CASE: RCD.U/M - Base Price EQ WRK.U/M - Third
     C           #1CRCD    IFEQ WUAFCD                     *IF
     C                     Z-ADDWUARPR    #1AKPR           Unit Price
     C                     END                             *FI
      * Calc Unit Price Ordered U/M
      * CASE: WRK.USR Quantity 17,9 is NE Zeros
     C           WUUQ17    IFNE *ZERO                      *IF
     C           #1BZPR    DIV  WUUQ17    #1AUPR    H      Unit Price Orde
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1BZPR    #1AUPR           Unit Price Orde
     C                     END                             *FI
     C                     Z-ADD#1AUPR    #1ALPR           Unit Price_Cred
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * Price Method is Manual.
      *================================================================
      * CASE: RCD.Unit Weight Ordered U/M is Not equal zero
     C           #1AVWG    IFNE *ZERO                      *IF
      * Calc Working Extended Amt
      * PAR.Calc Work Field 15,6 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : RCD.Unit Price Ordered U_M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : RCD.Unit Weight Ordered U_M
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : RCD.USR Pounds
     C           #1AUPR    DIV  #1AVWG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT #RMHNB    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    P3JYNX           Calc Work Field
     C                     END                             *FI
      * Recalc Unit Price per U/M
      * CASE: RCD.Quantity Ordered is not equal zero
     C           #1AVQT    IFNE *ZERO                      *IF
     C           P3JYNX    DIV  #1AVQT    #1AUPR    H      Unit Price Orde
     C                     ELSE
      * CASE: *OTHERWISE
     C           P3JYNX    DIV  1         #1AUPR    H      Unit Price Orde
     C                     END                             *FI
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Company Item
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1HGCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AIC3' defaulted for 'Company Number'.
      * Field '(RCD) #1HGCD' defaulted for 'Item Code'.
     C                     CALL 'PDJISRR'              90  SEL Company/Ite
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0097  30       Company Number
     C           #1HGCD    PARM #1HGCD    WQ0098  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJISRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9832  *
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HGCD    IFEQ *ZERO                      Item Code
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVABZ    KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    BZAIC3
     C                     Z-ADD#1HGCD    BZHGCD
     C           KLVABZ    CHAIN@BZREJU              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Company Item           NF'
     C                     MOVEL'USR0326' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0326' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Warehouse Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AJCD' defaulted for 'Warehouse Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0099  3        Warehouse Code
     C                     PARM *ZERO     WQ0100  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9837  *
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJCD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBAD    KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD
     C           KLVBAD    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Customer Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1BKC7'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'AR Customer Number'.
      * Field '(LCL) YL0007' defaulted for 'G/L Vendor Number USR'.
     C                     CALL 'PMFRSRR'              90  SEL A/R Cust W/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0101  70       AR Customer Num
     C           YL0007    PARM *ZERO     WQ0102  80       G/L Vendor Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1BKC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BKC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7
     C           KLVCBB    CHAIN@BBREE9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Customer Master        NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Order Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1CFC7    IFEQ *ZERO                      Order Group Cod
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDK0    KLIST
     C                     KFLD           K0AIC3           Company Number
     C                     KFLD           K0CFC7           Order Group Cod
      * Setup key
     C                     Z-ADD#1AIC3    K0AIC3
     C                     Z-ADD#1CFC7    K0CFC7
     C           KLVDK0    CHAIN@K0REJ6              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Order Group            NF'
     C                     MOVEL'USR2364' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2364' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Commodity Markets
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Commodity Marke
     C           YPMTFD    OREQ '#1LQCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1LQCD' defaulted for 'Commodity Market Code'.
     C                     CALL 'PDEDSRR'              90  SEL Commod. Mkt
     C                     PARM *BLANK    W0RTN   7
     C           #1LQCD    PARM #1LQCD    WQ0103  3        Commodity Marke
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1LQCD    IFNE *BLANK                     Commodity Marke
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LQCD    IFEQ *BLANK                     Commodity Marke
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEFY    KLIST
     C                     KFLD           FYLQCD           Commodity Marke
      * Setup key
     C                     MOVEL#1LQCD    FYLQCD
     C           KLVEFY    CHAIN@FYREDK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Commodity Markets      NF'
     C                     MOVEL'USR1218' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1218' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Market Date Method
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RDCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Date Method Cod
     C           YPMTFD    OREQ '#1RDCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AIC3' defaulted for 'Company Number'.
      * Field '(RCD) #1RDCD' defaulted for 'Date Method Code'.
     C                     CALL 'PDKISRR'              90  Sel Market Date
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0104  30       Company Number
     C           #1RDCD    PARM *BLANK    WQ0105  3        Date Method Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKISRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RDCD    IFNE *BLANK                     Date Method Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RDCD    IFEQ *BLANK                     Date Method Cod
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFIP    KLIST
     C                     KFLD           IPAIC3           Company Number
     C                     KFLD           IPRDCD           Date Method Cod
      * Setup key
     C                     Z-ADD#1AIC3    IPAIC3
     C                     MOVEL#1RDCD    IPRDCD
     C           KLVFIP    CHAIN@IPRERT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Market Date Method     NF'
     C                     MOVEL'USR1681' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1681' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Price Method Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q7CD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Price Method Co
     C           YPMTFD    OREQ '#1Q7CD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AIC3' defaulted for 'Company Number'.
      * Field '(RCD) #1Q7CD' defaulted for 'Price Method Code'.
     C                     CALL 'PDZDSRR'              90  SEL PD Price Me
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0106  30       Company Number
     C           #1Q7CD    PARM #1Q7CD    WQ0107  3        Price Method Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9836  *
     C                     END
      *
     C           #1Q7CD    IFNE *BLANK                     Price Method Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q7CD    IFEQ *BLANK                     Price Method Co
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGIH    KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    IHAIC3
     C                     MOVEL#1Q7CD    IHQ7CD
     C           KLVGIH    CHAIN@IHRERN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Price Method Header    NF'
     C                     MOVEL'USR1665' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1665' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1CRCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1CRCD' defaulted for 'U_M_Base Price'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1CRCD    PARM #1CRCD    WQ0108  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1CRCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CRCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHAM    KLIST
     C                     KFLD           AMHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1CRCD    AMHHCD
     C           KLVHAM    CHAIN@AMREB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1AGCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AGCD' defaulted for 'U_M_Ordered'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AGCD    PARM #1AGCD    WQ0109  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1AGCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AGCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIAM    KLIST
     C                     KFLD           AMHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1AGCD    AMHHCD
     C           KLVIAM    CHAIN@AMREB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Price Audit Reason Cd
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RFCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Price Audit Rea
     C           YPMTFD    OREQ '#1RFCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AIC3' defaulted for 'Company Number'.
      * Field '(RCD) #1RFCD' defaulted for 'Price Audit Reason Code'.
     C                     CALL 'PDEZSRR'              90  Zzz Price Audit
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0110  30       Company Number
     C           #1RFCD    PARM #1RFCD    WQ0111  3        Price Audit Rea
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEZSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RFCD    IFNE *BLANK                     Price Audit Rea
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RFCD    IFEQ *BLANK                     Price Audit Rea
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJIR    KLIST
     C                     KFLD           IRAIC3           Company Number
     C                     KFLD           IRRFCD           Price Audit Rea
      * Setup key
     C                     Z-ADD#1AIC3    IRAIC3
     C                     MOVEL#1RFCD    IRRFCD
     C           KLVJIR    CHAIN@IRRERQ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Price Audit Reason Cd  NF'
     C                     MOVEL'USR1685' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1685' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A5DT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A5DT    AFBCDT
     C           KLVKAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AODT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AODT    AFBCDT
     C           KLVLAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1GNDT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1GNDT    AFBCDT
     C           KLVMAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RGNB'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1RGNB' defaulted for 'Item Structure Type Code'.
     C                     CALL 'PDENSRR'              90  SEL Item Type A
     C                     PARM *BLANK    W0RTN   7
     C           #1RGNB    PARM #1RGNB    WQ0112  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDENSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RGNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RGNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNE8    KLIST
     C                     KFLD           E8RGNB           Item Structure
      * Setup key
     C                     Z-ADD#1RGNB    E8RGNB
     C           KLVNE8    CHAIN@E8REBB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'Item Structure Type    NF'
     C                     MOVEL'USR1166' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1166' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RHNB'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1RHNB' defaulted for 'Item Structure Group Code'.
     C                     CALL 'PDEMSRR'              90  SEL Item Group
     C                     PARM *BLANK    W0RTN   7
     C           #1RHNB    PARM #1RHNB    WQ0113  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RHNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VOEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RHNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOE9    KLIST
     C                     KFLD           E9RHNB           Item Structure
      * Setup key
     C                     Z-ADD#1RHNB    E9RHNB
     C           KLVOE9    CHAIN@E9REA8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VOEXIT
     C                     END
      * Send message 'Item Structure Group   NF'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1168' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Class
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RINB'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1RINB' defaulted for 'Item Structure Class Code'.
     C                     CALL 'PDELSRR'              90  SEL Item Class
     C                     PARM *BLANK    W0RTN   7
     C           #1RINB    PARM #1RINB    WQ0114  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDELSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RINB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VPEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RINB    IFEQ *ZERO                      Item Structure
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPFA    KLIST
     C                     KFLD           FARINB           Item Structure
      * Setup key
     C                     Z-ADD#1RINB    FARINB
     C           KLVPFA    CHAIN@FAREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VPEXIT
     C                     END
      * Send message 'Item Structure Class   NF'
     C                     MOVEL'USR1170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1170' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to Item Level Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Item Level
     C           YPMTFD    OREQ '#1RBCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1RBCD' defaulted for 'Item Level'.
     C                     CALL 'PDBPSRR'              90  SEL PD Item Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1RBCD    PARM #1RBCD    WQ0115  2        Item Level
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RBCD    IFNE *BLANK                     Item Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VQEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RBCD    IFEQ *BLANK                     Item Level
     C                     GOTO VQEXIT
     C                     END
      *
     C           KLVQIL    KLIST
     C                     KFLD           ILRBCD           Item Level
      * Setup key
     C                     MOVEL#1RBCD    ILRBCD
     C           KLVQIL    CHAIN@ILRERK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VQEXIT
     C                     END
      * Send message 'Item Level Codes       NF'
     C                     MOVEL'USR1673' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1673' W0RTN
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1HICD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1HICD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0008' defaulted for 'Record Status'.
     C                     CALL 'PDHJSRR'              90  Zzz Rcd Sts-Act
     C                     PARM *BLANK    W0RTN   7
     C           YL0008    PARM YL0008    WQ0116  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1HICD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VREXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HICD    IFEQ *BLANK                     Quality Level
     C                     GOTO VREXIT
     C                     END
      *
     C           KLVRAI    KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1HICD    AIHICD
     C           KLVRAI    CHAIN@AIREBL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VREXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1RNCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0008' defaulted for 'Record Status'.
     C                     CALL 'PDHJSRR'              90  Zzz Rcd Sts-Act
     C                     PARM *BLANK    W0RTN   7
     C           YL0008    PARM YL0008    WQ0117  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1RNCD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VSEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RNCD    IFEQ *BLANK                     Quality Level
     C                     GOTO VSEXIT
     C                     END
      *
     C           KLVSAI    KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1RNCD    AIHICD
     C           KLVSAI    CHAIN@AIREBL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VSEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         VTCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ROCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1ROCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0008' defaulted for 'Record Status'.
     C                     CALL 'PDHJSRR'              90  Zzz Rcd Sts-Act
     C                     PARM *BLANK    W0RTN   7
     C           YL0008    PARM YL0008    WQ0118  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1ROCD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VTEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ROCD    IFEQ *BLANK                     Quality Level
     C                     GOTO VTEXIT
     C                     END
      *
     C           KLVTAI    KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1ROCD    AIHICD
     C           KLVTAI    CHAIN@AIREBL              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VTEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VTEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VTEXIT    ENDSR
      /EJECT
     CSR         VUCKRL    BEGSR
      *================================================================
      * Check reference to User Profile Control
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJVN    WK1X01  1
     C           WK1X01    IFEQ '?'                        User Profile Na
     C           YPMTFD    OREQ '#1AJVN'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AJVN' defaulted for 'User Profile Name'.
     C                     CALL 'CAXPSRR'              90  SEL User Profil
     C                     PARM *BLANK    W0RTN   7
     C           #1AJVN    PARM #1AJVN    WQ0119 10        User Profile Na
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAXPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1AJVN    IFNE *BLANK                     User Profile Na
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VUEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJVN    IFEQ *BLANK                     User Profile Na
     C                     GOTO VUEXIT
     C                     END
      *
     C           KLVUDR    KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL#1AJVN    DRAJVN
     C           KLVUDR    CHAIN@DRRETH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VUEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VUEXIT
     C                     END
      * Send message 'User Profile Control   NF'
     C                     MOVEL'USR0763' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0763' W0RTN
      *================================================================
     CSR         VUEXIT    ENDSR
      /EJECT
     CSR         VVCKRL    BEGSR
      *================================================================
      * Check reference to Country Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1KXCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Country Code
     C           YPMTFD    OREQ '#1KXCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1KXCD' defaulted for 'Country Code'.
     C                     CALL 'OMZASRR'              90  SEL Select Coun
     C                     PARM *BLANK    W0RTN   7
     C           #1KXCD    PARM #1KXCD    WQ0120  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMZASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1KXCD    IFNE *BLANK                     Country Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VVEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1KXCD    IFEQ *BLANK                     Country Code
     C                     GOTO VVEXIT
     C                     END
      *
     C           KLVVE5    KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVEL#1KXCD    E5KXCD
     C           KLVVE5    CHAIN@E5REB8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VVEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VVEXIT
     C                     END
      * Send message 'Country Master         NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1158' W0RTN
      *================================================================
     CSR         VVEXIT    ENDSR
      /EJECT
     CSR         VWCKRL    BEGSR
      *================================================================
      * Check reference to Event Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Event Code
     C           YPMTFD    OREQ '#1JPCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1JPCD' defaulted for 'Event Code'.
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #1JPCD    PARM #1JPCD    WQ0121  2        Event Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1JPCD    IFNE *BLANK                     Event Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VWEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JPCD    IFEQ *BLANK                     Event Code
     C                     GOTO VWEXIT
     C                     END
      *
     C           KLVWEZ    KLIST
     C                     KFLD           EZJPCD           Event Code
      * Setup key
     C                     MOVEL#1JPCD    EZJPCD
     C           KLVWEZ    CHAIN@EZREYT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VWEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VWEXIT
     C                     END
      * Send message 'Event Types            NF'
     C                     MOVEL'USR1076' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1076' W0RTN
      *================================================================
     CSR         VWEXIT    ENDSR
      /EJECT
     CSR         VXCKRL    BEGSR
      *================================================================
      * Check reference to OP Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1CQCD' defaulted for 'Reason Code'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1C4NB' defaulted for 'Order Number'.
      * Field '(CTL) #2GWST' defaulted for 'Header Status'.
     C                     CALL 'PDG8SRR'              90  SEL for Order R
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0122  3        Reason Code
     C                     PARM #1C4NB    WQ0123  70       Order Number
     C                     PARM #2GWST    WQ0124  1        Header Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG8SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9839  *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VXEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VXEXIT
     C                     END
      *
     C           KLVXCX    KLIST
     C                     KFLD           CXCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    CXCQCD
     C           KLVXCX    CHAIN@CXRENA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VXEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VXEXIT
     C                     END
      * Send message 'OP Reason Codes        NF'
     C                     MOVEL'USR0504' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0504' W0RTN
      *================================================================
     CSR         VXEXIT    ENDSR
      /EJECT
     CSR         VYCKRL    BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Sales Route Cod
     C           YPMTFD    OREQ '#1R4CD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1R4CD' defaulted for 'Sales Route Code'.
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0125  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1R4CD    IFNE *BLANK                     Sales Route Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VYEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R4CD    IFEQ *BLANK                     Sales Route Cod
     C                     GOTO VYEXIT
     C                     END
      *
     C           KLVYJE    KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD
     C           KLVYJE    CHAIN@JEREWF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VYEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VYEXIT
     C                     END
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1800' W0RTN
      *================================================================
     CSR         VYEXIT    ENDSR
      /EJECT
     CSR         VZCKRL    BEGSR
      *================================================================
      * Check reference to Ham Group Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1A1AA'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1A1AA' defaulted for 'Ham Group Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0009' defaulted for 'Exit Selection USR'.
     C                     CALL 'PDVYSRR'              90  SEL Ham Group
     C                     PARM *BLANK    W0RTN   7
     C           #1A1AA    PARM #1A1AA    WQ0126  30       Ham Group Numbe
     C           YL0009    PARM YL0009    WQ0127  1        Exit Selection
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1A1AA    IFNE *ZERO                      Ham Group Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VZEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1A1AA    IFEQ *ZERO                      Ham Group Numbe
     C                     GOTO VZEXIT
     C                     END
      *
     C           KLVZM0    KLIST
     C                     KFLD           M0A1AA           Ham Group Numbe
      * Setup key
     C                     Z-ADD#1A1AA    M0A1AA
     C           KLVZM0    CHAIN@M0REZH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VZEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VZEXIT
     C                     END
      * Send message 'Ham Group Master       NF'
     C                     MOVEL'USR2837' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2837' W0RTN
      *================================================================
     CSR         VZEXIT    ENDSR
      /EJECT
     CSR         WACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C                     MOVELV2C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#2C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #2C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0203  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0204  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLWABE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3
     C                     Z-ADD#2C4NB    BEC4NB
     C           KLWABE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     MOVELBEXIST    #2XIST           Credit Hold
     C                     MOVELBEXJST    #2XJST           Production Hold
     C                     MOVELBEGWST    #2GWST           Header Status
     C                     MOVELBEJNCD    #2JNCD           Order Type_Sale
     C                     Z-ADDBERMNB    #2RMNB           Load ID
     C                     MOVELBEU2ST    #2U2ST           Export Status
     C                     MOVELBEHNNA    #2HNNA           Ship To City
     C                     MOVELBEDBCD    #2DBCD           Ship To State C
     C                     Z-ADDBEEIDT    #2EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #2AFTM           Requested Deliv
     C                     MOVELBEGJST    #2GJST           Order in Use
     C                     GOTO WAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WAEXIT
     C                     END
     C           WA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         WAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD14        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           ZHF4RW    IFEQ 014
     C           ZHCSCL    ANDGE004
     C           ZHCSCL    ANDLE010
     C           *IN77     ANDEQ'0'
     C                     MOVEL'#1HGCD'  YPMTFD           Item Code
     C                     END
      *
     C           ZHF4RW    IFEQ 014
     C           ZHCSCL    ANDGE055
     C           ZHCSCL    ANDLE057
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#1Q7CD'  YPMTFD           Price Method Co
     C                     END
      *
     C           ZHF4RW    IFEQ 014
     C           ZHCSCL    ANDGE059
     C           ZHCSCL    ANDLE061
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#1AJCD'  YPMTFD           Warehouse Code
     C                     END
      *
     C           ZHF4RW    IFEQ 014
     C           ZHCSCL    ANDGE071
     C           ZHCSCL    ANDLE073
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#1CQCD'  YPMTFD           Reason Code
     C                     END
      *
     C           ZHF4RW    IFEQ 014
     C           ZHCSCL    ANDEQ075
     C                     MOVEL'#1AMST'  YPMTFD           Affect Inventor
     C                     END
      *
     C           ZHF4RW    IFEQ 014
     C           ZHCSCL    ANDEQ077
     C                     MOVEL'#1ANST'  YPMTFD           Affect Sales Do
     C                     END
      *
     C           ZHF4RW    IFEQ 014
     C           ZHCSCL    ANDEQ079
     C                     MOVEL'#1VAST'  YPMTFD           Affect Sales Pn
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
      * USER: Exit program processing
      * CASE: PAR.Access Denied (Y/N) is no
     C           P2WVST    IFEQ 'N'                        *IF
     C                     MOVEL'NOUPD'   P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1A5DT           Requested Ship
     C                     MOVEL*BLANK    P1GTST           Comment Print A
     C                     MOVEL*BLANK    P1GVST           Comment Print I
     C                     MOVEL*BLANK    P1GUST           Comment Print P
     C                     MOVEL*BLANK    P1QFST           Comment Print S
     C                     Z-ADD*ZERO     P1JZVA           Order Value Tot
     C                     Z-ADD*ZERO     P1A1WG           Order Weight To
     C                     MOVEL*BLANK    P1VEST           Palletize
     C                     MOVEL*BLANK    P1VGST           Slip Sheet
     C                     MOVEL*BLANK    P1RPCD           Age Code
     C                     Z-ADD*ZERO     P1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    P1VDST           Load Type
     C                     MOVEL*BLANK    P1JPCD           Event Code
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     MOVEL*BLANK    P1FSSX           Broker Order St
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     MOVEL*BLANK    P2DQCD           Enterprise Code
     C                     MOVEL*BLANK    P2DRCD           Enterprise Code
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2WVST           Access Denied (
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL*BLANK    P3TMST           USR First Time
     C                     MOVEL*BLANK    P3GGST           USR Display fie
     C                     MOVEL*BLANK    P3QKST           Display Flag
     C                     Z-ADD*ZERO     P3JYNX           Calc Work Field
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4AUDT           Effective Date
     C                     Z-ADD*ZERO     P4CWDT           End Date Effect
     C                     Z-ADD*ZERO     P4DQQT           Maximum Quantit
     C                     Z-ADD*ZERO     P4HFQT           Quantity Sold
     C                     Z-ADD*ZERO     P4GBDT           Contract Mkt Pr
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5WDST           Cntrt Enter no
     C                     MOVEL*BLANK    P5WEST           Cntrt.# does no
     C                     MOVEL*BLANK    P5WFST           Qty ordered > C
     C                     MOVEL*BLANK    P5WGST           Contract Expire
     C                     MOVEL*BLANK    P5WHST           Price Override
     C                     MOVEL*BLANK    P5WIST           Price Method QT
     C                     MOVEL*BLANK    P5WJST           Prc Code FRM or
     C                     MOVEL*BLANK    P5WKST           Mkt Pricing Dat
     C                     MOVEL*BLANK    P5WLST           Mkt Meth. and D
     C                     MOVEL*BLANK    P5WMST           Price Override
     C                     MOVEL*BLANK    P5XSST           Contract Exists
     C                     MOVEL*BLANK    P5YXST           Price Override
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6V8ST           Price Method Ty
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7OBST           Billing Activit
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P8MHNB           USR Pounds
      * Clear all neither parameters
     C                     MOVEL*BLANK    P9TOCD           Price Method De
     C                     MOVEL*BLANK    P9TPCD           Price Method De
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR Production
     C                     MOVEL*BLANK    WUXPST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A_R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Order Sequence Number
     C                     Z-ADD*ZERO     WUDPNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field USR Quantity 17,9
     C                     Z-ADD*ZERO     WUUQ17 179
      * Define work field USR Quantity
     C                     Z-ADD*ZERO     WUBAQT 112
      * Define work field Error Return
     C                     MOVEL*BLANK    WUWZST  5
      * Define work field UOM Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Conversion Factor 1
     C                     Z-ADD*ZERO     WUAWPC  94
      * Define work field Operation Factor 1
     C                     MOVEL*BLANK    WULXST  1
      * Define work field UOM Second
     C                     MOVEL*BLANK    WUAECD  2
      * Define work field Conversion Factor 2
     C                     Z-ADD*ZERO     WUAXPC  94
      * Define work field Operation Factor 2
     C                     MOVEL*BLANK    WULYST  1
      * Define work field UOM Third
     C                     MOVEL*BLANK    WUAFCD  2
      * Define work field UOM Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Market Overage
     C                     Z-ADD*ZERO     WUBLPR 114
      * Define work field Standard Overage_Underage
     C                     Z-ADD*ZERO     WUBMPR 114
      * Define work field Unused Parm - CD9     USR
     C                     MOVEL*BLANK    WUA6AA  9
      * Define work field Item Pricing Operation
     C                     MOVEL*BLANK    WUU9ST  1
      * Define work field Item Pricing Constant
     C                     Z-ADD*ZERO     WUCMCO 114
      * Define work field Pricing Retrieved Amount
     C                     Z-ADD*ZERO     WUTPVA 114
      * Define work field Price based on U/M1 S
     C                     Z-ADD*ZERO     WUAPPR 114
      * Define work field Price based on U/M2 S
     C                     Z-ADD*ZERO     WUAQPR 114
      * Define work field Price based on U/M3 S
     C                     Z-ADD*ZERO     WUARPR 114
      * Clear all neither parameters
      * CRT PD Order Detail    CR - Order Detail  * 
     C                     Z-ADD*ZERO     OMAATM           Job Time
     C                     Z-ADD*ZERO     OMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WBBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WBBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCBTC7           Parent Customer
     C                     Z-ADD*ZERO     WCANC7           AR Customer Num
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCORIT           Original Item
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WCESNB           Accounting Year
     C                     Z-ADD*ZERO     WCETNB           Accounting Peri
     C                     Z-ADD*ZERO     WCBZNB           OM Week
     C                     Z-ADD*ZERO     WCEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WCBYWG           Weight Billed
     C                     Z-ADD*ZERO     WCS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WCUTVA           Standard Overag
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCCKNB           GL Document Num
     C                     Z-ADD*ZERO     WCR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WCSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WCSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WCONVA           Actual Freight
     C                     Z-ADD*ZERO     WCB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WCB5NB           PM Line Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WCUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WCUOVA           Commission Amou
     C                     Z-ADD*ZERO     WCUPVA           Financials Amou
     C                     Z-ADD*ZERO     WCUQVA           Financials Amou
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WCIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WCNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WCBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WCCDPR           Market Value
     C                     Z-ADD*ZERO     WCD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WCD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WCCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WCOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WCD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WCCFVL           HST Item Target
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     WUUENB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WDGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Display Flag 1 USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Customer TF Exempt Code
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field OH TF Exempt Code
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field Affect Commission
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Item TF Exempt Code
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field G/L Vendor Number USR
     C                     Z-ADD*ZERO     YL0007  80
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Exit Selection USR
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0010  2
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field Misc Tare Weight
     C                     Z-ADD*ZERO     YL0011  52
      * Define local work field Box Weight
     C                     Z-ADD*ZERO     YL0012  52
      * Define local work field Number Cases On A Pallet
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field Pallet Tare Weight
     C                     Z-ADD*ZERO     YL0014  52
      * Define local work field Box iD
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Total Tare USR
     C                     Z-ADD*ZERO     YL0016  52
      * Define local work field Weight 1.1             .U
     C                     Z-ADD*ZERO     YL0017  92
      * Define local work field Weight 1.2             .U
     C                     Z-ADD*ZERO     YL0018  92
      * Define local work field Text 3 Length USR
     C                     MOVEL*BLANK    YL0019  3
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0020 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0021 12
      * Define local work field Weight Beg Inv usr
     C                     Z-ADD*ZERO     YL0022  70
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0023  7
      * Define local work field Affect Inventory Sts Usr
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field Affect Sales Doll Sts Usr
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Affect Sales Pnds Sts Usr
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field Upd/Del Sts USR
     C                     MOVEL*BLANK    YL0027  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD04        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR NGSUBR                     Modifications a
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SRRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Change to ADD mode if no records exists.
     C                     EXSR NHSUBR                     Change to ADD m
      * Initialize flags and get company defaults.
     C                     EXSR NISUBR                     Initialize flag
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 QPRINT
00002 PPL4PFR$
00003 USR0752
