// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLH9XFR
// ?Date: 14.08.2025 Time: 02:54:20
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?RMC 11/23/05 added co to mplus msgs
EXECUTE FUNCTION(Rtv Payment Processing RT) TYPE(RTVOBJ) FILE(PKC4REP)          AB1147409;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(NLL.Pmt_Current_Payment_Date);
PARAMETER(WRK.Pmt_Current_Payment_Step);
PARAMETER(WRK.PP_Commission_Paym_Error);
PARAMETER(WRK.PP_Payment_Error);
PARAMETER(WRK.PP_Unused_Nbr_1);
PARAMETER(WRK.PP_Repayment_Status);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// LCL.Office Dist List USR = CON.PRKHPPST
LCL.Office_Dist_List_USR = 'PRKHPPST';

//?Step 6, 7, & Roll Kill Date
CASE;

// IF WRK.PP Payment Error is No Errors
IF WRK.PP_Payment_Error = 'N';

// AND WRK.PP Commission Paym Error is No Errors
AND WRK.PP_Commission_Paym_Error = 'N';

//?Step 6: Payment Post
DO;

//?Step 6:  Producer Posting
CASE;

// IF WRK.Pmt Current Payment Step is Less or Equal to Step 6
IF WRK.Pmt_Current_Payment_Step <= 00006;

//?Step 6  Payment posting and producer Post/Create Producer Vouchers
CASE;

// IF WRK.Pmt Current Payment Step is Greater then or Equal 5
IF WRK.Pmt_Current_Payment_Step >= 00005;

// WRK.Pmt Current Payment Step = CND.00006 Producer Payment
WRK.Pmt_Current_Payment_Step = 00006;

EXECUTE FUNCTION(Upd Paymnt Prc         CH) TYPE(CHGOBJ) FILE(PKC4REP)          AB1146820;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Step);
PARAMETER(WRK.PP_Commission_Paym_Error);
PARAMETER(WRK.PP_Payment_Error);
PARAMETER(WRK.PP_Unused_Nbr_1);
PARAMETER(WRK.PP_Repayment_Status);
{
 //?USER: Processing before Data read

 EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
 PARAMETER(PAR.RS_User_Changed);
 PARAMETER(PAR.RS_Date_Changed);
 PARAMETER(PAR.RS_Time_Changed);
 PARAMETER(PAR.RS_Job);
 PARAMETER(PAR.RS_Program);
 {
  //?Execute internal function

  // PAR.RS User Changed = JOB.*USER
  PAR.RS_User_Changed = JOB.*USER;

  // PAR.RS Date Changed = JOB.*Job date
  PAR.RS_Date_Changed = JOB.*Job_date;

  // PAR.RS Time Changed = JOB.*Job time
  PAR.RS_Time_Changed = JOB.*Job_time;

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

 }

}


// Call program Prt Pay Chk Post Rep  PF.
CALL PROGRAM(Prt Pay Chk Post Rep  PF) ('PKT1PFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('P');
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER('U');
PARAMETER(WRK.@Payment_Error);

//?This report will print a report by producer, and create checks
// Call program Prt Payment Edit/Post PF.
CALL PROGRAM(Prt Payment Edit/Post PF) ('PKS2PFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('P');
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER('U');
PARAMETER(WRK.@Payment_Error);

//?This report will print comm paid by TH producer, and create checks
// Call program Prt Payment Comm E/P  PF.
CALL PROGRAM(Prt Payment Comm E/P  PF) ('PKPMPFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('P');
PARAMETER(WRK.@Payment_Error);
PARAMETER(PAR.Oms_System_Value_Alpha);

//?PK0166- Update TH Ext with Excluded Carcass Data
// Call program Rtv Excep Deleted Sum XF.
CALL PROGRAM(Rtv Excep Deleted Sum XF) ('PKT5XFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);

// Call program Prt Pur-Jrn Prm/      PF.
CALL PROGRAM(Prt Pur-Jrn Prm/      PF) ('PKTTPFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('P');
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER('U');
PARAMETER(WRK.@Payment_Sts);

// Call program Prt Pur-Jrn Rsl       PF.
CALL PROGRAM(Prt Pur-Jrn Rsl       PF) ('PKTZPFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('P');
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER('U');
PARAMETER(WRK.@Payment_Sts);

// WRK.Pmt Current Payment Step = CND.00007 Carcass Summary
WRK.Pmt_Current_Payment_Step = 00007;

EXECUTE FUNCTION(Upd Paymnt Prc         CH) TYPE(CHGOBJ) FILE(PKC4REP)          AB1146820;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Step);
PARAMETER(WRK.PP_Commission_Paym_Error);
PARAMETER(WRK.PP_Payment_Error);
PARAMETER(WRK.PP_Unused_Nbr_1);
PARAMETER(WRK.PP_Repayment_Status);
{
 //?USER: Processing before Data read

 EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
 PARAMETER(PAR.RS_User_Changed);
 PARAMETER(PAR.RS_Date_Changed);
 PARAMETER(PAR.RS_Time_Changed);
 PARAMETER(PAR.RS_Job);
 PARAMETER(PAR.RS_Program);
 {
  //?Execute internal function

  // PAR.RS User Changed = JOB.*USER
  PAR.RS_User_Changed = JOB.*USER;

  // PAR.RS Date Changed = JOB.*Job date
  PAR.RS_Date_Changed = JOB.*Job_date;

  // PAR.RS Time Changed = JOB.*Job time
  PAR.RS_Time_Changed = JOB.*Job_time;

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

 }

}


ENDIF;

ENDIF;

ENDDO;

ENDIF;

