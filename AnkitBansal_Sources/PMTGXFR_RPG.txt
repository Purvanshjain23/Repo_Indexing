     H/TITLE Exc Crt RIN Genrt Rpt XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 06/22/10  Time  : 13:15:54
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMCCCPL4IF  E           K        DISK
      * RSQ : COA Batch Header          Comp/Prod Date/Batch
      *
     FPMCAREL1IF  E           K        DISK
      * RTV : COA Property Define Hdr   Retrieval index
      *
     FPMDACPL3IF  E           K        DISK
      * RSQ : COA Batch Header RIN      Co/ULSD/Batch/Order
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FPMDPCPL0IF  E           K        DISK                      A
      * UPD : RFS RIN Generation Rpt    Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@CCCPSC
      * COA Batch Header          Comp/Prod Date/Batch
      * Renamed input format fields
     I              CCAIC3                          WAAIC3
     I              CCL6T1                          WAL6T1
     I              CCI3NY                          WAI3NY
     I              CCIKAA                          WAIKAA
     I              CCIDAA                          WAIDAA
     I              CCRFDT                          WARFDT
     I              CCC2TM                          WAC2TM
     I              CCMHT1                          WAMHT1
     I              CCRGDT                          WARGDT
     I              CCC3TM                          WAC3TM
     I              CCMKT1                          WAMKT1
     I              CCJHNY                          WAJHNY
     I              CCR1NA                          WAR1NA
     I              CCRHDT                          WARHDT
     I              CCC4TM                          WAC4TM
     I              CCMIT1                          WAMIT1
     I              CCMJT1                          WAMJT1
     I              CCHXTX                          WAHXTX
     I              CCHJTX                          WAHJTX
     I              CCHYTX                          WAHYTX
     I              CCJENY                          WAJENY
     I              CCJVNY                          WAJVNY
     I              CCJWNY                          WAJWNY
     I              CCIMTX                          WAIMTX
     I              CCFEDS                          WAFEDS
     I              CCMTT1                          WAMTT1
     I              CCJXNY                          WAJXNY
     I              CCJ1NY                          WAJ1NY
     I              CCJCNY                          WAJCNY
     I              CCJDNY                          WAJDNY
     I              CCJ3NY                          WAJ3NY
     I              CCRLDT                          WARLDT
     I              CCMSAA                          WAMSAA
     I              CCMTAA                          WAMTAA
     I              CCMUAA                          WAMUAA
     I              CCL8T1                          WAL8T1
     I              CCR0NY                          WAR0NY
     I              CCL7T1                          WAL7T1
     I              CCJQST                          WAJQST
     I              CCWUT1                          WAWUT1
     I              CCWVT1                          WAWVT1
     I              CCJZST                          WAJZST
     I              CCJ0ST                          WAJ0ST
     I              CCTTDT                          WATTDT
     I              CCDRTM                          WADRTM
     I              CCWYT1                          WAWYT1
     I              CCJUST                          WAJUST
     I              CCR4NY                          WAR4NY
     I              CCMZAA                          WAMZAA
     I              CCTUDT                          WATUDT
     I              CCDSTM                          WADSTM
     I              CCWZT1                          WAWZT1
     I              CCM0AA                          WAM0AA
     I              CCSANY                          WASANY
     I              CCKJST                          WAKJST
     I              CCKKST                          WAKKST
     I              CCGZPC                          WAGZPC
     I              CCW2T1                          WAW2T1
     I              CCM1AA                          WAM1AA
     I              CCSBNY                          WASBNY
     I              CCKLST                          WAKLST
     I              CCKPST                          WAKPST
     I              CCG0PC                          WAG0PC
     I              CCW3T1                          WAW3T1
     I              CCM2AA                          WAM2AA
     I              CCSCNY                          WASCNY
     I              CCKQST                          WAKQST
     I              CCKRST                          WAKRST
     I              CCG1PC                          WAG1PC
     I              CCW4T1                          WAW4T1
     I              CCVSST                          WAVSST
     I              CCMJDT                          WAMJDT
     I              CCBETM                          WABETM
     I              CCCCVN                          WACCVN
     I              CCCDVN                          WACDVN
     I              CCMKDT                          WAMKDT
     I              CCBFTM                          WABFTM
     I              CCCEVN                          WACEVN
     I              CCCFVN                          WACFVN
      *
     I@CAREOB
      * COA Property Define Hdr   Retrieval index
      * Renamed input format fields
     I              CAAIC3                          WBAIC3
     I              CAIDAA                          WBIDAA
     I              CAR2NA                          WBR2NA
     I              CAL2T1                          WBL2T1
     I              CAL3T1                          WBL3T1
     I              CAL4T1                          WBL4T1
     I              CAL5T1                          WBL5T1
     I              CAL6T1                          WBL6T1
     I              CAL7T1                          WBL7T1
     I              CAL8T1                          WBL8T1
     I              CAL9T1                          WBL9T1
     I              CAMAT1                          WBMAT1
     I              CAJCNY                          WBJCNY
     I              CAJDNY                          WBJDNY
     I              CAJENY                          WBJENY
     I              CAJFNY                          WBJFNY
     I              CAGMPC                          WBGMPC
     I              CAMBT1                          WBMBT1
     I              CAIEAA                          WBIEAA
     I              CAIFAA                          WBIFAA
     I              CAIGAA                          WBIGAA
     I              CAIHAA                          WBIHAA
     I              CAIIAA                          WBIIAA
     I              CAIJAA                          WBIJAA
     I              CAJQNY                          WBJQNY
     I              CALXST                          WBLXST
     I              CAJRNY                          WBJRNY
     I              CALYST                          WBLYST
     I              CAIMTX                          WBIMTX
     I              CAFEDS                          WBFEDS
     I              CAIBAA                          WBIBAA
     I              CAI1NY                          WBI1NY
     I              CAHCTU                          WBHCTU
     I              CAMCT1                          WBMCT1
     I              CAVSST                          WBVSST
     I              CAMJDT                          WBMJDT
     I              CABETM                          WBBETM
     I              CACCVN                          WBCCVN
     I              CACDVN                          WBCDVN
     I              CAMKDT                          WBMKDT
     I              CABFTM                          WBBFTM
     I              CACEVN                          WBCEVN
     I              CACFVN                          WBCFVN
      *
     I@DACPP8
      * COA Batch Header RIN      Co/ULSD/Batch/Order
      * Renamed input format fields
     I              DAAIC3                          WCAIC3
     I              DAL6T1                          WCL6T1
     I              DAI3NY                          WCI3NY
     I              DAJYNY                          WCJYNY
     I              DAQ1NY                          WCQ1NY
     I              DAMUT1                          WCMUT1
     I              DAJZNY                          WCJZNY
     I              DAJ0NY                          WCJ0NY
     I              DAJ2NY                          WCJ2NY
     I              DARIDT                          WCRIDT
     I              DAC5TM                          WCC5TM
     I              DAMVT1                          WCMVT1
     I              DAMWT1                          WCMWT1
     I              DARINT                          WCRINT
     I              DARJDT                          WCRJDT
     I              DAC6TM                          WCC6TM
     I              DAC4NB                          WCC4NB
     I              DADPNB                          WCDPNB
     I              DAUENB                          WCUENB
     I              DARZNB                          WCRZNB
     I              DANGT1                          WCNGT1
     I              DARMNB                          WCRMNB
     I              DARKDT                          WCRKDT
     I              DAC7TM                          WCC7TM
     I              DARINS                          WCRINS
     I              DAMXT1                          WCMXT1
     I              DAG3ST                          WCG3ST
     I              DAQWNY                          WCQWNY
     I              DAL0AA                          WCL0AA
     I              DAMAT1                          WCMAT1
     I              DATDNA                          WCTDNA
     I              DACWC3                          WCCWC3
     I              DAQXNY                          WCQXNY
     I              DAQZNY                          WCQZNY
     I              DAQ0NY                          WCQ0NY
     I              DALVTX                          WCLVTX
     I              DANYT1                          WCNYT1
     I              DAG5ST                          WCG5ST
     I              DAG7ST                          WCG7ST
     I              DATFDT                          WCTFDT
     I              DATGDT                          WCTGDT
     I              DAWIT1                          WCWIT1
     I              DAQYNY                          WCQYNY
     I              DAL7T1                          WCL7T1
     I              DAR8NY                          WCR8NY
     I              DAR0NY                          WCR0NY
     I              DAI7AA                          WCI7AA
     I              DAMXAA                          WCMXAA
     I              DAMSAA                          WCMSAA
     I              DAR7NY                          WCR7NY
     I              DAHEPR                          WCHEPR
     I              DAHFPR                          WCHFPR
     I              DAWVT1                          WCWVT1
     I              DAW0T1                          WCW0T1
     I              DAR5NY                          WCR5NY
     I              DAW1T1                          WCW1T1
     I              DAR6NY                          WCR6NY
     I              DAJ1ST                          WCJ1ST
     I              DAKHST                          WCKHST
     I              DATWDT                          WCTWDT
     I              DADUTM                          WCDUTM
     I              DAKGST                          WCKGST
     I              DATVDT                          WCTVDT
     I              DADTTM                          WCDTTM
     I              DAR9NY                          WCR9NY
     I              DASQNY                          WCSQNY
     I              DABHR3                          WCBHR3
     I              DASRNY                          WCSRNY
     I              DAW7T1                          WCW7T1
     I              DAW8T1                          WCW8T1
     I              DAT2DT                          WCT2DT
     I              DAVSST                          WCVSST
     I              DAMJDT                          WCMJDT
     I              DABETM                          WCBETM
     I              DACCVN                          WCCCVN
     I              DACDVN                          WCCDVN
     I              DAMKDT                          WCMKDT
     I              DABFTM                          WCBFTM
     I              DACEVN                          WCCEVN
     I              DACFVN                          WCCFVN
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                          WEAIC3
     I              FNC4NB                          WEC4NB
     I              FNDPNB                          WEDPNB
     I              FNUENB                          WEUENB
     I              FNRZNB                          WERZNB
     I              FNFOQT                          WEFOQT
     I              FNR0NB                          WER0NB
     I              FNPMST                          WEPMST
     I              FNK7DT                          WEK7DT
     I              FNPFNX                          WEPFNX
     I              FNHGCD                          WEHGCD
     I              FNAJCD                          WEAJCD
     I              FNELDT                          WEELDT
     I              FNN5WG                          WEN5WG
     I              FNRZNA                          WERZNA
     I              FNH5NY                          WEH5NY
     I              FNH6NY                          WEH6NY
     I              FNH7NY                          WEH7NY
     I              FNGBTX                          WEGBTX
     I              FNN6WG                          WEN6WG
     I              FNN7WG                          WEN7WG
     I              FNGCTX                          WEGCTX
     I              FNGDTX                          WEGDTX
     I              FNRBDT                          WERBDT
     I              FNITNY                          WEITNY
     I              FNIVNY                          WEIVNY
     I              FNIUNY                          WEIUNY
     I              FNIWNY                          WEIWNY
     I              FNIXNY                          WEIXNY
     I              FNIYNY                          WEIYNY
     I              FNUVST                          WEUVST
     I              FNUWST                          WEUWST
     I              FNUXST                          WEUXST
     I              FNVSST                          WEVSST
     I              FNAATM                          WEAATM
     I              FNAYNA                          WEAYNA
     I              FNA0NA                          WEA0NA
     I              FNAXDT                          WEAXDT
      *
     I@DPCPR2
      * RFS RIN Generation Rpt    Update index
      * Renamed input format fields
     I              DPNWT1                          WFNWT1
     I              DPLTTX                          WFLTTX
     I              DPLUTX                          WFLUTX
     I              DPNXT1                          WFNXT1
     I              DPNYT1                          WFNYT1
     I              DPI4AA                          WFI4AA
     I              DPNZT1                          WFNZT1
     I              DPLVTX                          WFLVTX
     I              DPI5AA                          WFI5AA
     I              DPN0T1                          WFN0T1
     I              DPK2NY                          WFK2NY
     I              DPK3NY                          WFK3NY
     I              DPK4NY                          WFK4NY
     I              DPN1T1                          WFN1T1
     I              DPI6AA                          WFI6AA
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
     IQPMDP1    E DSPMDPCPL0
      * UPD : RFS RIN Generation Rpt    Update index
      * Renamed input format fields
     I              DPNWT1                          WFNWT1
     I              DPLTTX                          WFLTTX
     I              DPLUTX                          WFLUTX
     I              DPNXT1                          WFNXT1
     I              DPNYT1                          WFNYT1
     I              DPI4AA                          WFI4AA
     I              DPNZT1                          WFNZT1
     I              DPLVTX                          WFLVTX
     I              DPI5AA                          WFI5AA
     I              DPN0T1                          WFN0T1
     I              DPK2NY                          WFK2NY
     I              DPK3NY                          WFK3NY
     I              DPK4NY                          WFK4NY
     I              DPN1T1                          WFN1T1
     I              DPI6AA                          WFI6AA
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * FLD: RFS RIN Generation Rpt
      * N :  RFS Report Form ID
     I                                        1   7 P2NWT1
      * I :  RFS Report Type
     I                                        8   8 P2LTTX
      * N :  RFS CBI
     I                                        9   9 P2LUTX
      * N :  RFS Report Date
     I                                       10  19 P2NXT1
      * I :  RFS Report Year
     I                                       20  23 P2NYT1
      * O :  RFS Company ID
     I                                       24  27 P2I4AA
      * I :  RFS Compliance Period
     I                                       28  29 P2LVTX
     IP3PARM      DS
      * N :  Date From             USR
     I                                    P   1   40P3JEDT
     IP4PARM      DS
      * N :  Date To               USR
     I                                    P   1   40P4JFDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2LTTX    PARM           WP0002  1        RFS Report Type
     C           P2NYT1    PARM           WP0003  4        RFS Report Year
     C           P2I4AA    PARM P2I4AA    WP0004  4        RFS Company ID
     C           P2LVTX    PARM           WP0005  2        RFS Compliance
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Crt RIN Genrt Rpt XF
      * F1110 - EPA Quarterly Reporting -- Report RFS0400
      *      RFS RIN Generation Report - send quarterly to the EPA
      * Q1 =  Jan - Mar (Due May 31)         Q2 = Apr - Jun (Due Aug 31)
      * Q3 =  Jul - Sep (Due Nov 30)         Q4 = Oct - Dec (Due Feb 28)
      * Per Internal Auditors 5/12/09 : Get Batch volume from the total a
      * shipped from the batch - instead of from what they enter when the
      * create the batch.
      * C0774 RMC 5/20/10 use ship co when going to OD
      * Set field values that wont change per batch:
     C                     MOVEL@CN,001   P2NWT1           RFS Report Form
     C                     MOVEL'N'       P2LUTX           RFS CBI
      * Format report date: MM/DD/YYYY
      *
     C                     MOVEL*BLANK    WN0001  7        Date 7A
      *
      * Clc Fmt Dt MM/DD/YYYY IF
      * Format input date as : MM/DD/YYYY
     C                     MOVEL*BLANK    WN0001           Date 7A
     C                     MOVEL##JDT     WN0001           Date 7A
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0001:ZQ WUT5TX    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0001:ZQ WUT8TX    P  90  Day (Alpha) USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * WRK.Year Code = PAR.Date In *YEAR
     C           ##JDT     ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
     C                     MOVELWUAYNX    WUNYTX           Year USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  '/':ZQ    WUN0TX    P      Month MM/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT8TX    CAT  '/':ZQ    WUN1TX    P      Day DD/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUN0TX    CAT  WUN1TX:ZQ WUN2TX    P      Month/Day MM/DD
     C                     Z-ADD*ZERO     ZQ      50
     C           WUN2TX    CAT  WUNYTX:ZQ P2NXT1    P      MMDDYYYY Usr
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTP2NYT1:ZQ WUUATX    P  90  Year Alpha (YY)
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WUUATX:ZQ WUMLT1    P      Text 3 Length U
      * Set Compliance From and To Dates
      * CASE: PAR.RFS Compliance Period is Quarter 1 (Jan-Mar)
     C           P2LVTX    IFEQ 'Q1'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0101':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0331':ZQ WUV6CD    P      Date To Alpha
     C                     ELSE
      * CASE: PAR.RFS Compliance Period is Quarter 2 (Apr-Jun)
     C           P2LVTX    IFEQ 'Q2'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0401':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0630':ZQ WUV6CD    P      Date To Alpha
     C                     ELSE
      * CASE: PAR.RFS Compliance Period is Quarter 3 (Jly-Sep)
     C           P2LVTX    IFEQ 'Q3'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0701':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '0930':ZQ WUV6CD    P      Date To Alpha
     C                     ELSE
      * CASE: PAR.RFS Compliance Period is Quarter 4 (Oct-Dec)
     C           P2LVTX    IFEQ 'Q4'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '1001':ZQ WUV5CD    P      Date From Alpha
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMLT1    CAT  '1231':ZQ WUV6CD    P      Date To Alpha
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVE WUV5CD    P3JEDT           Date From
     C                     MOVE WUV6CD    P4JFDT           Date To
      * Read COA Batch Header file and create records:
      * RTV Crt RFS RIN Gen Fl RT - COA Batch Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Crt RFS RIN Gen Fl RT - COA Batch Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002 10        RFS Production
     C                     Z-ADD*ZERO     WN0003  21       RFS Equivalence
     C                     MOVEL*BLANK    WN0004  6        RFS Renew Fuel
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WARHDT           COA Batch Produ
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP3JEDT    WARHDT           COA Batch Produ
      * Establish starting position
     C           KPSSA     SETLL@CCCPSC                    *
     C           KRSSA     READE@CCCPSC                  90*
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create 1 report for each BATCH of fuel generated.
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.COA Batch Production Date GE PAR.Date From
      *   |- c2    : DB1.COA Batch Production Date LE PAR.Date To
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WARHDT    IFGE P3JEDT                     *IF
     C           WARHDT    IFLE P4JFDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV for RFS EPA Rpts  RT - COA Property Define Hdr  * 
     C                     EXSR SBRVGN
      * Equiv value is stored as '15', so cvt to dec, and divide by 10 to
     C                     MOVE YL0007    YL0014           USR Number 2.0
     C           YL0014    DIV  10        WN0003           RFS Equivalence
      * Format Prod date as MM/DD/YYYY
      *
     C                     MOVEL*BLANK    WN0005  7        Date 7A
      *
      * Clc Fmt Dt MM/DD/YYYY IF
      * Format input date as : MM/DD/YYYY
     C                     MOVEL*BLANK    WN0005           Date 7A
     C                     MOVELWARHDT    WN0005           Date 7A
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0005:ZQ WUT5TX    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0005:ZQ WUT8TX    P  90  Day (Alpha) USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * WRK.Year Code = PAR.Date In *YEAR
     C           WARHDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
     C                     MOVELWUAYNX    WUNYTX           Year USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  '/':ZQ    WUN0TX    P      Month MM/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT8TX    CAT  '/':ZQ    WUN1TX    P      Day DD/  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUN0TX    CAT  WUN1TX:ZQ WUN2TX    P      Month/Day MM/DD
     C                     Z-ADD*ZERO     ZQ      50
     C           WUN2TX    CAT  WUNYTX:ZQ WN0002    P      MMDDYYYY Usr
      * Concat Renewable fuel type and feedstock
     C                     Z-ADD*ZERO     ZQ      50
     C           WAIMTX    CAT  WAFEDS:ZQ WN0004    P      RFS Renew Fuel
      * 5/13/09 Get Batch Volume from total shipped from the batch per au
      * Rtv RFS400-Batch Vol  RT - COA Batch Header RIN  * 
     C                     EXSR SCRVGN
      * ----------- Write 1 rcd per batch header -----------------
      * Crt RFS RIN Gnrtn Rpt CR - RFS RIN Generation Rpt  * 
     C                     EXSR SFCRRC
     C                     END                             *FI
     C           KRSSA     READE@CCCPSC                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     MOVELYL0005    P2I4AA           RFS Company ID
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV for RFS EPA Rpts  RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           COA Bio-dsl Fue
     C                     MOVEL*BLANK    YL0002           COA Producer Re
     C                     MOVEL*BLANK    YL0003           COA Employer ID
     C                     MOVEL*BLANK    YL0004           COA Sold From N
     C                     MOVEL*BLANK    YL0005           COA ULSD Compan
     C                     MOVEL*BLANK    YL0006           COA ULSD Facili
     C                     MOVEL*BLANK    YL0007           COA RIN Equival
     C                     MOVEL*BLANK    YL0008           COA RIN Renewab
     C                     MOVEL*BLANK    YL0009           COA RIN Type Fl
     C                     Z-ADD*ZERO     YL0010           COA Density Loa
     C                     Z-ADD*ZERO     YL0011           COA BOL Percent
     C                     MOVEL*BLANK    YL0012           COA RFS Renew F
     C                     MOVEL*BLANK    YL0013           COA RFS Rnwbl F
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBIDAA           COA Bio-diesel
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     MOVELWAIDAA    WBIDAA           COA Bio-diesel
      * Establish starting position
     C           KRSSB     CHAIN@CAREOB              90    *
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBR2NA    YL0001           COA Bio-dsl Fue
     C                     MOVELWBL2T1    YL0002           COA Producer Re
     C                     MOVELWBL3T1    YL0003           COA Employer ID
     C                     MOVELWBL5T1    YL0004           COA Sold From N
     C                     MOVELWBL6T1    YL0005           COA ULSD Compan
     C                     MOVELWBL7T1    YL0006           COA ULSD Facili
     C                     MOVELWBL8T1    YL0007           COA RIN Equival
     C                     MOVELWBL9T1    YL0008           COA RIN Renewab
     C                     MOVELWBMAT1    YL0009           COA RIN Type Fl
     C                     Z-ADDWBJCNY    YL0010           COA Density Loa
     C                     Z-ADDWBGMPC    YL0011           COA BOL Percent
     C                     MOVELWBIMTX    YL0012           COA RFS Renew F
     C                     MOVELWBFEDS    YL0013           COA RFS Rnwbl F
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv RFS400-Batch Vol  RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0015           Quantity Shippe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCL6T1    WQSC02           COA ULSD Compan
     C           *LIKE     DEFN WCI3NY    WQSC03           COA Batch Numbe
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           COA ULSD Compan
     C                     KFLD           WQSC03           COA Batch Numbe
      * Setup key
     C                     Z-ADDWAAIC3    WQSC01           Company Number
     C                     MOVELWAL6T1    WQSC02           COA ULSD Compan
     C                     Z-ADDWAI3NY    WQSC03           COA Batch Numbe
      * Establish starting position
     C           KRSSC     SETLL@DACPP8                    *
     C           KRSSC     READE@DACPP8                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.COA Retired RIN Reason Cd is *Blank
     C           WCRINT    IFEQ *BLANK                     *IF
      * RTV RFS0400 Btch Volum RT - Order Detail  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C           KRSSC     READE@DACPP8                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV RFS0400 Btch Volum RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Setup key
     C                     Z-ADDWCCWC3    WDAIC3           Company Number
     C                     Z-ADDWCC4NB    WDC4NB           Order Number
     C                     Z-ADDWCDPNB    WDDPNB           Order Sequence
     C                     Z-ADDWCUENB    WDUENB           Order Secondary
      * Establish starting position
     C           KRSSD     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WDGMST    IFEQ 'L'                        *IF
     C           WDGMST    OREQ 'A'
     C           WDGMST    OREQ 'C'
     C           WDGMST    OREQ 'R'
     C           WDGMST    OREQ 'E'
     C           WDGMST    OREQ 'H'
     C           WDGMST    OREQ 'I'
     C                     Z-ADD*ZERO     YL0016           Quantity Shippe
      * RTV HPB Gross Gall DtlRT - Manifest Detail  * 
     C                     EXSR SERVGN
     C                     ADD  YL0016    YL0015           Quantity Shippe
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV HPB Gross Gall DtlRT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSE02           Order Number
     C           *LIKE     DEFN WEDPNB    WQSE03           Order Sequence
     C           *LIKE     DEFN WEUENB    WQSE04           Order Secondary
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
     C                     KFLD           WQSE03           Order Sequence
     C                     KFLD           WQSE04           Order Secondary
      * Setup key
     C                     Z-ADDWDAIC3    WQSE01           Company Number
     C                     Z-ADDWDC4NB    WQSE02           Order Number
     C                     Z-ADDWDDPNB    WQSE03           Order Sequence
     C                     Z-ADDWDUENB    WQSE04           Order Secondary
      * Establish starting position
     C           KRSSE     SETLL@FNCPCT                    *
     C           KRSSE     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WEFOQT    YL0016           Quantity Shippe
     C           KRSSE     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt RFS RIN Gnrtn Rpt CR - RFS RIN Generation Rpt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DPCPR2
     C                     MOVELP2NWT1    WFNWT1           RFS Report Form
     C                     MOVELP2LTTX    WFLTTX           RFS Report Type
     C                     MOVELP2LUTX    WFLUTX           RFS CBI
     C                     MOVELP2NXT1    WFNXT1           RFS Report Date
     C                     MOVELP2NYT1    WFNYT1           RFS Report Year
     C                     MOVELYL0005    WFI4AA           RFS Company ID
     C                     MOVELYL0004    WFNZT1           RFS Company Nam
     C                     MOVELP2LVTX    WFLVTX           RFS Compliance
     C                     MOVELYL0006    WFI5AA           RFS Compliance
     C                     MOVELWN0002    WFN0T1           RFS Production
     C                     Z-ADDWN0003    WFK2NY           RFS Equivalence
     C                     Z-ADDYL0015    WFK3NY           RFS Batch Volum
     C                     Z-ADDWAJWNY    WFK4NY           RFS Denaturant
     C                     MOVELWAMTT1    WFN1T1           RFS Renew ID Nb
     C                     MOVELWN0004    WFI6AA           RFS Renew Fuel
      *
     C           KLCRSF    KLIST
     C                     KFLD           WFNWT1           RFS Report Form
     C                     KFLD           WFLTTX           RFS Report Type
     C                     KFLD           WFLUTX           RFS CBI
     C                     KFLD           WFNXT1           RFS Report Date
     C                     KFLD           WFNYT1           RFS Report Year
     C                     KFLD           WFI4AA           RFS Company ID
     C                     KFLD           WFNZT1           RFS Company Nam
     C                     KFLD           WFLVTX           RFS Compliance
     C                     KFLD           WFI5AA           RFS Compliance
     C                     KFLD           WFN0T1           RFS Production
     C                     KFLD           WFK2NY           RFS Equivalence
     C                     KFLD           WFK3NY           RFS Batch Volum
      * Check for duplicate primary key
     C           KLCRSF    SETLL@DPCPR2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3916' W0RTN   7
      * Send message 'RFS RIN Generation Rpt EX'
     C                     MOVEL'USR3916' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@DPCPR2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2NWT1           RFS Report Form
     C                     MOVEL*BLANK    P2LUTX           RFS CBI
     C                     MOVEL*BLANK    P2NXT1           RFS Report Date
     C                     Z-ADD*ZERO     P3JEDT           Date From
     C                     Z-ADD*ZERO     P4JFDT           Date To
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Month (Char) USR
     C                     MOVEL*BLANK    WUT5TX  2
      * Define work field Day (Alpha) USR
     C                     MOVEL*BLANK    WUT8TX  2
      * Define work field Year Code
     C                     Z-ADD*ZERO     WUAYNX  40
      * Define work field Year USR
     C                     MOVEL*BLANK    WUNYTX  4
      * Define work field Month MM/  3A
     C                     MOVEL*BLANK    WUN0TX  3
      * Define work field Day DD/  3A
     C                     MOVEL*BLANK    WUN1TX  3
      * Define work field Month/Day MM/DD/
     C                     MOVEL*BLANK    WUN2TX  6
      * Define work field Year Alpha (YY) USR
     C                     MOVEL*BLANK    WUUATX  2
      * Define work field Text 3 Length USR
     C                     MOVEL*BLANK    WUMLT1  3
      * Define work field Date From Alpha       USR
     C                     MOVEL*BLANK    WUV5CD  7
      * Define work field Date To Alpha         USR
     C                     MOVEL*BLANK    WUV6CD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WARFDT           COA Date Open f
     C                     Z-ADD*ZERO     WAC2TM           COA Time Open f
     C                     Z-ADD*ZERO     WARGDT           COA Date Close
     C                     Z-ADD*ZERO     WAC3TM           COA Time Close
     C                     Z-ADD*ZERO     WAJHNY           COA Gallons Use
     C                     Z-ADD*ZERO     WARHDT           COA Batch Produ
     C                     Z-ADD*ZERO     WAC4TM           COA Batch Unuse
     C                     Z-ADD*ZERO     WAJENY           COA Temperature
     C                     Z-ADD*ZERO     WAJVNY           COA Batch Volum
     C                     Z-ADD*ZERO     WAJWNY           COA Batch Denat
     C                     Z-ADD*ZERO     WAJXNY           COA Batch Expor
     C                     Z-ADD*ZERO     WAJ1NY           COA Last RIN EE
     C                     Z-ADD*ZERO     WAJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WAJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WAJ3NY           COA RIN Equival
     C                     Z-ADD*ZERO     WARLDT           COA Batch Unuse
     C                     Z-ADD*ZERO     WAR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WATTDT           COA BH EMTS Dat
     C                     Z-ADD*ZERO     WADRTM           COA BH EMTS Tim
     C                     Z-ADD*ZERO     WAR4NY           COA BH Unused N
     C                     Z-ADD*ZERO     WATUDT           COA BH Unused D
     C                     Z-ADD*ZERO     WADSTM           COA BH Unused T
     C                     Z-ADD*ZERO     WASANY           COA BH Feedstck
     C                     Z-ADD*ZERO     WAGZPC           COA BH Feedstck
     C                     Z-ADD*ZERO     WASBNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WAG0PC           COA BH Feedstck
     C                     Z-ADD*ZERO     WASCNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WAG1PC           cOA BH Feedstck
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WBJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WBJENY           COA Temperature
     C                     Z-ADD*ZERO     WBJFNY           COA Temperature
     C                     Z-ADD*ZERO     WBGMPC           COA BOL Percent
     C                     Z-ADD*ZERO     WBJQNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WBJRNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WBI1NY           Sold To Custome
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WCJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WCQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WCJZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WCJ0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WCJ2NY           COA RIN Volume
     C                     Z-ADD*ZERO     WCRIDT           COA RIN Transac
     C                     Z-ADD*ZERO     WCC5TM           COA RIN Transac
     C                     Z-ADD*ZERO     WCRJDT           COA Retired RIN
     C                     Z-ADD*ZERO     WCC6TM           COA Retired RIN
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRKDT           COA Date of 1st
     C                     Z-ADD*ZERO     WCC7TM           COA RIN Unused
     C                     Z-ADD*ZERO     WCQWNY           COA RIN Gallons
     C                     Z-ADD*ZERO     WCCWC3           COA Shipping Co
     C                     Z-ADD*ZERO     WCQXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     WCQZNY           COA Reference B
     C                     Z-ADD*ZERO     WCQ0NY           COA Reference B
     C                     Z-ADD*ZERO     WCTFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     WCTGDT           COA BHR Unused
     C                     Z-ADD*ZERO     WCQYNY           COA BHR Loadout
     C                     Z-ADD*ZERO     WCR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     WCR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WCR7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WCHEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     WCHFPR           COA BHR Gallon
     C                     Z-ADD*ZERO     WCR5NY           COA RIN Support
     C                     Z-ADD*ZERO     WCR6NY           COA RIN Support
     C                     Z-ADD*ZERO     WCTWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     WCDUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     WCTVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     WCDTTM           COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WCR9NY           COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WCSQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     WCSRNY           COA BHR Unused
     C                     Z-ADD*ZERO     WCT2DT           COA BHR Unused
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WDDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WDDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WDGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WERZNB           Case Sequence N
     C                     Z-ADD*ZERO     WEFOQT           Case Quantity
     C                     Z-ADD*ZERO     WER0NB           Case Weight
     C                     Z-ADD*ZERO     WEK7DT           Label Date
     C                     Z-ADD*ZERO     WEPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WEH5NY           Manifest Total
     C                     Z-ADD*ZERO     WEH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WEH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WEN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WEN7WG           Manifest Unused
     C                     Z-ADD*ZERO     WERBDT           Manifest Unused
     C                     Z-ADD*ZERO     WEITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WEIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WEIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WEIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WEIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WEIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFK2NY           RFS Equivalence
     C                     Z-ADD*ZERO     WFK3NY           RFS Batch Volum
     C                     Z-ADD*ZERO     WFK4NY           RFS Denaturant
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field COA Bio-dsl Fuel Cd Descr
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field COA Producer Regist Nbr
     C                     MOVEL*BLANK    YL0002 25
      * Define local work field COA Employer ID
     C                     MOVEL*BLANK    YL0003 20
      * Define local work field COA Sold From Name
     C                     MOVEL*BLANK    YL0004 40
      * Define local work field COA ULSD Company #
     C                     MOVEL*BLANK    YL0005  4
      * Define local work field COA ULSD Facility #
     C                     MOVEL*BLANK    YL0006  5
      * Define local work field COA RIN Equivalence Valu
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field COA RIN Renewable Enrgy
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field COA RIN Type Flag
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field COA Density Loadout
     C                     Z-ADD*ZERO     YL0010  75
      * Define local work field COA BOL Percent
     C                     Z-ADD*ZERO     YL0011  41
      * Define local work field COA RFS Renew Fuel Code
     C                     MOVEL*BLANK    YL0012  3
      * Define local work field COA RFS Rnwbl Feedstock
     C                     MOVEL*BLANK    YL0013  3
      * Define local work field USR Number 2.0
     C                     Z-ADD*ZERO     YL0014  20
      * Define local work field Quantity Shipped Total
     C                     Z-ADD*ZERO     YL0015 112
      * Define local work field Quantity Shipped Total
     C                     Z-ADD*ZERO     YL0016 112
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 RFS0400
00002 1111111
