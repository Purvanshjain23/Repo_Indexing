// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBKRXFR
// ?Date: 14.08.2025 Time: 03:48:20
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(RTV PRT ManSumm-Sales  IF) TYPE(EXCINTFUN)                     AC2083973;
PARAMETER(1);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.AR_Customer_Number);
PARAMETER(PAR.Warehouse_Type);
PARAMETER(PAR.Manifest_Type_STS);
PARAMETER(PAR.PRT_Description);
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.PRT_Night_Queue_Run_Sts);
PARAMETER(PAR.PRT_Night_Queue);
PARAMETER(PAR.System_Value_Numeric);
PARAMETER(PAR.Broker_Code);
PARAMETER(PAR.Email_Address);
PARAMETER(PAR.Date_MM_DD_YYYY_USR);
PARAMETER(PAR.Date_mm_dd_yyyy_USR);
{
 //?Execute internal function

 EXECUTE FUNCTION(RTV PRT ManSumm-Sales  RT) TYPE(RTVOBJ) FILE(PMD4CPP)          AC2083965;
 PARAMETER(PAR.Order_Number);
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.AR_Customer_Number);
 PARAMETER(PAR.Warehouse_Type);
 PARAMETER(PAR.Manifest_Type_STS);
 PARAMETER(PAR.PRT_Description);
 PARAMETER(PAR.PRT_Printer_Device);
 PARAMETER(PAR.PRT_Hold_Output_Sts);
 PARAMETER(PAR.PRT_Save_Output_Sts);
 PARAMETER(PAR.PRT_Night_Queue_Run_Sts);
 PARAMETER(PAR.PRT_Night_Queue);
 PARAMETER(PAR.System_Value_Numeric);
 PARAMETER(PAR.Broker_Code);
 PARAMETER(PAR.Email_Address);
 PARAMETER(PAR.Date_MM_DD_YYYY_USR);
 PARAMETER(PAR.Date_mm_dd_yyyy_USR);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PAR.Pager Msg 256 USR = CON.*BLANK
  PAR.Pager_Msg_256_USR = *BLANK;

  // PAR.Subject Line USR = CON.*BLANK
  PAR.Subject_Line_USR = *BLANK;

  //?* Format the Subject Line and the Message
  // PAR.Text USR 7 = CVTVAR(DB1.A/R Customer Number)
  PAR.Text_USR_7 = CVTVAR(DB1.AR_Customer_Number);

  // WRK.Company Number Alpha = CVTVAR(PAR.Company Number)
  WRK.Company_Number_Alpha = CVTVAR(PAR.Company_Number);

  //?**  Esend will only accept 60 characters for the Subject line
  // PAR.Subject Line USR = CONCAT(PAR.Date MM/DD/YYYY     USR,CON.thru,CON.1)
  PAR.Subject_Line_USR = PAR.Date_MM_DD_YYYY_USR + 'thru' (1);

  // PAR.Subject Line USR = CONCAT(PAR.Subject Line USR,PAR.Date mm/dd/yyyy USR,CON.1)
  PAR.Subject_Line_USR = PAR.Subject_Line_USR + PAR.Date_mm_dd_yyyy_USR (1);

  // PAR.Message USR = PAR.Subject Line USR
  PAR.Message_USR = PAR.Subject_Line_USR;

  // PAR.Pager Msg 256 USR = PAR.Message USR
  PAR.Pager_Msg_256_USR = PAR.Message_USR;

  // PAR.Subject Line USR = CONCAT(PAR.Subject Line USR,CON.For Co.,CON.1)
  PAR.Subject_Line_USR = PAR.Subject_Line_USR + 'For Co.' (1);

  // PAR.Subject Line USR = CONCAT(PAR.Subject Line USR,WRK.Company Number Alpha,CON.1)
  PAR.Subject_Line_USR = PAR.Subject_Line_USR + WRK.Company_Number_Alpha (1);

  // PAR.Subject Line USR = CONCAT(PAR.Subject Line USR,CON., Cust.,CON.*ZERO)
  PAR.Subject_Line_USR = PAR.Subject_Line_USR + ', Cust.' (0);

  // PAR.Subject Line USR = CONCAT(PAR.Subject Line USR,PAR.Text USR 7,CON.1)
  PAR.Subject_Line_USR = PAR.Subject_Line_USR + PAR.Text_USR_7 (1);

  // PAR.Message USR = PAR.Pager Msg 256 USR
  PAR.Message_USR = PAR.Pager_Msg_256_USR;

  // PAR.Order Number Alpha = CVTVAR(DB1.Order Number)
  PAR.Order_Number_Alpha = CVTVAR(DB1.Order_Number);

  // PAR.Message Line 2 = CONCAT(CON.PO/Order#:,DB1.Customer Purchase Order #,CON.1)
  PAR.Message_Line_2 = 'PO/Order#:' + DB1.Customer_Purchase_Order_# (1);

  // PAR.Message USR = CONCAT(PAR.Message USR,PAR.Message Line 2,CON.1)
  PAR.Message_USR = PAR.Message_USR + PAR.Message_Line_2 (1);

  // PAR.Message USR = CONCAT(PAR.Message USR,PAR.Order Number Alpha,CON.1)
  PAR.Message_USR = PAR.Message_USR + PAR.Order_Number_Alpha (1);

  // PAR.Pager Msg 256 USR = PAR.Message USR
  PAR.Pager_Msg_256_USR = PAR.Message_USR;

  // PAR.Order Number 1  PASS  USR = DB1.Order Number
  PAR.Order_Number_1_PASS_USR = DB1.Order_Number;

  // PAR.Company Number Pass   USR = DB1.Company Number
  PAR.Company_Number_Pass_USR = DB1.Company_Number;

  //?Assign print file based on Report Type (Sales Summary or Detail) E003081
  CASE;

  // IF PAR.Manifest Type STS is Sales Summary
  IF PAR.Manifest_Type_STS = 'SS';

  // OR PAR.Manifest Type STS is Sales Detail
  OR PAR.Manifest_Type_STS = 'SD';

  // LCL.Spool File Selection = CON.OMD0PFR$
  LCL.Spool_File_Selection = 'OMD0PFR$';

  //?Assign print file based on Report Type (Sales Summary or Detail) E003081
  // IF PAR.Manifest Type STS is Customer Detail
  IF PAR.Manifest_Type_STS = 'CD';

  // LCL.Spool File Selection = CON.OMDZPFR$
  LCL.Spool_File_Selection = 'OMDZPFR$';

  ENDIF;

  //?* Print then email the report
  // Call program PRT Manifest for Japan UP.
  CALL PROGRAM(PRT Manifest for Japan UP) ('PBLNUPC');
  PARAMETER(LCL.Return_Code_Usr);
  PARAMETER('OMS');
  PARAMETER('OMD0PCLP');
  PARAMETER(PAR.PRT_Description);
  PARAMETER(PAR.PRT_Printer_Device);
  PARAMETER(PAR.PRT_Hold_Output_Sts);
  PARAMETER(PAR.PRT_Save_Output_Sts);
  PARAMETER(PAR.PRT_Night_Queue_Run_Sts);
  PARAMETER(PAR.PRT_Night_Queue);
  PARAMETER(PAR.Company_Number_Pass_USR);
  PARAMETER(PAR.Order_Number_1_PASS_USR);
  PARAMETER(PAR.System_Value_Numeric);
  PARAMETER(PAR.Manifest_Type_STS);
  PARAMETER(PAR.Email_Address);
  PARAMETER(PAR.Subject_Line_USR);
  PARAMETER(PAR.Message_USR);
  PARAMETER(LCL.Spool_File_Selection);

 }

}


