/*********************************************************************/
/* PROGRAM : PUDPUPC                                                 */
/* DESC    : PRT IN TRANSIT ORDERS  CL EXECUTE USER PROGRAM          */
/* DATE    : 07/31/2017                                              */
/* PROJECT : T11041 - 3PL EDI TRANSACTION                            */
/* BY      : DANNY NGUYEN                                            */
/* PURPOSE : Call SEQUEL to print In Transit Orders for EDI 943      */
/*           transactions as excel via email.                        */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE     BY  CHANGE DESCRIPTION                                   */
/* -------- --- ---------------------------------------------------- */
/* MM/DD/YY xxx Project ID. Desc                                     */
/*                                                                   */
/*********************************************************************/

             PGM        PARM(&FMDTEA &TODTEA &COMP &WHSFM &WHSTO &EMAIL)

             DCL        VAR(&FMDTEA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FMDTE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&TODTEA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TODTE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&COMPA) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSFM) TYPE(*CHAR) LEN(3)
             DCL        VAR(&WHSFM2) TYPE(*CHAR) LEN(5)
             DCL        VAR(&WHSTO) TYPE(*CHAR) LEN(3)
             DCL        VAR(&RTNLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EMLMSG) TYPE(*CHAR) LEN(90) +
                          VALUE('Shipped Warehouse Transfer In +
                          Transit-EDI: For To Whse')

    /* Format Data */
             CHGVAR     VAR(&FMDTE) VALUE(&FMDTEA)
             CHGVAR     VAR(&TODTE) VALUE(&TODTEA)
             CHGVAR     VAR(&COMPA) VALUE(&COMP)
             IF         COND(&WHSFM *NE ' ') THEN(DO)
             CHGVAR     VAR(&WHSFM2) VALUE(&WHSFM)
             ENDDO
             ELSE       CMD(DO)
             CHGVAR     VAR(&WHSFM2) VALUE('*ALL')
             ENDDO

/*-------------------------------------------------------------------*/
/* Create Excel Spreadsheet with SEQUEL Viewpoint and email to       */
/* receipient.                                                       */
/*-------------------------------------------------------------------*/
    /* Concat To Warehouse to the Email Msg */
             CHGVAR     VAR(&EMLMSG) VALUE(&EMLMSG *BCAT &WHSTO)

    /* If INTRANSIT return library not PRKPLIB then set 'TEST' in Email Msg */
             RTVOBJD    OBJ(INTRANSIT) OBJTYPE(*USRSPC) RTNLIB(&RTNLIB)
             IF         COND(&RTNLIB *NE 'PRKPLIB') THEN(DO)
             CHGVAR     VAR(&EMLMSG) VALUE(&EMLMSG *BCAT '- TEST')
             ENDDO

             EXECUTE    VIEW(INTRANSIT) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&EMLMSG) +
                          SETVAR((&FMDTE &FMDTEA) (&TODTE &TODTEA) +
                          (&COMP &COMPA) (&WHSFM &WHSFM2) (&WHSTO +
                          &WHSTO))

 ENDPGM:
             ENDPGM
