     H/TITLE PFS Order Header      XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 07/12/19  Time  : 10:24:01
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPOBIREL1IF  E           K        DISK
      * RTV : Customer Item Reference   Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPPBCCPL1IF  E           K        DISK
      * RTV : PFS Order Detail          Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FPPBDCPL1IF  E           K        DISK
      * RTV : PFS Order BOL Comment     Retrieval index
      *
     FOPCOCPL1IF  E           K        DISK
      * RTV : Order Comment             Retrieval index       NV
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPPB1REL1IF  E           K        DISK
      * RTV : Country Comment           Retrieval index
      *
     FPOAVCPL1IF  E           K        DISK
      * RTV : Customer Comment          Retrieval index
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FPPBBCPL1IF  E           K        DISK
      * RTV : PFS Order Header          Retrieval index
      *
     FPPBCCPL0UF  E           K        DISK                      A
      * UPD : PFS Order Detail          Update index
      *
     FPPBDCPL0UF  E           K        DISK                      A
      * UPD : PFS Order BOL Comment     Update index
      *
     FPPBBCPL0UF  E           K        DISK                      A
      * UPD : PFS Order Header          Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WAAIC3
     I              KMV8CD                          WAV8CD
     I              KMAUNA                          WAAUNA
     I              KMI5ST                          WAI5ST
     I              KMBXTX                          WABXTX
     I              KMM8NB                          WAM8NB
     I              KMUVST                          WAUVST
     I              KMUWST                          WAUWST
     I              KMUXST                          WAUXST
     I              KMVSST                          WAVSST
     I              KMAATM                          WAAATM
     I              KMAYNA                          WAAYNA
     I              KMA0NA                          WAA0NA
     I              KMAXDT                          WAAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WEBKC7
     I              BBAYTX                          WEAYTX
     I              BBACNA                          WEACNA
     I              BBADNA                          WEADNA
     I              BBAENA                          WEAENA
     I              BBAJNA                          WEAJNA
     I              BBBGCD                          WEBGCD
     I              BBG5CD                          WEG5CD
     I              BBBTTX                          WEBTTX
     I              BBBVTX                          WEBVTX
     I              BBBWTX                          WEBWTX
     I              BBABTX                          WEABTX
     I              BBA2NA                          WEA2NA
     I              BBCBST                          WECBST
     I              BBB0NA                          WEB0NA
     I              BBP3NB                          WEP3NB
     I              BBAXNA                          WEAXNA
     I              BBI6DT                          WEI6DT
     I              BBAYDT                          WEAYDT
     I              BBANC7                          WEANC7
     I              BBBTC7                          WEBTC7
     I              BBK6ST                          WEK6ST
     I              BBUZST                          WEUZST
     I              BBKXCD                          WEKXCD
     I              BBLTCD                          WELTCD
     I              BBQNST                          WEQNST
     I              BBS2NB                          WES2NB
     I              BBVHVA                          WEVHVA
     I              BBI7DT                          WEI7DT
     I              BBRJST                          WERJST
     I              BBRKST                          WERKST
     I              BBQWST                          WEQWST
     I              BBQXST                          WEQXST
     I              BBQYST                          WEQYST
     I              BBUNCS                          WEUNCS
     I              BBUVST                          WEUVST
     I              BBUWST                          WEUWST
     I              BBUXST                          WEUXST
     I              BBVSST                          WEVSST
     I              BBAATM                          WEAATM
     I              BBAYNA                          WEAYNA
     I              BBA0NA                          WEA0NA
     I              BBAXDT                          WEAXDT
      *
     I@BIREKY
      * Customer Item Reference   Retrieval index
      * Renamed input format fields
     I              BIBKC7                          WFBKC7
     I              BIHGCD                          WFHGCD
     I              BICOAA                          WFCOAA
     I              BICPAA                          WFCPAA
     I              BIPSNA                          WFPSNA
     I              BIPTNA                          WFPTNA
     I              BIPUNA                          WFPUNA
     I              BILBSX                          WFLBSX
     I              BILCSX                          WFLCSX
     I              BILDSX                          WFLDSX
     I              BILESX                          WFLESX
     I              BILFSX                          WFLFSX
     I              BIVSST                          WFVSST
     I              BIMJDT                          WFMJDT
     I              BIBETM                          WFBETM
     I              BICCVN                          WFCCVN
     I              BICDVN                          WFCDVN
     I              BIMKDT                          WFMKDT
     I              BIBFTM                          WFBFTM
     I              BICEVN                          WFCEVN
     I              BICFVN                          WFCFVN
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WGAIC3
     I              EOBKC7                          WGBKC7
     I              EOAQCD                          WGAQCD
     I              EOR4CD                          WGR4CD
     I              EOBYNA                          WGBYNA
     I              EOB6NA                          WGB6NA
     I              EOBZNA                          WGBZNA
     I              EOLLST                          WGLLST
     I              EOPPST                          WGPPST
     I              EOR5NB                          WGR5NB
     I              EOR6NB                          WGR6NB
     I              EOQGST                          WGQGST
     I              EOBOCD                          WGBOCD
     I              EOTBNB                          WGTBNB
     I              EOMTCU                          WGMTCU
     I              EOW2NB                          WGW2NB
     I              EORPCD                          WGRPCD
     I              EOAJCD                          WGAJCD
     I              EOX9ST                          WGX9ST
     I              EOT9CD                          WGT9CD
     I              EOUBCD                          WGUBCD
     I              EOISTX                          WGISTX
     I              EOLQCD                          WGLQCD
     I              EONJNA                          WGNJNA
     I              EOI0TX                          WGI0TX
     I              EONKNA                          WGNKNA
     I              EOI1TX                          WGI1TX
     I              EOVLST                          WGVLST
     I              EORLST                          WGRLST
     I              EOMMTX                          WGMMTX
     I              EOOHNA                          WGOHNA
     I              EOQ6ST                          WGQ6ST
     I              EOQ8ST                          WGQ8ST
     I              EORBST                          WGRBST
     I              EOREST                          WGREST
     I              EOUVST                          WGUVST
     I              EOUWST                          WGUWST
     I              EOUXST                          WGUXST
     I              EOVSST                          WGVSST
     I              EOAATM                          WGAATM
     I              EOAYNA                          WGAYNA
     I              EOA0NA                          WGA0NA
     I              EOAXDT                          WGAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WHAIC3
     I              AFBCDT                          WHBCDT
     I              AFCQNB                          WHCQNB
     I              AFESNB                          WHESNB
     I              AFETNB                          WHETNB
     I              AFBZNB                          WHBZNB
     I              AFA9ST                          WHA9ST
     I              AFEINB                          WHEINB
     I              AFC5ST                          WHC5ST
     I              AFAQNB                          WHAQNB
     I              AFCMST                          WHCMST
     I              AFV9ST                          WHV9ST
     I              AFWAST                          WHWAST
     I              AFX2ST                          WHX2ST
     I              AFOJDT                          WHOJDT
     I              AFNQNX                          WHNQNX
     I              AFNRNX                          WHNRNX
     I              AFI9SX                          WHI9SX
     I              AFJASX                          WHJASX
     I              AFOKDT                          WHOKDT
     I              AFOLDT                          WHOLDT
     I              AFUVST                          WHUVST
     I              AFUWST                          WHUWST
     I              AFUXST                          WHUXST
     I              AFAATM                          WHAATM
     I              AFAYNA                          WHAYNA
     I              AFA0NA                          WHA0NA
     I              AFAXDT                          WHAXDT
      *
     I@IORETI
      * Item Bill Of Material     Retrieval index
      * Renamed input format fields
     I              IOAIC3                          WIAIC3
     I              IOHGCD                          WIHGCD
     I              IOC9NB                          WIC9NB
     I              IOV2ST                          WIV2ST
     I              IOBOPR                          WIBOPR
     I              IOBPPR                          WIBPPR
     I              IOHGQT                          WIHGQT
     I              IOHHCD                          WIHHCD
     I              IOYAST                          WIYAST
     I              IOCNSM                          WICNSM
     I              IOBMY1                          WIBMY1
     I              IOBMY2                          WIBMY2
     I              IOIXQT                          WIIXQT
     I              IOIYQT                          WIIYQT
     I              IORSST                          WIRSST
     I              IORTST                          WIRTST
     I              IOUVST                          WIUVST
     I              IOUWST                          WIUWST
     I              IOUXST                          WIUXST
     I              IOVSST                          WIVSST
     I              IOAATM                          WIAATM
     I              IOAYNA                          WIAYNA
     I              IOA0NA                          WIA0NA
     I              IOAXDT                          WIAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WJAIC3
     I              BZHGCD                          WJHGCD
     I              BZAVNA                          WJAVNA
     I              BZAWNA                          WJAWNA
     I              BZL7NA                          WJL7NA
     I              BZL8NA                          WJL8NA
     I              BZL6NA                          WJL6NA
     I              BZMFNA                          WJMFNA
     I              BZADCD                          WJADCD
     I              BZAWPC                          WJAWPC
     I              BZLXST                          WJLXST
     I              BZAECD                          WJAECD
     I              BZAXPC                          WJAXPC
     I              BZLYST                          WJLYST
     I              BZAFCD                          WJAFCD
     I              BZAICD                          WJAICD
     I              BZAIWG                          WJAIWG
     I              BZHICD                          WJHICD
     I              BZRBCD                          WJRBCD
     I              BZFZST                          WJFZST
     I              BZAVST                          WJAVST
     I              BZCZWG                          WJCZWG
     I              BZC0WG                          WJC0WG
     I              BZURTN                          WJURTN
     I              BZAJC8                          WJAJC8
     I              BZRINB                          WJRINB
     I              BZRHNB                          WJRHNB
     I              BZRGNB                          WJRGNB
     I              BZLNCD                          WJLNCD
     I              BZTFNB                          WJTFNB
     I              BZN0CD                          WJN0CD
     I              BZX4ST                          WJX4ST
     I              BZTMVA                          WJTMVA
     I              BZTNVA                          WJTNVA
     I              BZBLPR                          WJBLPR
     I              BZBMPR                          WJBMPR
     I              BZLRCD                          WJLRCD
     I              BZU9ST                          WJU9ST
     I              BZCMCO                          WJCMCO
     I              BZQ1CD                          WJQ1CD
     I              BZQ8CD                          WJQ8CD
     I              BZCHTM                          WJCHTM
     I              BZQZCD                          WJQZCD
     I              BZXWST                          WJXWST
     I              BZXXST                          WJXXST
     I              BZVMST                          WJVMST
     I              BZSWGH                          WJSWGH
     I              BZPPHE                          WJPPHE
     I              BZR3CD                          WJR3CD
     I              BZSDCD                          WJSDCD
     I              BZICN1                          WJICN1
     I              BZSVCD                          WJSVCD
     I              BZICN2                          WJICN2
     I              BZSWCD                          WJSWCD
     I              BZV2NB                          WJV2NB
     I              BZSXCD                          WJSXCD
     I              BZITCN                          WJITCN
     I              BZSYCD                          WJSYCD
     I              BZITC5                          WJITC5
     I              BZSZCD                          WJSZCD
     I              BZICN6                          WJICN6
     I              BZS0CD                          WJS0CD
     I              BZICN7                          WJICN7
     I              BZS1CD                          WJS1CD
     I              BZICN8                          WJICN8
     I              BZS2CD                          WJS2CD
     I              BZICN9                          WJICN9
     I              BZS3CD                          WJS3CD
     I              BZICN0                          WJICN0
     I              BZS4CD                          WJS4CD
     I              BZSFNB                          WJSFNB
     I              BZA3WG                          WJA3WG
     I              BZSJNB                          WJSJNB
     I              BZLLCD                          WJLLCD
     I              BZLMCD                          WJLMCD
     I              BZP3ST                          WJP3ST
     I              BZSKNB                          WJSKNB
     I              BZSLNB                          WJSLNB
     I              BZSMNB                          WJSMNB
     I              BZP4ST                          WJP4ST
     I              BZCFNB                          WJCFNB
     I              BZCGNB                          WJCGNB
     I              BZILNB                          WJILNB
     I              BZCHNB                          WJCHNB
     I              BZCINB                          WJCINB
     I              BZCJNB                          WJCJNB
     I              BZCMNB                          WJCMNB
     I              BZCNNB                          WJCNNB
     I              BZCRNB                          WJCRNB
     I              BZCSNB                          WJCSNB
     I              BZCVNB                          WJCVNB
     I              BZCWNB                          WJCWNB
     I              BZCXNB                          WJCXNB
     I              BZCZNB                          WJCZNB
     I              BZC0NB                          WJC0NB
     I              BZN1CD                          WJN1CD
     I              BZB4NB                          WJB4NB
     I              BZB5NB                          WJB5NB
     I              BZX5ST                          WJX5ST
     I              BZX6ST                          WJX6ST
     I              BZX7ST                          WJX7ST
     I              BZPCCT                          WJPCCT
     I              BZBDNB                          WJBDNB
     I              BZBJNB                          WJBJNB
     I              BZSUST                          WJSUST
     I              BZSVST                          WJSVST
     I              BZSYST                          WJSYST
     I              BZSZST                          WJSZST
     I              BZS1ST                          WJS1ST
     I              BZXRCD                          WJXRCD
     I              BZXTCD                          WJXTCD
     I              BZXUCD                          WJXUCD
     I              BZF5WG                          WJF5WG
     I              BZF6WG                          WJF6WG
     I              BZF7WG                          WJF7WG
     I              BZBLNB                          WJBLNB
     I              BZBNNB                          WJBNNB
     I              BZS2ST                          WJS2ST
     I              BZS4ST                          WJS4ST
     I              BZS5ST                          WJS5ST
     I              BZS6ST                          WJS6ST
     I              BZS8ST                          WJS8ST
     I              BZS9ST                          WJS9ST
     I              BZTCST                          WJTCST
     I              BZTDST                          WJTDST
     I              BZUVST                          WJUVST
     I              BZUWST                          WJUWST
     I              BZUXST                          WJUXST
     I              BZVSST                          WJVSST
     I              BZAATM                          WJAATM
     I              BZAYNA                          WJAYNA
     I              BZA0NA                          WJA0NA
     I              BZAXDT                          WJAXDT
      *
     I@BCCPZP
      * PFS Order Detail          Retrieval index
      * Renamed input format fields
     I              BCY1NX                          WKY1NX
     I              BCZPNX                          WKZPNX
     I              BCZXNX                          WKZXNX
     I              BCZYNX                          WKZYNX
     I              BCY2NX                          WKY2NX
     I              BCGIT1                          WKGIT1
     I              BCGGT1                          WKGGT1
     I              BCGHT1                          WKGHT1
     I              BCVFSX                          WKVFSX
     I              BCVGSX                          WKVGSX
     I              BCVHSX                          WKVHSX
     I              BCVISX                          WKVISX
     I              BCF8AA                          WKF8AA
     I              BCV4SX                          WKV4SX
     I              BCF9AA                          WKF9AA
     I              BCZFNX                          WKZFNX
     I              BCZZNX                          WKZZNX
     I              BCZ0NX                          WKZ0NX
     I              BCBINY                          WKBINY
     I              BCBJNY                          WKBJNY
     I              BCBKNY                          WKBKNY
     I              BCATNY                          WKATNY
     I              BCALD8                          WKALD8
     I              BCAMD8                          WKAMD8
     I              BCF5NY                          WKF5NY
     I              BCZISX                          WKZISX
     I              BCZJSX                          WKZJSX
     I              BCZKSX                          WKZKSX
     I              BCZLSX                          WKZLSX
     I              BCZMSX                          WKZMSX
     I              BCUWSX                          WKUWSX
     I              BCUXSX                          WKUXSX
     I              BCV3SX                          WKV3SX
     I              BCAHNY                          WKAHNY
     I              BCAINY                          WKAINY
     I              BCAJNY                          WKAJNY
     I              BCAKNY                          WKAKNY
      *
     I@BCCPZO
      * PFS Order Detail          Update index
      * Renamed input format fields
     I              BCY1NX                          WLY1NX
     I              BCZPNX                          WLZPNX
     I              BCZXNX                          WLZXNX
     I              BCZYNX                          WLZYNX
     I              BCY2NX                          WLY2NX
     I              BCGIT1                          WLGIT1
     I              BCGGT1                          WLGGT1
     I              BCGHT1                          WLGHT1
     I              BCVFSX                          WLVFSX
     I              BCVGSX                          WLVGSX
     I              BCVHSX                          WLVHSX
     I              BCVISX                          WLVISX
     I              BCF8AA                          WLF8AA
     I              BCV4SX                          WLV4SX
     I              BCF9AA                          WLF9AA
     I              BCZFNX                          WLZFNX
     I              BCZZNX                          WLZZNX
     I              BCZ0NX                          WLZ0NX
     I              BCBINY                          WLBINY
     I              BCBJNY                          WLBJNY
     I              BCBKNY                          WLBKNY
     I              BCATNY                          WLATNY
     I              BCALD8                          WLALD8
     I              BCAMD8                          WLAMD8
     I              BCF5NY                          WLF5NY
     I              BCZISX                          WLZISX
     I              BCZJSX                          WLZJSX
     I              BCZKSX                          WLZKSX
     I              BCZLSX                          WLZLSX
     I              BCZMSX                          WLZMSX
     I              BCUWSX                          WLUWSX
     I              BCUXSX                          WLUXSX
     I              BCV3SX                          WLV3SX
     I              BCAHNY                          WLAHNY
     I              BCAINY                          WLAINY
     I              BCAJNY                          WLAJNY
     I              BCAKNY                          WLAKNY
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WMAIC3
     I              AMC4NB                          WMC4NB
     I              AMRMNB                          WMRMNB
     I              AMRUNB                          WMRUNB
     I              AMXACD                          WMXACD
     I              AMOANA                          WMOANA
     I              AMHBAA                          WMHBAA
     I              AMJ0T1                          WMJ0T1
     I              AMGENY                          WMGENY
     I              AMJ1T1                          WMJ1T1
     I              AMHCAA                          WMHCAA
     I              AMQWDT                          WMQWDT
     I              AMQXDT                          WMQXDT
     I              AMQYDT                          WMQYDT
     I              AMHDAA                          WMHDAA
     I              AMCCTX                          WMCCTX
     I              AMJ2T1                          WMJ2T1
     I              AMRLNA                          WMRLNA
     I              AMRMNA                          WMRMNA
     I              AMGINY                          WMGINY
     I              AMGFNY                          WMGFNY
     I              AMGGNY                          WMGGNY
     I              AMGHNY                          WMGHNY
     I              AMHEVL                          WMHEVL
     I              AMHFVL                          WMHFVL
     I              AMHGVL                          WMHGVL
     I              AMQZDT                          WMQZDT
     I              AMQ0DT                          WMQ0DT
     I              AMQ1DT                          WMQ1DT
     I              AMQ2DT                          WMQ2DT
     I              AMC2TX                          WMC2TX
     I              AMC3TX                          WMC3TX
     I              AMC6TX                          WMC6TX
     I              AMCHTX                          WMCHTX
     I              AMCITX                          WMCITX
     I              AMCLTX                          WMCLTX
     I              AMB4TX                          WMB4TX
     I              AMCUTX                          WMCUTX
     I              AMCVTX                          WMCVTX
     I              AMB9TX                          WMB9TX
     I              AMJWSC                          WMJWSC
     I              AMITNY                          WMITNY
     I              AMLMT1                          WMLMT1
     I              AMLWAA                          WMLWAA
     I              AMFVST                          WMFVST
     I              AMF0ST                          WMF0ST
     I              AMF2ST                          WMF2ST
     I              AMF3ST                          WMF3ST
     I              AMJUSC                          WMJUSC
     I              AMJVSC                          WMJVSC
     I              AMV3T1                          WMV3T1
     I              AMV4T1                          WMV4T1
     I              AMV5T1                          WMV5T1
     I              AMV6T1                          WMV6T1
     I              AMV7T1                          WMV7T1
     I              AMV8T1                          WMV8T1
     I              AMV9T1                          WMV9T1
     I              AMWAT1                          WMWAT1
     I              AMWBT1                          WMWBT1
     I              AMWCT1                          WMWCT1
     I              AMWDT1                          WMWDT1
     I              AMQJNY                          WMQJNY
     I              AMQKNY                          WMQKNY
     I              AMQLNY                          WMQLNY
     I              AMP8NY                          WMP8NY
     I              AMP9NY                          WMP9NY
     I              AMQANY                          WMQANY
     I              AMQCNY                          WMQCNY
     I              AMQDNY                          WMQDNY
     I              AMQENY                          WMQENY
     I              AMQFNY                          WMQFNY
     I              AMQGNY                          WMQGNY
     I              AMQHNY                          WMQHNY
     I              AMQINY                          WMQINY
     I              AMQMNY                          WMQMNY
     I              AMMYU1                          WMMYU1
     I              AMJXSC                          WMJXSC
     I              AMJYSC                          WMJYSC
     I              AMJZSC                          WMJZSC
     I              AMJ0SC                          WMJ0SC
     I              AMMZU1                          WMMZU1
     I              AMM0U1                          WMM0U1
     I              AMM1U1                          WMM1U1
     I              AMM2U1                          WMM2U1
     I              AMM3U1                          WMM3U1
     I              AMW5DT                          WMW5DT
     I              AMW6DT                          WMW6DT
     I              AMUVST                          WMUVST
     I              AMUWST                          WMUWST
     I              AMUXST                          WMUXST
     I              AMVSST                          WMVSST
     I              AMAATM                          WMAATM
     I              AMAYNA                          WMAYNA
     I              AMA0NA                          WMA0NA
     I              AMAXDT                          WMAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WOAIC3
     I              JYZ9ST                          WOZ9ST
     I              JYCSST                          WOCSST
     I              JYZ8ST                          WOZ8ST
     I              JYCXST                          WOCXST
     I              JYSWST                          WOSWST
     I              JYXXTM                          WOXXTM
     I              JYUECD                          WOUECD
     I              JYHSST                          WOHSST
     I              JYAMEO                          WOAMEO
     I              JYSSDF                          WOSSDF
     I              JYPDFT                          WOPDFT
     I              JYYISX                          WOYISX
     I              JYYJSX                          WOYJSX
     I              JYYKSX                          WOYKSX
     I              JYYLSX                          WOYLSX
     I              JYYMSX                          WOYMSX
     I              JYYNSX                          WOYNSX
     I              JYUVST                          WOUVST
     I              JYUWST                          WOUWST
     I              JYUXST                          WOUXST
     I              JYVSST                          WOVSST
     I              JYAATM                          WOAATM
     I              JYAYNA                          WOAYNA
     I              JYA0NA                          WOA0NA
     I              JYAXDT                          WOAXDT
      *
     I@BDCPAB
      * PFS Order BOL Comment     Retrieval index
      * Renamed input format fields
     I              BDY1NX                          WRY1NX
     I              BDZPNX                          WRZPNX
     I              BDIZST                          WRIZST
     I              BDZ1NX                          WRZ1NX
     I              BDGJT1                          WRGJT1
     I              BDUWSX                          WRUWSX
     I              BDUXSX                          WRUXSX
     I              BDV3SX                          WRV3SX
     I              BDAHNY                          WRAHNY
     I              BDAINY                          WRAINY
     I              BDAJNY                          WRAJNY
     I              BDAKNY                          WRAKNY
      *
     I@BDCPAA
      * PFS Order BOL Comment     Update index
      * Renamed input format fields
     I              BDY1NX                          WSY1NX
     I              BDZPNX                          WSZPNX
     I              BDIZST                          WSIZST
     I              BDZ1NX                          WSZ1NX
     I              BDGJT1                          WSGJT1
     I              BDUWSX                          WSUWSX
     I              BDUXSX                          WSUXSX
     I              BDV3SX                          WSV3SX
     I              BDAHNY                          WSAHNY
     I              BDAINY                          WSAINY
     I              BDAJNY                          WSAJNY
     I              BDAKNY                          WSAKNY
      *
     I@COCPNU
      * Order Comment             Retrieval index       NV
      * Renamed input format fields
     I              COAIC3                          WTAIC3
     I              COC4NB                          WTC4NB
     I              COI1SX                          WTI1SX
     I              CODXNB                          WTDXNB
     I              COG4NA                          WTG4NA
     I              COUVST                          WTUVST
     I              COUWST                          WTUWST
     I              COUXST                          WTUXST
     I              COAATM                          WTAATM
     I              COAYNA                          WTAYNA
     I              COA0NA                          WTA0NA
     I              COAXDT                          WTAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WVAIC3
     I              OMC4NB                          WVC4NB
     I              OMDPNB                          WVDPNB
     I              OMUENB                          WVUENB
     I              OMHGCD                          WVHGCD
     I              OMAJCD                          WVAJCD
     I              OMBKC7                          WVBKC7
     I              OMCFC7                          WVCFC7
     I              OMGMST                          WVGMST
     I              OMGNST                          WVGNST
     I              OMMAVA                          WVMAVA
     I              OMKDVA                          WVKDVA
     I              OML8VA                          WVL8VA
     I              OML9VA                          WVL9VA
     I              OMGTST                          WVGTST
     I              OMGVST                          WVGVST
     I              OMGUST                          WVGUST
     I              OMQFST                          WVQFST
     I              OMAYVA                          WVAYVA
     I              OMEXDT                          WVEXDT
     I              OMLQCD                          WVLQCD
     I              OMRDCD                          WVRDCD
     I              OMQ7CD                          WVQ7CD
     I              OMBZPR                          WVBZPR
     I              OML6NB                          WVL6NB
     I              OMU1ST                          WVU1ST
     I              OMGIDT                          WVGIDT
     I              OMCRCD                          WVCRCD
     I              OMAGCD                          WVAGCD
     I              OMRZST                          WVRZST
     I              OMR0ST                          WVR0ST
     I              OMR1ST                          WVR1ST
     I              OMG7NA                          WVG7NA
     I              OMG8NA                          WVG8NA
     I              OMRPCD                          WVRPCD
     I              OMVEST                          WVVEST
     I              OMVGST                          WVVGST
     I              OMAVST                          WVAVST
     I              OMU0ST                          WVU0ST
     I              OMRFCD                          WVRFCD
     I              OMFZST                          WVFZST
     I              OMR1NB                          WVR1NB
     I              OMAVQT                          WVAVQT
     I              OMD0WG                          WVD0WG
     I              OMCCQT                          WVCCQT
     I              OMAUWG                          WVAUWG
     I              OMCBQT                          WVCBQT
     I              OMATWG                          WVATWG
     I              OMAQCS                          WVAQCS
     I              OMAGCS                          WVAGCS
     I              OMAKPR                          WVAKPR
     I              OMALPR                          WVALPR
     I              OMAUPR                          WVAUPR
     I              OMAVWG                          WVAVWG
     I              OMA4WG                          WVA4WG
     I              OMA5DT                          WVA5DT
     I              OMAODT                          WVAODT
     I              OMGNDT                          WVGNDT
     I              OMAMST                          WVAMST
     I              OMANST                          WVANST
     I              OMVAST                          WVVAST
     I              OMRGNB                          WVRGNB
     I              OMRHNB                          WVRHNB
     I              OMRINB                          WVRINB
     I              OMRBCD                          WVRBCD
     I              OMHICD                          WVHICD
     I              OMRNCD                          WVRNCD
     I              OMROCD                          WVROCD
     I              OMCXDT                          WVCXDT
     I              OMAJVN                          WVAJVN
     I              OMKXCD                          WVKXCD
     I              OMJPCD                          WVJPCD
     I              OMCQCD                          WVCQCD
     I              OMR4CD                          WVR4CD
     I              OMZ1ST                          WVZ1ST
     I              OMZ3ST                          WVZ3ST
     I              OMZ4ST                          WVZ4ST
     I              OMDUPR                          WVDUPR
     I              OMB6VL                          WVB6VL
     I              OMA1AA                          WVA1AA
     I              OMFZSX                          WVFZSX
     I              OMF0SX                          WVF0SX
     I              OMF1SX                          WVF1SX
     I              OMF2SX                          WVF2SX
     I              OMF3SX                          WVF3SX
     I              OMF4SX                          WVF4SX
     I              OMF5SX                          WVF5SX
     I              OMF6SX                          WVF6SX
     I              OMF7SX                          WVF7SX
     I              OMNTDT                          WVNTDT
     I              OMNUDT                          WVNUDT
     I              OMNVDT                          WVNVDT
     I              OMNWDT                          WVNWDT
     I              OMNXDT                          WVNXDT
     I              OMBUTM                          WVBUTM
     I              OMBVTM                          WVBVTM
     I              OMBWTM                          WVBWTM
     I              OMBXTM                          WVBXTM
     I              OMBYTM                          WVBYTM
     I              OMH5NX                          WVH5NX
     I              OMH6NX                          WVH6NX
     I              OMH7NX                          WVH7NX
     I              OMH8NX                          WVH8NX
     I              OMH9NX                          WVH9NX
     I              OMDVPR                          WVDVPR
     I              OMDWPR                          WVDWPR
     I              OMDXPR                          WVDXPR
     I              OMDYPR                          WVDYPR
     I              OMDZPR                          WVDZPR
     I              OMGSPR                          WVGSPR
     I              OMGTPR                          WVGTPR
     I              OMGUPR                          WVGUPR
     I              OMHOST                          WVHOST
     I              OMHPST                          WVHPST
     I              OMIOST                          WVIOST
     I              OMPEWG                          WVPEWG
     I              OMRINY                          WVRINY
     I              OMTIDT                          WVTIDT
     I              OMTJDT                          WVTJDT
     I              OMH2ST                          WVH2ST
     I              OMH0ST                          WVH0ST
     I              OMH1ST                          WVH1ST
     I              OMTKDT                          WVTKDT
     I              OMTLDT                          WVTLDT
     I              OMTMDT                          WVTMDT
     I              OMUVST                          WVUVST
     I              OMUWST                          WVUWST
     I              OMUXST                          WVUXST
     I              OMAATM                          WVAATM
     I              OMAYNA                          WVAYNA
     I              OMA0NA                          WVA0NA
     I              OMAXDT                          WVAXDT
      *
     I@B1REED
      * Country Comment           Retrieval index
      * Renamed input format fields
     I              B1KXCD                          WWKXCD
     I              B1I1SX                          WWI1SX
     I              B1M5NX                          WWM5NX
     I              B1Q6NA                          WWQ6NA
     I              B1UVST                          WWUVST
     I              B1UWST                          WWUWST
     I              B1UXST                          WWUXST
     I              B1VSST                          WWVSST
     I              B1AATM                          WWAATM
     I              B1AYNA                          WWAYNA
     I              B1A0NA                          WWA0NA
     I              B1AXDT                          WWAXDT
      *
     I@AVCPG4
      * Customer Comment          Retrieval index
      * Renamed input format fields
     I              AVBKC7                          WXBKC7
     I              AVI1SX                          WXI1SX
     I              AVM5NX                          WXM5NX
     I              AVXRTX                          WXXRTX
     I              AVUVST                          WXUVST
     I              AVUWST                          WXUWST
     I              AVUXST                          WXUXST
     I              AVVSST                          WXVSST
     I              AVAATM                          WXAATM
     I              AVAYNA                          WXAYNA
     I              AVA0NA                          WXA0NA
     I              AVAXDT                          WXAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WYBKC7
     I              NEUFTX                          WYUFTX
     I              NEUGTX                          WYUGTX
     I              NEPFNA                          WYPFNA
     I              NEJ5NX                          WYJ5NX
     I              NEU5TX                          WYU5TX
     I              NEU6TX                          WYU6TX
     I              NEW0TX                          WYW0TX
     I              NEHSSX                          WYHSSX
     I              NEHUSX                          WYHUSX
     I              NEHVSX                          WYHVSX
     I              NEAAC8                          WYAAC8
     I              NEP0SX                          WYP0SX
     I              NEP1SX                          WYP1SX
     I              NEP2SX                          WYP2SX
     I              NEP3SX                          WYP3SX
     I              NEP4SX                          WYP4SX
     I              NEP5SX                          WYP5SX
     I              NEP6SX                          WYP6SX
     I              NEUVST                          WYUVST
     I              NEUWST                          WYUWST
     I              NEUXST                          WYUXST
     I              NEVSST                          WYVSST
     I              NEAATM                          WYAATM
     I              NEAYNA                          WYAYNA
     I              NEA0NA                          WYA0NA
     I              NEAXDT                          WYAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          TARMNB
     I              FLRUNB                          TARUNB
     I              FLRVNB                          TARVNB
     I              FLDQTX                          TADQTX
     I              FLRWNB                          TARWNB
     I              FLRXNB                          TARXNB
     I              FLSQNB                          TASQNB
     I              FLT0NB                          TAT0NB
     I              FLT1NB                          TAT1NB
     I              FLR1NB                          TAR1NB
     I              FLAIC3                          TAAIC3
     I              FLC4NB                          TAC4NB
     I              FLVCST                          TAVCST
     I              FLKEDT                          TAKEDT
     I              FLSXNB                          TASXNB
     I              FLKFDT                          TAKFDT
     I              FLACTM                          TAACTM
     I              FLK5TX                          TAK5TX
     I              FLW5CD                          TAW5CD
     I              FLEJDT                          TAEJDT
     I              FLAGTM                          TAAGTM
     I              FLKJDT                          TAKJDT
     I              FLATTM                          TAATTM
     I              FLHDDT                          TAHDDT
     I              FLAUTM                          TAAUTM
     I              FLKKDT                          TAKKDT
     I              FLAVTM                          TAAVTM
     I              FLZ4NB                          TAZ4NB
     I              FLY7ST                          TAY7ST
     I              FLY2ST                          TAY2ST
     I              FLWHTX                          TAWHTX
     I              FLWITX                          TAWITX
     I              FLWJTX                          TAWJTX
     I              FLWKTX                          TAWKTX
     I              FLWLTX                          TAWLTX
     I              FLN7DT                          TAN7DT
     I              FLN8DT                          TAN8DT
     I              FLN9DT                          TAN9DT
     I              FLB3TM                          TAB3TM
     I              FLB4TM                          TAB4TM
     I              FLB5TM                          TAB5TM
     I              FLIASX                          TAIASX
     I              FLIBSX                          TAIBSX
     I              FLICSX                          TAICSX
     I              FLWVTX                          TAWVTX
     I              FLWWTX                          TAWWTX
     I              FLWXTX                          TAWXTX
     I              FLUVST                          TAUVST
     I              FLUWST                          TAUWST
     I              FLUXST                          TAUXST
     I              FLAATM                          TAAATM
     I              FLAYNA                          TAAYNA
     I              FLA0NA                          TAA0NA
     I              FLAXDT                          TAAXDT
      *
     I@LCREL2
      * Shipping Line/Port        Retrieval index
      * Renamed input format fields
     I              LCXACD                          TBXACD
     I              LCOANA                          TBOANA
     I              LCOKTX                          TBOKTX
     I              LCLBTX                          TBLBTX
     I              LCLATX                          TBLATX
     I              LCXBCD                          TBXBCD
     I              LCLCTX                          TBLCTX
     I              LCSPPN                          TBSPPN
     I              LCLDTX                          TBLDTX
     I              LCPYAA                          TBPYAA
     I              LCUVST                          TBUVST
     I              LCUWST                          TBUWST
     I              LCUXST                          TBUXST
     I              LCVSST                          TBVSST
     I              LCAATM                          TBAATM
     I              LCAYNA                          TBAYNA
     I              LCA0NA                          TBA0NA
     I              LCAXDT                          TBAXDT
      *
     I@BBCPZS
      * PFS Order Header          Retrieval index
      * Renamed input format fields
     I              BBY1NX                          TCY1NX
     I              BBZPNX                          TCZPNX
     I              BBZGNX                          TCZGNX
     I              BBZWNX                          TCZWNX
     I              BBZVNX                          TCZVNX
     I              BBVCSX                          TCVCSX
     I              BBZQNX                          TCZQNX
     I              BBF0T1                          TCF0T1
     I              BBF1T1                          TCF1T1
     I              BBF2T1                          TCF2T1
     I              BBGUT1                          TCGUT1
     I              BBF3T1                          TCF3T1
     I              BBF4T1                          TCF4T1
     I              BBF5T1                          TCF5T1
     I              BBF6T1                          TCF6T1
     I              BBF7T1                          TCF7T1
     I              BBZENX                          TCZENX
     I              BBF8T1                          TCF8T1
     I              BBF9T1                          TCF9T1
     I              BBGAT1                          TCGAT1
     I              BBGVT1                          TCGVT1
     I              BBGBT1                          TCGBT1
     I              BBGCT1                          TCGCT1
     I              BBGDT1                          TCGDT1
     I              BBFZT1                          TCFZT1
     I              BBZRNX                          TCZRNX
     I              BBZSNX                          TCZSNX
     I              BBZTNX                          TCZTNX
     I              BBZUNX                          TCZUNX
     I              BBVBSX                          TCVBSX
     I              BBU3SX                          TCU3SX
     I              BBGET1                          TCGET1
     I              BBGFT1                          TCGFT1
     I              BBA1NY                          TCA1NY
     I              BBBKNY                          TCBKNY
     I              BBATNY                          TCATNY
     I              BBVESX                          TCVESX
     I              BBF8AA                          TCF8AA
     I              BBF9AA                          TCF9AA
     I              BBC5NY                          TCC5NY
     I              BBF5NY                          TCF5NY
     I              BBF5AA                          TCF5AA
     I              BBFRT1                          TCFRT1
     I              BBFST1                          TCFST1
     I              BBFTT1                          TCFTT1
     I              BBFUT1                          TCFUT1
     I              BBFVT1                          TCFVT1
     I              BBFWT1                          TCFWT1
     I              BBFXT1                          TCFXT1
     I              BBZLNX                          TCZLNX
     I              BBF7AA                          TCF7AA
     I              BBF6AA                          TCF6AA
     I              BBS6NA                          TCS6NA
     I              BBZDSX                          TCZDSX
     I              BBZESX                          TCZESX
     I              BBZFSX                          TCZFSX
     I              BBZGSX                          TCZGSX
     I              BBZHSX                          TCZHSX
     I              BBMXU1                          TCMXU1
     I              BBUWSX                          TCUWSX
     I              BBUXSX                          TCUXSX
     I              BBV3SX                          TCV3SX
     I              BBAHNY                          TCAHNY
     I              BBAINY                          TCAINY
     I              BBAJNY                          TCAJNY
     I              BBAKNY                          TCAKNY
      *
     I@BBCPZR
      * PFS Order Header          Update index
      * Renamed input format fields
     I              BBY1NX                          TDY1NX
     I              BBZPNX                          TDZPNX
     I              BBZGNX                          TDZGNX
     I              BBZWNX                          TDZWNX
     I              BBZVNX                          TDZVNX
     I              BBVCSX                          TDVCSX
     I              BBZQNX                          TDZQNX
     I              BBF0T1                          TDF0T1
     I              BBF1T1                          TDF1T1
     I              BBF2T1                          TDF2T1
     I              BBGUT1                          TDGUT1
     I              BBF3T1                          TDF3T1
     I              BBF4T1                          TDF4T1
     I              BBF5T1                          TDF5T1
     I              BBF6T1                          TDF6T1
     I              BBF7T1                          TDF7T1
     I              BBZENX                          TDZENX
     I              BBF8T1                          TDF8T1
     I              BBF9T1                          TDF9T1
     I              BBGAT1                          TDGAT1
     I              BBGVT1                          TDGVT1
     I              BBGBT1                          TDGBT1
     I              BBGCT1                          TDGCT1
     I              BBGDT1                          TDGDT1
     I              BBFZT1                          TDFZT1
     I              BBZRNX                          TDZRNX
     I              BBZSNX                          TDZSNX
     I              BBZTNX                          TDZTNX
     I              BBZUNX                          TDZUNX
     I              BBVBSX                          TDVBSX
     I              BBU3SX                          TDU3SX
     I              BBGET1                          TDGET1
     I              BBGFT1                          TDGFT1
     I              BBA1NY                          TDA1NY
     I              BBBKNY                          TDBKNY
     I              BBATNY                          TDATNY
     I              BBVESX                          TDVESX
     I              BBF8AA                          TDF8AA
     I              BBF9AA                          TDF9AA
     I              BBC5NY                          TDC5NY
     I              BBF5NY                          TDF5NY
     I              BBF5AA                          TDF5AA
     I              BBFRT1                          TDFRT1
     I              BBFST1                          TDFST1
     I              BBFTT1                          TDFTT1
     I              BBFUT1                          TDFUT1
     I              BBFVT1                          TDFVT1
     I              BBFWT1                          TDFWT1
     I              BBFXT1                          TDFXT1
     I              BBZLNX                          TDZLNX
     I              BBF7AA                          TDF7AA
     I              BBF6AA                          TDF6AA
     I              BBS6NA                          TDS6NA
     I              BBZDSX                          TDZDSX
     I              BBZESX                          TDZESX
     I              BBZFSX                          TDZFSX
     I              BBZGSX                          TDZGSX
     I              BBZHSX                          TDZHSX
     I              BBMXU1                          TDMXU1
     I              BBUWSX                          TDUWSX
     I              BBUXSX                          TDUXSX
     I              BBV3SX                          TDV3SX
     I              BBAHNY                          TDAHNY
     I              BBAINY                          TDAINY
     I              BBAJNY                          TDAJNY
     I              BBAKNY                          TDAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPPBC1    E DSPPBCCPL0
      * UPD : PFS Order Detail          Update index
      * Renamed input format fields
     I              BCY1NX                          WLY1NX
     I              BCZPNX                          WLZPNX
     I              BCZXNX                          WLZXNX
     I              BCZYNX                          WLZYNX
     I              BCY2NX                          WLY2NX
     I              BCGIT1                          WLGIT1
     I              BCGGT1                          WLGGT1
     I              BCGHT1                          WLGHT1
     I              BCVFSX                          WLVFSX
     I              BCVGSX                          WLVGSX
     I              BCVHSX                          WLVHSX
     I              BCVISX                          WLVISX
     I              BCF8AA                          WLF8AA
     I              BCV4SX                          WLV4SX
     I              BCF9AA                          WLF9AA
     I              BCZFNX                          WLZFNX
     I              BCZZNX                          WLZZNX
     I              BCZ0NX                          WLZ0NX
     I              BCBINY                          WLBINY
     I              BCBJNY                          WLBJNY
     I              BCBKNY                          WLBKNY
     I              BCATNY                          WLATNY
     I              BCALD8                          WLALD8
     I              BCAMD8                          WLAMD8
     I              BCF5NY                          WLF5NY
     I              BCZISX                          WLZISX
     I              BCZJSX                          WLZJSX
     I              BCZKSX                          WLZKSX
     I              BCZLSX                          WLZLSX
     I              BCZMSX                          WLZMSX
     I              BCUWSX                          WLUWSX
     I              BCUXSX                          WLUXSX
     I              BCV3SX                          WLV3SX
     I              BCAHNY                          WLAHNY
     I              BCAINY                          WLAINY
     I              BCAJNY                          WLAJNY
     I              BCAKNY                          WLAKNY
      *
     IYARDCS      DS                            222
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPPBD1    E DSPPBDCPL0
      * UPD : PFS Order BOL Comment     Update index
      * Renamed input format fields
     I              BDY1NX                          WSY1NX
     I              BDZPNX                          WSZPNX
     I              BDIZST                          WSIZST
     I              BDZ1NX                          WSZ1NX
     I              BDGJT1                          WSGJT1
     I              BDUWSX                          WSUWSX
     I              BDUXSX                          WSUXSX
     I              BDV3SX                          WSV3SX
     I              BDAHNY                          WSAHNY
     I              BDAINY                          WSAINY
     I              BDAJNY                          WSAJNY
     I              BDAKNY                          WSAKNY
      *
     IYBRDCS      DS                            111
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPPBB1    E DSPPBBCPL0
      * UPD : PFS Order Header          Update index
      * Renamed input format fields
     I              BBY1NX                          TDY1NX
     I              BBZPNX                          TDZPNX
     I              BBZGNX                          TDZGNX
     I              BBZWNX                          TDZWNX
     I              BBZVNX                          TDZVNX
     I              BBVCSX                          TDVCSX
     I              BBZQNX                          TDZQNX
     I              BBF0T1                          TDF0T1
     I              BBF1T1                          TDF1T1
     I              BBF2T1                          TDF2T1
     I              BBGUT1                          TDGUT1
     I              BBF3T1                          TDF3T1
     I              BBF4T1                          TDF4T1
     I              BBF5T1                          TDF5T1
     I              BBF6T1                          TDF6T1
     I              BBF7T1                          TDF7T1
     I              BBZENX                          TDZENX
     I              BBF8T1                          TDF8T1
     I              BBF9T1                          TDF9T1
     I              BBGAT1                          TDGAT1
     I              BBGVT1                          TDGVT1
     I              BBGBT1                          TDGBT1
     I              BBGCT1                          TDGCT1
     I              BBGDT1                          TDGDT1
     I              BBFZT1                          TDFZT1
     I              BBZRNX                          TDZRNX
     I              BBZSNX                          TDZSNX
     I              BBZTNX                          TDZTNX
     I              BBZUNX                          TDZUNX
     I              BBVBSX                          TDVBSX
     I              BBU3SX                          TDU3SX
     I              BBGET1                          TDGET1
     I              BBGFT1                          TDGFT1
     I              BBA1NY                          TDA1NY
     I              BBBKNY                          TDBKNY
     I              BBATNY                          TDATNY
     I              BBVESX                          TDVESX
     I              BBF8AA                          TDF8AA
     I              BBF9AA                          TDF9AA
     I              BBC5NY                          TDC5NY
     I              BBF5NY                          TDF5NY
     I              BBF5AA                          TDF5AA
     I              BBFRT1                          TDFRT1
     I              BBFST1                          TDFST1
     I              BBFTT1                          TDFTT1
     I              BBFUT1                          TDFUT1
     I              BBFVT1                          TDFVT1
     I              BBFWT1                          TDFWT1
     I              BBFXT1                          TDFXT1
     I              BBZLNX                          TDZLNX
     I              BBF7AA                          TDF7AA
     I              BBF6AA                          TDF6AA
     I              BBS6NA                          TDS6NA
     I              BBZDSX                          TDZDSX
     I              BBZESX                          TDZESX
     I              BBZFSX                          TDZFSX
     I              BBZGSX                          TDZGSX
     I              BBZHSX                          TDZHSX
     I              BBMXU1                          TDMXU1
     I              BBUWSX                          TDUWSX
     I              BBUXSX                          TDUXSX
     I              BBV3SX                          TDV3SX
     I              BBAHNY                          TDAHNY
     I              BBAINY                          TDAINY
     I              BBAJNY                          TDAJNY
     I              BBAKNY                          TDAKNY
      *
     IYCRDCS      DS                            861
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop/Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Carrier Code
     I                                        7   9 P1BZNA
      * I :  Load ID
     I                                    P  10  130P1RMNB
     IP2PARM      DS
      * I :  Load Status
     I                                        1   1 P2PKST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Requested Delv Date Error'
      * Requested Delivery Dt
     I                                    P   1   40ZA0001
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0002
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0003
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0004
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0005
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0006
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0007
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0008
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0009
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0010
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0011
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0012
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0013
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0014
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0015
      * Message data for 'Invalid Item Age Days'
      * Item Age Days
     I                                    P   1   30ZA0016
      * Message data for 'Invalid Prod OvrDates'
      * Production AgeDte Fr
     I                                    P   1   40ZA0017
      * Production AgeDte To
     I                                    P   5   80ZA0018
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1BZNA    PARM           WP0003  3        Carrier Code
     C           P1RMNB    PARM           WP0004  70       Load ID
     C           P2PKST    PARM           WP0005  1        Load Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Order Header      XF
      * ****************************
      * Get Next PFS Sequence No         -- copied from reg carlisle lh d
     C                     EXSR UASUBR                     Get Next PFS Se
      * ****************************
      * **** UPDATE ORDER HEADER
      * RTV 1st Warehouse      RT - Order Detail  * 
     C                     EXSR SBRVGN
      * Rtv Live w/CT PFS Int RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0002    WL0001    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0003    P      WHS Live w/Carl
     C                     MOVELWL0003    YL0004    P      WHS PFS Interfa
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0003    IFEQ 'Y'                        *IF
      * CASE: LCL.WHS PFS Interface is Download/Both
     C           YL0004    IFEQ 'D'                        *IF
     C           YL0004    OREQ 'B'
     C                     MOVEL'Y'       YL0003           WHS Live w/Carl
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0003           WHS Live w/Carl
     C                     END                             *FI
     C                     END                             *FI
      * ** Create PFS Order Header
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVELP2PKST    YL0005           Load Status
     C                     Z-ADD*ZERO     YL0006           Stop/Drop
      * PFS Order Header      RT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADDYL0040    PARMNB           Load ID
     C                     Z-ADDYL0006    PARVNB           Stop/Drop
     C                     MOVEL'SNDPFS'  PARVST    P      Load Change Typ
     C                     MOVEL'INT'     PAUJST    P      Department Cont
     C                     MOVEL*BLANK    PAMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##JOB     PAA0NA    P      Job Name
     C                     MOVELP1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
     C                     Z-ADDP1C4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     MOVEL@CN,001   WAV8CD           Company Value C
      * Establish starting position
     C           KRSSA     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAM8NB    YL0001           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSB01           Company Number
     C                     Z-ADDP1C4NB    WQSB02           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
      * Establish starting position
     C           KPSSB     SETLL@BGWKL1                    *
     C           KRSSB     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWBAJCD    YL0002           Warehouse Code
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Live w/CT PFS Int RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           WHS Live w/Carl
     C                     MOVEL*BLANK    WL0003           WHS PFS Interfa
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCRRSX    WL0002           WHS Live w/Carl
     C                     MOVELWCRSSX    WL0003           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * PFS Order Header      RT - Order Header TRG  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       PFS Company Num
     C                     Z-ADD*ZERO     WN0002  70       PFS Order Numbe
     C                     Z-ADD*ZERO     WN0003  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0004  20       PFS Load Stop N
     C                     MOVEL*BLANK    WN0005  2        PFS Order Type
     C                     Z-ADD*ZERO     WN0006  70       PFS Ship To Cus
     C                     MOVEL*BLANK    WN0007 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0008 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0009 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0010 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0011 20        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0012  2        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0013 11        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0014 50        PFS Ship To Ema
     C                     MOVEL*BLANK    WN0015 25        PFS Ship To Pho
     C                     Z-ADD*ZERO     WN0016  70       PFS Bill To Cus
     C                     MOVEL*BLANK    WN0017 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0018 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0019 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0020 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0021 20        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0022  2        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0023 11        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0024 15        PFS Customer PO
     C                     Z-ADD*ZERO     WN0025  80       PFS Order Date
     C                     Z-ADD*ZERO     WN0026  80       PFS Scheduled S
     C                     Z-ADD*ZERO     WN0027  80       PFS Requested D
     C                     Z-ADD*ZERO     WN0028  60       PFS Requested D
     C                     MOVEL*BLANK    WN0029  1        PFS Export Stat
     C                     MOVEL*BLANK    WN0030  6        PFS Country Cod
     C                     MOVEL*BLANK    WN0031 40        PFS Special Ins
     C                     MOVEL*BLANK    WN0032 40        PFS Special Ins
     C                     Z-ADD*ZERO     WN0033  70       PFS Maximum Gro
     C                     Z-ADD*ZERO     WN0034  50       PFS Estimated P
     C                     Z-ADD*ZERO     WN0035  52       PFS Average Pal
     C                     MOVEL*BLANK    WN0036  1        PFS Order Statu
     C                     MOVEL*BLANK    WN0037  3        PFS Ship From W
     C                     MOVEL*BLANK    WN0038  3        PFS Ship To War
     C                     Z-ADD*ZERO     WN0039  50       PFS Order Detai
     C                     MOVEL*BLANK    WN0040  3        PFS Shipping Li
     C                     MOVEL*BLANK    WN0041 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0042 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0043 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0044 20        PFS Shipping Li
     C                     MOVEL*BLANK    WN0045  2        PFS Shipping Li
     C                     MOVEL*BLANK    WN0046 11        PFS Shipping LI
     C                     MOVEL*BLANK    WN0047 30        PFS Vessel Name
     C                     MOVEL*BLANK    WN0048 15        PFS Voyage
     C                     MOVEL*BLANK    WN0049 20        PFS Discharge P
     C                     MOVEL*BLANK    WN0050 15        PFS Booking Num
     C                     MOVEL*BLANK    WN0051 15        PFS Delivery P.
     C                     MOVEL*BLANK    WN0052  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0053  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0054  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0055  2        PFS Order Unuse
     C                     MOVEL*BLANK    WN0056  2        PFS Order Unuse
     C                     MOVEL*BLANK    WN0057 15        PFS Order Unuse
     C                     MOVEL*BLANK    WN0058  1        PFS Record Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      * --------
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
     C                     Z-ADDP1C4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * FP1309 Inventory Age  IF
      * FP1309 Inventory Age Code Description
      * ** CREATE ORDER DETAIL
      * PFS Order Detail      RT - Order Detail  * 
     C                     EXSR SERVGN
      * ** E0657 RMC 4/05/2010   UPDATE ORDER BOL Comment from Country co
      * **   Was outputting shipping instructions prior to 4/05/10 - but
      * **   Werent picked up by carisle in ppu1upc - file was commented
      * RTV OHE Intend for Exp RT - Order Header Extension  * 
     C                     EXSR SPRVGN
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR SQRVGN
      * For Daily CAT = put all comments in Order Comments
      * CASE: LCL.Company Organization is Daily's
     C           YL0021    IFEQ 'D'                        *IF
      * Rtv Del Ord Comment   RT - PFS Order BOL Comment  * delete all fo
     C                     EXSR SRRVGN
      * CASE: PAR.Load Status is Lock
     C           YL0005    IFEQ 'L'                        *IF
      * RTV PFS Ord Comment   RT - Order Comment  * 
     C                     EXSR STRVGN
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0017           Company Number
     C                     Z-ADDWDC4NB    WL0018           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    YL0023    P      Country Code
      * CASE: LCL.OHE Intended for ExportCC is Entered
     C           YL0019    IFNE *BLANK                     *IF
      * Rtv PFS BL Cmnt f/CAT RT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0019    WL0020    P      Country Code
     C                     MOVEL'BI'      WL0021    P      Comment Type
     C                     Z-ADDWDAIC3    WL0022           Company Number
     C                     Z-ADDWDC4NB    WL0023           Order Number
     C                     MOVELYL0005    WL0024    P      Load Status
     C                     EXSR SZRVGN
     C                     ELSE
      * CASE: LCL.Country Code is Entered
     C           YL0023    IFNE *BLANK                     *IF
      * Rtv PFS BL Cmnt f/CAT RT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0023    WL0020    P      Country Code
     C                     MOVEL'BL'      WL0021    P      Comment Type
     C                     Z-ADDWDAIC3    WL0022           Company Number
     C                     Z-ADDWDC4NB    WL0023           Order Number
     C                     MOVELYL0005    WL0024    P      Load Status
     C                     EXSR SZRVGN
     C                     END                             *FI
     C                     END                             *FI
      * PFS Cust Comment Tp BL RT - Customer Comment  * 
     C                     EXSR TARVGN
     C                     END                             *FI
     C                     END                             *FI
      * Not Dailys output these comments -  orig code before p000196
      * CASE: LCL.Company Organization is Not Daily's
     C           YL0021    IFEQ 'H'                        *IF
     C           YL0021    OREQ 'S'
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0017           Company Number
     C                     Z-ADDWDC4NB    WL0018           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    YL0023    P      Country Code
      * CASE: LCL.OHE Intended for ExportCC is Entered
     C           YL0019    IFNE *BLANK                     *IF
      * Rtv Crt PFS BOL CommntRT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0019    WL0025    P      Country Code
     C                     MOVEL'BI'      WL0026    P      Comment Type
     C                     Z-ADDWDAIC3    WL0027           Company Number
     C                     Z-ADDWDC4NB    WL0028           Order Number
     C                     MOVELYL0005    WL0029    P      Load Status
     C                     EXSR TBRVGN
     C                     ELSE
      * CASE: LCL.Country Code is Entered
     C           YL0023    IFNE *BLANK                     *IF
      * Rtv Crt PFS BOL CommntRT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0023    WL0025    P      Country Code
     C                     MOVEL'BL'      WL0026    P      Comment Type
     C                     Z-ADDWDAIC3    WL0027           Company Number
     C                     Z-ADDWDC4NB    WL0028           Order Number
     C                     MOVELYL0005    WL0029    P      Load Status
     C                     EXSR TBRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** PFS Order Header now includes the export shipping instructions
      * ** CREATE ORDER HEADER
     C                     EXSR UDSUBR                     ** CREATE ORDER
      * ** Accumulate Number of Pallets Loaded & Total Pallet Weight **
     C                     ADD  YL0011    YL0008           Number Pallets
     C                     ADD  YL0012    YL0009           Weight 1 USR
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * PFS Order Detail      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0059  30       PFS Company Num
     C                     Z-ADD*ZERO     WN0060  70       PFS Order Numbe
     C                     Z-ADD*ZERO     WN0061  30       PFS Order Line
     C                     Z-ADD*ZERO     WN0062  30       PFS Substitutio
     C                     Z-ADD*ZERO     WN0063  70       PFS Item Code
     C                     MOVEL*BLANK    WN0064 14        PFS Customer It
     C                     MOVEL*BLANK    WN0065 30        PFS Item Descri
     C                     MOVEL*BLANK    WN0066 30        PFS Item Descri
     C                     MOVEL*BLANK    WN0067  1        PFS Age Code
     C                     MOVEL*BLANK    WN0068  1        PFS Slip Sheet
     C                     MOVEL*BLANK    WN0069  1        PFS Shrink Wrap
     C                     MOVEL*BLANK    WN0070  1        PFS Palletize
     C                     MOVEL*BLANK    WN0071  3        PFS Ship From W
     C                     MOVEL*BLANK    WN0072  2        PFS Ship From W
     C                     MOVEL*BLANK    WN0073  3        PFS Ship To War
     C                     Z-ADD*ZERO     WN0074  70       PFS Scheduled Q
     C                     Z-ADD*ZERO     WN0075  82       PFS Scheduled W
     C                     Z-ADD*ZERO     WN0076  82       PFS Maximum Net
     C                     Z-ADD*ZERO     WN0077  82       PFS Minimum Uni
     C                     Z-ADD*ZERO     WN0078  82       PFS Maximum Uni
     C                     Z-ADD*ZERO     WN0079  50       PFS Estimated P
     C                     Z-ADD*ZERO     WN0080  52       PFS Average Pal
     C                     Z-ADD*ZERO     WN0081  80       PFS Oldest Date
     C                     Z-ADD*ZERO     WN0082  80       PFS Newest Date
     C                     MOVEL*BLANK    WN0083  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0084  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0085  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0086  2        PFS Pallet Type
     C                     MOVEL*BLANK    WN0087  2        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0088  1        PFS Record Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC 12/19/17 output par.pfs pallet type
      * RMC R5207 02/16/16 DLY - output sched ship date-1prod date for ne
      * RMC 03/13/07 output par.sequence no.
      * FP1309 Inventory Age  IF
      * FP1309 Inventory Age Code Description
     C                     Z-ADD0         YL0011           Number Pallets
     C                     Z-ADD0         YL0012           Weight 1 USR
     C                     Z-ADD0         WN0039           PFS Order Detai
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0004  30       Company Number
     C           WUYISX    PARM *BLANK    WQ0005  1        Plant Company S
     C           WUYJSX    PARM *BLANK    WQ0006  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WQSE01           Company Number
     C                     Z-ADDWDC4NB    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * fp1309 calculate the date for the newest and oldest
     C                     Z-ADDWBAIC3    WN0059           PFS Company Num
     C                     Z-ADDWBC4NB    WN0060           PFS Order Numbe
     C                     Z-ADDWBDPNB    WN0061           PFS Order Line
     C                     Z-ADDWBBXTM    WN0062           PFS Substitutio
      * RTV Item Ref Sts      RT - Customer  * 
     C                     EXSR SFRVGN
     C                     Z-ADDWBHGCD    WN0063           PFS Item Code
      * CASE: LCL.Item Reference Status is Both
     C           YL0013    IFEQ 'B'                        *IF
      * Rtv Cust Item Ref     RT - Customer Item Reference  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0064           PFS Customer It
     C                     END                             *FI
     C                     MOVELWBG7NA    WN0065           PFS Item Descri
     C                     MOVELWBG8NA    WN0066           PFS Item Descri
     C                     MOVELWBVGST    WN0068           PFS Slip Sheet
     C                     MOVELWDVFST    WN0069           PFS Shrink Wrap
     C                     MOVELWBVEST    WN0070           PFS Palletize
     C                     MOVELWBF5SX    WN0086           PFS Pallet Type
     C                     MOVELWBAJCD    WN0071           PFS Ship From W
      * CASE: PAR.PFS Ship From Warehouse is CFH
     C           WN0071    IFEQ 'CFH'                      *IF
     C                     MOVEL'CF1'     WN0071           PFS Ship From W
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SHRVGN
      * PFS Ship To Warehouse
      * CASE: PAR.Order Type - Sales is Transfer Order
     C           WDJNCD    IFEQ 'TR'                       *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0004           Company Number
     C                     Z-ADDWBBKC7    WL0005           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WN0073    P      Warehouse Code
     C                     END                             *FI
      * FP1309 Calculate Oldest Allowed & Newest Allowed Dates
     C                     EXSR UCSUBR                     FP1309 Calculat
      * RMC 10/14/13 E2824 Output Ordered a lieu sched - because sched ch
      *   unless User Release is Yes, then they want to short ship the sc
      * CASE: DB1.Released by User Sts Y/N is yes
     C           WBF3SX    IFEQ 'Y'                        *IF
     C                     Z-ADDWBCCQT    WN0074           PFS Scheduled Q
     C                     Z-ADDWBAUWG    WN0075           PFS Scheduled W
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBAVQT    WN0074           PFS Scheduled Q
     C                     Z-ADDWBD0WG    WN0075           PFS Scheduled W
     C                     END                             *FI
     C                     Z-ADDWBBWTM    WN0076           PFS Maximum Net
      * PFS Estimated Pallets, PFS Average Pallet Tare
      * CASE: PAR.Palletize is yes
     C           WDVEST    IFEQ 'Y'                        *IF
      * Rtv Pallet Tare/Cases RT - Item Bill Of Material  * 
     C                     EXSR SKRVGN
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C           YL0017    IFGT 0                          *IF
      * PFS Estimated Pallets
      * PAR.PFS Estimated Pallets =
      *    *COMPUTE ((x1 / x2))
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Number Cases On A Pallet
     C           WBAVQT    DIV  YL0017    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0079           PFS Estimated P
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0079           PFS Estimated P
     C                     END                             *FI
      * CASE: PAR.PFS Estimated Pallets is GT Zero
     C           WN0079    IFGT 0                          *IF
     C                     Z-ADDYL0018    WN0080           PFS Average Pal
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0079           PFS Estimated P
     C                     Z-ADD0         WN0080           PFS Average Pal
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Detail Line Status is Cancelled
      *   |- c2    : PAR.Load Status is Unlock
      *   '-
     C           WBGMST    IFEQ 'X'                        *IF
     C           YL0005    OREQ 'U'                        *OR
     C                     MOVEL'D'       WN0088           PFS Record Stat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WN0088           PFS Record Stat
     C                     END                             *FI
      * Upd Order Detail      RT - PFS Order Detail  * 
     C                     EXSR SMRVGN
      * ** Accumulate Number of Pallets & Total Pallet Weight **
     C                     ADD  WN0079    YL0011           Number Pallets
      * PAR.Weight 1 USR
      * PAR.Weight 1 USR =
      *    *COMPUTE ((x3 + (x1 * x2)))
      * x3    : PAR.Weight 1 USR
      * +     : PGM.*Synon (15,2) work field
      * x1    : PAR.PFS Average Pallet Tare
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PFS Estimated Pallets
     C           WN0080    MULT WN0079    W0WA01           *Synon (15,2) w
     C           YL0012    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0012           Weight 1 USR
     C                     ADD  1         WN0039           PFS Order Detai
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Item Ref Sts      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWBBKC7    WEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0013           Item Reference
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEQYST    YL0013           Item Reference
     C                     GOTO SFEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Cust Item Ref     RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWBBKC7    WFBKC7           Ship To Custome
     C                     Z-ADDWBHGCD    WFHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BIREKY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0064           CIR Resource No
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFCOAA    WN0064           CIR Resource No
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0071    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0072           Warehouse Type
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WN0072           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0004    WGAIC3           Company Number
     C                     Z-ADDWL0005    WGBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Warehouse Code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAJCD    WL0006           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Prev Prd Dte      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSJ01           Company Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WHBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSJ01           Company Number
     C                     Z-ADDWBAODT    WHBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSJ     SETLL@AFREPU                    *
     C           KRSSJ     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Orde
     C           WHBCDT    IFEQ WBAODT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Production Day Status is yes
     C           WHWAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWHBCDT    YL0015           Production Date
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Pallet Tare/Cases RT - Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WIHGCD    WQSK02           Item Code
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Item Code
      * Setup key
     C                     Z-ADDWBAIC3    WQSK01           Company Number
     C                     Z-ADDWBHGCD    WQSK02           Item Code
      * Establish starting position
     C           KRSSK     SETLL@IORETI                    *
     C           KRSSK     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOM Type is Supplies
     C           WIV2ST    IFEQ 'S'                        *IF
      * Rtv Pallet Tare/Cases RT - Company/Item  * 
     C                     EXSR SLRVGN
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@IORETI                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Pallet Tare/Cases RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
      * Setup key
     C                     Z-ADDWIAIC3    WJAIC3           Company Number
     C                     Z-ADDWIC9NB    WJHGCD           Item Code
      * Establish starting position
     C           KRSSL     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJURTN    YL0017           Number Cases On
     C                     Z-ADDWJSFNB    YL0018           Pallet Tare Wei
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Upd Order Detail      RT - PFS Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0089  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0090  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0091  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0092  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0093  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0094  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WKY1NX           PFS Company Num
     C                     KFLD           WKZPNX           PFS Order Numbe
     C                     KFLD           WKZXNX           PFS Order Line
     C                     KFLD           WKZYNX           PFS Substitutio
      * Setup key
     C                     Z-ADDWN0059    WKY1NX           PFS Company Num
     C                     Z-ADDWN0060    WKZPNX           PFS Order Numbe
     C                     Z-ADDWN0061    WKZXNX           PFS Order Line
     C                     Z-ADDWN0062    WKZYNX           PFS Substitutio
      * Establish starting position
     C           KRSSM     CHAIN@BCCPZP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3488' W0RTN   7
      * USER: Processing if Data record not found
      * Crt PFS Order Detail  CR - PFS Order Detail  * 
     C                     EXSR SNCRRC
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PFS Order Detail  CH - PFS Order Detail  * 
     C                     EXSR SOCHRC
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Crt PFS Order Detail  CR - PFS Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCCPZO
     C                     Z-ADDWN0059    WLY1NX           PFS Company Num
     C                     Z-ADDWN0060    WLZPNX           PFS Order Numbe
     C                     Z-ADDWN0061    WLZXNX           PFS Order Line
     C                     Z-ADDWN0062    WLZYNX           PFS Substitutio
     C                     Z-ADDWN0063    WLY2NX           PFS Item Code
     C                     MOVELWN0064    WLGIT1           PFS Customer It
     C                     MOVELWN0065    WLGGT1           PFS Item Descri
     C                     MOVELWN0066    WLGHT1           PFS Item Descri
     C                     MOVELWN0067    WLVFSX           PFS Age Code
     C                     MOVELWN0068    WLVGSX           PFS Slip Sheet
     C                     MOVELWN0069    WLVHSX           PFS Shrink Wrap
     C                     MOVELWN0070    WLVISX           PFS Palletize
     C                     MOVELWN0071    WLF8AA           PFS Ship From W
     C                     MOVELWN0072    WLV4SX           PFS Ship From W
     C                     MOVELWN0073    WLF9AA           PFS Ship To War
     C                     Z-ADDWN0074    WLZFNX           PFS Scheduled Q
     C                     Z-ADDWN0075    WLZZNX           PFS Scheduled W
     C                     Z-ADDWN0076    WLZ0NX           PFS Maximum Net
     C                     Z-ADDWN0077    WLBINY           PFS Minimum Uni
     C                     Z-ADDWN0078    WLBJNY           PFS Maximum Uni
     C                     Z-ADDWN0079    WLBKNY           PFS Estimated P
     C                     Z-ADDWN0080    WLATNY           PFS Average Pal
     C                     Z-ADDWN0081    WLALD8           PFS Oldest Date
     C                     Z-ADDWN0082    WLAMD8           PFS Newest Date
     C                     Z-ADDYL0001    WLF5NY           PFS Sequence No
     C                     MOVELWN0083    WLZISX           PFS Ord Dtl Unu
     C                     MOVELWN0084    WLZJSX           PFS Ord Dtl Unu
     C                     MOVELWN0085    WLZKSX           PFS Ord Dtl Unu
     C                     MOVELWN0086    WLZLSX           PFS Pallet Type
     C                     MOVELWN0087    WLZMSX           PFS Ord Dtl Unu
     C                     MOVELWN0088    WLUWSX           PFS Record Stat
     C                     Z-ADDWN0089    WLUXSX           PFS Process Sta
     C                     MOVELWN0090    WLV3SX           PFS Error Reaso
     C                     Z-ADDWN0091    WLAHNY           PFS Create Date
     C                     Z-ADDWN0092    WLAINY           PFS Create Time
     C                     Z-ADDWN0093    WLAJNY           PFS Change Date
     C                     Z-ADDWN0094    WLAKNY           PFS Change time
      *
      * USER: Processing before Data update
      * Set Create Stamp      IF
     C                     Z-ADD0         WLUXSX           PFS Process Sta
     C                     Z-ADD##JDT     WLAHNY           PFS Create Date
     C                     Z-ADD##JTM     WLAINY           PFS Create Time
     C           KLCRSN    KLIST
     C                     KFLD           WLY1NX           PFS Company Num
     C                     KFLD           WLZPNX           PFS Order Numbe
     C                     KFLD           WLZXNX           PFS Order Line
     C                     KFLD           WLZYNX           PFS Substitutio
      * Check for duplicate primary key
     C           KLCRSN    SETLL@BCCPZO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3489' W0RTN   7
      * Send message 'PFS Order Detail       EX'
     C                     MOVEL'USR3489' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@BCCPZO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg PFS Order Detail  CH - PFS Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0095  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0096  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0097  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0098  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0099  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0100  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BCCPZO
     C                     Z-ADDWN0059    WLY1NX           PFS Company Num
     C                     Z-ADDWN0060    WLZPNX           PFS Order Numbe
     C                     Z-ADDWN0061    WLZXNX           PFS Order Line
     C                     Z-ADDWN0062    WLZYNX           PFS Substitutio
      *
     C           KLCHSO    KLIST
     C                     KFLD           WLY1NX           PFS Company Num
     C                     KFLD           WLZPNX           PFS Order Numbe
     C                     KFLD           WLZXNX           PFS Order Line
     C                     KFLD           WLZYNX           PFS Substitutio
     C           KLCHSO    CHAIN@BCCPZO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBCCPL0'MDACP
     C                     MOVEL'@BCCPZO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBC1    YARDCS
      * Move non-key fields to @BCCPZO
     C                     Z-ADDWN0063    WLY2NX           PFS Item Code
     C                     MOVELWN0064    WLGIT1    P      PFS Customer It
     C                     MOVELWN0065    WLGGT1    P      PFS Item Descri
     C                     MOVELWN0066    WLGHT1    P      PFS Item Descri
     C                     MOVELWN0067    WLVFSX    P      PFS Age Code
     C                     MOVELWN0068    WLVGSX    P      PFS Slip Sheet
     C                     MOVELWN0069    WLVHSX    P      PFS Shrink Wrap
     C                     MOVELWN0070    WLVISX    P      PFS Palletize
     C                     MOVELWN0071    WLF8AA    P      PFS Ship From W
     C                     MOVELWN0072    WLV4SX    P      PFS Ship From W
     C                     MOVELWN0073    WLF9AA    P      PFS Ship To War
     C                     Z-ADDWN0074    WLZFNX           PFS Scheduled Q
     C                     Z-ADDWN0075    WLZZNX           PFS Scheduled W
     C                     Z-ADDWN0076    WLZ0NX           PFS Maximum Net
     C                     Z-ADDWN0077    WLBINY           PFS Minimum Uni
     C                     Z-ADDWN0078    WLBJNY           PFS Maximum Uni
     C                     Z-ADDWN0079    WLBKNY           PFS Estimated P
     C                     Z-ADDWN0080    WLATNY           PFS Average Pal
     C                     Z-ADDWN0081    WLALD8           PFS Oldest Date
     C                     Z-ADDWN0082    WLAMD8           PFS Newest Date
     C                     Z-ADDYL0001    WLF5NY           PFS Sequence No
     C                     MOVELWN0083    WLZISX    P      PFS Ord Dtl Unu
     C                     MOVELWN0084    WLZJSX    P      PFS Ord Dtl Unu
     C                     MOVELWN0085    WLZKSX    P      PFS Ord Dtl Unu
     C                     MOVELWN0086    WLZLSX    P      PFS Pallet Type
     C                     MOVELWN0087    WLZMSX    P      PFS Ord Dtl Unu
     C                     MOVELWN0088    WLUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WLAJNY           PFS Change Date
     C                     Z-ADD##JTM     WLAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BCCPZO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV OHE Intend for Exp RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WMAIC3           Company Number
     C                     Z-ADDWDC4NB    WMC4NB           Order Number
      * Establish starting position
     C           KRSSP     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMLWAA    YL0019           OHE Intended fo
     C                     GOTO SPEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WOAIC3           Company Number
      * Setup key
     C                     Z-ADDWDAIC3    WOAIC3           Company Number
      * Establish starting position
     C           KRSSQ     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0020           Plant Company S
     C                     MOVEL*BLANK    YL0021           Company Organiz
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOYISX    YL0020           Plant Company S
     C                     MOVELWOYJSX    YL0021           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Del Ord Comment   RT - PFS Order BOL Comment  * delete all f
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRY1NX    WQSR01           PFS Company Num
     C           *LIKE     DEFN WRZPNX    WQSR02           PFS Order Numbe
     C           *LIKE     DEFN WRIZST    WQSR03           PFS BOL Comment
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WQSR01           PFS Company Num
     C                     KFLD           WQSR02           PFS Order Numbe
     C                     KFLD           WQSR03           PFS BOL Comment
     C                     KFLD           WRZ1NX           PFS Sequence Nu
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           PFS Company Num
     C                     KFLD           WQSR02           PFS Order Numbe
     C                     KFLD           WQSR03           PFS BOL Comment
      * Setup key
     C                     Z-ADDWDAIC3    WQSR01           PFS Company Num
     C                     Z-ADDWDC4NB    WQSR02           PFS Order Numbe
     C                     MOVEL'BL'      WQSR03           PFS BOL Comment
     C                     Z-ADD0         WRZ1NX           PFS Sequence Nu
      * Establish starting position
     C           KPSSR     SETLL@BDCPAB                    *
     C           KRSSR     READE@BDCPAB                  90*
      * Data record not found
     C   90                MOVEL'USR3490' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del PFS BOL Comment   DL - PFS Order BOL Comment  * 
     C                     EXSR SSDLRC
     C           KRSSR     READE@BDCPAB                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSDLRC    BEGSR
      *================================================================
      * Del PFS BOL Comment   DL - PFS Order BOL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BDCPAA
     C                     Z-ADDWRY1NX    WSY1NX           PFS Company Num
     C                     Z-ADDWRZPNX    WSZPNX           PFS Order Numbe
     C                     MOVELWRIZST    WSIZST           PFS BOL Comment
     C                     Z-ADDWRZ1NX    WSZ1NX           PFS Sequence Nu
      *
     C           KLDLSS    KLIST
     C                     KFLD           WSY1NX           PFS Company Num
     C                     KFLD           WSZPNX           PFS Order Numbe
     C                     KFLD           WSIZST           PFS BOL Comment
     C                     KFLD           WSZ1NX           PFS Sequence Nu
     C           KLDLSS    CHAIN@BDCPAA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBDCPL0'MDACP
     C                     MOVEL'@BDCPAA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BDCPAA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV PFS Ord Comment   RT - Order Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQST01           Company Number
     C           *LIKE     DEFN WTC4NB    WQST02           Order Number
     C           *LIKE     DEFN WTI1SX    WQST03           Comment Type
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Order Number
     C                     KFLD           WQST03           Comment Type
      * Setup key
     C                     Z-ADDWDAIC3    WQST01           Company Number
     C                     Z-ADDWDC4NB    WQST02           Order Number
     C                     MOVEL'BL'      WQST03           Comment Type
      * Establish starting position
     C           KRSST     SETLL@COCPNU                    *
     C           KRSST     READE@COCPNU                  90*
      * Data record not found
     C   90                MOVEL'USR0486' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0007           PFS Company Num
     C                     Z-ADDWTC4NB    WL0008           PFS Order Numbe
     C                     MOVELWTI1SX    WL0009    P      PFS BOL Comment
     C                     Z-ADDYL0022    WL0010           PFS Sequence Nu
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    YL0022           PFS Sequence Nu
     C                     ADD  1         YL0022           PFS Sequence Nu
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0011           PFS Company Num
     C                     Z-ADDWTC4NB    WL0012           PFS Order Numbe
     C                     MOVELWTI1SX    WL0013    P      PFS BOL Comment
     C                     Z-ADDYL0022    WL0014           PFS Sequence Nu
     C                     MOVELWTG4NA    WL0015    P      PFS BOL Comment
     C                     MOVEL'A'       WL0016    P      PFS Record Stat
     C                     EXSR SVRVGN
     C           KRSST     READE@COCPNU                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRY1NX    WQSU01           PFS Company Num
     C           *LIKE     DEFN WRZPNX    WQSU02           PFS Order Numbe
     C           *LIKE     DEFN WRIZST    WQSU03           PFS BOL Comment
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           PFS Company Num
     C                     KFLD           WQSU02           PFS Order Numbe
     C                     KFLD           WQSU03           PFS BOL Comment
      * Setup key
     C                     Z-ADDWL0007    WQSU01           PFS Company Num
     C                     Z-ADDWL0008    WQSU02           PFS Order Numbe
     C                     MOVELWL0009    WQSU03           PFS BOL Comment
      * Establish starting position
     C           KRSSU     SETLL@BDCPAB                    *
     C           KRSSU     READE@BDCPAB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3490' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0010           PFS Sequence Nu
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWRZ1NX    WL0010           PFS Sequence Nu
     C           KRSSU     READE@BDCPAB                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0101  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0102  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0103  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0104  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0105  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0106  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WRY1NX           PFS Company Num
     C                     KFLD           WRZPNX           PFS Order Numbe
     C                     KFLD           WRIZST           PFS BOL Comment
     C                     KFLD           WRZ1NX           PFS Sequence Nu
      * Setup key
     C                     Z-ADDWL0011    WRY1NX           PFS Company Num
     C                     Z-ADDWL0012    WRZPNX           PFS Order Numbe
     C                     MOVELWL0013    WRIZST           PFS BOL Comment
     C                     Z-ADDWL0014    WRZ1NX           PFS Sequence Nu
      * Establish starting position
     C           KRSSV     CHAIN@BDCPAB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3490' W0RTN   7
      * USER: Processing if Data record not found
      * Crt PFS BOL Comment   CR - PFS Order BOL Comment  * 
     C                     EXSR SWCRRC
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PFS BOL Comment   CH - PFS Order BOL Comment  * 
     C                     EXSR SXCHRC
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Crt PFS BOL Comment   CR - PFS Order BOL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BDCPAA
     C                     Z-ADDWL0011    WSY1NX           PFS Company Num
     C                     Z-ADDWL0012    WSZPNX           PFS Order Numbe
     C                     MOVELWL0013    WSIZST           PFS BOL Comment
     C                     Z-ADDWL0014    WSZ1NX           PFS Sequence Nu
     C                     MOVELWL0015    WSGJT1           PFS BOL Comment
     C                     MOVELWL0016    WSUWSX           PFS Record Stat
     C                     Z-ADDWN0101    WSUXSX           PFS Process Sta
     C                     MOVELWN0102    WSV3SX           PFS Error Reaso
     C                     Z-ADDWN0103    WSAHNY           PFS Create Date
     C                     Z-ADDWN0104    WSAINY           PFS Create Time
     C                     Z-ADDWN0105    WSAJNY           PFS Change Date
     C                     Z-ADDWN0106    WSAKNY           PFS Change time
      *
      * USER: Processing before Data update
      * Set Create Stamp      IF
     C                     Z-ADD0         WSUXSX           PFS Process Sta
     C                     Z-ADD##JDT     WSAHNY           PFS Create Date
     C                     Z-ADD##JTM     WSAINY           PFS Create Time
     C           KLCRSW    KLIST
     C                     KFLD           WSY1NX           PFS Company Num
     C                     KFLD           WSZPNX           PFS Order Numbe
     C                     KFLD           WSIZST           PFS BOL Comment
     C                     KFLD           WSZ1NX           PFS Sequence Nu
      * Check for duplicate primary key
     C           KLCRSW    SETLL@BDCPAA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3491' W0RTN   7
      * Send message 'PFS Order BOL Comment  EX'
     C                     MOVEL'USR3491' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@BDCPAA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg PFS BOL Comment   CH - PFS Order BOL Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0107  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0108  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0109  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0110  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0111  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0112  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BDCPAA
     C                     Z-ADDWL0011    WSY1NX           PFS Company Num
     C                     Z-ADDWL0012    WSZPNX           PFS Order Numbe
     C                     MOVELWL0013    WSIZST    P      PFS BOL Comment
     C                     Z-ADDWL0014    WSZ1NX           PFS Sequence Nu
      *
     C           KLCHSX    KLIST
     C                     KFLD           WSY1NX           PFS Company Num
     C                     KFLD           WSZPNX           PFS Order Numbe
     C                     KFLD           WSIZST           PFS BOL Comment
     C                     KFLD           WSZ1NX           PFS Sequence Nu
     C           KLCHSX    CHAIN@BDCPAA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBDCPL0'MDACP
     C                     MOVEL'@BDCPAA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBD1    YBRDCS
      * Move non-key fields to @BDCPAA
     C                     MOVELWL0015    WSGJT1    P      PFS BOL Comment
     C                     MOVELWL0016    WSUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WSAJNY           PFS Change Date
     C                     Z-ADD##JTM     WSAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BDCPAA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVAIC3    WQSY01           Company Number
     C           *LIKE     DEFN WVC4NB    WQSY02           Order Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Order Number
      * Setup key
     C                     Z-ADDWL0017    WQSY01           Company Number
     C                     Z-ADDWL0018    WQSY02           Order Number
      * Establish starting position
     C           KRSSY     SETLL@BGWKAE                    *
     C           KRSSY     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0019           Country Code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WVGMST    IFEQ 'L'                        *IF
     C           WVGMST    OREQ 'A'
     C           WVGMST    OREQ 'C'
     C           WVGMST    OREQ 'R'
     C           WVGMST    OREQ 'E'
     C           WVGMST    OREQ 'H'
     C           WVGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     MOVELWVKXCD    WL0019           Country Code
     C                     GOTO SYEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSY     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv PFS BL Cmnt f/CAT RT - Country Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWKXCD    WQSZ01           Country Code
     C           *LIKE     DEFN WWI1SX    WQSZ02           Comment Type
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Country Code
     C                     KFLD           WQSZ02           Comment Type
      * Setup key
     C                     MOVELWL0020    WQSZ01           Country Code
     C                     MOVELWL0021    WQSZ02           Comment Type
      * Establish starting position
     C           KRSSZ     SETLL@B1REED                    *
     C           KRSSZ     READE@B1REED                  90*
      * Data record not found
     C   90                MOVEL'USR3594' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Comment is Not Entered
     C           WWQ6NA    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0022    WL0007           PFS Company Num
     C                     Z-ADDWL0023    WL0008           PFS Order Numbe
     C                     MOVEL'BL'      WL0009    P      PFS BOL Comment
     C                     Z-ADDYL0024    WL0010           PFS Sequence Nu
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    YL0024           PFS Sequence Nu
     C                     ADD  1         YL0024           PFS Sequence Nu
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0022    WL0011           PFS Company Num
     C                     Z-ADDWL0023    WL0012           PFS Order Numbe
     C                     MOVEL'BL'      WL0013    P      PFS BOL Comment
     C                     Z-ADDYL0024    WL0014           PFS Sequence Nu
     C                     MOVELWWQ6NA    WL0015    P      PFS BOL Comment
     C                     MOVEL'A'       WL0016    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
     C           KRSSZ     READE@B1REED                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * PFS Cust Comment Tp BL RT - Customer Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0113  70       PFS Ship To Cus
     C                     MOVEL*BLANK    WN0114  2        PFS Comment Typ
     C                     Z-ADD*ZERO     WN0115  30       PFS Sequence Nu
     C                     MOVEL*BLANK    WN0116 60        PFS Comment
     C                     MOVEL*BLANK    WN0117  1        PFS Record Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXBKC7    WQTA01           Ship To Custome
     C           *LIKE     DEFN WXI1SX    WQTA02           Comment Type
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Ship To Custome
     C                     KFLD           WQTA02           Comment Type
      * Setup key
     C                     Z-ADDWDBKC7    WQTA01           Ship To Custome
     C                     MOVEL'BL'      WQTA02           Comment Type
      * Establish starting position
     C           KRSTA     SETLL@AVCPG4                    *
     C           KRSTA     READE@AVCPG4                  90*
      * Data record not found
     C   90                MOVEL'USR2993' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0007           PFS Company Num
     C                     Z-ADDWDC4NB    WL0008           PFS Order Numbe
     C                     MOVEL'BL'      WL0009    P      PFS BOL Comment
     C                     Z-ADDWN0115    WL0010           PFS Sequence Nu
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    WN0115           PFS Sequence Nu
     C                     ADD  1         WN0115           PFS Sequence Nu
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0011           PFS Company Num
     C                     Z-ADDWDC4NB    WL0012           PFS Order Numbe
     C                     MOVEL'BL'      WL0013    P      PFS BOL Comment
     C                     Z-ADDWN0115    WL0014           PFS Sequence Nu
     C                     MOVELWXXRTX    WL0015    P      PFS BOL Comment
     C                     MOVEL'A'       WL0016    P      PFS Record Stat
     C                     EXSR SVRVGN
     C           KRSTA     READE@AVCPG4                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Crt PFS BOL CommntRT - Country Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWKXCD    WQTB01           Country Code
     C           *LIKE     DEFN WWI1SX    WQTB02           Comment Type
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Country Code
     C                     KFLD           WQTB02           Comment Type
      * Setup key
     C                     MOVELWL0025    WQTB01           Country Code
     C                     MOVELWL0026    WQTB02           Comment Type
      * Establish starting position
     C           KRSTB     SETLL@B1REED                    *
     C           KRSTB     READE@B1REED                  90*
      * Data record not found
     C   90                MOVEL'USR3594' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Comment is Not Entered
     C           WWQ6NA    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Load Status is Unlock
     C           WL0029    IFEQ 'U'                        *IF
     C                     MOVEL'D'       YL0025           PFS Record Stat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       YL0025           PFS Record Stat
     C                     END                             *FI
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0027    WL0011           PFS Company Num
     C                     Z-ADDWL0028    WL0012           PFS Order Numbe
     C                     MOVELWWI1SX    WL0013    P      PFS BOL Comment
     C                     Z-ADDWWM5NX    WL0014           PFS Sequence Nu
     C                     MOVELWWQ6NA    WL0015    P      PFS BOL Comment
     C                     MOVELYL0025    WL0016    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
     C           KRSTB     READE@B1REED                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv All Values        RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WYBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWDBKC7    WYBKC7           Ship To Custome
      * Establish starting position
     C           KRSTC     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0014           Email Address
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWYUGTX    WN0014           Email Address
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWDBKC7    WEBKC7           Ship To Custome
      * Establish starting position
     C           KRSTD     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBVTX    WN0015           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Carr Appt Dt/Tm   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TARMNB    WQTE02           Load ID
     C           *LIKE     DEFN TAC4NB    WQTE03           Order Number
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE02           Load ID
     C                     KFLD           WQTE03           Order Number
      * Setup key
     C                     Z-ADDWDRMNB    WQTE02           Load ID
     C                     Z-ADDWDC4NB    WQTE03           Order Number
      * Establish starting position
     C           KRSTE     SETLL@FLCPKF                    *
     C           KRSTE     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDTAN7DT    YL0029           Appointment Con
     C                     Z-ADDTAB3TM    YL0030           Appointment Con
     C                     GOTO TEEXIT                     *QUIT
     C           KRSTE     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV OHE Delivery PO #  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WMAIC3           Company Number
     C                     Z-ADDWDC4NB    WMC4NB           Order Number
      * Establish starting position
     C           KRSTF     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0051           Delivery P.O. N
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMLMT1    WN0051           Delivery P.O. N
     C                     GOTO TFEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV From/To WHS   PFS RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQTG01           Company Number
     C           *LIKE     DEFN WBC4NB    WQTG02           Order Number
      * Define keylist
     C           KPSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WQTG02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WQTG02           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WQTG01           Company Number
     C                     Z-ADDWDC4NB    WQTG02           Order Number
     C                     Z-ADD0         WBDPNB           Order Sequence
     C                     Z-ADD0         WBUENB           Order Secondary
      * Establish starting position
     C           KPSTG     SETLL@BGWKL1                    *
     C           KRSTG     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0037           Warehouse Code
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           WBGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELWBAJCD    WN0037           Warehouse Code
     C                     GOTO TGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTG     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV PFS Export Inst    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WMAIC3           Company Number
     C                     Z-ADDWDC4NB    WMC4NB           Order Number
      * Establish starting position
     C           KRSTH     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0040           Shipping Line
     C                     MOVEL*BLANK    YL0010           Port Delv Termi
     C                     MOVEL*BLANK    WN0044           OHE City
     C                     MOVEL*BLANK    WN0047           OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0048           OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0050           OHE Booking Num
     C                     MOVEL*BLANK    WN0049           OHE Discharge P
     C                     Z-ADD*ZERO     YL0031           OHE Sail/Flight
     C                     Z-ADD*ZERO     YL0032           OHE Port Cut Da
     C                     Z-ADD*ZERO     YL0033           OHE Arrival Dat
     C                     MOVEL*BLANK    YL0034           OHE Late Delive
     C                     MOVEL*BLANK    YL0035           OHE Ship Status
     C                     MOVEL*BLANK    YL0036           OHE Container N
     C                     MOVEL*BLANK    YL0037           OHE Comment 1
     C                     MOVEL*BLANK    YL0038           OHE Comment 2
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMXACD    WN0040           Shipping Line
     C                     MOVELWMOANA    YL0010           Port Delv Termi
     C                     MOVELWMHBAA    WN0044           OHE City
     C                     MOVELWMJ0T1    WN0047           OHE Vessel/Airl
     C                     MOVELWMGENY    WN0048           OHE Voyage/Flig
     C                     MOVELWMJ1T1    WN0050           OHE Booking Num
     C                     MOVELWMHCAA    WN0049           OHE Discharge P
     C                     Z-ADDWMQWDT    YL0031           OHE Sail/Flight
     C                     Z-ADDWMQXDT    YL0032           OHE Port Cut Da
     C                     Z-ADDWMQYDT    YL0033           OHE Arrival Dat
     C                     MOVELWMHDAA    YL0034           OHE Late Delive
     C                     MOVELWMCCTX    YL0035           OHE Ship Status
     C                     MOVELWMJ2T1    YL0036           OHE Container N
     C                     MOVELWMRLNA    YL0037           OHE Comment 1
     C                     MOVELWMRMNA    YL0038           OHE Comment 2
     C                     GOTO THEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           TBXACD           Shipping Line
     C                     KFLD           TBOANA           Port Delv Termi
      * Setup key
     C                     MOVELWN0040    TBXACD           Shipping Line
     C                     MOVELYL0010    TBOANA           Port Delv Termi
      * Establish starting position
     C           KRSTI     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0044           Port City
     C                     MOVEL*BLANK    WN0042           Port Address Li
     C                     MOVEL*BLANK    WN0043           Port Address Li
     C                     MOVEL*BLANK    WN0045           Sail Port State
     C                     MOVEL*BLANK    WN0046           Port Zip/Postal
     C                     Z-ADD*ZERO     YL0039           Port Phone Numb
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTBOKTX    WN0044           Port City
     C                     MOVELTBLBTX    WN0042           Port Address Li
     C                     MOVELTBLATX    WN0043           Port Address Li
     C                     MOVELTBXBCD    WN0045           Sail Port State
     C                     MOVELTBLCTX    WN0046           Port Zip/Postal
     C                     Z-ADDTBSPPN    YL0039           Port Phone Numb
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Upd Order Header      RT - PFS Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0134  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0135  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0136  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0137  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0138  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0139  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * LJB 1/14/09 FP1303 Add PFS Delivery P.O. Number (new field)
      * RMC 03/13/07 output par.sequence no
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           TCY1NX           PFS Company Num
     C                     KFLD           TCZPNX           PFS Order Numbe
      * Setup key
     C                     Z-ADDWN0001    TCY1NX           PFS Company Num
     C                     Z-ADDWN0002    TCZPNX           PFS Order Numbe
      * Establish starting position
     C           KRSTJ     CHAIN@BBCPZS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3486' W0RTN   7
      * USER: Processing if Data record not found
      * Crt PFS Order Header  CR - PFS Order Header  * 
     C                     EXSR TKCRRC
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PFS Order Header  CH - PFS Order Header  * 
     C                     EXSR TLCHRC
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt PFS Order Header  CR - PFS Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BBCPZR
     C                     Z-ADDWN0001    TDY1NX           PFS Company Num
     C                     Z-ADDWN0002    TDZPNX           PFS Order Numbe
     C                     Z-ADDWN0003    TDZGNX           PFS Load ID
     C                     Z-ADDYL0007    TDZWNX           PFS Loading Seq
     C                     Z-ADDWN0004    TDZVNX           PFS Load Stop N
     C                     MOVELWN0005    TDVCSX           PFS Order Type
     C                     Z-ADDWN0006    TDZQNX           PFS Ship To Cus
     C                     MOVELWN0007    TDF0T1           PFS Ship To Cus
     C                     MOVELWN0008    TDF1T1           PFS Ship To Cus
     C                     MOVELWN0009    TDF2T1           PFS Ship To Cus
     C                     MOVELWN0010    TDGUT1           PFS Ship To Cus
     C                     MOVELWN0011    TDF3T1           PFS Ship To Cus
     C                     MOVELWN0012    TDF4T1           PFS Ship To Cus
     C                     MOVELWN0013    TDF5T1           PFS Ship To Cus
     C                     MOVELWN0014    TDF6T1           PFS Ship To Ema
     C                     MOVELWN0015    TDF7T1           PFS Ship To Pho
     C                     Z-ADDWN0016    TDZENX           PFS Bill To Cus
     C                     MOVELWN0017    TDF8T1           PFS Bill To Cus
     C                     MOVELWN0018    TDF9T1           PFS Bill To Cus
     C                     MOVELWN0019    TDGAT1           PFS Bill To Cus
     C                     MOVELWN0020    TDGVT1           PFS Bill To Cus
     C                     MOVELWN0021    TDGBT1           PFS Bill To Cus
     C                     MOVELWN0022    TDGCT1           PFS Bill To Cus
     C                     MOVELWN0023    TDGDT1           PFS Bill To Cus
     C                     MOVELWN0024    TDFZT1           PFS Customer PO
     C                     Z-ADDWN0025    TDZRNX           PFS Order Date
     C                     Z-ADDWN0026    TDZSNX           PFS Scheduled S
     C                     Z-ADDWN0027    TDZTNX           PFS Requested D
     C                     Z-ADDWN0028    TDZUNX           PFS Requested D
     C                     MOVELWN0029    TDVBSX           PFS Export Stat
     C                     MOVELWN0030    TDU3SX           PFS Country Cod
     C                     MOVELWN0031    TDGET1           PFS Special Ins
     C                     MOVELWN0032    TDGFT1           PFS Special Ins
     C                     Z-ADDWN0033    TDA1NY           PFS Maximum Gro
     C                     Z-ADDWN0034    TDBKNY           PFS Estimated P
     C                     Z-ADDWN0035    TDATNY           PFS Average Pal
     C                     MOVELWN0036    TDVESX           PFS Order Statu
     C                     MOVELWN0037    TDF8AA           PFS Ship From W
     C                     MOVELWN0038    TDF9AA           PFS Ship To War
     C                     Z-ADDWN0039    TDC5NY           PFS Order Detai
     C                     Z-ADDYL0001    TDF5NY           PFS Sequence No
     C                     MOVELWN0040    TDF5AA           PFS Shipping Li
     C                     MOVELWN0041    TDFRT1           PFS Shipping Li
     C                     MOVELWN0042    TDFST1           PFS Shipping Li
     C                     MOVELWN0043    TDFTT1           PFS Shipping Li
     C                     MOVELWN0044    TDFUT1           PFS Shipping Li
     C                     MOVELWN0045    TDFVT1           PFS Shipping Li
     C                     MOVELWN0046    TDFWT1           PFS Shipping LI
     C                     MOVELWN0047    TDFXT1           PFS Vessel Name
     C                     MOVELWN0048    TDZLNX           PFS Voyage
     C                     MOVELWN0049    TDF7AA           PFS Discharge P
     C                     MOVELWN0050    TDF6AA           PFS Booking Num
     C                     MOVELWN0051    TDS6NA           PFS Delivery P.
     C                     MOVELWN0052    TDZDSX           PFS Order Unuse
     C                     MOVELWN0053    TDZESX           PFS Order Unuse
     C                     MOVELWN0054    TDZFSX           PFS Order Unuse
     C                     MOVELWN0055    TDZGSX           PFS Order Unuse
     C                     MOVELWN0056    TDZHSX           PFS Order Unuse
     C                     MOVELWN0057    TDMXU1           PFS Order Unuse
     C                     MOVELWN0058    TDUWSX           PFS Record Stat
     C                     Z-ADDWN0134    TDUXSX           PFS Process Sta
     C                     MOVELWN0135    TDV3SX           PFS Error Reaso
     C                     Z-ADDWN0136    TDAHNY           PFS Create Date
     C                     Z-ADDWN0137    TDAINY           PFS Create Time
     C                     Z-ADDWN0138    TDAJNY           PFS Change Date
     C                     Z-ADDWN0139    TDAKNY           PFS Change time
      *
      * USER: Processing before Data update
      * Set Create Stamp      IF
     C                     Z-ADD0         TDUXSX           PFS Process Sta
     C                     Z-ADD##JDT     TDAHNY           PFS Create Date
     C                     Z-ADD##JTM     TDAINY           PFS Create Time
     C           KLCRTK    KLIST
     C                     KFLD           TDY1NX           PFS Company Num
     C                     KFLD           TDZPNX           PFS Order Numbe
      * Check for duplicate primary key
     C           KLCRTK    SETLL@BBCPZR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3487' W0RTN   7
      * Send message 'PFS Order Header       EX'
     C                     MOVEL'USR3487' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@BBCPZR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Chg PFS Order Header  CH - PFS Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0140  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0141  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0142  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0143  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0144  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0145  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BBCPZR
     C                     Z-ADDWN0001    TDY1NX           PFS Company Num
     C                     Z-ADDWN0002    TDZPNX           PFS Order Numbe
      *
     C           KLCHTL    KLIST
     C                     KFLD           TDY1NX           PFS Company Num
     C                     KFLD           TDZPNX           PFS Order Numbe
     C           KLCHTL    CHAIN@BBCPZR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBBCPL0'MDACP
     C                     MOVEL'@BBCPZR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBB1    YCRDCS
      * Move non-key fields to @BBCPZR
     C                     Z-ADDWN0003    TDZGNX           PFS Load ID
     C                     Z-ADDYL0007    TDZWNX           PFS Loading Seq
     C                     Z-ADDWN0004    TDZVNX           PFS Load Stop N
     C                     MOVELWN0005    TDVCSX    P      PFS Order Type
     C                     Z-ADDWN0006    TDZQNX           PFS Ship To Cus
     C                     MOVELWN0007    TDF0T1    P      PFS Ship To Cus
     C                     MOVELWN0008    TDF1T1    P      PFS Ship To Cus
     C                     MOVELWN0009    TDF2T1    P      PFS Ship To Cus
     C                     MOVELWN0010    TDGUT1    P      PFS Ship To Cus
     C                     MOVELWN0011    TDF3T1    P      PFS Ship To Cus
     C                     MOVELWN0012    TDF4T1    P      PFS Ship To Cus
     C                     MOVELWN0013    TDF5T1    P      PFS Ship To Cus
     C                     MOVELWN0014    TDF6T1    P      PFS Ship To Ema
     C                     MOVELWN0015    TDF7T1    P      PFS Ship To Pho
     C                     Z-ADDWN0016    TDZENX           PFS Bill To Cus
     C                     MOVELWN0017    TDF8T1    P      PFS Bill To Cus
     C                     MOVELWN0018    TDF9T1    P      PFS Bill To Cus
     C                     MOVELWN0019    TDGAT1    P      PFS Bill To Cus
     C                     MOVELWN0020    TDGVT1    P      PFS Bill To Cus
     C                     MOVELWN0021    TDGBT1    P      PFS Bill To Cus
     C                     MOVELWN0022    TDGCT1    P      PFS Bill To Cus
     C                     MOVELWN0023    TDGDT1    P      PFS Bill To Cus
     C                     MOVELWN0024    TDFZT1    P      PFS Customer PO
     C                     Z-ADDWN0025    TDZRNX           PFS Order Date
     C                     Z-ADDWN0026    TDZSNX           PFS Scheduled S
     C                     Z-ADDWN0027    TDZTNX           PFS Requested D
     C                     Z-ADDWN0028    TDZUNX           PFS Requested D
     C                     MOVELWN0029    TDVBSX    P      PFS Export Stat
     C                     MOVELWN0030    TDU3SX    P      PFS Country Cod
     C                     MOVELWN0031    TDGET1    P      PFS Special Ins
     C                     MOVELWN0032    TDGFT1    P      PFS Special Ins
     C                     Z-ADDWN0033    TDA1NY           PFS Maximum Gro
     C                     Z-ADDWN0034    TDBKNY           PFS Estimated P
     C                     Z-ADDWN0035    TDATNY           PFS Average Pal
     C                     MOVELWN0036    TDVESX    P      PFS Order Statu
     C                     MOVELWN0037    TDF8AA    P      PFS Ship From W
     C                     MOVELWN0038    TDF9AA    P      PFS Ship To War
     C                     Z-ADDWN0039    TDC5NY           PFS Order Detai
     C                     Z-ADDYL0001    TDF5NY           PFS Sequence No
     C                     MOVELWN0040    TDF5AA    P      PFS Shipping Li
     C                     MOVELWN0041    TDFRT1    P      PFS Shipping Li
     C                     MOVELWN0042    TDFST1    P      PFS Shipping Li
     C                     MOVELWN0043    TDFTT1    P      PFS Shipping Li
     C                     MOVELWN0044    TDFUT1    P      PFS Shipping Li
     C                     MOVELWN0045    TDFVT1    P      PFS Shipping Li
     C                     MOVELWN0046    TDFWT1    P      PFS Shipping LI
     C                     MOVELWN0047    TDFXT1    P      PFS Vessel Name
     C                     MOVELWN0048    TDZLNX    P      PFS Voyage
     C                     MOVELWN0049    TDF7AA    P      PFS Discharge P
     C                     MOVELWN0050    TDF6AA    P      PFS Booking Num
     C                     MOVELWN0051    TDS6NA    P      PFS Delivery P.
     C                     MOVELWN0052    TDZDSX    P      PFS Order Unuse
     C                     MOVELWN0053    TDZESX    P      PFS Order Unuse
     C                     MOVELWN0054    TDZFSX    P      PFS Order Unuse
     C                     MOVELWN0055    TDZGSX    P      PFS Order Unuse
     C                     MOVELWN0056    TDZHSX    P      PFS Order Unuse
     C                     MOVELWN0057    TDMXU1    P      PFS Order Unuse
     C                     MOVELWN0058    TDUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     TDAJNY           PFS Change Date
     C                     Z-ADD##JTM     TDAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BBCPZR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- copied from reg carlisle lh
      *================================================================
      * Create all records for this order/load with same sequence.
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SARVGN
     C                     ADD  1         YL0001           PFS Sequence No
      * Skip 0
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0001    IFEQ *ZERO                      *IF
     C                     ADD  1         YL0001           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C                     PARM YL0001    WQ0003 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * 12/19/17
      * RMC R12371 For Foods - output pallet type to pfs order detail BCZ
      * *****
      * RMC P000196 For Dailys Cat2 -- output Order comments and customer
      *   to PFS Order Comment file
      * *****
      * LJB FP1303 1/14/08  Added PFS Delivery P.O., new field that is
      * in the Order Heder EXT file and may be added in Order Entry.
      * *****
      * RMC PFS015 8/14/06  Added receipt order sts par for TR from ext
      *      Whse to Internal Whse that is Live w/Carlisle.
      *      Order Type will be "RO" in PFS Order Header record.
      * *****
      * RMC 03/13/07 output par.sequence no
      * *****
      * ** FP1101-4 LJB 04/06/2007
      * ** Get the Export Status from the Order Header. If this is
      * ** an Export Order, get the Customer Order Export Instructions fr
      * ** the Order Header Extension file.
      * *****
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * FP1309 Calculate Oldest Allowed & Newest Allowed Dates
      *================================================================
      * FP1309 Calculate Oldest Allowed & Newest Allowed Dates
     C                     MOVELWUJ1TX    WN0067           PFS Age Code
     C                     Z-ADD0         WN0081           PFS Oldest Date
     C                     Z-ADD0         WN0082           PFS Newest Date
      * **** Calculate both dates ****
      * The oldest allowed date is either the Override From date or
      * Requested Delivery Date - Item Age Days.
      * Val Age Information   IF
     C                     MOVEL*BLANK    WUB8SX           Error Flag
     C                     MOVEL*BLANK    YL0014           Error Status
     C                     MOVEL*BLANK    WUKWTX           Error Reason De
     C                     MOVEL*BLANK    WUKXTX           Error Reason De
     C                     MOVEL*BLANK    WUKYTX           Error Reason De
     C                     MOVEL*BLANK    WUKZTX           Error Reason De
     C                     MOVEL*BLANK    WUTITX           Error Reason De
      * CASE: PAR.Company Organization is Seaboard
     C           WUYJSX    IFEQ 'S'                        *IF
      * CASE: PAR.Requested Delivery Date is not entered
     C           WDEIDT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  WDEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Send message 'Requested Delv Date Error'
     C                     MOVEL'USR4329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Scheduled Ship Date is not entered
     C           WBAODT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  WBAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0002
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHGCD    WQ0007  70       Item Code
     C                     PARM WBAJCD    WQ0008  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0009  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0010 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0011 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0012 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0013 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0014 30        Error Reason De
     C                     PARM WBAIC3    WQ0015  30       Company Number
     C                     PARM WBAODT    WQ0016  70       Scheduled Ship
     C                     PARM WDEIDT    WQ0017  70       Requested Deliv
     C                     PARM WBRINY    WQ0018  40       Item Age Days
     C                     PARM WBTIDT    WQ0019  70       Production Ovr
     C                     PARM WBTJDT    WQ0020  70       Production Ovr
     C           WN0081    PARM WN0081    WQ0021  70       Production AgeD
     C           WN0082    PARM WN0082    WQ0022  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB8SX    IFEQ 'Y'                        *IF
     C           'C'       IFEQ 'V'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WN0081    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWBRINY    ZA0004           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WBTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0005
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WBTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0006
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWBRINY    ZA0007           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WBTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0008
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WBTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWBRINY    ZA0010           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WBTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WBTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0012
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWBRINY    ZA0013           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WBTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0014
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WBTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0015
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
     C           WBTIDT    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADDWBRINY    ZA0016           Item Age Days
      * Send message 'Invalid Item Age Days'
     C                     MOVEL'USR4309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WN0081    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0017
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  WN0082    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Send message 'Invalid Prod OvrDates'
     C                     MOVEL'USR4310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       YL0014           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Newest date is from the Schedule Ship Date unless User OvrR
      * CASE: DB1.Production Ovr AgeDte To is GT Zero
     C           WBTJDT    IFGT 0                          *IF
      * The newest allowed date: If entered - Override To date will be us
     C                     ELSE
      * CASE: *OTHERWISE
      * The newest allowed date: If there is no override then
      * the newest allowed date = Schedule Ship Date
      * Carlisle application adds the chill time in their process
      * Requested from John Z during technical review.  FP1309
     C                     Z-ADDWBAODT    WN0082           PFS Newest Date
     C                     END                             *FI
      * R5207 2/16/16  Dailys  Only  - newest prod date
      * CASE: WRK.Company Organization is Daily's
     C           WUYJSX    IFEQ 'D'                        *IF
      * Rtv Prev Prd Dte      RT - Calendar  * 
     C                     EXSR SJRVGN
     C                     MOVEL*BLANK    WUR4TX           Date (Alpha) US
     C                     MOVELYL0015    WUR4TX           Date (Alpha) US
     C                     Z-ADD6         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUR4TX:ZQ WUT7TX    P  90  Date (Char-6) U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           '20'      CAT  WUT7TX:ZQ YL0016    P      Date (Char-8) U
     C                     MOVE YL0016    WN0082           PFS Newest Date
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ** CREATE ORDER HEADER
      *================================================================
     C                     Z-ADDWDAIC3    WN0001           PFS Company Num
     C                     Z-ADDWDC4NB    WN0002           PFS Order Numbe
     C                     Z-ADDP1RMNB    WN0003           PFS Load ID
     C                     Z-ADDYL0006    WN0004           PFS Load Stop N
     C                     MOVELWDJNCD    WN0005           PFS Order Type
     C                     Z-ADDWDBKC7    WN0006           PFS Ship To Cus
     C                     MOVELWDBRTX    WN0007           PFS Ship To Cus
     C                     MOVELWDHMNA    WN0008           PFS Ship To Cus
     C                     MOVELWDHONA    WN0009           PFS Ship To Cus
     C                     MOVELWDHPNA    WN0010           PFS Ship To Cus
     C                     MOVELWDHNNA    WN0011           PFS Ship To Cus
     C                     MOVELWDDBCD    WN0012           PFS Ship To Cus
     C                     MOVELWDCKTX    WN0013           PFS Ship To Cus
      * Rtv All Values        RT - Customer EXT  * 
     C                     EXSR TCRVGN
      * RTV Customer Telephone RT - Customer  * 
     C                     EXSR TDRVGN
     C                     Z-ADDWDB0C7    WN0016           PFS Bill To Cus
     C                     MOVELWDAETX    WN0017           PFS Bill To Cus
     C                     MOVELWDB1NA    WN0018           PFS Bill To Cus
     C                     MOVELWDB3NA    WN0019           PFS Bill To Cus
     C                     MOVELWDB4NA    WN0020           PFS Bill To Cus
     C                     MOVELWDB2NA    WN0021           PFS Bill To Cus
     C                     MOVELWDBHCD    WN0022           PFS Bill To Cus
     C                     MOVELWDC8TX    WN0023           PFS Bill To Cus
     C                     MOVELWDBCNA    WN0024           PFS Customer PO
      *
     C                     MOVEL*BLANK    WN0118  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0119  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0120  2        Month (Char) US
     C                     MOVEL*BLANK    WN0121  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WDA0DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0026
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WDA0DT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0027
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WDA0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0028
     C                     MOVEL*BLANK    WN0119           Year Alpha (YYY
     C                     MOVELYL0026    WN0119           Year Alpha (YYY
     C                     MOVELYL0027    WN0120           Month (Char) US
     C                     MOVELYL0028    WN0121           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0119    CAT  WN0120:ZQ WN0118    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0118    CAT  WN0121:ZQ WN0118    P      Date (Char-8) U
     C                     MOVE WN0118    WN0025           Date Out (8,0)
      *
     C                     MOVEL*BLANK    WN0122  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0123  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0124  2        Month (Char) US
     C                     MOVEL*BLANK    WN0125  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WDAODT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0026
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WDAODT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0027
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WDAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0028
     C                     MOVEL*BLANK    WN0123           Year Alpha (YYY
     C                     MOVELYL0026    WN0123           Year Alpha (YYY
     C                     MOVELYL0027    WN0124           Month (Char) US
     C                     MOVELYL0028    WN0125           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0123    CAT  WN0124:ZQ WN0122    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0122    CAT  WN0125:ZQ WN0122    P      Date (Char-8) U
     C                     MOVE WN0122    WN0026           Date Out (8,0)
     C                     Z-ADD0         YL0029           LD Carrier Appt
     C                     Z-ADD0         YL0030           LD Carrier Appt
      * E4119 RMC 9/2/16 TMS Use appt date/time if there, else use req de
      * CASE: DB1.OH Load Plan Ready is Yes
     C           WDFVSX    IFEQ 'Y'                        *IF
      * RTV Carr Appt Dt/Tm   RT - Load Detail  * 
     C                     EXSR TERVGN
     C                     END                             *FI
      * CASE: LCL.LD Carrier Appt Date is Entered
     C           YL0029    IFGT 0                          *IF
      *
     C                     MOVEL*BLANK    WN0126  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0127  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0128  2        Month (Char) US
     C                     MOVEL*BLANK    WN0129  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           YL0029    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0026
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           YL0029    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0027
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           YL0029    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0028
     C                     MOVEL*BLANK    WN0127           Year Alpha (YYY
     C                     MOVELYL0026    WN0127           Year Alpha (YYY
     C                     MOVELYL0027    WN0128           Month (Char) US
     C                     MOVELYL0028    WN0129           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0127    CAT  WN0128:ZQ WN0126    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0126    CAT  WN0129:ZQ WN0126    P      Date (Char-8) U
     C                     MOVE WN0126    WN0027           Date Out (8,0)
     C                     Z-ADDYL0030    WN0028           PFS Requested D
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0130  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0131  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0132  2        Month (Char) US
     C                     MOVEL*BLANK    WN0133  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WDEIDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0026
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WDEIDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0027
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WDEIDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0028
     C                     MOVEL*BLANK    WN0131           Year Alpha (YYY
     C                     MOVELYL0026    WN0131           Year Alpha (YYY
     C                     MOVELYL0027    WN0132           Month (Char) US
     C                     MOVELYL0028    WN0133           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0131    CAT  WN0132:ZQ WN0130    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0130    CAT  WN0133:ZQ WN0130    P      Date (Char-8) U
     C                     MOVE WN0130    WN0027           Date Out (8,0)
     C           100       MULT WDAFTM    WN0028           PFS Requested D
     C                     END                             *FI
     C                     MOVELWDU2ST    WN0029           PFS Export Stat
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0017           Company Number
     C                     Z-ADDWDC4NB    WL0018           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    WN0030    P      Country Code
      * ** 01/14/2009 LJB FP1303 Retrieve new delivery p.o.number
      * RTV OHE Delivery PO #  RT - Order Header Extension  * 
     C                     EXSR TFRVGN
      * CASE: PAR.PFS Country Code is Not Entered
     C           WN0030    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    WN0030           PFS Country Cod
     C                     MOVEL'USA'     WN0030           PFS Country Cod
     C                     END                             *FI
     C                     MOVELWDB6NA    WN0031           PFS Special Ins
     C                     MOVELWDBYNA    WN0032           PFS Special Ins
     C                     Z-ADDWDBPTM    WN0033           PFS Maximum Gro
     C                     Z-ADDYL0011    WN0034           PFS Estimated P
      * avg pallet tare
      * CASE: LCL.Number Pallets Loaded is Not zero
     C           YL0011    IFNE 0                          *IF
     C           YL0012    DIV  YL0011    WN0035    H      PFS Average Pal
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0035           PFS Average Pal
     C                     END                             *FI
      * RTV From/To WHS   PFS RT - Order Detail  * 
     C                     EXSR TGRVGN
      * Warehouse CFH to CF1
      * CASE: PAR.PFS Ship From Warehouse is CFH
     C           WN0037    IFEQ 'CFH'                      *IF
     C                     MOVEL'CF1'     WN0037           PFS Ship From W
     C                     END                             *FI
      * PFS Ship To Warehouse for Transfers
      * CASE: DB1.Order Type - Sales is Transfer Order
     C           WDJNCD    IFEQ 'TR'                       *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0004           Company Number
     C                     Z-ADDWDBKC7    WL0005           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WN0038    P      Warehouse Code
     C                     END                             *FI
      * invoiced status
      * CASE: DB1.Invoice Number is GT Zero
     C           WDCONB    IFGT 0                          *IF
     C                     MOVEL'C'       WN0036           PFS Order Statu
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWDGWST    WN0036           PFS Order Statu
     C                     END                             *FI
      * --------
      * load status
      * CASE: PAR.Load Status is Unlock
     C           YL0005    IFEQ 'U'                        *IF
     C                     MOVEL'D'       WN0058           PFS Record Stat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WN0058           PFS Record Stat
     C                     END                             *FI
      * PFS015 RMC 8/14/06
      * CASE: PAR.Receipt Order Sts USR is yes
     C           'N'       IFEQ 'Y'                        *IF
     C                     MOVEL'RO'      WN0005           PFS Order Type
     C                     END                             *FI
      * **************************************************************
      * ** FP1101-4 LJB 04/06/2007
      * ** Get Customer Order Export Instructions from OHE
      * CASE: DB1.Export Status is yes
     C           WDU2ST    IFEQ 'Y'                        *IF
      * ** FP1101
     C                     MOVELWDU2ST    WN0029           PFS Export Stat
      * RTV PFS Export Inst    RT - Order Header Extension  * 
     C                     EXSR THRVGN
      * ** Shipping line and port terminal info
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.PFS Shipping Line is Entered
      *   |- c2    : PAR.Port Delv Terminal is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0040    IFNE *BLANK                     *IF
     C           YL0010    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
     C                     EXSR TIRVGN
     C                     MOVEL*BLANK    WN0041           PFS Shipping Li
     C                     MOVELYL0010    WN0041           PFS Shipping Li
     C                     MOVEL*BLANK    WN0015           PFS Ship To Pho
     C                     MOVELYL0039    WN0015           PFS Ship To Pho
     C                     END                             *FI
     C                     END                             *FI
      * ** Update includes new Order Header Extension file export data
      * 07/12/19 DN R15161-Sent in PAR.PFS Load Unused Text 1.
      * Upd Order Header      RT - PFS Order Header  * 
     C                     EXSR TJRVGN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAM8NB           System Value Nu
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WBGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WCBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Plant Company Sts
     C                     MOVEL*BLANK    WUYISX  1
      * Define work field Company Organization
     C                     MOVEL*BLANK    WUYJSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEP3NB           D & B Number
     C                     Z-ADD*ZERO     WEI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WEAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WES2NB           Parent Credit L
     C                     Z-ADD*ZERO     WEVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WEI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGR5NB           Deliver after t
     C                     Z-ADD*ZERO     WGR6NB           Deliver before
     C                     Z-ADD*ZERO     WGTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WGMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WGW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field BLANK 1               USR
     C                     MOVEL*BLANK    WUJ1TX 25
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WHCQNB           Julian Date
     C                     Z-ADD*ZERO     WHESNB           Accounting Year
     C                     Z-ADD*ZERO     WHETNB           Accounting Peri
     C                     Z-ADD*ZERO     WHBZNB           OM Week
     C                     Z-ADD*ZERO     WHEINB           Week Number
     C                     Z-ADD*ZERO     WHAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WHOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WHNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WHNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WHOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WHOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Date (Alpha) USR
     C                     MOVEL*BLANK    WUR4TX  7
      * Define work field Date (Char-6) USR
     C                     MOVEL*BLANK    WUT7TX  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIC9NB           Component Item
     C                     Z-ADD*ZERO     WIBOPR           Sales Yield
     C                     Z-ADD*ZERO     WIBPPR           Production Yiel
     C                     Z-ADD*ZERO     WIHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WICNSM           Consume Priorit
     C                     Z-ADD*ZERO     WIBMY1           Consume Priorit
     C                     Z-ADD*ZERO     WIBMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WIIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WIIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAIWG           Unit Weight
     C                     Z-ADD*ZERO     WJCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WJC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WJURTN           Number Cases On
     C                     Z-ADD*ZERO     WJAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJTFNB           Transportation
     C                     Z-ADD*ZERO     WJTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WJTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WJBLPR           Market Overage
     C                     Z-ADD*ZERO     WJBMPR           Standard Overag
     C                     Z-ADD*ZERO     WJCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WJCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WJSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WJPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WJICN1           Item Category N
     C                     Z-ADD*ZERO     WJICN2           Item Category N
     C                     Z-ADD*ZERO     WJV2NB           Item Category N
     C                     Z-ADD*ZERO     WJITCN           Item Category N
     C                     Z-ADD*ZERO     WJITC5           Item Category N
     C                     Z-ADD*ZERO     WJICN6           Item Category N
     C                     Z-ADD*ZERO     WJICN7           Item Category N
     C                     Z-ADD*ZERO     WJICN8           Item Category N
     C                     Z-ADD*ZERO     WJICN9           Item Category N
     C                     Z-ADD*ZERO     WJICN0           Item Category N
     C                     Z-ADD*ZERO     WJSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WJA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WJSJNB           Production Lead
     C                     Z-ADD*ZERO     WJSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WJSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WJSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WJCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WJCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WJILNB           Packages per ca
     C                     Z-ADD*ZERO     WJCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WJCINB           PM Batch Size
     C                     Z-ADD*ZERO     WJCJNB           Package Level s
     C                     Z-ADD*ZERO     WJCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WJCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WJCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WJCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WJCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WJCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WJCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WJCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WJC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WJB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WJB5NB           PM Line Number
     C                     Z-ADD*ZERO     WJBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WJBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WJF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WJF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WJF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WJBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WJBNNB           Production Qty
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WKZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WKZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WKZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     WKY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WKZFNX           PFS Scheduled Q
     C                     Z-ADD*ZERO     WKZZNX           PFS Scheduled W
     C                     Z-ADD*ZERO     WKZ0NX           PFS Maximum Net
     C                     Z-ADD*ZERO     WKBINY           PFS Minimum Uni
     C                     Z-ADD*ZERO     WKBJNY           PFS Maximum Uni
     C                     Z-ADD*ZERO     WKBKNY           PFS Estimated P
     C                     Z-ADD*ZERO     WKATNY           PFS Average Pal
     C                     Z-ADD*ZERO     WKALD8           PFS Oldest Date
     C                     Z-ADD*ZERO     WKAMD8           PFS Newest Date
     C                     Z-ADD*ZERO     WKF5NY           PFS Sequence No
     C                     Z-ADD*ZERO     WKUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WKAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WKAINY           PFS Create Time
     C                     Z-ADD*ZERO     WKAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WKAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMRMNB           Load ID
     C                     Z-ADD*ZERO     WMRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WMQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WMQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WMQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WMGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WMGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WMGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WMGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WMHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WMHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WMHGVL           Transload Termi
     C                     Z-ADD*ZERO     WMQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WMQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WMQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WMQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WMITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WMQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WMQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WMQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WMP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WMP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WMQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WMQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WMQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WMQENY           Original Appoin
     C                     Z-ADD*ZERO     WMQFNY           Original Appoin
     C                     Z-ADD*ZERO     WMQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WMQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WMQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WMQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WMW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WMW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOXXTM           Departure Time
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WRZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WRZ1NX           PFS Sequence Nu
     C                     Z-ADD*ZERO     WRUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WRAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WRAINY           PFS Create Time
     C                     Z-ADD*ZERO     WRAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WRAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTC4NB           Order Number
     C                     Z-ADD*ZERO     WTDXNB           Sequence Number
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWM5NX           Comment Sequenc
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WXM5NX           Comment Sequenc
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WYAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TARMNB           Load ID
     C                     Z-ADD*ZERO     TARUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     TARVNB           Stop/Drop
     C                     Z-ADD*ZERO     TARWNB           Miles to next s
     C                     Z-ADD*ZERO     TARXNB           Freight Charge
     C                     Z-ADD*ZERO     TASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     TAT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     TAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     TAR1NB           Rated Freight
     C                     Z-ADD*ZERO     TAAIC3           Company Number
     C                     Z-ADD*ZERO     TAC4NB           Order Number
     C                     Z-ADD*ZERO     TAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     TASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     TAKFDT           Appointment Con
     C                     Z-ADD*ZERO     TAACTM           Appointment Con
     C                     Z-ADD*ZERO     TAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     TAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     TAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     TAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     TAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     TAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     TAKKDT           On Yard Date
     C                     Z-ADD*ZERO     TAAVTM           On Yard Time
     C                     Z-ADD*ZERO     TAZ4NB           MPC Number
     C                     Z-ADD*ZERO     TAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     TAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     TAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     TAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     TAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     TAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     TAAATM           Job Time
     C                     Z-ADD*ZERO     TAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBSPPN           Port Phone Numb
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  1
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  3
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  2
     C                     Z-ADD*ZERO     WL0010  30
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     MOVEL*BLANK    WL0013  2
     C                     Z-ADD*ZERO     WL0014  30
     C                     MOVEL*BLANK    WL0015 60
     C                     MOVEL*BLANK    WL0016  1
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  6
      * Define local variables for subroutine SZRVGN.
     C                     MOVEL*BLANK    WL0020  6
     C                     MOVEL*BLANK    WL0021  2
     C                     Z-ADD*ZERO     WL0022  30
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  1
      * Define local variables for subroutine TBRVGN.
     C                     MOVEL*BLANK    WL0025  6
     C                     MOVEL*BLANK    WL0026  2
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  1
      * Define local work field PFS Sequence No.
     C                     Z-ADD*ZERO     YL0001  90
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Stop/Drop
     C                     Z-ADD*ZERO     YL0006  50
      * Define local work field PFS Loading Sequence
     C                     Z-ADD*ZERO     YL0007  20
      * Define local work field Number Pallets Loaded
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field Weight 1 USR
     C                     Z-ADD*ZERO     YL0009 112
      * Define local work field Port Delv Terminal
     C                     MOVEL*BLANK    YL0010 20
      * Define local work field Number Pallets Loaded
     C                     Z-ADD*ZERO     YL0011  50
      * Define local work field Weight 1 USR
     C                     Z-ADD*ZERO     YL0012 112
      * Define local work field Item Reference Status
     C                     MOVEL*BLANK    YL0013  1
      * Define null work field CIR Item No
     C                     MOVEL*BLANK    YN0001 10
      * Define null work field CIR Description Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field CIR Description Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field CIR Description Line 3
     C                     MOVEL*BLANK    YN0004 30
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Production Date Prev USR
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0016  8
      * Define local work field Number Cases On A Pallet
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field Pallet Tare Weight
     C                     Z-ADD*ZERO     YL0018  52
      * Define local work field OHE Intended for ExportCC
     C                     MOVEL*BLANK    YL0019  6
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field PFS Sequence Number
     C                     Z-ADD*ZERO     YL0022  30
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0023  6
      * Define local work field PFS Sequence Number
     C                     Z-ADD*ZERO     YL0024  30
      * Define local work field PFS Record Status
     C                     MOVEL*BLANK    YL0025  1
      * Define null work field Internet Password
     C                     MOVEL*BLANK    YN0005 10
      * Define null work field Email User ID
     C                     MOVEL*BLANK    YN0006  8
      * Define null work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YN0007  6
      * Define null work field EDI Cust Duns Number
     C                     MOVEL*BLANK    YN0008 20
      * Define null work field EDI Warehouse/Store No.
     C                     MOVEL*BLANK    YN0009 20
      * Define null work field State Tax ID
     C                     MOVEL*BLANK    YN0010 20
      * Define null work field Cust Shipping Temp C/F
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field One Invoice Per PO
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field EDI Advanced Ship Notice
     C                     MOVEL*BLANK    YN0013  1
      * Define local work field Year Code
     C                     Z-ADD*ZERO     YL0026  40
      * Define local work field Month NBR USR
     C                     Z-ADD*ZERO     YL0027  20
      * Define local work field Day of Month USR
     C                     Z-ADD*ZERO     YL0028  20
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0029  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0030  60
      * Define local work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YL0032  70
      * Define local work field OHE Arrival Date
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YL0034  3
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field OHE Container Number
     C                     MOVEL*BLANK    YL0036 12
      * Define local work field OHE Comment 1
     C                     MOVEL*BLANK    YL0037 35
      * Define local work field OHE Comment 2
     C                     MOVEL*BLANK    YL0038 75
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0039 110
      * Define null work field Port Fax Number
     C                     MOVEL*BLANK    YN0014 25
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0040  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PFSSEQNO
