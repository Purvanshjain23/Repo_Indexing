// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBH5XFR
// ?Date: 14.08.2025 Time: 03:48:06
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?** Creates Load & Order records for Japanese Chilled Orders
EXECUTE FUNCTION(zTV/CRT Jpn Ords only  RT) TYPE(RTVOBJ) FILE(PNHGCPP)          AC2063308;
PARAMETER(PAR.Company_Number);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 //?** Creates Order Headers/Details for Japanese Chilled Orders
 //?** Load Header and Detail are NOT created
 //?** This function is called by an SSIS function
 //?** Default Order Number to zeros for this procedure
 //?** Put Price Code into the Item Code PASS USR field
 // LCL.System Value Numeric = CON.*ZERO
 LCL.System_Value_Numeric = *ZERO;

 // LCL.Order Number 1  PASS  USR = CON.*ZERO
 LCL.Order_Number_1_PASS_USR = *ZERO;

 //?** Build the Special Instructions, pass in Customer Name parm
 // LCL.Reference Field = CON.*BLANK
 LCL.Reference_Field = *BLANK;

 // LCL.Reference Field = CONCAT(CON.CAF,DB1.Destination City,CON.1)
 LCL.Reference_Field = 'CAF' + DB1.Destination_City (1);

 //?** Build the Shipping Instructions
 // PAR.ED Shipping Marks Txt = CONCAT(DB1.Customer Purchase Order #,CON./,CON.*ZERO)
 PAR.ED_Shipping_Marks_Txt = DB1.Customer_Purchase_Order_# + '/' (*ZERO);

 // PAR.ED Shipping Marks Txt = CONCAT(PAR.ED Shipping Marks Txt,DB1.Country Abbreviation,CON.*ZERO)
 PAR.ED_Shipping_Marks_Txt = PAR.ED_Shipping_Marks_Txt + DB1.Destination_City_Abbrev (*ZERO);

 //?** Parse SSD from *char(26) (from SSIS) to 10 alpha for CVT DATE
 //?** Then move 11 alpha date to 7 alpha, convert 7 alpha
 //?** to 7 numeric. Finally move 7 numeric to SSD
 // WRK.Text USR 4 = SUBSTRING(DB1.SSD Date/Time Alpha,CON.1,CON.4)
 WRK.Text_USR_4 = SUBSTRING(DB1.SSD_Date_Time_Alpha:1:4);

 // WRK.Text 2 = SUBSTRING(DB1.SSD Date/Time Alpha,CON.6,CON.2)
 WRK.Text_2 = SUBSTRING(DB1.SSD_Date_Time_Alpha:6:2);

 // WRK.Text 2 Length USR = SUBSTRING(DB1.SSD Date/Time Alpha,CON.9,CON.2)
 WRK.Text_2_Length_USR = SUBSTRING(DB1.SSD_Date_Time_Alpha:9:2);

 // WRK.Text 10A USR = CONCAT(WRK.Text USR 4,WRK.Text 2,CON.*ZERO)
 WRK.Text_10A_USR = WRK.Text_USR_4 + WRK.Text_2 (*ZERO);

 // WRK.Text 10A USR = CONCAT(WRK.Text 10A USR,WRK.Text 2 Length USR,CON.*ZERO)
 WRK.Text_10A_USR = WRK.Text_10A_USR + WRK.Text_2_Length_USR (*ZERO);

 // Call program Cvt Date              UP.
 CALL PROGRAM(Cvt Date              UP) ('POD5UPR');
 PARAMETER(WRK.Text_10A_USR);
 PARAMETER(WRK.Text_usr_11);
 PARAMETER(*YYMD);
 PARAMETER(*CYMD);
 PARAMETER(*NONE);

 // WRK.Text USR 7 = WRK.Text usr 11
 WRK.Text_USR_7 = WRK.Text_usr_11;

 // WRK.Number Value - 7 = CVTVAR(WRK.Text USR 7)
 WRK.Number_Value_7 = CVTVAR(WRK.Text_USR_7);

 // WRK.Scheduled Ship Date USR = WRK.Number Value - 7
 WRK.Scheduled_Ship_Date_USR = WRK.Number_Value_7;

 //?** Parse SSD from *char(26) (from SSIS) to 10 alpha for CVT DATE
 //?** Then move 11 alpha date to 7 alpha, convert 7 alpha
 //?** to 7 numeric. Finally move 7 numeric to RDD
 // WRK.Text USR 4 = SUBSTRING(DB1.RDD Date/Time Alpha,CON.1,CON.4)
 WRK.Text_USR_4 = SUBSTRING(DB1.RDD_Date_Time_Alpha:1:4);

 // WRK.Text 2 = SUBSTRING(DB1.RDD Date/Time Alpha,CON.6,CON.2)
 WRK.Text_2 = SUBSTRING(DB1.RDD_Date_Time_Alpha:6:2);

 // WRK.Text 2 Length USR = SUBSTRING(DB1.RDD Date/Time Alpha,CON.9,CON.2)
 WRK.Text_2_Length_USR = SUBSTRING(DB1.RDD_Date_Time_Alpha:9:2);

 // WRK.Text 10A USR = CONCAT(WRK.Text USR 4,WRK.Text 2,CON.*ZERO)
 WRK.Text_10A_USR = WRK.Text_USR_4 + WRK.Text_2 (*ZERO);

 // WRK.Text 10A USR = CONCAT(WRK.Text 10A USR,WRK.Text 2 Length USR,CON.*ZERO)
 WRK.Text_10A_USR = WRK.Text_10A_USR + WRK.Text_2_Length_USR (*ZERO);

 // Call program Cvt Date              UP.
 CALL PROGRAM(Cvt Date              UP) ('POD5UPR');
 PARAMETER(WRK.Text_10A_USR);
 PARAMETER(WRK.Text_usr_11);
 PARAMETER(*YYMD);
 PARAMETER(*CYMD);
 PARAMETER(*NONE);

 // WRK.Text USR 7 = WRK.Text usr 11
 WRK.Text_USR_7 = WRK.Text_usr_11;

 // WRK.Number Value - 7 = CVTVAR(WRK.Text USR 7)
 WRK.Number_Value_7 = CVTVAR(WRK.Text_USR_7);

 // WRK.Req Delivery Date = WRK.Number Value - 7
 WRK.Req_Delivery_Date = WRK.Number_Value_7;

 // Call program Zzz JPN Orders Not LoadXF.
 CALL PROGRAM(Zzz JPN Orders Not LoadXF) ('PBH2XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(WRK.Scheduled_Ship_Date_USR);
 PARAMETER(WRK.Scheduled_Ship_Date_USR);
 PARAMETER(WRK.Req_Delivery_Date);
 PARAMETER(LCL.Order_Number_1_PASS_USR);
 PARAMETER(LCL.System_Value_Numeric);
 PARAMETER(DB1.Warehouse_Code);
 PARAMETER(DB1.Price_Code);
 PARAMETER('U');
 PARAMETER(LCL.Reference_Field);
 PARAMETER(DB1.Customer_Purchase_Order_#);
 PARAMETER(DB1.Item_Age_Days);
 PARAMETER(LCL.Date_4_RGF_Pass);
 PARAMETER(LCL.Date_4_RGT_Pass);
 PARAMETER(PAR.ED_Shipping_Marks_Txt);

 //?** Default printer to Sales, PRKPRT14
 // WRK.Hold = CND.No
 WRK.Hold = *NO;

 // Call program Rtv Alpha Value       XF.
 CALL PROGRAM(Rtv Alpha Value       XF) ('POMTXFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER('JPNPRINTER');
 PARAMETER(WRK.Printer_Device);

 //?E2176 SLM 03/14/2013 due to parms only pass as blanks
 // Call program PRT Acknowledgements UP.
 CALL PROGRAM(PRT Acknowledgements UP) ('PDJWPCLP');
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Order_Number_1_PASS_USR);
 PARAMETER(LCL.Order_Number_1_PASS_USR);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*BLANK);
 PARAMETER(WRK.Blank_for_4_USR);
 PARAMETER(1);
 PARAMETER('A');
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER('S');
 PARAMETER(WRK.Printer_Device);
 PARAMETER(WRK.Hold);
 PARAMETER(*YES);
 PARAMETER(1);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);

 EXECUTE FUNCTION(RTV Order Qty/Wgt TotalRT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC2027679;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Order_Number_1_PASS_USR);
 PARAMETER(LCL.Order_Value_Total);
 PARAMETER(LCL.Order_Weight_Total);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // Call program EDT Post Open Orders 2 XF.
 CALL PROGRAM(EDT Post Open Orders 2 XF) ('POI4XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Order_Number_1_PASS_USR);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(LCL.Order_Value_Total);
 PARAMETER(LCL.Order_Weight_Total);
 PARAMETER('JPN');
 PARAMETER(DB1.Warehouse_Code);

}


