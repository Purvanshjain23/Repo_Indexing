// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLDNXFR
// ?Date: 14.08.2025 Time: 02:53:50
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?11/05/20 ISE H16853 Recompiled due to change in Buy Order Number
//?7/23/03
EXECUTE FUNCTION(Fix Delv Time Var      RT) TYPE(RTVOBJ) FILE(PLAFCPP)          AB1254893;
{
 //?USER: Process Data record

 CASE;

 // IF DB1.DT On Time Delivery is Early
 IF DB1.DT_On_Time_Delivery = 'E';

 //?7/22/03 Adjust Early time by adding 15 minutes
 // LCL.DT Delv Time Variance = DB1.DT Delv Time Variance + CON.15
 LCL.DT_Delv_Time_Variance = DB1.DT_Delv_Time_Variance + 15;

 EXECUTE FUNCTION(Chg Delv Time Var     CH) TYPE(CHGOBJ) FILE(PLAFCPP)           AB1254894;
 PARAMETER(DB1.CC_Company_Number);
 PARAMETER(DB1.DSH_Kill_Date);
 PARAMETER(DB1.DT_Delivery_Date);
 PARAMETER(DB1.DT_Delivery_Time);
 PARAMETER(DB1.DT_Delivery_Time_Seq);
 PARAMETER(LCL.DT_Delv_Time_Variance);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 // IF DB1.DT On Time Delivery is Late
 IF DB1.DT_On_Time_Delivery = 'L';

 //?7/22/03 Adjust Late  time by subtracting 15 minutes
 // LCL.DT Delv Time Variance = DB1.DT Delv Time Variance - CON.15
 LCL.DT_Delv_Time_Variance = DB1.DT_Delv_Time_Variance - 15;

 EXECUTE FUNCTION(Chg Delv Time Var     CH) TYPE(CHGOBJ) FILE(PLAFCPP)           AB1254894;
 PARAMETER(DB1.CC_Company_Number);
 PARAMETER(DB1.DSH_Kill_Date);
 PARAMETER(DB1.DT_Delivery_Date);
 PARAMETER(DB1.DT_Delivery_Time);
 PARAMETER(DB1.DT_Delivery_Time_Seq);
 PARAMETER(LCL.DT_Delv_Time_Variance);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 ENDIF;

}


