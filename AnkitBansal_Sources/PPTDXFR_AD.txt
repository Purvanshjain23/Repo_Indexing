// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPTDXFR
// ?Date: 14.08.2025 Time: 03:41:52
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?RMC 9/20/05 If par.status is Y, init all values
//?            If par.status is N, init Negative values only
//?RMC 3/14/06 pass in warehouse
EXECUTE FUNCTION(Prc Post Phys Init    RT) TYPE(RTVOBJ) FILE(CAB1REP)           AC1752882;
PARAMETER(PAR.Status_Y_or_N);
PARAMETER(PAR.PFS_From_Warehouse_Code);
{
 //?USER: Initialize routine

 //?09/09/09 PKD E00475 Use System Date instead of Job Date
 EXECUTE FUNCTION(Rtv System Date *CYMD IF) TYPE(EXCINTFUN)                      AC1952751;
 PARAMETER(LCL.System_Date_USR);
 {
  //?Execute internal function

  // LCL.*System timestamp = JOB.*System timestamp
  LCL.*System_timestamp = JOB.*System_timestamp;

  // LCL.Year USR = SUBSTRING(LCL.*System timestamp,CON.1,CON.4)
  LCL.Year_USR = SUBSTRING(LCL.*System_timestamp:1:4);

  // LCL.Month USR = SUBSTRING(LCL.*System timestamp,CON.6,CON.2)
  LCL.Month_USR = SUBSTRING(LCL.*System_timestamp:6:2);

  // LCL.Day USR = SUBSTRING(LCL.*System timestamp,CON.9,CON.2)
  LCL.Day_USR = SUBSTRING(LCL.*System_timestamp:9:2);

  // LCL.Date (Char-8) USR = CONCAT(LCL.Year USR,LCL.Month USR,CON.*ZERO)
  LCL.Date_Char_8_USR = LCL.Year_USR + LCL.Month_USR (*ZERO);

  // LCL.Date (Char-8) USR = CONCAT(LCL.Date (Char-8) USR,LCL.Day USR,CON.*ZERO)
  LCL.Date_Char_8_USR = LCL.Date_Char_8_USR + LCL.Day_USR (*ZERO);

  // LCL.DATE = CVTVAR(LCL.Date (Char-8) USR)
  LCL.DATE = CVTVAR(LCL.Date_Char_8_USR);

  EXECUTE FUNCTION(CVT *YYMD to *CYMD    IF) TYPE(EXCINTFUN)                      AC1929228;
  PARAMETER(PAR.System_Date_USR);
  PARAMETER(LCL.DATE);
  {
   //?Execute internal function

   //?** YEAR **
   // PAR.Year Code = PAR.DATE / CON.10000 *
   PAR.Year_Code = PAR.DATE / 10000;

   // PAR.Year  NBR USR = PAR.Year Code
   PAR.Year_NBR_USR = PAR.Year_Code;

   // PAR.Year  (Char) USR = CVTVAR(PAR.Year  NBR USR)
   PAR.Year_Char_USR = CVTVAR(PAR.Year_NBR_USR);

   //?** MONTH **
   // PAR.Month                 USR = PAR.DATE / CON.100 *
   PAR.Month_USR = PAR.DATE / 100;

   // PAR.Month (Char) USR = CVTVAR(PAR.Month                 USR)
   PAR.Month_Char_USR = CVTVAR(PAR.Month_USR);

   //?** DAY **
   // PAR.Day of Month USR = PAR.DATE
   PAR.Day_of_Month_USR = PAR.DATE;

   // PAR.Day   (Char) USR = CVTVAR(PAR.Day of Month USR)
   PAR.Day_Char_USR = CVTVAR(PAR.Day_of_Month_USR);

   //?CENTURY+YEAR
   CASE;

   // IF PAR.Year Code is Twentieth Century
   IF PAR.Year_Code <= 1999;

   // PAR.Date (Alpha) USR = CONCAT(CON.0,PAR.Year  (Char) USR,CON.*ZERO)
   PAR.Date_Alpha_USR = '0' + PAR.Year_Char_USR (*ZERO);

   //?CENTURY+YEAR
   // IF *OTHERWISE
   IF *OTHERWISE;

   // PAR.Date (Alpha) USR = CONCAT(CON.1,PAR.Year  (Char) USR,CON.*ZERO)
   PAR.Date_Alpha_USR = '1' + PAR.Year_Char_USR (*ZERO);

   ENDIF;

   // PAR.Date (Alpha) USR = CONCAT(PAR.Date (Alpha) USR,PAR.Month (Char) USR,CON.*ZERO)
   PAR.Date_Alpha_USR = PAR.Date_Alpha_USR + PAR.Month_Char_USR (*ZERO);

   // PAR.Date (Alpha) USR = CONCAT(PAR.Date (Alpha) USR,PAR.Day   (Char) USR,CON.*ZERO)
   PAR.Date_Alpha_USR = PAR.Date_Alpha_USR + PAR.Day_Char_USR (*ZERO);

   // PAR.Date                  USR = CVTVAR(PAR.Date (Alpha) USR)
   PAR.Date_USR = CVTVAR(PAR.Date_Alpha_USR);

  }

 }

 //?USER: Process Data record

 //?RMC 3/14/06 compare to par instead of hardcoded GP1
 CASE;

 // IF DB1.Warehouse Code EQ PAR.PFS Warehouse Code
 IF DB1.Warehouse_Code = PAR.PFS_From_Warehouse_Code;

 CASE;

 // IF PAR.Status - Y or N is no
 IF PAR.Status_Y_or_N = 'N';

 // AND DB1.Quantity on Hand - Weight is Greater than zero
 AND DB1.Quantity_on_Hand_Weight > *ZERO;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.Quantity on Hand - Weight = CON.*ZERO - DB1.Quantity on Hand - Weight
 WRK.Quantity_on_Hand_Weight = 0 - DB1.Quantity_on_Hand_Weight;

 // WRK.Quantity on Hand - U/M1 = CON.*ZERO - DB1.Quantity on Hand - U/M1
 WRK.Quantity_on_Hand_UOM1 = *ZERO - DB1.Quantity_on_Hand_UOM1;

 // Call program Prc Create Dtl Receipt XF.
 CALL PROGRAM(Prc Create Dtl Receipt XF) ('CAALXFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.Warehouse_Code);
 PARAMETER('A');
 PARAMETER('AP');
 PARAMETER(LCL.System_Date_USR);
 PARAMETER(DB1.Production_Date);
 PARAMETER('Post Physical Initialize');
 PARAMETER(WRK.Quantity_on_Hand_UOM1);
 PARAMETER(WRK.Quantity_on_Hand_Weight);
 PARAMETER(*BLANK);
 PARAMETER('1');
 PARAMETER(DB1.Label_Date);

 ENDIF;

 ENDIF;

}


