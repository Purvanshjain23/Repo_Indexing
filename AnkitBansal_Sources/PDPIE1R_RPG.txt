     H/TITLE EDT Cr/Dr Memo Header  E1 Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 01/25/16  Time  : 09:35:39
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDPIE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Cr/Dr Memo Header  E1 Edit record(1 screen)
      *
     FOPBFCPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBFCPM3IF  E           K        DISK
      * RSQ : Order Header TRG          Co, Invoice Number
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FOPBFCPLCIF  E           K        DISK
      * RSQ : Order Header TRG          Co,Attach to Order#
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAALREL1IF  E           K        DISK
      * RTV : Manager Level             Retrieval index       NV
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FCAACREL2IF  E           K        DISK
      * RTV : State                     Active only
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FOPCXREL2IF  E           K        DISK
      * RTV : OP Reason Codes           Active Records Only
      *
     FPDJHREL1IF  E           K        DISK
      * RTV : Internal Reason           Retrieval index
      *
     FOPEZREL1IF  E           K        DISK
      * RTV : Event Types               Retrieval index       NV
      *
     FPDMKCPL1IF  E           K        DISK
      * RTV : A/R Claim                 Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : User Entry Control        Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPEYCPL0IF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBFCPL0UF  E           K        DISK                      A
      * UPD : Order Header TRG          Update index
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   4 004  5 0A
     E                    W0END   4 004  5 0A
     E                    W0NAM   4 004 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 030  5 0A
     E                    W1END   7 030  5 0A
     E                    W1NAM   7 030 10
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@BFCPDX
      * Order Header TRG          Co, Invoice Number
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BFCPN9
      * Order Header TRG          Co,Attach to Order#
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BBREWG
      * Customer                  Active Only
      * Renamed input format fields
     I              BBBKC7                          WCBKC7
     I              BBAYTX                          WCAYTX
     I              BBACNA                          WCACNA
     I              BBADNA                          WCADNA
     I              BBAENA                          WCAENA
     I              BBAJNA                          WCAJNA
     I              BBBGCD                          WCBGCD
     I              BBG5CD                          WCG5CD
     I              BBBTTX                          WCBTTX
     I              BBBVTX                          WCBVTX
     I              BBBWTX                          WCBWTX
     I              BBABTX                          WCABTX
     I              BBA2NA                          WCA2NA
     I              BBCBST                          WCCBST
     I              BBB0NA                          WCB0NA
     I              BBP3NB                          WCP3NB
     I              BBAXNA                          WCAXNA
     I              BBI6DT                          WCI6DT
     I              BBAYDT                          WCAYDT
     I              BBANC7                          WCANC7
     I              BBBTC7                          WCBTC7
     I              BBK6ST                          WCK6ST
     I              BBUZST                          WCUZST
     I              BBKXCD                          WCKXCD
     I              BBLTCD                          WCLTCD
     I              BBQNST                          WCQNST
     I              BBS2NB                          WCS2NB
     I              BBVHVA                          WCVHVA
     I              BBI7DT                          WCI7DT
     I              BBRJST                          WCRJST
     I              BBRKST                          WCRKST
     I              BBQWST                          WCQWST
     I              BBQXST                          WCQXST
     I              BBQYST                          WCQYST
     I              BBUNCS                          WCUNCS
     I              BBUVST                          WCUVST
     I              BBUWST                          WCUWST
     I              BBUXST                          WCUXST
     I              BBVSST                          WCVSST
     I              BBAATM                          WCAATM
     I              BBAYNA                          WCAYNA
     I              BBA0NA                          WCA0NA
     I              BBAXDT                          WCAXDT
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WDAIC3
     I              ASAXNB                          WDAXNB
     I              ASNGNB                          WDNGNB
     I              ASBZNB                          WDBZNB
     I              ASC5NB                          WDC5NB
     I              ASC3NB                          WDC3NB
     I              ASCYNB                          WDCYNB
     I              ASIONB                          WDIONB
     I              ASI6NB                          WDI6NB
     I              ASDCNB                          WDDCNB
     I              ASC7NB                          WDC7NB
     I              ASC2NB                          WDC2NB
     I              ASC1NB                          WDC1NB
     I              ASL8NB                          WDL8NB
     I              ASBANB                          WDBANB
     I              ASCHST                          WDCHST
     I              ASCKST                          WDCKST
     I              ASCIST                          WDCIST
     I              ASCGST                          WDCGST
     I              ASAIPC                          WDAIPC
     I              ASASPC                          WDASPC
     I              ASA2VA                          WDA2VA
     I              ASC2ST                          WDC2ST
     I              ASD8ST                          WDD8ST
     I              ASD7ST                          WDD7ST
     I              ASA8NA                          WDA8NA
     I              ASA9NA                          WDA9NA
     I              ASBANA                          WDBANA
     I              ASBBNA                          WDBBNA
     I              ASEUST                          WDEUST
     I              ASAADY                          WDAADY
     I              ASABDY                          WDABDY
     I              ASACDY                          WDACDY
     I              ASADDY                          WDADDY
     I              ASAEDY                          WDAEDY
     I              ASAFDY                          WDAFDY
     I              ASAGDY                          WDAGDY
     I              ASAHDY                          WDAHDY
     I              ASAENB                          WDAENB
     I              ASALNB                          WDALNB
     I              ASEVNB                          WDEVNB
     I              ASRPOP                          WDRPOP
     I              ASDWNB                          WDDWNB
     I              ASR3NB                          WDR3NB
     I              ASPNST                          WDPNST
     I              ASR4NB                          WDR4NB
     I              ASPOST                          WDPOST
     I              ASSCNB                          WDSCNB
     I              ASVIST                          WDVIST
     I              ASVJST                          WDVJST
     I              ASBVVN                          WDBVVN
     I              ASUVST                          WDUVST
     I              ASUWST                          WDUWST
     I              ASUXST                          WDUXST
     I              ASVSST                          WDVSST
     I              ASAATM                          WDAATM
     I              ASAYNA                          WDAYNA
     I              ASA0NA                          WDA0NA
     I              ASAXDT                          WDAXDT
      *
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                          WEAIC3
     I              ABADTX                          WEADTX
     I              ABACNA                          WEACNA
     I              ABADNA                          WEADNA
     I              ABAENA                          WEAENA
     I              ABAJNA                          WEAJNA
     I              ABBTTX                          WEBTTX
     I              ABBVTX                          WEBVTX
     I              ABBWTX                          WEBWTX
     I              ABA2NA                          WEA2NA
     I              ABABTX                          WEABTX
     I              ABBGCD                          WEBGCD
     I              ABKXCD                          WEKXCD
     I              ABUVST                          WEUVST
     I              ABUWST                          WEUWST
     I              ABUXST                          WEUXST
     I              ABVSST                          WEVSST
     I              ABAATM                          WEAATM
     I              ABAYNA                          WEAYNA
     I              ABA0NA                          WEA0NA
     I              ABAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            779
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      * Outward parameters
     IPARC        DS                              6
      * KEY : Order Header TRG          Co,Attach to Order#
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Attach to Order Number
     I                                    P   3   60PAT3NB
      *
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      *
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WDAIC3
     I              ASAXNB                          WDAXNB
     I              ASNGNB                          WDNGNB
     I              ASBZNB                          WDBZNB
     I              ASC5NB                          WDC5NB
     I              ASC3NB                          WDC3NB
     I              ASCYNB                          WDCYNB
     I              ASIONB                          WDIONB
     I              ASI6NB                          WDI6NB
     I              ASDCNB                          WDDCNB
     I              ASC7NB                          WDC7NB
     I              ASC2NB                          WDC2NB
     I              ASC1NB                          WDC1NB
     I              ASL8NB                          WDL8NB
     I              ASBANB                          WDBANB
     I              ASCHST                          WDCHST
     I              ASCKST                          WDCKST
     I              ASCIST                          WDCIST
     I              ASCGST                          WDCGST
     I              ASAIPC                          WDAIPC
     I              ASASPC                          WDASPC
     I              ASA2VA                          WDA2VA
     I              ASC2ST                          WDC2ST
     I              ASD8ST                          WDD8ST
     I              ASD7ST                          WDD7ST
     I              ASA8NA                          WDA8NA
     I              ASA9NA                          WDA9NA
     I              ASBANA                          WDBANA
     I              ASBBNA                          WDBBNA
     I              ASEUST                          WDEUST
     I              ASAADY                          WDAADY
     I              ASABDY                          WDABDY
     I              ASACDY                          WDACDY
     I              ASADDY                          WDADDY
     I              ASAEDY                          WDAEDY
     I              ASAFDY                          WDAFDY
     I              ASAGDY                          WDAGDY
     I              ASAHDY                          WDAHDY
     I              ASAENB                          WDAENB
     I              ASALNB                          WDALNB
     I              ASEVNB                          WDEVNB
     I              ASRPOP                          WDRPOP
     I              ASDWNB                          WDDWNB
     I              ASR3NB                          WDR3NB
     I              ASPNST                          WDPNST
     I              ASR4NB                          WDR4NB
     I              ASPOST                          WDPOST
     I              ASSCNB                          WDSCNB
     I              ASVIST                          WDVIST
     I              ASVJST                          WDVJST
     I              ASBVVN                          WDBVVN
     I              ASUVST                          WDUVST
     I              ASUWST                          WDUWST
     I              ASUXST                          WDUXST
     I              ASVSST                          WDVSST
     I              ASAATM                          WDAATM
     I              ASAYNA                          WDAYNA
     I              ASA0NA                          WDA0NA
     I              ASAXDT                          WDAXDT
      *
     IYARDCS      DS                            278
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            278
     IYCRDCS      DS                            779
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      *
     IYDRDCS      DS                            793
      * Outward parameters
     IPBRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PBAIC3
      * I :  Order Number
     I                                    P   3   60PBC4NB
      * I :  Order Type - Sales
     I                                        7   8 PBJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PBANC7
      * I :  Ship To Customer
     I                                    P  13  160PBBKC7
      * I :  Ship To Name
     I                                       17  46 PBBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PBHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PBHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PBHPNA
      * I :  Ship To City
     I                                      137 156 PBHNNA
      * I :  Ship To State Code
     I                                      157 158 PBDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PBCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PBB0C7
      * I :  Bill to Name
     I                                      174 203 PBAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PBB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PBB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PBB4NA
      * I :  Bill to City
     I                                      294 313 PBB2NA
      * I :  Bill to State Code
     I                                      314 315 PBBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PBC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PBBCNA
      * I :  Order Date
     I                                    P 342 3450PBA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PBA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PBGNDT
      * I :  Cancel Date
     I                                    P 354 3570PBACDT
      * I :  Terms Code
     I                                      358 359 PBAQCD
      * I :  Special Instructions
     I                                      360 399 PBB6NA
      * I :  Special Instructions 2
     I                                      400 439 PBBYNA
      * I :  Carrier Code
     I                                      440 442 PBBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PBGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PBGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PBGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PBQFST
      * I :  Reason Code
     I                                      447 449 PBCQCD
      * I :  Order in Use
     I                                      450 450 PBGJST
      * I :  Header Status
     I                                      451 451 PBGWST
      * I :  Header Status Last
     I                                      452 452 PBGXST
      * I :  Order Type Print Status
     I                                      453 453 PBGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PBAODT
      * I :  User Original Entry
     I                                      458 467 PBAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PBCXDT
      * I :  Order Value Total
     I                                    P 472 4772PBJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PBA1WG
      * I :  Credit Hold
     I                                      484 484 PBXIST
      * I :  Production Hold
     I                                      485 485 PBXJST
      * I :  New Customer Hold
     I                                      486 486 PBXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PBEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PBAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PBE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PBE9CD
      * I :  Load ID
     I                                    P 510 5130PBRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PBTBNB
      * I :  Rated Freight
     I                                    P 517 5222PBR1NB
      * I :  LTL Flag
     I                                      523 523 PBPJST
      * I :  Price Audit
     I                                      524 524 PBU0ST
      * I :  Price Status
     I                                      525 525 PBU1ST
      * I :  Shipping Method
     I                                      526 527 PBQ2CD
      * I :  Export Status
     I                                      528 528 PBU2ST
      * I :  Palletize
     I                                      529 529 PBVEST
      * I :  Shrink Wrap
     I                                      530 530 PBVFST
      * I :  Slip Sheet
     I                                      531 531 PBVGST
      * I :  Age Code
     I                                      532 532 PBRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PBRNNB
      * I :  Load Type
     I                                      536 536 PBVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PBATIN
      * I :  Load Plan Order
     I                                      541 541 PBU4ST
      * I :  Print Pick Slip
     I                                      542 542 PBU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PBRSRN
      * I :  Special Comment 1
     I                                      547 576 PBMHNA
      * I :  Special Comment 2
     I                                      577 606 PBMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PBWBST
      * I :  Sales Route Code
     I                                      608 610 PBR4CD
      * I :  Manager Level Code
     I                                      611 612 PBBFCD
      * I :  VP Level Code
     I                                      613 615 PBQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PBT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PBSICD
      * I :  Invoice Number
     I                                    P 623 6260PBCONB
      * I :  Invoice Suffix
     I                                      627 628 PBCEST
      * I :  Invoice Date
     I                                    P 629 6320PBAWDT
      * I :  Event Code
     I                                      633 634 PBJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PBXUST
      * I :  Modified Flag
     I                                      636 636 PBZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PBVRVA
      * I :  Billing Activity Type
     I                                      643 643 PBOBST
      * I :  Block Order Flag
     I                                      644 644 PBBCST
      * I :  Order Certification Flag
     I                                      645 645 PBBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PBB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PBGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PBGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PBGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PBGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PBFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PBFOSX
      * I :  Order Emailed
     I                                      658 658 PBFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PBFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PBFRSX
      * I :  Broker Order Status
     I                                      661 661 PBFSSX
      * I :  Air Freight Order
     I                                      662 662 PBFTSX
      * I :  Order Requires Review
     I                                      663 664 PBFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PBFVSX
      * I :  Export USDA Approved
     I                                      667 668 PBFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PBFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PBFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PBNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PBNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PBNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PBNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PBNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PBBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PBBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PBBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PBBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PBBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PBH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PBH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PBH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PBH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PBH4NX
      * I :  Claim Number
     I                                    P 745 7480PBC0C7
      * I :  EDI Status 1
     I                                      749 749 PBUVST
      * I :  EDI Status 2
     I                                      750 750 PBUWST
      * I :  EDI Status 3
     I                                      751 751 PBUXST
      * I :  Job Time
     I                                    P 752 7550PBAATM
      * I :  User Id
     I                                      756 765 PBAYNA
      * I :  Job Name
     I                                      766 775 PBA0NA
      * I :  Job Date
     I                                    P 776 7790PBAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Application Code
     I                                        4   9 P1DNCD
      * N :  Salesperson Code
     I                                       10  12 P1BCCD
      * I :  Allow Multi-Company
     I                                       13  13 P1I6ST
      * N :  Default Printer
     I                                       14  23 P1MPNA
      * N :  Access Denied (Y/N)
     I                                       24  24 P1WVST
     IP2PARM      DS
      * FLD: Order Header TRG
      * B : MAP Company Number
     I                                    P   1   20P2AIC3
      * B : MAP Order Number
     I                                    P   3   60P2C4NB
      * N :  Order Type - Sales
     I                                        7   8 P2JNCD
      * N :  A/R Customer Number
     I                                    P   9  120P2ANC7
      * N :  Ship To Customer
     I                                    P  13  160P2BKC7
      * N :  Ship To Name
     I                                       17  46 P2BRTX
      * N :  Ship To Address Line 1
     I                                       47  76 P2HMNA
      * N :  Ship To Address Line 2
     I                                       77 106 P2HONA
      * N :  Ship To Address Line 3
     I                                      107 136 P2HPNA
      * N :  Ship To City
     I                                      137 156 P2HNNA
      * N :  Ship To State Code
     I                                      157 158 P2DBCD
      * N :  Ship To Zip/Postal Code
     I                                      159 169 P2CKTX
      * N :  Attach to Invoice Number
     I                                    P 170 1730P2ATIN
      * N :  Attach to Order Number
     I                                    P 174 1770P2T3NB
     IP3PARM      DS
      * FLD: Order Types
      * I :  Billing Activity Type
     I                                        1   1 P3OBST
     IP4PARM      DS
      * N : MAP Company Name
     I                                        1  30 P4APTX
     IP5PARM      DS
      * N : MAP @Order Type Code
     I                                        1   2 P5JMCD
     IP6PARM      DS
      * N : MAP @Invoice Number
     I                                    P   1   40P6PONB
     IP7PARM      DS
      * N : MAP @Order Number Alpha
     I                                    P   1   40P7BFC7
     IP8PARM      DS
      * FLD: Company Control
      * N :  Next Credit Memo Number
     I                                    P   1   40P8CYNB
      * N :  Auto Order Numbering?
     I                                        5   5 P8CHST
     IP9PARM      DS
      * N :  USR Update Flag
     I                                        1   1 P9R4ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Order type invalid'
      * Order Type Description
     I                                        1  30 ZA0001
      * Order Type - Sales
     I                                       31  32 ZA0002
      * Message data for 'Order Types            NF'
      * Message data for 'Original order not found'
      * Order Number
     I                                        1   7 ZA0003
      * Message data for 'Original invoice not fnd'
      * Invoice Number
     I                                    P   1   40ZA0004
      * Message data for 'Not a real error'
      * BLANK
     I                                        1 256 ZA0005
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Order & Invoice mismatch'
      * Attach to Order Number
     I                                        1   7 ZA0006
      * Attach to Invoice Number
     I                                    P   8  110ZA0007
      * Message data for 'Order & Invoice mismatch'
      * Attach to Order Number
     I                                        1   7 ZA0008
      * Attach to Invoice Number
     I                                    P   8  110ZA0009
      * Message data for 'Original order not found'
      * Order Number
     I                                        1   7 ZA0010
      * Message data for 'Order & Invoice mismatch'
      * Attach to Order Number
     I                                        1   7 ZA0011
      * Attach to Invoice Number
     I                                    P   8  110ZA0012
      * Message data for 'Original invoice not fnd'
      * Invoice Number
     I                                    P   1   40ZA0013
      * Message data for 'A/R Customer invalid'
      * A/R Customer Number
     I                                        1   7 ZA0014
      * Message data for 'A/R Customer invalid'
      * A/R Customer Number
     I                                        1   7 ZA0015
      * Message data for 'Ship to Customer Flag 'N''
      * Ship To Customer
     I                                        1   7 ZA0016
      * Message data for 'Affect Auto Accrual Valid'
      * Affect Auto Accruals
     I                                        1   1 ZA0017
      * Message data for 'Order created'
      * Order Number
     I                                        1   7 ZA0018
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1I6ST    PARM           WP0001  1        Allow Multi-Com
     C           P2AIC3    PARM P2AIC3    WP0002  30       Company Number
     C           P2C4NB    PARM P2C4NB    WP0003  70       Order Number
     C           P3OBST    PARM           WP0004  1        Billing Activit
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C  N09                EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1C4NB    OREQ *ZERO                      Order Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KRTV      CHAIN@BECPFK              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     993132*
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * Verify record existence against program mode
     C           W0PMD     IFNE 'ADD'
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     993132*
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
     C                     MOVEL*BLANK    #DDGU1           ACR Shipping Me
      * ACR Shipping Method DRV
      * PAR.ACR Shipping Method DRV = Condition name of PAR.ACR Shipping
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #1Q2CD    W0INVL 25        ACR Shipping Me
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DDGU1    PARM           W0CNNM 25        ACR Shipping Me
      *
      * USER: Initialize detail screen (existing record)
     C                     MOVEL#PAPTX    #PAPTX           Company Name
      * FP1309 SLM
      * Do not internal populate the age code on the order header
     C                     Z-ADDBEBKC7    P2BKC7           Ship To Custome
      * Determine if Ship to Customer should be input or output field
      * CASE: Memo is free standing
      *  - c1 AND c2
      *   |- c1    : DB1.Attach to Order Number is Equal to zeros
      *   |- c2    : DB1.Attach to Invoice Number is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BET3NB    IFEQ *ZERO                      *IF
     C           BEATIN    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P9R4ST           USR Update Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P9R4ST           USR Update Flag
     C                     END                             *FI
      * If claim memo, then screen is output only.
     C                     EXSR UASUBR                     If claim memo,
     C                     Z-ADDBEATIN    P2ATIN           Attach to Invoi
     C                     Z-ADDBET3NB    P2T3NB           Attach to Order
      * Save initial values for later comparison
      * CASE: WRK.ZERO is Zero
     C           WUW0NB    IFEQ *ZERO                      *IF
     C                     Z-ADD#1BKC7    WUBKC7           Ship To Custome
     C                     MOVEL#1BRTX    WUBRTX           Ship To Name
     C                     MOVEL#1HMNA    WUHMNA           Ship To Address
     C                     MOVEL#1HONA    WUHONA           Ship To Address
     C                     MOVEL#1HPNA    WUHPNA           Ship To Address
     C                     MOVEL#1HNNA    WUHNNA           Ship To City
     C                     MOVEL#1DBCD    WUDBCD           Ship To State C
     C                     MOVEL#1CKTX    WUCKTX           Ship To Zip/Pos
     C                     Z-ADD#1B0C7    WUB0C7           Bill to Custome
     C                     MOVEL#1AETX    WUAETX           Bill to Name
     C                     MOVEL#1B1NA    WUB1NA           Bill to Address
     C                     MOVEL#1B3NA    WUB3NA           Bill to Address
     C                     MOVEL#1B4NA    WUB4NA           Bill to Address
     C                     MOVEL#1B2NA    WUB2NA           Bill to City
     C                     MOVEL#1BHCD    WUBHCD           Bill to State C
     C                     MOVEL#1C8TX    WUC8TX           Bill to Zip/Pos
     C                     Z-ADD#1T3NB    WUT3NB           Attach to Order
     C                     Z-ADD#1ATIN    WUATIN           Attach to Invoi
     C                     MOVEL#1BCNA    WUBCNA           Customer Purcha
     C                     Z-ADD#1RSRN    WURSRN           Resell Referenc
     C                     MOVEL#1MHNA    WUMHNA           Special Comment
     C                     MOVEL#1MINA    WUMINA           Special Comment
     C                     MOVEL#1WBST    WUWBST           Affect Auto Acc
     C                     END                             *FI
     C                     END
      *
     C                     ELSE
      * If record already exists, error
     C           *IN90     IFEQ '0'
     C                     SETON                     993132*
      * Send message 'Order Header TRG       EX'
     C                     MOVEL'USR0177' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
      * USER: Initialize detail screen (new record)
      * Determine whether to hide order # in add mode
      * CASE: Auto Numbering and in add mode
      *  - c1 AND c2
      *   |- c1    : PAR.Auto Order Numbering? is yes
      *   |- c2    : PGM.*Program mode is *ADD
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P8CHST    IFEQ 'Y'                        *IF
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       #DGGST           USR Display fie
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #DGGST           USR Display fie
     C                     END                             *FI
     C                     MOVEL#PAPTX    #PAPTX           Company Name
     C                     MOVEL#PJMCD    #1JNCD           Order Type - Sa
     C                     Z-ADD#PBFC7    #1T3NB           Attach to Order
     C                     Z-ADD#PPONB    #1ATIN           Attach to Invoi
      * E4057 JJH 06/09/15 - Default Affect Auto accrual with Yes
     C                     MOVEL'Y'       #1WBST           Affect Auto Acc
      * Fill fields from original order
      * CASE: DTL.Attach to Order Number is Not equal to zeros
     C           #1T3NB    IFNE *ZERO                      *IF
      * RTV Orig Order Fields  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1T3NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    #1ANC7           A/R Customer Nu
     C                     Z-ADDWL0004    #1BKC7           Ship To Custome
     C                     MOVELWL0005    #1BRTX    P      Ship To Name
     C                     MOVELWL0006    #1HMNA    P      Ship To Address
     C                     MOVELWL0007    #1HONA    P      Ship To Address
     C                     MOVELWL0008    #1HPNA    P      Ship To Address
     C                     MOVELWL0009    #1HNNA    P      Ship To City
     C                     MOVELWL0010    #1DBCD    P      Ship To State C
     C                     MOVELWL0011    #1CKTX    P      Ship To Zip/Pos
     C                     Z-ADDWL0012    #1B0C7           Bill to Custome
     C                     MOVELWL0013    #1AETX    P      Bill to Name
     C                     MOVELWL0014    #1B1NA    P      Bill to Address
     C                     MOVELWL0015    #1B3NA    P      Bill to Address
     C                     MOVELWL0016    #1B4NA    P      Bill to Address
     C                     MOVELWL0017    #1B2NA    P      Bill to City
     C                     MOVELWL0018    #1BHCD    P      Bill to State C
     C                     MOVELWL0019    #1C8TX    P      Bill to Zip/Pos
     C                     MOVELWL0020    #1BCNA    P      Customer Purcha
     C                     MOVELWL0021    #1U2ST    P      Export Status
     C                     MOVELWL0022    #1R4CD    P      Sales Route Cod
     C                     MOVELWL0023    #1BFCD    P      Manager Level C
     C                     MOVELWL0024    #1Q4CD    P      VP Level Code
     C                     ELSE
      * CASE: *OTHERWISE
      * Fill fields from original order via invoice
      * CASE: DTL.Attach to Invoice Number is Not equal to zero
     C           #1ATIN    IFNE *ZERO                      *IF
      * RTV Order # for Invc   RT - OP Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0025           Company Number
     C                     Z-ADD#1ATIN    WL0026           Invoice Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    #1T3NB           Order Number
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Orig Order Fields  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1T3NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    #1ANC7           A/R Customer Nu
     C                     Z-ADDWL0004    #1BKC7           Ship To Custome
     C                     MOVELWL0005    #1BRTX    P      Ship To Name
     C                     MOVELWL0006    #1HMNA    P      Ship To Address
     C                     MOVELWL0007    #1HONA    P      Ship To Address
     C                     MOVELWL0008    #1HPNA    P      Ship To Address
     C                     MOVELWL0009    #1HNNA    P      Ship To City
     C                     MOVELWL0010    #1DBCD    P      Ship To State C
     C                     MOVELWL0011    #1CKTX    P      Ship To Zip/Pos
     C                     Z-ADDWL0012    #1B0C7           Bill to Custome
     C                     MOVELWL0013    #1AETX    P      Bill to Name
     C                     MOVELWL0014    #1B1NA    P      Bill to Address
     C                     MOVELWL0015    #1B3NA    P      Bill to Address
     C                     MOVELWL0016    #1B4NA    P      Bill to Address
     C                     MOVELWL0017    #1B2NA    P      Bill to City
     C                     MOVELWL0018    #1BHCD    P      Bill to State C
     C                     MOVELWL0019    #1C8TX    P      Bill to Zip/Pos
     C                     MOVELWL0020    #1BCNA    P      Customer Purcha
     C                     MOVELWL0021    #1U2ST    P      Export Status
     C                     MOVELWL0022    #1R4CD    P      Sales Route Cod
     C                     MOVELWL0023    #1BFCD    P      Manager Level C
     C                     MOVELWL0024    #1Q4CD    P      VP Level Code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Determine if Ship to Customer should be input or output field
      * CASE: Memo is free standing
      *  - c1 AND c2
      *   |- c1    : DTL.Attach to Order Number is Equal to zeros
      *   |- c2    : DTL.Attach to Invoice Number is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1T3NB    IFEQ *ZERO                      *IF
     C           #1ATIN    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P9R4ST           USR Update Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P9R4ST           USR Update Flag
     C                     END                             *FI
      * Not a claim memo, so screen is input capable.
     C                     EXSR UBSUBR                     Not a claim mem
     C                     Z-ADD##JDT     #1A0DT           Order Date
     C                     MOVEL'N'       #1U4ST           Load Plan Order
     C                     MOVEL'N'       #1U5ST           Print Pick Slip
     C                     MOVEL'A'       #1U0ST           Price Audit
     C                     MOVEL'P'       #1U1ST           Price Status
     C                     MOVEL'01'      #1JPCD           Event Code
     C                     MOVEL'N'       #1XIST           Credit Hold
     C                     MOVEL'N'       #1XJST           Production Hold
     C                     MOVEL'N'       #1XKST           New Customer Ho
      * RTV Billing Type       RT - OP Order Types  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1JNCD    WL0028    P      Order Type - Sa
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0029    #1OBST    P      Billing Activit
      * Set suffix
      * CASE: DTL.Billing Activity Type is Credit Memo
     C           #1OBST    IFEQ '2'                        *IF
     C                     MOVEL'CM'      #1CEST           Invoice Suffix
     C                     ELSE
      * CASE: DTL.Billing Activity Type is Debit Memo
     C           #1OBST    IFEQ '3'                        *IF
     C                     MOVEL'DM'      #1CEST           Invoice Suffix
     C                     END                             *FI
     C                     END                             *FI
      * Save initial values for later comparison
      * CASE: WRK.ZERO is Zero
     C           WUW0NB    IFEQ *ZERO                      *IF
     C                     Z-ADD#1BKC7    WUBKC7           Ship To Custome
     C                     MOVEL#1BRTX    WUBRTX           Ship To Name
     C                     MOVEL#1HMNA    WUHMNA           Ship To Address
     C                     MOVEL#1HONA    WUHONA           Ship To Address
     C                     MOVEL#1HPNA    WUHPNA           Ship To Address
     C                     MOVEL#1HNNA    WUHNNA           Ship To City
     C                     MOVEL#1DBCD    WUDBCD           Ship To State C
     C                     MOVEL#1CKTX    WUCKTX           Ship To Zip/Pos
     C                     Z-ADD#1B0C7    WUB0C7           Bill to Custome
     C                     MOVEL#1AETX    WUAETX           Bill to Name
     C                     MOVEL#1B1NA    WUB1NA           Bill to Address
     C                     MOVEL#1B3NA    WUB3NA           Bill to Address
     C                     MOVEL#1B4NA    WUB4NA           Bill to Address
     C                     MOVEL#1B2NA    WUB2NA           Bill to City
     C                     MOVEL#1BHCD    WUBHCD           Bill to State C
     C                     MOVEL#1C8TX    WUC8TX           Bill to Zip/Pos
     C                     Z-ADD#1T3NB    WUT3NB           Attach to Order
     C                     Z-ADD#1ATIN    WUATIN           Attach to Invoi
     C                     MOVEL#1BCNA    WUBCNA           Customer Purcha
     C                     Z-ADD#1RSRN    WURSRN           Resell Referenc
     C                     MOVEL#1MHNA    WUMHNA           Special Comment
     C                     MOVEL#1MINA    WUMINA           Special Comment
     C                     MOVEL#1WBST    WUWBST           Affect Auto Acc
     C                     END                             *FI
     C                     END
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #1C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Company Name and Address
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate key screen
     C                     MOVEL'N'       WUZZST           Record Selected
      * Add Mode processing
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * Gets the next number to use temporarily.
      * RTV Next Order Number  RT - Company Control  * 
     C                     EXSR SDRVGN
      * Process key screen selects
      * CASE: Select Company
      *  - c1 AND c2
      *   |- c1    : KEY.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> KEY.Accounting Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V1AIC3'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Co By Number       SR - Company Name and Address  * 
     C                     CALL 'PDMESRR'              90  SEL Co By Numbe
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0004  30       Company Number
     C           #PAPTX    PARM *BLANK    WQ0005 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       WUZZST           Record Selected
     C                     ELSE
      * CASE: Select Order Type
      *  - c1 AND c2
      *   |- c1    : KEY.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> KEY.@Order Type Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#PJMCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Credit/Debit Memo  SR - OP Order Types  * 
     C                     CALL 'PDPKSRR'              90  SEL Credit/Debi
     C                     PARM *BLANK    W0RTN   7
     C           #PJMCD    PARM #PJMCD    WQ0006  2        Order Type - Sa
     C                     PARM P3OBST    WQ0007  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPKSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     MOVEL'Y'       WUZZST           Record Selected
     C                     ELSE
      * CASE: Select Attach Order Number
      *  - c1 AND c2
      *   |- c1    : KEY.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> KEY.@Order Number Alpha
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'VPBFC7'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Will need to select only Invoice type orders ??
      * SEL Order by PO        SR - OP Order Header  * 
     C                     CALL 'PDHKSRR'              90  SEL Order by PO
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0008  30       Company Number
     C           #PBFC7    PARM #PBFC7    WQ0009  70       Order Number
     C           WUBCNA    PARM WUBCNA    WQ0010 15        Customer Purcha
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHKSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       WUZZST           Record Selected
     C                     ELSE
      * CASE: Select Attach Invoice
      *  - c1 AND c2
      *   |- c1    : KEY.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> KEY.@Invoice Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#PPONB'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL A/R Header         SR - A/R Header  * 
     C                     CALL 'PDPGSRR'              90  SEL A/R Header
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0011  30       Company Number
     C           #PPONB    PARM #PPONB    WQ0012  70       Invoice Number
     C           WUCEST    PARM WUCEST    WQ0013  2        Invoice Suffix
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       WUZZST           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Billing Type       RT - Order Types  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PJMCD    WL0028    P      Order Type - Sa
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0029    WUOBST    P      Billing Activit
      * Error if not found or bill type mismatch
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Description for error message
      * CASE: PAR.Billing Activity Type EQ WRK.BLANK
     C           P3OBST    IFEQ WUGSTX                     *IF
     C                     MOVEL*BLANK    WUJVNA           Order Type Desc
     C                     MOVEL@CN,002   WUJVNA           Order Type Desc
     C                     ELSE
      * CASE: *OTHERWISE
      * WRK.Order Type Description = Condition name of PAR.Billing Activi
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1167313   Y2LSNO  70       List number
     C                     PARM P3OBST    W0INVL 25        Billing Activit
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUJVNA    PARM           W0CNNM 25        Order Type Desc
      *
     C                     END                             *FI
      * CASE: Credit or Debit Memo
      *  - c1 AND c2
      *   |- c1    : PAR.Billing Activity Type EQ WRK.BLANK
      *   |- c2    : WRK.Billing Activity Type is Credit or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3OBST    IFEQ WUGSTX                     *IF
     C           WUOBST    IFEQ '2'                        *IF
     C           WUOBST    OREQ '3'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: PAR.Billing Activity Type EQ WRK.Billing Activity Type
     C           P3OBST    IFEQ WUOBST                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVELWUJVNA    ZA0001           Order Type Desc
     C                     MOVELP2JNCD    ZA0002           Order Type - Sa
      * Send message 'Order type invalid'
     C                     MOVEL'USR1895' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Order Types            NF'
     C                     MOVEL'USR1063' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * Validate original order number
      * CASE: KEY.@Order Number Alpha is NE Zero
     C           #PBFC7    IFNE *ZERO                      *IF
      * RTV Invoice Number     RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0030           Company Number
     C                     Z-ADD#PBFC7    WL0031           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    #PPONB           Invoice Number
     C                     MOVELWL0033    WUG0TX    P      Invoice Suffix
     C                     Z-ADDWL0034    WUNFNN           Invoice Date
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert @Order Number Alpha to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PBFC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PBFC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Original order not found'
     C                     MOVEL'USR1777' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate original invoice number
      * CASE: KEY.@Invoice Number is Not equal to zero
     C           #PPONB    IFNE *ZERO                      *IF
      * RTV Order # for Invc   RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0025           Company Number
     C                     Z-ADD#PPONB    WL0026           Invoice Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    #PBFC7           Order Number
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#PPONB    ZA0004           @Invoice Number
      * Send message 'Original invoice not fnd'
     C                     MOVEL'USR1778' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check for other memos attached to original order number
      * CASE: KEY.@Order Number Alpha is NE Zero
     C           #PBFC7    IFNE *ZERO                      *IF
      * VAL Addl Memos for Ord RT - PD Order Header  * 
     C                     EXSR SFRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,003                    *IF
      * WW Attached Memos      DF - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#PBFC7    PAT3NB           Attach to Order
      *
     C                     CALL 'PDY5DFR'              90  WW Attached Mem
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDY5DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Ensure that if a field was Selected, the program does not continu
      * CASE: WRK.Record Selected       USR is yes
     C           WUZZST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWUGSTX    ZA0005           BLANK
      * Send message 'Not a real error'
     C                     MOVEL'USR1969' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Number required
     C           #1C4NB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
      * USER: Process key screen request
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO CCEXIT                     *QUIT
     C                     END                             *FI
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MFIZ#2
     C                     END
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #1BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Affect Auto Accruals
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1WBST    W0NSRQ  1        Affect Auto Acc
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#1WBST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1318755   Y2LSNO  70
     C           #1WBST    PARM #1WBST    W0EXVL 25        Affect Auto Acc
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
     C                     MOVEL#PAPTX    #PAPTX           Company Name
      * If nothing on Edit Credit/Debit Memo screen changes, do not Confi
      * CASE: SOMETHING CHANGED
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18ORc19ORc20ORc21ORc22
      *   |- c1    : DTL.Ship To Customer NE WRK.Ship To Customer
      *   |- c2    : DTL.Ship To Name NE WRK.Ship To Name
      *   |- c3    : DTL.Ship To Address Line 1 NE WRK.Ship To Address Li
      *   |- c4    : DTL.Ship To Address Line 2 NE WRK.Ship To Address Li
      *   |- c5    : DTL.Ship To Address Line 3 NE WRK.Ship To Address Li
      *   |- c6    : DTL.Ship To City NE WRK.Ship To City
      *   |- c7    : DTL.Ship To State Code NE WRK.Ship To State Code
      *   |- c8    : DTL.Ship To Zip/Postal Code NE WRK.Ship To Zip/Posta
      *   |- c9    : DTL.Bill to Name NE WRK.Bill to Name
      *   |- c10   : DTL.Bill to Address Line 1 NE WRK.Bill to Address Li
      *   |- c11   : DTL.Bill to Address Line 2 NE WRK.Bill to Address Li
      *   |- c12   : DTL.Bill to Address Line 3 NE WRK.Bill to Address Li
      *   |- c13   : DTL.Bill to City NE WRK.Bill to City
      *   |- c14   : DTL.Bill to State Code NE WRK.Bill to State Code
      *   |- c15   : DTL.Bill to Zip/Postal Code NE WRK.Bill to Zip/Posta
      *   |- c16   : DTL.Attach to Order Number NE WRK.Attach to Order Nu
      *   |- c17   : DTL.Attach to Invoice Number NE WRK.Attach to Invoic
      *   |- c18   : DTL.Customer Purchase Order # NE WRK.Customer Purcha
      *   |- c19   : DTL.Resell Reference Number NE WRK.Resell Reference
      *   |- c20   : DTL.Special Comment 1 NE WRK.Special Comment 1
      *   |- c21   : DTL.Special Comment 2 NE WRK.Special Comment 2
      *   |- c22   : DTL.Affect Auto Accruals NE WRK.Affect Auto Accruals
      *   '-
     C           #1BKC7    IFNE WUBKC7                     *IF
     C           #1BRTX    ORNE WUBRTX                     *OR
     C           #1HMNA    ORNE WUHMNA                     *OR
     C           #1HONA    ORNE WUHONA                     *OR
     C           #1HPNA    ORNE WUHPNA                     *OR
     C           #1HNNA    ORNE WUHNNA                     *OR
     C           #1DBCD    ORNE WUDBCD                     *OR
     C           #1CKTX    ORNE WUCKTX                     *OR
     C           #1AETX    ORNE WUAETX                     *OR
     C           #1B1NA    ORNE WUB1NA                     *OR
     C           #1B3NA    ORNE WUB3NA                     *OR
     C           #1B4NA    ORNE WUB4NA                     *OR
     C           #1B2NA    ORNE WUB2NA                     *OR
     C           #1BHCD    ORNE WUBHCD                     *OR
     C           #1C8TX    ORNE WUC8TX                     *OR
     C           #1T3NB    ORNE WUT3NB                     *OR
     C           #1ATIN    ORNE WUATIN                     *OR
     C           #1BCNA    ORNE WUBCNA                     *OR
     C           #1RSRN    ORNE WURSRN                     *OR
     C           #1MHNA    ORNE WUMHNA                     *OR
     C           #1MINA    ORNE WUMINA                     *OR
     C           #1WBST    ORNE WUWBST                     *OR
      * Edit details
      * CASE: DTL.*CMD key is *Edit Details
     C           *IN13     IFEQ '1'                        *IF
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Edit details
      * CASE: DTL.*CMD key is *Edit Details
     C           *IN13     IFEQ '1'                        *IF
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * EDT Cr/Dr Memo Lines   EF - Order Detail  * 
     C                     CALL 'PDPGEFR'              90  EDT Cr/Dr Memo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0014  30       Company Number
     C                     PARM #1C4NB    WQ0015  70       Order Number
     C                     PARM #1JNCD    WQ0016  2        Order Type - Sa
     C                     PARM #1BKC7    WQ0017  70       Ship To Custome
     C                     PARM #1BRTX    WQ0018 30        Ship To Name
     C                     PARM #1A0DT    WQ0019  70       Order Date
     C                     PARM #1U1ST    WQ0020  1        Price Status
     C                     PARM #1C0C7    WQ0021  70       Claim Number
     C                     PARM P1DNCD    WQ0022  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPGEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process Selects
      * CASE: Select Ship to (& Bill to) Customer
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V1BKC7'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Shipto & A/R Cust  SR - Customer  * 
     C                     CALL 'PDY5SRR'              90  SEL Shipto & A/
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0023  70       Ship To Custome
     C           #1ANC7    PARM *ZERO     WQ0024  70       A/R Customer Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDY5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Fill in Bill to information
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     Z-ADD#1ANC7    #1B0C7           Bill to Custome
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0035           Ship To Custome
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0036    #1BRTX    P      Customer Name
     C                     MOVELWL0037    #1HMNA    P      Address Line 1
     C                     MOVELWL0038    #1HONA    P      Address Line 2
     C                     MOVELWL0039    #1HPNA    P      Address Line 3
     C                     MOVELWL0040    #1HNNA    P      City
     C                     MOVELWL0041    #1DBCD    P      State Code
     C                     MOVELWL0042    #1CKTX    P      Zip/Postal Code
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1B0C7    WL0035           Ship To Custome
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0036    #1AETX    P      Customer Name
     C                     MOVELWL0037    #1B1NA    P      Address Line 1
     C                     MOVELWL0038    #1B3NA    P      Address Line 2
     C                     MOVELWL0039    #1B4NA    P      Address Line 3
     C                     MOVELWL0040    #1B2NA    P      City
     C                     MOVELWL0041    #1BHCD    P      State Code
     C                     MOVELWL0042    #1C8TX    P      Zip/Postal Code
     C                     Z-ADD#1BKC7    P2BKC7           Ship To Custome
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: Select Ship to State
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Ship To State Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#1DBCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL State              SR - State  * 
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1DBCD    PARM #1DBCD    WQ0025  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: Select Bill to State
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Bill to State Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#1BHCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL State              SR - State  * 
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1BHCD    PARM #1BHCD    WQ0026  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: Select Attach Order Number
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Attach to Order Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V1T3NB'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Will need to select only Invoice type orders ??
      * SEL Order by PO        SR - OP Order Header  * 
     C                     CALL 'PDHKSRR'              90  SEL Order by PO
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0027  30       Company Number
     C           #1T3NB    PARM #1T3NB    WQ0028  70       Order Number
     C           WUBCNA    PARM WUBCNA    WQ0029 15        Customer Purcha
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHKSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: Select Attach Invoice
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Attach to Invoice Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#1ATIN'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL A/R Header         SR - A/R Header  * 
     C                     CALL 'PDPGSRR'              90  SEL A/R Header
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0030  30       Company Number
     C           #1ATIN    PARM #1ATIN    WQ0031  70       Invoice Number
     C           WUCEST    PARM WUCEST    WQ0032  2        Invoice Suffix
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: F4 on Ship To City
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Ship To City
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#1HNNA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** FP1251 LJB 03/19/2008 change to To City and State
      * SEL Milge Ship To City SR - Mileage Between Cities  * 
     C                     CALL 'PDWMSRR'              90  SEL Milge Ship
     C                     PARM *BLANK    W0RTN   7
     C           #1HNNA    PARM #1HNNA    WQ0033 20        To City
     C           #1DBCD    PARM #1DBCD    WQ0034  2        To State State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     994041*
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Orig order & invoice both entered
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Attach to Order Number is Not equal to zeros
      *   |- c2    : DTL.Attach to Invoice Number is Not equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1T3NB    IFNE *ZERO                      *IF
     C           #1ATIN    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Order # for Invc   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0025           Company Number
     C                     Z-ADD#1ATIN    WL0026           Invoice Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    WUT3NB           Order Number
      * Error if attach to order isn't order for invoice
      * CASE: WRK.Attach to Order Number NE DTL.Attach to Order Number
     C           WUT3NB    IFNE #1T3NB                     *IF
      * Setup message data for message
      * Convert Attach to Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1T3NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1T3NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0006           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD#1ATIN    ZA0007           Attach to Invoi
      * Send message 'Order & Invoice mismatch'
     C                     MOVEL'USR1997' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Validate original order number
      * CASE: DTL.Attach to Order Number is Not equal to zeros
     C           #1T3NB    IFNE *ZERO                      *IF
      * RTV Invoice Number     RT - OP Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0030           Company Number
     C                     Z-ADD#1T3NB    WL0031           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    WUATIN           Invoice Number
     C                     MOVELWL0033    WUG0TX    P      Invoice Suffix
     C                     Z-ADDWL0034    WUNFNN           Invoice Date
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Fill in/check invoice number
      * CASE: DTL.Attach to Invoice Number EQ WRK.ZERO
     C           #1ATIN    IFEQ WUW0NB                     *IF
     C                     Z-ADDWUATIN    #1ATIN           Attach to Invoi
     C                     ELSE
      * CASE: WRK.Attach to Invoice Number EQ DTL.Attach to Invoice Numbe
     C           WUATIN    IFEQ #1ATIN                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Attach to Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1T3NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1T3NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0008           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0008           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD#1ATIN    ZA0009           Attach to Invoi
      * Send message 'Order & Invoice mismatch'
     C                     MOVEL'USR1997' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Attach to Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1T3NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1T3NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0010           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0010           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Original order not found'
     C                     MOVEL'USR1777' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate original invoice number
      * CASE: DTL.Attach to Invoice Number is Not equal to zero
     C           #1ATIN    IFNE *ZERO                      *IF
      * RTV Order # for Invc   RT - OP Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0025           Company Number
     C                     Z-ADD#1ATIN    WL0026           Invoice Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    WUT3NB           Order Number
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Fill in/check order number
      * CASE: DTL.Attach to Order Number EQ WRK.ZERO
     C           #1T3NB    IFEQ WUW0NB                     *IF
     C                     Z-ADDWUT3NB    #1T3NB           Attach to Order
     C                     ELSE
      * CASE: WRK.Attach to Order Number EQ DTL.Attach to Order Number
     C           WUT3NB    IFEQ #1T3NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Attach to Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1T3NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1T3NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0011           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0011           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD#1ATIN    ZA0012           Attach to Invoi
      * Send message 'Order & Invoice mismatch'
     C                     MOVEL'USR1997' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1ATIN    ZA0013           Attach to Invoi
      * Send message 'Original invoice not fnd'
     C                     MOVEL'USR1778' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Original document change
      * CASE: PAR.Attach to Invoice Number NE DTL.Attach to Invoice Numbe
     C           P2ATIN    IFNE #1ATIN                     *IF
      * RTV Order # for Invc   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0025           Company Number
     C                     Z-ADD#1ATIN    WL0026           Invoice Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0027    #1T3NB           Order Number
      * Fill in fields from original order
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Orig Order Fields  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1T3NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    #1ANC7           A/R Customer Nu
     C                     Z-ADDWL0004    #1BKC7           Ship To Custome
     C                     MOVELWL0005    #1BRTX    P      Ship To Name
     C                     MOVELWL0006    #1HMNA    P      Ship To Address
     C                     MOVELWL0007    #1HONA    P      Ship To Address
     C                     MOVELWL0008    #1HPNA    P      Ship To Address
     C                     MOVELWL0009    #1HNNA    P      Ship To City
     C                     MOVELWL0010    #1DBCD    P      Ship To State C
     C                     MOVELWL0011    #1CKTX    P      Ship To Zip/Pos
     C                     Z-ADDWL0012    #1B0C7           Bill to Custome
     C                     MOVELWL0013    #1AETX    P      Bill to Name
     C                     MOVELWL0014    #1B1NA    P      Bill to Address
     C                     MOVELWL0015    #1B3NA    P      Bill to Address
     C                     MOVELWL0016    #1B4NA    P      Bill to Address
     C                     MOVELWL0017    #1B2NA    P      Bill to City
     C                     MOVELWL0018    #1BHCD    P      Bill to State C
     C                     MOVELWL0019    #1C8TX    P      Bill to Zip/Pos
     C                     MOVELWL0020    #1BCNA    P      Customer Purcha
     C                     MOVELWL0021    #1U2ST    P      Export Status
     C                     MOVELWL0022    #1R4CD    P      Sales Route Cod
     C                     MOVELWL0023    #1BFCD    P      Manager Level C
     C                     MOVELWL0024    #1Q4CD    P      VP Level Code
     C                     END                             *FI
     C                     Z-ADD#1T3NB    P2T3NB           Attach to Order
     C                     Z-ADD#1ATIN    P2ATIN           Attach to Invoi
     C                     Z-ADD#1BKC7    P2BKC7           Ship To Custome
     C                     ELSE
      * CASE: PAR.Attach to Order Number NE DTL.Attach to Order Number
     C           P2T3NB    IFNE #1T3NB                     *IF
      * RTV Orig Order Fields  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1T3NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    #1ANC7           A/R Customer Nu
     C                     Z-ADDWL0004    #1BKC7           Ship To Custome
     C                     MOVELWL0005    #1BRTX    P      Ship To Name
     C                     MOVELWL0006    #1HMNA    P      Ship To Address
     C                     MOVELWL0007    #1HONA    P      Ship To Address
     C                     MOVELWL0008    #1HPNA    P      Ship To Address
     C                     MOVELWL0009    #1HNNA    P      Ship To City
     C                     MOVELWL0010    #1DBCD    P      Ship To State C
     C                     MOVELWL0011    #1CKTX    P      Ship To Zip/Pos
     C                     Z-ADDWL0012    #1B0C7           Bill to Custome
     C                     MOVELWL0013    #1AETX    P      Bill to Name
     C                     MOVELWL0014    #1B1NA    P      Bill to Address
     C                     MOVELWL0015    #1B3NA    P      Bill to Address
     C                     MOVELWL0016    #1B4NA    P      Bill to Address
     C                     MOVELWL0017    #1B2NA    P      Bill to City
     C                     MOVELWL0018    #1BHCD    P      Bill to State C
     C                     MOVELWL0019    #1C8TX    P      Bill to Zip/Pos
     C                     MOVELWL0020    #1BCNA    P      Customer Purcha
     C                     MOVELWL0021    #1U2ST    P      Export Status
     C                     MOVELWL0022    #1R4CD    P      Sales Route Cod
     C                     MOVELWL0023    #1BFCD    P      Manager Level C
     C                     MOVELWL0024    #1Q4CD    P      VP Level Code
     C                     Z-ADD#1T3NB    P2T3NB           Attach to Order
     C                     Z-ADD#1ATIN    P2ATIN           Attach to Invoi
     C                     Z-ADD#1BKC7    P2BKC7           Ship To Custome
     C                     END                             *FI
     C                     END                             *FI
      * Customer change
      * CASE: DTL.Ship To Customer NE PAR.Ship To Customer
     C           #1BKC7    IFNE P2BKC7                     *IF
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0035           Ship To Custome
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0036    #1BRTX    P      Customer Name
     C                     MOVELWL0037    #1HMNA    P      Address Line 1
     C                     MOVELWL0038    #1HONA    P      Address Line 2
     C                     MOVELWL0039    #1HPNA    P      Address Line 3
     C                     MOVELWL0040    #1HNNA    P      City
     C                     MOVELWL0041    #1DBCD    P      State Code
     C                     MOVELWL0042    #1CKTX    P      Zip/Postal Code
     C                     Z-ADD#1BKC7    P2BKC7           Ship To Custome
      * RTV Customer A/R Cust  RT - Customer  * 
     C                     EXSR SHRVGN
     C                     Z-ADD#1ANC7    #1B0C7           Bill to Custome
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1B0C7    WL0035           Ship To Custome
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0036    #1AETX    P      Customer Name
     C                     MOVELWL0037    #1B1NA    P      Address Line 1
     C                     MOVELWL0038    #1B3NA    P      Address Line 2
     C                     MOVELWL0039    #1B4NA    P      Address Line 3
     C                     MOVELWL0040    #1B2NA    P      City
     C                     MOVELWL0041    #1BHCD    P      State Code
     C                     MOVELWL0042    #1C8TX    P      Zip/Postal Code
     C                     END                             *FI
      * Set up sales route, mgr, VP
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Attach to Order Number EQ WRK.ZERO
      *   |- c2    : DTL.Attach to Invoice Number EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1T3NB    IFEQ WUW0NB                     *IF
     C           #1ATIN    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Sales Route        RT - Company/Customer  * 
     C                     EXSR SIRVGN
      * RTV Sales Hierarchy    RT - PD Sales Route  * 
     C                     EXSR SJRVGN
      * CASE: DTL.VP Level Code EQ WRK.BLANK
     C           #1Q4CD    IFEQ WUGSTX                     *IF
      * RTV Mgr Desc,VP Level  RT - Manager Level  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     END                             *FI
      * Ensure that bill to customer not 0
      * CASE: DTL.Bill to Customer EQ WRK.ZERO
     C           #1B0C7    IFEQ WUW0NB                     *IF
      * Setup message data for message
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1B0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0014           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0014           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'A/R Customer invalid'
     C                     MOVEL'USR2110' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL Check Exists       RT - Customer  * 
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1B0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0015           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0015           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'A/R Customer invalid'
     C                     MOVEL'USR2110' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate that the ship to Customer entered has a shiptoflag
     C                     EXSR UCSUBR                     Validate that t
      * 06/26/14 PKD E3164 Need Shipping Method for Credit/Debit Memo for
      *              processing Accrual Programs for Daily's
      * 09/11/14 JJH E3387 Removed validation for Daily's Only.  It will
      *          Validation will now occur for all companies.
      * E4057 JJH 09/06/15 - SNDERRMSG if Affect Auto Accruals is not
      *   set to a Y or N
      * SNDERRMSG if Affect Auto Accruals NE Y or N
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.Affect Auto Accruals is Affect Auto Accruals
      *   |- c2    : DTL.Affect Auto Accruals is Dont Affect Auto Accrual
      *   '-
     C           #1WBST    IFEQ 'Y'                        *IF
     C           #1WBST    OREQ 'N'                        *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1WBST    ZA0017           Affect Auto Acc
      * Send message 'Affect Auto Accrual Valid'
     C                     MOVEL'USR4796' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Order Types
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Check reference to State
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9941  *
     C                     END
      * Check reference to Customer
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9944  *
     C                     END
      * Check reference to Calendar
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to OP Reason Codes
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Sales Route
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Internal Reason
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Event Types
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to A/R Claim
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
     C                     MOVEL*BLANK    #DDGU1           ACR Shipping Me
      * ACR Shipping Method DRV
      * PAR.ACR Shipping Method DRV = Condition name of PAR.ACR Shipping
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #1Q2CD    W0INVL 25        ACR Shipping Me
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DDGU1    PARM           W0CNNM 25        ACR Shipping Me
      *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * Add mode processing
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * RTV Terms/Type        RT - Company/Customer  * 
     C                     EXSR SNRVGN
      * CASE: DTL.Export Status is blank
     C           #1U2ST    IFEQ *BLANK                     *IF
      * CASE: LCL.Type Code is Export
     C           YL0003    IFEQ 'EX'                       *IF
     C                     MOVEL'Y'       #1U2ST           Export Status
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Co. Dflt Int All   RT - Company Defaults Internal  * 
     C                     EXSR SORVGN
     C                     MOVELYL0004    #1U2ST           Export Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Ship To Customer required
     C           #1BKC7    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Ship To Name required
     C           #1BRTX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Bill to Name required
     C           #1AETX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Ship To Address Line 1 required
     C           #1HMNA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Bill to Address Line 1 required
     C           #1B1NA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Ship To City required
     C           #1HNNA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9940  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Ship To State Code required
     C           #1DBCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9941  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Ship To Zip/Postal Code required
     C           #1CKTX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9942  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Bill to City required
     C           #1B2NA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9943  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Bill to State Code required
     C           #1BHCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9944  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Bill to Zip/Postal Code required
     C           #1C8TX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9945  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * Add mode processing
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     EXSR SPCRRC
      * RTV Billing Type       RT - OP Order Types  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1JNCD    WL0028    P      Order Type - Sa
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0029    WUOBST    P      Billing Activit
      * Set Invoice Suffix
      * CASE: WRK.Billing Activity Type is Credit Memo
     C           WUOBST    IFEQ '2'                        *IF
     C                     MOVEL'CM'      #1CEST           Invoice Suffix
     C                     ELSE
      * CASE: WRK.Billing Activity Type is Debit Memo
     C           WUOBST    IFEQ '3'                        *IF
     C                     MOVEL'DM'      #1CEST           Invoice Suffix
     C                     END                             *FI
     C                     END                             *FI
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0018           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0018           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order created'
     C                     MOVEL'USR1968' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * EDT Cr/Dr Memo Lines   EF - Order Detail  * 
     C                     CALL 'PDPGEFR'              90  EDT Cr/Dr Memo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0046  30       Company Number
     C                     PARM #1C4NB    WQ0047  70       Order Number
     C                     PARM #1JNCD    WQ0048  2        Order Type - Sa
     C                     PARM #1BKC7    WQ0049  70       Ship To Custome
     C                     PARM #1BRTX    WQ0050 30        Ship To Name
     C                     PARM #1A0DT    WQ0051  70       Order Date
     C                     PARM #1U1ST    WQ0052  1        Price Status
     C                     PARM #1C0C7    WQ0053  70       Claim Number
     C                     PARM P1DNCD    WQ0054  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPGEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
     C                     Z-ADD#1C4NB    P2C4NB           Order Number
     C                     END                             *FI
      * no need to update load weight, since memos aren't load planned.
      * Edit details
      * CASE: DTL.*CMD key is *Edit Details
     C           *IN13     IFEQ '1'                        *IF
      * EDT Cr/Dr Memo Lines   EF - Order Detail  * 
     C                     CALL 'PDPGEFR'              90  EDT Cr/Dr Memo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0055  30       Company Number
     C                     PARM #1C4NB    WQ0056  70       Order Number
     C                     PARM #1JNCD    WQ0057  2        Order Type - Sa
     C                     PARM #1BKC7    WQ0058  70       Ship To Custome
     C                     PARM #1BRTX    WQ0059 30        Ship To Name
     C                     PARM #1A0DT    WQ0060  70       Order Date
     C                     PARM #1U1ST    WQ0061  1        Price Status
     C                     PARM #1C0C7    WQ0062  70       Claim Number
     C                     PARM P1DNCD    WQ0063  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPGEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
     C                     END                             *FI
      * Cmd 3 End of Job
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     GOTO EBEXIT                     *QUIT
     C                     END                             *FI
     C           W0PMD     IFEQ 'ADD'
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
     C                     END
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * CRT Order Hdr-auto nbr CR - Order Header TRG  * 
     C                     EXSR SQCRRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Order Header       CH - Order Header TRG  * 
     C                     EXSR STCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YCRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P2AIC3    IFEQ *ZERO                      Company Number
     C           P2C4NB    OREQ *ZERO                      Order Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P8CHST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           #DGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           P9R4ST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           P1WVST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      * Enable key screen
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #DGGST           USR Display fie
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     Z-ADD*ZERO     #1ANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     #1ACDT           Cancel Date
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #1GJST           Order in Use
     C                     MOVEL*BLANK    #1GWST           Header Status
     C                     MOVEL*BLANK    #1GXST           Header Status L
     C                     MOVEL*BLANK    #1GYST           Order Type Prin
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
     C                     MOVEL*BLANK    #1AIVN           User Original E
     C                     Z-ADD*ZERO     #1CXDT           Date of Origina
     C                     MOVEL*BLANK    #1XIST           Credit Hold
     C                     MOVEL*BLANK    #1XJST           Production Hold
     C                     MOVEL*BLANK    #1XKST           New Customer Ho
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
     C                     MOVEL*BLANK    #1E8CD           Accounts Receiv
     C                     MOVEL*BLANK    #1E9CD           Accounts Receiv
     C                     MOVEL*BLANK    #1U0ST           Price Audit
     C                     MOVEL*BLANK    #1U1ST           Price Status
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     Z-ADD*ZERO     #1T3NB           Attach to Order
     C                     Z-ADD*ZERO     #1ATIN           Attach to Invoi
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     MOVEL*BLANK    #1SICD           Reason for Pric
     C                     Z-ADD*ZERO     #1CONB           Invoice Number
     C                     MOVEL*BLANK    #1CEST           Invoice Suffix
     C                     Z-ADD*ZERO     #1AWDT           Invoice Date
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1BFCD           Manager Level C
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1AQCD           Terms Code
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     #1A5DT           Requested Ship
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     Z-ADD*ZERO     #1AFTM           Requested Deliv
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     MOVEL*BLANK    #1VFST           Shrink Wrap
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #1VEST           Palletize
     C                     MOVEL*BLANK    #1VGST           Slip Sheet
     C                     MOVEL*BLANK    #1XUST           Trans Contol AS
     C                     MOVEL*BLANK    #1Z1ST           Modified Flag
     C                     Z-ADD*ZERO     #1VRVA           A/R order Value
     C                     MOVEL*BLANK    #1OBST           Billing Activit
     C                     MOVEL*BLANK    #1BCST           Block Order Fla
     C                     MOVEL*BLANK    #1BDST           Order Certifica
     C                     Z-ADD*ZERO     #1B7VL           Invoice Order V
     C                     MOVEL*BLANK    #1GASX           Process Sts for
     C                     MOVEL*BLANK    #1GBSX           Order Conf Fax
     C                     MOVEL*BLANK    #1GCSX           Manifest Fax St
     C                     MOVEL*BLANK    #1GDSX           Invoice Fax Sts
     C                     MOVEL*BLANK    #1FNSX           Transfer in Sto
     C                     MOVEL*BLANK    #1FOSX           Email Cust On O
     C                     MOVEL*BLANK    #1FPSX           Order Emailed
     C                     MOVEL*BLANK    #1FQSX           Export Docs Go
     C                     MOVEL*BLANK    #1FRSX           Shipping Temp C
     C                     MOVEL*BLANK    #1FSSX           Broker Order St
     C                     MOVEL*BLANK    #1FTSX           Air Freight Ord
     C                     MOVEL*BLANK    #1FUSX           Order Requires
     C                     MOVEL*BLANK    #1FVSX           OH Load Plan Re
     C                     MOVEL*BLANK    #1FWSX           Export USDA App
     C                     MOVEL*BLANK    #1FXSX           HPB Ship to War
     C                     MOVEL*BLANK    #1FYSX           OH TF Exempt Co
     C                     Z-ADD*ZERO     #1NODT           OH Appt Confirm
     C                     Z-ADD*ZERO     #1NPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     #1NQDT           Load Actual Shi
     C                     Z-ADD*ZERO     #1NRDT           Load BOL Comple
     C                     Z-ADD*ZERO     #1NSDT           Load Truck Depa
     C                     Z-ADD*ZERO     #1BPTM           Maximum Gross W
     C                     Z-ADD*ZERO     #1BQTM           Time of Origina
     C                     Z-ADD*ZERO     #1BRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     #1BSTM           Load BOL Comple
     C                     Z-ADD*ZERO     #1BTTM           Load Truck Depa
     C                     Z-ADD*ZERO     #1H0NX           Act Frt Referen
     C                     Z-ADD*ZERO     #1H1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     #1H2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     #1H3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     #1H4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     #1C0C7           Claim Number
     C                     MOVEL*BLANK    #1U4ST           Load Plan Order
     C                     MOVEL*BLANK    #1U5ST           Print Pick Slip
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     MOVEL*BLANK    #1B6NA           Special Instruc
     C                     MOVEL*BLANK    #1BYNA           Special Instruc
     C                     MOVEL*BLANK    #1GTST           Comment Print A
     C                     MOVEL*BLANK    #1GVST           Comment Print I
     C                     MOVEL*BLANK    #1GUST           Comment Print P
     C                     MOVEL*BLANK    #1QFST           Comment Print S
     C                     Z-ADD*ZERO     #1JZVA           Order Value Tot
     C                     MOVEL*BLANK    #1JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #1A1WG           Order Weight To
     C                     Z-ADD*ZERO     #1A0DT           Order Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1A0DT
     C                     Z-ADD*ZERO     #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     Z-ADD*ZERO     #1B0C7           Bill to Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1B0C7
     C                     MOVEL*BLANK    #1BRTX           Ship To Name
     C                     MOVEL*BLANK    #1AETX           Bill to Name
     C                     MOVEL*BLANK    #1HMNA           Ship To Address
     C                     MOVEL*BLANK    #1B1NA           Bill to Address
     C                     MOVEL*BLANK    #1HONA           Ship To Address
     C                     MOVEL*BLANK    #1B3NA           Bill to Address
     C                     MOVEL*BLANK    #1HPNA           Ship To Address
     C                     MOVEL*BLANK    #1B4NA           Bill to Address
     C                     MOVEL*BLANK    #1HNNA           Ship To City
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     MOVEL*BLANK    #1CKTX           Ship To Zip/Pos
     C                     MOVEL*BLANK    #1B2NA           Bill to City
     C                     MOVEL*BLANK    #1BHCD           Bill to State C
     C                     MOVEL*BLANK    #1C8TX           Bill to Zip/Pos
     C                     MOVEL*BLANK    #1BCNA           Customer Purcha
     C                     Z-ADD*ZERO     #1RSRN           Resell Referenc
     C                     MOVEL*BLANK    #1MHNA           Special Comment
     C                     MOVEL*BLANK    #1MINA           Special Comment
     C                     MOVEL*BLANK    #1WBST           Affect Auto Acc
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     MOVEL*BLANK    #DDGU1           ACR Shipping Me
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BECPFK fields to screen
      *================================================================
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP7BFC7    #PBFC7           @Order Number A
     C                     Z-ADDP6PONB    #PPONB           @Invoice Number
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELP4APTX    #PAPTX           Company Name
     C                     Z-ADDP2C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     MOVELP5JMCD    #PJMCD           @Order Type Cod
      * USER: Initialize key screen
      * RTV Company Name - Company Name and Address  * 
     C                     EXSR SVRVGN
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
     C                     Z-ADDP2C4NB    #1C4NB           Order Number
     C                     MOVELP2JNCD    #PJMCD           @Order Type Cod
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MFIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     MOVEL*BLANK    #DDGU1           ACR Shipping Me
      *================================================================
     CSR         MFEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  #1A0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A0DT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1B0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1B0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1B0C7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Orig Order Fields  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0001    BEAIC3           Company Number
     C                     Z-ADDWL0002    BEC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEANC7    WL0003           A/R Customer Nu
     C                     Z-ADDBEBKC7    WL0004           Ship To Custome
     C                     MOVELBEBRTX    WL0005           Ship To Name
     C                     MOVELBEHMNA    WL0006           Ship To Address
     C                     MOVELBEHONA    WL0007           Ship To Address
     C                     MOVELBEHPNA    WL0008           Ship To Address
     C                     MOVELBEHNNA    WL0009           Ship To City
     C                     MOVELBEDBCD    WL0010           Ship To State C
     C                     MOVELBECKTX    WL0011           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    WL0012           Bill to Custome
     C                     MOVELBEAETX    WL0013           Bill to Name
     C                     MOVELBEB1NA    WL0014           Bill to Address
     C                     MOVELBEB3NA    WL0015           Bill to Address
     C                     MOVELBEB4NA    WL0016           Bill to Address
     C                     MOVELBEB2NA    WL0017           Bill to City
     C                     MOVELBEBHCD    WL0018           Bill to State C
     C                     MOVELBEC8TX    WL0019           Bill to Zip/Pos
     C                     MOVELBEBCNA    WL0020           Customer Purcha
     C                     MOVELBEU2ST    WL0021           Export Status
     C                     MOVELBER4CD    WL0022           Sales Route Cod
     C                     MOVELBEBFCD    WL0023           Manager Level C
     C                     MOVELBEQ4CD    WL0024           VP Level Code
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Order # for Invc   RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WACONB    WQSB02           Invoice Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Invoice Number
      * Setup key
     C                     Z-ADDWL0025    WQSB01           Company Number
     C                     Z-ADDWL0026    WQSB02           Invoice Number
      * Establish starting position
     C           KRSSB     SETLL@BFCPDX                    *
     C           KRSSB     READE@BFCPDX                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAC4NB    WL0027           Order Number
     C           KRSSB     READE@BFCPDX                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - OP Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           EXJNCD           Order Type - Sa
      * Setup key
     C                     MOVELWL0028    EXJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSC     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEXOBST    WL0029           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Next Order Number  RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADD*ZERO     ASAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDASC5NB    #1C4NB           Next Order Numb
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Invoice Number     RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0030    BEAIC3           Company Number
     C                     Z-ADDWL0031    BEC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0032           Invoice Number
     C                     MOVEL*BLANK    WL0033           Invoice Suffix
     C                     Z-ADD*ZERO     WL0034           Invoice Date
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBECONB    WL0032           Invoice Number
     C                     MOVELBECEST    WL0033           Invoice Suffix
     C                     Z-ADDBEAWDT    WL0034           Invoice Date
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * VAL Addl Memos for Ord RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WBT3NB    WQSF02           Attach to Order
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Attach to Order
      * Setup key
     C                     Z-ADD#1AIC3    WQSF01           Company Number
     C                     Z-ADD#PBFC7    WQSF02           Attach to Order
      * Establish starting position
     C           KRSSF     SETLL@BFCPN9                    *
     C           KRSSF     READE@BFCPN9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Billing Activity Type is Credit or Debit Memo
     C           WBOBST    IFEQ '2'                        *IF
     C           WBOBST    OREQ '3'
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BFCPN9                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Cust Name/Addr     RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0035    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    WL0036           Customer Name
     C                     MOVELBBACNA    WL0037           Address Line 1
     C                     MOVELBBADNA    WL0038           Address Line 2
     C                     MOVELBBAENA    WL0039           Address Line 3
     C                     MOVELBBAJNA    WL0040           City
     C                     MOVELBBBGCD    WL0041           State Code
     C                     MOVELBBBTTX    WL0042           Zip/Postal Code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Customer A/R Cust  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBBANC7    #1ANC7           A/R Customer Nu
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Sales Route        RT - Company/Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1AIC3    EOAIC3           Company Number
     C                     Z-ADD#1BKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@EOREXM              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOR4CD    #1R4CD           Sales Route Cod
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Sales Hierarchy    RT - PD Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSJ     CHAIN@JEREWS              90    *
      * Data record not found
     C   90                MOVEL'USR1800' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEBFCD    #1BFCD           Manager Level C
     C                     MOVELJEQ4CD    #1Q4CD           VP Level Code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Mgr Desc,VP Level  RT - Manager Level  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           ALBFCD           Manager Level C
      * Setup key
     C                     MOVEL#1BFCD    ALBFCD           Manager Level C
      * Establish starting position
     C           KRSSK     CHAIN@ALREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Description
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELALAUNA    WUG0TX           Description
     C                     MOVELALQ4CD    #1Q4CD           VP Level Code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * VAL Check Exists       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1B0C7    WCBKC7           Ship To Custome
      * Establish starting position
     C           KRSSL     CHAIN@BBREWG              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Ship To Flag       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSM     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WURJST           Ship To Custome
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBRJST    WURJST           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Terms/Type        RT - Company/Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1AIC3    EOAIC3           Company Number
     C                     Z-ADD#1BKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSN     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1AQCD           Terms Code
     C                     MOVEL*BLANK    YL0003           Type Code
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOAQCD    #1AQCD           Terms Code
     C                     MOVELEOBOCD    YL0003           Type Code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Co. Dflt Int All   RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    JYAIC3           Company Number
      * Establish starting position
     C           KRSSO     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUZ9ST           Shipping Method
     C                     MOVEL*BLANK    WUCSST           Load Type Dft
     C                     MOVEL*BLANK    WUZ8ST           LTL Flag Dft
     C                     MOVEL*BLANK    YL0004           Export Status D
     C                     MOVEL*BLANK    WUSWST           Shrink Wrap Dft
     C                     Z-ADD*ZERO     WUXXTM           Departure Time
     C                     MOVEL*BLANK    WUUECD           Export Code Dft
     C                     MOVEL*BLANK    WUHSST           Allow Mult Whse
     C                     MOVEL*BLANK    WUAMEO           Allow Multi Exp
     C                     MOVEL*BLANK    WUSSDF           Slip Sheet Dft
     C                     MOVEL*BLANK    WUPDFT           Palletize Dft
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYZ9ST    WUZ9ST           Shipping Method
     C                     MOVELJYCSST    WUCSST           Load Type Dft
     C                     MOVELJYZ8ST    WUZ8ST           LTL Flag Dft
     C                     MOVELJYCXST    YL0004           Export Status D
     C                     MOVELJYSWST    WUSWST           Shrink Wrap Dft
     C                     Z-ADDJYXXTM    WUXXTM           Departure Time
     C                     MOVELJYUECD    WUUECD           Export Code Dft
     C                     MOVELJYHSST    WUHSST           Allow Mult Whse
     C                     MOVELJYAMEO    WUAMEO           Allow Multi Exp
     C                     MOVELJYSSDF    WUSSDF           Slip Sheet Dft
     C                     MOVELJYPDFT    WUPDFT           Palletize Dft
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - OP Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        EDI Status 1
     C                     MOVEL*BLANK    WN0002  1        EDI Status 2
     C                     MOVEL*BLANK    WN0003  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0004  60       Job Time
     C                     MOVEL*BLANK    WN0005 10        User Id
     C                     MOVEL*BLANK    WN0006 10        Job Name
     C                     Z-ADD*ZERO     WN0007  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADD#1AIC3    EYAIC3           Company Number
     C                     Z-ADD#1C4NB    EYC4NB           Order Number
     C                     Z-ADD1         EYQ2NB           Event Number
     C                     MOVEL'01'      EYJPCD           Event Code
     C                     Z-ADD#1AIC3    EYAUC3           Invoice/Memo Co
     C                     Z-ADD#1C4NB    EYQ7NB           Invoice/Memo Nu
     C                     MOVEL*BLANK    EYOMST           Invoice/Memo Su
     C                     Z-ADD##JDT     EYD2DT           Event Date
     C                     MOVEL'Y'       EYONST           Activity Comple
     C                     MOVEL'N'       EYOOST           Activity Hold
     C                     MOVEL'Y'       EYOPST           Post Cash Compl
     C                     Z-ADD*ZERO     EYAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     EYQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     EYQ9NB           Cross Event Ref
     C                     Z-ADD#1BKC7    EYBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     EYAATM           Job Time
     C                     MOVEL##USR     EYAYNA           User Id
     C                     MOVEL##JOB     EYA0NA           Job Name
     C                     Z-ADD##JDT     EYAXDT           Job Date
     C           KLCRSP    KLIST
     C                     KFLD           EYAIC3           Company Number
     C                     KFLD           EYC4NB           Order Number
     C                     KFLD           EYQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSP    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * CRT Order Hdr-auto nbr CR - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0008  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0009 12        Accounts Receiv
     C                     MOVEL*BLANK    WN0010  1        EDI Status 1
     C                     MOVEL*BLANK    WN0011  1        EDI Status 2
     C                     MOVEL*BLANK    WN0012  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0013  60       Job Time
     C                     MOVEL*BLANK    WN0014 10        User Id
     C                     MOVEL*BLANK    WN0015 10        Job Name
     C                     Z-ADD*ZERO     WN0016  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
     C                     MOVEL#1JNCD    BEJNCD           Order Type - Sa
     C                     Z-ADD#1ANC7    BEANC7           A/R Customer Nu
     C                     Z-ADD#1BKC7    BEBKC7           Ship To Custome
     C                     MOVEL#1BRTX    BEBRTX           Ship To Name
     C                     MOVEL#1HMNA    BEHMNA           Ship To Address
     C                     MOVEL#1HONA    BEHONA           Ship To Address
     C                     MOVEL#1HPNA    BEHPNA           Ship To Address
     C                     MOVEL#1HNNA    BEHNNA           Ship To City
     C                     MOVEL#1DBCD    BEDBCD           Ship To State C
     C                     MOVEL#1CKTX    BECKTX           Ship To Zip/Pos
     C                     Z-ADD#1B0C7    BEB0C7           Bill to Custome
     C                     MOVEL#1AETX    BEAETX           Bill to Name
     C                     MOVEL#1B1NA    BEB1NA           Bill to Address
     C                     MOVEL#1B3NA    BEB3NA           Bill to Address
     C                     MOVEL#1B4NA    BEB4NA           Bill to Address
     C                     MOVEL#1B2NA    BEB2NA           Bill to City
     C                     MOVEL#1BHCD    BEBHCD           Bill to State C
     C                     MOVEL#1C8TX    BEC8TX           Bill to Zip/Pos
     C                     MOVEL#1BCNA    BEBCNA           Customer Purcha
     C                     Z-ADD#1A0DT    BEA0DT           Order Date
     C                     Z-ADD#1A5DT    BEA5DT           Requested Ship
     C                     Z-ADD#1GNDT    BEGNDT           Actual Shipped
     C                     Z-ADD#1ACDT    BEACDT           Cancel Date
     C                     MOVEL#1AQCD    BEAQCD           Terms Code
     C                     MOVEL#1B6NA    BEB6NA           Special Instruc
     C                     MOVEL#1BYNA    BEBYNA           Special Instruc
     C                     MOVEL#1BZNA    BEBZNA           Carrier Code
     C                     MOVEL#1GTST    BEGTST           Comment Print A
     C                     MOVEL#1GVST    BEGVST           Comment Print I
     C                     MOVEL#1GUST    BEGUST           Comment Print P
     C                     MOVEL#1QFST    BEQFST           Comment Print S
     C                     MOVEL#1CQCD    BECQCD           Reason Code
     C                     MOVEL'Y'       BEGJST           Order in Use
     C                     MOVEL'A'       BEGWST           Header Status
     C                     MOVEL#1GXST    BEGXST           Header Status L
     C                     MOVEL*BLANK    BEGYST           Order Type Prin
     C                     Z-ADD#1AODT    BEAODT           Scheduled Ship
     C                     MOVEL##USR     BEAIVN           User Original E
     C                     Z-ADD##JDT     BECXDT           Date of Origina
     C                     Z-ADD*ZERO     BEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     BEA1WG           Order Weight To
     C                     MOVEL#1XIST    BEXIST           Credit Hold
     C                     MOVEL#1XJST    BEXJST           Production Hold
     C                     MOVEL#1XKST    BEXKST           New Customer Ho
     C                     Z-ADD#1EIDT    BEEIDT           Requested Deliv
     C                     Z-ADD#1AFTM    BEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     BERMNB           Load ID
     C                     Z-ADD*ZERO     BETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     BER1NB           Rated Freight
     C                     MOVEL#1PJST    BEPJST           LTL Flag
     C                     MOVEL#1U0ST    BEU0ST           Price Audit
     C                     MOVEL#1U1ST    BEU1ST           Price Status
     C                     MOVEL#1Q2CD    BEQ2CD           Shipping Method
     C                     MOVEL#1U2ST    BEU2ST           Export Status
     C                     MOVEL#1VEST    BEVEST           Palletize
     C                     MOVEL#1VFST    BEVFST           Shrink Wrap
     C                     MOVEL#1VGST    BEVGST           Slip Sheet
     C                     MOVEL*BLANK    BERPCD           Age Code
     C                     Z-ADD#1RNNB    BERNNB           Reefer Temperat
     C                     MOVEL#1VDST    BEVDST           Load Type
     C                     Z-ADD#1ATIN    BEATIN           Attach to Invoi
     C                     MOVEL#1U4ST    BEU4ST           Load Plan Order
     C                     MOVEL#1U5ST    BEU5ST           Print Pick Slip
     C                     Z-ADD#1RSRN    BERSRN           Resell Referenc
     C                     MOVEL#1MHNA    BEMHNA           Special Comment
     C                     MOVEL#1MINA    BEMINA           Special Comment
     C                     MOVEL#1WBST    BEWBST           Affect Auto Acc
     C                     MOVEL#1R4CD    BER4CD           Sales Route Cod
     C                     MOVEL#1BFCD    BEBFCD           Manager Level C
     C                     MOVEL#1Q4CD    BEQ4CD           VP Level Code
     C                     Z-ADD#1T3NB    BET3NB           Attach to Order
     C                     MOVEL#1SICD    BESICD           Reason for Pric
     C                     Z-ADD#1CONB    BECONB           Invoice Number
     C                     MOVEL#1CEST    BECEST           Invoice Suffix
     C                     Z-ADD#1AWDT    BEAWDT           Invoice Date
     C                     MOVEL#1JPCD    BEJPCD           Event Code
     C                     MOVEL#1XUST    BEXUST           Trans Contol AS
     C                     MOVEL#1Z1ST    BEZ1ST           Modified Flag
     C                     Z-ADD#1VRVA    BEVRVA           A/R order Value
     C                     MOVEL#1OBST    BEOBST           Billing Activit
     C                     MOVEL'F'       BEBCST           Block Order Fla
     C                     MOVEL#1BDST    BEBDST           Order Certifica
     C                     Z-ADD#1B7VL    BEB7VL           Invoice Order V
     C                     MOVEL#1GASX    BEGASX           Process Sts for
     C                     MOVEL#1GBSX    BEGBSX           Order Conf Fax
     C                     MOVEL#1GCSX    BEGCSX           Manifest Fax St
     C                     MOVEL#1GDSX    BEGDSX           Invoice Fax Sts
     C                     MOVEL#1FNSX    BEFNSX           Transfer in Sto
     C                     MOVEL#1FOSX    BEFOSX           Email Cust On O
     C                     MOVEL#1FPSX    BEFPSX           Order Emailed
     C                     MOVEL#1FQSX    BEFQSX           Export Docs Go
     C                     MOVEL#1FRSX    BEFRSX           Shipping Temp C
     C                     MOVEL#1FSSX    BEFSSX           Broker Order St
     C                     MOVEL#1FTSX    BEFTSX           Air Freight Ord
     C                     MOVEL#1FUSX    BEFUSX           Order Requires
     C                     MOVEL#1FVSX    BEFVSX           OH Load Plan Re
     C                     MOVEL#1FWSX    BEFWSX           Export USDA App
     C                     MOVEL#1FXSX    BEFXSX           HPB Ship to War
     C                     MOVEL#1FYSX    BEFYSX           OH TF Exempt Co
     C                     Z-ADD#1NODT    BENODT           OH Appt Confirm
     C                     Z-ADD#1NPDT    BENPDT           JPN Invoice Iss
     C                     Z-ADD#1NQDT    BENQDT           Load Actual Shi
     C                     Z-ADD#1NRDT    BENRDT           Load BOL Comple
     C                     Z-ADD#1NSDT    BENSDT           Load Truck Depa
     C                     Z-ADD#1BPTM    BEBPTM           Maximum Gross W
     C                     Z-ADD##JTM     BEBQTM           Time of Origina
     C                     Z-ADD#1BRTM    BEBRTM           OH Appt Confirm
     C                     Z-ADD#1BSTM    BEBSTM           Load BOL Comple
     C                     Z-ADD#1BTTM    BEBTTM           Load Truck Depa
     C                     Z-ADD#1H0NX    BEH0NX           Act Frt Referen
     C                     Z-ADD#1H1NX    BEH1NX           Act Non-Ref Frt
     C                     Z-ADD#1H2NX    BEH2NX           OH Fuel Surchar
     C                     Z-ADD#1H3NX    BEH3NX           OH Total Non-Re
     C                     Z-ADD#1H4NX    BEH4NX           OH Total Ref Fr
     C                     Z-ADD#1C0C7    BEC0C7           Claim Number
      *
      * USER: Processing before Data update
     C                     MOVEL*BLANK    BERPCD           Age Code
      * Get/Update current next number
      * CASE: PAR.Auto Order Numbering? is yes
     C           P8CHST    IFEQ 'Y'                        *IF
      * PKTR01 Update control company 000                 7/27/04
      * CHG Next Order Number  CH - Company Control  * 
     C                     EXSR SRCHRC
     C                     END                             *FI
      * Check return code
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Get/Update invoice number if Credit or Debit memo
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Invoice Number is Equal to zero
      *   |- c2    : PAR.Billing Activity Type is Credit or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1CONB    IFEQ 0                          *IF
     C           #1OBST    IFEQ '2'                        *IF
     C           #1OBST    OREQ '3'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 02/18/05 PKD get from company 000
      * CHG Next Invoice Nbr   CH - Company Control  * 
     C                     EXSR SSCHRC
      * Invoice Suffix
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           #1OBST    IFEQ '2'                        *IF
     C                     MOVEL'CM'      BECEST           Invoice Suffix
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Debit Memo
     C           #1OBST    IFEQ '3'                        *IF
     C                     MOVEL'DM'      BECEST           Invoice Suffix
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##JOB     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           BECXDT    PARM *ZERO     WQ0068 155       Current System
     C           BEBQTM    PARM *ZERO     WQ0069 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSQ    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@BECPFJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0177' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@BECPFJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
      * USER: Processing if Data update error
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * Move @BECPFJ fields back
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * CHG Next Order Number  CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0017  40       Current Account
     C                     Z-ADD*ZERO     WN0018  20       Current Account
     C                     Z-ADD*ZERO     WN0019  30       OM Week
     C                     Z-ADD*ZERO     WN0020  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0021  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0022  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0023  70       Next Charge Bac
     C                     Z-ADD*ZERO     WN0024  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0025  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0026  70       Next Customer #
     C                     Z-ADD*ZERO     WN0027  70       Next Inventory
     C                     Z-ADD*ZERO     WN0028  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0029  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0030  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0031  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0032  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0033  1        Auto Customers
     C                     MOVEL*BLANK    WN0034  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0035  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0036  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0037 112       Late Charge Min
     C                     MOVEL*BLANK    WN0038  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0039  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0040  1        Allocate Credit
     C                     MOVEL*BLANK    WN0041 30        Message Line 1
     C                     MOVEL*BLANK    WN0042 30        Message Line 2
     C                     MOVEL*BLANK    WN0043 30        Message Line 3
     C                     MOVEL*BLANK    WN0044 30        Message Line 4
     C                     MOVEL*BLANK    WN0045  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0046  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0047  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0048  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0049  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0050  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0051  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0052  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0053  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0054  30       Retention Perio
     C                     Z-ADD*ZERO     WN0055  30       Retention Perio
     C                     Z-ADD*ZERO     WN0056  30       Retention Perio
     C                     Z-ADD*ZERO     WN0057  30       Retention Perio
     C                     Z-ADD*ZERO     WN0058  30       Retention Perio
     C                     Z-ADD*ZERO     WN0059  70       Next Load ID
     C                     MOVEL*BLANK    WN0060  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0061  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0062  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0063  30       Production Numb
     C                     MOVEL*BLANK    WN0064  1        Freight by Poun
     C                     MOVEL*BLANK    WN0065  1        Price Audit Act
     C                     MOVEL*BLANK    WN0066 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0067  1        EDI Status 1
     C                     MOVEL*BLANK    WN0068  1        EDI Status 2
     C                     MOVEL*BLANK    WN0069  1        EDI Status 3
     C                     MOVEL*BLANK    WN0070  1        Record Status
     C                     Z-ADD*ZERO     WN0071  60       Job Time
     C                     MOVEL*BLANK    WN0072 10        User Id
     C                     MOVEL*BLANK    WN0073 10        Job Name
     C                     Z-ADD*ZERO     WN0074  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADD0         WDAIC3           Company Number
      *
     C           KLCHSR    KLIST
     C                     KFLD           WDAIC3           Company Number
     C           KLCHSR    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YARDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Assumes Credit memo numbers always automatically assigned
     C                     MOVEL'Y'       YARDC            *Record Data Ch
     C                     Z-ADDWDC5NB    BEC4NB           USR Next Order
     C                     ADD  1         WDC5NB           Next Order Numb
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * CHG Next Invoice Nbr   CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0075  40       Current Account
     C                     Z-ADD*ZERO     WN0076  20       Current Account
     C                     Z-ADD*ZERO     WN0077  30       OM Week
     C                     Z-ADD*ZERO     WN0078  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0079  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0080  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0081  70       Next Charge Bac
     C                     Z-ADD*ZERO     WN0082  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0083  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0084  70       Next Customer #
     C                     Z-ADD*ZERO     WN0085  70       Next Inventory
     C                     Z-ADD*ZERO     WN0086  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0087  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0088  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0089  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0090  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0091  1        Auto Customers
     C                     MOVEL*BLANK    WN0092  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0093  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0094  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0095 112       Late Charge Min
     C                     MOVEL*BLANK    WN0096  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0097  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0098  1        Allocate Credit
     C                     MOVEL*BLANK    WN0099 30        Message Line 1
     C                     MOVEL*BLANK    WN0100 30        Message Line 2
     C                     MOVEL*BLANK    WN0101 30        Message Line 3
     C                     MOVEL*BLANK    WN0102 30        Message Line 4
     C                     MOVEL*BLANK    WN0103  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0104  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0105  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0106  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0107  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0108  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0109  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0110  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0111  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0112  30       Retention Perio
     C                     Z-ADD*ZERO     WN0113  30       Retention Perio
     C                     Z-ADD*ZERO     WN0114  30       Retention Perio
     C                     Z-ADD*ZERO     WN0115  30       Retention Perio
     C                     Z-ADD*ZERO     WN0116  30       Retention Perio
     C                     Z-ADD*ZERO     WN0117  70       Next Load ID
     C                     MOVEL*BLANK    WN0118  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0119  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0120  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0121  30       Production Numb
     C                     MOVEL*BLANK    WN0122  1        Freight by Poun
     C                     MOVEL*BLANK    WN0123  1        Price Audit Act
     C                     MOVEL*BLANK    WN0124 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0125  1        EDI Status 1
     C                     MOVEL*BLANK    WN0126  1        EDI Status 2
     C                     MOVEL*BLANK    WN0127  1        EDI Status 3
     C                     MOVEL*BLANK    WN0128  1        Record Status
     C                     Z-ADD*ZERO     WN0129  60       Job Time
     C                     MOVEL*BLANK    WN0130 10        User Id
     C                     MOVEL*BLANK    WN0131 10        Job Name
     C                     Z-ADD*ZERO     WN0132  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADD0         WDAIC3           Company Number
      *
     C           KLCHSS    KLIST
     C                     KFLD           WDAIC3           Company Number
     C           KLCHSS    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YBRDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Assumes Invoice numbers always automatically assigned
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
      * Val Invoice Exists    XF - A/R Header  * 
     C                     CALL 'PMQIXFR'              90  Val Invoice Exi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDC3NB    WQ0064  70       Invoice Number
     C           YL0005    PARM *BLANK    WQ0065  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMQIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * DO WHILE: LCL.Record Found USR is Record Found
     C           YL0005    DOWEQ'Y'                        *DOW
     C                     ADD  1         WDC3NB           Next Invoice Nu
      * Val Invoice Exists    XF - A/R Header  * 
     C                     CALL 'PMQIXFR'              90  Val Invoice Exi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDC3NB    WQ0066  70       Invoice Number
     C           YL0005    PARM *BLANK    WQ0067  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMQIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *ITR
     C                     Z-ADDWDC3NB    BECONB           USR Next Invoic
     C                     ADD  1         WDC3NB           Next Invoice Nu
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Order Header       CH - Order Header TRG  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0133  60       Job Time
     C                     MOVEL*BLANK    WN0134 10        User Id
     C                     MOVEL*BLANK    WN0135 10        Job Name
     C                     Z-ADD*ZERO     WN0136  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      *
     C           KLCHST    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHST    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     GOTO STEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * USER: Processing after Data read
      * 01/22/09 RMC  move here from "before Data update" spot
      * 06/23/00 PKD Added the update of the Export Status on the Load
      *              if the Export Status on the Order is changed to Y,
      * Change the Export Status.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Export Status NE DB1.Export Status
      *   |- c2    : PAR.Export Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U2ST    IFNE BEU2ST                     *IF
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Load ID is NE Blank
      *   |- c2    : DB1.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BERMNB    IFNE 0                          *IF
     C           BEU4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Chg Export Status     CH - Load Header  * 
     C                     EXSR SUCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       YL0006           Status Flag 1
      * Email Requested Delv Change msg is changed and Appt exists.
      * CASE:
      *  - (c1ORc2) AND c3
      *   |- c1    : PAR.Requested Delivery Date NE DB1.Requested Deliver
      *   |- c2    : PAR.Requested Delivery Time NE DB1.Requested Deliver
      *   |- c3    : DB1.OH Appt Confirmation Dt is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1EIDT    IFNE BEEIDT                     *IF
     C           #1AFTM    ORNE BEAFTM                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           BENODT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0006           Status Flag 1
     C                     END                             *FI
      * Move non-key fields to @BECPFJ
     C                     MOVEL#1JNCD    BEJNCD    P      Order Type - Sa
     C                     Z-ADD#1ANC7    BEANC7           A/R Customer Nu
     C                     Z-ADD#1BKC7    BEBKC7           Ship To Custome
     C                     MOVEL#1BRTX    BEBRTX    P      Ship To Name
     C                     MOVEL#1HMNA    BEHMNA    P      Ship To Address
     C                     MOVEL#1HONA    BEHONA    P      Ship To Address
     C                     MOVEL#1HPNA    BEHPNA    P      Ship To Address
     C                     MOVEL#1HNNA    BEHNNA    P      Ship To City
     C                     MOVEL#1DBCD    BEDBCD    P      Ship To State C
     C                     MOVEL#1CKTX    BECKTX    P      Ship To Zip/Pos
     C                     Z-ADD#1B0C7    BEB0C7           Bill to Custome
     C                     MOVEL#1AETX    BEAETX    P      Bill to Name
     C                     MOVEL#1B1NA    BEB1NA    P      Bill to Address
     C                     MOVEL#1B3NA    BEB3NA    P      Bill to Address
     C                     MOVEL#1B4NA    BEB4NA    P      Bill to Address
     C                     MOVEL#1B2NA    BEB2NA    P      Bill to City
     C                     MOVEL#1BHCD    BEBHCD    P      Bill to State C
     C                     MOVEL#1C8TX    BEC8TX    P      Bill to Zip/Pos
     C                     MOVEL#1BCNA    BEBCNA    P      Customer Purcha
     C                     Z-ADD#1A0DT    BEA0DT           Order Date
     C                     Z-ADD#1A5DT    BEA5DT           Requested Ship
     C                     Z-ADD#1GNDT    BEGNDT           Actual Shipped
     C                     Z-ADD#1ACDT    BEACDT           Cancel Date
     C                     MOVEL#1AQCD    BEAQCD    P      Terms Code
     C                     MOVEL#1B6NA    BEB6NA    P      Special Instruc
     C                     MOVEL#1BYNA    BEBYNA    P      Special Instruc
     C                     MOVEL#1BZNA    BEBZNA    P      Carrier Code
     C                     MOVEL#1GTST    BEGTST    P      Comment Print A
     C                     MOVEL#1GVST    BEGVST    P      Comment Print I
     C                     MOVEL#1GUST    BEGUST    P      Comment Print P
     C                     MOVEL#1QFST    BEQFST    P      Comment Print S
     C                     MOVEL#1CQCD    BECQCD    P      Reason Code
     C                     MOVEL#1GJST    BEGJST    P      Order in Use
     C                     MOVEL#1GWST    BEGWST    P      Header Status
     C                     MOVEL#1GXST    BEGXST    P      Header Status L
     C                     MOVEL*BLANK    BEGYST    P      Order Type Prin
     C                     Z-ADD#1AODT    BEAODT           Scheduled Ship
     C                     MOVEL#1AIVN    BEAIVN    P      User Original E
     C                     Z-ADD#1CXDT    BECXDT           Date of Origina
     C                     Z-ADD#1JZVA    BEJZVA           Order Value Tot
     C                     Z-ADD#1A1WG    BEA1WG           Order Weight To
     C                     MOVEL#1XIST    BEXIST    P      Credit Hold
     C                     MOVEL#1XJST    BEXJST    P      Production Hold
     C                     MOVEL#1XKST    BEXKST    P      New Customer Ho
     C                     Z-ADD#1EIDT    BEEIDT           Requested Deliv
     C                     Z-ADD#1AFTM    BEAFTM           Requested Deliv
     C                     MOVEL#1E8CD    BEE8CD    P      Accounts Receiv
     C                     MOVEL#1E9CD    BEE9CD    P      Accounts Receiv
     C                     Z-ADD#1RMNB    BERMNB           Load ID
     C                     Z-ADD#1TBNB    BETBNB           Absorbed Freigh
     C                     Z-ADD#1R1NB    BER1NB           Rated Freight
     C                     MOVEL#1PJST    BEPJST    P      LTL Flag
     C                     MOVEL#1U0ST    BEU0ST    P      Price Audit
     C                     MOVEL#1U1ST    BEU1ST    P      Price Status
     C                     MOVEL#1Q2CD    BEQ2CD    P      Shipping Method
     C                     MOVEL#1U2ST    BEU2ST    P      Export Status
     C                     MOVEL#1VEST    BEVEST    P      Palletize
     C                     MOVEL#1VFST    BEVFST    P      Shrink Wrap
     C                     MOVEL#1VGST    BEVGST    P      Slip Sheet
     C                     MOVEL#1RPCD    BERPCD    P      Age Code
     C                     Z-ADD#1RNNB    BERNNB           Reefer Temperat
     C                     MOVEL#1VDST    BEVDST    P      Load Type
     C                     Z-ADD#1ATIN    BEATIN           Attach to Invoi
     C                     MOVEL#1U4ST    BEU4ST    P      Load Plan Order
     C                     MOVEL#1U5ST    BEU5ST    P      Print Pick Slip
     C                     Z-ADD#1RSRN    BERSRN           Resell Referenc
     C                     MOVEL#1MHNA    BEMHNA    P      Special Comment
     C                     MOVEL#1MINA    BEMINA    P      Special Comment
     C                     MOVEL#1WBST    BEWBST    P      Affect Auto Acc
     C                     MOVEL#1R4CD    BER4CD    P      Sales Route Cod
     C                     MOVEL#1BFCD    BEBFCD    P      Manager Level C
     C                     MOVEL#1Q4CD    BEQ4CD    P      VP Level Code
     C                     Z-ADD#1T3NB    BET3NB           Attach to Order
     C                     MOVEL#1SICD    BESICD    P      Reason for Pric
     C                     Z-ADD#1CONB    BECONB           Invoice Number
     C                     MOVEL#1CEST    BECEST    P      Invoice Suffix
     C                     Z-ADD#1AWDT    BEAWDT           Invoice Date
     C                     MOVEL#1JPCD    BEJPCD    P      Event Code
     C                     MOVEL#1XUST    BEXUST    P      Trans Contol AS
     C                     MOVEL#1Z1ST    BEZ1ST    P      Modified Flag
     C                     Z-ADD#1VRVA    BEVRVA           A/R order Value
     C                     MOVEL#1OBST    BEOBST    P      Billing Activit
     C                     MOVEL#1BCST    BEBCST    P      Block Order Fla
     C                     MOVEL#1BDST    BEBDST    P      Order Certifica
     C                     Z-ADD#1B7VL    BEB7VL           Invoice Order V
     C                     MOVEL#1GASX    BEGASX    P      Process Sts for
     C                     MOVEL#1GBSX    BEGBSX    P      Order Conf Fax
     C                     MOVEL#1GCSX    BEGCSX    P      Manifest Fax St
     C                     MOVEL#1GDSX    BEGDSX    P      Invoice Fax Sts
     C                     MOVEL#1FNSX    BEFNSX    P      Transfer in Sto
     C                     MOVEL#1FOSX    BEFOSX    P      Email Cust On O
     C                     MOVEL#1FPSX    BEFPSX    P      Order Emailed
     C                     MOVEL#1FQSX    BEFQSX    P      Export Docs Go
     C                     MOVEL#1FRSX    BEFRSX    P      Shipping Temp C
     C                     MOVEL#1FSSX    BEFSSX    P      Broker Order St
     C                     MOVEL#1FTSX    BEFTSX    P      Air Freight Ord
     C                     MOVEL#1FUSX    BEFUSX    P      Order Requires
     C                     MOVEL#1FVSX    BEFVSX    P      OH Load Plan Re
     C                     MOVEL#1FWSX    BEFWSX    P      Export USDA App
     C                     MOVEL#1FXSX    BEFXSX    P      HPB Ship to War
     C                     MOVEL#1FYSX    BEFYSX    P      OH TF Exempt Co
     C                     Z-ADD#1NODT    BENODT           OH Appt Confirm
     C                     Z-ADD#1NPDT    BENPDT           JPN Invoice Iss
     C                     Z-ADD#1NQDT    BENQDT           Load Actual Shi
     C                     Z-ADD#1NRDT    BENRDT           Load BOL Comple
     C                     Z-ADD#1NSDT    BENSDT           Load Truck Depa
     C                     Z-ADD#1BPTM    BEBPTM           Maximum Gross W
     C                     Z-ADD#1BQTM    BEBQTM           Time of Origina
     C                     Z-ADD#1BRTM    BEBRTM           OH Appt Confirm
     C                     Z-ADD#1BSTM    BEBSTM           Load BOL Comple
     C                     Z-ADD#1BTTM    BEBTTM           Load Truck Depa
     C                     Z-ADD#1H0NX    BEH0NX           Act Frt Referen
     C                     Z-ADD#1H1NX    BEH1NX           Act Non-Ref Frt
     C                     Z-ADD#1H2NX    BEH2NX           OH Fuel Surchar
     C                     Z-ADD#1H3NX    BEH3NX           OH Total Non-Re
     C                     Z-ADD#1H4NX    BEH4NX           OH Total Ref Fr
     C                     Z-ADD#1C0C7    BEC0C7           Claim Number
     C                     MOVEL#1UVST    BEUVST    P      EDI Status 1
     C                     MOVEL#1UWST    BEUWST    P      EDI Status 2
     C                     MOVEL#1UXST    BEUXST    P      EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##PGM     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPBRC
     C                     Z-ADDBEAIC3    PBAIC3           Company Number
     C                     Z-ADDBEC4NB    PBC4NB           Order Number
     C                     MOVELBEJNCD    PBJNCD    P      Order Type - Sa
     C                     Z-ADDBEANC7    PBANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    PBBKC7           Ship To Custome
     C                     MOVELBEBRTX    PBBRTX    P      Ship To Name
     C                     MOVELBEHMNA    PBHMNA    P      Ship To Address
     C                     MOVELBEHONA    PBHONA    P      Ship To Address
     C                     MOVELBEHPNA    PBHPNA    P      Ship To Address
     C                     MOVELBEHNNA    PBHNNA    P      Ship To City
     C                     MOVELBEDBCD    PBDBCD    P      Ship To State C
     C                     MOVELBECKTX    PBCKTX    P      Ship To Zip/Pos
     C                     Z-ADDBEB0C7    PBB0C7           Bill to Custome
     C                     MOVELBEAETX    PBAETX    P      Bill to Name
     C                     MOVELBEB1NA    PBB1NA    P      Bill to Address
     C                     MOVELBEB3NA    PBB3NA    P      Bill to Address
     C                     MOVELBEB4NA    PBB4NA    P      Bill to Address
     C                     MOVELBEB2NA    PBB2NA    P      Bill to City
     C                     MOVELBEBHCD    PBBHCD    P      Bill to State C
     C                     MOVELBEC8TX    PBC8TX    P      Bill to Zip/Pos
     C                     MOVELBEBCNA    PBBCNA    P      Customer Purcha
     C                     Z-ADDBEA0DT    PBA0DT           Order Date
     C                     Z-ADDBEA5DT    PBA5DT           Requested Ship
     C                     Z-ADDBEGNDT    PBGNDT           Actual Shipped
     C                     Z-ADDBEACDT    PBACDT           Cancel Date
     C                     MOVELBEAQCD    PBAQCD    P      Terms Code
     C                     MOVELBEB6NA    PBB6NA    P      Special Instruc
     C                     MOVELBEBYNA    PBBYNA    P      Special Instruc
     C                     MOVELBEBZNA    PBBZNA    P      Carrier Code
     C                     MOVELBEGTST    PBGTST    P      Comment Print A
     C                     MOVELBEGVST    PBGVST    P      Comment Print I
     C                     MOVELBEGUST    PBGUST    P      Comment Print P
     C                     MOVELBEQFST    PBQFST    P      Comment Print S
     C                     MOVELBECQCD    PBCQCD    P      Reason Code
     C                     MOVELBEGJST    PBGJST    P      Order in Use
     C                     MOVELBEGWST    PBGWST    P      Header Status
     C                     MOVELBEGXST    PBGXST    P      Header Status L
     C                     MOVELBEGYST    PBGYST    P      Order Type Prin
     C                     Z-ADDBEAODT    PBAODT           Scheduled Ship
     C                     MOVELBEAIVN    PBAIVN    P      User Original E
     C                     Z-ADDBECXDT    PBCXDT           Date of Origina
     C                     Z-ADDBEJZVA    PBJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    PBA1WG           Order Weight To
     C                     MOVELBEXIST    PBXIST    P      Credit Hold
     C                     MOVELBEXJST    PBXJST    P      Production Hold
     C                     MOVELBEXKST    PBXKST    P      New Customer Ho
     C                     Z-ADDBEEIDT    PBEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    PBAFTM           Requested Deliv
     C                     MOVELBEE8CD    PBE8CD    P      Accounts Receiv
     C                     MOVELBEE9CD    PBE9CD    P      Accounts Receiv
     C                     Z-ADDBERMNB    PBRMNB           Load ID
     C                     Z-ADDBETBNB    PBTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    PBR1NB           Rated Freight
     C                     MOVELBEPJST    PBPJST    P      LTL Flag
     C                     MOVELBEU0ST    PBU0ST    P      Price Audit
     C                     MOVELBEU1ST    PBU1ST    P      Price Status
     C                     MOVELBEQ2CD    PBQ2CD    P      Shipping Method
     C                     MOVELBEU2ST    PBU2ST    P      Export Status
     C                     MOVELBEVEST    PBVEST    P      Palletize
     C                     MOVELBEVFST    PBVFST    P      Shrink Wrap
     C                     MOVELBEVGST    PBVGST    P      Slip Sheet
     C                     MOVELBERPCD    PBRPCD    P      Age Code
     C                     Z-ADDBERNNB    PBRNNB           Reefer Temperat
     C                     MOVELBEVDST    PBVDST    P      Load Type
     C                     Z-ADDBEATIN    PBATIN           Attach to Invoi
     C                     MOVELBEU4ST    PBU4ST    P      Load Plan Order
     C                     MOVELBEU5ST    PBU5ST    P      Print Pick Slip
     C                     Z-ADDBERSRN    PBRSRN           Resell Referenc
     C                     MOVELBEMHNA    PBMHNA    P      Special Comment
     C                     MOVELBEMINA    PBMINA    P      Special Comment
     C                     MOVELBEWBST    PBWBST    P      Affect Auto Acc
     C                     MOVELBER4CD    PBR4CD    P      Sales Route Cod
     C                     MOVELBEBFCD    PBBFCD    P      Manager Level C
     C                     MOVELBEQ4CD    PBQ4CD    P      VP Level Code
     C                     Z-ADDBET3NB    PBT3NB           Attach to Order
     C                     MOVELBESICD    PBSICD    P      Reason for Pric
     C                     Z-ADDBECONB    PBCONB           Invoice Number
     C                     MOVELBECEST    PBCEST    P      Invoice Suffix
     C                     Z-ADDBEAWDT    PBAWDT           Invoice Date
     C                     MOVELBEJPCD    PBJPCD    P      Event Code
     C                     MOVELBEXUST    PBXUST    P      Trans Contol AS
     C                     MOVELBEZ1ST    PBZ1ST    P      Modified Flag
     C                     Z-ADDBEVRVA    PBVRVA           A/R order Value
     C                     MOVELBEOBST    PBOBST    P      Billing Activit
     C                     MOVELBEBCST    PBBCST    P      Block Order Fla
     C                     MOVELBEBDST    PBBDST    P      Order Certifica
     C                     Z-ADDBEB7VL    PBB7VL           Invoice Order V
     C                     MOVELBEGASX    PBGASX    P      Process Sts for
     C                     MOVELBEGBSX    PBGBSX    P      Order Conf Fax
     C                     MOVELBEGCSX    PBGCSX    P      Manifest Fax St
     C                     MOVELBEGDSX    PBGDSX    P      Invoice Fax Sts
     C                     MOVELBEFNSX    PBFNSX    P      Transfer in Sto
     C                     MOVELBEFOSX    PBFOSX    P      Email Cust On O
     C                     MOVELBEFPSX    PBFPSX    P      Order Emailed
     C                     MOVELBEFQSX    PBFQSX    P      Export Docs Go
     C                     MOVELBEFRSX    PBFRSX    P      Shipping Temp C
     C                     MOVELBEFSSX    PBFSSX    P      Broker Order St
     C                     MOVELBEFTSX    PBFTSX    P      Air Freight Ord
     C                     MOVELBEFUSX    PBFUSX    P      Order Requires
     C                     MOVELBEFVSX    PBFVSX    P      OH Load Plan Re
     C                     MOVELBEFWSX    PBFWSX    P      Export USDA App
     C                     MOVELBEFXSX    PBFXSX    P      HPB Ship to War
     C                     MOVELBEFYSX    PBFYSX    P      OH TF Exempt Co
     C                     Z-ADDBENODT    PBNODT           OH Appt Confirm
     C                     Z-ADDBENPDT    PBNPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    PBNQDT           Load Actual Shi
     C                     Z-ADDBENRDT    PBNRDT           Load BOL Comple
     C                     Z-ADDBENSDT    PBNSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    PBBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    PBBQTM           Time of Origina
     C                     Z-ADDBEBRTM    PBBRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    PBBSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    PBBTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    PBH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    PBH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    PBH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    PBH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    PBH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    PBC0C7           Claim Number
     C                     MOVELBEUVST    PBUVST    P      EDI Status 1
     C                     MOVELBEUWST    PBUWST    P      EDI Status 2
     C                     MOVELBEUXST    PBUXST    P      EDI Status 3
     C                     Z-ADDBEAATM    PBAATM           Job Time
     C                     MOVELBEAYNA    PBAYNA    P      User Id
     C                     MOVELBEA0NA    PBA0NA    P      Job Name
     C                     Z-ADDBEAXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * -----------------------------------------------------------------
      * -----------------------------------------------------------------
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * Email Requested Delv Change msg is changed and Appt exists.
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0006    IFEQ 'Y'                        *IF
      * Exc Email Ord RqDtChg XF - Order Header TRG  * 
     C                     CALL 'PBEPXFR'              90  Exc Email Ord R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEAIC3    WQ0070  30       Company Number
     C                     PARM BEC4NB    WQ0071  70       Order Number
     C                     PARM BER4CD    WQ0072  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBEPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Export Status     CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0137  30       Company Number
     C                     Z-ADD*ZERO     WN0138  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0139  1        LTL Flag
     C                     MOVEL*BLANK    WN0140  1        Load Status
     C                     Z-ADD*ZERO     WN0141  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0142 15        Seal 1
     C                     MOVEL*BLANK    WN0143 15        Seal 2
     C                     MOVEL*BLANK    WN0144 15        Seal 3
     C                     MOVEL*BLANK    WN0145 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0146 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0147  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0148 112       Flat Amount
     C                     MOVEL*BLANK    WN0149  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0150  50       Total Stops
     C                     MOVEL*BLANK    WN0151 20        Trailer Id
     C                     MOVEL*BLANK    WN0152  3        Transloader Car
     C                     Z-ADD*ZERO     WN0153  40       BOL Time
     C                     MOVEL*BLANK    WN0154  3        Carrier Code
     C                     MOVEL*BLANK    WN0155  7        Truck Size
     C                     Z-ADD*ZERO     WN0156  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0157 112       Rated Freight
     C                     MOVEL*BLANK    WN0158  1        Ship Status
     C                     MOVEL*BLANK    WN0159  1        Load Type
     C                     Z-ADD*ZERO     WN0160  50       Number Pallets
     C                     Z-ADD*ZERO     WN0161  50       Number Pallets
     C                     Z-ADD*ZERO     WN0162 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0163  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0164  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0165  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0166 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0167 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0168  70       Actual Departur
     C                     Z-ADD*ZERO     WN0169  40       Departure Time
     C                     Z-ADD*ZERO     WN0170  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0171  52       Product Tempera
     C                     Z-ADD*ZERO     WN0172  50       Number Pallets
     C                     MOVEL*BLANK    WN0173 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0174  70       Total Load Mile
     C                     MOVEL*BLANK    WN0175 12        Recorder ID
     C                     MOVEL*BLANK    WN0176  2        Shipping Method
     C                     MOVEL*BLANK    WN0177  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0178  2        Ship To State C
     C                     Z-ADD*ZERO     WN0179  70       Gross Weight
     C                     MOVEL*BLANK    WN0180  3        Carrier Broker
     C                     Z-ADD*ZERO     WN0181  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0182  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0183  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0184  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0185  70       Spotted Date
     C                     Z-ADD*ZERO     WN0186  60       Spotted Time
     C                     Z-ADD*ZERO     WN0187  70       Load Finished D
     C                     Z-ADD*ZERO     WN0188  60       Load Finished T
     C                     Z-ADD*ZERO     WN0189  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0190  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0191  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0192  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0193  70       Truck Departure
     C                     Z-ADD*ZERO     WN0194  60       Truck Departure
     C                     Z-ADD*ZERO     WN0195  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0196  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0197  3        Shipping Line
     C                     MOVEL*BLANK    WN0198 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0199 30        Vessel Name
     C                     Z-ADD*ZERO     WN0200  50       Voyage
     C                     Z-ADD*ZERO     WN0201  70       Sail Date
     C                     MOVEL*BLANK    WN0202 12        Booking Number
     C                     MOVEL*BLANK    WN0203 20        Discharge Port
     C                     Z-ADD*ZERO     WN0204  70       Arrival Date
     C                     MOVEL*BLANK    WN0205 12        Container Numbe
     C                     Z-ADD*ZERO     WN0206  70       Date In
     C                     Z-ADD*ZERO     WN0207  60       Time In
     C                     Z-ADD*ZERO     WN0208  70       Date Out
     C                     Z-ADD*ZERO     WN0209  60       Time Out
     C                     Z-ADD*ZERO     WN0210 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0211  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0212  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0213  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0214  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0215  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0216  70       Requested Deliv
     C                     MOVEL*BLANK    WN0217  1        Load Acceptance
     C                     MOVEL*BLANK    WN0218  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0219  70       On Yard Date
     C                     Z-ADD*ZERO     WN0220  60       On Yard Time
     C                     Z-ADD*ZERO     WN0221  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0222  60       Deadline Depart
     C                     MOVEL*BLANK    WN0223  1        Load Held Over
     C                     MOVEL*BLANK    WN0224  1        Load Held Over
     C                     MOVEL*BLANK    WN0225 15        Load Held Over
     C                     MOVEL*BLANK    WN0226 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0227 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0228  70       Express Mail Da
     C                     MOVEL*BLANK    WN0229  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0230  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0231  70       Product Complet
     C                     Z-ADD*ZERO     WN0232  60       Product Complet
     C                     Z-ADD*ZERO     WN0233  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0234  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0235  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0236  1        Load Confirmed
     C                     MOVEL*BLANK    WN0237 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0238  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0239  60       Load Door 1
     C                     Z-ADD*ZERO     WN0240  70       Override Total
     C                     Z-ADD*ZERO     WN0241  60       Load Door 2
     C                     MOVEL*BLANK    WN0242  1        Partial Load
     C                     MOVEL*BLANK    WN0243  1        Load Confirmati
     C                     MOVEL*BLANK    WN0244  1        Export Load USD
     C                     MOVEL*BLANK    WN0245  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0246 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0247 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0248 15        Late Billing Em
     C                     MOVEL*BLANK    WN0249 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0250 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0251  1        Multi Company L
     C                     MOVEL*BLANK    WN0252  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0253  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0254  1        LH Power Only L
     C                     MOVEL*BLANK    WN0255  1        LH Unused Sts 4
     C                     MOVEL*BLANK    WN0256  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0257  2        Load U/M
     C                     MOVEL*BLANK    WN0258  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0259  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0260  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0261  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0262  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0263  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0264  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0265  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0266  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0267  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0268  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0269  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0270  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0271  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0272  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0273  60       LH Unused Time
     C                     MOVEL*BLANK    WN0274  1        EDI Status 1
     C                     MOVEL*BLANK    WN0275  1        EDI Status 2
     C                     MOVEL*BLANK    WN0276  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0277  60       Job Time
     C                     MOVEL*BLANK    WN0278 10        User Id
     C                     MOVEL*BLANK    WN0279 10        Job Name
     C                     Z-ADD*ZERO     WN0280  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDBERMNB    FJRMNB           Load ID
      *
     C           KLCHSU    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHSU    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YDRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL#1U2ST    FJU2ST    P      Export Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##JOB     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Company Name - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WEAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
      * Establish starting position
     C           KRSSV     CHAIN@ABREAK              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEADTX    #PAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV OP status          RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADD000       ASAIC3           Company Number
      * Establish starting position
     C           KRSSW     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELASCHST    P8CHST           Auto Order Numb
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Dflt Type for Co   RT - OP Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           C0AJVN           User Profile Na
     C                     KFLD           C0DNCD           Application Cod
     C                     KFLD           C0AIC3           Company Number
      * Setup key
     C                     MOVELWL0043    C0AJVN           User Profile Na
     C                     MOVELWL0044    C0DNCD           Application Cod
     C                     Z-ADDWL0045    C0AIC3           Company Number
      * Establish starting position
     C           KRSSX     CHAIN@C0REO4              90    *
      * Data record not found
     C   90                MOVEL'USR0527' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC0JNCD    WL0046           Order Type - Sa
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSY01           Application Cod
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Application Cod
      * Setup key
     C                     MOVELP1DNCD    WQSY01           Application Cod
      * Establish starting position
     C           KRSSY     SETLL@DNRESF                    *
     C           KRSSY     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
     C           KRSSY     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSZ01           Application Cod
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSZ01           Application Cod
      * Establish starting position
     C           KRSSZ     SETLL@DNRESF                    *
     C           KRSSZ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSZ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * If claim memo, then screen is output only.
      *================================================================
      * CASE: DTL.Claim Number is Not Zero
     C           #1C0C7    IFNE *ZERO                      *IF
     C                     MOVEL'Y'       P1WVST           Access Denied (
     C                     MOVEL*BLANK    P9R4ST           USR Update Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P1WVST           Access Denied (
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Not a claim memo, so screen is input capable.
      *================================================================
     C                     Z-ADD*ZERO     #1C0C7           Claim Number
     C                     MOVEL'N'       P1WVST           Access Denied (
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Validate that the ship to Customer entered has a shiptoflag
      *================================================================
      * 031808 slm Add validation that the ship to customer number
      * does have the flag set as a Y in the ship to flag for this
      * customer
      * RTV Ship To Flag       RT - Customer  * 
     C                     EXSR SMRVGN
      * CASE: WRK.Ship To Customer Flag is Allow Use as Ship To Cust
     C           WURJST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0016           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0016           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Ship to Customer Flag 'N''
     C                     MOVEL'USR2482' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** FP1309 03/26/2010 SLM  ORDER HEADER AGE CODE WITH BLANKS *ADD
      * ** FP1309 03/26/2010 SLM  ORDER HEADER AGE CODE WRK FIELD *HIDE
      * ** FT665  02/19/2008 RMC  output time of orig entry
      * ** E3387  09/09/2014 JJH  Display Shipping Method as Output and
      *           Optional.  Removed restriction for Shipping Method
      *           NE Blank.
      * ** E4057  06/11/2015 JJH  Default Affect Auto Accrual with Y=Yes
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0001  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0002  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0003  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBAB    KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    ABAIC3
     C           KLVBAB    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Order Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Order Type - Sa
     C           YPMTFD    OREQ '#1JNCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JNCD' defaulted for 'Order Type - Sales'.
     C                     CALL 'PDZ2SRR'              90  SEL OP Order Ty
     C                     PARM *BLANK    W0RTN   7
     C           #1JNCD    PARM #1JNCD    WQ0035  2        Order Type - Sa
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZ2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1JNCD    IFNE *BLANK                     Order Type - Sa
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JNCD    IFEQ *BLANK                     Order Type - Sa
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCEX    KLIST
     C                     KFLD           EXJNCD           Order Type - Sa
      * Setup key
     C                     MOVEL#1JNCD    EXJNCD
     C           KLVCEX    CHAIN@EXRETY              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Order Types            NF'
     C                     MOVEL'USR1063' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1063' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1BKC7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Ship To Custome
     C           YPMTFD    OREQ '#1BKC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BKC7' defaulted for 'Ship To Customer'.
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0036  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1BKC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BKC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWC    KLIST
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WCBKC7
     C           KLVDWC    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1DBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1DBCD' defaulted for 'Ship To State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1DBCD    PARM #1DBCD    WQ0037  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9941  *
     C                     END
      *
     C           #1DBCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DBCD    IFEQ *BLANK                     State Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1DBCD    ACBGCD
     C           KLVEAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1B0C7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Ship To Custome
     C           YPMTFD    OREQ '#1B0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1B0C7' defaulted for 'Bill to Customer'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1B0C7    PARM #1B0C7    WQ0038  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1B0C7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1B0C7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWC    KLIST
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1B0C7    WCBKC7
     C           KLVFWC    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BHCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1BHCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BHCD' defaulted for 'Bill to State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1BHCD    PARM #1BHCD    WQ0039  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9944  *
     C                     END
      *
     C           #1BHCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BHCD    IFEQ *BLANK                     State Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1BHCD    ACBGCD
     C           KLVGAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A0DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A0DT    AFBCDT
     C           KLVHAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to OP Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CQCD' defaulted for 'Reason Code'.
     C                     CALL 'OPTNSRR'              90  SEL Order Reaso
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0040  3        Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPTNSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVICX    KLIST
     C                     KFLD           CXCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    CXCQCD
     C           KLVICX    CHAIN@CXRET4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'OP Reason Codes        NF'
     C                     MOVEL'USR0504' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0504' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1EIDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1EIDT    AFBCDT
     C           KLVJAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Sales Route Cod
     C           YPMTFD    OREQ '#1R4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0041  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1R4CD    IFNE *BLANK                     Sales Route Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VKEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R4CD    IFEQ *BLANK                     Sales Route Cod
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKJE    KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD
     C           KLVKJE    CHAIN@JEREWS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1800' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Internal Reason
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1SICD    IFEQ *BLANK                     Internal Reason
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLJH    KLIST
     C                     KFLD           JHSGCD           Internal Reason
      * Setup key
     C                     MOVEL#1SICD    JHSGCD
     C           KLVLJH    CHAIN@JHREXO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Internal Reason        NF'
     C                     MOVEL'USR1835' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1835' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Event Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Event Code
     C           YPMTFD    OREQ '#1JPCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JPCD' defaulted for 'Event Code'.
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #1JPCD    PARM #1JPCD    WQ0042  2        Event Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1JPCD    IFNE *BLANK                     Event Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JPCD    IFEQ *BLANK                     Event Code
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMEZ    KLIST
     C                     KFLD           EZJPCD           Event Code
      * Setup key
     C                     MOVEL#1JPCD    EZJPCD
     C           KLVMEZ    CHAIN@EZREYT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Event Types            NF'
     C                     MOVEL'USR1076' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1076' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to A/R Claim
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1C0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1C0C7' defaulted for 'Claim Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0001' defaulted for 'Claim Company Number'.
      * Field '(LCL) YL0002' defaulted for 'Claim Ship to Customer'.
     C                     CALL 'PMCSSRR'              90  Sel A/R Claim
     C                     PARM *BLANK    W0RTN   7
     C           #1C0C7    PARM #1C0C7    WQ0043  70       Claim Number
     C           YL0001    PARM YL0001    WQ0044  30       Claim Company N
     C           YL0002    PARM YL0002    WQ0045  70       Claim Ship to C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1C0C7    IFNE *ZERO                      Claim Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1C0C7    IFEQ *ZERO                      Claim Number
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNMK    KLIST
     C                     KFLD           MKC0C7           Claim Number
      * Setup key
     C                     Z-ADD#1C0C7    MKC0C7
     C           KLVNMK    CHAIN@MKCPWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'A/R Claim              NF'
     C                     MOVEL'USR2729' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2729' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE023
     C           ZHCSCL    ANDLE025
     C           @#DFMT    ANDEQ'#RCDKEY'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDGE023
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDKEY'
     C           *IN78     ANDEQ'0'
     C                     MOVEL'#1C4NB'  YPMTFD           Order Number
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE031
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN77     ANDEQ'0'
     C                     MOVEL'#1BKC7'  YPMTFD           Ship To Custome
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE026
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#1DBCD'  YPMTFD           Ship To State C
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDGE064
     C           ZHCSCL    ANDLE065
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#1BHCD'  YPMTFD           Bill to State C
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#1WBST'  YPMTFD           Affect Auto Acc
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1WVST           Access Denied (
     C                     MOVEL*BLANK    P2JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     P2ANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     P2BKC7           Ship To Custome
     C                     MOVEL*BLANK    P2BRTX           Ship To Name
     C                     MOVEL*BLANK    P2HMNA           Ship To Address
     C                     MOVEL*BLANK    P2HONA           Ship To Address
     C                     MOVEL*BLANK    P2HPNA           Ship To Address
     C                     MOVEL*BLANK    P2HNNA           Ship To City
     C                     MOVEL*BLANK    P2DBCD           Ship To State C
     C                     MOVEL*BLANK    P2CKTX           Ship To Zip/Pos
     C                     Z-ADD*ZERO     P2ATIN           Attach to Invoi
     C                     Z-ADD*ZERO     P2T3NB           Attach to Order
     C                     MOVEL*BLANK    P4APTX           Company Name
     C                     MOVEL*BLANK    P5JMCD           @Order Type Cod
     C                     Z-ADD*ZERO     P6PONB           @Invoice Number
     C                     Z-ADD*ZERO     P7BFC7           @Order Number A
     C                     Z-ADD*ZERO     P8CYNB           Next Credit Mem
     C                     MOVEL*BLANK    P8CHST           Auto Order Numb
     C                     MOVEL*BLANK    P9R4ST           USR Update Flag
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field Bill to Customer
     C                     Z-ADD*ZERO     WUB0C7  70
      * Define work field Bill to Name
     C                     MOVEL*BLANK    WUAETX 30
      * Define work field Bill to Address Line 1
     C                     MOVEL*BLANK    WUB1NA 30
      * Define work field Bill to Address Line 2
     C                     MOVEL*BLANK    WUB3NA 30
      * Define work field Bill to Address Line 3
     C                     MOVEL*BLANK    WUB4NA 30
      * Define work field Bill to City
     C                     MOVEL*BLANK    WUB2NA 20
      * Define work field Bill to State Code
     C                     MOVEL*BLANK    WUBHCD  2
      * Define work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    WUC8TX 11
      * Define work field Attach to Order Number
     C                     Z-ADD*ZERO     WUT3NB  70
      * Define work field Attach to Invoice Number
     C                     Z-ADD*ZERO     WUATIN  70
      * Define work field Customer Purchase Order #
     C                     MOVEL*BLANK    WUBCNA 15
      * Define work field Resell Reference Number
     C                     Z-ADD*ZERO     WURSRN  70
      * Define work field Special Comment 1
     C                     MOVEL*BLANK    WUMHNA 30
      * Define work field Special Comment 2
     C                     MOVEL*BLANK    WUMINA 30
      * Define work field Affect Auto Accruals
     C                     MOVEL*BLANK    WUWBST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Record Selected       USR
     C                     MOVEL*BLANK    WUZZST  1
      * Define work field Invoice Suffix
     C                     MOVEL*BLANK    WUCEST  2
      * Define work field Billing Activity Type
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Order Type Description
     C                     MOVEL*BLANK    WUJVNA 30
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCP3NB           D & B Number
     C                     Z-ADD*ZERO     WCI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WCAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBTC7           Parent Customer
     C                     Z-ADD*ZERO     WCS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WCVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WCI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Ship To Customer Flag
     C                     MOVEL*BLANK    WURJST  1
      * Define work field Shipping Method Dft
     C                     MOVEL*BLANK    WUZ9ST  2
      * Define work field Load Type Dft
     C                     MOVEL*BLANK    WUCSST  1
      * Define work field LTL Flag Dft
     C                     MOVEL*BLANK    WUZ8ST  1
      * Define work field Shrink Wrap Dft
     C                     MOVEL*BLANK    WUSWST  1
      * Define work field Departure Time DFT
     C                     Z-ADD*ZERO     WUXXTM  40
      * Define work field Export Code Dft
     C                     MOVEL*BLANK    WUUECD  6
      * Define work field Allow Mult Whse to Order
     C                     MOVEL*BLANK    WUHSST  1
      * Define work field Allow Multi Export On Ord
     C                     MOVEL*BLANK    WUAMEO  1
      * Define work field Slip Sheet Dft
     C                     MOVEL*BLANK    WUSSDF  1
      * Define work field Palletize Dft
     C                     MOVEL*BLANK    WUPDFT  1
      * Clear all neither parameters
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     Z-ADD*ZERO     EYAATM           Job Time
     C                     Z-ADD*ZERO     EYAXDT           Job Date
      * Clear all neither parameters
      * CRT Order Hdr-auto nbr CR - Order Header TRG  * 
     C                     Z-ADD*ZERO     BEAATM           Job Time
     C                     Z-ADD*ZERO     BEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAXNB           Current Account
     C                     Z-ADD*ZERO     WDNGNB           Current Account
     C                     Z-ADD*ZERO     WDBZNB           OM Week
     C                     Z-ADD*ZERO     WDC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WDC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WDCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WDIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WDI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WDDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WDC7NB           Next Customer #
     C                     Z-ADD*ZERO     WDC2NB           Next Inventory
     C                     Z-ADD*ZERO     WDC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WDL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WDBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WDAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WDASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WDA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WDAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WDABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WDACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WDADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WDAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WDAENB           Retention Perio
     C                     Z-ADD*ZERO     WDALNB           Retention Perio
     C                     Z-ADD*ZERO     WDEVNB           Retention Perio
     C                     Z-ADD*ZERO     WDRPOP           Retention Perio
     C                     Z-ADD*ZERO     WDDWNB           Retention Perio
     C                     Z-ADD*ZERO     WDR3NB           Next Load ID
     C                     Z-ADD*ZERO     WDR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WDSCNB           Production Numb
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Company Organization
     C                     MOVEL*BLANK    WUYJSX  1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 30
     C                     MOVEL*BLANK    WL0007 30
     C                     MOVEL*BLANK    WL0008 30
     C                     MOVEL*BLANK    WL0009 20
     C                     MOVEL*BLANK    WL0010  2
     C                     MOVEL*BLANK    WL0011 11
     C                     Z-ADD*ZERO     WL0012  70
     C                     MOVEL*BLANK    WL0013 30
     C                     MOVEL*BLANK    WL0014 30
     C                     MOVEL*BLANK    WL0015 30
     C                     MOVEL*BLANK    WL0016 30
     C                     MOVEL*BLANK    WL0017 20
     C                     MOVEL*BLANK    WL0018  2
     C                     MOVEL*BLANK    WL0019 11
     C                     MOVEL*BLANK    WL0020 15
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  3
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024  3
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0025  30
     C                     Z-ADD*ZERO     WL0026  70
     C                     Z-ADD*ZERO     WL0027  70
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0028  2
     C                     MOVEL*BLANK    WL0029  1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0030  30
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033  2
     C                     Z-ADD*ZERO     WL0034  70
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0035  70
     C                     MOVEL*BLANK    WL0036 30
     C                     MOVEL*BLANK    WL0037 30
     C                     MOVEL*BLANK    WL0038 30
     C                     MOVEL*BLANK    WL0039 30
     C                     MOVEL*BLANK    WL0040 20
     C                     MOVEL*BLANK    WL0041  2
     C                     MOVEL*BLANK    WL0042 11
      * Define local variables for subroutine SXRVGN.
     C                     MOVEL*BLANK    WL0043 10
     C                     MOVEL*BLANK    WL0044  6
     C                     Z-ADD*ZERO     WL0045  30
     C                     MOVEL*BLANK    WL0046  2
      * Define local work field Claim Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Claim Ship to Customer
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Export Status Dft
     C                     MOVEL*BLANK    YL0004  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Company Organization
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field CDI Unused Sts 2
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field CDI Unused Sts 3
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field CDI Shipper
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field CDI Produced by co
     C                     MOVEL*BLANK    YN0006  2
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0006  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
      * Set program mode
      * CASE: PAR.Order Number is Equal to zeros
     C           P2C4NB    IFEQ *ZERO                      *IF
     C                     MOVEL'ADD'     W0PMD            *Program mode
      * RTV OP status          RT - Company Control  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
      * Set Application
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           P3OBST    IFEQ '2'                        *IF
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL'C/M'     P1DNCD           Application Cod
      * RTV Dflt Type for Co   RT - OP Entry Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0043    P      User Profile Na
     C                     MOVELP1DNCD    WL0044    P      Application Cod
     C                     Z-ADDP2AIC3    WL0045           Company Number
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    P2JNCD    P      Order Type - Sa
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Debit Memo
     C           P3OBST    IFEQ '3'                        *IF
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL'D/M'     P1DNCD           Application Cod
      * RTV Dflt Type for Co   RT - OP Entry Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0043    P      User Profile Na
     C                     MOVELP1DNCD    WL0044    P      Application Cod
     C                     Z-ADDP2AIC3    WL0045           Company Number
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    P2JNCD    P      Order Type - Sa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL'MEMO'    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P2JNCD           Order Type - Sa
     C                     END                             *FI
     C                     END                             *FI
      * Set Order type
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * Set default Order type
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           P3OBST    IFEQ '2'                        *IF
      * RTV Dflt Type for Co   RT - OP Entry Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0043    P      User Profile Na
     C                     MOVELP1DNCD    WL0044    P      Application Cod
     C                     Z-ADDP2AIC3    WL0045           Company Number
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    P2JNCD    P      Order Type - Sa
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Debit Memo
     C           P3OBST    IFEQ '3'                        *IF
      * RTV Dflt Type for Co   RT - OP Entry Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0043    P      User Profile Na
     C                     MOVELP1DNCD    WL0044    P      Application Cod
     C                     Z-ADDP2AIC3    WL0045           Company Number
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    P2JNCD    P      Order Type - Sa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P2JNCD           Order Type - Sa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SYRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
     C                     Z-ADDP2C4NB    #1C4NB           Order Number
      * ** FP1251 Determine if Seaboard, Dailys, HPB, etc.
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0073  30       Company Number
     C                     PARM *BLANK    WQ0074  1        Plant Company S
     C           WUYJSX    PARM *BLANK    WQ0075  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      *================================================================
     CSR         ZZEXIT    ENDSR
** KEY Screen: Field position and name array
01047010550130301822
** W0END
01049010840130901823
** W0NAM
V1AIC3    #PAPTX    V1C4NB    #PJMCD
** W1BEG
01049010560130501343015610159901817
02073021120230602345025620260102818
02857030740311303330033530335803371
03392033970387204128043840464004896
0515205161
** W1END
01051010850131101355015620161101824
02079021180233502374025910263002847
02886031030314203349033540336803390
03393034070388604134044130466904896
0515305173
** W1NAM
V1AIC3    #PAPTX    V1C4NB    #1JZVA    #1JNCD    #1A1WG    V1A0DT
V1BKC7    V1B0C7    #1BRTX    #1AETX    #1HMNA    #1B1NA    #1HONA
#1B3NA    #1HPNA    #1B4NA    #1HNNA    #1DBCD    #1CKTX    #1B2NA
#1BHCD    #1C8TX    #1BCNA    #1RSRN    #1MHNA    #1MINA    #1WBST
#1Q2CD    #DDGU1
** @CN
00001 USR0752
00002 Credit or Debit Memo
00003 Y2U0003
