// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKQRXFR
// ?Date: 14.08.2025 Time: 02:52:31
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modifications and Comments
DO;

//?H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Number
ENDDO;

EXECUTE FUNCTION(Tmp Init Farm Site    RT) TYPE(RTVOBJ) FILE(PKD6CPP)           AB1216892;
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Rtv Tto Ref/Farm      RT) TYPE(RTVOBJ) FILE(PKA1CPP)           AB1216893;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(PAR.TH_Group_Reference);
 PARAMETER(PAR.TH_HPS_Farm_Site);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // PAR.PCD Tattoo Group Ref = PAR.TH Tattoo Reference
 PAR.PCD_Tattoo_Group_Ref = PAR.TH_Group_Reference;

 CASE;

 // IF DB1.PCD Source Type is External
 IF DB1.PCD_Source_Type = 'E';

 // PAR.PCD Farm Site = DB1.PL Location Code
 PAR.PCD_Farm_Site = DB1.PL_Location_Code;

 // IF DB1.PCD Source Type is Internal
 IF DB1.PCD_Source_Type = 'I';

 // PAR.Farm Site 6.0 USR = PAR.TH HPS Farm Site
 PAR.Farm_Site_6_0_USR = PAR.TH_HPS_Farm_Site;

 // PAR.PCD Farm Site = CVTVAR(PAR.Farm Site 6.0 USR)
 PAR.PCD_Farm_Site = CVTVAR(PAR.Farm_Site_6_0_USR);

 ENDIF;

 EXECUTE FUNCTION(Tmp Init Farm Site    CH) TYPE(CHGOBJ) FILE(PKD6CPP)           AB1216908;
 PARAMETER(DB1.CC_Company_Number);
 PARAMETER(DB1.PCS_Code);
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(PAR.PCD_Farm_Site);
 PARAMETER(PAR.PCD_Tattoo_Group_Ref);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

}


