     H/TITLE CNV PK0199 NewFields  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version: 62050
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 03/30/00  Time  : 13:55:42
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company/Item              Retrieval index       NV
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMHSTPL0UF  E           K        DISK
      * UPD : Sales History             Update index
      *
     E                    YDOW        7  1               *Days of week
     I@FHSTD3
      * Sales History             Retrieval index
      * Renamed input format fields
     I              F4AIC3                          WAAIC3
     I              F4C4NB                          WAC4NB
     I              F4DPNB                          WADPNB
     I              F4UENB                          WAUENB
     I              F4MONA                          WAMONA
     I              F4RJCD                          WARJCD
     I              F4RKCD                          WARKCD
     I              F4GPTX                          WAGPTX
     I              F4ABTX                          WAABTX
     I              F4KXCD                          WAKXCD
     I              F4BOCD                          WABOCD
     I              F4BTC7                          WABTC7
     I              F4ANC7                          WAANC7
     I              F4AQTX                          WAAQTX
     I              F4BKC7                          WABKC7
     I              F4BRTX                          WABRTX
     I              F4HNNA                          WAHNNA
     I              F4DBCD                          WADBCD
     I              F4CKTX                          WACKTX
     I              F4BCNA                          WABCNA
     I              F4A0DT                          WAA0DT
     I              F4ACDT                          WAACDT
     I              F4R4CD                          WAR4CD
     I              F4R5CD                          WAR5CD
     I              F4BFCD                          WABFCD
     I              F4Q4CD                          WAQ4CD
     I              F4AQCD                          WAAQCD
     I              F4TBNB                          WATBNB
     I              F4BZNA                          WABZNA
     I              F4RLCD                          WARLCD
     I              F4JNCD                          WAJNCD
     I              F4Q2CD                          WAQ2CD
     I              F4U2ST                          WAU2ST
     I              F4ATIN                          WAATIN
     I              F4T3NB                          WAT3NB
     I              F4RSRN                          WARSRN
     I              F4ORIT                          WAORIT
     I              F4AJCD                          WAAJCD
     I              F4AVQT                          WAAVQT
     I              F4D0WG                          WAD0WG
     I              F4CCQT                          WACCQT
     I              F4AUWG                          WAAUWG
     I              F4AGCD                          WAAGCD
     I              F4AKPR                          WAAKPR
     I              F4AUPR                          WAAUPR
     I              F4CRCD                          WACRCD
     I              F4A5DT                          WAA5DT
     I              F4AWDT                          WAAWDT
     I              F4HDDT                          WAHDDT
     I              F4AGCS                          WAAGCS
     I              F4AQCS                          WAAQCS
     I              F4AVWG                          WAAVWG
     I              F4AYVA                          WAAYVA
     I              F4AMST                          WAAMST
     I              F4ANST                          WAANST
     I              F4VAST                          WAVAST
     I              F4L6NB                          WAL6NB
     I              F4UMCD                          WAUMCD
     I              F4HCDT                          WAHCDT
     I              F4ESNB                          WAESNB
     I              F4ETNB                          WAETNB
     I              F4BZNB                          WABZNB
     I              F4EXQT                          WAEXQT
     I              F4BYWG                          WABYWG
     I              F4S5NB                          WAS5NB
     I              F4MAVA                          WAMAVA
     I              F4KDVA                          WAKDVA
     I              F4USVA                          WAUSVA
     I              F4UTVA                          WAUTVA
     I              F4A4WG                          WAA4WG
     I              F4CKNB                          WACKNB
     I              F4BMST                          WABMST
     I              F4R8NB                          WAR8NB
     I              F4RMCD                          WARMCD
     I              F4BZPR                          WABZPR
     I              F4RDCD                          WARDCD
     I              F4Q7CD                          WAQ7CD
     I              F4EXDT                          WAEXDT
     I              F4LQCD                          WALQCD
     I              F4HICD                          WAHICD
     I              F4RBCD                          WARBCD
     I              F4RGNB                          WARGNB
     I              F4RHNB                          WARHNB
     I              F4RINB                          WARINB
     I              F4R1NB                          WAR1NB
     I              F4CONB                          WACONB
     I              F4CEST                          WACEST
     I              F4GNDT                          WAGNDT
     I              F4RMNB                          WARMNB
     I              F4AODT                          WAAODT
     I              F4LLCD                          WALLCD
     I              F4LMCD                          WALMCD
     I              F4SKNB                          WASKNB
     I              F4SLNB                          WASLNB
     I              F4SMNB                          WASMNB
     I              F4G7NA                          WAG7NA
     I              F4ONVA                          WAONVA
     I              F4N0CD                          WAN0CD
     I              F4B4NB                          WAB4NB
     I              F4B5NB                          WAB5NB
     I              F4N1CD                          WAN1CD
     I              F4GIDT                          WAGIDT
     I              F4Z1ST                          WAZ1ST
     I              F4ULVA                          WAULVA
     I              F4UNVA                          WAUNVA
     I              F4UOVA                          WAUOVA
     I              F4UPVA                          WAUPVA
     I              F4UQVA                          WAUQVA
     I              F4SDCD                          WASDCD
     I              F4QZCD                          WAQZCD
     I              F4XWST                          WAXWST
     I              F4T9CD                          WAT9CD
     I              F4UBCD                          WAUBCD
     I              F4CFC7                          WACFC7
     I              F4X1CD                          WAX1CD
     I              F4GASX                          WAGASX
     I              F4DUPR                          WADUPR
     I              F4B6VL                          WAB6VL
     I              F4IANX                          WAIANX
     I              F4IBNX                          WAIBNX
     I              F4RPCD                          WARPCD
     I              F4NYDT                          WANYDT
     I              F4BZTM                          WABZTM
     I              F4Z4NB                          WAZ4NB
     I              F4XACD                          WAXACD
     I              F4OANA                          WAOANA
     I              F4OKTX                          WAOKTX
     I              F4K4TX                          WAK4TX
     I              F4NBBO                          WANBBO
     I              F4OCFR                          WAOCFR
     I              F4C0C7                          WAC0C7
     I              F4A1AA                          WAA1AA
     I              F4VEST                          WAVEST
     I              F4A5PR                          WAA5PR
     I              F4CDPR                          WACDPR
     I              F4D0PR                          WAD0PR
     I              F4D0VL                          WAD0VL
     I              F4IRSX                          WAIRSX
     I              F4CEVL                          WACEVL
     I              F4ISSX                          WAISSX
     I              F4ITSX                          WAITSX
     I              F4IUSX                          WAIUSX
     I              F4OHDT                          WAOHDT
     I              F4D9PR                          WAD9PR
     I              F4CFVL                          WACFVL
     I              F4UVST                          WAUVST
     I              F4UWST                          WAUWST
     I              F4UXST                          WAUXST
     I              F4AATM                          WAAATM
     I              F4AYNA                          WAAYNA
     I              F4A0NA                          WAA0NA
     I              F4AXDT                          WAAXDT
      *
     I@BZREJU
      * Company/Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                          WCLQCD
     I              F0LRCD                          WCLRCD
     I              F0EQDT                          WCEQDT
     I              F0A5PR                          WCA5PR
     I              F0B8PR                          WCB8PR
     I              F0UVST                          WCUVST
     I              F0UWST                          WCUWST
     I              F0UXST                          WCUXST
     I              F0VSST                          WCVSST
     I              F0AATM                          WCAATM
     I              F0AYNA                          WCAYNA
     I              F0A0NA                          WCA0NA
     I              F0AXDT                          WCAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WDAIC3
     I              KMV8CD                          WDV8CD
     I              KMAUNA                          WDAUNA
     I              KMI5ST                          WDI5ST
     I              KMBXTX                          WDBXTX
     I              KMM8NB                          WDM8NB
     I              KMUVST                          WDUVST
     I              KMUWST                          WDUWST
     I              KMUXST                          WDUXST
     I              KMVSST                          WDVSST
     I              KMAATM                          WDAATM
     I              KMAYNA                          WDAYNA
     I              KMA0NA                          WDA0NA
     I              KMAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@FHSTD2
      * Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WFAIC3
     I              F4C4NB                          WFC4NB
     I              F4DPNB                          WFDPNB
     I              F4UENB                          WFUENB
     I              F4MONA                          WFMONA
     I              F4RJCD                          WFRJCD
     I              F4RKCD                          WFRKCD
     I              F4GPTX                          WFGPTX
     I              F4ABTX                          WFABTX
     I              F4KXCD                          WFKXCD
     I              F4BOCD                          WFBOCD
     I              F4BTC7                          WFBTC7
     I              F4ANC7                          WFANC7
     I              F4AQTX                          WFAQTX
     I              F4BKC7                          WFBKC7
     I              F4BRTX                          WFBRTX
     I              F4HNNA                          WFHNNA
     I              F4DBCD                          WFDBCD
     I              F4CKTX                          WFCKTX
     I              F4BCNA                          WFBCNA
     I              F4A0DT                          WFA0DT
     I              F4ACDT                          WFACDT
     I              F4R4CD                          WFR4CD
     I              F4R5CD                          WFR5CD
     I              F4BFCD                          WFBFCD
     I              F4Q4CD                          WFQ4CD
     I              F4AQCD                          WFAQCD
     I              F4TBNB                          WFTBNB
     I              F4BZNA                          WFBZNA
     I              F4RLCD                          WFRLCD
     I              F4JNCD                          WFJNCD
     I              F4Q2CD                          WFQ2CD
     I              F4U2ST                          WFU2ST
     I              F4ATIN                          WFATIN
     I              F4T3NB                          WFT3NB
     I              F4RSRN                          WFRSRN
     I              F4ORIT                          WFORIT
     I              F4AJCD                          WFAJCD
     I              F4AVQT                          WFAVQT
     I              F4D0WG                          WFD0WG
     I              F4CCQT                          WFCCQT
     I              F4AUWG                          WFAUWG
     I              F4AGCD                          WFAGCD
     I              F4AKPR                          WFAKPR
     I              F4AUPR                          WFAUPR
     I              F4CRCD                          WFCRCD
     I              F4A5DT                          WFA5DT
     I              F4AWDT                          WFAWDT
     I              F4HDDT                          WFHDDT
     I              F4AGCS                          WFAGCS
     I              F4AQCS                          WFAQCS
     I              F4AVWG                          WFAVWG
     I              F4AYVA                          WFAYVA
     I              F4AMST                          WFAMST
     I              F4ANST                          WFANST
     I              F4VAST                          WFVAST
     I              F4L6NB                          WFL6NB
     I              F4UMCD                          WFUMCD
     I              F4HCDT                          WFHCDT
     I              F4ESNB                          WFESNB
     I              F4ETNB                          WFETNB
     I              F4BZNB                          WFBZNB
     I              F4EXQT                          WFEXQT
     I              F4BYWG                          WFBYWG
     I              F4S5NB                          WFS5NB
     I              F4MAVA                          WFMAVA
     I              F4KDVA                          WFKDVA
     I              F4USVA                          WFUSVA
     I              F4UTVA                          WFUTVA
     I              F4A4WG                          WFA4WG
     I              F4CKNB                          WFCKNB
     I              F4BMST                          WFBMST
     I              F4R8NB                          WFR8NB
     I              F4RMCD                          WFRMCD
     I              F4BZPR                          WFBZPR
     I              F4RDCD                          WFRDCD
     I              F4Q7CD                          WFQ7CD
     I              F4EXDT                          WFEXDT
     I              F4LQCD                          WFLQCD
     I              F4HICD                          WFHICD
     I              F4RBCD                          WFRBCD
     I              F4RGNB                          WFRGNB
     I              F4RHNB                          WFRHNB
     I              F4RINB                          WFRINB
     I              F4R1NB                          WFR1NB
     I              F4CONB                          WFCONB
     I              F4CEST                          WFCEST
     I              F4GNDT                          WFGNDT
     I              F4RMNB                          WFRMNB
     I              F4AODT                          WFAODT
     I              F4LLCD                          WFLLCD
     I              F4LMCD                          WFLMCD
     I              F4SKNB                          WFSKNB
     I              F4SLNB                          WFSLNB
     I              F4SMNB                          WFSMNB
     I              F4G7NA                          WFG7NA
     I              F4ONVA                          WFONVA
     I              F4N0CD                          WFN0CD
     I              F4B4NB                          WFB4NB
     I              F4B5NB                          WFB5NB
     I              F4N1CD                          WFN1CD
     I              F4GIDT                          WFGIDT
     I              F4Z1ST                          WFZ1ST
     I              F4ULVA                          WFULVA
     I              F4UNVA                          WFUNVA
     I              F4UOVA                          WFUOVA
     I              F4UPVA                          WFUPVA
     I              F4UQVA                          WFUQVA
     I              F4SDCD                          WFSDCD
     I              F4QZCD                          WFQZCD
     I              F4XWST                          WFXWST
     I              F4T9CD                          WFT9CD
     I              F4UBCD                          WFUBCD
     I              F4CFC7                          WFCFC7
     I              F4X1CD                          WFX1CD
     I              F4GASX                          WFGASX
     I              F4DUPR                          WFDUPR
     I              F4B6VL                          WFB6VL
     I              F4IANX                          WFIANX
     I              F4IBNX                          WFIBNX
     I              F4RPCD                          WFRPCD
     I              F4NYDT                          WFNYDT
     I              F4BZTM                          WFBZTM
     I              F4Z4NB                          WFZ4NB
     I              F4XACD                          WFXACD
     I              F4OANA                          WFOANA
     I              F4OKTX                          WFOKTX
     I              F4K4TX                          WFK4TX
     I              F4NBBO                          WFNBBO
     I              F4OCFR                          WFOCFR
     I              F4C0C7                          WFC0C7
     I              F4A1AA                          WFA1AA
     I              F4VEST                          WFVEST
     I              F4A5PR                          WFA5PR
     I              F4CDPR                          WFCDPR
     I              F4D0PR                          WFD0PR
     I              F4D0VL                          WFD0VL
     I              F4IRSX                          WFIRSX
     I              F4CEVL                          WFCEVL
     I              F4ISSX                          WFISSX
     I              F4ITSX                          WFITSX
     I              F4IUSX                          WFIUSX
     I              F4OHDT                          WFOHDT
     I              F4D9PR                          WFD9PR
     I              F4CFVL                          WFCFVL
     I              F4UVST                          WFUVST
     I              F4UWST                          WFUWST
     I              F4UXST                          WFUXST
     I              F4AATM                          WFAATM
     I              F4AYNA                          WFAYNA
     I              F4A0NA                          WFA0NA
     I              F4AXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQOMHS1    E DSOMHSTPL0
      * UPD : Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WFAIC3
     I              F4C4NB                          WFC4NB
     I              F4DPNB                          WFDPNB
     I              F4UENB                          WFUENB
     I              F4MONA                          WFMONA
     I              F4RJCD                          WFRJCD
     I              F4RKCD                          WFRKCD
     I              F4GPTX                          WFGPTX
     I              F4ABTX                          WFABTX
     I              F4KXCD                          WFKXCD
     I              F4BOCD                          WFBOCD
     I              F4BTC7                          WFBTC7
     I              F4ANC7                          WFANC7
     I              F4AQTX                          WFAQTX
     I              F4BKC7                          WFBKC7
     I              F4BRTX                          WFBRTX
     I              F4HNNA                          WFHNNA
     I              F4DBCD                          WFDBCD
     I              F4CKTX                          WFCKTX
     I              F4BCNA                          WFBCNA
     I              F4A0DT                          WFA0DT
     I              F4ACDT                          WFACDT
     I              F4R4CD                          WFR4CD
     I              F4R5CD                          WFR5CD
     I              F4BFCD                          WFBFCD
     I              F4Q4CD                          WFQ4CD
     I              F4AQCD                          WFAQCD
     I              F4TBNB                          WFTBNB
     I              F4BZNA                          WFBZNA
     I              F4RLCD                          WFRLCD
     I              F4JNCD                          WFJNCD
     I              F4Q2CD                          WFQ2CD
     I              F4U2ST                          WFU2ST
     I              F4ATIN                          WFATIN
     I              F4T3NB                          WFT3NB
     I              F4RSRN                          WFRSRN
     I              F4ORIT                          WFORIT
     I              F4AJCD                          WFAJCD
     I              F4AVQT                          WFAVQT
     I              F4D0WG                          WFD0WG
     I              F4CCQT                          WFCCQT
     I              F4AUWG                          WFAUWG
     I              F4AGCD                          WFAGCD
     I              F4AKPR                          WFAKPR
     I              F4AUPR                          WFAUPR
     I              F4CRCD                          WFCRCD
     I              F4A5DT                          WFA5DT
     I              F4AWDT                          WFAWDT
     I              F4HDDT                          WFHDDT
     I              F4AGCS                          WFAGCS
     I              F4AQCS                          WFAQCS
     I              F4AVWG                          WFAVWG
     I              F4AYVA                          WFAYVA
     I              F4AMST                          WFAMST
     I              F4ANST                          WFANST
     I              F4VAST                          WFVAST
     I              F4L6NB                          WFL6NB
     I              F4UMCD                          WFUMCD
     I              F4HCDT                          WFHCDT
     I              F4ESNB                          WFESNB
     I              F4ETNB                          WFETNB
     I              F4BZNB                          WFBZNB
     I              F4EXQT                          WFEXQT
     I              F4BYWG                          WFBYWG
     I              F4S5NB                          WFS5NB
     I              F4MAVA                          WFMAVA
     I              F4KDVA                          WFKDVA
     I              F4USVA                          WFUSVA
     I              F4UTVA                          WFUTVA
     I              F4A4WG                          WFA4WG
     I              F4CKNB                          WFCKNB
     I              F4BMST                          WFBMST
     I              F4R8NB                          WFR8NB
     I              F4RMCD                          WFRMCD
     I              F4BZPR                          WFBZPR
     I              F4RDCD                          WFRDCD
     I              F4Q7CD                          WFQ7CD
     I              F4EXDT                          WFEXDT
     I              F4LQCD                          WFLQCD
     I              F4HICD                          WFHICD
     I              F4RBCD                          WFRBCD
     I              F4RGNB                          WFRGNB
     I              F4RHNB                          WFRHNB
     I              F4RINB                          WFRINB
     I              F4R1NB                          WFR1NB
     I              F4CONB                          WFCONB
     I              F4CEST                          WFCEST
     I              F4GNDT                          WFGNDT
     I              F4RMNB                          WFRMNB
     I              F4AODT                          WFAODT
     I              F4LLCD                          WFLLCD
     I              F4LMCD                          WFLMCD
     I              F4SKNB                          WFSKNB
     I              F4SLNB                          WFSLNB
     I              F4SMNB                          WFSMNB
     I              F4G7NA                          WFG7NA
     I              F4ONVA                          WFONVA
     I              F4N0CD                          WFN0CD
     I              F4B4NB                          WFB4NB
     I              F4B5NB                          WFB5NB
     I              F4N1CD                          WFN1CD
     I              F4GIDT                          WFGIDT
     I              F4Z1ST                          WFZ1ST
     I              F4ULVA                          WFULVA
     I              F4UNVA                          WFUNVA
     I              F4UOVA                          WFUOVA
     I              F4UPVA                          WFUPVA
     I              F4UQVA                          WFUQVA
     I              F4SDCD                          WFSDCD
     I              F4QZCD                          WFQZCD
     I              F4XWST                          WFXWST
     I              F4T9CD                          WFT9CD
     I              F4UBCD                          WFUBCD
     I              F4CFC7                          WFCFC7
     I              F4X1CD                          WFX1CD
     I              F4GASX                          WFGASX
     I              F4DUPR                          WFDUPR
     I              F4B6VL                          WFB6VL
     I              F4IANX                          WFIANX
     I              F4IBNX                          WFIBNX
     I              F4RPCD                          WFRPCD
     I              F4NYDT                          WFNYDT
     I              F4BZTM                          WFBZTM
     I              F4Z4NB                          WFZ4NB
     I              F4XACD                          WFXACD
     I              F4OANA                          WFOANA
     I              F4OKTX                          WFOKTX
     I              F4K4TX                          WFK4TX
     I              F4NBBO                          WFNBBO
     I              F4OCFR                          WFOCFR
     I              F4C0C7                          WFC0C7
     I              F4A1AA                          WFA1AA
     I              F4VEST                          WFVEST
     I              F4A5PR                          WFA5PR
     I              F4CDPR                          WFCDPR
     I              F4D0PR                          WFD0PR
     I              F4D0VL                          WFD0VL
     I              F4IRSX                          WFIRSX
     I              F4CEVL                          WFCEVL
     I              F4ISSX                          WFISSX
     I              F4ITSX                          WFITSX
     I              F4IUSX                          WFIUSX
     I              F4OHDT                          WFOHDT
     I              F4D9PR                          WFD9PR
     I              F4CFVL                          WFCFVL
     I              F4UVST                          WFUVST
     I              F4UWST                          WFUWST
     I              F4UXST                          WFUXST
     I              F4AATM                          WFAATM
     I              F4AYNA                          WFAYNA
     I              F4A0NA                          WFA0NA
     I              F4AXDT                          WFAXDT
      *
     IYARDCS      DS                            792
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CNV PK0199 NewFields  XF
      * CNV PK0199 NewFields  RT - Sales History  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * CNV PK0199 NewFields  RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@FHSTD3                    *
     C                     READ @FHSTD3                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Item Info&Std Ovr  RT - Company/Item  * 
     C                     EXSR SBRVGN
      * RTV Print Realization  RT - Company/Item  * 
     C                     EXSR SCRVGN
      * Retrieve needed fields from Item & IC Item Balance files
      * RTV Copy to History    XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDRFXFR'              90  RTV Copy to His
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0001  30       Company Number
     C                     PARM WAS5NB    WQ0002  70       Item Code
     C           WUN0CD    PARM *BLANK    WQ0003  3        Item Type Code
     C           YL0003    PARM *BLANK    WQ0004  7        Commodity Price
     C           WUQZCD    PARM *BLANK    WQ0005  2        Base/Conv/Loss
     C           WUXWST    PARM *BLANK    WQ0006  1        Variety/Rendere
     C           WUSDCD    PARM *BLANK    WQ0007  1        PD Code UnUsed
     C           WULLCD    PARM *BLANK    WQ0008  3        Packaging Code
     C           WULMCD    PARM *BLANK    WQ0009  3        Grade Code
     C           WUSKNB    PARM *ZERO     WQ0010  20       Agrimetrics gro
     C           WUSLNB    PARM *ZERO     WQ0011  10       Agrimetrics pac
     C           WUSMNB    PARM *ZERO     WQ0012  20       Agrimetrics gra
     C           WUN1CD    PARM *BLANK    WQ0013  3        PM ABC Class
     C           WUB4NB    PARM *ZERO     WQ0014  30       PM R/M Type Cod
     C           WUB5NB    PARM *ZERO     WQ0015  50       PM Line Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Compute Market Price    PK0199  (calcs copied from sls rlztn repo
     C                     EXSR UASUBR                     Compute Market
      * Compute Market Price for Default Cmdty Mkt Code    PK0199
     C                     EXSR UBSUBR                     Compute Market
      * RTV Palletize          RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * CASE: DB1.Actual Shipped Date is In the year 2000
     C           WAGNDT    IFGE 1000101                    *IF
     C                     MOVEL'N'       WUIRSX           Sales Expense P
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUIRSX           Sales Expense P
     C                     END                             *FI
      * CHG PK0199 New fields - Sales History  * 
     C                     EXSR SGCHRC
     C                     READ @FHSTD3                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Item Info&Std Ovr  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAS5NB    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUADCD           U/M - Primary
     C                     MOVEL*BLANK    WUAICD           U/M - Pricing
     C                     Z-ADD*ZERO     YL0001           Unit Weight
     C                     MOVEL*BLANK    WUAVST           Catch Weight St
     C                     Z-ADD*ZERO     WUBMPR           Standard Overag
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBADCD    WUADCD           U/M - Primary
     C                     MOVELWBAICD    WUAICD           U/M - Pricing
     C                     Z-ADDWBAIWG    YL0001           Unit Weight
     C                     MOVELWBAVST    WUAVST           Catch Weight St
     C                     Z-ADDWBBMPR    WUBMPR           Standard Overag
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Print Realization  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAS5NB    WBHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Default Commod
     C                     MOVEL*BLANK    WUX6ST           Print on Realiz
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBLNCD    YL0002           Default Commod
     C                     MOVELWBX6ST    WUX6ST           Print on Realiz
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCLQCD    WQSD01           Commodity Marke
     C           *LIKE     DEFN WCLRCD    WQSD02           Commodity Price
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Commodity Marke
     C                     KFLD           WQSD02           Commodity Price
     C                     KFLD           WCEQDT           Market Price Da
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Commodity Marke
     C                     KFLD           WQSD02           Commodity Price
      * Setup key
     C                     MOVELWL0001    WQSD01           Commodity Marke
     C                     MOVELWL0002    WQSD02           Commodity Price
     C                     Z-ADDWL0003    WCEQDT           Market Price Da
      * Establish starting position
     C           KPSSD     SETLL@F0CPEP                    *
     C           KRSSD     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Commodity Marke
     C                     Z-ADD*ZERO     WL0005           USR Date Priced
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWCA5PR    WL0004           Commodity Marke
     C                     Z-ADDWCEQDT    WL0005           USR Date Priced
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDV8CD           Company Value C
      * Setup key
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     MOVE *BLANK    WDV8CD           Company Value C
     C                     MOVEL'DFTMKT'  WDV8CD           Company Value C
      * Establish starting position
     C           KRSSE     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDBXTX    YL0005           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Palletize          RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WEAIC3           Company Number
     C                     Z-ADDWAC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSSF     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Palletize
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEVEST    YL0007           Palletize
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * CHG PK0199 New fields - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 20        A/R City
     C                     MOVEL*BLANK    WN0002  2        A/R State
     C                     MOVEL*BLANK    WN0003  6        A/R County Code
     C                     MOVEL*BLANK    WN0004 11        A/R Zip/Postal
     C                     MOVEL*BLANK    WN0005 25        Alpha Search
     C                     MOVEL*BLANK    WN0006  6        Country Code
     C                     MOVEL*BLANK    WN0007  2        Type Code
     C                     Z-ADD*ZERO     WN0008  70       Parent Customer
     C                     Z-ADD*ZERO     WN0009  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0010 30        A/R Customer Na
     C                     Z-ADD*ZERO     WN0011  70       Ship To Custome
     C                     MOVEL*BLANK    WN0012 30        Ship To Name
     C                     MOVEL*BLANK    WN0013 20        Ship To City
     C                     MOVEL*BLANK    WN0014  2        Ship To State C
     C                     MOVEL*BLANK    WN0015 11        Ship To Zip/Pos
     C                     MOVEL*BLANK    WN0016 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0017  70       Order Date
     C                     Z-ADD*ZERO     WN0018  70       Cancel Date
     C                     MOVEL*BLANK    WN0019  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0020  3        Original Salesp
     C                     MOVEL*BLANK    WN0021  2        Manager Level C
     C                     MOVEL*BLANK    WN0022  3        VP Level Code
     C                     MOVEL*BLANK    WN0023  2        Terms Code
     C                     Z-ADD*ZERO     WN0024  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0025  3        Carrier Code
     C                     MOVEL*BLANK    WN0026  3        Order Header Re
     C                     MOVEL*BLANK    WN0027  2        Order Type - Sa
     C                     MOVEL*BLANK    WN0028  2        Shipping Method
     C                     MOVEL*BLANK    WN0029  1        Export Status
     C                     Z-ADD*ZERO     WN0030  70       Attach to Invoi
     C                     Z-ADD*ZERO     WN0031  70       Attach to Order
     C                     Z-ADD*ZERO     WN0032  70       Resell Referenc
     C                     Z-ADD*ZERO     WN0033  70       Original Item
     C                     MOVEL*BLANK    WN0034  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0035 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0036 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0037 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0038 112       Weight Schedule
     C                     MOVEL*BLANK    WN0039  2        U/M - Ordered
     C                     Z-ADD*ZERO     WN0040 114       Unit Price
     C                     Z-ADD*ZERO     WN0041 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0042  2        U/M - Base Pric
     C                     Z-ADD*ZERO     WN0043  70       Requested Ship
     C                     Z-ADD*ZERO     WN0044  70       Invoice Date
     C                     Z-ADD*ZERO     WN0045  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Cost Order
     C                     Z-ADD*ZERO     WN0048 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0049 112       Extended Amount
     C                     MOVEL*BLANK    WN0050  1        Affect Inventor
     C                     MOVEL*BLANK    WN0051  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0052  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0053  70       Contract Number
     C                     MOVEL*BLANK    WN0054  6        Export Country
     C                     Z-ADD*ZERO     WN0055  70       Unused Date
     C                     Z-ADD*ZERO     WN0056  40       Accounting Year
     C                     Z-ADD*ZERO     WN0057  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0058  30       OM Week
     C                     Z-ADD*ZERO     WN0059 112       Quantity Billed
     C                     Z-ADD*ZERO     WN0060 112       Weight Billed
     C                     Z-ADD*ZERO     WN0061  70       Shipped Item Co
     C                     Z-ADD*ZERO     WN0062 112       Billing Detail
     C                     Z-ADD*ZERO     WN0063 112       Billing Detail
     C                     Z-ADD*ZERO     WN0064 112       FOB Gross Amoun
     C                     Z-ADD*ZERO     WN0065 112       Standard Overag
     C                     Z-ADD*ZERO     WN0066 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0067  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0068  1        G/L Update Stat
     C                     Z-ADD*ZERO     WN0069  30       Original Order
     C                     MOVEL*BLANK    WN0070  3        Order Detail Re
     C                     Z-ADD*ZERO     WN0071 114       Price Overage O
     C                     MOVEL*BLANK    WN0072  3        Date Method Cod
     C                     MOVEL*BLANK    WN0073  3        Price Method Co
     C                     Z-ADD*ZERO     WN0074  70       Market Pricing
     C                     MOVEL*BLANK    WN0075  3        Commodity Marke
     C                     MOVEL*BLANK    WN0076  2        Quality Level
     C                     MOVEL*BLANK    WN0077  2        Item Level
     C                     Z-ADD*ZERO     WN0078  30       Item Structure
     C                     Z-ADD*ZERO     WN0079  30       Item Structure
     C                     Z-ADD*ZERO     WN0080  30       Item Structure
     C                     Z-ADD*ZERO     WN0081 112       Rated Freight
     C                     Z-ADD*ZERO     WN0082  70       Invoice Number
     C                     MOVEL*BLANK    WN0083  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0084  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0085  70       Load ID
     C                     Z-ADD*ZERO     WN0086  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0087  3        Packaging Code
     C                     MOVEL*BLANK    WN0088  3        Grade Code
     C                     Z-ADD*ZERO     WN0089  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0090  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0091  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0092 30        Order Desc. Lin
     C                     Z-ADD*ZERO     WN0093 112       Actual Freight
     C                     MOVEL*BLANK    WN0094  3        Item Type Code
     C                     Z-ADD*ZERO     WN0095  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WN0096  50       PM Line Number
     C                     MOVEL*BLANK    WN0097  3        PM ABC Class
     C                     Z-ADD*ZERO     WN0098  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0099  1        Modified Flag
     C                     Z-ADD*ZERO     WN0100 112       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0101 112       Automatic Accru
     C                     Z-ADD*ZERO     WN0102 112       Non Automatic A
     C                     Z-ADD*ZERO     WN0103 112       Financials Amou
     C                     Z-ADD*ZERO     WN0104 112       Financials Amou
     C                     MOVEL*BLANK    WN0105  1        PD Code UnUsed
     C                     MOVEL*BLANK    WN0106  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0107  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0108  3        Customer Group
     C                     MOVEL*BLANK    WN0109  3        Customer Group
     C                     Z-ADD*ZERO     WN0110  70       Order Group Cod
     C                     MOVEL*BLANK    WN0111  4        Shipping Zone C
     C                     MOVEL*BLANK    WN0112  1        Invoice Price T
     C                     Z-ADD*ZERO     WN0113 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0114 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0115  30       Req Shipping Te
     C                     Z-ADD*ZERO     WN0116  30       Actual Shipping
     C                     MOVEL*BLANK    WN0117  1        Age Code
     C                     Z-ADD*ZERO     WN0118  70       Req Delivery Da
     C                     Z-ADD*ZERO     WN0119  60       Req Delivery Ti
     C                     Z-ADD*ZERO     WN0120  70       MPC Number
     C                     MOVEL*BLANK    WN0121  3        Shipping Line
     C                     MOVEL*BLANK    WN0122 20        Sail Port Delv
     C                     MOVEL*BLANK    WN0123 25        Sail Port City
     C                     MOVEL*BLANK    WN0124 30        Vessel Name
     C                     MOVEL*BLANK    WN0125 12        Booking Number
     C                     Z-ADD*ZERO     WN0126 112       Ocean Freight
     C                     Z-ADD*ZERO     WN0127  70       Claim Number
     C                     Z-ADD*ZERO     WN0128  30       Ham Group Numbe
     C                     Z-ADD*ZERO     WN0129 112       Sales Expense T
     C                     MOVEL*BLANK    WN0130  1        HST Unused Sts
     C                     MOVEL*BLANK    WN0131  2        HST Unused Sts
     C                     Z-ADD*ZERO     WN0132  70       HST Unused Date
     C                     Z-ADD*ZERO     WN0133 114       HST Unused Pric
     C                     Z-ADD*ZERO     WN0134 112       HST Unused Valu
     C                     MOVEL*BLANK    WN0135  1        EDI Status 1
     C                     MOVEL*BLANK    WN0136  1        EDI Status 2
     C                     MOVEL*BLANK    WN0137  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0138  60       Job Time
     C                     MOVEL*BLANK    WN0139 10        User Id
     C                     MOVEL*BLANK    WN0140 10        Job Name
     C                     Z-ADD*ZERO     WN0141  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FHSTD2
     C                     Z-ADDWAAIC3    WFAIC3           Company Number
     C                     Z-ADDWAC4NB    WFC4NB           Order Number
     C                     Z-ADDWADPNB    WFDPNB           Order Sequence
     C                     Z-ADDWAUENB    WFUENB           Order Secondary
      *
     C           KLCHSG    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C           KLCHSG    CHAIN@FHSTD2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHSTPL0'MDACP
     C                     MOVEL'@FHSTD2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHS1    YARDCS
      * Move non-key fields to @FHSTD2
     C                     MOVELYL0007    WFVEST           Palletize
     C                     Z-ADDYL0004    WFA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WFCDPR           Market Value
     C                     Z-ADDYL0006    WFD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WFD0VL           Default Market
     C                     MOVELWUIRSX    WFIRSX           Sales Expense P
     C                     MOVELWAISSX    WFISSX           Data Mart Proce
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FHSTD2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHSTPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Compute Market Price    PK0199  (calcs copied from sls rlztn rep
      *================================================================
      * subtract 1 from actual shipped date for starting point
      * WRK.Actual Shipped Date = DB1.Actual Shipped Date + CON.-1 *DAYS
     C           WAGNDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WUGNDT
     C                     ELSE
     C           XDINDT    SUB  1000000   WUGNDT
     C                     END
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0002    WL0001    P      Commodity Marke
     C                     MOVELYL0003    WL0002    P      Commodity Price
     C                     Z-ADDWUGNDT    WL0003           Market Price Da
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    YL0004           Commodity Marke
     C                     Z-ADDWL0005    WUE7DT           USR Date Priced
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Compute Market Price for Default Cmdty Mkt Code    PK0199
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SERVGN
      * subtract 1 from actual shipped date for starting point
      * WRK.Actual Shipped Date = DB1.Actual Shipped Date + CON.-1 *DAYS
     C           WAGNDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WUGNDT
     C                     ELSE
     C           XDINDT    SUB  1000000   WUGNDT
     C                     END
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0001    P      Commodity Marke
     C                     MOVELYL0003    WL0002    P      Commodity Price
     C                     Z-ADDWUGNDT    WL0003           Market Price Da
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    YL0006           Commodity Marke
     C                     Z-ADDWL0005    WUE7DT           USR Date Priced
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAORIT           Original Item
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Order
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAHCDT           Unused Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WABYWG           Weight Billed
     C                     Z-ADD*ZERO     WAS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WAUTVA           Standard Overag
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WACKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WAR8NB           Original Order
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WAONVA           Actual Freight
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WAUNVA           Automatic Accru
     C                     Z-ADD*ZERO     WAUOVA           Non Automatic A
     C                     Z-ADD*ZERO     WAUPVA           Financials Amou
     C                     Z-ADD*ZERO     WAUQVA           Financials Amou
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WAIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WANYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WABZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAOCFR           Ocean Freight
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WAA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WACDPR           Market Value
     C                     Z-ADD*ZERO     WAD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WAD0VL           Default Market
     C                     Z-ADD*ZERO     WACEVL           Sales Expense T
     C                     Z-ADD*ZERO     WAOHDT           HST Unused Date
     C                     Z-ADD*ZERO     WAD9PR           HST Unused Pric
     C                     Z-ADD*ZERO     WACFVL           HST Unused Valu
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field U/M - Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Catch Weight Status
     C                     MOVEL*BLANK    WUAVST  1
      * Define work field Standard Overage/Underage
     C                     Z-ADD*ZERO     WUBMPR 114
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Iten Category N
     C                     Z-ADD*ZERO     WBSFNB           UnUsed NBR 5.2
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           Packages (Trays
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WBILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WBCHNB           PM Crew Size
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WBCMNB           PM BOM Spec Dat
     C                     Z-ADD*ZERO     WBCNNB           PM Seaboard Spe
     C                     Z-ADD*ZERO     WBCRNB           PM Seaboard Rep
     C                     Z-ADD*ZERO     WBCSNB           PM Raw Yield
     C                     Z-ADD*ZERO     WBCVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           CI Unused Wgt 1
     C                     Z-ADD*ZERO     WBF6WG           CI Unused Wgt 2
     C                     Z-ADD*ZERO     WBF7WG           CI Unused Wgt 3
     C                     Z-ADD*ZERO     WBBLNB           CI Unused Nbr 1
     C                     Z-ADD*ZERO     WBBNNB           CI Unused Nbr 2
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Print on Realization Rpt
     C                     MOVEL*BLANK    WUX6ST  2
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field PD Code UnUsed
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Packaging Code
     C                     MOVEL*BLANK    WULLCD  3
      * Define work field Grade Code
     C                     MOVEL*BLANK    WULMCD  3
      * Define work field Agrimetrics group
     C                     Z-ADD*ZERO     WUSKNB  20
      * Define work field Agrimetrics pack
     C                     Z-ADD*ZERO     WUSLNB  10
      * Define work field Agrimetrics grade
     C                     Z-ADD*ZERO     WUSMNB  20
      * Define work field PM ABC Class
     C                     MOVEL*BLANK    WUN1CD  3
      * Define work field PM R/M Type Code
     C                     Z-ADD*ZERO     WUB4NB  30
      * Define work field PM Line Number
     C                     Z-ADD*ZERO     WUB5NB  50
      * Define work field Actual Shipped Date
     C                     Z-ADD*ZERO     WUGNDT  70
      * Define work field USR Date Priced
     C                     Z-ADD*ZERO     WUE7DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCEQDT           Market Price Da
     C                     Z-ADD*ZERO     WCA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WCB8PR           Projected Marke
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDM8NB           System Value Nu
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A/R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Unused Date
     C                     Z-ADD*ZERO     WENPDT           OH Unused Date
     C                     Z-ADD*ZERO     WENQDT           OH Unused Date
     C                     Z-ADD*ZERO     WENRDT           OH Unused Date
     C                     Z-ADD*ZERO     WENSDT           OH Unused Date
     C                     Z-ADD*ZERO     WEBPTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBQTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WEH0NX           OH Unused Nbr 1
     C                     Z-ADD*ZERO     WEH1NX           OH Unused Nbr 2
     C                     Z-ADD*ZERO     WEH2NX           OH Unused Nbr 3
     C                     Z-ADD*ZERO     WEH3NX           OH Unused Nbr 4
     C                     Z-ADD*ZERO     WEH4NX           OH Unused Nbr 5
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Sales Expense Process Sts
     C                     MOVEL*BLANK    WUIRSX  1
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  7
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004 114
     C                     Z-ADD*ZERO     WL0005  70
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field Commodity Market Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0003  7
      * Define local work field Commodity Market Price
     C                     Z-ADD*ZERO     YL0004 114
      * Define local work field Commodity Market Code USR
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field Default Cmdty Mkt Price
     C                     Z-ADD*ZERO     YL0006 114
      * Define local work field Palletize
     C                     MOVEL*BLANK    YL0007  1
      *================================================================
     CSR         ZZEXIT    ENDSR
