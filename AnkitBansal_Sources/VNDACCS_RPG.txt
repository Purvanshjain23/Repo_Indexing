     H/TITLE Sel Vendor Name       XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISRCENT
     H* Date          : 10/21/20  Time  : 09:45:55
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              8  0
     D  WP0002         S             40
     D  WP0003         S             40
     D  WP0004         S             40
     D  WP0005         S             40
     D  WP0006         S              3
     D  WP0007         S             12
     D  WP0008         S              6
     D  WP0009         S             20
     D  WP0010         S              6
     D  WP0011         S             20
     D  WP0012         S              6
     D  WP0013         S             20
     D  WP0014         S              1
     D  WP0015         S             16
     D  WP0016         S              3
     D  WP0017         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              3  0
     D  YL0002         S              1
     D  YL0003         S              1
     D  YL0004         S              1
     D  YL0005         S              1
     D  YL0006         S              1
     D  YL0007         S              1
     D  WQ0001         S              3  0
     D  WQ0002         S              1
     D  WQ0003         S              1
     D  WQ0004         S              1
     D  WQ0005         S              1
     D  WQ0006         S              1
     D  WQ0007         S              1
     D  W0CLPG         S             10
     D  WXPGM          S             10
     D  WQ0008         S              7
     D  WQ0009         S              8  0
     D  WQ0010         S             40
     D  WQ0011         S             40
     D  WQ0012         S             40
     D  WQ0013         S             40
     D  WQ0014         S              3
     D  WQ0015         S             12
     D  WQ0016         S              6
     D  WQ0017         S             20
     D  WQ0018         S              6
     D  WQ0019         S             20
     D  WQ0020         S              6
     D  WQ0021         S             20
     D  WQ0022         S              1
     D  WQ0023         S             16
     D  WQ0024         S              3
     D  WQ0025         S              1
     D  WQ0026         S              7
     D  WQ0027         S              8  0
     D  WQ0028         S             40
     D  WQ0029         S             40
     D  WQ0030         S             40
     D  WQ0031         S             40
     D  WQ0032         S              3
     D  WQ0033         S             12
     D  WQ0034         S              6
     D  WQ0035         S             20
     D  WQ0036         S              6
     D  WQ0037         S             20
     D  WQ0038         S              6
     D  WQ0039         S             20
     D  WQ0040         S              1
     D  WQ0041         S             16
     D  WQ0042         S              3
     D  WQ0043         S              1
     D  WQ0044         S              7
     D  WQ0045         S              8  0
     D  WQ0046         S             40
     D  WQ0047         S             40
     D  WQ0048         S             40
     D  WQ0049         S             40
     D  WQ0050         S              3
     D  WQ0051         S             12
     D  WQ0052         S              6
     D  WQ0053         S             20
     D  WQ0054         S              6
     D  WQ0055         S             20
     D  WQ0056         S              6
     D  WQ0057         S             20
     D  WQ0058         S              1
     D  WQ0059         S             16
     D  WQ0060         S              3
     D  WQ0061         S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: *Arrays
      * O :  Address Number
     D  P1AN8                  1      8  0
      * O :  Address Line 1
     D  P1ADD1                 9     48
      * O :  Address Line 2
     D  P1ADD2                49     88
      * O :  Address Line 3
     D  P1ADD3                89    128
      * O :  Address Line 4
     D  P1ADD4               129    168
      * O :  State
     D  P1ADDS               169    171
      * O :  Postal Code
     D  P1ADDZ               172    183
      * O :  Phone Prefix
     D  P1AR1                184    189
      * O :  Phone Number
     D  P1PH1                190    209
      * O :  Phone - Area 1
     D  P1M4TX               210    215
      * O :  Phone - Number 1
     D  P1M5TX               216    235
      * O :  Phone - Area 2
     D  P1M6TX               236    241
      * O :  Phone - Number 2
     D  P1M7TX               242    261
      * O :  Ten 99
     D  P1KDST               262    262
      * O :  Tax ID 16A
     D  P1M8TX               263    278
      * O :  Country
     D  P1CTR                279    281
      * O :  TPST
     D  P1KEST               282    282
     D                 DS
     D  ZAMSDA                 1    132
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1AN8         PARM      P1AN8         WP0001                         Address Number
     C     P1ADD1        PARM      P1ADD1        WP0002                         Address Line 1
     C     P1ADD2        PARM      P1ADD2        WP0003                         Address Line 2
     C     P1ADD3        PARM      P1ADD3        WP0004                         Address Line 3
     C     P1ADD4        PARM      P1ADD4        WP0005                         Address Line 4
     C     P1ADDS        PARM      P1ADDS        WP0006                         State
     C     P1ADDZ        PARM      P1ADDZ        WP0007                         Postal Code
     C     P1AR1         PARM      P1AR1         WP0008                         Phone Prefix
     C     P1PH1         PARM      P1PH1         WP0009                         Phone Number
     C     P1M4TX        PARM      P1M4TX        WP0010                         Phone - Area 1
     C     P1M5TX        PARM      P1M5TX        WP0011                         Phone - Number
     C     P1M6TX        PARM      P1M6TX        WP0012                         Phone - Area 2
     C     P1M7TX        PARM      P1M7TX        WP0013                         Phone - Number
     C     P1KDST        PARM      P1KDST        WP0014                         Ten 99
     C     P1M8TX        PARM      P1M8TX        WP0015                         Tax ID 16A
     C     P1CTR         PARM      P1CTR         WP0016                         Country
     C     P1KEST        PARM      P1KEST        WP0017                         TPST
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Sel Vendor Name       XF
      * Modification history
     C                   EXSR      UASUBR                                       Modification hi
      * Since the Address Book file does not contain a company number,
      * hard code company 350 at this time.
     C                   Z-ADD     350           YL0001                         OMS Company Num
      * Retrieve Company Values for E1 Live, JW Live, and M3 Live
      * Rtv Live In E1/JW/M3  XF - STR Cross Model Calls  * 
     C                   CALL      'E1JUXFR'                            90      Rtv Live In E1/
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0001        WQ0001                         OMS Company Num
     C     YL0002        PARM      *BLANK        WQ0002                         E1 Live
     C     YL0003        PARM      *BLANK        WQ0003                         JW Live
     C     YL0004        PARM      *BLANK        WQ0004                         M3 Live
     C     YL0005        PARM      *BLANK        WQ0005                         E1 Parallel
     C     YL0006        PARM      *BLANK        WQ0006                         JW Parallel
     C     YL0007        PARM      *BLANK        WQ0007                         M3 Parallel
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'E1JUXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Logic based upon Live In flag (Y/N/P)
      * CASE: (E1LIVE = Y or P) OR JWLIVE = P
      *  - c1 OR c2
      *   |- c1    : LCL.E1 Live is Yes or Parallel
      *   |- c2    : LCL.JW Live is Parallel
      *   '-
      * Sel Vendor Name    E1 UP - Address Book       F0101  * 
     C                   IF        YL0002 = 'P' OR
     C                             YL0002 = 'Y' OR
     C                             YL0003 = 'P'
     C                   MOVEL     'VNDACCSE'    WXPGM
     C                   MOVE      '1 '          WXPGM
     C                   CALL      WXPGM                                90      Sel Vendor Name
     C     W0RTN         PARM      *BLANK        WQ0008                         *Return code
     C     P1AN8         PARM      *ZERO         WQ0009                         Address Number
     C     P1ADD1        PARM      *BLANK        WQ0010                         Address Line 1
     C     P1ADD2        PARM      *BLANK        WQ0011                         Address Line 2
     C     P1ADD3        PARM      *BLANK        WQ0012                         Address Line 3
     C     P1ADD4        PARM      *BLANK        WQ0013                         Address Line 4
     C     P1ADDS        PARM      *BLANK        WQ0014                         State
     C     P1ADDZ        PARM      *BLANK        WQ0015                         Postal Code
     C     P1AR1         PARM      *BLANK        WQ0016                         Phone Prefix
     C     P1PH1         PARM      *BLANK        WQ0017                         Phone Number
     C     P1M4TX        PARM      *BLANK        WQ0018                         Phone - Area 1
     C     P1M5TX        PARM      *BLANK        WQ0019                         Phone - Number
     C     P1M6TX        PARM      *BLANK        WQ0020                         Phone - Area 2
     C     P1M7TX        PARM      *BLANK        WQ0021                         Phone - Number
     C     P1KDST        PARM      *BLANK        WQ0022                         Ten 99
     C     P1M8TX        PARM      *BLANK        WQ0023                         Tax ID 16A
     C     P1CTR         PARM      *BLANK        WQ0024                         Country
     C     P1KEST        PARM      *BLANK        WQ0025                         TPST
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   MOVEL     'VNDACCSE'    W0CLPG
     C                   MOVE      '1 '          W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: LCL.JW Live is Yes
      * Sel Vendor Name World UP - Address Book       F0101  * 
     C                   IF        YL0003 = 'Y'
     C                   CALL      'VNDACCSW'                           90      Sel Vendor Name
     C     W0RTN         PARM      *BLANK        WQ0026                         *Return code
     C     P1AN8         PARM      *ZERO         WQ0027                         Address Number
     C     P1ADD1        PARM      *BLANK        WQ0028                         Address Line 1
     C     P1ADD2        PARM      *BLANK        WQ0029                         Address Line 2
     C     P1ADD3        PARM      *BLANK        WQ0030                         Address Line 3
     C     P1ADD4        PARM      *BLANK        WQ0031                         Address Line 4
     C     P1ADDS        PARM      *BLANK        WQ0032                         State
     C     P1ADDZ        PARM      *BLANK        WQ0033                         Postal Code
     C     P1AR1         PARM      *BLANK        WQ0034                         Phone Prefix
     C     P1PH1         PARM      *BLANK        WQ0035                         Phone Number
     C     P1M4TX        PARM      *BLANK        WQ0036                         Phone - Area 1
     C     P1M5TX        PARM      *BLANK        WQ0037                         Phone - Number
     C     P1M6TX        PARM      *BLANK        WQ0038                         Phone - Area 2
     C     P1M7TX        PARM      *BLANK        WQ0039                         Phone - Number
     C     P1KDST        PARM      *BLANK        WQ0040                         Ten 99
     C     P1M8TX        PARM      *BLANK        WQ0041                         Tax ID 16A
     C     P1CTR         PARM      *BLANK        WQ0042                         Country
     C     P1KEST        PARM      *BLANK        WQ0043                         TPST
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'VNDACCSW'    W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
      * Sel Vendor Name World UP - Address Book       F0101  * 
     C                   CALL      'VNDACCSW'                           90      Sel Vendor Name
     C     W0RTN         PARM      *BLANK        WQ0044                         *Return code
     C     P1AN8         PARM      *ZERO         WQ0045                         Address Number
     C     P1ADD1        PARM      *BLANK        WQ0046                         Address Line 1
     C     P1ADD2        PARM      *BLANK        WQ0047                         Address Line 2
     C     P1ADD3        PARM      *BLANK        WQ0048                         Address Line 3
     C     P1ADD4        PARM      *BLANK        WQ0049                         Address Line 4
     C     P1ADDS        PARM      *BLANK        WQ0050                         State
     C     P1ADDZ        PARM      *BLANK        WQ0051                         Postal Code
     C     P1AR1         PARM      *BLANK        WQ0052                         Phone Prefix
     C     P1PH1         PARM      *BLANK        WQ0053                         Phone Number
     C     P1M4TX        PARM      *BLANK        WQ0054                         Phone - Area 1
     C     P1M5TX        PARM      *BLANK        WQ0055                         Phone - Number
     C     P1M6TX        PARM      *BLANK        WQ0056                         Phone - Area 2
     C     P1M7TX        PARM      *BLANK        WQ0057                         Phone - Number
     C     P1KDST        PARM      *BLANK        WQ0058                         Ten 99
     C     P1M8TX        PARM      *BLANK        WQ0059                         Tax ID 16A
     C     P1CTR         PARM      *BLANK        WQ0060                         Country
     C     P1KEST        PARM      *BLANK        WQ0061                         TPST
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'VNDACCSW'    W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Pass back the return code to the calling program
     C                   MOVEL     W0RTN         P0RTN                          *Return code
     C                   EXSR      ZYEXPG
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  3/12/2020 JBB P16169 - JDE World to JDE E1
      *      Project SDN465     Function created.  Use Company Values to
      *                         determine whether to call JDE World or JD
      *                         Enterprise 1 programs.
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
     C                   MOVEL     'N'           W0PMT
      * Define local work field OMS Company Number
     C                   Z-ADD     *ZERO         YL0001
      * Define local work field E1 Live
     C                   EVAL      YL0002 = ' '
      * Define local work field JW Live
     C                   EVAL      YL0003 = ' '
      * Define local work field M3 Live
     C                   EVAL      YL0004 = ' '
      * Define local work field E1 Parallel
     C                   EVAL      YL0005 = ' '
      * Define local work field JW Parallel
     C                   EVAL      YL0006 = ' '
      * Define local work field M3 Parallel
     C                   EVAL      YL0007 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
