// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBJOXFR
// ?Date: 14.08.2025 Time: 03:48:15
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Build Order Detail Build Sched workfile in qtemp for unbooked orders rpts
EXECUTE FUNCTION(RTV Crt ODBS Unbooked RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC2072223;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.From_Date_USR);
PARAMETER(PAR.Sales_Route_Code);
PARAMETER(PAR.OH_Load_Plan_Ready);
PARAMETER(PAR.From_Date_USR);
PARAMETER(PAR.USR_Select_Omit_Flag);
PARAMETER(PAR.Status_Y_or_N);
{
 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 CASE;

 // IF PAR.Company Number is Equal to zero
 IF ( PAR.Company_Number = *ZERO;

 // OR DB1.Company Number EQ PAR.Company Number
 OR DB1.Company_Number = PAR.Company_Number );

 // AND PAR.Sales Route Code is not entered
 AND ( PAR.Sales_Route_Code = *BLANK;

 // OR PAR.Sales Route Code EQ DB1.Sales Route Code
 OR PAR.Sales_Route_Code = DB1.Sales_Route_Code );

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?SEL not tied orders only (load id = 0 )
 CASE;

 // IF PAR.Status - Y or N is yes
 IF PAR.Status_Y_or_N = 'Y';

 CASE;

 // IF DB1.Load ID is GT Zero
 IF DB1.Load_ID > *ZERO;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 //?SEL/OMT FRT ORD STS
 CASE;

 // IF PAR.USR Select/Omit Flag is Select
 IF PAR.USR_Select_Omit_Flag = 'S';

 CASE;

 // IF PAR.TPM Freight Order Sts NE DB1.TPM Freight Order Sts
 IF PAR.OH_Load_Plan_Ready <> DB1.OH_Load_Plan_Ready;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?SEL/OMT FRT ORD STS
 // IF PAR.USR Select/Omit Flag is Omit
 IF PAR.USR_Select_Omit_Flag = 'O';

 CASE;

 // IF PAR.TPM Freight Order Sts EQ DB1.TPM Freight Order Sts
 IF PAR.OH_Load_Plan_Ready = DB1.OH_Load_Plan_Ready;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 EXECUTE FUNCTION(RTV Territory using St RT) TYPE(RTVOBJ) FILE(PDLWREP)          AC1494008;
 PARAMETER(DB1.Ship_To_State_Code);
 PARAMETER(LCL.Territory_Code);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  QUIT;

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 //?Partial picked Y/N ?
 CASE;

 // IF DB1.Event Code is 03 Picked
 IF DB1.Event_Code = '03';

 // LCL.ODBS Partial Pick Sts = CND.Yes
 LCL.ODBS_Partial_Pick_Sts = 1;

 //?Partial picked Y/N ?
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.ODBS Partial Pick Sts = CND.No
 LCL.ODBS_Partial_Pick_Sts = 2;

 ENDIF;

 // Call program CLC Deadln Depart Dt  XF.
 CALL PROGRAM(CLC Deadln Depart Dt  XF) ('POSCXFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Ship_To_City);
 PARAMETER(DB1.Ship_To_State_Code);
 PARAMETER(DB1.Requested_Delivery_Date);
 PARAMETER(DB1.Requested_Delivery_Time);
 PARAMETER(LCL.Deadline_Depart_Date_LH);
 PARAMETER(LCL.Deadline_Depart_Time_LH);

 //?Force req deliv date if it cant be calculated
 CASE;

 // IF LCL.Deadline Depart Date LH is not entered
 IF LCL.Deadline_Depart_Date_LH = *ZERO;

 // LCL.Deadline Depart Date LH = DB1.Requested Delivery Date
 LCL.Deadline_Depart_Date_LH = DB1.Requested_Delivery_Date;

 // LCL.Deadline Depart Time LH = DB1.Requested Delivery Time * CON.100 *
 LCL.Deadline_Depart_Time_LH = DB1.Requested_Delivery_Time * 100;

 ENDIF;

 EXECUTE FUNCTION(UPS Crt ODBS Unbooked RT) TYPE(RTVOBJ) FILE(OPBGWKP)           AC2072224;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Type_Sales);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(DB1.Ship_To_State_Code);
 PARAMETER(DB1.Carrier_Code);
 PARAMETER(DB1.Header_Status);
 PARAMETER(DB1.Date_of_Original_Entry);
 PARAMETER(DB1.Credit_Hold);
 PARAMETER(DB1.Production_Hold);
 PARAMETER(DB1.Requested_Delivery_Date);
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Shipping_Method);
 PARAMETER(DB1.Export_Status);
 PARAMETER(DB1.Event_Code);
 PARAMETER(DB1.Block_Order_Flag);
 PARAMETER(DB1.Time_of_Original_Entry);
 PARAMETER(LCL.ODBS_Partial_Pick_Sts);
 PARAMETER(LCL.Deadline_Depart_Date_LH);
 PARAMETER(LCL.Deadline_Depart_Time_LH);
 PARAMETER(LCL.Territory_Code);
 {
  //?USER: Initialize routine

  //?***** Change log and comments
  DO;

  //?** 8/15/13 RMC E2625 New for unbooked orders -crt in qtemp
  ENDDO;

  //?USER: Process Data record

  //?Process record
  CASE;

  // IF DB1.Detail Line Status is Conf/Comp/Canc
  IF DB1.Detail_Line_Status = 'X'/'C'/'R';

  //?Process record
  // IF *OTHERWISE
  IF *OTHERWISE;

  // LCL.OD Adj Type = CND.Order Allocate
  LCL.OD_Adj_Type = 'OA';

  CASE;

  // IF DB1.OD Adj Type Override is Alloc Inventory First
  IF DB1.OD_Adj_Type_Override = 'F';

  // LCL.OD Adj Type = CND.Order Allocate-Inv First
  LCL.OD_Adj_Type = 'OI';

  // IF DB1.OD Adj Type Override is Alloc Inventory Last
  IF DB1.OD_Adj_Type_Override = 'L';

  // LCL.OD Adj Type = CND.Order Allocate-Inv Last
  LCL.OD_Adj_Type = 'OL';

  // IF DB1.OD Adj Type Override is Freeze Time Override
  IF DB1.OD_Adj_Type_Override = 'Z';

  // LCL.OD Adj Type = CND.Order Alloc-Frz time over
  LCL.OD_Adj_Type = 'OF';

  // IF DB1.OD Adj Type Override is Freeze Time-Allow Old prd
  IF DB1.OD_Adj_Type_Override = 'O';

  // LCL.OD Adj Type = CND.Order Alloc-Frz old prod
  LCL.OD_Adj_Type = 'FO';

  ENDIF;

  // LCL.Chill Time USR = CON.*ZERO
  LCL.Chill_Time_USR = *ZERO;

  //?get chill time
  DO;

  EXECUTE FUNCTION(UPS Rtv Company/Item  IF) TYPE(EXCINTFUN)                      AC1423844;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Item_Code);
  PARAMETER(NLL.Description_Line_One);
  PARAMETER(NLL.UOM_Primary);
  PARAMETER(NLL.Unit_Weight);
  PARAMETER(NLL.Item_Structure_Class_Code);
  PARAMETER(NLL.Item_Structure_Group_Code);
  PARAMETER(NLL.Item_Structure_Type_Code);
  PARAMETER(NLL.Item_Type_Code);
  PARAMETER(NLL.Default_Warehouse);
  PARAMETER(LCL.Fresh_Chilling_Time);
  PARAMETER(NLL.Base_Conv_Loss_Item);
  PARAMETER(NLL.Variety_Rendered_Cut);
  PARAMETER(NLL.Credit_Item_Status);
  PARAMETER(NLL.Std_Weight_Head_Var_Ren);
  PARAMETER(NLL.Pieces_Per_Head);
  PARAMETER(NLL.Department_Code);
  PARAMETER(NLL.Group_for_Packaging);
  PARAMETER(NLL.Seconds_Item);
  PARAMETER(NLL.Piece_Count_Item);
  PARAMETER(NLL.Pieces_Per_Bag);
  PARAMETER(NLL.Bags_Per_Unit);
  PARAMETER(NLL.Export_Domestic);
  PARAMETER(NLL.Print_On_Schedule);
  PARAMETER(NLL.Fresh_Inv_Allocation_Seq);
  PARAMETER(NLL.Fresh_Sched_As_Ordered);
  PARAMETER(NLL.Frozen_Inv_Allocation_Seq);
  PARAMETER(NLL.Primal_Group_Code);
  PARAMETER(DB1.Warehouse_Code);
  PARAMETER(LCL.Warehouse_Type);
  PARAMETER(NLL.Trans_Contol_AS400_Plant);
  PARAMETER(NLL.Warehouse_Location);
  PARAMETER(LCL.Warehouse_Std_Chill_Time);
  PARAMETER(LCL.Warehouse_Chill_Time);
  {
   //?Execute internal function

   EXECUTE FUNCTION(Rtv Prd Sch Info   PS RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1294543;
   PARAMETER(PAR.Company_Number);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.Description_Line_One);
   PARAMETER(PAR.UOM_Primary);
   PARAMETER(PAR.Unit_Weight);
   PARAMETER(PAR.Item_Structure_Class_Code);
   PARAMETER(PAR.Item_Structure_Group_Code);
   PARAMETER(PAR.Item_Structure_Type_Code);
   PARAMETER(PAR.Item_Type_Code);
   PARAMETER(PAR.Default_Warehouse);
   PARAMETER(PAR.Fresh_Chilling_Time);
   PARAMETER(PAR.Base_Conv_Loss_Item);
   PARAMETER(PAR.Variety_Rendered_Cut);
   PARAMETER(PAR.Credit_Item_Status);
   PARAMETER(PAR.Std_Weight_Head_Var_Ren);
   PARAMETER(PAR.Pieces_Per_Head);
   PARAMETER(PAR.Department_Code);
   PARAMETER(PAR.Group_for_Packaging);
   PARAMETER(PAR.Seconds_Item);
   PARAMETER(PAR.Piece_Count_Item);
   PARAMETER(PAR.Pieces_Per_Bag);
   PARAMETER(PAR.Bags_Per_Unit);
   PARAMETER(PAR.Export_Domestic);
   PARAMETER(PAR.Print_On_Schedule);
   PARAMETER(PAR.Fresh_Inv_Allocation_Seq);
   PARAMETER(PAR.Fresh_Sched_As_Ordered);
   PARAMETER(PAR.Frozen_Inv_Allocation_Seq);
   PARAMETER(PAR.Primal_Group_Code);
   {
    //?USER: Processing if Data record not found

    MOVE *ALL (To: PAR From: CON);

    //?USER: Process Data record

    MOVE *ALL (To: PAR From: DB1);

   }

   EXECUTE FUNCTION(BPS Rtv Whs Info      RT) TYPE(RTVOBJ) FILE(CAADREP)           AC1475289;
   PARAMETER(PAR.Warehouse_Code);
   PARAMETER(PAR.Warehouse_Type);
   PARAMETER(PAR.Trans_Contol_AS400_Plant);
   PARAMETER(PAR.Warehouse_Location);
   PARAMETER(PAR.Warehouse_Std_Chill_Time);
   PARAMETER(PAR.Warehouse_Chill_Time);
   {
    //?USER: Processing if Data record not found

    MOVE *ALL (To: PAR From: CON);

    //?USER: Process Data record

    MOVE *ALL (To: PAR From: DB1);

   }

  }

  CASE;

  // IF LCL.Warehouse Std Chill Time is yes
  IF LCL.Warehouse_Std_Chill_Time = 'Y';

  // LCL.Chill Time USR = LCL.Warehouse Chill Time
  LCL.Chill_Time_USR = LCL.Warehouse_Chill_Time;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // LCL.Chill Time USR = LCL.Fresh Chilling Time
  LCL.Chill_Time_USR = LCL.Fresh_Chilling_Time;

  ENDIF;

  ENDDO;

  // Call program CLC PA Age FrmToDates XF.
  CALL PROGRAM(CLC PA Age FrmToDates XF) ('PNO7XFR');
  PARAMETER(DB1.Company_Number);
  PARAMETER(LCL.Chilling_Time_USR);
  PARAMETER(DB1.Scheduled_Ship_Date);
  PARAMETER(PAR.Requested_Delivery_Date);
  PARAMETER(DB1.Item_Age_Days);
  PARAMETER(DB1.Production_Ovr_AgeDte_Fr);
  PARAMETER(DB1.Production_Ovr_AgeDte_To);
  PARAMETER(LCL.Production_AgeDte_Fr);
  PARAMETER(LCL.Production_AgeDte_To);

  // LCL.OD Schedule Override Sts = DB1.OD Schedule Override Sts
  LCL.OD_Schedule_Override_Sts = DB1.OD_Schedule_Override_Sts;

  EXECUTE FUNCTION(RTV Warehouse Type     RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1285482;
  PARAMETER(DB1.Warehouse_Code);
  PARAMETER(LCL.Warehouse_Type);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  EXECUTE FUNCTION(Crt Order Det Bld Sch CR) TYPE(CRTOBJ) FILE(PME6CPP)           AC1918004;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(DB1.Scheduled_Ship_Date);
  PARAMETER(PAR.ODBS_Partial_Pick_Sts);
  PARAMETER(DB1.Detail_Line_Status);
  PARAMETER(PAR.Header_Status);
  PARAMETER(PAR.Order_Type_Sales);
  PARAMETER(DB1.Item_Code);
  PARAMETER(DB1.Consumed_Item_Code);
  PARAMETER(DB1.Warehouse_Code);
  PARAMETER(DB1.Age_Code);
  PARAMETER(DB1.Quantity_Ordered);
  PARAMETER(DB1.Weight_Ordered);
  PARAMETER(DB1.Quantity_Scheduled);
  PARAMETER(DB1.Weight_Scheduled);
  PARAMETER(PAR.Event_Code);
  PARAMETER(PAR.Deadline_Depart_Date_LH);
  PARAMETER(PAR.Deadline_Depart_Time_LH);
  PARAMETER(LCL.Warehouse_Type);
  PARAMETER(PAR.Load_ID);
  PARAMETER(PAR.Export_Status);
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(PAR.Production_Hold);
  PARAMETER(PAR.Credit_Hold);
  PARAMETER(LCL.Load_Status);
  PARAMETER(PAR.Carrier_Code);
  PARAMETER(PAR.Date_of_Original_Entry);
  PARAMETER(PAR.Time_of_Original_Entry);
  PARAMETER(LCL.OD_Schedule_Override_Sts);
  PARAMETER(LCL.OD_Adj_Type);
  PARAMETER(*ZERO);
  PARAMETER(PAR.Requested_Delivery_Date);
  PARAMETER(DB1.Item_Age_Days);
  PARAMETER(DB1.Production_Ovr_AgeDte_Fr);
  PARAMETER(DB1.Production_Ovr_AgeDte_To);
  PARAMETER(LCL.Production_AgeDte_Fr);
  PARAMETER(LCL.Production_AgeDte_To);
  PARAMETER(PAR.Block_Order_Flag);
  PARAMETER(LCL.ODBS_Status_2_2_size);
  PARAMETER(DB1.Sales_Route_Code);
  PARAMETER(PAR.Ship_To_State_Code);
  PARAMETER(PAR.Territory_Code);
  PARAMETER(DB1.Requested_Ship_Date);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(WRK.BLANK);
  PARAMETER(WRK.BLANK);
  PARAMETER(WRK.BLANK);
  ENDIF;

 }

 ENDIF;

}


//?***** Change Log and Comments
DO;

//?** 8/15/13 RMC E2625 New for unbooked orders reports -> crt in qtemp
ENDDO;

