/*   SUBMIT PRINT REPORT TO BATCH    */
/********************************************************************/
/*   RMC 2/4/03  ADDED INV SUFFIX SELECTION                         */
/********************************************************************/
PGM   PARM(&OUTQ &COPYN &HOLD &SAVE &COMPNYN &INVSFX)
        DCL    &RETURN     *CHAR   (7)           /* Return Code               */
        DCL    &PGM        *CHAR   (10)          /* CL to Submit              */
        DCL    &COMPNYN    *DEC                  /* Company Number (Passed)   */
        DCL    &COPYN      *DEC                  /* No. +
                                                 Copies    */
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue              */
        DCL    &HOLD       *CHAR   (4)           /* Hold Status               */
        DCL    &SAVE       *CHAR   (4)           /* Save Status               */
        DCL    &NQSTAT     *CHAR   (01)          /* If MUST run in Night Q    */
        DCL    &NIGHTQ     *CHAR   (10)          /* Night Job Queue           */
        DCL    &INVSFX     *CHAR   (2)           /* INVOICE SUFFIX            */
             DCL        VAR(&ERROR) TYPE(*CHAR) LEN(7) VALUE(' ')
        DCL    &COMMAND    *CHAR   (512) /* +
                          Command for Create Printer File Override */

/* INTERNAL FIELDS                                                            */
        DCL    &COPY       *DEC    (2 0)         /* Number of copies          */
        DCL    &COMPANY    *DEC    (3 0)         /* Company Number            */
/********************************************************************/
/*   SUBMIT PRINT CL PROGRAM                                        */
/********************************************************************/

             CHGVAR     VAR(&COPY) VALUE(&COPYN)
             CHGVAR     VAR(&COMPANY) VALUE(&COMPNYN)
  SUBMIT:

             SBDPRTOVR  CMDVAR(&COMMAND) FILE(PDQPPFR$) OUTQ(&OUTQ) +
                          LANDSCAPE(*PRTF) COPIES(&COPY) +
                          HOLD(&HOLD) SAVE(&SAVE)
             CALL       PGM(QCMDEXC) PARM(&command 512)
             /* CREATE AVAILABLE TO POST AND PRINT REPORT  */
             CALL       PGM(PDQPPFR) PARM(' ' &COMPANY &INVSFX)
             DLTOVR     FILE(*ALL)
             GOTO       CMDLBL(END)
/********************************************************************/
/*   INITIALIZE VARIABLES                                           */
/********************************************************************/

             CHGVAR     VAR(&RETURN) VALUE('       ')
             CHGVAR     VAR(&COPY) VALUE(&COPYN)
             CHGVAR     VAR(&COMPANY) VALUE(&COMPNYN)
     END:    ENDPGM
