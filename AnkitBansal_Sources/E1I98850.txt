/*                                                                   */
/*  Program  . . . . .   E1I98850 copied from J98850                 */
/*                                                                   */
/*  Description  . . .   Retrieve User Message File Preference       */
/*                                                                   */
/*  Program Revision Log                                             */
/*  --------------------                                             */
/*                                                                   */
/*       Date        Programmer        Description                   */
/*     --------      ----------     -------------------------------- */
/*     10/22/92          KREUTZ     SAR # 411694                     */
/*     12/15/95          BECK       SAR # 1089414                    */
/*      5/07/20          Baden      SAR # SDN465                     */
/*                                                                   */
/*********************************************************************/
J98850:    PGM          PARM(&LNGMSGF)
/*                                                                   */
/* --------- Define program file(s) and variable(s). --------------- */
/*                                                                   */
             DCL      VAR(&LNGMSGF ) TYPE(*CHAR)  LEN(10)
             DCL      VAR(&LNGP    ) TYPE(*CHAR)  LEN(2)
             DCL      VAR(&UPREF   ) TYPE(*CHAR)  LEN(22)
             DCL      VAR(&LANGMSGF) TYPE(*CHAR)  LEN(10)
/*                                                                   */
/* --------- Global CPF error intercept ---------------------------- */
/*                                                                   */
             MONMSG     MSGID(CPF0000 CPC0000 CPD0000) EXEC(GOTO +
                          CMDLBL(ABEND))
/*                                                                   */
/* --------- Retrieve User Language Preference --------------------- */
/*                                                                   */
/*           CALL       PGM(X00921  ) PARM(&UPREF)                   */

             CALL       PGM(E1I00921) PARM(&UPREF)
/*                                                                   */
/* -------- Load Language Preference Field and Message File -------- */
/*                                                                   */
             CHGVAR     VAR(&LNGP ) VALUE(%SST(&UPREF 5 2))
             CHGVAR     VAR(&LNGMSGF) VALUE('QJDEMSG   ')
             IF         COND(&LNGP *NE '  ') THEN(DO)
               CHGVAR     VAR(&LNGMSGF) VALUE('QJDEMSG' || &LNGP)
               CHKOBJ     OBJ(*LIBL/&LNGMSGF) OBJTYPE(*MSGF)
               MONMSG     MSGID(CPF0000 CPC0000 CPD0000)
             ENDDO
/*                                                                   */
/* --------- Branch to normal EOJ ---------------------------------- */
/*                                                                   */
             RMVMSG     CLEAR(*ALL)
             GOTO       EOJ
/*                                                                   */
/* --------- Abnormal end of job processing ------------------------ */
/*                                                                   */
ABEND:
/*           SNDPGMMSG  MSGID(JDE9999) MSGF(QJDEMSG) MSGDTA('J98850  +
                          ') TOPGMQ(*EXT)                            */

             SNDPGMMSG  MSGID(JDE9999) MSGF(QJDEMSG) MSGDTA('E1I988  +
                          50') TOPGMQ(*EXT)
             MONMSG     MSGID(CPF0000 CPC0000 CPD0000)
             CHGJOB     LOG(4 00 *SECLVL) SWS(1XXXXXXX)
             MONMSG     MSGID(CPF0000 CPC0000 CPD0000)
/*                                                                   */
/* --------- End of Job -------------------------------------------- */
/*                                                                   */
EOJ:
             ENDPGM
