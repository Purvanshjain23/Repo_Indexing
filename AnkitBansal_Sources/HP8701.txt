      *****************  RPG PROGRAM HEADING  ************************
      *
      * SYSTEM:      HOG PRODUCTION
      * PROGRAM:     HP8701
      * TITLE:       Calculate Farm Budget Amount for a Budget Item
      * PROGRAMMER:  LeAnne Fedor
      * CREATED:     07/29/04
      *
      * FUNCTION:  Incoming parms:
      *                 1) budget item
      *                 2) budget quantity
      *
      *            Parms passed out:
      *                 1) volume
      *                 2) cost per unit amount
      *                 3) farm budget amount
      *
      * NOTE:      This program does not set on LR---it uses RETURN to speed processing.
      *
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      *
      * 10/13/04  LeAnne Fedor
      *           Cost Per Unit Amount was changed from 9,2 to 9,4.
      /EJECT
      ****************************************************************
      * DEFINITION SPECIFICATIONS
      ****************************************************************
      *
     Fhsl181c   if   e           k disk
      *    Item
      *
      ****************************************************************
      * CONSTANTS
      ****************************************************************
      *
     D yes             c                   'Y'
     D no              c                   'N'
      *
      ****************************************************************
      * STANDALONE FIELDS
      ****************************************************************
      *
      * Parms
      *
     D xxbgqt          s                   like(imvol)
     D xxbgit          s                   like(imbgit)
     D xxfbam          s              9  2
     D xxcpuam         s                   like(imcpuam)
     D xxvol           s                   like(imvol)
      *
      ****************************************************************
      * DATA STRUCTURES
      ****************************************************************
      *
      *---------------------------------------------------------------
      * Standard program status data structure
      *---------------------------------------------------------------
      *    externally defined as UTPGFR (record format: PGMDSR)
     D pgmds         esds                  extname(utpgfr)
      *
      * The following is a dummy C-spec to keep the D-specs from
      * running over into the C-specs on the compile listing. It
      * serves no other purpose and can be deleted at any time.
      *
     C                   if        sdpgm = *blank
     C                   endif
      /EJECT
      ****************************************************************
      * Mainline
      ****************************************************************
      *
      * Retrieve the first record in the Item Master for the incoming Budget Item.
      *
     C     xxbgit        chain     hsl181c                            92
     C                   if        *in92 = *off
      *
     C                   z-add     imvol         xxvol
     C                   z-add     imcpuam       xxcpuam
      *
     C                   select
     C                   when      imvol = 0
     C                   eval      xxfbam = xxbgqt * xxcpuam
      *
     C                   when      imvol > 0
     C                   eval      xxfbam = (xxbgqt / imvol) * xxcpuam
     C                   endsl
      *
     C                   endif
      *
     C                   seton                                        lr
      /EJECT
      *---------------------------------------------------------------
      * Initialization subroutine
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
      * Parm lists
      *
     C     *entry        plist
     C                   parm                    xxbgit
     C                   parm                    xxbgqt
      *
     C                   parm                    xxvol
     C                   parm                    xxcpuam
     C                   parm                    xxfbam
      *
     C                   endsr
      /EJECT
