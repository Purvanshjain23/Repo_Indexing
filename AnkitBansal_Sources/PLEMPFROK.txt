     H/TITLE Prt Crc Sum & Dtl     PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISSMASO
     H* Date          : 10/11/07  Time  : 11:21:27
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKCXREL1IF  E           K        DISK
      * RTV : Crc Sum Lean Dist Range   Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKARREL0IF  E           K        DISK
      * RTV : Carcass Merit Program     Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPLASREL1IF  E           K        DISK
      * RTV : Producer Site Mileage     Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKBAREL0IF  E           K        DISK
      * RTV : Trucker                   Retrieval index
      *
     FPKCYCPL1IF  E           K        DISK
      * RTV : Crc Sum Tattoo Lean Dist  Retrieval index
      *
     FPKC0CPL2IF  E           K        DISK
      * RSQ : Crc Sum Prd Lean Dst YTD  Co/Prd/Kldte(d)/Ln%
      *
     FPKCZCPL3IF  E           K        DISK
      * RSQ : Crc Sum Prd          YTD  Co/Prd/KlDte(d)
      *
     FPKDBCPL2IF  E           K        DISK
      * RSQ : Crc Sum Co Wgt Lot   WK   Co/WkEnd-d/Min-d/Max
      *
     FPKBPREL3IF  E           K        DISK
      * RSQ : Loss Type                 LossDfn/LossTyp
      *
     FPKBSCPL6IF  E           K        DISK
      * RSQ : Loss Trans                Co/LsTyp/Bo/Ld/Tto
      *
     FPKBRREL1IF  E           K        DISK
      * RTV : Loss Reason               Retrieval index
      *
     FPKB1CPL2IF  E           K        DISK
      * RSQ : Carcass Detail            Co/BO/Ld/Tto/HWgt
      *
     FPKA1CPLFIF  E           K        DISK
      * RSQ : Tattoo Header             Co/BOL/Kill/Ttt
      *
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKA4CPL3IF  E           K        DISK
      * RSQ : Tattoo Header Comment     Co/BOL/Tto/KDt/Typ/Lin
      *
     FPKA1CPLIIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Bol/Ttt
      *
     FPKDZREL1IF  E           K        DISK
      * RTV : Tattoo Defect             Retrieval index
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPLEMPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Crc Sum & Dtl     PF  Print file
      *
      * Long constants
     E                    @CN#    1  27  6   @CN    25
     I@A1CPOC
      * Tattoo Header             Co/BOL/Kill/Ttt
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@A1CPOI
      * Tattoo Header             Co/Bol/Ttt
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      * Outward parameters
     IPARC        DS                             15
      * KEY : Tattoo Header EXT         Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20PAHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   50PABNNB
      * I : RST BOL Load Number
     I                                    P   6   80PABONB
      * I : RST TH Tattoo Number
     I                                    P   9  110PACVNB
      * I : RST TH Kill Date
     I                                    P  12  150PAB0DT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   50P1BNNB
      * I : RST BOL Load Number
     I                                    P   6   80P1BONB
      * I : RST TH Tattoo Number
     I                                    P   9  110P1CVNB
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Lean Rng Hdg 1 USR
     I                                        1  10 P2DVCD
      * N :  Lean Rng Hdg 2 USR
     I                                       11  20 P2DWCD
      * N :  Lean Rng Hdg 3 USR
     I                                       21  30 P2DXCD
      * N :  Lean Rng Hdg 4 USR
     I                                       31  40 P2DYCD
      * N :  Lean Rng Hdg 5 USR
     I                                       41  50 P2DZCD
      * N :  Lean Rng Hdg 6 USR
     I                                       51  60 P2D0CD
      * N :  Lean Rng Hdg 7 USR
     I                                       61  70 P2D1CD
      * N :  Lean Rng Hdg 8 USR
     I                                       71  80 P2D2CD
      * N :  Lean Rng Min 1 USR
     I                                    P  81  820P2CXPC
      * N :  Lean Rng Max 1 USR
     I                                    P  83  840P2CYPC
      * N :  Lean Rng Min 2 USR
     I                                    P  85  860P2CZPC
      * N :  Lean Rng Max 2 USR
     I                                    P  87  880P2C0PC
      * N :  Lean Rng Min 3 USR
     I                                    P  89  900P2C1PC
      * N :  Lean Rng Max 3 USR
     I                                    P  91  920P2C2PC
      * N :  Lean Rng Min 4 USR
     I                                    P  93  940P2C3PC
      * N :  Lean Rng Max 4 USR
     I                                    P  95  960P2C4PC
      * N :  Lean Rng Min 5 USR
     I                                    P  97  980P2C5PC
      * N :  Lean Rng Max 5 USR
     I                                    P  99 1000P2C6PC
      * N :  Lean Rng Min 6 USR
     I                                    P 101 1020P2C7PC
      * N :  Lean Rng Max 6 USR
     I                                    P 103 1040P2C8PC
      * N :  Lean Rng Min 7 USR
     I                                    P 105 1060P2C9PC
      * N :  Lean Rng Max 7 USR
     I                                    P 107 1080P2DAPC
      * N :  Lean Rng Min 8 USR
     I                                    P 109 1100P2DBPC
      * N :  Lean Rng Max 8 USR
     I                                    P 111 1120P2DCPC
     IP3PARM      DS
      * I :  Print Carcass Analysis Us
     I                                        1   1 P3MVST
     IP4PARM      DS
      * I :  TFD Header Action-Crc Dtl
     I                                        1  10 P4NPTX
     IP5PARM      DS
      * I :  TFD Header Action-Crc Sum
     I                                        1  10 P5NKTX
     IP6PARM      DS
      * FLD: Buy Order Header
      * N :  BOH Quote Price Type
     I                                        1   2 P6B3ST
      * N :  BOH Commodity Market Code
     I                                        3   5 P6ETCD
      * N :  BOH Commodity Price Group
     I                                        6  12 P6EUCD
      * N :  CMP Program Code
     I                                       13  15 P6AMCD
     IP7PARM      DS
      * FLD: Carcass Merit Program
      * N :  CMP Sort Basis
     I                                        1   1 P7DMST
     IP8PARM      DS
      * FLD: *Arrays
      * N :  PY Head Killed
     I                                    P   1   40P8MFNB
      * N :  Pricing UOM USR
     I                                        5   6 P8SNST
      * I :  Print Comp Sum/Dtl STS
     I                                        7   7 P8TOST
      * I :  Status 3
     I                                        8   8 P8SVST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Invalid Company Number'
      * CC Company Number
     I                                    P   1   20ZA0001
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  50       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P3MVST    PARM           WP0005  1        Print Carcass A
     C           P4NPTX    PARM           WP0006 10        TFD Header Acti
     C           P5NKTX    PARM           WP0007 10        TFD Header Acti
     C           P8TOST    PARM           WP0008  1        Print Comp Sum/
     C           P8SVST    PARM           WP0009  1        Status 3
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Crc Sum & Dtl     PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$ZENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Crc Sum & Dtl     PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKA01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQKA02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQKA03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQKA04           TH Tattoo Numbe
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
     C                     KFLD           WQKA02           BOH Buy Order N
     C                     KFLD           WQKA03           BOL Load Number
     C                     KFLD           WQKA04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQKA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQKA03           BOL Load Number
     C                     Z-ADDP1CVNB    WQKA04           TH Tattoo Numbe
      * Establish starting position
     C           KRSA      SETLL@A1CPC4                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0AL02  1        BOL Load Number
     C                     MOVEL'Y'       W0AL03  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $DOBNB           TH Hot Wgt DRV
     C                     Z-ADDA1HMNB    $DHMNB           BOH Company Num
     C                     MOVEL*BLANK    $DHDTX           Payment Type De
     C                     MOVEL*BLANK    $DOGTX           Text 10 3 USR
     C                     MOVEL*BLANK    $DJPTX           Text 10 1 USR
     C                     MOVEL*BLANK    $DJQTX           Text 10 2 USR
     C                     Z-ADDA1A6DT    $DA6DT           TH Pricing Date
     C                     Z-ADDA1B0DT    $DB0DT           TH Kill Date
     C                     Z-ADDA1CVNB    $DCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     $DLNA1           TH TATTOO HD RE
     C                     Z-ADDA1FENB    $DFENB           TH Head Killed
     C                     Z-ADD*ZERO     $DN7NB           TH Live Wgt DRV
     C                     Z-ADDA1F7NB    $DF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $DPKNB           Th Live Adj Wgt
     C                     Z-ADD*ZERO     $DU3PR           USDA Prk CutOut
     C                     Z-ADDA1AMPR    $DAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $DU4PR           Break-even Pric
     C                     Z-ADD*ZERO     $DU5PR           Deferred Price
     C                     Z-ADDA1LRNB    $DLRNB           TH Adj Live Wgt
     C                     MOVEL*BLANK    $DTATX           Producer Line U
     C                     Z-ADD*ZERO     $DKYA1           USDA Carc CWT U
     C                     Z-ADD*ZERO     $DIKPC           Base Carc CWT U
     C                     Z-ADD*ZERO     $DILPC           Break-even Carc
     C                     MOVEL*BLANK    $DTBTX           Location Line U
     C                     MOVEL*BLANK    $DNYCD           PS Site ID
     C                     Z-ADD*ZERO     $DLLA1           PSM Miles to Co
     C                     Z-ADD*ZERO     $DVQPR           PrdLoc Trnsp Al
      * Load related totals format
     C                     Z-ADDA1HMNB    $XHMNB           BOH Company Num
      * USER: Process before print of BOH Company Number format
      * CUR = PAR By name
     C                     Z-ADDP1HMNB    $DHMNB           BOH Company Num
     C                     Z-ADDP1CVNB    $DCVNB           TH Tattoo Numbe
      * Rtv Carcass Sum Info  RT - Buy Order Header  * 
     C                     EXSR SBRVGN
      * Rtv CMP Payment Info  RT - Carcass Merit Program  * 
     C                     EXSR SCRVGN
      * CASE: WRK.CMP Grading Type is Meat Value
     C           WUDLST    IFEQ 'M'                        *IF
     C                     MOVEL'M'       WUYZST           Carc/Summ Speci
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUYZST           Carc/Summ Speci
     C                     END                             *FI
      * RTV Ship Resale Info  XF - Tattoo Header  * 
     C                     CALL 'PLF2XFR'              90  RTV Ship Resale
     C                     PARM *BLANK    W0RTN   7
     C                     PARM A1HMNB    WQ0001  30       BOH Company Num
     C                     PARM A1BNNB    WQ0002  50       BOH Buy Order N
     C                     PARM A1BONB    WQ0003  50       BOL Load Number
     C                     PARM A1AWDT    WQ0004  70       TH Purchase Dat
     C           WULOA1    PARM WULOA1    WQ0005  50       Shipped Head Us
     C           WUCSA1    PARM WUCSA1    WQ0006  50       Resale Head Rec
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLF2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Retrieve the Site ID from Tattoo Header EXT - 1/6/06 LJB HPE01
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR SDRVGN
     C                     MOVELWUNYCD    $DNYCD           PS Site ID
      * Rtv Prod Loc Dlv CoMilRT - Producer Site Mileage  * 
     C                     EXSR SERVGN
     C                     Z-ADD$DLLA1    YL0002           PSM Miles to Co
      * Mve Parm to Another Parm - Tattoo Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDA1AWDT    WL0001           TH Purchase Dat
     C                     MOVELA1BICD    WL0002    P      TH Group Refere
     C                     MOVELA1CPST    WL0003    P      TH Live Purchas
     C                     Z-ADDA1ACPR    WL0004           TH Live Purchas
     C                     Z-ADDA1B9PR    WL0005           TH Live Gross A
     C                     Z-ADDA1CAPR    WL0006           TH LIve Net Amt
     C                     MOVELA1C4ST    WL0007    P      TH Resale UOM
     C                     Z-ADDA1AIPR    WL0008           TH Recalc Live
     C                     Z-ADDA1A6DT    WL0009           TH Pricing Date
     C                     MOVELA1C2ST    WL0010    P      TH Resale Sprea
     C                     Z-ADDA1CXNB    WL0011           TH Dead On Arri
     C                     Z-ADDA1CWNB    WL0012           TH Head Receive
     C                     Z-ADDA1FCNB    WL0013           TH Yard Deads
     C                     Z-ADDA1H9NB    WL0014           TH Held Over
     C                     Z-ADDA1FDNB    WL0015           TH Head Condemn
     C                     Z-ADDA1FENB    WL0016           TH Head Killed
     C                     Z-ADDA1HENB    WL0017           TH Head Adds
     C                     Z-ADDA1HFNB    WL0018           TH Head Accepte
     C                     Z-ADDA1CYNB    WL0019           TH Live Wgt
     C                     Z-ADDA1LRNB    WL0020           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    WL0021           TH Hot Wgt
     C                     Z-ADDA1A5PC    WL0022           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    WL0023           TH Tot Backfat
     C                     Z-ADDA1A4PC    WL0024           TH Tot Light Re
     C                     Z-ADDA1F7NB    WL0025           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    WL0026           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    WL0027           TH Avg Light Re
     C                     Z-ADDA1F4NB    WL0028           TH Avg Lean Per
     C                     Z-ADDA1F3NB    WL0029           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    WL0030           TH Avg Backfat
     C                     Z-ADDA1AVPC    WL0031           TH Std Yield Pe
     C                     Z-ADDA1AWPC    WL0032           TH Actual Yield
     C                     Z-ADDA1CWPC    WL0033           TH Adj Actual Y
     C                     Z-ADDA1A8PC    WL0034           TH Yield Differ
     C                     Z-ADDA1A7PC    WL0035           TH Recalc Live
     C                     Z-ADDA1B8PR    WL0036           TH CM Market Pr
     C                     Z-ADDA1AMPR    WL0037           TH CM Base Mkt
     C                     Z-ADDA1ANPR    WL0038           TH CM Base Mkt
     C                     Z-ADDA1AYVA    WL0039           TH CM Sort Disc
     C                     Z-ADDA1AWVA    WL0040           TH CM Yield Gai
     C                     Z-ADDA1AOPR    WL0041           TH CM Base Carc
     C                     Z-ADDA1AXVA    WL0042           TH CM LN AddOn/
     C                     Z-ADDA1APPR    WL0043           TH CM Carcass G
     C                     Z-ADDA1ASPR    WL0044           TH Deduction Am
     C                     Z-ADDA1A4VA    WL0045           TH Total Net WO
     C                     Z-ADDA1ATPR    WL0046           TH Carcass Net
     C                     Z-ADDA1A5VA    WL0047           TH Additions Am
     C                     Z-ADDA1CBPR    WL0048           TH Payment Gros
     C                     Z-ADDA1CCPR    WL0049           Th Payment Net
     C                     Z-ADDA1LPNB    WL0050           TH AP Voucher/D
     C                     Z-ADDA1CDPR    WL0051           TH Freight Amou
     C                     Z-ADDA1A7VA    WL0052           TH Accrual Amou
     C                     Z-ADDA1A2PR    WL0053           TH Fixed Cost A
     C                     MOVELA1JWST    WL0054    P      TH Calc Net Sts
     C                     MOVELA1CWST    WL0055    P      TH Payment Sts
     C                     MOVELA1D7ST    WL0056    P      TH Header Error
     C                     MOVELA1D8ST    WL0057    P      TH Detail Error
     C                     MOVELA1DWST    WL0058    P      TH Kill Balanci
     C                     MOVELA1D6ST    WL0059    P      TH Bal to Kill
     C                     Z-ADDA1GHNB    WL0060           TH Commission A
     C                     Z-ADDA1BYDT    WL0061           TH Voucher Paym
     C                     MOVELA1E0ST    WL0062    P      TH User Error O
     C                     MOVELA1E1ST    WL0063    P      TH Held Over Re
     C                     MOVELA1E2ST    WL0064    P      TH Sex
     C                     Z-ADDA1BSDT    WL0065           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    WL0066           TH Commission P
     C                     Z-ADDA1BUDT    WL0067           TH Actual Check
     C                     Z-ADDA1HGNB    WL0068           TH Shipped Weig
     C                     Z-ADDA1HHNB    WL0069           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    WL0070           TH FFLI
     C                     Z-ADDA1A3PR    WL0071           TH Kill Product
     C                     Z-ADDA1A4PR    WL0072           TH Cut Product
     C                     Z-ADDA1A6PR    WL0073           TH Render Produ
     C                     Z-ADDA1J9NB    WL0074           TH Head Exclude
     C                     Z-ADDA1D6PR    WL0075           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    WL0076           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    WL0077           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    WL0078           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    WL0079           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    WL0080           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    WL0081           TH CM Crc Val L
     C                     Z-ADDA1EDPR    WL0082           TH CM Crc Val C
     C                     Z-ADDA1EEPR    WL0083           TH CM Lean Prem
     C                     Z-ADDA1EFPR    WL0084           TH CM Lean Prem
     C                     Z-ADDA1EGPR    WL0085           TH CM Gross Liv
     C                     Z-ADDA1EHPR    WL0086           TH CM Gross Car
     C                     MOVELA1KAST    WL0087    P      TH Source Type
     C                     MOVELA1J7ST    WL0088    P      TH Scale Ticket
     C                     MOVELA1J9ST    WL0089    P      TH Payment Type
     C                     Z-ADDA1OXNB    WL0090           TH HPS Movement
     C                     MOVELA1LKST    WL0091    P      TH Source Code
     C                     MOVELA1LLST    WL0092    P      TH Hog Class Ty
     C                     MOVELA1J8ST    WL0093    P      TH Posted to HP
     C                     MOVELA1LIST    WL0094    P      TH Schedule Kil
     C                     MOVELA1LJST    WL0095    P      TH Shift Held O
     C                     MOVELA1NZTX    WL0096    P      TH State
     C                     MOVELA1HJCD    WL0097    P      TH Unused Code
     C                     MOVELA1R4ST    WL0098    P      TH Unused Sts 2
     C                     MOVELA1R5ST    WL0099    P      TH Commission S
     C                     MOVELA1R6ST    WL0100    P      TH Paid 2 Week
     C                     MOVELA1R7ST    WL0101    P      TH Unused Sts 1
     C                     Z-ADDA1THWT    WL0102           TH DOA Weight
     C                     Z-ADDA1T2WT    WL0103           TH Avg Lean % E
     C                     Z-ADDA1THHD    WL0104           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    WL0105           TH Shift Held O
     C                     Z-ADDA1OBPR    WL0106           TH Sorting Amou
     C                     Z-ADDA1KOER    WL0107           TH Head Identif
     C                     Z-ADDA1OPIR    WL0108           TH Percent Iden
     C                     Z-ADDA1OPEM    WL0109           TH Percent Acce
     C                     Z-ADDA1IORP    WL0110           TH Head Adjuste
     C                     Z-ADDA1OWEO    WL0111           TH PHA Head Add
     C                     MOVELA1OQET    WL0112    P      TH PHA Add Type
     C                     MOVELA1URST    WL0113    P      TH PHA Average
     C                     MOVELA1USST    WL0114    P      TH PHA Add Reas
     C                     Z-ADDA1HHPC    WL0115           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    WL0116           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    WL0117           TH VC Gross Val
     C                     Z-ADDA1TBPR    WL0118           TH Excluded Gro
     C                     Z-ADDA1JFUR    WL0119           TH Avg Lean %
     C                     Z-ADDA1KRIF    WL0120           TH Broken Back
     C                     Z-ADDA1KORF    WL0121           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    WL0122           TH Unused Nbr 4
     C                     Z-ADDA1KROT    WL0123           TH Excluded Car
     C                     Z-ADDA1OTJG    WL0124           TH Excluded Pre
     C                     Z-ADDA1IRJG    WL0125           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    WL0126           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    WL0127           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    WL0128           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    WL0129           TH Break Even P
     C                     Z-ADDA1KFOR    WL0130           TH Meat Value F
     C                     Z-ADDA1ORJK    WL0131           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    WL0132           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    WL0133           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    WL0134           TH Avg Backfat
     C                     Z-ADDA1NCNF    WL0135           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    WL0136           TH MPR Sort Los
     C                     Z-ADDA1IGIR    WL0137           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    WL0138           TH Unused Nbr 2
     C                     Z-ADDA1EADT    WL0139           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    WL0140           TH Cold Scl Upl
     C                     MOVELA1BDCD    WL0141    P      DF Defect Code
     C                     MOVELA1CSCD    WL0142    P      THP Process Cod
     C                     MOVELA1ABCD    WL0143    P      PD Producer Cod
     C                     MOVELA1AECD    WL0144    P      PL Location Cod
     C                     MOVELA1ACCD    WL0145    P      HB Buyer Code
     C                     MOVELA1AGCD    WL0146    P      GN Genetic Code
     C                     MOVELA1BECD    WL0147    P      HC Class Code
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0148    YL0003           TH Purchase Dat
     C                     MOVELWL0149    YL0004    P      TH Group Refere
     C                     MOVELWL0150    YL0005    P      TH Live Purchas
     C                     Z-ADDWL0151    YL0006           TH Live Purchas
     C                     Z-ADDWL0152    YL0007           TH Live Gross A
     C                     Z-ADDWL0153    YL0008           TH LIve Net Amt
     C                     MOVELWL0154    YL0009    P      TH Resale UOM
     C                     Z-ADDWL0155    YL0010           TH Recalc Live
     C                     Z-ADDWL0156    YL0011           TH Pricing Date
     C                     MOVELWL0157    YL0012    P      TH Resale Sprea
     C                     Z-ADDWL0158    YL0013           TH Dead On Arri
     C                     Z-ADDWL0159    YL0014           TH Head Receive
     C                     Z-ADDWL0160    YL0015           TH Yard Deads
     C                     Z-ADDWL0161    YL0016           TH Held Over
     C                     Z-ADDWL0162    YL0017           TH Head Condemn
     C                     Z-ADDWL0163    YL0018           TH Head Killed
     C                     Z-ADDWL0164    YL0019           TH Head Adds
     C                     Z-ADDWL0165    YL0020           TH Head Accepte
     C                     Z-ADDWL0166    YL0021           TH Live Wgt
     C                     Z-ADDWL0167    YL0022           TH Adj Live Wgt
     C                     Z-ADDWL0168    YL0023           TH Hot Wgt
     C                     Z-ADDWL0169    YL0024           TH Tot Loin Eye
     C                     Z-ADDWL0170    YL0025           TH Tot Backfat
     C                     Z-ADDWL0171    YL0026           TH Tot Light Re
     C                     Z-ADDWL0172    YL0027           TH Avg Live Wgt
     C                     Z-ADDWL0173    YL0028           TH Avg Hot Wgt
     C                     Z-ADDWL0174    YL0029           TH Avg Light Re
     C                     Z-ADDWL0175    YL0030           TH Avg Lean Per
     C                     Z-ADDWL0176    YL0031           TH Avg Loin Eye
     C                     Z-ADDWL0177    YL0032           TH Avg Backfat
     C                     Z-ADDWL0178    YL0033           TH Std Yield Pe
     C                     Z-ADDWL0179    YL0034           TH Actual Yield
     C                     Z-ADDWL0180    YL0035           TH Adj Actual Y
     C                     Z-ADDWL0181    YL0036           TH Yield Differ
     C                     Z-ADDWL0182    YL0037           TH Recalc Live
     C                     Z-ADDWL0183    YL0038           TH CM Market Pr
     C                     Z-ADDWL0184    YL0039           TH CM Base Mkt
     C                     Z-ADDWL0185    YL0040           TH CM Base Mkt
     C                     Z-ADDWL0186    YL0041           TH CM Sort Disc
     C                     Z-ADDWL0187    YL0042           TH CM Yield Gai
     C                     Z-ADDWL0188    YL0043           TH CM Base Carc
     C                     Z-ADDWL0189    YL0044           TH CM LN AddOn/
     C                     Z-ADDWL0190    YL0045           TH CM Carcass G
     C                     Z-ADDWL0191    YL0046           TH Deduction Am
     C                     Z-ADDWL0192    YL0047           TH Total Net WO
     C                     Z-ADDWL0193    YL0048           TH Carcass Net
     C                     Z-ADDWL0194    YL0049           TH Additions Am
     C                     Z-ADDWL0195    YL0050           TH Payment Gros
     C                     Z-ADDWL0196    YL0051           Th Payment Net
     C                     Z-ADDWL0197    YL0052           TH AP Voucher/D
     C                     Z-ADDWL0198    YL0053           TH Freight Amou
     C                     Z-ADDWL0199    YL0054           TH Accrual Amou
     C                     Z-ADDWL0200    YL0055           TH Fixed Cost A
     C                     MOVELWL0201    YL0056    P      TH Calc Net Sts
     C                     MOVELWL0202    YL0057    P      TH Payment Sts
     C                     MOVELWL0203    YL0058    P      TH Header Error
     C                     MOVELWL0204    YL0059    P      TH Detail Error
     C                     MOVELWL0205    YL0060    P      TH Kill Balanci
     C                     MOVELWL0206    YL0061    P      TH Bal to Kill
     C                     Z-ADDWL0207    YL0062           TH Commission A
     C                     Z-ADDWL0208    YL0063           TH Voucher Paym
     C                     MOVELWL0209    YL0064    P      TH User Error O
     C                     MOVELWL0210    YL0065    P      TH Held Over Re
     C                     MOVELWL0211    YL0066    P      TH Sex
     C                     Z-ADDWL0212    YL0067           TH Held/Ovr Com
     C                     Z-ADDWL0213    YL0068           TH Commission P
     C                     Z-ADDWL0214    YL0069           TH Actual Check
     C                     Z-ADDWL0215    YL0070           TH Shipped Weig
     C                     Z-ADDWL0216    YL0071           TH Avg Hot Wgt
     C                     Z-ADDWL0217    YL0072           TH FFLI
     C                     Z-ADDWL0218    YL0073           TH Kill Product
     C                     Z-ADDWL0219    YL0074           TH Cut Product
     C                     Z-ADDWL0220    YL0075           TH Render Produ
     C                     Z-ADDWL0221    YL0076           TH Head Exclude
     C                     Z-ADDWL0222    YL0077           TH CM Bse Mkt L
     C                     Z-ADDWL0223    YL0078           TH CM Bse Mkt C
     C                     Z-ADDWL0224    YL0079           TH CM Srt Dsc L
     C                     Z-ADDWL0225    YL0080           TH CM Srt Dsc C
     C                     Z-ADDWL0226    YL0081           TH CM Yld G/L L
     C                     Z-ADDWL0227    YL0082           TH CM Yld G/L C
     C                     Z-ADDWL0228    YL0083           TH CM Crc Val L
     C                     Z-ADDWL0229    YL0084           TH CM Crc Val C
     C                     Z-ADDWL0230    YL0085           TH CM Lean Prem
     C                     Z-ADDWL0231    YL0086           TH CM Lean Prem
     C                     Z-ADDWL0232    YL0087           TH CM Gross Liv
     C                     Z-ADDWL0233    YL0088           TH CM Gross Car
     C                     MOVELWL0234    YL0089    P      TH Source Type
     C                     MOVELWL0235    YL0090    P      TH Scale Ticket
     C                     MOVELWL0236    YL0091    P      TH Payment Type
     C                     Z-ADDWL0237    YL0092           TH HPS Movement
     C                     MOVELWL0238    YL0093    P      TH Source Code
     C                     MOVELWL0239    YL0094    P      TH Hog Class Ty
     C                     MOVELWL0240    YL0095    P      TH Posted to HP
     C                     MOVELWL0241    YL0096    P      TH Schedule Kil
     C                     MOVELWL0242    YL0097    P      TH Shift Held O
     C                     MOVELWL0243    YL0098    P      TH State
     C                     MOVELWL0244    YL0099    P      TH Unused Code
     C                     MOVELWL0245    YL0100    P      TH Unused Sts 2
     C                     MOVELWL0246    YL0101    P      TH Commission S
     C                     MOVELWL0247    YL0102    P      TH Paid 2 Week
     C                     MOVELWL0248    YL0103    P      TH Unused Sts 1
     C                     Z-ADDWL0249    YL0104           TH DOA Weight
     C                     Z-ADDWL0250    YL0105           TH Avg Lean % E
     C                     Z-ADDWL0251    YL0106           TH HPS Farm Sit
     C                     Z-ADDWL0252    YL0107           TH Shift Held O
     C                     Z-ADDWL0253    YL0108           TH Sorting Amou
     C                     Z-ADDWL0254    YL0109           TH Head Identif
     C                     Z-ADDWL0255    YL0110           TH Percent Iden
     C                     Z-ADDWL0256    YL0111           TH Percent Acce
     C                     Z-ADDWL0257    YL0112           TH Head Adjuste
     C                     Z-ADDWL0258    YL0113           TH PHA Head Add
     C                     MOVELWL0259    YL0114    P      TH PHA Add Type
     C                     MOVELWL0260    YL0115    P      TH PHA Average
     C                     MOVELWL0261    YL0116    P      TH PHA Add Reas
     C                     Z-ADDWL0262    YL0117           TH PHA Yield Pe
     C                     Z-ADDWL0263    YL0118           TH PHA Lean Prm
     C                     Z-ADDWL0264    YL0119           TH VC Gross Val
     C                     Z-ADDWL0265    YL0120           TH Excluded Gro
     C                     Z-ADDWL0266    YL0121           TH Avg Lean %
     C                     Z-ADDWL0267    YL0122           TH Broken Back
     C                     Z-ADDWL0268    YL0123           TH Hot Scl Uplo
     C                     Z-ADDWL0269    YL0124           TH Unused Nbr 4
     C                     Z-ADDWL0270    YL0125           TH Excluded Car
     C                     Z-ADDWL0271    YL0126           TH Excluded Pre
     C                     Z-ADDWL0272    YL0127           TH Unused Nbr 7
     C                     Z-ADDWL0273    YL0128           TH Unused Nbr 8
     C                     Z-ADDWL0274    YL0129           TH Unused Nbr 9
     C                     Z-ADDWL0275    YL0130           TH Unused Nbr 1
     C                     Z-ADDWL0276    YL0131           TH Break Even P
     C                     Z-ADDWL0277    YL0132           TH Meat Value F
     C                     Z-ADDWL0278    YL0133           TH Yld Parm Adj
     C                     Z-ADDWL0279    YL0134           TH PHA Sort Dis
     C                     Z-ADDWL0280    YL0135           TH Avg Loin Eye
     C                     Z-ADDWL0281    YL0136           TH Avg Backfat
     C                     Z-ADDWL0282    YL0137           TH HITCH Old Pa
     C                     Z-ADDWL0283    YL0138           TH MPR Sort Los
     C                     Z-ADDWL0284    YL0139           TH Unused Nbr 1
     C                     Z-ADDWL0285    YL0140           TH Unused Nbr 2
     C                     Z-ADDWL0286    YL0141           TH Cold Scl Upl
     C                     Z-ADDWL0287    YL0142           TH Cold Scl Upl
     C                     MOVELWL0288    YL0143    P      DF Defect Code
     C                     MOVELWL0289    YL0144    P      THP Process Cod
     C                     MOVELWL0290    YL0145    P      PD Producer Cod
     C                     MOVELWL0291    YL0146    P      PL Location Cod
     C                     MOVELWL0292    YL0147    P      HB Buyer Code
     C                     MOVELWL0293    YL0148    P      GN Genetic Code
     C                     MOVELWL0294    YL0149    P      HC Class Code
      * CASE: PAR.Status 3 is Yes
     C           P8SVST    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0138    YL0041           TH CM Sort Disc
     C                     END                             *FI
      * Pricing UOM USR
      * CASE: PAR.BOH Quote Price Type is Entered
     C           P6B3ST    IFEQ 'CP'                       *IF
     C           P6B3ST    OREQ 'LP'
      * CASE: PAR.BOH Quote Price Type is Carcass Price
     C           P6B3ST    IFEQ 'CP'                       *IF
     C                     MOVEL'CW'      P8SNST           Pricing UOM USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'LW'      P8SNST           Pricing UOM USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Commod Group U/M  XF - STR Order Management Sys  * 
     C                     CALL 'PDUVXFR'              90  Rtv Commod Grou
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P6EUCD    WQ0007  7        BOH Commodity P
     C           P8SNST    PARM *BLANK    WQ0008  2        Pricing UOM USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Live/Carcass Merit Payment type description
      * CASE: PAR.Print Comp Sum/Dtl STS is Yes
     C           P8TOST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    $DHDTX           Payment Type De
     C                     MOVEL@CN,01    $DHDTX           Payment Type De
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Payment Type is Live
      *   |- c2    : PAR.Print Carcass Analysis Us is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           A1J9ST    IFEQ 'L'                        *IF
     C           P3MVST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    $DHDTX           Payment Type De
     C                     MOVEL'L I V E' $DHDTX           Payment Type De
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TH Payment Type is Carcass Merit
      *   |- c2    : PAR.Print Live as Carcass USR is Yes
      *   '-
     C           A1J9ST    IFEQ 'C'                        *IF
     C           P3MVST    OREQ 'Y'                        *OR
     C                     MOVEL*BLANK    $DHDTX           Payment Type De
     C                     MOVEL@CN,02    $DHDTX           Payment Type De
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Analysis fields into payment fields
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           P3MVST    IFEQ 'Y'                        *IF
      * Rtv Tattoo Hdr Ext    XF - Tattoo Header EXT  * 
     C                     CLEARPARC
     C                     Z-ADDA1HMNB    PAHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    PABONB           BOL Load Number
     C                     Z-ADDA1CVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKAWXFR'              90  Rtv Tattoo Hdr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
     C           YL0038    PARM YL0038    WQ0009  52       TH CM Market Pr
     C           YL0039    PARM YL0039    WQ0010  52       TH CM Base Mkt
     C           YL0040    PARM YL0040    WQ0011  72       TH CM Base Mkt
     C           YL0041    PARM YL0041    WQ0012  72       TH CM Sort Disc
     C           YL0042    PARM YL0042    WQ0013  72       TH CM Yield Gai
     C           YL0043    PARM YL0043    WQ0014  72       TH CM Base Carc
     C           YL0044    PARM YL0044    WQ0015  72       TH CM LN AddOn/
     C           YL0045    PARM YL0045    WQ0016  72       TH CM Carcass G
     C           YL0077    PARM YL0077    WQ0017  52       TH CM Bse Mkt L
     C           YL0078    PARM YL0078    WQ0018  52       TH CM Bse Mkt C
     C           YL0079    PARM YL0079    WQ0019  52       TH CM Srt Dsc L
     C           YL0080    PARM YL0080    WQ0020  52       TH CM Srt Dsc C
     C           YL0081    PARM YL0081    WQ0021  52       TH CM Yld G/L L
     C           YL0082    PARM YL0082    WQ0022  52       TH CM Yld G/L C
     C           YL0083    PARM YL0083    WQ0023  52       TH CM Crc Val L
     C           YL0084    PARM YL0084    WQ0024  52       TH CM Crc Val C
     C           YL0085    PARM YL0085    WQ0025  52       TH CM Lean Prem
     C           YL0086    PARM YL0086    WQ0026  52       TH CM Lean Prem
     C           YL0087    PARM YL0087    WQ0027  52       TH CM Gross Liv
     C           YL0088    PARM YL0088    WQ0028  52       TH CM Gross Car
     C           W0RTN     PARM W0RTN     WQ0029  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAWXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Held Over Processing  -- maybe also analysis
      * CASE: DB1.TH Held Over Record is Yes
     C           A1E1ST    IFEQ 'Y'                        *IF
      *
     C                     Z-ADD*ZERO     WN0001 152       Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0002 152       Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0003 152       Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0004 152       Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0005 152       Loin-Eye * Wgt
      *
      * Prt Crc Sum (Hld Ovr) IF
      * 9/24/02 RMC Calc 2 dec backfat and loin eye
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0150           TH Kill Date
     C                     Z-ADD*ZERO     YL0013           TH Dead On Arri
     C                     Z-ADD*ZERO     YL0014           TH Head Receive
     C                     Z-ADD*ZERO     YL0015           TH Yard Deads
     C                     Z-ADD*ZERO     YL0017           TH Head Condemn
     C                     Z-ADD*ZERO     YL0018           TH Head Killed
     C                     Z-ADD*ZERO     YL0019           TH Head Adds
     C                     Z-ADD*ZERO     YL0021           TH Live Wgt
     C                     Z-ADD*ZERO     YL0022           TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0023           TH Hot Wgt
     C                     Z-ADD*ZERO     YL0027           TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0028           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0030           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0031           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0032           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0034           TH Actual Yield
     C                     Z-ADD*ZERO     YL0035           TH Adj Actual Y
     C                     Z-ADD*ZERO     YL0040           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0041           TH CM Sort Disc
     C                     Z-ADD*ZERO     YL0042           TH CM Yield Gai
     C                     Z-ADD*ZERO     YL0043           TH CM Base Carc
     C                     Z-ADD*ZERO     YL0044           TH CM LN AddOn/
     C                     Z-ADD*ZERO     YL0045           TH CM Carcass G
     C                     Z-ADD*ZERO     YL0046           TH Deduction Am
     C                     Z-ADD*ZERO     YL0048           TH Carcass Net
     C                     Z-ADD*ZERO     YL0049           TH Additions Am
     C                     Z-ADD*ZERO     YL0050           TH Payment Gros
     C                     Z-ADD*ZERO     YL0051           Th Payment Net
     C                     Z-ADD*ZERO     YL0070           TH Shipped Weig
     C                     Z-ADD*ZERO     YL0072           TH FFLI
     C                     Z-ADD*ZERO     YL0076           TH Head Exclude
     C                     Z-ADD*ZERO     YL0077           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     YL0078           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     YL0079           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     YL0080           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     YL0081           TH CM Yld G/L L
     C                     Z-ADD*ZERO     YL0082           TH CM Yld G/L C
     C                     Z-ADD*ZERO     YL0083           TH CM Crc Val L
     C                     Z-ADD*ZERO     YL0084           TH CM Crc Val C
     C                     Z-ADD*ZERO     YL0085           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0086           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0087           TH CM Gross Liv
     C                     Z-ADD*ZERO     YL0088           TH CM Gross Car
     C                     Z-ADD*ZERO     YL0112           TH Head Adjuste
     C                     Z-ADD*ZERO     YL0113           TH PHA Head Add
     C                     Z-ADD*ZERO     YL0120           TH Excluded Gro
     C                     Z-ADD*ZERO     YL0125           TH Excluded Car
     C                     Z-ADD*ZERO     YL0126           TH Excluded Pre
     C                     Z-ADD*ZERO     YL0135           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0136           TH Avg Backfat
     C                     Z-ADD*ZERO     WN0001           Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0002           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0003           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0004           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0005           Loin-Eye * Wgt
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header  * 
     C                     EXSR SGRVGN
      * Calculate Live /CWT and Carc /CWT
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
      * Calculate Carc/CWT if Par.Th Hot Wt is n= 0
      * CASE: PAR.TH Hot Wgt NE WRK.Zero USR
     C           YL0023    IFNE WUE9NB                     *IF
      * TH CM Bse Mkt Carc /CWT
      * PAR.TH CM Bse Mkt Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0023    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0040    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0078           TH CM Bse Mkt C
      * TH CM Srt Dsc Carc /CWT
      * PAR.TH CM Srt Dsc Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0023    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0041    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0080           TH CM Srt Dsc C
      * TH CM Crc Val Carc /CWT
      * WRK.TH CM Crc Val Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0023    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0043    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEDPR           TH CM Crc Val C
     C                     Z-ADDWUEDPR    YL0084           TH CM Crc Val C
      * TH CM Lean Prem Carc /CWT
      * PAR.TH CM Lean Prem Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0023    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0044    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0086           TH CM Lean Prem
      * TH CM Gross Carc /CWT
      * PAR.TH CM Gross Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0023    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0045    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0088           TH CM Gross Car
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0078           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     YL0080           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     YL0082           TH CM Yld G/L C
     C                     Z-ADD*ZERO     YL0084           TH CM Crc Val C
     C                     Z-ADD*ZERO     YL0086           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0088           TH CM Gross Car
     C                     END                             *FI
      * Calculate Live/CWT if Par.Th live wt is n= 0
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           YL0021    IFNE WUE9NB                     *IF
      * TH CM Bse Mkt Live /CWT
      * PAR.TH CM Bse Mkt Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0021    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0040    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0077           TH CM Bse Mkt L
      * TH CM Srt Dsc Live /CWT
      * PAR.TH CM Srt Dsc Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0021    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0041    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0079           TH CM Srt Dsc L
      * TH CM Yld G/L live /CWT
      * PAR.TH CM Yld G/L Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Yield Gain/Loss Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0021    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0042    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0081           TH CM Yld G/L L
      * TH CM Crc Val Live /CWT
      * PAR.TH CM Crc Val Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0021    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0043    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0083           TH CM Crc Val L
      * TH CM Lean Prem Live /CWT
      * PAR.TH CM Lean Prem Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0021    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0044    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0085           TH CM Lean Prem
      * TH CM Gross Live /CWT
      * PAR.TH CM Gross Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0021    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0045    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0087           TH CM Gross Liv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0077           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     YL0079           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     YL0081           TH CM Yld G/L L
     C                     Z-ADD*ZERO     YL0083           TH CM Crc Val L
     C                     Z-ADD*ZERO     YL0085           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0087           TH CM Gross Liv
     C                     END                             *FI
     C                     END                             *FI
      * Calc Avg Live Wt
      * CASE: PAR.TH Head Received is *Zeros
     C           YL0014    IFEQ *ZERO                      *IF
     C                     Z-ADD*ZERO     WUF7NB           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0021    DIV  YL0014    WUF7NB           TH Avg Live Wgt
     C                     END                             *FI
      * Calc Adj Live Weight
      * CASE: PAR.TH Head Received EQ PAR.TH Head Killed
     C           YL0014    IFEQ YL0018                     *IF
     C                     Z-ADDYL0021    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0018    MULT WUF7NB    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
     C                     Z-ADDWUF7NB    YL0027           TH Avg Live Wgt
     C                     Z-ADDWULRNB    YL0022           TH Adj Live Wgt
      * Calc Actual Yield %
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           YL0021    IFNE WUE9NB                     *IF
      * TH Actual Yield %
      * PAR.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0023    DIV  YL0021    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0034           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0034           TH Actual Yield
     C                     END                             *FI
      * Calc Adj Actual Yield %
      * CASE: PAR.TH Adj Live Wgt NE WRK.Zero USR
     C           YL0022    IFNE WUE9NB                     *IF
      * TH Adj Actual Yield %
      * PAR.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0023    DIV  YL0022    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0035           TH Adj Actual Y
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0035           TH Adj Actual Y
     C                     END                             *FI
      * Calc Avg Hot Wt
      * CASE: PAR.TH Head Killed NE WRK.Zero USR
     C           YL0018    IFNE WUE9NB                     *IF
     C           YL0023    DIV  YL0018    YL0028    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0028           TH Avg Hot Wgt
     C                     END                             *FI
      * Calc Avg Lean %, Loin eye, & Backfat
      * CASE: PAR.TH Hot Wgt NE WRK.Zero USR
     C           YL0023    IFNE WUE9NB                     *IF
     C           WN0001    DIV  YL0023    YL0030    H      TH Avg Lean Per
     C           WN0003    DIV  YL0023    YL0031    H      TH Avg Loin Eye
     C           WN0002    DIV  YL0023    YL0032    H      TH Avg Backfat
     C           WN0005    DIV  YL0023    YL0135    H      TH Avg Loin Eye
     C           WN0004    DIV  YL0023    YL0136    H      TH Avg Backfat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0030           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0031           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0032           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0135           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0136           TH Avg Backfat
     C                     END                             *FI
      * TH FFLI
      * PAR.TH FFLI =
      *    *COMPUTE (x1 + (x2 * x3) - (x4 * x5))
      * x1    : CON.51.537
      * +     : PGM.*Synon (17,7) work field
      * x2    : CON..035
      * *     : PGM.*Synon (17,7) work field *
      * x3    : PAR.TH Hot Wgt
      * -     : PGM.*Synon (17,7) work field
      * x4    : CON.12.26
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.TH Avg Backfat
     C           .035      MULT YL0023    W0WD02           *Synon (17,7) w
     C           51.537    ADD  W0WD02    W0WD01           *Synon (17,7) w
     C           12.26     MULT YL0032    W0WD03           *Synon (17,7) w
     C           W0WD01    SUB  W0WD03    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0072           TH FFLI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDA1KROT    YL0125           TH Excluded Car
     C                     Z-ADDA1OTJG    YL0126           TH Excluded Pre
      * 10/10/07 slm
      * This should be for TF only Guymon should have regualr
      * CASE: WRK.Carc/Summ Special Prc Usr is Meat Cmp Program
     C           WUYZST    IFEQ 'M'                        *IF
     C                     Z-ADDYL0055    YL0043           TH CM Base Carc
     C                     END                             *FI
      * CASE: LCL.TH Hot Wgt is Zeros
     C           YL0023    IFEQ *ZERO                      *IF
     C                     Z-ADD*ZERO     YL0084           TH CM Crc Val C
     C                     ELSE
      * CASE: *OTHERWISE
      * TH CM Crc Val Carc /CWT
      * LCL.TH CM Crc Val Carc /CWT =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Hot Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0043    DIV  YL0023    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0084           TH CM Crc Val C
     C                     END                             *FI
     C                     END                             *FI
      * Create the Producer Line
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SIRVGN
     C                     Z-ADD2         ZQ      50
     C           A1ABCD    CAT  YL0151:ZQ $DTATX    P      Producer Line U
      * Create the Producer Location Line
      * Rtv PL Address flds   RT - Producer Location  * 
     C                     EXSR SJRVGN
      * Get Vendor Address    RT - STR VND Common Routines  * 
     C                     CALL 'VNDFAXR'              90  Get Vendor Addr
     C           W0RTN     PARM *BLANK    WQ0030  7        *Return code
     C           YL0153    PARM YL0153    WQ0031  80       Address Number
     C           YL0155    PARM YL0155    WQ0032 40        Pass Name
     C           YL0156    PARM YL0156    WQ0033 40        Address 1
     C           YL0157    PARM YL0157    WQ0034 40        Address 2
     C           YL0158    PARM YL0158    WQ0035 40        Address 3
     C           YL0159    PARM YL0159    WQ0036 40        City
     C           YL0160    PARM YL0160    WQ0037  3        State
     C           YL0161    PARM YL0161    WQ0038 12        Zip
     C           YL0162    PARM YL0162    WQ0039  6        Area Code
     C           YL0163    PARM YL0163    WQ0040 20        Telephone
     C           YL0164    PARM YL0164    WQ0041  6        Fax Area Code #
     C           YL0165    PARM YL0165    WQ0042 20        Fax Telephone
     C           YL0166    PARM YL0166    WQ0043  6        Fax Area Code #
     C           YL0167    PARM YL0167    WQ0044 20        Fax Telephone 2
     C           YL0168    PARM YL0168    WQ0045  1        Vendor 1099
     C           YL0169    PARM YL0169    WQ0046 16        Vendor Tax Id.
     C           YL0170    PARM YL0170    WQ0047  3        Country Code
     C                     PARM 'P'       WQ0048  1        Producer/Trucke
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'VNDFAXR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD2         ZQ      50
     C           A1AECD    CAT  YL0159:ZQ $DTBTX    P      Location Line U
     C                     Z-ADD2         ZQ      50
     C           $DTBTX    CAT  YL0160:ZQ $DTBTX    P      Location Line U
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $EHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $EBNNB           BOH Buy Order N
      * Load related totals format
     C                     Z-ADDA1HMNB    $WHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $WBNNB           BOH Buy Order N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $FHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $FBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $FBONB           BOL Load Number
      * Load related totals format
     C                     Z-ADDA1HMNB    $QHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $QBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $QBONB           BOL Load Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $GHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $GBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $GBONB           BOL Load Number
     C                     Z-ADDA1CVNB    $GCVNB           TH Tattoo Numbe
      * Load related totals format
     C                     Z-ADDA1HMNB    $IHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $IBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $IBONB           BOL Load Number
     C                     Z-ADDA1CVNB    $ICVNB           TH Tattoo Numbe
     C                     Z-ADDA1OXNB    $IOXNB           TH HPS Movement
     C                     MOVELA1BICD    $IBICD           TH Group Refere
     C                     MOVEL*BLANK    $ITCTX           Prd/Co Confiden
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA1HMNB    $HHMNB           BOH Company Num
     C                     Z-ADDA1BONB    $HBONB           BOL Load Number
     C                     Z-ADDA1A6DT    $HA6DT           TH Pricing Date
     C                     Z-ADDA1AWDT    $HAWDT           TH Purchase Dat
     C                     Z-ADDA1B0DT    $HB0DT           TH Kill Date
     C                     Z-ADDA1CVNB    $HCVNB           TH Tattoo Numbe
     C                     MOVELA1CPST    $HCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $HACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    $HB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $HCAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    $HC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $HAIPR           TH Recalc Live
     C                     MOVELA1C2ST    $HC2ST           TH Resale Sprea
     C                     Z-ADDA1CWNB    $HCWNB           TH Head Receive
     C                     Z-ADDA1H9NB    $HH9NB           TH Held Over
     C                     Z-ADDA1FENB    $HFENB           TH Head Killed
     C                     Z-ADDA1F7NB    $HF7NB           TH Avg Live Wgt
     C                     Z-ADDA1LRNB    $HLRNB           TH Adj Live Wgt
     C                     Z-ADDA1HFNB    $HHFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    $HCYNB           TH Live Wgt
     C                     Z-ADDA1AMPR    $HAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     $HE7PR           TH CM BASE CARC
     C                     MOVELA1ABCD    $HABCD           PD Producer Cod
     C                     MOVEL*BLANK    $HKPTX           Text 5
     C                     MOVELA1ACCD    $HACCD           HB Buyer Code
     C                     Z-ADD*ZERO     $HARDT           BOH Buy Order D
     C                     MOVEL*BLANK    $HVKTX           Text 25 #5 Usr
     C                     Z-ADDA1ANPR    $HANPR           TH CM Base Mkt
     C                     Z-ADDA1D6PR    $HD6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $HD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     $HVKPR           Base Mkt Price
     C                     Z-ADDA1AWPC    $HAWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    $HCWPC           TH Adj Actual Y
     C                     Z-ADDA1A2PR    $HA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    $HJWST           TH Calc Net Sts
     C                     Z-ADDA1AYVA    $HAYVA           TH CM Sort Disc
     C                     Z-ADDA1D8PR    $HD8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $HD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     $HVLPR           Var From Top Wt
     C                     MOVEL*BLANK    $HUHTX           Text 25 #1 Usr
     C                     Z-ADDA1AWVA    $HAWVA           TH CM Yield Gai
     C                     Z-ADDA1EAPR    $HEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $HEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     $HVMPR           Yield Gain/Loss
     C                     Z-ADD*ZERO     $HLYA1           Avg Meat Value
     C                     Z-ADD*ZERO     $HLOA1           Shipped Head Us
     C                     Z-ADD*ZERO     $HCSA1           Resale Head Rec
     C                     Z-ADD*ZERO     $HD0PC           TH Avg Lean Per
     C                     Z-ADDA1A5PC    $HA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $HFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $HA4PC           TH Tot Light Re
     C                     MOVEL*BLANK    $HUITX           Text 25 #2 Usr
     C                     Z-ADDA1AOPR    $HAOPR           TH CM Base Carc
     C                     Z-ADDA1ECPR    $HECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $HEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     $HVNPR           Carcass Value
     C                     MOVEL*BLANK    $HUJTX           Text 25 #3 Usr
     C                     Z-ADDA1E0NB    $HE0NB           TH Hot Wgt
     C                     Z-ADDA1AXVA    $HAXVA           TH CM LN AddOn/
     C                     Z-ADDA1EEPR    $HEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $HEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     $HVOPR           Quality Prem/De
     C                     Z-ADDA1F4NB    $HF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     $HOCNB           TH Avg Hot Wgt
     C                     Z-ADDA1TBPR    $HTBPR           TH Excluded Gro
     C                     MOVELA1KAST    $HKAST           TH Source Type
     C                     MOVELA1J7ST    $HJ7ST           TH Scale Ticket
     C                     MOVELA1J8ST    $HJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $HLIST           TH Schedule Kil
     C                     MOVELA1LJST    $HLJST           TH Shift Held O
     C                     Z-ADDA1OMVJ    $HOMVJ           TH PHA Sort Dis
     C                     MOVELA1J9ST    $HJ9ST           TH Payment Type
     C                     MOVELA1LKST    $HLKST           TH Source Code
     C                     MOVELA1LLST    $HLLST           TH Hog Class Ty
     C                     MOVEL*BLANK    $HOETX           Text 25 1 USR
     C                     Z-ADD*ZERO     $HOBNB           TH Hot Wgt DRV
     C                     Z-ADDA1APPR    $HAPPR           TH CM Carcass G
     C                     Z-ADDA1EGPR    $HEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $HEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     $HVPPR           Gross Value
     C                     Z-ADDA1F5NB    $HF5NB           TH Avg Light Re
     C                     MOVEL*BLANK    $HOFTX           Text 25 2 USR
     C                     Z-ADDA1HDNB    $HHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F2NB    $HF2NB           TH Avg Backfat
     C                     MOVEL*BLANK    $HGWTX           Ded Line 1 Desc
     C                     Z-ADD*ZERO     $HC7PR           Ded Line 1 USR
     C                     Z-ADD*ZERO     $HU6PR           Head Amount 1 U
     C                     Z-ADDA1ASPR    $HASPR           TH Deduction Am
     C                     Z-ADDA1AVPC    $HAVPC           TH Std Yield Pe
     C                     Z-ADDA1A8PC    $HA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $HA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    $HB8PR           TH CM Market Pr
     C                     Z-ADDA1A4VA    $HA4VA           TH Total Net WO
     C                     MOVEL*BLANK    $HGXTX           Ded Line 2 Desc
     C                     Z-ADD*ZERO     $HC9PR           Ded Line 2 USR
     C                     Z-ADD*ZERO     $HU7PR           Head Amount 2 U
     C                     Z-ADDA1A5VA    $HA5VA           TH Additions Am
     C                     Z-ADDA1HGNB    $HHGNB           TH Shipped Weig
     C                     Z-ADDA1F3NB    $HF3NB           TH Avg Loin Eye
     C                     MOVEL*BLANK    $HGYTX           Ded Line 3 Desc
     C                     Z-ADD*ZERO     $HC6PR           Ded Line 3 USR
     C                     Z-ADD*ZERO     $HU8PR           Head Amount 3 U
     C                     Z-ADDA1HINB    $HHINB           TH FFLI
     C                     MOVEL*BLANK    $HGZTX           Ded Line 4 Desc
     C                     Z-ADD*ZERO     $HC8PR           Ded Line 4 USR
     C                     Z-ADD*ZERO     $HU9PR           Head Amount 4 U
     C                     Z-ADDA1MCNF    $HMCNF           TH Avg Backfat
     C                     MOVEL*BLANK    $HG0TX           Ded Line 5 Desc
     C                     Z-ADD*ZERO     $HC5PR           Ded Line 5 USR
     C                     Z-ADD*ZERO     $HVAPR           Head Amount 5 U
     C                     MOVEL*BLANK    $HG1TX           Ded Line 6 Desc
     C                     Z-ADD*ZERO     $HEIPR           Ded Line 6 USR
     C                     Z-ADD*ZERO     $HVBPR           Head Amount 6 U
     C                     Z-ADDA1MVNF    $HMVNF           TH Avg Loin Eye
     C                     MOVEL*BLANK    $HHETX           Ded Line 7 Desc
     C                     Z-ADD*ZERO     $HELPR           Ded Line 7 USR
     C                     Z-ADD*ZERO     $HVCPR           Head Amount 7 U
     C                     MOVEL*BLANK    $HHFTX           Ded Line 8 Desc
     C                     Z-ADD*ZERO     $HEMPR           Ded Line 8 USR
     C                     Z-ADD*ZERO     $HVDPR           Head Amount 8 U
     C                     Z-ADDA1ATPR    $HATPR           TH Carcass Net
     C                     MOVEL*BLANK    $HDVCD           Lean Rng Hdg 1
     C                     MOVEL*BLANK    $HDWCD           Lean Rng Hdg 2
     C                     MOVEL*BLANK    $HDXCD           Lean Rng Hdg 3
     C                     MOVEL*BLANK    $HDYCD           Lean Rng Hdg 4
     C                     MOVEL*BLANK    $HDZCD           Lean Rng Hdg 5
     C                     MOVEL*BLANK    $HD0CD           Lean Rng Hdg 6
     C                     MOVEL*BLANK    $HD1CD           Lean Rng Hdg 7
     C                     MOVEL*BLANK    $HD2CD           Lean Rng Hdg 8
     C                     MOVEL*BLANK    $HNBCD           Lean Rng Hdg TO
     C                     Z-ADD*ZERO     $HM2NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM3NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM4NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM5NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM6NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM7NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM8NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM9NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HLQA1           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HDDPC           Lean Rng Tto Pc
     C                     Z-ADD*ZERO     $HDEPC           Lean Rng Tto Pc
     C                     Z-ADD*ZERO     $HDFPC           Lean Rng Tto Pc
     C                     Z-ADD*ZERO     $HDGPC           Lean Rng Tto Pc
     C                     Z-ADD*ZERO     $HDHPC           Lean Rng Tto Pc
     C                     Z-ADD*ZERO     $HDIPC           Lean Rng Tto Pc
     C                     Z-ADD*ZERO     $HDJPC           Lean Rng Tto Pc
     C                     Z-ADD*ZERO     $HDKPC           Lean Rng Tto Pc
     C                     Z-ADD*ZERO     $HNANB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNBNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNCNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNDNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNENB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNFNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNGNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNHNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HLRA1           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HDLPC           Lean Rng Prd Pc
     C                     Z-ADD*ZERO     $HDMPC           Lean Rng Prd Pc
     C                     Z-ADD*ZERO     $HDNPC           Lean Rng Prd Pc
     C                     Z-ADD*ZERO     $HDOPC           Lean Rng Prd Pc
     C                     Z-ADD*ZERO     $HDPPC           Lean Rng Prd Pc
     C                     Z-ADD*ZERO     $HDQPC           Lean Rng Prd Pc
     C                     Z-ADD*ZERO     $HDRPC           Lean Rng Prd Pc
     C                     Z-ADD*ZERO     $HDSPC           Lean Rng Prd Pc
     C                     Z-ADD*ZERO     $HCHDT           PY As of Kill D
     C                     Z-ADDA1CXNB    $HCXNB           TH Dead On Arri
     C                     Z-ADDA1FCNB    $HFCNB           TH Yard Deads
     C                     Z-ADDA1FDNB    $HFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     $HMHNB           CWL Min Adj Liv
     C                     Z-ADD*ZERO     $HMINB           CWL Max Adj Liv
     C                     MOVEL*BLANK    $HG3TX           Reason 1 Desc U
     C                     Z-ADD*ZERO     $HMRNB           Reason Head 1 U
     C                     MOVEL*BLANK    $HG9TX           Reason 2 Desc U
     C                     Z-ADD*ZERO     $HMSNB           Reason Head 2 U
     C                     MOVEL*BLANK    $HHATX           Reason 3 Desc U
     C                     Z-ADD*ZERO     $HMTNB           Reason Head 3 U
     C                     MOVEL*BLANK    $HHKTX           Yield NA WK USR
     C                     MOVEL*BLANK    $HHRTX           Yield Top X WK
     C                     MOVEL*BLANK    $HHTTX           Yield Mid Hi X
     C                     MOVEL*BLANK    $HHSTX           Yield Mid Low X
     C                     MOVEL*BLANK    $HHUTX           Yield Lower X W
     C                     MOVEL*BLANK    $HHBTX           Reason 4 Desc U
     C                     Z-ADD*ZERO     $HMUNB           Reason Head 4 U
     C                     MOVEL*BLANK    $HHJTX           Lean% NA WK USR
     C                     MOVEL*BLANK    $HHNTX           Lean% Top X WK
     C                     MOVEL*BLANK    $HHPTX           Lean% Mid Hi X
     C                     MOVEL*BLANK    $HHOTX           Lean% Mid Low X
     C                     MOVEL*BLANK    $HHQTX           Lean% Lower X W
     C                     MOVEL*BLANK    $HHCTX           Reason 5 Desc U
     C                     Z-ADD*ZERO     $HMVNB           Reason Head 5 U
     C                     MOVEL*BLANK    $HHLTX           Lean Prm NA WK
     C                     MOVEL*BLANK    $HHVTX           Lean Prm Top X
     C                     MOVEL*BLANK    $HHXTX           Lean Prm Mid Hi
     C                     MOVEL*BLANK    $HHWTX           Lean Prm Mid Lo
     C                     MOVEL*BLANK    $HHYTX           Lean Prm Lower
     C                     MOVEL*BLANK    $HHMTX           Sort Dsc NA WK
     C                     MOVEL*BLANK    $HHZTX           Sort Dsc Top X
     C                     MOVEL*BLANK    $HH1TX           Sort Dsc Mid Hi
     C                     MOVEL*BLANK    $HH0TX           Sort Dsc Mid Lo
     C                     MOVEL*BLANK    $HH2TX           Sort Dsc Lower
     C                     MOVEL*BLANK    $HONTX           Trim 1 Desc Crc
     C                     Z-ADD*ZERO     $HMWNB           Trim Head 1 USR
     C                     MOVEL*BLANK    $HOTTX           Trim 2 Desc Crc
     C                     Z-ADD*ZERO     $HMXNB           Trim Head 2 USR
     C                     MOVEL*BLANK    $HOUTX           Trim 3 Desc Crc
     C                     Z-ADD*ZERO     $HMYNB           Trim Head 3 USR
     C                     MOVEL*BLANK    $HOVTX           Trim 4 Desc Crc
     C                     Z-ADD*ZERO     $HMZNB           Trim Head 4 USR
     C                     MOVEL*BLANK    $HOWTX           Trim 5 Desc Crc
     C                     Z-ADD*ZERO     $HM0NB           Trim Head 5 USR
     C                     MOVEL*BLANK    $HOXTX           Trim 6 Desc Crc
     C                     Z-ADD*ZERO     $HTRHD           Trim Head 6 USR
     C                     Z-ADD*ZERO     $HH3NB           Weight Tot USR
     C                     Z-ADDA1HENB    $HHENB           TH Head Adds
     C                     Z-ADDA1J9NB    $HJ9NB           TH Head Exclude
     C                     Z-ADDA1IORP    $HIORP           TH Head Adjuste
     C                     MOVEL*BLANK    $HP3TX           Desc 15 USR
     C                     Z-ADDA1OWEO    $HOWEO           TH PHA Head Add
     C                     MOVEL*BLANK    $HI1TX           Condition Name
     C                     Z-ADDA1HHPC    $HHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $HS9PR           TH PHA Lean Prm
     C                     MOVEL*BLANK    $HODTX           Text Usr 1
     C                     Z-ADDA1BNNB    $HBNNB           BOH Buy Order N
     C                     Z-ADDA1OXNB    $HOXNB           TH HPS Movement
     C                     MOVELA1BICD    $HBICD           TH Group Refere
     C                     Z-ADDA1CBPR    $HCBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    $HCCPR           Th Payment Net
     C                     Z-ADDA1LPNB    $HLPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $HCDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $HA7VA           TH Accrual Amou
     C                     MOVELA1CWST    $HCWST           TH Payment Sts
     C                     MOVELA1D7ST    $HD7ST           TH Header Error
     C                     MOVELA1D8ST    $HD8ST           TH Detail Error
     C                     MOVELA1DWST    $HDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $HD6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $HGHNB           TH Commission A
     C                     Z-ADDA1BYDT    $HBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $HE0ST           TH User Error O
     C                     MOVELA1E1ST    $HE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $HE2ST           TH Sex
     C                     Z-ADDA1BSDT    $HBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $HBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $HBUDT           TH Actual Check
     C                     Z-ADDA1HHNB    $HHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1A3PR    $HA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $HA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $HA6PR           TH Render Produ
     C                     MOVELA1AGCD    $HAGCD           GN Genetic Code
     C                     MOVELA1BECD    $HBECD           HC Class Code
     C                     MOVELA1BDCD    $HBDCD           DF Defect Code
     C                     MOVELA1CSCD    $HCSCD           THP Process Cod
     C                     MOVELA1AECD    $HAECD           PL Location Cod
      * USER: Process before print of detail format
      * CUR = PAR By name
     C                     Z-ADDP1HMNB    $HHMNB           BOH Company Num
     C                     Z-ADDP1BONB    $HBONB           BOL Load Number
     C                     Z-ADDP1CVNB    $HCVNB           TH Tattoo Numbe
     C                     MOVELP2DVCD    $HDVCD           Lean Rng Hdg 1
     C                     MOVELP2DWCD    $HDWCD           Lean Rng Hdg 2
     C                     MOVELP2DXCD    $HDXCD           Lean Rng Hdg 3
     C                     MOVELP2DYCD    $HDYCD           Lean Rng Hdg 4
     C                     MOVELP2DZCD    $HDZCD           Lean Rng Hdg 5
     C                     MOVELP2D0CD    $HD0CD           Lean Rng Hdg 6
     C                     MOVELP2D1CD    $HD1CD           Lean Rng Hdg 7
     C                     MOVELP2D2CD    $HD2CD           Lean Rng Hdg 8
     C                     Z-ADDP1BNNB    $HBNNB           BOH Buy Order N
      * Mve Parm to Another Parm - Tattoo Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0003    WL0001           TH Purchase Dat
     C                     MOVELYL0004    WL0002    P      TH Group Refere
     C                     MOVELYL0005    WL0003    P      TH Live Purchas
     C                     Z-ADDYL0006    WL0004           TH Live Purchas
     C                     Z-ADDYL0007    WL0005           TH Live Gross A
     C                     Z-ADDYL0008    WL0006           TH LIve Net Amt
     C                     MOVELYL0009    WL0007    P      TH Resale UOM
     C                     Z-ADDYL0010    WL0008           TH Recalc Live
     C                     Z-ADDYL0011    WL0009           TH Pricing Date
     C                     MOVELYL0012    WL0010    P      TH Resale Sprea
     C                     Z-ADDYL0013    WL0011           TH Dead On Arri
     C                     Z-ADDYL0014    WL0012           TH Head Receive
     C                     Z-ADDYL0015    WL0013           TH Yard Deads
     C                     Z-ADDYL0016    WL0014           TH Held Over
     C                     Z-ADDYL0017    WL0015           TH Head Condemn
     C                     Z-ADDYL0018    WL0016           TH Head Killed
     C                     Z-ADDYL0019    WL0017           TH Head Adds
     C                     Z-ADDYL0020    WL0018           TH Head Accepte
     C                     Z-ADDYL0021    WL0019           TH Live Wgt
     C                     Z-ADDYL0022    WL0020           TH Adj Live Wgt
     C                     Z-ADDYL0023    WL0021           TH Hot Wgt
     C                     Z-ADDYL0024    WL0022           TH Tot Loin Eye
     C                     Z-ADDYL0025    WL0023           TH Tot Backfat
     C                     Z-ADDYL0026    WL0024           TH Tot Light Re
     C                     Z-ADDYL0027    WL0025           TH Avg Live Wgt
     C                     Z-ADDYL0028    WL0026           TH Avg Hot Wgt
     C                     Z-ADDYL0029    WL0027           TH Avg Light Re
     C                     Z-ADDYL0030    WL0028           TH Avg Lean Per
     C                     Z-ADDYL0031    WL0029           TH Avg Loin Eye
     C                     Z-ADDYL0032    WL0030           TH Avg Backfat
     C                     Z-ADDYL0033    WL0031           TH Std Yield Pe
     C                     Z-ADDYL0034    WL0032           TH Actual Yield
     C                     Z-ADDYL0035    WL0033           TH Adj Actual Y
     C                     Z-ADDYL0036    WL0034           TH Yield Differ
     C                     Z-ADDYL0037    WL0035           TH Recalc Live
     C                     Z-ADDYL0038    WL0036           TH CM Market Pr
     C                     Z-ADDYL0039    WL0037           TH CM Base Mkt
     C                     Z-ADDYL0040    WL0038           TH CM Base Mkt
     C                     Z-ADDYL0041    WL0039           TH CM Sort Disc
     C                     Z-ADDYL0042    WL0040           TH CM Yield Gai
     C                     Z-ADDYL0043    WL0041           TH CM Base Carc
     C                     Z-ADDYL0044    WL0042           TH CM LN AddOn/
     C                     Z-ADDYL0045    WL0043           TH CM Carcass G
     C                     Z-ADDYL0046    WL0044           TH Deduction Am
     C                     Z-ADDYL0047    WL0045           TH Total Net WO
     C                     Z-ADDYL0048    WL0046           TH Carcass Net
     C                     Z-ADDYL0049    WL0047           TH Additions Am
     C                     Z-ADDYL0050    WL0048           TH Payment Gros
     C                     Z-ADDYL0051    WL0049           Th Payment Net
     C                     Z-ADDYL0052    WL0050           TH AP Voucher/D
     C                     Z-ADDYL0053    WL0051           TH Freight Amou
     C                     Z-ADDYL0054    WL0052           TH Accrual Amou
     C                     Z-ADDYL0055    WL0053           TH Fixed Cost A
     C                     MOVELYL0056    WL0054    P      TH Calc Net Sts
     C                     MOVELYL0057    WL0055    P      TH Payment Sts
     C                     MOVELYL0058    WL0056    P      TH Header Error
     C                     MOVELYL0059    WL0057    P      TH Detail Error
     C                     MOVELYL0060    WL0058    P      TH Kill Balanci
     C                     MOVELYL0061    WL0059    P      TH Bal to Kill
     C                     Z-ADDYL0062    WL0060           TH Commission A
     C                     Z-ADDYL0063    WL0061           TH Voucher Paym
     C                     MOVELYL0064    WL0062    P      TH User Error O
     C                     MOVELYL0065    WL0063    P      TH Held Over Re
     C                     MOVELYL0066    WL0064    P      TH Sex
     C                     Z-ADDYL0067    WL0065           TH Held/Ovr Com
     C                     Z-ADDYL0068    WL0066           TH Commission P
     C                     Z-ADDYL0069    WL0067           TH Actual Check
     C                     Z-ADDYL0070    WL0068           TH Shipped Weig
     C                     Z-ADDYL0071    WL0069           TH Avg Hot Wgt
     C                     Z-ADDYL0072    WL0070           TH FFLI
     C                     Z-ADDYL0073    WL0071           TH Kill Product
     C                     Z-ADDYL0074    WL0072           TH Cut Product
     C                     Z-ADDYL0075    WL0073           TH Render Produ
     C                     Z-ADDYL0076    WL0074           TH Head Exclude
     C                     Z-ADDYL0077    WL0075           TH CM Bse Mkt L
     C                     Z-ADDYL0078    WL0076           TH CM Bse Mkt C
     C                     Z-ADDYL0079    WL0077           TH CM Srt Dsc L
     C                     Z-ADDYL0080    WL0078           TH CM Srt Dsc C
     C                     Z-ADDYL0081    WL0079           TH CM Yld G/L L
     C                     Z-ADDYL0082    WL0080           TH CM Yld G/L C
     C                     Z-ADDYL0083    WL0081           TH CM Crc Val L
     C                     Z-ADDYL0084    WL0082           TH CM Crc Val C
     C                     Z-ADDYL0085    WL0083           TH CM Lean Prem
     C                     Z-ADDYL0086    WL0084           TH CM Lean Prem
     C                     Z-ADDYL0087    WL0085           TH CM Gross Liv
     C                     Z-ADDYL0088    WL0086           TH CM Gross Car
     C                     MOVELYL0089    WL0087    P      TH Source Type
     C                     MOVELYL0090    WL0088    P      TH Scale Ticket
     C                     MOVELYL0091    WL0089    P      TH Payment Type
     C                     Z-ADDYL0092    WL0090           TH HPS Movement
     C                     MOVELYL0093    WL0091    P      TH Source Code
     C                     MOVELYL0094    WL0092    P      TH Hog Class Ty
     C                     MOVELYL0095    WL0093    P      TH Posted to HP
     C                     MOVELYL0096    WL0094    P      TH Schedule Kil
     C                     MOVELYL0097    WL0095    P      TH Shift Held O
     C                     MOVELYL0098    WL0096    P      TH State
     C                     MOVELYL0099    WL0097    P      TH Unused Code
     C                     MOVELYL0100    WL0098    P      TH Unused Sts 2
     C                     MOVELYL0101    WL0099    P      TH Commission S
     C                     MOVELYL0102    WL0100    P      TH Paid 2 Week
     C                     MOVELYL0103    WL0101    P      TH Unused Sts 1
     C                     Z-ADDYL0104    WL0102           TH DOA Weight
     C                     Z-ADDYL0105    WL0103           TH Avg Lean % E
     C                     Z-ADDYL0106    WL0104           TH HPS Farm Sit
     C                     Z-ADDYL0107    WL0105           TH Shift Held O
     C                     Z-ADDYL0108    WL0106           TH Sorting Amou
     C                     Z-ADDYL0109    WL0107           TH Head Identif
     C                     Z-ADDYL0110    WL0108           TH Percent Iden
     C                     Z-ADDYL0111    WL0109           TH Percent Acce
     C                     Z-ADDYL0112    WL0110           TH Head Adjuste
     C                     Z-ADDYL0113    WL0111           TH PHA Head Add
     C                     MOVELYL0114    WL0112    P      TH PHA Add Type
     C                     MOVELYL0115    WL0113    P      TH PHA Average
     C                     MOVELYL0116    WL0114    P      TH PHA Add Reas
     C                     Z-ADDYL0117    WL0115           TH PHA Yield Pe
     C                     Z-ADDYL0118    WL0116           TH PHA Lean Prm
     C                     Z-ADDYL0119    WL0117           TH VC Gross Val
     C                     Z-ADDYL0120    WL0118           TH Excluded Gro
     C                     Z-ADDYL0121    WL0119           TH Avg Lean %
     C                     Z-ADDYL0122    WL0120           TH Broken Back
     C                     Z-ADDYL0123    WL0121           TH Hot Scl Uplo
     C                     Z-ADDYL0124    WL0122           TH Unused Nbr 4
     C                     Z-ADDYL0125    WL0123           TH Excluded Car
     C                     Z-ADDYL0126    WL0124           TH Excluded Pre
     C                     Z-ADDYL0127    WL0125           TH Unused Nbr 7
     C                     Z-ADDYL0128    WL0126           TH Unused Nbr 8
     C                     Z-ADDYL0129    WL0127           TH Unused Nbr 9
     C                     Z-ADDYL0130    WL0128           TH Unused Nbr 1
     C                     Z-ADDYL0131    WL0129           TH Break Even P
     C                     Z-ADDYL0132    WL0130           TH Meat Value F
     C                     Z-ADDYL0133    WL0131           TH Yld Parm Adj
     C                     Z-ADDYL0134    WL0132           TH PHA Sort Dis
     C                     Z-ADDYL0135    WL0133           TH Avg Loin Eye
     C                     Z-ADDYL0136    WL0134           TH Avg Backfat
     C                     Z-ADDYL0137    WL0135           TH HITCH Old Pa
     C                     Z-ADDYL0138    WL0136           TH MPR Sort Los
     C                     Z-ADDYL0139    WL0137           TH Unused Nbr 1
     C                     Z-ADDYL0140    WL0138           TH Unused Nbr 2
     C                     Z-ADDYL0141    WL0139           TH Cold Scl Upl
     C                     Z-ADDYL0142    WL0140           TH Cold Scl Upl
     C                     MOVELYL0143    WL0141    P      DF Defect Code
     C                     MOVELYL0144    WL0142    P      THP Process Cod
     C                     MOVELYL0145    WL0143    P      PD Producer Cod
     C                     MOVELYL0146    WL0144    P      PL Location Cod
     C                     MOVELYL0147    WL0145    P      HB Buyer Code
     C                     MOVELYL0148    WL0146    P      GN Genetic Code
     C                     MOVELYL0149    WL0147    P      HC Class Code
     C                     EXSR SFINFN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0148    $HAWDT           TH Purchase Dat
     C                     MOVELWL0149    $HBICD    P      TH Group Refere
     C                     MOVELWL0150    $HCPST    P      TH Live Purchas
     C                     Z-ADDWL0151    $HACPR           TH Live Purchas
     C                     Z-ADDWL0152    $HB9PR           TH Live Gross A
     C                     Z-ADDWL0153    $HCAPR           TH LIve Net Amt
     C                     MOVELWL0154    $HC4ST    P      TH Resale UOM
     C                     Z-ADDWL0155    $HAIPR           TH Recalc Live
     C                     Z-ADDWL0156    $HA6DT           TH Pricing Date
     C                     MOVELWL0157    $HC2ST    P      TH Resale Sprea
     C                     Z-ADDWL0158    $HCXNB           TH Dead On Arri
     C                     Z-ADDWL0159    $HCWNB           TH Head Receive
     C                     Z-ADDWL0160    $HFCNB           TH Yard Deads
     C                     Z-ADDWL0161    $HH9NB           TH Held Over
     C                     Z-ADDWL0162    $HFDNB           TH Head Condemn
     C                     Z-ADDWL0163    $HFENB           TH Head Killed
     C                     Z-ADDWL0164    $HHENB           TH Head Adds
     C                     Z-ADDWL0165    $HHFNB           TH Head Accepte
     C                     Z-ADDWL0166    $HCYNB           TH Live Wgt
     C                     Z-ADDWL0167    $HLRNB           TH Adj Live Wgt
     C                     Z-ADDWL0168    $HE0NB           TH Hot Wgt
     C                     Z-ADDWL0169    $HA5PC           TH Tot Loin Eye
     C                     Z-ADDWL0170    $HFBNB           TH Tot Backfat
     C                     Z-ADDWL0171    $HA4PC           TH Tot Light Re
     C                     Z-ADDWL0172    $HF7NB           TH Avg Live Wgt
     C                     Z-ADDWL0173    $HHDNB           TH Avg Hot Wgt
     C                     Z-ADDWL0174    $HF5NB           TH Avg Light Re
     C                     Z-ADDWL0175    $HF4NB           TH Avg Lean Per
     C                     Z-ADDWL0176    $HF3NB           TH Avg Loin Eye
     C                     Z-ADDWL0177    $HF2NB           TH Avg Backfat
     C                     Z-ADDWL0178    $HAVPC           TH Std Yield Pe
     C                     Z-ADDWL0179    $HAWPC           TH Actual Yield
     C                     Z-ADDWL0180    $HCWPC           TH Adj Actual Y
     C                     Z-ADDWL0181    $HA8PC           TH Yield Differ
     C                     Z-ADDWL0182    $HA7PC           TH Recalc Live
     C                     Z-ADDWL0183    $HB8PR           TH CM Market Pr
     C                     Z-ADDWL0184    $HAMPR           TH CM Base Mkt
     C                     Z-ADDWL0185    $HANPR           TH CM Base Mkt
     C                     Z-ADDWL0186    $HAYVA           TH CM Sort Disc
     C                     Z-ADDWL0187    $HAWVA           TH CM Yield Gai
     C                     Z-ADDWL0188    $HAOPR           TH CM Base Carc
     C                     Z-ADDWL0189    $HAXVA           TH CM LN AddOn/
     C                     Z-ADDWL0190    $HAPPR           TH CM Carcass G
     C                     Z-ADDWL0191    $HASPR           TH Deduction Am
     C                     Z-ADDWL0192    $HA4VA           TH Total Net WO
     C                     Z-ADDWL0193    $HATPR           TH Carcass Net
     C                     Z-ADDWL0194    $HA5VA           TH Additions Am
     C                     Z-ADDWL0195    $HCBPR           TH Payment Gros
     C                     Z-ADDWL0196    $HCCPR           Th Payment Net
     C                     Z-ADDWL0197    $HLPNB           TH AP Voucher/D
     C                     Z-ADDWL0198    $HCDPR           TH Freight Amou
     C                     Z-ADDWL0199    $HA7VA           TH Accrual Amou
     C                     Z-ADDWL0200    $HA2PR           TH Fixed Cost A
     C                     MOVELWL0201    $HJWST    P      TH Calc Net Sts
     C                     MOVELWL0202    $HCWST    P      TH Payment Sts
     C                     MOVELWL0203    $HD7ST    P      TH Header Error
     C                     MOVELWL0204    $HD8ST    P      TH Detail Error
     C                     MOVELWL0205    $HDWST    P      TH Kill Balanci
     C                     MOVELWL0206    $HD6ST    P      TH Bal to Kill
     C                     Z-ADDWL0207    $HGHNB           TH Commission A
     C                     Z-ADDWL0208    $HBYDT           TH Voucher Paym
     C                     MOVELWL0209    $HE0ST    P      TH User Error O
     C                     MOVELWL0210    $HE1ST    P      TH Held Over Re
     C                     MOVELWL0211    $HE2ST    P      TH Sex
     C                     Z-ADDWL0212    $HBSDT           TH Held/Ovr Com
     C                     Z-ADDWL0213    $HBTDT           TH Commission P
     C                     Z-ADDWL0214    $HBUDT           TH Actual Check
     C                     Z-ADDWL0215    $HHGNB           TH Shipped Weig
     C                     Z-ADDWL0216    $HHHNB           TH Avg Hot Wgt
     C                     Z-ADDWL0217    $HHINB           TH FFLI
     C                     Z-ADDWL0218    $HA3PR           TH Kill Product
     C                     Z-ADDWL0219    $HA4PR           TH Cut Product
     C                     Z-ADDWL0220    $HA6PR           TH Render Produ
     C                     Z-ADDWL0221    $HJ9NB           TH Head Exclude
     C                     Z-ADDWL0222    $HD6PR           TH CM Bse Mkt L
     C                     Z-ADDWL0223    $HD7PR           TH CM Bse Mkt C
     C                     Z-ADDWL0224    $HD8PR           TH CM Srt Dsc L
     C                     Z-ADDWL0225    $HD9PR           TH CM Srt Dsc C
     C                     Z-ADDWL0226    $HEAPR           TH CM Yld G/L L
     C                     Z-ADDWL0227    $HEBPR           TH CM Yld G/L C
     C                     Z-ADDWL0228    $HECPR           TH CM Crc Val L
     C                     Z-ADDWL0229    $HEDPR           TH CM Crc Val C
     C                     Z-ADDWL0230    $HEEPR           TH CM Lean Prem
     C                     Z-ADDWL0231    $HEFPR           TH CM Lean Prem
     C                     Z-ADDWL0232    $HEGPR           TH CM Gross Liv
     C                     Z-ADDWL0233    $HEHPR           TH CM Gross Car
     C                     MOVELWL0234    $HKAST    P      TH Source Type
     C                     MOVELWL0235    $HJ7ST    P      TH Scale Ticket
     C                     MOVELWL0236    $HJ9ST    P      TH Payment Type
     C                     Z-ADDWL0237    $IOXNB           TH HPS Movement
     C                     MOVELWL0238    $HLKST    P      TH Source Code
     C                     MOVELWL0239    $HLLST    P      TH Hog Class Ty
     C                     MOVELWL0240    $HJ8ST    P      TH Posted to HP
     C                     MOVELWL0241    $HLIST    P      TH Schedule Kil
     C                     MOVELWL0242    $HLJST    P      TH Shift Held O
     C                     MOVELWL0243    YN0020    P      TH State
     C                     MOVELWL0244    YN0021    P      TH Unused Code
     C                     MOVELWL0245    YN0022    P      TH Unused Sts 2
     C                     MOVELWL0246    YN0023    P      TH Commission S
     C                     MOVELWL0247    YN0024    P      TH Paid 2 Week
     C                     MOVELWL0248    YN0025    P      TH Unused Sts 1
     C                     Z-ADDWL0249    YN0026           TH DOA Weight
     C                     Z-ADDWL0250    YN0027           TH Avg Lean % E
     C                     Z-ADDWL0251    YN0028           TH HPS Farm Sit
     C                     Z-ADDWL0252    YN0029           TH Shift Held O
     C                     Z-ADDWL0253    YN0030           TH Sorting Amou
     C                     Z-ADDWL0254    YN0031           TH Head Identif
     C                     Z-ADDWL0255    YN0032           TH Percent Iden
     C                     Z-ADDWL0256    YN0033           TH Percent Acce
     C                     Z-ADDWL0257    $HIORP           TH Head Adjuste
     C                     Z-ADDWL0258    $HOWEO           TH PHA Head Add
     C                     MOVELWL0259    YN0034    P      TH PHA Add Type
     C                     MOVELWL0260    YN0035    P      TH PHA Average
     C                     MOVELWL0261    YN0036    P      TH PHA Add Reas
     C                     Z-ADDWL0262    $HHHPC           TH PHA Yield Pe
     C                     Z-ADDWL0263    $HS9PR           TH PHA Lean Prm
     C                     Z-ADDWL0264    YN0037           TH VC Gross Val
     C                     Z-ADDWL0265    $HTBPR           TH Excluded Gro
     C                     Z-ADDWL0266    YN0038           TH Avg Lean %
     C                     Z-ADDWL0267    YN0039           TH Broken Back
     C                     Z-ADDWL0268    YN0040           TH Hot Scl Uplo
     C                     Z-ADDWL0269    YN0041           TH Unused Nbr 4
     C                     Z-ADDWL0270    YN0042           TH Excluded Car
     C                     Z-ADDWL0271    YN0043           TH Excluded Pre
     C                     Z-ADDWL0272    YN0044           TH Unused Nbr 7
     C                     Z-ADDWL0273    YN0045           TH Unused Nbr 8
     C                     Z-ADDWL0274    YN0046           TH Unused Nbr 9
     C                     Z-ADDWL0275    YN0047           TH Unused Nbr 1
     C                     Z-ADDWL0276    YN0048           TH Break Even P
     C                     Z-ADDWL0277    YN0049           TH Meat Value F
     C                     Z-ADDWL0278    YN0050           TH Yld Parm Adj
     C                     Z-ADDWL0279    $HOMVJ           TH PHA Sort Dis
     C                     Z-ADDWL0280    $HMVNF           TH Avg Loin Eye
     C                     Z-ADDWL0281    $HMCNF           TH Avg Backfat
     C                     Z-ADDWL0282    YN0051           TH HITCH Old Pa
     C                     Z-ADDWL0283    YN0052           TH MPR Sort Los
     C                     Z-ADDWL0284    YN0053           TH Unused Nbr 1
     C                     Z-ADDWL0285    YN0054           TH Unused Nbr 2
     C                     Z-ADDWL0286    YN0055           TH Cold Scl Upl
     C                     Z-ADDWL0287    YN0056           TH Cold Scl Upl
     C                     MOVELWL0288    $HBDCD    P      DF Defect Code
     C                     MOVELWL0289    $HCSCD    P      THP Process Cod
     C                     MOVELWL0290    $HABCD    P      PD Producer Cod
     C                     MOVELWL0291    $HAECD    P      PL Location Cod
     C                     MOVELWL0292    $HACCD    P      HB Buyer Code
     C                     MOVELWL0293    $HAGCD    P      GN Genetic Code
     C                     MOVELWL0294    $HBECD    P      HC Class Code
      * CASE: PAR.Status 3 is Yes
     C           P8SVST    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0138    $HAYVA           TH CM Sort Disc
     C                     END                             *FI
      * Rtv Carcass Sum Info  RT - Buy Order Header  * 
     C                     EXSR SORVGN
      * Analysis fields into payment fields
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           P3MVST    IFEQ 'Y'                        *IF
      * Rtv Tattoo Hdr Ext    XF - Tattoo Header EXT  * 
     C                     CLEARPARC
     C                     Z-ADD$HHMNB    PAHMNB           BOH Company Num
     C                     Z-ADD$HBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADD$HBONB    PABONB           BOL Load Number
     C                     Z-ADD$HCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADD$HB0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKAWXFR'              90  Rtv Tattoo Hdr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
     C           $HB8PR    PARM $HB8PR    WQ0060  52       TH CM Market Pr
     C           $HAMPR    PARM $HAMPR    WQ0061  52       TH CM Base Mkt
     C           $HANPR    PARM $HANPR    WQ0062  72       TH CM Base Mkt
     C           $HAYVA    PARM $HAYVA    WQ0063  72       TH CM Sort Disc
     C           $HAWVA    PARM $HAWVA    WQ0064  72       TH CM Yield Gai
     C           $HAOPR    PARM $HAOPR    WQ0065  72       TH CM Base Carc
     C           $HAXVA    PARM $HAXVA    WQ0066  72       TH CM LN AddOn/
     C           $HAPPR    PARM $HAPPR    WQ0067  72       TH CM Carcass G
     C           $HD6PR    PARM $HD6PR    WQ0068  52       TH CM Bse Mkt L
     C           $HD7PR    PARM $HD7PR    WQ0069  52       TH CM Bse Mkt C
     C           $HD8PR    PARM $HD8PR    WQ0070  52       TH CM Srt Dsc L
     C           $HD9PR    PARM $HD9PR    WQ0071  52       TH CM Srt Dsc C
     C           $HEAPR    PARM $HEAPR    WQ0072  52       TH CM Yld G/L L
     C           $HEBPR    PARM $HEBPR    WQ0073  52       TH CM Yld G/L C
     C           $HECPR    PARM $HECPR    WQ0074  52       TH CM Crc Val L
     C           $HEDPR    PARM $HEDPR    WQ0075  52       TH CM Crc Val C
     C           $HEEPR    PARM $HEEPR    WQ0076  52       TH CM Lean Prem
     C           $HEFPR    PARM $HEFPR    WQ0077  52       TH CM Lean Prem
     C           $HEGPR    PARM $HEGPR    WQ0078  52       TH CM Gross Liv
     C           $HEHPR    PARM $HEHPR    WQ0079  52       TH CM Gross Car
     C           W0RTN     PARM W0RTN     WQ0080  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAWXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Live/Carcass Merit Payment/Comparison
      * CASE: PAR.Print Comp Sum/Dtl STS is Yes
     C           P8TOST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Payment Type is Live
      *   |- c2    : PAR.Print Live as Carcass USR is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           A1J9ST    IFEQ 'L'                        *IF
     C           P3MVST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0006    $HAMPR           TH CM Base Mkt
     C                     Z-ADDYL0050    $HAPPR           TH CM Carcass G
     C                     Z-ADDYL0051    $HATPR           TH Carcass Net
      * TH CM Gross Live /CWT
      * CASE: DB1.TH Live Wgt NE WRK.Zero USR
     C           A1CYNB    IFNE WUE9NB                     *IF
      * re-cal for live only CWT
      * CUR.TH CM Gross Live /CWT =
      *    *COMPUTE ((x1 / (x2 / x3)))
      * x1    : LCL.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0021    DIV  100       W0WD01           *Synon (17,7) w
     C           YL0050    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HEGPR           TH CM Gross Liv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $HEGPR           TH CM Gross Liv
     C                     END                             *FI
      * TH CM Gross Carc /CWT
      * CASE: DB1.TH Hot Wgt NE WRK.Zero USR
     C           A1E0NB    IFNE WUE9NB                     *IF
      * re-cal for live only CWT
      * CUR.TH CM Gross Carc /CWT =
      *    *COMPUTE ((x1 / (x2 / x3)))
      * x1    : LCL.TH Payment Gross
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0023    DIV  100       W0WD01           *Synon (17,7) w
     C           YL0050    DIV  W0WD01    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    $HEHPR           TH CM Gross Car
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $HEHPR           TH CM Gross Car
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Tattoo Deduction/Additions
      * CASE: PAR.Print Comp Sum/Dtl STS is No
     C           P8TOST    IFEQ 'N'                        *IF
      * 041415 slm Add new logic for head and unit of measure
      * Rtv Truck/Load        RT - Buy Order Load  * 
     C                     EXSR SPRVGN
      * Rtv Trucker Name - Trucker  * 
     C                     EXSR SQRVGN
      * Prt Crc Sum Ded/Add   UP - Tattoo Ded/Add  * 
     C                     CALL 'PLENUPR'              90  Prt Crc Sum Ded
     C           W0RTN     PARM W0RTN     WQ0081  7        @TXT 7 postions
     C                     PARM A1HMNB    WQ0082  30       BOH Company Num
     C                     PARM A1BNNB    WQ0083  50       BOH Buy Order N
     C                     PARM A1BONB    WQ0084  50       BOL Load Number
     C                     PARM A1CVNB    WQ0085  50       TH Tattoo Numbe
     C           $HGWTX    PARM $HGWTX    WQ0086 20        Ded Line 1 Desc
     C           $HGXTX    PARM $HGXTX    WQ0087 20        Ded Line 2 Desc
     C           $HGYTX    PARM $HGYTX    WQ0088 20        Ded Line 3 Desc
     C           $HGZTX    PARM $HGZTX    WQ0089 20        Ded Line 4 Desc
     C           $HG0TX    PARM $HG0TX    WQ0090 20        Ded Line 5 Desc
     C           $HG1TX    PARM $HG1TX    WQ0091 20        Ded Line 6 Desc
     C           $HHETX    PARM $HHETX    WQ0092 20        Ded Line 7 Desc
     C           $HHFTX    PARM $HHFTX    WQ0093 20        Ded Line 8 Desc
     C           $HC7PR    PARM $HC7PR    WQ0094  72       Ded Line 1 USR
     C           $HC9PR    PARM $HC9PR    WQ0095  72       Ded Line 2 USR
     C           $HC6PR    PARM $HC6PR    WQ0096  72       Ded Line 3 USR
     C           $HC8PR    PARM $HC8PR    WQ0097  72       Ded Line 4 USR
     C           $HC5PR    PARM $HC5PR    WQ0098  72       Ded Line 5 USR
     C           $HEIPR    PARM $HEIPR    WQ0099  72       Ded Line 6 USR
     C           $HELPR    PARM $HELPR    WQ0100  72       Ded Line 7 USR
     C           $HEMPR    PARM $HEMPR    WQ0101  72       Ded Line 8 USR
     C           WUK1A1    PARM *ZERO     WQ0102  72       Ded/Add /Head 1
     C           WUK2A1    PARM *ZERO     WQ0103  72       Ded/Add /Head 2
     C           WUK3A1    PARM *ZERO     WQ0104  72       Ded/Add /Head 3
     C           WUK4A1    PARM *ZERO     WQ0105  72       Ded/Add /Head 4
     C           WUK5A1    PARM *ZERO     WQ0106  72       Ded/Add /Head 5
     C           WUK6A1    PARM *ZERO     WQ0107  72       Ded/Add /Head 6
     C           WUK7A1    PARM *ZERO     WQ0108  72       Ded/Add /Head 7
     C           WUK8A1    PARM *ZERO     WQ0109  72       Ded/Add /Head 8
     C           WUY0ST    PARM *BLANK    WQ0110  2        Ded/Add UOM 1 U
     C           WUY1ST    PARM *BLANK    WQ0111  2        Ded/Add UOM 2 U
     C           WUY2ST    PARM *BLANK    WQ0112  2        Ded/Add UOM 3 U
     C           WUY3ST    PARM *BLANK    WQ0113  2        Ded/Add UOM 4 U
     C           WUY4ST    PARM *BLANK    WQ0114  2        Ded/Add UOM 5 U
     C           WUY5ST    PARM *BLANK    WQ0115  2        Ded/Add UOM 6 U
     C           WUY6ST    PARM *BLANK    WQ0116  2        Ded/Add UOM 7 U
     C           WUY7ST    PARM *BLANK    WQ0117  2        Ded/Add UOM 8 U
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLENUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: CUR.Ded Line 1 Desc USR EQ LCL.Ded Line 1 Desc USR
     C           $HGWTX    IFEQ YL0001                     *IF
     C                     MOVELYL0178    $HGWTX           Ded Line 1 Desc
     C                     ELSE
      * CASE: CUR.Ded Line 2 Desc USR EQ LCL.Ded Line 1 Desc USR
     C           $HGXTX    IFEQ YL0001                     *IF
     C                     MOVELYL0178    $HGXTX           Ded Line 2 Desc
     C                     ELSE
      * CASE: CUR.Ded Line 3 Desc USR EQ LCL.Ded Line 1 Desc USR
     C           $HGYTX    IFEQ YL0001                     *IF
     C                     MOVELYL0178    $HGYTX           Ded Line 3 Desc
     C                     ELSE
      * CASE: CUR.Ded Line 4 Desc USR EQ LCL.Ded Line 1 Desc USR
     C           $HGZTX    IFEQ YL0001                     *IF
     C                     MOVELYL0178    $HGZTX           Ded Line 4 Desc
     C                     ELSE
      * CASE: CUR.Ded Line 5 Desc USR EQ LCL.Ded Line 1 Desc USR
     C           $HG0TX    IFEQ YL0001                     *IF
     C                     MOVELYL0178    $HG0TX           Ded Line 5 Desc
     C                     ELSE
      * CASE: CUR.Ded Line 6 Desc USR EQ LCL.Ded Line 1 Desc USR
     C           $HG1TX    IFEQ YL0001                     *IF
     C                     MOVELYL0178    $HG1TX           Ded Line 6 Desc
     C                     ELSE
      * CASE: CUR.Ded Line 7 Desc USR EQ LCL.Ded Line 1 Desc USR
     C           $HHETX    IFEQ YL0001                     *IF
     C                     MOVELYL0178    $HHETX           Ded Line 7 Desc
     C                     ELSE
      * CASE: CUR.Ded Line 8 Desc USR EQ LCL.Ded Line 1 Desc USR
     C           $HHFTX    IFEQ YL0001                     *IF
     C                     MOVELYL0178    $HHFTX           Ded Line 8 Desc
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $HATPR           TH Carcass Net
     C                     END                             *FI
      * Carcass Merit Hogs
      * CASE: DB1.TH Payment Type is Carcass Merit
     C           A1J9ST    IFEQ 'C'                        *IF
      * Calculate Adjusted Live Weight
      * CASE: LCL.TH Head Killed is *Zeros
     C           YL0018    IFEQ *ZERO                      *IF
     C                     Z-ADDYL0027    WUU9NB           Adj Avg Live We
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0022    DIV  YL0018    WUU9NB           Adj Avg Live We
     C                     END                             *FI
      * Rtv Tattoo Lean Dist  RT - Crc Sum Tattoo Lean Dist  * 
     C                     EXSR SRRVGN
      * Tattoo %
      * CASE: LCL.TH Head Killed is Not Zero
     C           YL0018    IFNE *ZERO                      *IF
      * Tattoo % 1
      * CUR.Lean Rng Tto Pct 1 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Tto Cnt 1 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HM2NB    DIV  YL0018    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDDPC           Lean Rng Tto Pc
      * Tattoo % 2
      * CUR.Lean Rng Tto Pct 2 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Tto Cnt 2 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HM3NB    DIV  YL0018    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDEPC           Lean Rng Tto Pc
      * Tattoo % 3
      * CUR.Lean Rng Tto Pct 3 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Tto Cnt 3 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HM4NB    DIV  YL0018    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDFPC           Lean Rng Tto Pc
      * Tattoo % 4
      * CUR.Lean Rng Tto Pct 4 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Tto Cnt 4 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HM5NB    DIV  YL0018    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDGPC           Lean Rng Tto Pc
      * Tattoo % 5
      * CUR.Lean Rng Tto Pct 5 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Tto Cnt 5 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HM6NB    DIV  YL0018    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDHPC           Lean Rng Tto Pc
      * Tattoo % 6
      * CUR.Lean Rng Tto Pct 6 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Tto Cnt 6 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HM7NB    DIV  YL0018    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDIPC           Lean Rng Tto Pc
      * Tattoo % 7
      * CUR.Lean Rng Tto Pct 7 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Tto Cnt 7 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HM8NB    DIV  YL0018    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDJPC           Lean Rng Tto Pc
      * Tattoo % 8
      * CUR.Lean Rng Tto Pct 8 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Tto Cnt 8 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.TH Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HM9NB    DIV  YL0018    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDKPC           Lean Rng Tto Pc
     C                     END                             *FI
      * ** Producer YTD Lean Distribution **
      * Rtv Prd Lean Dist     RT - Crc Sum Prd Lean Dst YTD  * 
     C                     EXSR SSRVGN
      * Rtv Head Killed       RT - Crc Sum Prd          YTD  * 
     C                     EXSR STRVGN
      * Producer YTD %
      * CASE: PAR.PY Head Killed is Greater then Zero
     C           P8MFNB    IFGT *ZERO                      *IF
      * YTD % 1
      * CUR.Lean Rng Prd Pct 1 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Prd Cnt 1 USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.PY Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HNANB    DIV  P8MFNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDLPC           Lean Rng Prd Pc
      * YTD % 2
      * CUR.Lean Rng Prd Pct 2 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Prd Cnt 2 USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.PY Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HNBNB    DIV  P8MFNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDMPC           Lean Rng Prd Pc
      * YTD % 3
      * CUR.Lean Rng Prd Pct 3 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Prd Cnt 3 USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.PY Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HNCNB    DIV  P8MFNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDNPC           Lean Rng Prd Pc
      * YTD % 4
      * CUR.Lean Rng Prd Pct 4 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Prd Cnt 4 USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.PY Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HNDNB    DIV  P8MFNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDOPC           Lean Rng Prd Pc
      * YTD % 5
      * CUR.Lean Rng Prd Pct 5 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Prd Cnt 5 USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.PY Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HNENB    DIV  P8MFNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDPPC           Lean Rng Prd Pc
      * YTD % 6
      * CUR.Lean Rng Prd Pct 6 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Prd Cnt 6 USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.PY Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HNFNB    DIV  P8MFNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDQPC           Lean Rng Prd Pc
      * YTD % 7
      * CUR.Lean Rng Prd Pct 7 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Prd Cnt 7 USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.PY Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HNGNB    DIV  P8MFNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDRPC           Lean Rng Prd Pc
      * YTD % 8
      * CUR.Lean Rng Prd Pct 8 USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Lean Rng Prd Cnt 8 USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.PY Head Killed
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.100
     C           $HNHNB    DIV  P8MFNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $HDSPC           Lean Rng Prd Pc
     C                     END                             *FI
      * ** Comparitive Data **
      *
     C                     Z-ADD*ZERO     WN0012  52       CWLW Min Top Ad
     C                     Z-ADD*ZERO     WN0013  52       CWLW Max Top Ad
     C                     Z-ADD*ZERO     WN0014  52       CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0015  52       CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0016  52       CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0017  52       CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0018  52       CWLW Min Lower
     C                     Z-ADD*ZERO     WN0019  52       CWLW Max Lower
     C                     Z-ADD*ZERO     WN0020  30       CWLW Min Top Le
     C                     Z-ADD*ZERO     WN0021  30       CWLW Max Top Le
     C                     Z-ADD*ZERO     WN0022  30       CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0023  30       CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0024  30       CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0025  30       CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0026  30       CWLW Min Lower
     C                     Z-ADD*ZERO     WN0027  30       CWLW Max Lower
     C                     Z-ADD*ZERO     WN0028  52       CWLW Min Top Le
     C                     Z-ADD*ZERO     WN0029  52       CWLW Max Top Le
     C                     Z-ADD*ZERO     WN0030  52       CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0031  52       CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0032  52       CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0033  52       CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0034  52       CWLW Min Lower
     C                     Z-ADD*ZERO     WN0035  52       CWLW Max Lower
     C                     Z-ADD*ZERO     WN0036  52       CWLW Min Top So
     C                     Z-ADD*ZERO     WN0037  52       CWLW Max Top So
     C                     Z-ADD*ZERO     WN0038  52       CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0039  52       CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0040  52       CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0041  52       CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0042  52       CWLW Min Lower
     C                     Z-ADD*ZERO     WN0043  52       CWLW Max Lower
      *
      * Prt Crc Sum WtLt WK   IF
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0012           CWLW Min Top Ad
     C                     Z-ADD*ZERO     WN0013           CWLW Max Top Ad
     C                     Z-ADD*ZERO     WN0014           CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0015           CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0016           CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0017           CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0018           CWLW Min Lower
     C                     Z-ADD*ZERO     WN0019           CWLW Max Lower
     C                     Z-ADD*ZERO     WN0020           CWLW Min Top Le
     C                     Z-ADD*ZERO     WN0021           CWLW Max Top Le
     C                     Z-ADD*ZERO     WN0022           CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0023           CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0024           CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0025           CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0026           CWLW Min Lower
     C                     Z-ADD*ZERO     WN0027           CWLW Max Lower
     C                     Z-ADD*ZERO     WN0028           CWLW Min Top Le
     C                     Z-ADD*ZERO     WN0029           CWLW Max Top Le
     C                     Z-ADD*ZERO     WN0030           CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0031           CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0032           CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0033           CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0034           CWLW Min Lower
     C                     Z-ADD*ZERO     WN0035           CWLW Max Lower
     C                     Z-ADD*ZERO     WN0036           CWLW Min Top So
     C                     Z-ADD*ZERO     WN0037           CWLW Max Top So
     C                     Z-ADD*ZERO     WN0038           CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0039           CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0040           CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0041           CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0042           CWLW Min Lower
     C                     Z-ADD*ZERO     WN0043           CWLW Max Lower
     C                     MOVEL*BLANK    $HHKTX           Yield NA WK USR
     C                     MOVEL*BLANK    $HHRTX           Yield Top X WK
     C                     MOVEL*BLANK    $HHTTX           Yield Mid Hi X
     C                     MOVEL*BLANK    $HHSTX           Yield Mid Low X
     C                     MOVEL*BLANK    $HHUTX           Yield Lower X W
     C                     MOVEL*BLANK    $HHJTX           Lean% NA WK USR
     C                     MOVEL*BLANK    $HHNTX           Lean% Top X WK
     C                     MOVEL*BLANK    $HHPTX           Lean% Mid Hi X
     C                     MOVEL*BLANK    $HHOTX           Lean% Mid Low X
     C                     MOVEL*BLANK    $HHQTX           Lean% Lower X W
     C                     MOVEL*BLANK    $HHLTX           Lean Prm NA WK
     C                     MOVEL*BLANK    $HHVTX           Lean Prm Top X
     C                     MOVEL*BLANK    $HHXTX           Lean Prm Mid Hi
     C                     MOVEL*BLANK    $HHWTX           Lean Prm Mid Lo
     C                     MOVEL*BLANK    $HHYTX           Lean Prm Lower
     C                     MOVEL*BLANK    $HHMTX           Sort Dsc NA WK
     C                     MOVEL*BLANK    $HHZTX           Sort Dsc Top X
     C                     MOVEL*BLANK    $HH1TX           Sort Dsc Mid Hi
     C                     MOVEL*BLANK    $HH0TX           Sort Dsc Mid Lo
     C                     MOVEL*BLANK    $HH2TX           Sort Dsc Lower
     C                     Z-ADD*ZERO     $HMHNB           CWL Min Adj Liv
     C                     Z-ADD*ZERO     $HMINB           CWL Max Adj Liv
     C                     Z-ADD*ZERO     WUNXNB           Live Wgt Min US
     C                     Z-ADD*ZERO     WUNYNB           Live Wgt Max US
      * Rtv Prior Sunday      XF - STR Order Management Sys  * 
     C                     CALL 'PDLNXFR'              90  Rtv Prior Sunda
     C                     PARM *BLANK    W0RTN   7
     C                     PARM A1HMNB    WQ0118  30       Company Number
     C                     PARM A1B0DT    WQ0119  70       Kill Date Usr
     C           WUB5DT    PARM *ZERO     WQ0120  70       Date USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Crc Sum WtLt WK   RT - Crc Sum Co Wgt Lot   WK  * 
     C                     EXSR SURVGN
      * Yield
      * CASE: PAR.TH Adj Actual Yield % EQ WRK.Zero USR
     C           $HCWPC    IFEQ WUE9NB                     *IF
     C                     MOVEL'NA'      $HHKTX           Yield NA WK USR
     C                     ELSE
      * CASE: *OTHERWISE
      * Yield Compare
      * CASE: PAR.TH Adj Actual Yield % GT PAR.CWLW Max Mid Hi Adj Yield
     C           $HCWPC    IFGT WN0017                     *IF
     C                     MOVEL'X'       $HHRTX           Yield Top X WK
     C                     ELSE
      * CASE: Max Mid Low < Yield <= Max Mid Hi
      *  - c1 AND c2
      *   |- c1    : PAR.TH Adj Actual Yield % GT PAR.CWLW Max Mid Low Ad
      *   |- c2    : PAR.TH Adj Actual Yield % LE PAR.CWLW Max Mid Hi Adj
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HCWPC    IFGT WN0015                     *IF
     C           $HCWPC    IFLE WN0017                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'X'       $HHTTX           Yield Mid Hi X
     C                     ELSE
      * CASE: Max Lower < Yield <= Max Mid Low
      *  - c1 AND c2
      *   |- c1    : PAR.TH Adj Actual Yield % GT PAR.CWLW Max Lower Adj
      *   |- c2    : PAR.TH Adj Actual Yield % LE PAR.CWLW Max Mid Low Ad
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HCWPC    IFGT WN0019                     *IF
     C           $HCWPC    IFLE WN0015                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'X'       $HHSTX           Yield Mid Low X
     C                     ELSE
      * CASE: PAR.TH Adj Actual Yield % LE PAR.CWLW Max Lower Adj Yield
     C           $HCWPC    IFLE WN0019                     *IF
     C                     MOVEL'X'       $HHUTX           Yield Lower X W
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Lean Percent
      * CASE: PAR.TH Avg Lean Percent EQ WRK.Zero USR
     C           $HF4NB    IFEQ WUE9NB                     *IF
     C                     MOVEL'NA'      $HHJTX           Lean% NA WK USR
     C                     ELSE
      * CASE: *OTHERWISE
      * Lean Percent Compare
      * CASE: PAR.TH Avg Lean Percent GT PAR.CWLW Max Mid Hi Lean%
     C           $HF4NB    IFGT WN0025                     *IF
     C                     MOVEL'X'       $HHNTX           Lean% Top X WK
     C                     ELSE
      * CASE: Max Mid Low < Lean% <= Max Mid Hi
      *  - c1 AND c2
      *   |- c1    : PAR.TH Avg Lean Percent GT PAR.CWLW Max Mid Low Lean
      *   |- c2    : PAR.TH Avg Lean Percent LE PAR.CWLW Max Mid Hi Lean%
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HF4NB    IFGT WN0023                     *IF
     C           $HF4NB    IFLE WN0025                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'X'       $HHPTX           Lean% Mid Hi X
     C                     ELSE
      * CASE: Max Lower < Lean% <= Max Mid Low
      *  - c1 AND c2
      *   |- c1    : PAR.TH Avg Lean Percent GT PAR.CWLW Max Lower Lean%
      *   |- c2    : PAR.TH Avg Lean Percent LE PAR.CWLW Max Mid Low Lean
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HF4NB    IFGT WN0027                     *IF
     C           $HF4NB    IFLE WN0023                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'X'       $HHOTX           Lean% Mid Low X
     C                     ELSE
      * CASE: PAR.TH Avg Lean Percent LE PAR.CWLW Max Lower Lean%
     C           $HF4NB    IFLE WN0027                     *IF
     C                     MOVEL'X'       $HHQTX           Lean% Lower X W
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Lean Premium Lv/CWT
      * CASE: PAR.TH CM Lean Prem Live /CWT EQ WRK.Zero USR
     C           $HEEPR    IFEQ WUE9NB                     *IF
     C                     MOVEL'NA'      $HHLTX           Lean Prm NA WK
     C                     ELSE
      * CASE: *OTHERWISE
      * Lean Premium Compare
      * CASE: PAR.TH CM Lean Prem Live /CWT GT PAR.CWLW Max Mid Hi Lean P
     C           $HEEPR    IFGT WN0033                     *IF
     C                     MOVEL'X'       $HHVTX           Lean Prm Top X
     C                     ELSE
      * CASE: Max Mid Low < Lean prm <= Max Mid Hi
      *  - c1 AND c2
      *   |- c1    : PAR.TH CM Lean Prem Live /CWT GT PAR.CWLW Max Mid Lo
      *   |- c2    : PAR.TH CM Lean Prem Live /CWT LE PAR.CWLW Max Mid Hi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HEEPR    IFGT WN0031                     *IF
     C           $HEEPR    IFLE WN0033                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'X'       $HHXTX           Lean Prm Mid Hi
     C                     ELSE
      * CASE: Max Lower < Lean prm <= Max Mid Low
      *  - c1 AND c2
      *   |- c1    : PAR.TH CM Lean Prem Live /CWT GT PAR.CWLW Max Lower
      *   |- c2    : PAR.TH CM Lean Prem Live /CWT LE PAR.CWLW Max Mid Lo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HEEPR    IFGT WN0035                     *IF
     C           $HEEPR    IFLE WN0031                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'X'       $HHWTX           Lean Prm Mid Lo
     C                     ELSE
      * CASE: PAR.TH CM Lean Prem Live /CWT LE PAR.CWLW Max Lower Lean Pr
     C           $HEEPR    IFLE WN0035                     *IF
     C                     MOVEL'X'       $HHYTX           Lean Prm Lower
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Sort Discount Lv/CWT
      * CASE: PAR.TH CM Srt Dsc Live /CWT EQ WRK.Zero USR
     C           $HD8PR    IFEQ WUE9NB                     *IF
     C                     MOVEL'NA'      $HHMTX           Sort Dsc NA WK
     C                     ELSE
      * CASE: *OTHERWISE
      * Sort Discount Compare
      * CASE: PAR.TH CM Srt Dsc Live /CWT GT PAR.CWLW Max Mid Hi Sort Dsc
     C           $HD8PR    IFGT WN0041                     *IF
     C                     MOVEL'X'       $HHZTX           Sort Dsc Top X
     C                     ELSE
      * CASE: Max Mid Low < Sort Dsc <= Max Mid Hi
      *  - c1 AND c2
      *   |- c1    : PAR.TH CM Srt Dsc Live /CWT GT PAR.CWLW Max Mid Low
      *   |- c2    : PAR.TH CM Srt Dsc Live /CWT LE PAR.CWLW Max Mid Hi S
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HD8PR    IFGT WN0039                     *IF
     C           $HD8PR    IFLE WN0041                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'X'       $HH1TX           Sort Dsc Mid Hi
     C                     ELSE
      * CASE: Max Lower < Sort Dsc <= Max Mid Low
      *  - c1 AND c2
      *   |- c1    : PAR.TH CM Srt Dsc Live /CWT GT PAR.CWLW Max Lower So
      *   |- c2    : PAR.TH CM Srt Dsc Live /CWT LE PAR.CWLW Max Mid Low
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HD8PR    IFGT WN0043                     *IF
     C           $HD8PR    IFLE WN0039                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'X'       $HH0TX           Sort Dsc Mid Lo
     C                     ELSE
      * CASE: PAR.TH CM Srt Dsc Live /CWT LE PAR.CWLW Max Lower Sort Dsc
     C           $HD8PR    IFLE WN0043                     *IF
     C                     MOVEL'X'       $HH2TX           Sort Dsc Lower
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 041415 slm Add new logic for head and unit of measure
      * Check each head > zero, and unit of measure for Head
      * If unit of measure is head and and head > zero then
      * the head will print.  There is a condition on each head
      * on the print file.
     C                     Z-ADD*ZERO     $HVKPR           Base Mkt Price
     C                     Z-ADD*ZERO     $HVLPR           Var From Top Wt
     C                     Z-ADD*ZERO     $HVMPR           Yield Gain/Loss
     C                     Z-ADD*ZERO     $HVNPR           Carcass Value
     C                     Z-ADD*ZERO     $HVOPR           Quality Prem/De
     C                     Z-ADD*ZERO     $HVPPR           Gross Value
     C                     Z-ADD*ZERO     $HU6PR           Head Amount 1 U
     C                     Z-ADD*ZERO     $HU7PR           Head Amount 2 U
     C                     Z-ADD*ZERO     $HU8PR           Head Amount 3 U
     C                     Z-ADD*ZERO     $HU9PR           Head Amount 4 U
     C                     Z-ADD*ZERO     $HVAPR           Head Amount 5 U
     C                     Z-ADD*ZERO     $HVBPR           Head Amount 6 U
     C                     Z-ADD*ZERO     $HVCPR           Head Amount 7 U
     C                     Z-ADD*ZERO     $HVDPR           Head Amount 8 U
      * CASE: WRK.Carc/Summ Special Prc Usr is Triumph Foods Market Spec
     C           WUYZST    IFEQ 'M'                        *IF
      * Head Amount
      * CASE: LCL.TH Head Killed is Not Zero
     C           YL0018    IFNE *ZERO                      *IF
     C           $HANPR    DIV  YL0018    $HVKPR    H      Base Mkt Price
     C           $HAYVA    DIV  YL0018    $HVLPR    H      Var From Top Wt
     C           $HAWVA    DIV  YL0018    $HVMPR    H      Yield Gain/Loss
     C           $HAOPR    DIV  YL0018    $HVNPR    H      Carcass Value
     C           $HAXVA    DIV  YL0018    $HVOPR    H      Quality Prem/De
     C           $HAPPR    DIV  YL0018    $HVPPR    H      Gross Value
     C           $HC7PR    DIV  YL0018    $HU6PR    H      Head Amount 1 U
     C           $HC9PR    DIV  YL0018    $HU7PR    H      Head Amount 2 U
     C           $HC6PR    DIV  YL0018    $HU8PR    H      Head Amount 3 U
     C           $HC8PR    DIV  YL0018    $HU9PR    H      Head Amount 4 U
     C           $HC5PR    DIV  YL0018    $HVAPR    H      Head Amount 5 U
     C           $HEIPR    DIV  YL0018    $HVBPR    H      Head Amount 6 U
     C           $HELPR    DIV  YL0018    $HVCPR    H      Head Amount 7 U
     C           $HEMPR    DIV  YL0018    $HVDPR    H      Head Amount 8 U
     C                     END                             *FI
     C                     Z-ADD*ZERO     $HLYA1           Avg Meat Value
      * cur.Avg Meat Value Factor %
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Payment Gross is Not Zeros
      *   |- c2    : DB1.TH CM Base Mkt Price Amt is Not Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           A1CBPR    IFNE *ZERO                      *IF
     C           A1ANPR    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * cur.Avg Meat Value Fac%
      * CUR.Avg Meat Value Factor % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : DB1.TH Payment Gross
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : DB1.TH CM Base Mkt Price Amt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           A1CBPR    DIV  A1ANPR    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HLYA1           Avg Meat Value
     C                     END                             *FI
     C                     END                             *FI
      * Market and Subject Hogs Only
      * CASE: DB1.HC Class Code is Resale
     C           A1BECD    IFEQ 'RSL'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Prt Crc Sum Cndmns    RT - Loss Type  * 
     C                     EXSR SVRVGN
      * Prt Crc Sum Trim Dtl  RT - Loss Type  * 
     C                     EXSR TCRVGN
     C                     Z-ADD1         ZQ      50
     C           WUOOTX    CAT  WUG4TX:ZQ $HONTX    P      Trim 1 Desc Crc
     C                     Z-ADD1         ZQ      50
     C           WUOPTX    CAT  WUG5TX:ZQ $HOTTX    P      Trim 2 Desc Crc
     C                     Z-ADD1         ZQ      50
     C           WUOQTX    CAT  WUG6TX:ZQ $HOUTX    P      Trim 3 Desc Crc
     C                     Z-ADD1         ZQ      50
     C           WUORTX    CAT  WUG7TX:ZQ $HOVTX    P      Trim 4 Desc Crc
     C                     Z-ADD1         ZQ      50
     C           WUOSTX    CAT  WUG8TX:ZQ $HOWTX    P      Trim 5 Desc Crc
     C                     Z-ADD1         ZQ      50
     C           WUO0TX    CAT  WUOZTX:ZQ $HOXTX    P      Trim 6 Desc Crc
     C                     END                             *FI
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR TERVGN
      * CASE: CUR.TH Avg Backfat - 2 Dec is Not Entered
     C           $HMCNF    IFEQ 0                          *IF
     C                     Z-ADD$HF2NB    $HMCNF           TH Avg Backfat
     C                     END                             *FI
      * CASE: CUR.TH Avg Loin Eye - 2 dec is Not Entered
     C           $HMVNF    IFEQ *ZERO                      *IF
     C                     Z-ADD$HF3NB    $HMVNF           TH Avg Loin Eye
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZA001           BOH Company Num
     C                     Z-ADDA1HMNB    WZA001
     C           *LIKE     DEFN A1BNNB    WZA002           BOH Buy Order N
     C                     Z-ADDA1BNNB    WZA002
     C           *LIKE     DEFN A1BONB    WZA003           BOL Load Number
     C                     Z-ADDA1BONB    WZA003
     C           *LIKE     DEFN A1CVNB    WZA004           TH Tattoo Numbe
     C                     Z-ADDA1CVNB    WZA004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@A1CPC4                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     MOVEL'Y'       WUP4ST           Status 1
     C                     MOVEL'Y'       WUP5ST           Status 2
     C                     MOVEL'Y'       WUSVST           Status 3
      * CASE: DB1.TH Held Over GT WRK.Zero USR
     C           A1H9NB    IFGT WUE9NB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * 5/28/03  Added par.status 3 field check for sort loss print
      * If live not printing as Carc, dont print base mkt, et al. fields
      * CASE:
      *  - (c1 AND c2 AND c3) AND c4
      *   |- c1    : DB1.TH Payment Type is Live
      *   |- c2    : PAR.Print Carcass Analysis Us is No
      *   |- c3    : PAR.Print Comp Sum/Dtl STS is No
      *   |- c4    : PAR.Status 3 is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           A1J9ST    IFEQ 'L'                        *IF
     C           P3MVST    IFEQ 'N'                        *IF
     C           P8TOST    IFEQ 'N'                        *IF
     C           P8SVST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUP4ST           Status 1
     C                     MOVEL'N'       WUP5ST           Status 2
     C                     END                             *FI
      * Display Shipped Weight
      * CASE: DB1.TH Payment Type is Carcass Merit
     C           A1J9ST    IFEQ 'C'                        *IF
     C                     MOVEL'N'       WUSVST           Status 3
     C                     ELSE
      * CASE: DB1.TH Payment Type is Live
     C           A1J9ST    IFEQ 'L'                        *IF
      * CASE: DB1.TH Live Purchase UOM is Not Shipped Weight
     C           A1CPST    IFEQ 'BD'                       *IF
     C           A1CPST    OREQ 'CW'
     C           A1CPST    OREQ 'CH'
     C           A1CPST    OREQ 'DH'
     C           A1CPST    OREQ 'FL'
     C           A1CPST    OREQ 'GV'
     C           A1CPST    OREQ 'KH'
     C           A1CPST    OREQ 'LW'
     C           A1CPST    OREQ 'NH'
     C           A1CPST    OREQ 'NL'
     C           A1CPST    OREQ 'RH'
     C           A1CPST    OREQ 'YH'
     C           A1CPST    OREQ 'DY'
     C           A1CPST    OREQ 'LX'
     C           A1CPST    OREQ 'RX'
     C                     MOVEL'N'       WUSVST           Status 3
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL@CN,20    YL0181           Company Value C
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM A1HMNB    WQ0126  30       BOH Company Num
     C                     PARM YL0181    WQ0127 10        Company Value C
     C           YL0180    PARM *BLANK    WQ0128 40        System Value Al
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0AL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0AL03  1        TH Tattoo Numbe
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0AL02  1        BOL Load Number
     C                     MOVEL'Y'       W0AL03  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           A1BNNB    IFNE WZA002                     BOH Buy Order N
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           A1BONB    IFNE WZA003                     BOL Load Number
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           A1CVNB    IFNE WZA004                     TH Tattoo Numbe
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL03    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Tattoo Number format
     C                     MOVELYL0004    $IBICD           TH Group Refere
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,21    CAT  @CN,22:ZQ $ITCTX    P      Prd/Co Confiden
     C                     Z-ADD1         ZQ      50
     C           $ITCTX    CAT  @CN,23:ZQ $ITCTX    P      Prd/Co Confiden
      * Val Company Number    IF
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $IHMNB    WQ0129  30       CC Company Numb
     C           WUBSTX    PARM *BLANK    WQ0130 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0131  1        Invalid Y/N USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Invalid Y/N USR is Yes
     C           WUG3ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD$IHMNB    ZA0001           CC Company Numb
      * Send message 'Invalid Company Number'
     C                     MOVEL'PRK0299' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVELWUG3ST    WUG3ST           Invalid Y/N USR
     C                     Z-ADD1         ZQ      50
     C           $ITCTX    CAT  WUBSTX:ZQ $ITCTX    P      Prd/Co Confiden
      * CASE: PAR.TFD Header Action-Crc Sum EQ WRK.Blank USR
     C           P5NKTX    IFEQ WUCRTX                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           YL0065    IFEQ *BLANK                     *IF
     C           YL0065    OREQ 'N'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$IKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
      * PRTOBJ calls after print of TH Tattoo Number format
      * Embedded PRTOBJ : Prt Carcass Detail,Fx PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$QKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
      * PRTOBJ calls after print of BOL Load Number format
      * Embedded PRTOBJ : Prt BOL Summary Totals PO
     C                     EXSR UGSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$WKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$XKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * Mention hidden format
     C   99N99             WRITE$YFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Carcass Detail,Fx PO: Mainline
      *================================================================
      * Prt Carcass Detail,Fx PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1HMNB    WQKB01           BOH Company Num
     C           *LIKE     DEFN B1BNNB    WQKB02           BOH Buy Order N
     C           *LIKE     DEFN B1BONB    WQKB03           BOL Load Number
     C           *LIKE     DEFN B1CVNB    WQKB04           TH Tattoo Numbe
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           BOH Buy Order N
     C                     KFLD           WQKB03           BOL Load Number
     C                     KFLD           WQKB04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$IHMNB    WQKB01           BOH Company Num
     C                     Z-ADD$IBNNB    WQKB02           BOH Buy Order N
     C                     Z-ADD$IBONB    WQKB03           BOL Load Number
     C                     Z-ADD$ICVNB    WQKB04           TH Tattoo Numbe
      * Establish starting position
     C           KRSB      SETLL@B1CPKX                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        CD Carcass/Hot
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $MJ9NB           TH Head Exclude
     C                     MOVEL*BLANK    $MHGTX           Record Add/Del
     C                     Z-ADD*ZERO     $MXFRE           Weight 7.1 1 US
     C                     Z-ADD*ZERO     $MJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     $MJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     $MF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     $MAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     $MAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     $MEZNB           CD Gross Value
     C                     Z-ADD*ZERO     $MTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     $MNSNB           Carcass number
     C                     Z-ADD*ZERO     $MKFNB           Carcass Count U
     C                     Z-ADD*ZERO     $MBFPC           Std Yield % SUM
     C                     Z-ADD*ZERO     $MBNPR           Std Yield % Tot
     C                     Z-ADD*ZERO     $MP7NB           Std Yield * Wgt
     C                     Z-ADD*ZERO     $MGRNB           Weight SUM
     C                     Z-ADD*ZERO     $ME6PR           Variance f/TopW
     C                     Z-ADD*ZERO     $MBMVA           Var From Top Wg
     C                     Z-ADD*ZERO     $MBSPR           Adj Base Carc P
     C                     Z-ADD*ZERO     $MBUPR           Adj Base Carc V
     C                     Z-ADD*ZERO     $MBPPC           Lean % 3.0 USR
     C                     Z-ADD*ZERO     $MD3PC           Lean % 1 USR
     C                     Z-ADD*ZERO     $MNTNB           Lean % * Wt
     C                     Z-ADD*ZERO     $MBIPR           Lean Add/Ded /L
     C                     Z-ADD*ZERO     $MBXPR           Lean Prem Val S
     C                     Z-ADD*ZERO     $MB0PR           Total Carc /CWT
     C                     Z-ADD*ZERO     $MBZPR           Total Carc Val
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $JARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     $JAWDT           TH Purchase Dat
     C                     Z-ADDB1HMNB    $JHMNB           BOH Company Num
     C                     Z-ADDB1B0DT    $JB0DT           TH Kill Date
     C                     MOVELB1ABCD    $JABCD           PD Producer Cod
     C                     Z-ADDB1CVNB    $JCVNB           TH Tattoo Numbe
     C                     Z-ADDB1BNNB    $JBNNB           BOH Buy Order N
     C                     Z-ADDB1BONB    $JBONB           BOL Load Number
     C                     Z-ADD*ZERO     $JOXNB           TH HPS Movement
     C                     MOVEL*BLANK    $JBICD           TH Group Refere
     C                     MOVEL*BLANK    $JAGTX           PD Name
     C                     MOVEL*BLANK    $JIXTX           Blank Usr 1 fld
     C                     MOVEL*BLANK    $JSUTX           Text 17 USR
     C                     MOVEL*BLANK    $JUITX           Text 25 #2 Usr
      * USER: Process before print of TH Tattoo Number format
      * CASE: PAR.TFD Header Action-Crc Sum EQ WRK.Blank USR
     C           P5NKTX    IFEQ WUCRTX                     *IF
     C                     MOVEL'N'       W0NEWP           *Print New Page
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0NEWP           *Print New Page
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDB1HMNB    $KHMNB           BOH Company Num
     C                     Z-ADDB1CVNB    $KCVNB           TH Tattoo Numbe
     C                     Z-ADDB1EWNB    $KEWNB           CD Carcass/Hot
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $LNNNB           Lean % * Wgt US
     C                     Z-ADDB1HMNB    $LHMNB           BOH Company Num
     C                     Z-ADDB1BNNB    $LBNNB           BOH Buy Order N
     C                     Z-ADDB1BONB    $LBONB           BOL Load Number
     C                     Z-ADDB1CVNB    $LCVNB           TH Tattoo Numbe
     C                     Z-ADDB1B0DT    $LB0DT           TH Kill Date
     C                     Z-ADDB1LGNB    $LLGNB           CD Scale Sequen
     C                     Z-ADDB1BBDT    $LBBDT           CD Kill Date
     C                     Z-ADDB1EUNB    $LEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     $LNSNB           Carcass number
     C                     MOVELB1UTST    $LUTST           CD Adjust/Add T
     C                     MOVEL*BLANK    $LHGTX           Record Add/Del
     C                     MOVELB1GDST    $LGDST           CD Trim Area
     C                     Z-ADDB1LHNB    $LLHNB           CD Carcass Numb
     C                     MOVELB1INST    $LINST           CD Record Add/D
     C                     Z-ADDB1BEPR    $LBEPR           CD Sort Loss
     C                     Z-ADDB1ASPC    $LASPC           CD STD Yield
     C                     Z-ADD*ZERO     $LP6NB           Std Yield * Wgt
     C                     Z-ADDB1EWNB    $LEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     $LE5PR           Variance f/TopW
     C                     Z-ADD*ZERO     $LE4PR           Variance from t
     C                     Z-ADDB1B4PR    $LB4PR           CD Base Carcass
     C                     Z-ADDB1EYNB    $LEYNB           CD Crc Value Pe
     C                     Z-ADDB1B1PR    $LB1PR           CD Base Carc Va
     C                     Z-ADDB1AVPR    $LAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     $LD1PC           CD Lean Percent
     C                     Z-ADDB1AUPC    $LAUPC           CD Lean Percent
     C                     Z-ADDB1AWPR    $LAWPR           CD Lean Premium
     C                     Z-ADDB1AXPR    $LAXPR           CD Lean Premium
     C                     Z-ADDB1EZNB    $LEZNB           CD Gross Value
     C                     Z-ADDB1AYPR    $LAYPR           CD Gross Value
     C                     Z-ADDB1AKTM    $LAKTM           CD Kill Time
     C                     MOVELB1IQST    $LIQST           CD Shift
     C                     MOVELB1EFST    $LEFST           CD Carcass Acti
     C                     Z-ADDB1H6NB    $LH6NB           CD Backfat Thic
     C                     Z-ADDB1BEPC    $LBEPC           CD Loin-Eye Dep
     C                     Z-ADDB1GCST    $LGCST           CD Light Reflec
     C                     MOVELB1GEST    $LGEST           CD Carcass Sex
     C                     Z-ADDB1BHPC    $LBHPC           CD FFLI
     C                     MOVELB1IOST    $LIOST           CD Record Creat
     C                     MOVELB1IPST    $LIPST           CD Record Creat
     C                     Z-ADDB1LTNB    $LLTNB           CD LOT
     C                     MOVELB1JNST    $LJNST           CD User Error O
     C                     Z-ADDB1X4NB    $LX4NB           CD Backfat Thic
     C                     Z-ADDB1FNPC    $LFNPC           CD Loin-Eye Dep
     C                     Z-ADDB1FOPC    $LFOPC           CD Light Reflec
     C                     Z-ADDB1FPPC    $LFPPC           CD Lean Percent
     C                     MOVELB1K2ST    $LK2ST           CD Source Type
     C                     MOVELB1K3ST    $LK3ST           CD Payment Type
     C                     Z-ADDB1JWPR    $LJWPR           CD CA Sort Loss
     C                     Z-ADDB1F5PC    $LF5PC           CD CA Std Yield
     C                     Z-ADDB1JXPR    $LJXPR           CD CA Base Carc
     C                     Z-ADDB1JYPR    $LJYPR           CD CA Crc Value
     C                     Z-ADDB1JZPR    $LJZPR           CD CA Base Carc
     C                     Z-ADDB1J0PR    $LJ0PR           CD CA Crc Value
     C                     Z-ADDB1J1PR    $LJ1PR           CD CA Lean Prem
     C                     Z-ADDB1J2PR    $LJ2PR           CD CA Lean Prem
     C                     Z-ADDB1J3PR    $LJ3PR           CD CA Gross Val
     C                     Z-ADDB1J4PR    $LJ4PR           CD CA Gross Val
     C                     MOVELB1HVCD    $LHVCD           CD Producer Loc
     C                     Z-ADDB1DKJR    $LDKJR           CD Loin Eye Inc
     C                     Z-ADDB1ITJF    $LITJF           CD Backfat Inch
     C                     Z-ADDB1IJGR    $LIJGR           CD Meat Value F
     C                     Z-ADDB1ORJE    $LORJE           CD Lean Prem/Di
     C                     Z-ADDB1OTJR    $LOTJR           CD Fixed Cost F
     C                     Z-ADDB1PEIR    $LPEIR           CD MPR Sort Los
     C                     Z-ADDB1IEUF    $LIEUF           CD Meat Value F
     C                     Z-ADDB1ORUE    $LORUE           CD Fixed Cost F
     C                     Z-ADDB1IUTR    $LIUTR           CD Gross Before
     C                     Z-ADDB1IJRR    $LIJRR           CD Gross Before
     C                     MOVELB1VCST    $LVCST           CD Broken Back
     C                     MOVELB1VDST    $LVDST           CD Adjust/Add S
     C                     MOVELB1VEST    $LVEST           CD Unused Sts 3
     C                     MOVELB1VFST    $LVFST           CD Unused Sts 4
     C                     MOVELB1VGST    $LVGST           CD Unused Sts 5
     C                     MOVELB1ABCD    $LABCD           PD Producer Cod
     C                     MOVELB1AACD    $LAACD           SR Source Code
      * USER: Process before print of detail format
      * Record status processing
      * CASE: CUR.CD Record Add/Del Sts is Blanks
     C           $LINST    IFEQ *BLANK                     *IF
     C                     ADD  1         WUNSNB           Carcass number
     C                     Z-ADDWUNSNB    $LNSNB           Carcass number
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CUR.CD Record Add/Del Sts is Delete
     C           $LINST    IFEQ 'D'                        *IF
     C                     ADD  1         WUNSNB           Carcass number
     C                     Z-ADDWUNSNB    $LNSNB           Carcass number
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUNSNB           Carcass number
     C                     Z-ADDWUNSNB    $LNSNB           Carcass number
     C                     END                             *FI
     C                     END                             *FI
      * Count Trimmed Carcasses
      * CASE: DB1.CD Trim Area is Entered
     C           B1GDST    IFEQ '3'                        *IF
     C           B1GDST    OREQ '2'
     C           B1GDST    OREQ '6'
     C           B1GDST    OREQ '4'
     C           B1GDST    OREQ '5'
     C           B1GDST    OREQ '1'
     C           B1GDST    OREQ '7'
     C                     ADD  1         WN0063           Carcass Count U
     C                     END                             *FI
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           P3MVST    IFEQ 'Y'                        *IF
     C                     Z-ADD$LJWPR    $LBEPR           CD Sort Loss
     C                     Z-ADD$LF5PC    $LASPC           CD STD Yield
     C                     Z-ADD$LJXPR    $LB4PR           CD Base Carcass
     C                     Z-ADD$LJYPR    $LEYNB           CD Crc Value Pe
     C                     Z-ADD$LJZPR    $LB1PR           CD Base Carc Va
     C                     Z-ADD$LJ0PR    $LAVPR           CD Crc Value $
     C                     Z-ADD$LJ1PR    $LAWPR           CD Lean Premium
     C                     Z-ADD$LJ2PR    $LAXPR           CD Lean Premium
     C                     Z-ADD$LJ3PR    $LEZNB           CD Gross Value
     C                     Z-ADD$LJ4PR    $LAYPR           CD Gross Value
     C                     END                             *FI
     C           $LEWNB    MULT $LASPC    $LP6NB           Std Yield * Wgt
     C           $LEWNB    MULT $LAUPC    $LNNNB           Lean % * Wgt US
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $LEWNB    $MGRNB           Weight SUM
     C                     ADD  $LP6NB    $MP7NB           Std Yield * Wgt
     C                     ADD  $LE4PR    $MBMVA           Var From Top Wg
     C                     ADD  $LAVPR    $MBUPR           Adj Base Carc V
     C                     ADD  $LNNNB    $MNTNB           Lean % * Wt
     C                     ADD  $LAXPR    $MBXPR           Lean Prem Val S
     C                     ADD  $LAYPR    $MBZPR           Total Carc Val
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN B1HMNB    WZB001           BOH Company Num
     C                     Z-ADDB1HMNB    WZB001
     C           *LIKE     DEFN B1BNNB    WZB002           BOH Buy Order N
     C                     Z-ADDB1BNNB    WZB002
     C           *LIKE     DEFN B1BONB    WZB003           BOL Load Number
     C                     Z-ADDB1BONB    WZB003
     C           *LIKE     DEFN B1CVNB    WZB004           TH Tattoo Numbe
     C                     Z-ADDB1CVNB    WZB004
     C           *LIKE     DEFN B1EWNB    WZB005           CD Carcass/Hot
     C                     Z-ADDB1EWNB    WZB005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@B1CPKX                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           P3MVST    IFEQ 'Y'                        *IF
      * Rtv PayTyp/Src Hc 2   Rt - Tattoo Header  * 
     C                     EXSR TFRVGN
      * CASE: WRK.TH Payment Type is Carcass Merit
     C           WUJ9ST    IFEQ 'C'                        *IF
      * CASE: WRK.TH Source Type is Internal
     C           WUKAST    IFEQ 'I'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0BL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0BL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0BL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0BL04  1        CD Carcass/Hot
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        CD Carcass/Hot
     C                     ELSE
      * Next record - Detect level breaks
     C           B1HMNB    IFNE WZB001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           B1BNNB    IFNE WZB002                     BOH Buy Order N
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           B1BONB    IFNE WZB003                     BOL Load Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           B1CVNB    IFNE WZB004                     TH Tattoo Numbe
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           B1EWNB    IFNE WZB005                     CD Carcass/Hot
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * CASE: PAR.Carcass number        USR is Zero
     C           WUNSNB    IFEQ *ZERO                      *IF
     C                     GOTO B4EXIT                     *QUIT
     C                     END                             *FI
      * Process Excluded Carcasses
      * CASE: PAR.TH Head Excluded is GT Zero
     C           YL0076    IFGT *ZERO                      *IF
     C                     MOVEL'DED'     $MHGTX           Record Add/Del
     C           -1        MULT YL0076    $MJ9NB           TH Head Exclude
     C           WUNSNB    SUB  YL0076    $MNSNB           Carcass number
     C                     Z-ADDYL0030    $MF4NB           TH Avg Lean Per
      * Weight
      * Weight Excluded
      * CUR.Weight 7.1 1 USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.TH Avg Hot Wgt EXC/ADD
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Excluded
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.-1
     C           YL0071    MULT YL0076    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT -1        W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $MXFRE           Weight 7.1 1 US
      * Carcass Value
     C           YL0125    MULT -1        $MJ0PR           CD CA Crc Value
      * Carcass Valuce /CWT
      * CUR.CD CA Crc Value Per CWT =
      *    *COMPUTE (x1 / (x2 / x3) * x4)
      * x1    : CUR.CD CA Crc Value $ Per Hd
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Weight 7.1 1 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : CON.-1
     C           $MXFRE    DIV  100       W0WB02    H      *Synon (15,5) w
     C           $MJ0PR    DIV  W0WB02    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT -1        W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $MJYPR           CD CA Crc Value
      * Premium
     C           YL0126    MULT -1        $MAXPR           CD Lean Premium
      * Premium /CWT
      * CUR.CD Lean Premium CWT =
      *    *COMPUTE (x1 / (x2 / x3) * x4)
      * x1    : CUR.CD Lean Premium $ Per Hd
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Weight 7.1 1 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : CON.-1
     C           $MXFRE    DIV  100       W0WB02    H      *Synon (15,5) w
     C           $MAXPR    DIV  W0WB02    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT -1        W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $MAWPR           CD Lean Premium
      * Gross
      * 8/15/2006 Un * this line and * out the line abovr
      *           The Exclude amount is not show as such on the carc dtl
     C           YL0120    MULT -1        $MTBPR           TH Excluded Gro
      * Gross Value /CWT
      * CUR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 / (x2 / x3) * x4)
      * x1    : CUR.TH Excluded Gross Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Weight 7.1 1 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : CON.-1
     C           $MXFRE    DIV  100       W0WB02    H      *Synon (15,5) w
     C           $MTBPR    DIV  W0WB02    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT -1        W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $MEZNB           CD Gross Value
      * Add Excluded Value to Total.
     C                     ADD  $MXFRE    $MGRNB           Weight SUM
     C                     ADD  $MJ0PR    $MBUPR           Adj Base Carc V
     C                     ADD  $MAXPR    $MBXPR           Lean Prem Val S
     C                     ADD  $MTBPR    $MBZPR           Total Carc Val
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUNSNB    $MNSNB           Carcass number
     C                     END                             *FI
      * Trimmed Carcasses
     C                     Z-ADDWN0063    $MKFNB           Carcass Count U
      * CASE: CUR.Weight SUM is Greater then Zero
     C           $MGRNB    IFGT *ZERO                      *IF
      * Std Yield % Avg
      * CUR.Std Yield * Wgt       SUM =
      *    *COMPUTE (x1 / x2)
      * x1    : CUR.Std Yield * Wgt       SUM
      * /     : CUR.Std Yield % Tot USR *Rounded
      * x2    : CUR.Weight SUM
     C           $MP7NB    DIV  $MGRNB    $MBNPR    H      Std Yield % Tot
     C                     Z-ADD$MBNPR    $MP7NB           Std Yield * Wgt
      * Variance from top/CWT
      * CUR.Variance f/TopWgt/CWT USR =
      *    *COMPUTE (x1 / (x2 /x3))
      * x1    : CUR.Var From Top Wgt Rep Sum
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Weight SUM
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $MGRNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $MBMVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $ME6PR           Variance f/TopW
      * Carcass value /CWT
      * CUR.Adj Base Carc Per CWT USR =
      *    *COMPUTE (x1 / (x2 /x3))
      * x1    : CUR.Adj Base Carc Val SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Weight SUM
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $MGRNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $MBUPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $MBSPR           Adj Base Carc P
      * Lean % Avg
      * CUR.Lean % 1 USR =
      *    *COMPUTE (x1 / x2)
      * x1    : CUR.Lean % * Wt           SUM
      * /     : PGM.*Synon (15,2) work field *
      * x2    : CUR.Weight SUM
     C           $MNTNB    DIV  $MGRNB    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $MD3PC           Lean % 1 USR
      * Lean Add/Ded /CWT
      * CUR.Lean Add/Ded /Lv CWT USR =
      *    *COMPUTE (x1 / (x2 /x3))
      * x1    : CUR.Lean Prem Val SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Weight SUM
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $MGRNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $MBXPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $MBIPR           Lean Add/Ded /L
      * CASE: PAR.CMP Grading Type is Meat Value
     C           YL0179    IFEQ 'M'                        *IF
      * Gross Value  /CWT
      * CUR.Total Carc /CWT USR =
      *    *COMPUTE (x1 / (x2 /x3))
      * x1    : CUR.Total Carc Val SUM
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.Weight SUM
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $MGRNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           $MBZPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $MB0PR           Total Carc /CWT
     C                     ELSE
      * CASE: *OTHERWISE
     C           $MBSPR    ADD  $MBIPR    $MB0PR           Total Carc /CWT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0030    $MD3PC           Lean % 1 USR
      * Rtv TH Ext for ExstnceRT - Tattoo Header EXT  * 
     C                     EXSR TGRVGN
      * Print *NONE for Excluded Carcass Data
      * CASE: WRK.*Return code is *Record does not exist
     C           WURTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'N'       YL0183           Format Printed
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0183           Format Printed
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 7
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           YL0076    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WN0061    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUABST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           YL0183    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      * Print format
     C                     WRITE$MFINTTL
     C                     END
      * PRTOBJ calls after print of final totals format
      * Embedded PRTOBJ : Prt Excluded Carc Dta PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt TH Comments       PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Excluded Carc Dta PO: Mainline
      *================================================================
      * Prt Excluded Carc Dta PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNHMNB    WQKC01           BOH Company Num
     C           *LIKE     DEFN DNBNNB    WQKC02           BOH Buy Order N
     C           *LIKE     DEFN DNBONB    WQKC03           BOL Load Number
     C           *LIKE     DEFN DNCVNB    WQKC04           TH Tattoo Numbe
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           BOH Buy Order N
     C                     KFLD           WQKC03           BOL Load Number
     C                     KFLD           WQKC04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$IHMNB    WQKC01           BOH Company Num
     C                     Z-ADD$IBNNB    WQKC02           BOH Buy Order N
     C                     Z-ADD$IBONB    WQKC03           BOL Load Number
     C                     Z-ADD$ICVNB    WQKC04           TH Tattoo Numbe
      * Establish starting position
     C           KRSC      SETLL@DNCPUY                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDDNHMNB    $OHMNB           BOH Company Num
     C                     Z-ADDDNBNNB    $OBNNB           BOH Buy Order N
     C                     Z-ADDDNBONB    $OBONB           BOL Load Number
     C                     Z-ADDDNCVNB    $OCVNB           TH Tattoo Numbe
     C                     Z-ADDDNLTHW    $OLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     $OM9A1           Hot Wgt < Usr
     C                     Z-ADD*ZERO     $OLHSM           Head LT Hot Wt
     C                     Z-ADDDNHLHW    $OHLHW           TH Head LT Hot
     C                     Z-ADDDNGTHW    $OGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     $ONAA1           Hot Wgt > Usr
     C                     Z-ADD*ZERO     $OGHSM           Head GT Hot Wt
     C                     Z-ADDDNHGHW    $OHGHW           TH Head GT Hot
     C                     Z-ADDDNH0PC    $OH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     $ONBA1           Lean Pct < Usr
     C                     Z-ADD*ZERO     $OLLSM           Head LT Lean Pc
     C                     Z-ADDDNHLLP    $OHLLP           TH Head LT Lean
     C                     Z-ADDDNH2PC    $OH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     $ONCA1           Lean Pct > Usr
     C                     Z-ADD*ZERO     $OGLSM           Head GT Lean Pc
     C                     Z-ADDDNHFLP    $OHFLP           TH Head GT Lean
     C                     Z-ADDDNLTBF    $OLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     $ONDA1           Backfat Inch <
     C                     Z-ADD*ZERO     $OLBSM           Head LT Backfat
     C                     Z-ADDDNHLBF    $OHLBF           TH Head LT Back
     C                     Z-ADDDNGTBF    $OGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     $ONEA1           Backfat Inch >
     C                     Z-ADD*ZERO     $OGBSM           Head GT Backfat
     C                     Z-ADDDNHGBF    $OHGBF           TH Head GT Back
     C                     Z-ADDDNHZPC    $OHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     $ONFA1           Loin Eye Inch <
     C                     Z-ADD*ZERO     $OLEIS           Head LT LoinEye
     C                     Z-ADD*ZERO     $ONGA1           Loin Eye Inch >
     C                     Z-ADDDNHLLE    $OHLLE           TH Head LT Loin
     C                     Z-ADDDNH1PC    $OH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     $OGESM           Head GT LoinEye
     C                     Z-ADDDNHGLE    $OHGLE           TH Head GT Loin
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDDNHMNB    $NHMNB           BOH Company Num
     C                     Z-ADDDNBNNB    $NBNNB           BOH Buy Order N
     C                     Z-ADDDNBONB    $NBONB           BOL Load Number
     C                     Z-ADDDNCVNB    $NCVNB           TH Tattoo Numbe
     C                     Z-ADDDNB0DT    $NB0DT           TH Kill Date
     C                     Z-ADDDNI5PR    $NI5PR           TH CA Market Pr
     C                     Z-ADDDNJBPR    $NJBPR           TH CA Base Mark
     C                     Z-ADDDNI6PR    $NI6PR           TH CA Base Mkt
     C                     Z-ADDDNI7PR    $NI7PR           TH CA Sort Disc
     C                     Z-ADDDNI8PR    $NI8PR           TH CA Yield Gai
     C                     Z-ADDDNI9PR    $NI9PR           TH CA Base Carc
     C                     Z-ADDDNJAPR    $NJAPR           TH CA Lean Prem
     C                     Z-ADDDNJCPR    $NJCPR           TH CA Carcass G
     C                     Z-ADDDNJDPR    $NJDPR           TH CA Bse Mkt L
     C                     Z-ADDDNJEPR    $NJEPR           TH CA Bse Mkt C
     C                     Z-ADDDNJFPR    $NJFPR           TH CA Srt Dsc L
     C                     Z-ADDDNJGPR    $NJGPR           TH CA Srt Dsc C
     C                     Z-ADDDNJHPR    $NJHPR           TH CA Yld G/L L
     C                     Z-ADDDNJIPR    $NJIPR           TH CA Yld G/L C
     C                     Z-ADDDNJJPR    $NJJPR           TH CA Crc Val L
     C                     Z-ADDDNJKPR    $NJKPR           TH CA Crc Val C
     C                     Z-ADDDNJLPR    $NJLPR           TH CA Lean Prm
     C                     Z-ADDDNJMPR    $NJMPR           TH CA Lean Prm
     C                     Z-ADDDNJNPR    $NJNPR           TH CA Gross Liv
     C                     Z-ADDDNJOPR    $NJOPR           TH CA Gross Car
     C                     Z-ADDDNLTHW    $NLTHW           TH Min LT Hot W
     C                     Z-ADDDNHLHW    $NHLHW           TH Head LT Hot
     C                     Z-ADDDNGTHW    $NGTHW           TH Max GT Hot W
     C                     Z-ADDDNHGHW    $NHGHW           TH Head GT Hot
     C                     Z-ADDDNH0PC    $NH0PC           TH Min LT Lean
     C                     Z-ADDDNHLLP    $NHLLP           TH Head LT Lean
     C                     Z-ADDDNH2PC    $NH2PC           TH Max GT Lean
     C                     Z-ADDDNHFLP    $NHFLP           TH Head GT Lean
     C                     MOVELDNABCD    $NABCD           PD Producer Cod
     C                     MOVELDNNYCD    $NNYCD           PS Site ID
     C                     Z-ADDDNLTBF    $NLTBF           TH Min LT Backf
     C                     Z-ADDDNHLBF    $NHLBF           TH Head LT Back
     C                     Z-ADDDNGTBF    $NGTBF           TH Max GT Backf
     C                     Z-ADDDNHGBF    $NHGBF           TH Head GT Back
     C                     Z-ADDDNHZPC    $NHZPC           TH Min LT LoinE
     C                     Z-ADDDNHLLE    $NHLLE           TH Head LT Loin
     C                     Z-ADDDNH1PC    $NH1PC           TH Max GT LoinE
     C                     Z-ADDDNHGLE    $NHGLE           TH Head GT Loin
     C                     MOVELDNAAVN    $NAAVN           RS User Changed
     C                     Z-ADDDNAADT    $NAADT           RS Date Changed
     C                     Z-ADDDNAMTM    $NAMTM           RS Time Changed
     C                     MOVELDNAJST    $NAJST           RS Record Statu
     C                     MOVELDNAHVN    $NAHVN           RS Job
     C                     MOVELDNAGVN    $NAGVN           RS Program
     C                     MOVELDNABVN    $NABVN           RS User Added
     C                     Z-ADDDNABDT    $NABDT           RS Date Added
     C                     Z-ADDDNABTM    $NABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $NHLBF    $OLBSM           Head LT Backfat
     C                     ADD  $NHGBF    $OGBSM           Head GT Backfat
     C                     ADD  $NHLHW    $OLHSM           Head LT Hot Wt
     C                     ADD  $NHGHW    $OGHSM           Head GT Hot Wt
     C                     ADD  $NHLLP    $OLLSM           Head LT Lean Pc
     C                     ADD  $NHFLP    $OGLSM           Head GT Lean Pc
     C                     ADD  $NHLLE    $OLEIS           Head LT LoinEye
     C                     ADD  $NHGLE    $OGESM           Head GT LoinEye
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DNHMNB    WZC001           BOH Company Num
     C                     Z-ADDDNHMNB    WZC001
     C           *LIKE     DEFN DNBNNB    WZC002           BOH Buy Order N
     C                     Z-ADDDNBNNB    WZC002
     C           *LIKE     DEFN DNBONB    WZC003           BOL Load Number
     C                     Z-ADDDNBONB    WZC003
     C           *LIKE     DEFN DNCVNB    WZC004           TH Tattoo Numbe
     C                     Z-ADDDNCVNB    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@DNCPUY                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0CL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0CL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0CL03  1        TH Tattoo Numbe
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           DNHMNB    IFNE WZC001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           DNBNNB    IFNE WZC002                     BOH Buy Order N
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           DNBONB    IFNE WZC003                     BOL Load Number
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           DNCVNB    IFNE WZC004                     TH Tattoo Numbe
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Tattoo Number format
      * Move the values of the ranges from the carcass merit programs
     C                     EXSR UESUBR                     Move the values
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 13
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$OKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Prt TH Comments       PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A4HMNB    WQKD01           BOH Company Num
     C           *LIKE     DEFN A4BNNB    WQKD02           BOH Buy Order N
     C           *LIKE     DEFN A4BONB    WQKD03           BOL Load Number
     C           *LIKE     DEFN A4CVNB    WQKD04           TH Tattoo Numbe
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           BOH Company Num
     C                     KFLD           WQKD02           BOH Buy Order N
     C                     KFLD           WQKD03           BOL Load Number
     C                     KFLD           WQKD04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$IHMNB    WQKD01           BOH Company Num
     C                     Z-ADD$IBNNB    WQKD02           BOH Buy Order N
     C                     Z-ADD$IBONB    WQKD03           BOL Load Number
     C                     Z-ADD$ICVNB    WQKD04           TH Tattoo Numbe
      * Establish starting position
     C           KRSD      SETLL@A4CPL4                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        BOH Company Num
     C                     MOVEL'Y'       W0DL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0DL02  1        BOL Load Number
     C                     MOVEL'Y'       W0DL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0DL04  1        TH Kill Date
     C                     MOVEL'Y'       W0DL05  1        THC Comment Typ
     C                     MOVEL'Y'       W0DL06  1        THC Comment Lin
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
     C           W0DL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP04  1
     C                     END
      *
     C           W0DL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP05  1
     C                     END
      *
     C           W0DL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP06  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA4HMNB    $PHMNB           BOH Company Num
     C                     Z-ADDA4BNNB    $PBNNB           BOH Buy Order N
     C                     Z-ADDA4BONB    $PBONB           BOL Load Number
     C                     Z-ADDA4CVNB    $PCVNB           TH Tattoo Numbe
     C                     Z-ADDA4B0DT    $PB0DT           TH Kill Date
     C                     Z-ADDA4BETX    $PBETX           THC Comment Lin
     C                     MOVELA4BFTX    $PBFTX           THC Comment
     C                     MOVELA4ETST    $PETST           THC Comment Typ
     C                     MOVELA4AAVN    $PAAVN           RS User Changed
     C                     Z-ADDA4AADT    $PAADT           RS Date Changed
     C                     Z-ADDA4AMTM    $PAMTM           RS Time Changed
     C                     MOVELA4AJST    $PAJST           RS Record Statu
     C                     MOVELA4AHVN    $PAHVN           RS Job
     C                     MOVELA4AGVN    $PAGVN           RS Program
     C                     MOVELA4ABVN    $PABVN           RS User Added
     C                     Z-ADDA4ABDT    $PABDT           RS Date Added
     C                     Z-ADDA4ABTM    $PABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A4HMNB    WZD001           BOH Company Num
     C                     Z-ADDA4HMNB    WZD001
     C           *LIKE     DEFN A4BNNB    WZD002           BOH Buy Order N
     C                     Z-ADDA4BNNB    WZD002
     C           *LIKE     DEFN A4BONB    WZD003           BOL Load Number
     C                     Z-ADDA4BONB    WZD003
     C           *LIKE     DEFN A4CVNB    WZD004           TH Tattoo Numbe
     C                     Z-ADDA4CVNB    WZD004
     C           *LIKE     DEFN A4B0DT    WZD005           TH Kill Date
     C                     Z-ADDA4B0DT    WZD005
     C           *LIKE     DEFN A4ETST    WZD006           THC Comment Typ
     C                     MOVELA4ETST    WZD006
     C           *LIKE     DEFN A4BETX    WZD007           THC Comment Lin
     C                     Z-ADDA4BETX    WZD007
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@A4CPL4                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.THC Comment Type is Historical or Payment
     C           A4ETST    IFEQ 'H'                        *IF
     C           A4ETST    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0DL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0DL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0DL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0DL04  1        TH Kill Date
     C                     MOVEL*BLANK    W0DL05  1        THC Comment Typ
     C                     MOVEL*BLANK    W0DL06  1        THC Comment Lin
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        BOH Company Num
     C                     MOVEL'Y'       W0DL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0DL02  1        BOL Load Number
     C                     MOVEL'Y'       W0DL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0DL04  1        TH Kill Date
     C                     MOVEL'Y'       W0DL05  1        THC Comment Typ
     C                     MOVEL'Y'       W0DL06  1        THC Comment Lin
     C                     ELSE
      * Next record - Detect level breaks
     C           A4HMNB    IFNE WZD001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           A4BNNB    IFNE WZD002                     BOH Buy Order N
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           A4BONB    IFNE WZD003                     BOL Load Number
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           A4CVNB    IFNE WZD004                     TH Tattoo Numbe
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C           A4B0DT    IFNE WZD005                     TH Kill Date
     C           W0DL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL04
     C                     END
     C           A4ETST    IFNE WZD006                     THC Comment Typ
     C           W0DL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL05
     C                     END
     C           A4BETX    IFNE WZD007                     THC Comment Lin
     C           W0DL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL06
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP06
     C                     END
      *
     C           W0DL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP05
     C                     END
      *
     C           W0DL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP04
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * Prt BOL Summary Totals PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQKE01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQKE02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQKE03           BOL Load Number
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           BOH Company Num
     C                     KFLD           WQKE02           BOH Buy Order N
     C                     KFLD           WQKE03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQKE01           BOH Company Num
     C                     Z-ADDP1BNNB    WQKE02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQKE03           BOL Load Number
      * Establish starting position
     C           KRSE      SETLL@A1CPOI                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        BOH Company Num
     C                     MOVEL'Y'       W0EL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0EL02  1        BOL Load Number
     C                     MOVEL'Y'       W0EL03  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWBHMNB    $RHMNB           BOH Company Num
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP01  1
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWBHMNB    $UHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $UBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $UBONB           BOL Load Number
     C                     Z-ADD*ZERO     $ULSA1           Tot Doa Usr
     C                     Z-ADD*ZERO     $ULTA1           Tot Received He
     C                     Z-ADD*ZERO     $ULUA1           Tot Yard Deads
     C                     Z-ADD*ZERO     $ULVA1           Tot Head Cmnd U
     C                     Z-ADD*ZERO     $ULWA1           Tot Killed Head
     C                     Z-ADDWBCXNB    $UCXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    $UCWNB           TH Head Receive
     C                     Z-ADDWBFCNB    $UFCNB           TH Yard Deads
     C                     Z-ADDWBFDNB    $UFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    $UFENB           TH Head Killed
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP02  1
     C                     END
      *
     C           W0EL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWBHMNB    $THMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $TBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $TBONB           BOL Load Number
     C                     Z-ADDWBCVNB    $TCVNB           TH Tattoo Numbe
     C                     Z-ADDWBAWDT    $TAWDT           TH Purchase Dat
     C                     MOVEL*BLANK    $TUPTX           Text of 35 size
     C                     MOVEL*BLANK    $TMFTX           Defect Desc Usr
     C                     Z-ADDWBCXNB    $TCXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    $TCWNB           TH Head Receive
     C                     Z-ADDWBFCNB    $TFCNB           TH Yard Deads
     C                     Z-ADDWBFDNB    $TFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    $TFENB           TH Head Killed
     C                     Z-ADDWBCYNB    $TCYNB           TH Live Wgt
     C                     Z-ADDWBCCPR    $TCCPR           Th Payment Net
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP03  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBHMNB    $SHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $SBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $SBONB           BOL Load Number
     C                     Z-ADDWBCVNB    $SCVNB           TH Tattoo Numbe
     C                     Z-ADDWBAWDT    $SAWDT           TH Purchase Dat
     C                     MOVEL*BLANK    $SOETX           Text 25 1 USR
     C                     MOVELWBLLST    $SLLST           TH Hog Class Ty
     C                     Z-ADDWBB0DT    $SB0DT           TH Kill Date
     C                     MOVELWBBICD    $SBICD           TH Group Refere
     C                     MOVELWBCPST    $SCPST           TH Live Purchas
     C                     Z-ADDWBACPR    $SACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    $SB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    $SCAPR           TH LIve Net Amt
     C                     Z-ADDWBCYNB    $SCYNB           TH Live Wgt
     C                     MOVELWBC4ST    $SC4ST           TH Resale UOM
     C                     Z-ADDWBAIPR    $SAIPR           TH Recalc Live
     C                     Z-ADDWBCDPR    $SCDPR           TH Freight Amou
     C                     Z-ADDWBHGNB    $SHGNB           TH Shipped Weig
     C                     Z-ADDWBA6DT    $SA6DT           TH Pricing Date
     C                     MOVELWBC2ST    $SC2ST           TH Resale Sprea
     C                     Z-ADDWBCXNB    $SCXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    $SCWNB           TH Head Receive
     C                     Z-ADDWBFCNB    $SFCNB           TH Yard Deads
     C                     Z-ADDWBH9NB    $SH9NB           TH Held Over
     C                     Z-ADDWBFDNB    $SFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    $SFENB           TH Head Killed
     C                     Z-ADDWBHENB    $SHENB           TH Head Adds
     C                     Z-ADDWBHFNB    $SHFNB           TH Head Accepte
     C                     Z-ADDWBE0NB    $SE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    $SA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    $SFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    $SA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    $SF7NB           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    $SHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    $SF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    $SF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $SF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $SF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    $SAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    $SAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    $SCWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    $SA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    $SA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    $SB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    $SAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    $SANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    $SAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    $SAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    $SAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    $SAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    $SAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    $SASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    $SA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    $SATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    $SA5VA           TH Additions Am
     C                     Z-ADDWBLPNB    $SLPNB           TH AP Voucher/D
     C                     MOVELWBE1ST    $SE1ST           TH Held Over Re
     C                     Z-ADDWBBSDT    $SBSDT           TH Held/Ovr Com
     C                     Z-ADDWBLRNB    $SLRNB           TH Adj Live Wgt
     C                     Z-ADDWBA7VA    $SA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    $SA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    $SJWST           TH Calc Net Sts
     C                     MOVELWBCWST    $SCWST           TH Payment Sts
     C                     Z-ADDWBCBPR    $SCBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    $SCCPR           Th Payment Net
     C                     MOVELWBD7ST    $SD7ST           TH Header Error
     C                     MOVELWBD8ST    $SD8ST           TH Detail Error
     C                     MOVELWBDWST    $SDWST           TH Kill Balanci
     C                     MOVELWBD6ST    $SD6ST           TH Bal to Kill
     C                     Z-ADDWBGHNB    $SGHNB           TH Commission A
     C                     Z-ADDWBBYDT    $SBYDT           TH Voucher Paym
     C                     MOVELWBE0ST    $SE0ST           TH User Error O
     C                     MOVELWBE2ST    $SE2ST           TH Sex
     C                     Z-ADDWBBTDT    $SBTDT           TH Commission P
     C                     Z-ADDWBBUDT    $SBUDT           TH Actual Check
     C                     Z-ADDWBHHNB    $SHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    $SHINB           TH FFLI
     C                     Z-ADDWBA3PR    $SA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    $SA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    $SA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    $SJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    $SD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    $SD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    $SD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    $SD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    $SEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    $SEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    $SECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    $SEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    $SEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    $SEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    $SEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    $SEHPR           TH CM Gross Car
     C                     MOVELWBKAST    $SKAST           TH Source Type
     C                     MOVELWBJ7ST    $SJ7ST           TH Scale Ticket
     C                     MOVELWBJ9ST    $SJ9ST           TH Payment Type
     C                     Z-ADDWBOXNB    $SOXNB           TH HPS Movement
     C                     MOVELWBLKST    $SLKST           TH Source Code
     C                     MOVELWBJ8ST    $SJ8ST           TH Posted to HP
     C                     MOVELWBLIST    $SLIST           TH Schedule Kil
     C                     MOVELWBLJST    $SLJST           TH Shift Held O
     C                     MOVELWBNZTX    $SNZTX           TH State
     C                     MOVELWBHJCD    $SHJCD           TH Unused Code
     C                     MOVELWBR4ST    $SR4ST           TH Unused Sts 2
     C                     MOVELWBR5ST    $SR5ST           TH Commission S
     C                     MOVELWBR6ST    $SR6ST           TH Paid 2 Week
     C                     MOVELWBR7ST    $SR7ST           TH Unused Sts 1
     C                     Z-ADDWBTHWT    $STHWT           TH DOA Weight
     C                     Z-ADDWBT2WT    $ST2WT           TH Avg Lean % E
     C                     Z-ADDWBTHHD    $STHHD           TH HPS Farm Sit
     C                     Z-ADDWBT2HD    $ST2HD           TH Shift Held O
     C                     Z-ADDWBOBPR    $SOBPR           TH Sorting Amou
     C                     Z-ADDWBKOER    $SKOER           TH Head Identif
     C                     Z-ADDWBOPIR    $SOPIR           TH Percent Iden
     C                     Z-ADDWBOPEM    $SOPEM           TH Percent Acce
     C                     Z-ADDWBIORP    $SIORP           TH Head Adjuste
     C                     Z-ADDWBOWEO    $SOWEO           TH PHA Head Add
     C                     MOVELWBOQET    $SOQET           TH PHA Add Type
     C                     MOVELWBURST    $SURST           TH PHA Average
     C                     MOVELWBUSST    $SUSST           TH PHA Add Reas
     C                     Z-ADDWBHHPC    $SHHPC           TH PHA Yield Pe
     C                     Z-ADDWBS9PR    $SS9PR           TH PHA Lean Prm
     C                     Z-ADDWBTAPR    $STAPR           TH VC Gross Val
     C                     Z-ADDWBTBPR    $STBPR           TH Excluded Gro
     C                     Z-ADDWBJFUR    $SJFUR           TH Avg Lean %
     C                     Z-ADDWBKRIF    $SKRIF           TH Broken Back
     C                     Z-ADDWBKORF    $SKORF           TH Hot Scl Uplo
     C                     Z-ADDWBKAPR    $SKAPR           TH Unused Nbr 4
     C                     Z-ADDWBKROT    $SKROT           TH Excluded Car
     C                     Z-ADDWBOTJG    $SOTJG           TH Excluded Pre
     C                     Z-ADDWBIRJG    $SIRJG           TH Unused Nbr 7
     C                     Z-ADDWBIMJF    $SIMJF           TH Unused Nbr 8
     C                     Z-ADDWBIRGF    $SIRGF           TH Unused Nbr 9
     C                     Z-ADDWBKRJF    $SKRJF           TH Unused Nbr 1
     C                     Z-ADDWBOJRF    $SOJRF           TH Break Even P
     C                     Z-ADDWBKFOR    $SKFOR           TH Meat Value F
     C                     Z-ADDWBORJK    $SORJK           TH Yld Parm Adj
     C                     Z-ADDWBOMVJ    $SOMVJ           TH PHA Sort Dis
     C                     Z-ADDWBMVNF    $SMVNF           TH Avg Loin Eye
     C                     Z-ADDWBMCNF    $SMCNF           TH Avg Backfat
     C                     Z-ADDWBNCNF    $SNCNF           TH HITCH Old Pa
     C                     Z-ADDWBNCHF    $SNCHF           TH MPR Sort Los
     C                     Z-ADDWBIGIR    $SIGIR           TH Unused Nbr 1
     C                     Z-ADDWBKFJR    $SKFJR           TH Unused Nbr 2
     C                     Z-ADDWBEADT    $SEADT           TH Cold Scl Upl
     C                     Z-ADDWBEBDT    $SEBDT           TH Cold Scl Upl
     C                     Z-ADDWBECDT    $SECDT           TH Unused Date
     C                     Z-ADDWBEDDT    $SEDDT           TH Unused Date
     C                     Z-ADDWBEEDT    $SEEDT           TH Unused Date
     C                     MOVELWBU4ST    $SU4ST           TH Unused Sts 1
     C                     MOVELWBU5ST    $SU5ST           TH Unused Sts 2
     C                     MOVELWBU6ST    $SU6ST           TH Unused Sts 3
     C                     MOVELWBU7ST    $SU7ST           TH Unused Sts 4
     C                     MOVELWBU8ST    $SU8ST           TH Unused Sts 5
     C                     MOVELWBU9ST    $SU9ST           TH Unused Sts 6
     C                     MOVELWBVAST    $SVAST           TH Unused Sts 7
     C                     MOVELWBVBST    $SVBST           TH Unused Sts 8
     C                     MOVELWBAGCD    $SAGCD           GN Genetic Code
     C                     MOVELWBBECD    $SBECD           HC Class Code
     C                     MOVELWBBDCD    $SBDCD           DF Defect Code
     C                     MOVELWBCSCD    $SCSCD           THP Process Cod
     C                     MOVELWBABCD    $SABCD           PD Producer Cod
     C                     MOVELWBAECD    $SAECD           PL Location Cod
     C                     MOVELWBACCD    $SACCD           HB Buyer Code
     C                     MOVELWBAAVN    $SAAVN           RS User Changed
     C                     Z-ADDWBAADT    $SAADT           RS Date Changed
     C                     Z-ADDWBAMTM    $SAMTM           RS Time Changed
     C                     MOVELWBAJST    $SAJST           RS Record Statu
     C                     MOVELWBAHVN    $SAHVN           RS Job
     C                     MOVELWBAGVN    $SAGVN           RS Program
     C                     MOVELWBABVN    $SABVN           RS User Added
     C                     Z-ADDWBABDT    $SABDT           RS Date Added
     C                     Z-ADDWBABTM    $SABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBHMNB    WZE001           BOH Company Num
     C                     Z-ADDWBHMNB    WZE001
     C           *LIKE     DEFN WBBNNB    WZE002           BOH Buy Order N
     C                     Z-ADDWBBNNB    WZE002
     C           *LIKE     DEFN WBBONB    WZE003           BOL Load Number
     C                     Z-ADDWBBONB    WZE003
     C           *LIKE     DEFN WBCVNB    WZE004           TH Tattoo Numbe
     C                     Z-ADDWBCVNB    WZE004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@A1CPOI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.TH Held Over Record is Yes
     C           WBE1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0EL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0EL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0EL03  1        TH Tattoo Numbe
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        BOH Company Num
     C                     MOVEL'Y'       W0EL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0EL02  1        BOL Load Number
     C                     MOVEL'Y'       W0EL03  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           WBHMNB    IFNE WZE001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C           WBBNNB    IFNE WZE002                     BOH Buy Order N
     C           W0EL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL01
     C                     END
     C           WBBONB    IFNE WZE003                     BOL Load Number
     C           W0EL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL02
     C                     END
     C           WBCVNB    IFNE WZE004                     TH Tattoo Numbe
     C           W0EL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL03
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL03    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Tattoo Number format
      * Meat cmp - Print the Live Weight and the Net amount if paid LV
     C                     MOVEL'N'       YL0194           Status 4
      * CASE: LCL.TH Payment Sts is Live anything
     C           YL0195    IFEQ 'ML'                       *IF
     C           YL0195    OREQ 'PL'
     C           YL0195    OREQ 'NL'
     C           YL0195    OREQ 'SL'
     C           YL0195    OREQ 'IL'
      * CASE: PAR.CMP Grading Type is Meat Value
     C           YL0179    IFEQ 'M'                        *IF
     C                     MOVEL'Y'       YL0194           Status 4
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert TH Purchase Date to display format
      * Convert date
     C           1000000   ADD  $TAWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VTAWDT
     C                     MOVEL'0'       *IN79
     C           YL0180    IFEQ 'Standard'                 *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$TKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP03
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of BOL Load Number format
     C                     Z-ADDWULSA1    $ULSA1           Tot Doa Usr
     C                     Z-ADDWULTA1    $ULTA1           Tot Received He
     C                     Z-ADDWULUA1    $ULUA1           Tot Yard Deads
     C                     Z-ADDWULVA1    $ULVA1           Tot Head Cmnd U
     C                     Z-ADDWULWA1    $ULWA1           Tot Killed Head
     C                     Z-ADD*ZERO     WULSA1           Tot Doa Usr
     C                     Z-ADD*ZERO     WULTA1           Tot Received He
     C                     Z-ADD*ZERO     WULUA1           Tot Yard Deads
     C                     Z-ADD*ZERO     WULVA1           Tot Head Cmnd U
     C                     Z-ADD*ZERO     WULWA1           Tot Killed Head
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$UKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP02
      * USER: Process after print of BOL Load Number format
     C                     Z-ADD*ZERO     $UCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     $UCWNB           TH Head Receive
     C                     Z-ADD*ZERO     $UFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     $UFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     $UFENB           TH Head Killed
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP01
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$VFINTTL
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Crc Sum & Dtl     PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Crc Sum & Dtl     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$C1STPAG
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Crc Sum & Dtl     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of BOH Company Number format
     C                     Z-ADD*ZERO     WUAZVA           THD Unit Amt
      * Rtv Tatt Ded/Add TransRT - Tattoo Ded/Add  * 
     C                     EXSR SKRVGN
     C                     Z-ADDWUAZVA    $DVQPR           PrdLoc Trnsp Al
     C                     Z-ADD*ZERO     $DN7NB           TH Live Wgt DRV
      * TH Live Wgt DRV
      * CASE: PAR.@Status (Rnd/Trn) is Rounded
     C           'T'       IFEQ 'R'                        *IF
     C           YL0021    MULT 1         $DN7NB    H      TH Live Wgt DRV
     C                     ELSE
      * CASE: PAR.@Status (Rnd/Trn) is Truncated
     C           'T'       IFEQ 'T'                        *IF
     C                     Z-ADDYL0021    $DN7NB           TH Live Wgt DRV
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD$DN7NB    YL0171           TH Live Wgt DRV
     C                     Z-ADDYL0027    $DF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $DPKNB           Th Live Adj Wgt
      * Th Live Adj Wgt Drv
      * CASE: PAR.@Status (Rnd/Trn) is Rounded
     C           'T'       IFEQ 'R'                        *IF
     C           YL0022    MULT 1         $DPKNB    H      Th Live Adj Wgt
     C                     ELSE
      * CASE: PAR.@Status (Rnd/Trn) is Truncated
     C           'T'       IFEQ 'T'                        *IF
     C                     Z-ADDYL0022    $DPKNB           Th Live Adj Wgt
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD$DPKNB    YL0172           Th Live Adj Wgt
     C                     Z-ADD*ZERO     $DOBNB           TH Hot Wgt DRV
      * TH Hot Wgt DRV
      * CASE: PAR.@Status (Rnd/Trn) is Rounded
     C           'T'       IFEQ 'R'                        *IF
     C           YL0023    MULT 1         $DOBNB    H      TH Hot Wgt DRV
     C                     ELSE
      * CASE: PAR.@Status (Rnd/Trn) is Truncated
     C           'T'       IFEQ 'T'                        *IF
     C                     Z-ADDYL0023    $DOBNB           TH Hot Wgt DRV
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD$DOBNB    YL0173           TH Hot Wgt DRV
      * Meat Special Processing  a-g
      * CASE: WRK.Carc/Summ Special Prc Usr is Meat Cmp Program
     C           WUYZST    IFEQ 'M'                        *IF
      * A = th cm market price
      * 12/15/06 PKD Retrieve the USDA Pork Cutout Price
      * RTV Market Price      XF - STR Order Management Sys  * 
     C                     CALL 'PDMWXFR'              90  RTV Market Pric
     C                     PARM W0RTN     WQ0049  7        *Return code
     C                     PARM 'HOG'     WQ0050  3        PSC Commodity M
     C                     PARM 'CUTOUT'  WQ0051  7        PSC Commodity P
     C                     PARM A1AWDT    WQ0052  70       TH Purchase Dat
     C                     PARM *ZERO     WQ0053  70       Date To   USR
     C           YL0174    PARM *ZERO     WQ0054 114       OMS Market Pric
     C           YL0175    PARM *ZERO     WQ0055  70       Pricing Date US
     C                     PARM A1HMNB    WQ0056  30       BOH Company Num
     C                     PARM 'CUR'     WQ0057  3        BOH Market Date
     C                     PARM 'H'       WQ0058  1        System Used
     C           WUIPTX    PARM *BLANK    WQ0059  5        OMS Error Retur
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMWXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           YL0174    MULT 1         $DU3PR    H      USDA Prk CutOut
      * B = 100%
     C                     Z-ADD100       $DKYA1           USDA Carc CWT U
      * C = TH CM BASE MKT PRICE
      * C = Should already be placed on report just a note here
      * D & F = Retrieve from Producer Sub Contract
      * D = Retrieve the Cmp on the Buy Order Load Wrk Cmp
      * F = Break-even Carc CWT Usr
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
     C                     EXSR SLRVGN
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
     C                     EXSR SMRVGN
      * D = BASE CARC CWT
      * Base Carc CWT Usr
      * CASE: WRK.CMP Program Code is *Blank
     C           WUAMCD    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     $DIKPC           Base Carc CWT U
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv CMP Payment Info  RT - Carcass Merit Program  * 
     C                     EXSR SNRVGN
     C                     Z-ADDWUVEPR    $DIKPC           Base Carc CWT U
     C                     END                             *FI
      * E = A * (F/100)
     C                     Z-ADDA1OJRF    $DU4PR           Break-even Pric
      * G = E - C
     C           $DU4PR    SUB  $DAMPR    $DU5PR           Deferred Price
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $DU3PR           USDA Prk CutOut
     C                     Z-ADD*ZERO     $DKYA1           USDA Carc CWT U
     C                     Z-ADD*ZERO     $DIKPC           Base Carc CWT U
     C                     Z-ADD*ZERO     $DILPC           Break-even Carc
     C                     Z-ADD*ZERO     $DU3PR           USDA Prk CutOut
     C                     Z-ADD*ZERO     $DU5PR           Deferred Price
     C                     END                             *FI
      * Live Vs. Meat Price
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Pricing UOM USR is Carcass Hundred Weight
      *   |- c2    : DB1.TH Payment Type is Carcass Merit
      *   |- c3    : PAR.Print Carcass Analysis Us is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P8SNST    IFEQ 'CW'                       *IF
     C                     MOVEL'0'       Y0CX02  1
     C           A1J9ST    IFEQ 'C'                        *IF
     C           P3MVST    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CW:  Switch Live & Carcass Weight & Average Weight.
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,03    $DJPTX           Text 10 1 USR
     C                     MOVEL@CN,04    $DJQTX           Text 10 2 USR
     C                     MOVEL@CN,05    $DOGTX           Text 10 3 USR
     C                     Z-ADD$DN7NB    WUN7NB           TH Live Wgt DRV
     C                     Z-ADD$DF7NB    WUF7NB           TH Avg Live Wgt
     C                     Z-ADDYL0173    $DN7NB           TH Live Wgt DRV
     C                     Z-ADDYL0028    $DF7NB           TH Avg Live Wgt
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * LW:  Switch Live & Carcass Weight & Average Weight.
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,06    $DJPTX           Text 10 1 USR
     C                     MOVEL@CN,07    $DJQTX           Text 10 2 USR
     C                     MOVEL*BLANK    $DOGTX           Text 10 3 USR
     C                     MOVEL'Live--'  $DOGTX           Text 10 3 USR
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0018    $DFENB           TH Head Killed
     C           YL0014    ADD  YL0013    $DLNA1           TH TATTOO HD RE
      * CASE: PAR.TFD Header Action-Crc Sum EQ WRK.Blank USR
     C           P5NKTX    IFEQ WUCRTX                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C                     Z-ADD$DLLA1    YL0002           PSM Miles to Co
     C                     Z-ADDWUAZVA    YL0176           PrdLoc Trnsp Al
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Pricing Date to display format
      * Convert date
     C           1000000   ADD  $DA6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDA6DT
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $DB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDB0DT
     C                     MOVEL'0'       *IN79
     C           P3MVST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUYZST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0002    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           YL0176    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Crc Sum & Dtl     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$EKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print BOL Load Number of Prt Crc Sum & Dtl     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$FKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Crc Sum & Dtl     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$GKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Detail line. of Prt Crc Sum & Dtl     PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     Z-ADDWULOA1    $HLOA1           Shipped Head Us
     C                     Z-ADDWUCSA1    $HCSA1           Resale Head Rec
      * CASE: CUR.TH Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
      * Rtv HPS Grp from Mvmt UP - STR HPS Interface  * 
     C                     CALL 'HP258'                90  Rtv HPS Grp fro
     C           WULMST    PARM WULMST    WQ0121  7        Return Code USR
     C                     PARM $HOXNB    WQ0122  70       TH HPS Movement
     C           $HBICD    PARM *BLANK    WQ0123  7        HPS Group Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP258'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: PAR.TFD Header Action-Crc Sum EQ WRK.Blank USR
     C           P5NKTX    IFEQ WUCRTX                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C                     Z-ADD*ZERO     $HD0PC           TH Avg Lean Per
      * TH Avg Lean Percent DRV
      * CASE: PAR.@Status (Rnd/Trn) is Rounded
     C           'T'       IFEQ 'R'                        *IF
     C           YL0030    MULT 1         $HD0PC    H      TH Avg Lean Per
     C                     ELSE
      * CASE: PAR.@Status (Rnd/Trn) is Truncated
     C           'T'       IFEQ 'T'                        *IF
     C                     Z-ADDYL0030    $HD0PC           TH Avg Lean Per
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     $HOBNB           TH Hot Wgt DRV
      * TH Hot Wgt DRV
      * CASE: PAR.@Status (Rnd/Trn) is Rounded
     C           'T'       IFEQ 'R'                        *IF
     C           YL0023    MULT 1         $HOBNB    H      TH Hot Wgt DRV
     C                     ELSE
      * CASE: PAR.@Status (Rnd/Trn) is Truncated
     C           'T'       IFEQ 'T'                        *IF
     C                     Z-ADDYL0023    $HOBNB           TH Hot Wgt DRV
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     $HOCNB           TH Avg Hot Wgt
      * TH Avg Hot Wgt DRV
      * CASE: PAR.@Status (Rnd/Trn) is Rounded
     C           'T'       IFEQ 'R'                        *IF
     C           YL0028    MULT 1         $HOCNB    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: PAR.@Status (Rnd/Trn) is Truncated
     C           'T'       IFEQ 'T'                        *IF
     C                     Z-ADDYL0028    $HOCNB           TH Avg Hot Wgt
     C                     END                             *FI
     C                     END                             *FI
      * Pricing UOM USR
      * CASE: PAR.BOH Quote Price Type is Entered
     C           P6B3ST    IFEQ 'CP'                       *IF
     C           P6B3ST    OREQ 'LP'
      * CASE: PAR.BOH Quote Price Type is Carcass Price
     C           P6B3ST    IFEQ 'CP'                       *IF
     C                     MOVEL'CW'      P8SNST           Pricing UOM USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'LW'      P8SNST           Pricing UOM USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Commod Group U/M  XF - STR Order Management Sys  * 
     C                     CALL 'PDUVXFR'              90  Rtv Commod Grou
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P6EUCD    WQ0124  7        BOH Commodity P
     C           P8SNST    PARM *BLANK    WQ0125  2        Pricing UOM USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * 10/10/07 slm condition print of base on difference in price and
      * carcass value
      * Donot prt 1-3 lns no diff in Base Market & Carcass Value
      * CASE: price and carcass value not = and car merit
      *  - c1 AND c3
      *   |- c1    : CUR.TH CM Base Carcass Value EQ CUR.TH CM Base Mkt P
      *   |- c3    : CUR.TH Payment Type is Carcass Merit
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HAOPR    IFEQ $HANPR                     *IF
     C           $HJ9ST    IFEQ 'C'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUP4ST           Status 1
     C                     END                             *FI
      * 5/29/03 New for sort loss print
      * CASE: PAR.Status 3 is Yes
     C           P8SVST    IFEQ 'Y'                        *IF
      * CASE: CUR.TH Hot Wgt DRV NE WRK.Zero USR
     C           $HOBNB    IFNE WUE9NB                     *IF
      * Var f/ Top Wgt /Carc CWT
      * CUR.TH CM Srt Dsc Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : LCL.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CUR.TH Hot Wgt DRV
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $HOBNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0041    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HD9PR           TH CM Srt Dsc C
     C                     END                             *FI
     C                     END                             *FI
      * Live Vs. Meat Price
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : PAR.Pricing UOM USR is Carcass Hundred Weight
      *   |- c2    : DB1.TH Payment Type is Carcass Merit
      *   |- c3    : PAR.Print Carcass Analysis Us is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P8SNST    IFEQ 'CW'                       *IF
     C                     MOVEL'0'       Y0CX02  1
     C           A1J9ST    IFEQ 'C'                        *IF
     C           P3MVST    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CW:  Switch Live & Carcass Weight & Average Weight.
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
     C                     Z-ADDYL0171    $HOBNB           TH Hot Wgt DRV
     C                     Z-ADDYL0027    $HHDNB           TH Avg Hot Wgt
     C                     MOVEL@CN,08    $HOETX           Text 25 1 USR
     C                     MOVEL@CN,09    $HOFTX           Text 25 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * LW:  Switch Live & Carcass Weight & Average Weight.
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,10    $HOETX           Text 25 1 USR
     C                     MOVEL@CN,11    $HOFTX           Text 25 2 USR
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    $HKPTX           Text 5
     C                     MOVEL'Adj.'    $HKPTX           Text 5
     C                     MOVELA1R6ST    WUR6ST           TH Paid 2 Week
      * The following values are calculated based on the Adj Live Wgt.
      * CASE: LCL.Th Live Adj Wgt Drv NE WRK.Zero USR
     C           YL0172    IFNE WUE9NB                     *IF
      * Base Market /Live CWT
      * CUR.TH CM Bse Mkt Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : LCL.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Th Live Adj Wgt Drv
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0172    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0040    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HD6PR           TH CM Bse Mkt L
      * Var f/ Top Wgt /Live CWT
      * CUR.TH CM Srt Dsc Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : LCL.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Th Live Adj Wgt Drv
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0172    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0041    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HD8PR           TH CM Srt Dsc L
      * Yield Gain/Loss /Live CWT
      * CUR.TH CM Yld G/L Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : LCL.TH CM Yield Gain/Loss Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Th Live Adj Wgt Drv
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0172    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0042    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HEAPR           TH CM Yld G/L L
      * Carcass Value /Live CWT
      * CUR.TH CM Crc Val Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : LCL.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Th Live Adj Wgt Drv
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0172    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0043    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HECPR           TH CM Crc Val L
      * Lean Prem/Ded /Live CWT
      * CUR.TH CM Lean Prem Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : LCL.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Th Live Adj Wgt Drv
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0172    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0044    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HEEPR           TH CM Lean Prem
      * Gross Value /Live CWT
      * CUR.TH CM Gross Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : LCL.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Th Live Adj Wgt Drv
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0172    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0045    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HEGPR           TH CM Gross Liv
     C                     END                             *FI
      * Producer Historical Average Add Reason.
      * CASE: DB1.TH PHA Add Reason is *None
     C           A1USST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $HI1TX           Condition Name
     C                     ELSE
      * CASE: *OTHERWISE
      * CUR.Condition Name 1 USR = Condition name of DB1.TH PHA Add Reaso
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1225368   Y2LSNO  70       List number
     C                     PARM A1USST    W0INVL 25        TH PHA Add Reas
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $HI1TX    PARM           W0CNNM 25        Condition Name
      *
      * CASE: DB1.TH PHA Add Type is Entire Tattoo
     C           A1OQET    IFEQ 'E'                        *IF
     C                     Z-ADD*ZERO     $HAWPC           TH Actual Yield
     C                     Z-ADDA1HHPC    $HCWPC           TH Adj Actual Y
     C                     END                             *FI
      * CASE: LCL.CMP Grading Type is Sort Discount Factor
     C           YL0179    IFEQ 'S'                        *IF
     C                     Z-ADD$HOMVJ    $HS9PR           TH PHA Lean Prm
     C                     MOVEL'%'       $HODTX           Text Usr 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $HODTX           Text Usr 1
     C                     END                             *FI
     C                     END                             *FI
     C                     MULT -1        $HTBPR           TH Excluded Gro
      * CASE: LCL.CMP Grading Type is Sort Discount Factor
     C           YL0179    IFEQ 'S'                        *IF
     C                     MOVEL@CN,12    $HP3TX           Desc 15 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $HP3TX           Desc 15 USR
     C                     MOVEL'Premium' $HP3TX           Desc 15 USR
     C                     END                             *FI
      * Description line text for variance from top wt , yeild gain/loss
      * or Blank, Fixed Cost or the Carcass Value, or the Quality
      * Premium/Deduct or the Lean Premium/Deduct
      * Create the Text of the above lines on the Carcass Summary Sheet
     C                     EXSR UBSUBR                     Create the Text
     C                     MOVEL*BLANK    $HNBCD           Lean Rng Hdg TO
     C                     MOVEL'  TOTAL' $HNBCD           Lean Rng Hdg TO
     C           $HM2NB    ADD  $HM3NB    $HLQA1           Lean Rng Tto Cn
     C                     ADD  $HM4NB    $HLQA1           Lean Rng Tto Cn
     C                     ADD  $HM5NB    $HLQA1           Lean Rng Tto Cn
     C                     ADD  $HM6NB    $HLQA1           Lean Rng Tto Cn
     C                     ADD  $HM7NB    $HLQA1           Lean Rng Tto Cn
     C                     ADD  $HM8NB    $HLQA1           Lean Rng Tto Cn
     C                     ADD  $HM9NB    $HLQA1           Lean Rng Tto Cn
     C           $HNANB    ADD  $HNBNB    $HLRA1           Lean Rng Prd Cn
     C                     ADD  $HNCNB    $HLRA1           Lean Rng Prd Cn
     C                     ADD  $HNDNB    $HLRA1           Lean Rng Prd Cn
     C                     ADD  $HNENB    $HLRA1           Lean Rng Prd Cn
     C                     ADD  $HNFNB    $HLRA1           Lean Rng Prd Cn
     C                     ADD  $HNGNB    $HLRA1           Lean Rng Prd Cn
     C                     ADD  $HNHNB    $HLRA1           Lean Rng Prd Cn
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert BOH Buy Order Date to display format
      * Convert date
     C           1000000   ADD  $HARDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHARDT
      * Convert PY As of Kill Date to display format
      * Convert date
     C           1000000   ADD  $HCHDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHCHDT
     C                     MOVEL'0'       *IN79
     C           WUYZST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUP4ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           $HAWPC    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WUP5ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           P3MVST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           $HU6PR    IFEQ 0                          *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           $HU7PR    IFEQ 0                          *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           WUSVST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           $HU8PR    IFEQ 0                          *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           $HU9PR    IFEQ 0                          *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN69
     C           $HVAPR    IFEQ 0                          *IF
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL'0'       *IN68
     C           $HVBPR    IFEQ 0                          *IF
     C                     MOVEL'1'       *IN68
     C                     END                             *FI
     C                     MOVEL'0'       *IN67
     C           $HVCPR    IFEQ 0                          *IF
     C                     MOVEL'1'       *IN67
     C                     END                             *FI
     C                     MOVEL'0'       *IN66
     C           $HVDPR    IFEQ 0                          *IF
     C                     MOVEL'1'       *IN66
     C                     END                             *FI
     C                     MOVEL'0'       *IN65
     C           $HLQA1    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN65
     C                     END                             *FI
     C                     MOVEL'0'       *IN64
     C           $HLRA1    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN64
     C                     END                             *FI
     C                     MOVEL'0'       *IN63
     C           $HI1TX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN63
     C                     END                             *FI
     C                     MOVEL'0'       *IN62
     C           $HE1ST    IFEQ *BLANK                     *IF
     C           $HE1ST    OREQ 'N'
     C                     MOVEL'1'       *IN62
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Carcass Detail,Fx PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Carcass Detail,Fx PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Carcass Detail,Fx PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print BOL Load Number of Prt Carcass Detail,Fx PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Carcass Detail,Fx PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Tattoo Number format
      * CUR = PAR By name
     C                     Z-ADDYL0182    $JARDT           BOH Buy Order D
     C                     Z-ADDYL0011    $JAWDT           TH Purchase Dat
     C                     Z-ADD$IHMNB    $JHMNB           BOH Company Num
     C                     MOVELYL0145    $JABCD           PD Producer Cod
     C                     Z-ADD$ICVNB    $JCVNB           TH Tattoo Numbe
     C                     Z-ADD$IBNNB    $JBNNB           BOH Buy Order N
     C                     Z-ADD$IBONB    $JBONB           BOL Load Number
     C                     Z-ADD$IOXNB    $JOXNB           TH HPS Movement
     C                     MOVEL$IBICD    $JBICD           TH Group Refere
     C                     MOVELYL0151    $JAGTX           PD Name
      * CASE: PAR.CMP Grading Type is Meat Value
     C           YL0179    IFEQ 'M'                        *IF
     C                     MOVEL@CN,24    $JSUTX           Text 17 USR
     C                     MOVEL@CN,25    $JUITX           Text 25 #2 Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,26    $JSUTX           Text 17 USR
     C                     MOVEL@CN,27    $JUITX           Text 25 #2 Usr
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Purchase Date to display format
      * Convert date
     C           1000000   ADD  $JAWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VJAWDT
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $JB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VJB0DT
     C                     MOVEL'0'       *IN79
     C           P3MVST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WN0061    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WN0062    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      * Print format
     C                     WRITE$JKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE 'P'       W0BP03
     C                     END                             FI
      * Print CD Carcass/Hot Weight of Prt Carcass Detail,Fx PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$KKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Detail line. of Prt Carcass Detail,Fx PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL*BLANK    WUNCCD           Summary Only Us
     C                     MOVEL'1'       WUNCCD           Summary Only Us
      * PK0166 -- commented out. The selection is done in the Initialize
      * CASE: PAR.Status 2 is No
     C           WN0062    IFEQ 'N'                        *IF
     C                     MOVEL'N'       WUABST           @Status (Yes/No
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUABST           @Status (Yes/No
     C                     END                             *FI
     C                     Z-ADD*ZERO     $LD1PC           CD Lean Percent
      * CD Lean Percent DRV
      * CASE: PAR.@Status (Rnd/Trn) is Rounded
     C           'T'       IFEQ 'R'                        *IF
     C           $LAUPC    MULT 1         $LD1PC    H      CD Lean Percent
     C                     ELSE
      * CASE: PAR.@Status (Rnd/Trn) is Truncated
     C           'T'       IFEQ 'T'                        *IF
     C                     Z-ADD$LAUPC    $LD1PC           CD Lean Percent
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     $LE5PR           Variance f/TopW
      * Variance f/TopWgt/CWT DRV
     C           $LEYNB    SUB  $LB4PR    $LE5PR           Variance f/TopW
     C                     Z-ADD*ZERO     $LE4PR           Variance from t
      * Variance from top wgt DRV
     C           $LAVPR    SUB  $LB1PR    $LE4PR           Variance from t
      * 11/28/2006 PKD/RMC Do not calculate using the Gross Before Sort.
      * **** 5/29/03 New for sort loss print
      * CASE: PAR.Status 3 is Yes
     C           P8SVST    IFEQ 'Y'                        *IF
     C                     Z-ADDB1PEIR    $LE4PR           Variance from t
      * Comp:sort loss/cwt
      * CUR.Variance f/TopWgt/CWT DRV =
      *    *COMPUTE (x1 /(x2/x3))
      * x1    : DB1.CD MPR Sort Loss
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           B1EWNB    DIV  100       W0WB01           *Synon (15,5) w
     C           B1PEIR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $LE5PR           Variance f/TopW
     C                     END                             *FI
      * ****
      * Adjust/Add Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CUR.CD Record Add/Del Sts is Add
      *   |- c2    : CUR.CD Adjust/Add Type is None
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $LINST    IFEQ 'A'                        *IF
     C           $LUTST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'AVG'     $LUTST           CD Adjust/Add T
     C                     END                             *FI
      * CASE: PAR.CMP Grading Type is Meat Value
     C           YL0179    IFEQ 'M'                        *IF
     C                     Z-ADD$LORUE    $LAVPR           CD Crc Value $
      * CUR.CD Crc Value Per CWT
      * CUR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.CD Fixed Cost Factor Amt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.CD Carcass/Hot Weight
      * *     : PGM.*Synon (15,2) work field *
      * x3    : CON.100
     C           $LORUE    DIV  $LEWNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $LEYNB           CD Crc Value Pe
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert CD Adjust/Add Type to external value
     C                     Z-ADD1225355   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL$LUTST    Y2INVL           CD Adjust/Add T
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    VLUTST           CD Adjust/Add T
      *
     C                     MOVEL'0'       *IN79
     C           WN0061    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUABST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$LCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$LDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Excluded Carc Dta PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Excluded Carc Dta PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Excluded Carc Dta PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print BOL Load Number of Prt Excluded Carc Dta PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Excluded Carc Dta PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of Prt Excluded Carc Dta PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$NDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of Prt TH Comments       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print BOH Company Number of Prt TH Comments       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt TH Comments       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print BOL Load Number of Prt TH Comments       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt TH Comments       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print TH Kill Date of Prt TH Comments       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP04
     C                     END                             FI
      * Print THC Comment Type of Prt TH Comments       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP05
     C                     END                             FI
      * Print THC Comment Line of Prt TH Comments       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP06
     C                     END                             FI
      * Print Detail line. of Prt TH Comments       PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$PCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$PDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of Prt BOL Summary Totals PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print BOH Company Number of Prt BOL Summary Totals PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of BOH Company Number format
      * CASE: PAR.Summary Only Usr is Summary Only
     C           WUNCCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       W0NEWP           *Print New Page
     C                     END                             *FI
      * Meat cmp - Print the Live Weight and the Net amount if paid LV
     C                     MOVEL'N'       YL0194           Status 4
      * CASE: PAR.CMP Grading Type is Meat Value
     C           YL0179    IFEQ 'M'                        *IF
     C                     MOVEL'Y'       YL0194           Status 4
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
     C                     MOVEL'0'       *IN79
     C           YL0180    IFEQ 'Standard'                 *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$RKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt BOL Summary Totals PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP01    ANDEQ'P'
      * USER: On print of BOH Buy Order Number format
     C                     MOVEL'N'       W0PFM            *Print format
      * Reset format print flag
     C                     MOVE *BLANK    W0EP01
     C                     END                             FI
      * Print BOL Load Number of Prt BOL Summary Totals PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP02    ANDEQ'P'
      * USER: On print of BOL Load Number format
     C                     MOVEL'N'       W0PFM            *Print format
      * Reset format print flag
     C                     MOVE *BLANK    W0EP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt BOL Summary Totals PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP03    ANDEQ'P'
      * USER: On print of TH Tattoo Number format
      * Meat cmp -
     C                     MOVEL'N'       YL0194           Status 4
      * CASE: PAR.CMP Grading Type is Meat Value
     C           YL0179    IFEQ 'M'                        *IF
     C                     MOVEL'Y'       YL0194           Status 4
     C                     END                             *FI
      * Reset format print flag
     C                     MOVE *BLANK    W0EP03
     C                     END                             FI
      * Print Detail line. of Prt BOL Summary Totals PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVELWBCWST    YL0195           TH Payment Sts
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL*BLANK    $TUPTX           Text of 35 size
     C                     MOVEL*BLANK    YL0196           Text of 35 size
      * CASE: PAR.Carcass Summary BOL USR is Standard
     C           YL0180    IFEQ 'Standard'                 *IF
      * NXT.Text of 35 size  Usr = Condition name of DB1.TH Hog Class Typ
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM WBLLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $TUPTX    PARM           W0CNNM 25        Text of 35 size
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Text of 35 size  Usr = Condition name of DB1.TH Hog Class Typ
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM WBLLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           YL0196    PARM           W0CNNM 25        Text of 35 size
      *
      * Rtv Tattoo Def-10 Dsc RT - Tattoo Defect  * 
     C                     EXSR TLRVGN
     C                     Z-ADD1         ZQ      50
     C           YL0196    CAT  YL0197:ZQ $TUPTX    P      Text of 35 size
     C                     END                             *FI
     C                     ADD  WBCXNB    WULSA1           Tot Doa Usr
     C                     ADD  WBCWNB    WULTA1           Tot Received He
     C                     ADD  WBFCNB    WULUA1           Tot Yard Deads
     C                     ADD  WBFDNB    WULVA1           Tot Head Cmnd U
     C                     ADD  WBFENB    WULWA1           Tot Killed Head
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$SCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$SDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0AP00    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Crc Sum & Dtl     PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Crc Sum & Dtl     PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  8         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Crc Sum & Dtl     PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Crc Sum & Dtl     PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Crc Sum & Dtl     PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Crc Sum & Dtl     PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD69        W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Carcass Detail,Fx PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Carcass Detail,Fx PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Carcass Detail,Fx PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Carcass Detail,Fx PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Carcass Detail,Fx PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  10        W0FSUM
     C                     END                             FI
      *
      * * CD Carcass/Hot Weight of Prt Carcass Detail,Fx PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Carcass Detail,Fx PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Excluded Carc Dta PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Excluded Carc Dta PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Excluded Carc Dta PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Excluded Carc Dta PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Excluded Carc Dta PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Excluded Carc Dta PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt TH Comments       PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt TH Comments       PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt TH Comments       PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt TH Comments       PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt TH Comments       PO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt TH Comments       PO
     C           W0DP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * THC Comment Type of Prt TH Comments       PO
     C           W0DP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * THC Comment Line of Prt TH Comments       PO
     C           W0DP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt TH Comments       PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD2         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt BOL Summary Totals PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt BOL Summary Totals PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  4         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt BOL Summary Totals PO
     C           W0EP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt BOL Summary Totals PO
     C           W0EP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt BOL Summary Totals PO
     C           W0EP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt BOL Summary Totals PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Lean Hdg/Rng      RT - Crc Sum Lean Dist Range  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CXHONB    WQSA01           CC Company Numb
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           CC Company Numb
      * Establish starting position
     C           KRSSA     SETLL@CXREOL                    *
     C           KRSSA     READE@CXREOL                  90*
      * Data record not found
     C   90                MOVEL'PRK0420' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CLDR Sequence is = 1
     C           CXMCNB    IFEQ 1                          *IF
     C                     MOVELCXDTCD    P2DVCD           Lean Rng Hdg 1
     C                     Z-ADDCXBWPC    P2CXPC           Lean Rng Min 1
     C                     Z-ADDCXBXPC    P2CYPC           Lean Rng Max 1
     C                     ELSE
      * CASE: DB1.CLDR Sequence is = 2
     C           CXMCNB    IFEQ 2                          *IF
     C                     MOVELCXDTCD    P2DWCD           Lean Rng Hdg 2
     C                     Z-ADDCXBWPC    P2CZPC           Lean Rng Min 2
     C                     Z-ADDCXBXPC    P2C0PC           Lean Rng Max 2
     C                     ELSE
      * CASE: DB1.CLDR Sequence is = 3
     C           CXMCNB    IFEQ 3                          *IF
     C                     MOVELCXDTCD    P2DXCD           Lean Rng Hdg 3
     C                     Z-ADDCXBWPC    P2C1PC           Lean Rng Min 3
     C                     Z-ADDCXBXPC    P2C2PC           Lean Rng Max 3
     C                     ELSE
      * CASE: DB1.CLDR Sequence is = 4
     C           CXMCNB    IFEQ 4                          *IF
     C                     MOVELCXDTCD    P2DYCD           Lean Rng Hdg 4
     C                     Z-ADDCXBWPC    P2C3PC           Lean Rng Min 4
     C                     Z-ADDCXBXPC    P2C4PC           Lean Rng Max 4
     C                     ELSE
      * CASE: DB1.CLDR Sequence is = 5
     C           CXMCNB    IFEQ 5                          *IF
     C                     MOVELCXDTCD    P2DZCD           Lean Rng Hdg 5
     C                     Z-ADDCXBWPC    P2C5PC           Lean Rng Min 5
     C                     Z-ADDCXBXPC    P2C6PC           Lean Rng Max 5
     C                     ELSE
      * CASE: DB1.CLDR Sequence is = 6
     C           CXMCNB    IFEQ 6                          *IF
     C                     MOVELCXDTCD    P2D0CD           Lean Rng Hdg 6
     C                     Z-ADDCXBWPC    P2C7PC           Lean Rng Min 6
     C                     Z-ADDCXBXPC    P2C8PC           Lean Rng Max 6
     C                     ELSE
      * CASE: DB1.CLDR Sequence is = 7
     C           CXMCNB    IFEQ 7                          *IF
     C                     MOVELCXDTCD    P2D1CD           Lean Rng Hdg 7
     C                     Z-ADDCXBWPC    P2C9PC           Lean Rng Min 7
     C                     Z-ADDCXBXPC    P2DAPC           Lean Rng Max 7
     C                     ELSE
      * CASE: DB1.CLDR Sequence is = 8
     C           CXMCNB    IFEQ 8                          *IF
     C                     MOVELCXDTCD    P2D2CD           Lean Rng Hdg 8
     C                     Z-ADDCXBWPC    P2DBPC           Lean Rng Min 8
     C                     Z-ADDCXBXPC    P2DCPC           Lean Rng Max 8
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@CXREOL                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Carcass Sum Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDA1HMNB    AWHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSB     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUARDT           BOH Buy Order D
     C                     MOVEL*BLANK    P6B3ST           BOH Quote Price
     C                     MOVEL*BLANK    P6ETCD           BOH Commodity M
     C                     MOVEL*BLANK    P6EUCD           BOH Commodity P
     C                     MOVEL*BLANK    P6AMCD           CMP Program Cod
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAWARDT    WUARDT           BOH Buy Order D
     C                     MOVELAWB3ST    P6B3ST           BOH Quote Price
     C                     MOVELAWETCD    P6ETCD           BOH Commodity M
     C                     MOVELAWEUCD    P6EUCD           BOH Commodity P
     C                     MOVELAWAMCD    P6AMCD           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv CMP Payment Info  RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ARAMCD           CMP Program Cod
      * Setup key
     C                     MOVELP6AMCD    ARAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSC     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUDLST           CMP Grading Typ
     C                     MOVEL*BLANK    P7DMST           CMP Sort Basis
     C                     Z-ADD*ZERO     WUVEPR           CMP % of Carcas
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELARDLST    WUDLST           CMP Grading Typ
     C                     MOVELARDMST    P7DMST           CMP Sort Basis
     C                     Z-ADDARVEPR    WUVEPR           CMP % of Carcas
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    DNHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    DNBONB           BOL Load Number
     C                     Z-ADDP1CVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSD     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUNYCD           PS Site ID
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    WUNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Prod Loc Dlv CoMilRT - Producer Site Mileage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ASABCD           PD Producer Cod
     C                     KFLD           ASNYCD           PS Site ID
     C                     KFLD           ASLKA1           PSM Company Num
      * Setup key
     C                     MOVELA1ABCD    ASABCD           PD Producer Cod
     C                     MOVELWUNYCD    ASNYCD           PS Site ID
     C                     Z-ADDA1HMNB    ASLKA1           PSM Company Num
      * Establish starting position
     C           KRSSE     CHAIN@ASREK9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $DLLA1           PSM Miles to Co
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDASLLA1    $DLLA1           PSM Miles to Co
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFINFN    BEGSR
      *================================================================
      * Mve Parm to Another Parm - Tattoo Header  * 
      *================================================================
      * Mve Parm to Another Parm
      * PR3 = PR1 By name
     C                     Z-ADDWL0001    WL0148           TH Purchase Dat
     C                     MOVELWL0002    WL0149           TH Group Refere
     C                     MOVELWL0003    WL0150           TH Live Purchas
     C                     Z-ADDWL0004    WL0151           TH Live Purchas
     C                     Z-ADDWL0005    WL0152           TH Live Gross A
     C                     Z-ADDWL0006    WL0153           TH LIve Net Amt
     C                     MOVELWL0007    WL0154           TH Resale UOM
     C                     Z-ADDWL0008    WL0155           TH Recalc Live
     C                     Z-ADDWL0009    WL0156           TH Pricing Date
     C                     MOVELWL0010    WL0157           TH Resale Sprea
     C                     Z-ADDWL0011    WL0158           TH Dead On Arri
     C                     Z-ADDWL0012    WL0159           TH Head Receive
     C                     Z-ADDWL0013    WL0160           TH Yard Deads
     C                     Z-ADDWL0014    WL0161           TH Held Over
     C                     Z-ADDWL0015    WL0162           TH Head Condemn
     C                     Z-ADDWL0016    WL0163           TH Head Killed
     C                     Z-ADDWL0017    WL0164           TH Head Adds
     C                     Z-ADDWL0018    WL0165           TH Head Accepte
     C                     Z-ADDWL0019    WL0166           TH Live Wgt
     C                     Z-ADDWL0020    WL0167           TH Adj Live Wgt
     C                     Z-ADDWL0021    WL0168           TH Hot Wgt
     C                     Z-ADDWL0022    WL0169           TH Tot Loin Eye
     C                     Z-ADDWL0023    WL0170           TH Tot Backfat
     C                     Z-ADDWL0024    WL0171           TH Tot Light Re
     C                     Z-ADDWL0025    WL0172           TH Avg Live Wgt
     C                     Z-ADDWL0026    WL0173           TH Avg Hot Wgt
     C                     Z-ADDWL0027    WL0174           TH Avg Light Re
     C                     Z-ADDWL0028    WL0175           TH Avg Lean Per
     C                     Z-ADDWL0029    WL0176           TH Avg Loin Eye
     C                     Z-ADDWL0030    WL0177           TH Avg Backfat
     C                     Z-ADDWL0031    WL0178           TH Std Yield Pe
     C                     Z-ADDWL0032    WL0179           TH Actual Yield
     C                     Z-ADDWL0033    WL0180           TH Adj Actual Y
     C                     Z-ADDWL0034    WL0181           TH Yield Differ
     C                     Z-ADDWL0035    WL0182           TH Recalc Live
     C                     Z-ADDWL0036    WL0183           TH CM Market Pr
     C                     Z-ADDWL0037    WL0184           TH CM Base Mkt
     C                     Z-ADDWL0038    WL0185           TH CM Base Mkt
     C                     Z-ADDWL0039    WL0186           TH CM Sort Disc
     C                     Z-ADDWL0040    WL0187           TH CM Yield Gai
     C                     Z-ADDWL0041    WL0188           TH CM Base Carc
     C                     Z-ADDWL0042    WL0189           TH CM LN AddOn/
     C                     Z-ADDWL0043    WL0190           TH CM Carcass G
     C                     Z-ADDWL0044    WL0191           TH Deduction Am
     C                     Z-ADDWL0045    WL0192           TH Total Net WO
     C                     Z-ADDWL0046    WL0193           TH Carcass Net
     C                     Z-ADDWL0047    WL0194           TH Additions Am
     C                     Z-ADDWL0048    WL0195           TH Payment Gros
     C                     Z-ADDWL0049    WL0196           Th Payment Net
     C                     Z-ADDWL0050    WL0197           TH AP Voucher/D
     C                     Z-ADDWL0051    WL0198           TH Freight Amou
     C                     Z-ADDWL0052    WL0199           TH Accrual Amou
     C                     Z-ADDWL0053    WL0200           TH Fixed Cost A
     C                     MOVELWL0054    WL0201           TH Calc Net Sts
     C                     MOVELWL0055    WL0202           TH Payment Sts
     C                     MOVELWL0056    WL0203           TH Header Error
     C                     MOVELWL0057    WL0204           TH Detail Error
     C                     MOVELWL0058    WL0205           TH Kill Balanci
     C                     MOVELWL0059    WL0206           TH Bal to Kill
     C                     Z-ADDWL0060    WL0207           TH Commission A
     C                     Z-ADDWL0061    WL0208           TH Voucher Paym
     C                     MOVELWL0062    WL0209           TH User Error O
     C                     MOVELWL0063    WL0210           TH Held Over Re
     C                     MOVELWL0064    WL0211           TH Sex
     C                     Z-ADDWL0065    WL0212           TH Held/Ovr Com
     C                     Z-ADDWL0066    WL0213           TH Commission P
     C                     Z-ADDWL0067    WL0214           TH Actual Check
     C                     Z-ADDWL0068    WL0215           TH Shipped Weig
     C                     Z-ADDWL0069    WL0216           TH Avg Hot Wgt
     C                     Z-ADDWL0070    WL0217           TH FFLI
     C                     Z-ADDWL0071    WL0218           TH Kill Product
     C                     Z-ADDWL0072    WL0219           TH Cut Product
     C                     Z-ADDWL0073    WL0220           TH Render Produ
     C                     Z-ADDWL0074    WL0221           TH Head Exclude
     C                     Z-ADDWL0075    WL0222           TH CM Bse Mkt L
     C                     Z-ADDWL0076    WL0223           TH CM Bse Mkt C
     C                     Z-ADDWL0077    WL0224           TH CM Srt Dsc L
     C                     Z-ADDWL0078    WL0225           TH CM Srt Dsc C
     C                     Z-ADDWL0079    WL0226           TH CM Yld G/L L
     C                     Z-ADDWL0080    WL0227           TH CM Yld G/L C
     C                     Z-ADDWL0081    WL0228           TH CM Crc Val L
     C                     Z-ADDWL0082    WL0229           TH CM Crc Val C
     C                     Z-ADDWL0083    WL0230           TH CM Lean Prem
     C                     Z-ADDWL0084    WL0231           TH CM Lean Prem
     C                     Z-ADDWL0085    WL0232           TH CM Gross Liv
     C                     Z-ADDWL0086    WL0233           TH CM Gross Car
     C                     MOVELWL0087    WL0234           TH Source Type
     C                     MOVELWL0088    WL0235           TH Scale Ticket
     C                     MOVELWL0089    WL0236           TH Payment Type
     C                     Z-ADDWL0090    WL0237           TH HPS Movement
     C                     MOVELWL0091    WL0238           TH Source Code
     C                     MOVELWL0092    WL0239           TH Hog Class Ty
     C                     MOVELWL0093    WL0240           TH Posted to HP
     C                     MOVELWL0094    WL0241           TH Schedule Kil
     C                     MOVELWL0095    WL0242           TH Shift Held O
     C                     MOVELWL0096    WL0243           TH State
     C                     MOVELWL0097    WL0244           TH Unused Code
     C                     MOVELWL0098    WL0245           TH Unused Sts 2
     C                     MOVELWL0099    WL0246           TH Commission S
     C                     MOVELWL0100    WL0247           TH Paid 2 Week
     C                     MOVELWL0101    WL0248           TH Unused Sts 1
     C                     Z-ADDWL0102    WL0249           TH DOA Weight
     C                     Z-ADDWL0103    WL0250           TH Avg Lean % E
     C                     Z-ADDWL0104    WL0251           TH HPS Farm Sit
     C                     Z-ADDWL0105    WL0252           TH Shift Held O
     C                     Z-ADDWL0106    WL0253           TH Sorting Amou
     C                     Z-ADDWL0107    WL0254           TH Head Identif
     C                     Z-ADDWL0108    WL0255           TH Percent Iden
     C                     Z-ADDWL0109    WL0256           TH Percent Acce
     C                     Z-ADDWL0110    WL0257           TH Head Adjuste
     C                     Z-ADDWL0111    WL0258           TH PHA Head Add
     C                     MOVELWL0112    WL0259           TH PHA Add Type
     C                     MOVELWL0113    WL0260           TH PHA Average
     C                     MOVELWL0114    WL0261           TH PHA Add Reas
     C                     Z-ADDWL0115    WL0262           TH PHA Yield Pe
     C                     Z-ADDWL0116    WL0263           TH PHA Lean Prm
     C                     Z-ADDWL0117    WL0264           TH VC Gross Val
     C                     Z-ADDWL0118    WL0265           TH Excluded Gro
     C                     Z-ADDWL0119    WL0266           TH Avg Lean %
     C                     Z-ADDWL0120    WL0267           TH Broken Back
     C                     Z-ADDWL0121    WL0268           TH Hot Scl Uplo
     C                     Z-ADDWL0122    WL0269           TH Unused Nbr 4
     C                     Z-ADDWL0123    WL0270           TH Excluded Car
     C                     Z-ADDWL0124    WL0271           TH Excluded Pre
     C                     Z-ADDWL0125    WL0272           TH Unused Nbr 7
     C                     Z-ADDWL0126    WL0273           TH Unused Nbr 8
     C                     Z-ADDWL0127    WL0274           TH Unused Nbr 9
     C                     Z-ADDWL0128    WL0275           TH Unused Nbr 1
     C                     Z-ADDWL0129    WL0276           TH Break Even P
     C                     Z-ADDWL0130    WL0277           TH Meat Value F
     C                     Z-ADDWL0131    WL0278           TH Yld Parm Adj
     C                     Z-ADDWL0132    WL0279           TH PHA Sort Dis
     C                     Z-ADDWL0133    WL0280           TH Avg Loin Eye
     C                     Z-ADDWL0134    WL0281           TH Avg Backfat
     C                     Z-ADDWL0135    WL0282           TH HITCH Old Pa
     C                     Z-ADDWL0136    WL0283           TH MPR Sort Los
     C                     Z-ADDWL0137    WL0284           TH Unused Nbr 1
     C                     Z-ADDWL0138    WL0285           TH Unused Nbr 2
     C                     Z-ADDWL0139    WL0286           TH Cold Scl Upl
     C                     Z-ADDWL0140    WL0287           TH Cold Scl Upl
     C                     MOVELWL0141    WL0288           DF Defect Code
     C                     MOVELWL0142    WL0289           THP Process Cod
     C                     MOVELWL0143    WL0290           PD Producer Cod
     C                     MOVELWL0144    WL0291           PL Location Cod
     C                     MOVELWL0145    WL0292           HB Buyer Code
     C                     MOVELWL0146    WL0293           GN Genetic Code
     C                     MOVELWL0147    WL0294           HC Class Code
     C                     GOTO SFEXIT                     *QUIT
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0006  72       TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0007  72       TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0008  72       TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0009  72       TH CA Base Carc
     C                     Z-ADD*ZERO     WN0010  72       TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0011  72       TH CA Carcass G
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0150           TH Kill Date
     C                     Z-ADD*ZERO     YL0013           TH Dead On Arri
     C                     Z-ADD*ZERO     YL0014           TH Head Receive
     C                     Z-ADD*ZERO     YL0015           TH Yard Deads
     C                     Z-ADD*ZERO     YL0017           TH Head Condemn
     C                     Z-ADD*ZERO     YL0018           TH Head Killed
     C                     Z-ADD*ZERO     YL0019           TH Head Adds
     C                     Z-ADD*ZERO     YL0021           TH Live Wgt
     C                     Z-ADD*ZERO     YL0022           TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0023           TH Hot Wgt
     C                     Z-ADD*ZERO     YL0040           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0041           TH CM Sort Disc
     C                     Z-ADD*ZERO     YL0042           TH CM Yield Gai
     C                     Z-ADD*ZERO     YL0043           TH CM Base Carc
     C                     Z-ADD*ZERO     YL0044           TH CM LN AddOn/
     C                     Z-ADD*ZERO     YL0045           TH CM Carcass G
     C                     Z-ADD*ZERO     YL0046           TH Deduction Am
     C                     Z-ADD*ZERO     YL0048           TH Carcass Net
     C                     Z-ADD*ZERO     YL0049           TH Additions Am
     C                     Z-ADD*ZERO     YL0050           TH Payment Gros
     C                     Z-ADD*ZERO     YL0051           Th Payment Net
     C                     Z-ADD*ZERO     YL0076           TH Head Exclude
     C                     Z-ADD*ZERO     YL0112           TH Head Adjuste
     C                     Z-ADD*ZERO     YL0113           TH PHA Head Add
     C                     Z-ADD*ZERO     YL0120           TH Excluded Gro
     C                     Z-ADD*ZERO     YL0125           TH Excluded Car
     C                     Z-ADD*ZERO     YL0126           TH Excluded Pre
     C                     Z-ADD*ZERO     WN0001           Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0002           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0003           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0006           TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0007           TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0008           TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0009           TH CA Base Carc
     C                     Z-ADD*ZERO     WN0010           TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0011           TH CA Carcass G
     C                     Z-ADD*ZERO     WN0004           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0005           Loin-Eye * Wgt
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSG02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSG03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQSG04           TH Tattoo Numbe
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           BOH Buy Order N
     C                     KFLD           WQSG03           BOL Load Number
     C                     KFLD           WQSG04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDA1HMNB    WQSG01           BOH Company Num
     C                     Z-ADDA1BNNB    WQSG02           BOH Buy Order N
     C                     Z-ADDA1BONB    WQSG03           BOL Load Number
     C                     Z-ADDA1CVNB    WQSG04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSG     SETLL@A1CPC4                    *
     C           KRSSG     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Kill Date
      * CASE: WRK.First Time Flag Usr is Yes
     C           WUHBST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     END                             *FI
     C                     Z-ADDA1B0DT    YL0150           TH Kill Date
     C                     ADD  A1CXNB    YL0013           TH Dead On Arri
     C                     ADD  A1CWNB    YL0014           TH Head Receive
     C                     ADD  A1FCNB    YL0015           TH Yard Deads
     C                     ADD  A1FDNB    YL0017           TH Head Condemn
     C                     ADD  A1FENB    YL0018           TH Head Killed
     C                     ADD  A1HENB    YL0019           TH Head Adds
     C                     ADD  A1CYNB    YL0021           TH Live Wgt
     C                     ADD  A1LRNB    YL0022           TH Adj Live Wgt
     C                     ADD  A1E0NB    YL0023           TH Hot Wgt
     C                     ADD  A1ANPR    YL0040           TH CM Base Mkt
      * 5/29/03 new for sort loss print
      * CASE: PAR.Status 3 is Yes
     C           P8SVST    IFEQ 'Y'                        *IF
     C                     ADD  A1NCHF    YL0041           TH CM Sort Disc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  A1AYVA    YL0041           TH CM Sort Disc
     C                     END                             *FI
     C                     ADD  A1AWVA    YL0042           TH CM Yield Gai
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WUDLST    IFEQ 'M'                        *IF
     C                     ADD  A1A2PR    YL0043           TH CM Base Carc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  A1AOPR    YL0043           TH CM Base Carc
     C                     END                             *FI
     C                     ADD  A1AXVA    YL0044           TH CM LN AddOn/
     C                     ADD  A1APPR    YL0045           TH CM Carcass G
     C                     ADD  A1ATPR    YL0048           TH Carcass Net
     C                     ADD  A1CBPR    YL0050           TH Payment Gros
     C                     ADD  A1CCPR    YL0051           Th Payment Net
      * Lean % * Wgt USR
      * PAR.Lean % * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Lean % * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Lean Percent
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           A1F4NB    MULT A1E0NB    W0WD01           *Synon (17,7) w
     C           WN0001    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0001           Lean % * Wgt US
      * Backfat * Wgt USR
      * PAR.Backfat * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Backfat * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Backfat
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           A1F2NB    MULT A1E0NB    W0WD01           *Synon (17,7) w
     C           WN0002    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0002           Backfat * Wgt U
      * Loin-Eye * Wgt USR
      * PAR.Loin-Eye * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Loin-Eye * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Loin Eye Depth
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           A1F3NB    MULT A1E0NB    W0WD01           *Synon (17,7) w
     C           WN0003    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0003           Loin-Eye * Wgt
      * Backfat2 * Wgt USR
      * PAR.Backfat * Wgt USR 2 =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Backfat * Wgt USR 2
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Backfat - 2 Dec
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           A1MCNF    MULT A1E0NB    W0WD01           *Synon (17,7) w
     C           WN0004    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0004           Backfat * Wgt U
      * Loin-Eye2 * Wgt USR
      * PAR.Loin-Eye * Wgt USR 2 =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Loin-Eye * Wgt USR 2
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Loin Eye - 2 dec
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           A1MVNF    MULT A1E0NB    W0WD01           *Synon (17,7) w
     C           WN0005    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0005           Loin-Eye * Wgt
     C                     ADD  A1ASPR    YL0046           TH Deduction Am
     C                     ADD  A1A5VA    YL0049           TH Additions Am
      * Analysis to Payments
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           P3MVST    IFEQ 'Y'                        *IF
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header EXT  * 
     C                     EXSR SHRVGN
     C                     ADD  WUI6PR    WN0006           TH CA Base Mkt
     C                     ADD  WUI7PR    WN0007           TH CA Sort Disc
     C                     ADD  WUI8PR    WN0008           TH CA Yield Gai
     C                     ADD  WUI9PR    WN0009           TH CA Base Carc
     C                     ADD  WUJAPR    WN0010           TH CA Lean Prem
     C                     ADD  WUJCPR    WN0011           TH CA Carcass G
     C                     END                             *FI
      * PK0166 - New fields
     C                     ADD  A1J9NB    YL0076           TH Head Exclude
     C                     ADD  A1TBPR    YL0120           TH Excluded Gro
     C                     ADD  A1KROT    YL0125           TH Excluded Car
     C                     ADD  A1OTJG    YL0126           TH Excluded Pre
     C                     ADD  A1IORP    YL0112           TH Head Adjuste
     C                     ADD  A1OWEO    YL0113           TH PHA Head Add
     C           KRSSG     READE@A1CPC4                  90*
     C                     ENDDO
      * USER: Exit processing
      * Analysis to Payments
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           P3MVST    IFEQ 'Y'                        *IF
     C                     Z-ADDWN0006    YL0040           TH CM Base Mkt
     C                     Z-ADDWN0007    YL0041           TH CM Sort Disc
     C                     Z-ADDWN0008    YL0042           TH CM Yield Gai
     C                     Z-ADDWN0009    YL0043           TH CM Base Carc
     C                     Z-ADDWN0010    YL0044           TH CM LN AddOn/
     C                     Z-ADDWN0011    YL0045           TH CM Carcass G
     C                     END                             *FI
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDA1HMNB    DNHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    DNBONB           BOL Load Number
     C                     Z-ADDA1CVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSH     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WUI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WUI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WUI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WUJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WUJCPR           TH CA Carcass G
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDNI6PR    WUI6PR           TH CA Base Mkt
     C                     Z-ADDDNI7PR    WUI7PR           TH CA Sort Disc
     C                     Z-ADDDNI8PR    WUI8PR           TH CA Yield Gai
     C                     Z-ADDDNI9PR    WUI9PR           TH CA Base Carc
     C                     Z-ADDDNJAPR    WUJAPR           TH CA Lean Prem
     C                     Z-ADDDNJCPR    WUJCPR           TH CA Carcass G
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELA1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSI     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    YL0151           PD Name
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv PL Address flds   RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVELA1ABCD    AFABCD           PD Producer Cod
     C                     MOVELA1AECD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSSJ     CHAIN@AFREAR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0015' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0152           PL Name
     C                     Z-ADD*ZERO     YL0153           Pl VND Address
     C                     MOVEL*BLANK    YL0154           PL State Code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFA8TX    YL0152           PL Name
     C                     Z-ADDAFGLNB    YL0153           Pl VND Address
     C                     MOVELAFN0TX    YL0154           PL State Code
     C                     GOTO SJEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Tatt Ded/Add TransRT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUAZVA           THD Unit Amt
      * Declare restrictor key work fields
     C           *LIKE     DEFN CDHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN CDBNNB    WQSK02           BOH Buy Order N
     C           *LIKE     DEFN CDBONB    WQSK03           BOL Load Number
     C           *LIKE     DEFN CDCVNB    WQSK04           TH Tattoo Numbe
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           BOH Buy Order N
     C                     KFLD           WQSK03           BOL Load Number
     C                     KFLD           WQSK04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDA1HMNB    WQSK01           BOH Company Num
     C                     Z-ADDA1BNNB    WQSK02           BOH Buy Order N
     C                     Z-ADDA1BONB    WQSK03           BOL Load Number
     C                     Z-ADDA1CVNB    WQSK04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSK     SETLL@CDCPIU                    *
     C           KRSSK     READE@CDCPIU                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.THD UOM is Head Killed/100 Miles
     C           CDEIST    IFEQ 'HM'                       *IF
     C                     Z-ADDCDAZVA    WUAZVA           THD Unit Amt
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDP1HMNB    AWHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSL     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWAKCD    WUAKCD           PC Contract Cod
     C                     MOVELAWALCD    WUALCD           PSC Sub-Contrac
     C                     MOVELAWAMCD    WUAMCD           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           AQAKCD           PC Contract Cod
     C                     KFLD           AQALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWUAKCD    AQAKCD           PC Contract Cod
     C                     MOVELWUALCD    AQALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSM     CHAIN@AQCPA0              90    *
      * Data record not found
     C   90                MOVEL'PRK0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAQA9PC    $DIKPC           PSC Market Perc
     C                     Z-ADDAQA7PR    $DILPC           PSC Break Even
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv CMP Payment Info  RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           ARAMCD           CMP Program Cod
      * Setup key
     C                     MOVELP6AMCD    ARAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSN     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUVEPR           CMP % of Carcas
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDARVEPR    WUVEPR           CMP % of Carcas
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Carcass Sum Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDA1HMNB    AWHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSO     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $HARDT           BOH Buy Order D
     C                     MOVEL*BLANK    P6B3ST           BOH Quote Price
     C                     MOVEL*BLANK    P6ETCD           BOH Commodity M
     C                     MOVEL*BLANK    P6EUCD           BOH Commodity P
     C                     MOVEL*BLANK    P6AMCD           CMP Program Cod
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAWARDT    $HARDT           BOH Buy Order D
     C                     MOVELAWB3ST    P6B3ST           BOH Quote Price
     C                     MOVELAWETCD    P6ETCD           BOH Commodity M
     C                     MOVELAWEUCD    P6EUCD           BOH Commodity P
     C                     MOVELAWAMCD    P6AMCD           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Truck/Load        RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD$HHMNB    AXHMNB           BOH Company Num
     C                     Z-ADD$HBNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADD$HBONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSP     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0177           TRK Trucker Cod
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAXBNCD    YL0177           TRK Trucker Cod
     C                     GOTO SPEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Trucker Name - Trucker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           BABNCD           TRK Trucker Cod
      * Setup key
     C                     MOVELYL0177    BABNCD           TRK Trucker Cod
      * Establish starting position
     C           KRSSQ     CHAIN@BAREDS              90    *
      * Data record not found
     C   90                MOVEL'PRK0079' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBABJTX    YL0178           TRK Name
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Lean Dist  RT - Crc Sum Tattoo Lean Dist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $HM2NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM3NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM4NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM5NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM6NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM7NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM8NB           Lean Rng Tto Cn
     C                     Z-ADD*ZERO     $HM9NB           Lean Rng Tto Cn
      * Declare restrictor key work fields
     C           *LIKE     DEFN CYHMNB    WQSR01           BOH Company Num
     C           *LIKE     DEFN CYBNNB    WQSR02           BOH Buy Order N
     C           *LIKE     DEFN CYBONB    WQSR03           BOL Load Number
     C           *LIKE     DEFN CYCVNB    WQSR04           TH Tattoo Numbe
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           BOH Company Num
     C                     KFLD           WQSR02           BOH Buy Order N
     C                     KFLD           WQSR03           BOL Load Number
     C                     KFLD           WQSR04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDA1HMNB    WQSR01           BOH Company Num
     C                     Z-ADDA1BNNB    WQSR02           BOH Buy Order N
     C                     Z-ADDA1BONB    WQSR03           BOL Load Number
     C                     Z-ADDA1CVNB    WQSR04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSR     SETLL@CYCPOY                    *
     C           KRSSR     READE@CYCPOY                  90*
      * Data record not found
     C   90                MOVEL'PRK0422' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: Min 1 <= % < Max 1
      *  - c1 AND c2
      *   |- c1    : DB1.CTLD Lean % GE PAR.Lean Rng Min 1 USR
      *   |- c2    : DB1.CTLD Lean % LT PAR.Lean Rng Max 1 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CYBYPC    IFGE P2CXPC                     *IF
     C           CYBYPC    IFLT P2CYPC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  CYMENB    $HM2NB           Lean Rng Tto Cn
     C                     ELSE
      * CASE: Min 2 <= % < Max 2
      *  - c1 AND c2
      *   |- c1    : DB1.CTLD Lean % GE PAR.Lean Rng Min 2 USR
      *   |- c2    : DB1.CTLD Lean % LT PAR.Lean Rng Max 2 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CYBYPC    IFGE P2CZPC                     *IF
     C           CYBYPC    IFLT P2C0PC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  CYMENB    $HM3NB           Lean Rng Tto Cn
     C                     ELSE
      * CASE: Min 3 <= % < Max 3
      *  - c1 AND c2
      *   |- c1    : DB1.CTLD Lean % GE PAR.Lean Rng Min 3 USR
      *   |- c2    : DB1.CTLD Lean % LT PAR.Lean Rng Max 3 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CYBYPC    IFGE P2C1PC                     *IF
     C           CYBYPC    IFLT P2C2PC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  CYMENB    $HM4NB           Lean Rng Tto Cn
     C                     ELSE
      * CASE: Min 4 <= % < Max 4
      *  - c1 AND c2
      *   |- c1    : DB1.CTLD Lean % GE PAR.Lean Rng Min 4 USR
      *   |- c2    : DB1.CTLD Lean % LT PAR.Lean Rng Max 4 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CYBYPC    IFGE P2C3PC                     *IF
     C           CYBYPC    IFLT P2C4PC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  CYMENB    $HM5NB           Lean Rng Tto Cn
     C                     ELSE
      * CASE: Min 5 <= % < Max 5
      *  - c1 AND c2
      *   |- c1    : DB1.CTLD Lean % GE PAR.Lean Rng Min 5 USR
      *   |- c2    : DB1.CTLD Lean % LT PAR.Lean Rng Max 5 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CYBYPC    IFGE P2C5PC                     *IF
     C           CYBYPC    IFLT P2C6PC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  CYMENB    $HM6NB           Lean Rng Tto Cn
     C                     ELSE
      * CASE: Min 6 <= % < Max 6
      *  - c1 AND c2
      *   |- c1    : DB1.CTLD Lean % GE PAR.Lean Rng Min 6 USR
      *   |- c2    : DB1.CTLD Lean % LT PAR.Lean Rng Max 6 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CYBYPC    IFGE P2C7PC                     *IF
     C           CYBYPC    IFLT P2C8PC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  CYMENB    $HM7NB           Lean Rng Tto Cn
     C                     ELSE
      * CASE: Min 7 <= % < Max 7
      *  - c1 AND c2
      *   |- c1    : DB1.CTLD Lean % GE PAR.Lean Rng Min 7 USR
      *   |- c2    : DB1.CTLD Lean % LT PAR.Lean Rng Max 7 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CYBYPC    IFGE P2C9PC                     *IF
     C           CYBYPC    IFLT P2DAPC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  CYMENB    $HM8NB           Lean Rng Tto Cn
     C                     ELSE
      * CASE: Min 8 <= % < Max 8
      *  - c1 AND c2
      *   |- c1    : DB1.CTLD Lean % GE PAR.Lean Rng Min 8 USR
      *   |- c2    : DB1.CTLD Lean % LT PAR.Lean Rng Max 8 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CYBYPC    IFGE P2DBPC                     *IF
     C           CYBYPC    IFLT P2DCPC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  CYMENB    $HM9NB           Lean Rng Tto Cn
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSR     READE@CYCPOY                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Prd Lean Dist     RT - Crc Sum Prd Lean Dst YTD  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $HNANB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNBNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNCNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNDNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNENB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNFNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNGNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HNHNB           Lean Rng Prd Cn
     C                     Z-ADD*ZERO     $HCHDT           Date USR
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN C0HONB    WQSS01           CC Company Numb
     C           *LIKE     DEFN C0ABCD    WQSS02           PD Producer Cod
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS01           CC Company Numb
     C                     KFLD           WQSS02           PD Producer Cod
     C                     KFLD           C0CHDT           PY As of Kill D
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           CC Company Numb
     C                     KFLD           WQSS02           PD Producer Cod
      * Setup key
     C                     Z-ADDA1HMNB    WQSS01           CC Company Numb
     C                     MOVELA1ABCD    WQSS02           PD Producer Cod
     C                     Z-ADDA1B0DT    C0CHDT           PY As of Kill D
      * Establish starting position
     C           KPSSS     SETLL@C0CPO9                    *
     C           KRSSS     READE@C0CPO9                  90*
      * Data record not found
     C   90                MOVEL'PRK0426' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.First Time Flag Usr is Yes
     C           WUHBST    IFEQ 'Y'                        *IF
     C                     Z-ADDC0CHDT    WUCHDT           PY As of Kill D
     C                     Z-ADDC0CHDT    $HCHDT           Date USR
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PY Kill Date NE WRK.PY Kill Date
     C           C0CHDT    IFNE WUCHDT                     *IF
     C                     GOTO SSEXIT                     *QUIT
     C                     END                             *FI
      * Accumulate Head Killed
      * CASE: Min 1 <= % < Max 1
      *  - c1 AND c2
      *   |- c1    : DB1.PLDY Lean % GE PAR.Lean Rng Min 1 USR
      *   |- c2    : DB1.PLDY Lean % LT PAR.Lean Rng Max 1 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           C0BZPC    IFGE P2CXPC                     *IF
     C           C0BZPC    IFLT P2CYPC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  C0MGNB    $HNANB           Lean Rng Prd Cn
     C                     ELSE
      * CASE: Min 2 <= % < Max 2
      *  - c1 AND c2
      *   |- c1    : DB1.PLDY Lean % GE PAR.Lean Rng Min 2 USR
      *   |- c2    : DB1.PLDY Lean % LT PAR.Lean Rng Max 2 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           C0BZPC    IFGE P2CZPC                     *IF
     C           C0BZPC    IFLT P2C0PC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  C0MGNB    $HNBNB           Lean Rng Prd Cn
     C                     ELSE
      * CASE: Min 3 <= % < Max 3
      *  - c1 AND c2
      *   |- c1    : DB1.PLDY Lean % GE PAR.Lean Rng Min 3 USR
      *   |- c2    : DB1.PLDY Lean % LT PAR.Lean Rng Max 3 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           C0BZPC    IFGE P2C1PC                     *IF
     C           C0BZPC    IFLT P2C2PC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  C0MGNB    $HNCNB           Lean Rng Prd Cn
     C                     ELSE
      * CASE: Min 4 <= % < Max 4
      *  - c1 AND c2
      *   |- c1    : DB1.PLDY Lean % GE PAR.Lean Rng Min 4 USR
      *   |- c2    : DB1.PLDY Lean % LT PAR.Lean Rng Max 4 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           C0BZPC    IFGE P2C3PC                     *IF
     C           C0BZPC    IFLT P2C4PC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  C0MGNB    $HNDNB           Lean Rng Prd Cn
     C                     ELSE
      * CASE: Min 5 <= % < Max 5
      *  - c1 AND c2
      *   |- c1    : DB1.PLDY Lean % GE PAR.Lean Rng Min 5 USR
      *   |- c2    : DB1.PLDY Lean % LT PAR.Lean Rng Max 5 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           C0BZPC    IFGE P2C5PC                     *IF
     C           C0BZPC    IFLT P2C6PC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  C0MGNB    $HNENB           Lean Rng Prd Cn
     C                     ELSE
      * CASE: Min 6 <= % < Max 6
      *  - c1 AND c2
      *   |- c1    : DB1.PLDY Lean % GE PAR.Lean Rng Min 6 USR
      *   |- c2    : DB1.PLDY Lean % LT PAR.Lean Rng Max 6 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           C0BZPC    IFGE P2C7PC                     *IF
     C           C0BZPC    IFLT P2C8PC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  C0MGNB    $HNFNB           Lean Rng Prd Cn
     C                     ELSE
      * CASE: Min 7 <= % < Max 7
      *  - c1 AND c2
      *   |- c1    : DB1.PLDY Lean % GE PAR.Lean Rng Min 7 USR
      *   |- c2    : DB1.PLDY Lean % LT PAR.Lean Rng Max 7 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           C0BZPC    IFGE P2C9PC                     *IF
     C           C0BZPC    IFLT P2DAPC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  C0MGNB    $HNGNB           Lean Rng Prd Cn
     C                     ELSE
      * CASE: Min 8 <= % < Max 8
      *  - c1 AND c2
      *   |- c1    : DB1.PLDY Lean % GE PAR.Lean Rng Min 8 USR
      *   |- c2    : DB1.PLDY Lean % LT PAR.Lean Rng Max 8 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           C0BZPC    IFGE P2DBPC                     *IF
     C           C0BZPC    IFLT P2DCPC                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  C0MGNB    $HNHNB           Lean Rng Prd Cn
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSS     READE@C0CPO9                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Head Killed       RT - Crc Sum Prd          YTD  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CZHONB    WQST01           CC Company Numb
     C           *LIKE     DEFN CZABCD    WQST02           PD Producer Cod
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           CC Company Numb
     C                     KFLD           WQST02           PD Producer Cod
     C                     KFLD           CZCHDT           PY As of Kill D
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           CC Company Numb
     C                     KFLD           WQST02           PD Producer Cod
      * Setup key
     C                     Z-ADDA1HMNB    WQST01           CC Company Numb
     C                     MOVELA1ABCD    WQST02           PD Producer Cod
     C                     Z-ADDA1B0DT    CZCHDT           PY As of Kill D
      * Establish starting position
     C           KPSST     SETLL@CZCPP4                    *
     C           KRSST     READE@CZCPP4                  90*
      * Data record not found
     C   90                MOVEL'PRK0424' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDCZMFNB    P8MFNB           PY Head Killed
     C                     GOTO STEXIT                     *QUIT
     C           KRSST     READE@CZCPP4                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Prt Crc Sum WtLt WK   RT - Crc Sum Co Wgt Lot   WK  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DBHONB    WQSU01           CC Company Numb
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           CC Company Numb
     C                     KFLD           DBCPDT           CWLW Week Endin
     C                     KFLD           DBMHNB           CWL Min Adj Liv
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           CC Company Numb
      * Setup key
     C                     Z-ADDA1HMNB    WQSU01           CC Company Numb
     C                     Z-ADDWUB5DT    DBCPDT           CWLW Week Endin
     C                     Z-ADDWUU9NB    DBMHNB           CWL Min Adj Liv
      * Establish starting position
     C           KPSSU     SETLL@DBCPRL                    *
     C           KRSSU     READE@DBCPRL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0506' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $HMHNB           Live Wgt Min US
     C                     Z-ADD*ZERO     $HMINB           Live Wgt Max US
     C                     Z-ADD*ZERO     WN0012           CWLW Min Top Ad
     C                     Z-ADD*ZERO     WN0013           CWLW Max Top Ad
     C                     Z-ADD*ZERO     WN0014           CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0015           CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0016           CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0017           CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0018           CWLW Min Lower
     C                     Z-ADD*ZERO     WN0019           CWLW Max Lower
     C                     Z-ADD*ZERO     WN0020           CWLW Min Top Le
     C                     Z-ADD*ZERO     WN0021           CWLW Max Top Le
     C                     Z-ADD*ZERO     WN0022           CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0023           CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0024           CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0025           CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0026           CWLW Min Lower
     C                     Z-ADD*ZERO     WN0027           CWLW Max Lower
     C                     Z-ADD*ZERO     WN0028           CWLW Min Top Le
     C                     Z-ADD*ZERO     WN0029           CWLW Max Top Le
     C                     Z-ADD*ZERO     WN0030           CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0031           CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0032           CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0033           CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0034           CWLW Min Lower
     C                     Z-ADD*ZERO     WN0035           CWLW Max Lower
     C                     Z-ADD*ZERO     WN0036           CWLW Min Top So
     C                     Z-ADD*ZERO     WN0037           CWLW Max Top So
     C                     Z-ADD*ZERO     WN0038           CWLW Min Mid Lo
     C                     Z-ADD*ZERO     WN0039           CWLW Max Mid Lo
     C                     Z-ADD*ZERO     WN0040           CWLW Min Mid Hi
     C                     Z-ADD*ZERO     WN0041           CWLW Max Mid Hi
     C                     Z-ADD*ZERO     WN0042           CWLW Min Lower
     C                     Z-ADD*ZERO     WN0043           CWLW Max Lower
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDBE2PC    WN0012           CWLW Min Top Ad
     C                     Z-ADDDBE3PC    WN0013           CWLW Max Top Ad
     C                     Z-ADDDBE4PC    WN0014           CWLW Min Mid Lo
     C                     Z-ADDDBE5PC    WN0015           CWLW Max Mid Lo
     C                     Z-ADDDBE6PC    WN0016           CWLW Min Mid Hi
     C                     Z-ADDDBE7PC    WN0017           CWLW Max Mid Hi
     C                     Z-ADDDBE8PC    WN0018           CWLW Min Lower
     C                     Z-ADDDBE9PC    WN0019           CWLW Max Lower
     C                     Z-ADDDBFAPC    WN0020           CWLW Min Top Le
     C                     Z-ADDDBFBPC    WN0021           CWLW Max Top Le
     C                     Z-ADDDBFCPC    WN0022           CWLW Min Mid Lo
     C                     Z-ADDDBFDPC    WN0023           CWLW Max Mid Lo
     C                     Z-ADDDBFEPC    WN0024           CWLW Min Mid Hi
     C                     Z-ADDDBFFPC    WN0025           CWLW Max Mid Hi
     C                     Z-ADDDBFGPC    WN0026           CWLW Min Lower
     C                     Z-ADDDBFHPC    WN0027           CWLW Max Lower
     C                     Z-ADDDBFPPR    WN0028           CWLW Min Top Le
     C                     Z-ADDDBFQPR    WN0029           CWLW Max Top Le
     C                     Z-ADDDBFRPR    WN0030           CWLW Min Mid Lo
     C                     Z-ADDDBFSPR    WN0031           CWLW Max Mid Lo
     C                     Z-ADDDBFTPR    WN0032           CWLW Min Mid Hi
     C                     Z-ADDDBFUPR    WN0033           CWLW Max Mid Hi
     C                     Z-ADDDBFVPR    WN0034           CWLW Min Lower
     C                     Z-ADDDBFWPR    WN0035           CWLW Max Lower
     C                     Z-ADDDBFXPR    WN0036           CWLW Min Top So
     C                     Z-ADDDBFYPR    WN0037           CWLW Max Top So
     C                     Z-ADDDBFZPR    WN0038           CWLW Min Mid Lo
     C                     Z-ADDDBF0PR    WN0039           CWLW Max Mid Lo
     C                     Z-ADDDBF1PR    WN0040           CWLW Min Mid Hi
     C                     Z-ADDDBF2PR    WN0041           CWLW Max Mid Hi
     C                     Z-ADDDBF3PR    WN0042           CWLW Min Lower
     C                     Z-ADDDBF4PR    WN0043           CWLW Max Lower
     C                     Z-ADDDBMHNB    $HMHNB           Live Wgt Min US
     C                     Z-ADDDBMINB    $HMINB           Live Wgt Max US
     C                     GOTO SUEXIT                     *QUIT
     C           KRSSU     READE@DBCPRL                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Prt Crc Sum Cndmns    RT - Loss Type  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0044  20       Loss Reason Cod
     C                     Z-ADD*ZERO     WN0045  20       Loss Reason Cod
     C                     Z-ADD*ZERO     WN0046  20       Loss Reason Cod
     C                     Z-ADD*ZERO     WN0047  20       Loss Reason Cod
     C                     Z-ADD*ZERO     WN0048  20       Loss Reason Cod
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    $HG3TX           Reason 1 Desc U
     C                     MOVEL*BLANK    $HG9TX           Reason 2 Desc U
     C                     MOVEL*BLANK    $HHATX           Reason 3 Desc U
     C                     MOVEL*BLANK    $HHBTX           Reason 4 Desc U
     C                     MOVEL*BLANK    $HHCTX           Reason 5 Desc U
     C                     Z-ADD*ZERO     $HMRNB           Reason Head 1 U
     C                     Z-ADD*ZERO     $HMSNB           Reason Head 2 U
     C                     Z-ADD*ZERO     $HMTNB           Reason Head 3 U
     C                     Z-ADD*ZERO     $HMUNB           Reason Head 4 U
     C                     Z-ADD*ZERO     $HMVNB           Reason Head 5 U
     C                     Z-ADD*ZERO     WN0044           Loss Reason Cod
     C                     Z-ADD*ZERO     WN0045           Loss Reason Cod
     C                     Z-ADD*ZERO     WN0046           Loss Reason Cod
     C                     Z-ADD*ZERO     WN0047           Loss Reason Cod
     C                     Z-ADD*ZERO     WN0048           Loss Reason Cod
      * Declare restrictor key work fields
     C           *LIKE     DEFN BPEZST    WQSV01           LT Loss Definit
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           LT Loss Definit
      * Setup key
     C                     MOVEL'C'       WQSV01           LT Loss Definit
      * Establish starting position
     C           KRSSV     SETLL@BPREPD                    *
     C           KRSSV     READE@BPREPD                  90*
      * Data record not found
     C   90                MOVEL'PRK0109' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Crc Sum Cndmn Rsn RT - Loss Trans  * 
     C                     EXSR SWRVGN
      * Reason 1 Desc
      * CASE: PAR.Loss Reason Code 1 USR NE WRK.Zero USR
     C           WN0044    IFNE WUE9NB                     *IF
      * Rtv Loss Reason       RT - Loss Reason  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
      * Reason 2 Desc
      * CASE: PAR.Loss Reason Code 2 USR NE WRK.Zero USR
     C           WN0045    IFNE WUE9NB                     *IF
      * Rtv Loss Reason       RT - Loss Reason  * 
     C                     EXSR SYRVGN
     C                     END                             *FI
      * Reason 3 Desc
      * CASE: PAR.Loss Reason Code 3 USR NE WRK.Zero USR
     C           WN0046    IFNE WUE9NB                     *IF
      * Rtv Loss Reason       RT - Loss Reason  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
      * Reason 4 Desc
      * CASE: PAR.Loss Reason Code 4 USR NE WRK.Zero USR
     C           WN0047    IFNE WUE9NB                     *IF
      * Rtv Loss Reason       RT - Loss Reason  * 
     C                     EXSR TARVGN
     C                     END                             *FI
      * Reason 5 Desc
      * CASE: PAR.Loss Reason Code 1 USR NE WRK.Zero USR
     C           WN0044    IFNE WUE9NB                     *IF
      * CASE: PAR.Loss Reason Code 5 USR is = 99
     C           WN0048    IFEQ 99                         *IF
     C                     MOVEL*BLANK    $HHCTX           Reason 5 Desc U
     C                     MOVEL'Other'   $HHCTX           Reason 5 Desc U
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Loss Reason       RT - Loss Reason  * 
     C                     EXSR TBRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSV     READE@BPREPD                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Crc Sum Cndmn Rsn RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BSBWCD    WQSW01           LT Type Code
     C           *LIKE     DEFN BSHMNB    WQSW02           BOH Company Num
     C           *LIKE     DEFN BSBNNB    WQSW03           BOH Buy Order N
     C           *LIKE     DEFN BSBONB    WQSW04           BOL Load Number
     C           *LIKE     DEFN BSCVNB    WQSW05           TH Tattoo Numbe
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           LT Type Code
     C                     KFLD           WQSW02           BOH Company Num
     C                     KFLD           WQSW03           BOH Buy Order N
     C                     KFLD           WQSW04           BOL Load Number
     C                     KFLD           WQSW05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDBPBWCD    WQSW01           LT Type Code
     C                     Z-ADDA1HMNB    WQSW02           BOH Company Num
     C                     Z-ADDA1BNNB    WQSW03           BOH Buy Order N
     C                     Z-ADDA1BONB    WQSW04           BOL Load Number
     C                     Z-ADDA1CVNB    WQSW05           TH Tattoo Numbe
      * Establish starting position
     C           KRSSW     SETLL@BSCPPE                    *
     C           KRSSW     READE@BSCPPE                  90*
      * Data record not found
     C   90                MOVEL'PRK0115' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Set up Reason Codes
      * CASE: Reason 1
      *  - c1 OR c2
      *   |- c1    : PAR.Loss Reason Code 1 USR EQ WRK.Zero USR
      *   |- c2    : DB1.LR Reason Code EQ PAR.Loss Reason Code 1 USR
      *   '-
     C           WN0044    IFEQ WUE9NB                     *IF
     C           BSBYCD    OREQ WN0044                     *OR
     C                     Z-ADDBSBYCD    WN0044           Loss Reason Cod
     C                     ADD  1         $HMRNB           Reason Head 1 U
     C                     ELSE
      * CASE: Reason 2
      *  - c1 OR c2
      *   |- c1    : PAR.Loss Reason Code 2 USR EQ WRK.Zero USR
      *   |- c2    : DB1.LR Reason Code EQ PAR.Loss Reason Code 2 USR
      *   '-
     C           WN0045    IFEQ WUE9NB                     *IF
     C           BSBYCD    OREQ WN0045                     *OR
     C                     Z-ADDBSBYCD    WN0045           Loss Reason Cod
     C                     ADD  1         $HMSNB           Reason Head 2 U
     C                     ELSE
      * CASE: Reason 3
      *  - c1 OR c2
      *   |- c1    : PAR.Loss Reason Code 3 USR EQ WRK.Zero USR
      *   |- c2    : DB1.LR Reason Code EQ PAR.Loss Reason Code 3 USR
      *   '-
     C           WN0046    IFEQ WUE9NB                     *IF
     C           BSBYCD    OREQ WN0046                     *OR
     C                     Z-ADDBSBYCD    WN0046           Loss Reason Cod
     C                     ADD  1         $HMTNB           Reason Head 3 U
     C                     ELSE
      * CASE: Reason 4
      *  - c1 OR c2
      *   |- c1    : PAR.Loss Reason Code 4 USR EQ WRK.Zero USR
      *   |- c2    : DB1.LR Reason Code EQ PAR.Loss Reason Code 4 USR
      *   '-
     C           WN0047    IFEQ WUE9NB                     *IF
     C           BSBYCD    OREQ WN0047                     *OR
     C                     Z-ADDBSBYCD    WN0047           Loss Reason Cod
     C                     ADD  1         $HMUNB           Reason Head 4 U
     C                     ELSE
      * CASE: Reason 5
      *  - c1 OR c2
      *   |- c1    : PAR.Loss Reason Code 5 USR EQ WRK.Zero USR
      *   |- c2    : DB1.LR Reason Code EQ PAR.Loss Reason Code 5 USR
      *   '-
     C           WN0048    IFEQ WUE9NB                     *IF
     C           BSBYCD    OREQ WN0048                     *OR
     C                     Z-ADDBSBYCD    WN0048           Loss Reason Cod
     C                     ADD  1         $HMVNB           Reason Head 5 U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD99        WN0048           Loss Reason Cod
     C                     ADD  1         $HMVNB           Reason Head 5 U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSW     READE@BSCPPE                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Loss Reason       RT - Loss Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           BRBYCD           LR Reason Code
      * Setup key
     C                     Z-ADDWN0044    BRBYCD           LR Reason Code
      * Establish starting position
     C           KRSSX     CHAIN@BRREFQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0113' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $HG3TX           LR Description
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBRBYTX    $HG3TX           LR Description
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Loss Reason       RT - Loss Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           BRBYCD           LR Reason Code
      * Setup key
     C                     Z-ADDWN0045    BRBYCD           LR Reason Code
      * Establish starting position
     C           KRSSY     CHAIN@BRREFQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0113' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $HG9TX           LR Description
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBRBYTX    $HG9TX           LR Description
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Loss Reason       RT - Loss Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           BRBYCD           LR Reason Code
      * Setup key
     C                     Z-ADDWN0046    BRBYCD           LR Reason Code
      * Establish starting position
     C           KRSSZ     CHAIN@BRREFQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0113' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $HHATX           LR Description
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBRBYTX    $HHATX           LR Description
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Loss Reason       RT - Loss Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           BRBYCD           LR Reason Code
      * Setup key
     C                     Z-ADDWN0047    BRBYCD           LR Reason Code
      * Establish starting position
     C           KRSTA     CHAIN@BRREFQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0113' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $HHBTX           LR Description
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBRBYTX    $HHBTX           LR Description
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Loss Reason       RT - Loss Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           BRBYCD           LR Reason Code
      * Setup key
     C                     Z-ADDWN0048    BRBYCD           LR Reason Code
      * Establish starting position
     C           KRSTB     CHAIN@BRREFQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0113' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $HHCTX           LR Description
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBRBYTX    $HHCTX           LR Description
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Prt Crc Sum Trim Dtl  RT - Loss Type  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0049  2        Trim Location 1
     C                     MOVEL*BLANK    WN0050  2        Trim Location 2
     C                     MOVEL*BLANK    WN0051  2        Trim Location 3
     C                     MOVEL*BLANK    WN0052  2        Trim Location 4
     C                     MOVEL*BLANK    WN0053  2        Trim Location 5
     C                     MOVEL*BLANK    WN0054  2        Trim Location 6
     C                     MOVEL*BLANK    WN0055  2        Trim Extent 1 U
     C                     MOVEL*BLANK    WN0056  2        Trim Extent 2 U
     C                     MOVEL*BLANK    WN0057  2        Trim Extent 3 U
     C                     MOVEL*BLANK    WN0058  2        Trim Extent 4 U
     C                     MOVEL*BLANK    WN0059  2        Trim Extent 5 U
     C                     MOVEL*BLANK    WN0060  2        Trim Extent 6 U
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG4TX           Trim 1 Desc USR
     C                     MOVEL*BLANK    WUG5TX           Trim 2 Desc USR
     C                     MOVEL*BLANK    WUG6TX           Trim 3 Desc USR
     C                     MOVEL*BLANK    WUG7TX           Trim 4 Desc USR
     C                     MOVEL*BLANK    WUG8TX           Trim 5 Desc USR
     C                     MOVEL*BLANK    WUOZTX           Trim 6 Desc USR
     C                     Z-ADD*ZERO     $HMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     $HMXNB           Trim Head 2 USR
     C                     Z-ADD*ZERO     $HMYNB           Trim Head 3 USR
     C                     Z-ADD*ZERO     $HMZNB           Trim Head 4 USR
     C                     Z-ADD*ZERO     $HM0NB           Trim Head 5 USR
     C                     Z-ADD*ZERO     $HTRHD           Trim Head 6 USR
     C                     Z-ADD*ZERO     $HH3NB           Weight Tot USR
     C                     MOVEL*BLANK    WN0049           Trim Location 1
     C                     MOVEL*BLANK    WN0050           Trim Location 2
     C                     MOVEL*BLANK    WN0051           Trim Location 3
     C                     MOVEL*BLANK    WN0052           Trim Location 4
     C                     MOVEL*BLANK    WN0053           Trim Location 5
     C                     MOVEL*BLANK    WN0054           Trim Location 6
     C                     MOVEL*BLANK    WN0055           Trim Extent 1 U
     C                     MOVEL*BLANK    WN0056           Trim Extent 2 U
     C                     MOVEL*BLANK    WN0057           Trim Extent 3 U
     C                     MOVEL*BLANK    WN0058           Trim Extent 4 U
     C                     MOVEL*BLANK    WN0059           Trim Extent 5 U
     C                     MOVEL*BLANK    WN0060           Trim Extent 6 U
     C                     MOVEL*BLANK    WUOOTX           Trim Extent 1 D
     C                     MOVEL*BLANK    WUOPTX           Trim Extent 2 D
     C                     MOVEL*BLANK    WUOQTX           Trim Extent 3 D
     C                     MOVEL*BLANK    WUOSTX           Trim Extent 5 D
     C                     MOVEL*BLANK    WUORTX           Trim Extent 4 D
     C                     MOVEL*BLANK    WUO0TX           Trim Extent 6 D
      * Declare restrictor key work fields
     C           *LIKE     DEFN BPEZST    WQTC01           LT Loss Definit
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           LT Loss Definit
      * Setup key
     C                     MOVEL'T'       WQTC01           LT Loss Definit
      * Establish starting position
     C           KRSTC     SETLL@BPREPD                    *
     C           KRSTC     READE@BPREPD                  90*
      * Data record not found
     C   90                MOVEL'PRK0109' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Crc Sum Trim Dtl  RT - Loss Trans  * 
     C                     EXSR TDRVGN
      * PAR.Trim 1 Desc USR = Condition name of PAR.Trim Location 1 USR
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158543   Y2LSNO  70       List number
     C                     PARM WN0049    W0INVL 25        Trim Location 1
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUG4TX    PARM           W0CNNM 25        Trim 1 Desc USR
      *
      * PAR.Trim 2 Desc USR = Condition name of PAR.Trim Location 2 USR
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158543   Y2LSNO  70       List number
     C                     PARM WN0050    W0INVL 25        Trim Location 2
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUG5TX    PARM           W0CNNM 25        Trim 2 Desc USR
      *
      * PAR.Trim 3 Desc USR = Condition name of PAR.Trim Location 3 USR
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158543   Y2LSNO  70       List number
     C                     PARM WN0051    W0INVL 25        Trim Location 3
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUG6TX    PARM           W0CNNM 25        Trim 3 Desc USR
      *
      * PAR.Trim 4 Desc USR = Condition name of PAR.Trim Location 4 USR
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158543   Y2LSNO  70       List number
     C                     PARM WN0052    W0INVL 25        Trim Location 4
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUG7TX    PARM           W0CNNM 25        Trim 4 Desc USR
      *
      * PAR.Trim 5 Desc USR = Condition name of PAR.Trim Location 5 USR
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158543   Y2LSNO  70       List number
     C                     PARM WN0053    W0INVL 25        Trim Location 5
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUG8TX    PARM           W0CNNM 25        Trim 5 Desc USR
      *
      * PAR.Trim 6 Desc USR = Condition name of PAR.Trim Location 6 USR
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158543   Y2LSNO  70       List number
     C                     PARM WN0054    W0INVL 25        Trim Location 6
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUOZTX    PARM           W0CNNM 25        Trim 6 Desc USR
      *
      * PAR.Trim Extent 1 Desc USR = Condition name of PAR.Trim Extent 1
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158533   Y2LSNO  70       List number
     C                     PARM WN0055    W0INVL 25        Trim Extent 1 U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUOOTX    PARM           W0CNNM 25        Trim Extent 1 D
      *
      * PAR.Trim Extent 2 Desc USR = Condition name of PAR.Trim Extent 2
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158533   Y2LSNO  70       List number
     C                     PARM WN0056    W0INVL 25        Trim Extent 2 U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUOPTX    PARM           W0CNNM 25        Trim Extent 2 D
      *
      * PAR.Trim Extent 3 Desc USR = Condition name of PAR.Trim Extent 3
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158533   Y2LSNO  70       List number
     C                     PARM WN0057    W0INVL 25        Trim Extent 3 U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUOQTX    PARM           W0CNNM 25        Trim Extent 3 D
      *
      * PAR.Trim Extent 4 Desc USR = Condition name of PAR.Trim Extent 4
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158533   Y2LSNO  70       List number
     C                     PARM WN0058    W0INVL 25        Trim Extent 4 U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUORTX    PARM           W0CNNM 25        Trim Extent 4 D
      *
      * PAR.Trim Extent 5 Desc USR = Condition name of PAR.Trim Extent 5
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158533   Y2LSNO  70       List number
     C                     PARM WN0059    W0INVL 25        Trim Extent 5 U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUOSTX    PARM           W0CNNM 25        Trim Extent 5 D
      *
      * PAR.Trim Extent 6 Desc USR = Condition name of PAR.Trim Extent 6
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158533   Y2LSNO  70       List number
     C                     PARM WN0060    W0INVL 25        Trim Extent 6 U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUO0TX    PARM           W0CNNM 25        Trim Extent 6 D
      *
     C           KRSTC     READE@BPREPD                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Crc Sum Trim Dtl  RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BSBWCD    WQTD01           LT Type Code
     C           *LIKE     DEFN BSHMNB    WQTD02           BOH Company Num
     C           *LIKE     DEFN BSBNNB    WQTD03           BOH Buy Order N
     C           *LIKE     DEFN BSBONB    WQTD04           BOL Load Number
     C           *LIKE     DEFN BSCVNB    WQTD05           TH Tattoo Numbe
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           LT Type Code
     C                     KFLD           WQTD02           BOH Company Num
     C                     KFLD           WQTD03           BOH Buy Order N
     C                     KFLD           WQTD04           BOL Load Number
     C                     KFLD           WQTD05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDBPBWCD    WQTD01           LT Type Code
     C                     Z-ADDA1HMNB    WQTD02           BOH Company Num
     C                     Z-ADDA1BNNB    WQTD03           BOH Buy Order N
     C                     Z-ADDA1BONB    WQTD04           BOL Load Number
     C                     Z-ADDA1CVNB    WQTD05           TH Tattoo Numbe
      * Establish starting position
     C           KRSTD     SETLL@BSCPPE                    *
     C           KRSTD     READE@BSCPPE                  90*
      * Data record not found
     C   90                MOVEL'PRK0115' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Set up Trim Locations
      * CASE: Trim 1
      *  - c1 OR c2
      *   |- c1    : PAR.Trim Location 1 USR EQ WRK.Blank USR
      *   |- c2    : DB1.LTN Trim Location EQ PAR.Trim Location 1 USR
      *   '-
     C           WN0049    IFEQ WUCRTX                     *IF
     C           BSS4NB    OREQ WN0049                     *OR
     C                     MOVELBSS4NB    WN0049           Trim Location 1
     C                     MOVELBSS3NB    WN0055           Trim Extent 1 U
     C                     ADD  1         $HMWNB           Trim Head 1 USR
     C                     ELSE
      * CASE: Trim 2
      *  - c1 OR c2
      *   |- c1    : PAR.Trim Location 2 USR EQ WRK.Blank USR
      *   |- c2    : DB1.LTN Trim Location EQ PAR.Trim Location 2 USR
      *   '-
     C           WN0050    IFEQ WUCRTX                     *IF
     C           BSS4NB    OREQ WN0050                     *OR
     C                     MOVELBSS4NB    WN0050           Trim Location 2
     C                     MOVELBSS3NB    WN0056           Trim Extent 2 U
     C                     ADD  1         $HMXNB           Trim Head 2 USR
     C                     ELSE
      * CASE: Trim 3
      *  - c1 OR c2
      *   |- c1    : PAR.Trim Location 3 USR EQ WRK.Blank USR
      *   |- c2    : DB1.LTN Trim Location EQ PAR.Trim Location 3 USR
      *   '-
     C           WN0051    IFEQ WUCRTX                     *IF
     C           BSS4NB    OREQ WN0051                     *OR
     C                     MOVELBSS4NB    WN0051           Trim Location 3
     C                     MOVELBSS3NB    WN0057           Trim Extent 3 U
     C                     ADD  1         $HMYNB           Trim Head 3 USR
     C                     ELSE
      * CASE: Trim 4
      *  - c1 OR c2
      *   |- c1    : PAR.Trim Location 4 USR EQ WRK.Blank USR
      *   |- c2    : DB1.LTN Trim Location EQ PAR.Trim Location 4 USR
      *   '-
     C           WN0052    IFEQ WUCRTX                     *IF
     C           BSS4NB    OREQ WN0052                     *OR
     C                     MOVELBSS4NB    WN0052           Trim Location 4
     C                     MOVELBSS3NB    WN0058           Trim Extent 4 U
     C                     ADD  1         $HMZNB           Trim Head 4 USR
     C                     ELSE
      * CASE: Trim 5
      *  - c1 OR c2
      *   |- c1    : PAR.Trim Location 5 USR EQ WRK.Blank USR
      *   |- c2    : DB1.LTN Trim Location EQ PAR.Trim Location 5 USR
      *   '-
     C           WN0053    IFEQ WUCRTX                     *IF
     C           BSS4NB    OREQ WN0053                     *OR
     C                     MOVELBSS4NB    WN0053           Trim Location 5
     C                     MOVELBSS3NB    WN0059           Trim Extent 5 U
     C                     ADD  1         $HM0NB           Trim Head 5 USR
     C                     ELSE
      * CASE: Trim 6
      *  - c1 AND c2
      *   |- c1    : PAR.Trim Location 6 USR EQ WRK.Blank USR
      *   |- c2    : DB1.LTN Trim Location EQ PAR.Trim Location 6 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0054    IFEQ WUCRTX                     *IF
     C           BSS4NB    IFEQ WN0054                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELBSS4NB    WN0054           Trim Location 6
     C                     MOVELBSS3NB    WN0060           Trim Extent 6 U
     C                     ADD  1         $HTRHD           Trim Head 6 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'99'      WUE5TX           Length Usr Txt
     C                     MOVELWUE5TX    WN0054           Trim Location 6
     C                     ADD  1         $HTRHD           Trim Head 6 USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  BSDSNB    $HH3NB           Weight Tot USR
     C           KRSTD     READE@BSCPPE                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           ARAMCD           CMP Program Cod
      * Setup key
     C                     MOVELP6AMCD    ARAMCD           CMP Program Cod
      * Establish starting position
     C           KRSTE     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUOHTX           CMP Description
     C                     MOVEL*BLANK    YL0179           CMP Grading Typ
     C                     MOVEL*BLANK    P7DMST           CMP Sort Basis
     C                     MOVEL*BLANK    WUOHTX           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WUNUMN           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WUNUMN           CMP Lean Factor
     C                     MOVEL*BLANK    WUOHTX           CMP Optimal Row
     C                     MOVEL*BLANK    WUOHTX           CMP Type
     C                     Z-ADD*ZERO     WUNUMN           CMP Market Add/
     C                     MOVEL*BLANK    WUOHTX           RS Record Statu
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELARA3TX    WUOHTX           CMP Description
     C                     MOVELARDLST    YL0179           CMP Grading Typ
     C                     MOVELARDMST    P7DMST           CMP Sort Basis
     C                     MOVELARDQST    WUOHTX           CMP Carc Wgt Ty
     C                     Z-ADDARAZPC    WUNUMN           CMP Std Lean Pe
     C                     Z-ADDARA0PC    WUNUMN           CMP Lean Factor
     C                     MOVELARDTST    WUOHTX           CMP Optimal Row
     C                     MOVELARF5ST    WUOHTX           CMP Type
     C                     Z-ADDARI1PR    WUNUMN           CMP Market Add/
     C                     MOVELARAJST    WUOHTX           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv PayTyp/Src Hc 2   Rt - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQTF01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQTF02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQTF03           BOL Load Number
     C           *LIKE     DEFN WAB0DT    WQTF04           TH Kill Date
     C           *LIKE     DEFN WACVNB    WQTF05           TH Tattoo Numbe
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           BOH Company Num
     C                     KFLD           WQTF02           BOH Buy Order N
     C                     KFLD           WQTF03           BOL Load Number
     C                     KFLD           WQTF04           TH Kill Date
     C                     KFLD           WQTF05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDB1HMNB    WQTF01           BOH Company Num
     C                     Z-ADDB1BNNB    WQTF02           BOH Buy Order N
     C                     Z-ADDB1BONB    WQTF03           BOL Load Number
     C                     Z-ADDB1B0DT    WQTF04           TH Kill Date
     C                     Z-ADDB1CVNB    WQTF05           TH Tattoo Numbe
      * Establish starting position
     C           KRSTF     SETLL@A1CPOC                    *
     C           KRSTF     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAKAST    WUKAST           TH Source Type
     C                     MOVELWAJ9ST    WUJ9ST           TH Payment Type
     C                     MOVELWALLST    WULLST           TH Hog Class Ty
     C           KRSTF     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv TH Ext for ExstnceRT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNHMNB    WQTG01           BOH Company Num
     C           *LIKE     DEFN DNBNNB    WQTG02           BOH Buy Order N
     C           *LIKE     DEFN DNBONB    WQTG03           BOL Load Number
     C           *LIKE     DEFN DNCVNB    WQTG04           TH Tattoo Numbe
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           BOH Company Num
     C                     KFLD           WQTG02           BOH Buy Order N
     C                     KFLD           WQTG03           BOL Load Number
     C                     KFLD           WQTG04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$IHMNB    WQTG01           BOH Company Num
     C                     Z-ADD$IBNNB    WQTG02           BOH Buy Order N
     C                     Z-ADD$IBONB    WQTG03           BOL Load Number
     C                     Z-ADD$ICVNB    WQTG04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTG     SETLL@DNCPUY                    *
     C           KRSTG     READE@DNCPUY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' WURTN            *Return code
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WURTN            *Return code
     C           KRSTG     READE@DNCPUY                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv CarSummary InfPrt RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           BOBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0184    BOBVCD           EV Validation C
      * Establish starting position
     C           KRSTH     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBOCBTX    YL0185           EV Description
     C                     Z-ADDBOAFPC    YL0186           EV Minimum
     C                     Z-ADDBOAGPC    YL0187           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv CarSummary InfPrt RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           BOBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0184    BOBVCD           EV Validation C
      * Establish starting position
     C           KRSTI     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBOCBTX    YL0185           EV Description
     C                     Z-ADDBOAFPC    YL0188           EV Minimum
     C                     Z-ADDBOAGPC    YL0189           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv CarSummary InfPrt RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           BOBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0184    BOBVCD           EV Validation C
      * Establish starting position
     C           KRSTJ     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBOCBTX    YL0185           EV Description
     C                     Z-ADDBOAFPC    YL0190           EV Minimum
     C                     Z-ADDBOAGPC    YL0191           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv CarSummary InfPrt RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           BOBVCD           EV Validation C
      * Setup key
     C                     MOVELYL0184    BOBVCD           EV Validation C
      * Establish starting position
     C           KRSTK     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBOCBTX    YL0185           EV Description
     C                     Z-ADDBOAFPC    YL0192           EV Minimum
     C                     Z-ADDBOAGPC    YL0193           EV Maximum
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Def-10 Dsc RT - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WUODNB           Defect Count Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQTL01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQTL02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQTL03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQTL04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQTL05           TH Kill Date
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           BOH Company Num
     C                     KFLD           WQTL02           BOH Buy Order N
     C                     KFLD           WQTL03           BOL Load Number
     C                     KFLD           WQTL04           TH Tattoo Numbe
     C                     KFLD           WQTL05           TH Kill Date
      * Setup key
     C                     Z-ADD$SHMNB    WQTL01           BOH Company Num
     C                     Z-ADD$SBNNB    WQTL02           BOH Buy Order N
     C                     Z-ADD$SBONB    WQTL03           BOL Load Number
     C                     Z-ADD$SCVNB    WQTL04           TH Tattoo Numbe
     C                     Z-ADD$SB0DT    WQTL05           TH Kill Date
      * Establish starting position
     C           KRSTL     SETLL@DZREX3                    *
     C           KRSTL     READE@DZREX3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0738' W0RTN   7
      * USER: Processing if Data record not found
      * 8/27/2007 slm  Correction to load par if a record not found
      *  was leaving information from the record last read.
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0197           Defect Desc Usr
     C                     Z-ADD*ZERO     YL0198           Defect HD user
     C                     MOVEL*BLANK    YL0199           Defect Desc Usr
     C                     Z-ADD*ZERO     YL0200           Defect HD user
     C                     MOVEL*BLANK    YL0201           Defect Desc Usr
     C                     Z-ADD*ZERO     YL0202           Defect HD user
     C                     MOVEL*BLANK    YL0203           Defect Desc Usr
     C                     Z-ADD*ZERO     YL0204           Defect HD user
     C                     MOVEL*BLANK    YL0205           Defect Desc Usr
     C                     Z-ADD*ZERO     YL0206           Defect HD user
     C                     MOVEL*BLANK    YL0207           Defect Desc Usr
     C                     Z-ADD*ZERO     YL0208           Defect HD user
     C                     MOVEL*BLANK    YL0209           Defect Desc Usr
     C                     Z-ADD*ZERO     YL0210           Defect HD user
     C                     MOVEL*BLANK    YL0211           Defect Desc Usr
     C                     Z-ADD*ZERO     YL0212           Defect HD user
     C                     MOVEL*BLANK    YL0213           Defect Desc Usr
     C                     Z-ADD*ZERO     YL0214           Defect HD user
     C                     MOVEL*BLANK    YL0215           Defect Desc Usr
     C                     Z-ADD*ZERO     YL0216           Defect HD user
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Defect Count Usr is One
     C           WUODNB    IFEQ 1                          *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TMRVGN
     C                     Z-ADDDZLJNB    YL0198           Defect HD user
     C                     Z-ADD2         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Two
     C           WUODNB    IFEQ 2                          *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TNRVGN
     C                     Z-ADDDZLJNB    YL0200           Defect HD user
     C                     Z-ADD3         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Three
     C           WUODNB    IFEQ 3                          *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TORVGN
     C                     Z-ADDDZLJNB    YL0202           Defect HD user
     C                     Z-ADD4         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Four
     C           WUODNB    IFEQ 4                          *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TPRVGN
     C                     Z-ADDDZLJNB    YL0204           Defect HD user
     C                     Z-ADD5         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Five
     C           WUODNB    IFEQ 5                          *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TQRVGN
     C                     Z-ADDDZLJNB    YL0206           Defect HD user
     C                     Z-ADD6         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Six
     C           WUODNB    IFEQ 6                          *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TRRVGN
     C                     Z-ADDDZLJNB    YL0208           Defect HD user
     C                     Z-ADD7         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Seven
     C           WUODNB    IFEQ 7                          *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TSRVGN
     C                     Z-ADDDZLJNB    YL0210           Defect HD user
     C                     Z-ADD8         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Eight
     C           WUODNB    IFEQ 8                          *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TTRVGN
     C                     Z-ADDDZLJNB    YL0212           Defect HD user
     C                     Z-ADD9         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Nine
     C           WUODNB    IFEQ 9                          *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TURVGN
     C                     Z-ADDDZLJNB    YL0214           Defect HD user
     C                     Z-ADD10        WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Ten
     C           WUODNB    IFEQ 10                         *IF
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TVRVGN
     C                     Z-ADDDZLJNB    YL0216           Defect HD user
     C                     Z-ADD11        WUODNB           Defect Count Us
     C                     GOTO TLEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTL     READE@DZREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELDZBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTM     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    YL0197           DF Description
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    YL0197           DF Description
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELDZBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTN     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    YL0199           DF Description
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    YL0199           DF Description
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELDZBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTO     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    YL0201           DF Description
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    YL0201           DF Description
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELDZBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTP     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    YL0203           DF Description
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    YL0203           DF Description
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELDZBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTQ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    YL0205           DF Description
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    YL0205           DF Description
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELDZBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTR     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    YL0207           DF Description
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    YL0207           DF Description
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELDZBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTS     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    YL0209           DF Description
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    YL0209           DF Description
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELDZBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTT     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    YL0211           DF Description
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    YL0211           DF Description
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELDZBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTU     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    YL0213           DF Description
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    YL0213           DF Description
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVELDZBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTV     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    YL0215           DF Description
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    YL0215           DF Description
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications ---
      *================================================================
      * 3/29/2007  Susan Mason   -  NEW COMPANY VALUE HPECSBOLLN
      * Custom   - Will print the Live Weight or the Net Amount
      * and will print the defect on the tattoo line
      * Standard - Will Not print the Live Weight or the Net Amount
      * and will not print the defect on the tattoo line
      * 8/02/2006  SLM Clean Up for Triumph Foods.
      * 8/02/2006      Do Not Print the Yield Gain/Loss for TF
      *                If the TH CM Yield Gain/Loss Amt is not Zero then
      *                we will print the heading.
      *                If the WRK.Carc/Summ Special Prc Usr is Meat Cmp P
      *                at this time th Meat Cmp Pgm will not have Yield G
      *                or loss, but we think there could be a possibility
      *                So test for Meat Processing at the detail time
      *                and then if the th yeild gain/loss field is zero
      *                then don't print the heading.
      *                and then if the th yeild gain/loss field is not ze
      *                then print the heading.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Create the Text of the above lines on the Carcass Summary Sheet
      *================================================================
      * Yield Gain/loss, Fixed Cost, Quality Premium/Deduct
      * or
      * Yield Gain/loss, Carcass Value, Lean Premium/Deduct
      * *add new text for Guymon
      * CASE: Standard and print carcass base price Yes
      *  - c1 AND c2
      *   |- c1    : LCL.Carcass Summary BOL USR is Standard
      *   |- c2    : WRK.Status 1 is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0180    IFEQ 'Standard'                 *IF
     C           WUP4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,13    $HVKTX           Text 25 #5 Usr
     C                     ELSE
      * CASE: LCL.Carcass Summary BOL USR is Standard
     C           YL0180    IFEQ 'Standard'                 *IF
     C                     MOVEL*BLANK    $HVKTX           Text 25 #5 Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,14    $HVKTX           Text 25 #5 Usr
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.TH CM Base Mkt Price Amt is Zeros
     C           A1ANPR    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    $HVKTX           Text 25 #5 Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     MOVEL@CN,15    $HUHTX           Text 25 #1 Usr
     C                     MOVEL@CN,16    $HUITX           Text 25 #2 Usr
     C                     MOVEL@CN,17    $HUJTX           Text 25 #3 Usr
      * CASE: DB1.TH CM Yield Gain/Loss Amt is Zeros
     C           A1AWVA    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    $HUHTX           Text 25 #1 Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * CASE: LCL.CMP Grading Type is Meat Value
     C           YL0179    IFEQ 'M'                        *IF
     C                     MOVEL@CN,18    $HUITX           Text 25 #2 Usr
     C                     MOVEL@CN,19    $HUJTX           Text 25 #3 Usr
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Carcass Detail,Fx PO
      *================================================================
     C                     MOVEL*BLANK    WUNCCD           Summary Only Us
      * CASE: PAR.TFD Header Action-Crc Dtl EQ WRK.Blank USR
     C           P4NPTX    IFEQ WUCRTX                     *IF
      * CASE: PAR.Print Carcass Analysis Us is No
     C           P3MVST    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    WUNCCD           Summary Only Us
     C                     MOVEL'1'       WUNCCD           Summary Only Us
     C                     GOTO UCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUNSNB           Carcass number
      *
     C                     MOVEL*BLANK    WN0061  1        Status 1
     C                     MOVEL*BLANK    WN0062  1        Status 2
     C                     Z-ADD*ZERO     WN0063  30       Carcass Count U
      *
      * Prt Carcass Detail,Fx PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Excluded Carc Dta PO
      *================================================================
      * CASE: LCL.Format Printed        USR is No
     C           YL0183    IFEQ 'N'                        *IF
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * Prt Excluded Carc Dta PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Move the values of the ranges from the carcass merit programs
      *================================================================
     C                     Z-ADDYL0186    $OM9A1           Hot Wgt < Usr
     C                     Z-ADDYL0187    $ONAA1           Hot Wgt > Usr
     C                     Z-ADDYL0188    $ONBA1           Lean Pct < Usr
     C                     Z-ADDYL0189    $ONCA1           Lean Pct > Usr
     C                     Z-ADDYL0190    $ONDA1           Backfat Inch <
     C                     Z-ADDYL0191    $ONEA1           Backfat Inch >
     C                     Z-ADDYL0192    $ONFA1           Loin Eye Inch <
     C                     Z-ADDYL0193    $ONGA1           Loin Eye Inch >
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt TH Comments       PO
      *================================================================
      * Prt TH Comments       PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt BOL Summary Totals PO
      *================================================================
      * Prt BOL Summary Totals PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * Prt Carcass Detail,Fx PO: Initialise
      *================================================================
      * USER: Initialize program
      * CASE:
      *  - (c1 AND c2 AND c3)
      *   |- c1    : PAR.TH Payment Sts is Live anything
      *   |- c2    : PAR.Print Carcass Analysis Us is No
      *   |- c3    : PAR.Print Comp Sum/Dtl STS is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0057    IFEQ 'ML'                       *IF
     C           YL0057    OREQ 'PL'
     C           YL0057    OREQ 'NL'
     C           YL0057    OREQ 'SL'
     C           YL0057    OREQ 'IL'
     C           P3MVST    IFEQ 'N'                        *IF
     C           P8TOST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0061           Status 1
     C                     MOVEL'N'       WN0062           Status 2
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is None
     C           P7DMST    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WN0061           Status 1
     C                     MOVEL'Y'       WN0062           Status 2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0061           Status 1
     C                     MOVEL'Y'       WN0062           Status 2
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Status 3 is Yes
     C           P8SVST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WN0061           Status 1
     C                     MOVEL'Y'       WN0062           Status 2
     C                     END                             *FI
     C                     Z-ADD*ZERO     WN0063           Carcass Count U
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * Prt Excluded Carc Dta PO: Initialise
      *================================================================
      * USER: Initialize program
      * Hot Wgt range for Exclude section
     C                     MOVEL'CDP'     YL0184           EV Validation C
      * Rtv CarSummary InfPrt RT - Evaluation Validation  * 
     C                     EXSR THRVGN
      * Lean PCT range for Exclude section
     C                     MOVEL'PLP'     YL0184           EV Validation C
      * Rtv CarSummary InfPrt RT - Evaluation Validation  * 
     C                     EXSR TIRVGN
      * Backfat range for Exclude section
     C                     MOVEL'BHP'     YL0184           EV Validation C
      * Rtv CarSummary InfPrt RT - Evaluation Validation  * 
     C                     EXSR TJRVGN
      * Loin Eye range for Exclude section
     C                     MOVEL'LHP'     YL0184           EV Validation C
      * Rtv CarSummary InfPrt RT - Evaluation Validation  * 
     C                     EXSR TKRVGN
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2DVCD           Lean Rng Hdg 1
     C                     MOVEL*BLANK    P2DWCD           Lean Rng Hdg 2
     C                     MOVEL*BLANK    P2DXCD           Lean Rng Hdg 3
     C                     MOVEL*BLANK    P2DYCD           Lean Rng Hdg 4
     C                     MOVEL*BLANK    P2DZCD           Lean Rng Hdg 5
     C                     MOVEL*BLANK    P2D0CD           Lean Rng Hdg 6
     C                     MOVEL*BLANK    P2D1CD           Lean Rng Hdg 7
     C                     MOVEL*BLANK    P2D2CD           Lean Rng Hdg 8
     C                     Z-ADD*ZERO     P2CXPC           Lean Rng Min 1
     C                     Z-ADD*ZERO     P2CYPC           Lean Rng Max 1
     C                     Z-ADD*ZERO     P2CZPC           Lean Rng Min 2
     C                     Z-ADD*ZERO     P2C0PC           Lean Rng Max 2
     C                     Z-ADD*ZERO     P2C1PC           Lean Rng Min 3
     C                     Z-ADD*ZERO     P2C2PC           Lean Rng Max 3
     C                     Z-ADD*ZERO     P2C3PC           Lean Rng Min 4
     C                     Z-ADD*ZERO     P2C4PC           Lean Rng Max 4
     C                     Z-ADD*ZERO     P2C5PC           Lean Rng Min 5
     C                     Z-ADD*ZERO     P2C6PC           Lean Rng Max 5
     C                     Z-ADD*ZERO     P2C7PC           Lean Rng Min 6
     C                     Z-ADD*ZERO     P2C8PC           Lean Rng Max 6
     C                     Z-ADD*ZERO     P2C9PC           Lean Rng Min 7
     C                     Z-ADD*ZERO     P2DAPC           Lean Rng Max 7
     C                     Z-ADD*ZERO     P2DBPC           Lean Rng Min 8
     C                     Z-ADD*ZERO     P2DCPC           Lean Rng Max 8
     C                     MOVEL*BLANK    P6B3ST           BOH Quote Price
     C                     MOVEL*BLANK    P6ETCD           BOH Commodity M
     C                     MOVEL*BLANK    P6EUCD           BOH Commodity P
     C                     MOVEL*BLANK    P6AMCD           CMP Program Cod
     C                     MOVEL*BLANK    P7DMST           CMP Sort Basis
     C                     Z-ADD*ZERO     P8MFNB           PY Head Killed
     C                     MOVEL*BLANK    P8SNST           Pricing UOM USR
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1BNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    A1BONB           BOL Load Number
     C                     MOVEL*LOVAL    A1CVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    A1B0DT           TH Kill Date
      * Define work field BOH Buy Order Date
     C                     Z-ADD*ZERO     WUARDT  70
      * Define work field CMP Grading Type
     C                     MOVEL*BLANK    WUDLST  1
      * Define work field CMP % of Carcass Cutout
     C                     Z-ADD*ZERO     WUVEPR  52
      * Define work field Carc/Summ Special Prc Usr
     C                     MOVEL*BLANK    WUYZST  1
      * Define work field Shipped Head Usr
     C                     Z-ADD*ZERO     WULOA1  50
      * Define work field Resale Head Recv USR
     C                     Z-ADD*ZERO     WUCSA1  50
      * Define work field PS Site ID
     C                     MOVEL*BLANK    WUNYCD 10
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field TH CA Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUI6PR  72
      * Define work field TH CA Sort Discount Amt
     C                     Z-ADD*ZERO     WUI7PR  72
      * Define work field TH CA Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUI8PR  72
      * Define work field TH CA Base Carcass Value
     C                     Z-ADD*ZERO     WUI9PR  72
      * Define work field TH CA Lean Premium Amt
     C                     Z-ADD*ZERO     WUJAPR  72
      * Define work field TH CA Carcass Gross Amt
     C                     Z-ADD*ZERO     WUJCPR  72
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUJ0ST  1
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     WUEDPR  52
      * Define work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUF7NB  51
      * Define work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     WULRNB  71
      * Define work field THD Unit Amt
     C                     Z-ADD*ZERO     WUAZVA  72
      * Define work field OMS Error Return Usr
     C                     MOVEL*BLANK    WUIPTX  5
      * Define work field PC Contract Code
     C                     MOVEL*BLANK    WUAKCD  5
      * Define work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    WUALCD  5
      * Define work field CMP Program Code
     C                     MOVEL*BLANK    WUAMCD  3
      * Define work field TH Live Wgt DRV
     C                     Z-ADD*ZERO     WUN7NB  70
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Ded/Add /Head 1 Usr
     C                     Z-ADD*ZERO     WUK1A1  72
      * Define work field Ded/Add /Head 2 Usr
     C                     Z-ADD*ZERO     WUK2A1  72
      * Define work field Ded/Add /Head 3 Usr
     C                     Z-ADD*ZERO     WUK3A1  72
      * Define work field Ded/Add /Head 4 Usr
     C                     Z-ADD*ZERO     WUK4A1  72
      * Define work field Ded/Add /Head 5 Usr
     C                     Z-ADD*ZERO     WUK5A1  72
      * Define work field Ded/Add /Head 6 Usr
     C                     Z-ADD*ZERO     WUK6A1  72
      * Define work field Ded/Add /Head 7 Usr
     C                     Z-ADD*ZERO     WUK7A1  72
      * Define work field Ded/Add /Head 8 Usr
     C                     Z-ADD*ZERO     WUK8A1  72
      * Define work field Ded/Add UOM 1 Usr
     C                     MOVEL*BLANK    WUY0ST  2
      * Define work field Ded/Add UOM 2 Usr
     C                     MOVEL*BLANK    WUY1ST  2
      * Define work field Ded/Add UOM 3 Usr
     C                     MOVEL*BLANK    WUY2ST  2
      * Define work field Ded/Add UOM 4 Usr
     C                     MOVEL*BLANK    WUY3ST  2
      * Define work field Ded/Add UOM 5 Usr
     C                     MOVEL*BLANK    WUY4ST  2
      * Define work field Ded/Add UOM 6 Usr
     C                     MOVEL*BLANK    WUY5ST  2
      * Define work field Ded/Add UOM 7 Usr
     C                     MOVEL*BLANK    WUY6ST  2
      * Define work field Ded/Add UOM 8 Usr
     C                     MOVEL*BLANK    WUY7ST  2
      * Define work field Adj Avg Live Weight   USR
     C                     Z-ADD*ZERO     WUU9NB  51
      * Define work field PY As of Kill Date
     C                     Z-ADD*ZERO     WUCHDT  70
      * Define work field Live Wgt Min USR
     C                     Z-ADD*ZERO     WUNXNB  30
      * Define work field Live Wgt Max USR
     C                     Z-ADD*ZERO     WUNYNB  30
      * Define work field Date USR
     C                     Z-ADD*ZERO     WUB5DT  70
      * Define work field Trim 1 Desc USR
     C                     MOVEL*BLANK    WUG4TX 15
      * Define work field Trim 2 Desc USR
     C                     MOVEL*BLANK    WUG5TX 15
      * Define work field Trim 3 Desc USR
     C                     MOVEL*BLANK    WUG6TX 15
      * Define work field Trim 4 Desc USR
     C                     MOVEL*BLANK    WUG7TX 15
      * Define work field Trim 5 Desc USR
     C                     MOVEL*BLANK    WUG8TX 15
      * Define work field Trim 6 Desc USR
     C                     MOVEL*BLANK    WUOZTX 15
      * Define work field Trim Extent 1 Desc USR
     C                     MOVEL*BLANK    WUOOTX  7
      * Define work field Trim Extent 2 Desc USR
     C                     MOVEL*BLANK    WUOPTX  7
      * Define work field Trim Extent 3 Desc USR
     C                     MOVEL*BLANK    WUOQTX  7
      * Define work field Trim Extent 5 Desc USR
     C                     MOVEL*BLANK    WUOSTX  7
      * Define work field Trim Extent 4 Desc USR
     C                     MOVEL*BLANK    WUORTX  7
      * Define work field Trim Extent 6 Desc USR
     C                     MOVEL*BLANK    WUO0TX  7
      * Define work field Length Usr Txt
     C                     MOVEL*BLANK    WUE5TX  2
      * Define work field Txt NU USR
     C                     MOVEL*BLANK    WUOHTX  1
      * Define work field Num NU USR
     C                     Z-ADD*ZERO     WUNUMN  10
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field Status 1
     C                     MOVEL*BLANK    WUP4ST  1
      * Define work field TH Paid 2 Week Avg Y/N
     C                     MOVEL*BLANK    WUR6ST  1
      * Define work field Status 2
     C                     MOVEL*BLANK    WUP5ST  1
      * Define work field Status 3
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Name USR
     C                     MOVEL*BLANK    WUBSTX 40
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Summary Only Usr
     C                     MOVEL*BLANK    WUNCCD 25
      * Define work field Carcass number        USR
     C                     Z-ADD*ZERO     WUNSNB  30
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    B1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    B1BNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    B1BONB           BOL Load Number
     C                     MOVEL*LOVAL    B1CVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    B1EWNB           CD Carcass/Hot
      * Define work field @Status (Yes/No)
     C                     MOVEL*BLANK    WUABST  1
      * Define work field TH Source Type
     C                     MOVEL*BLANK    WUKAST  1
      * Define work field TH Payment Type
     C                     MOVEL*BLANK    WUJ9ST  1
      * Define work field TH Hog Class Type
     C                     MOVEL*BLANK    WULLST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Unused Date
     C                     Z-ADD*ZERO     WAEDDT           TH Unused Date
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DNHMNB           BOH Company Num
     C                     MOVEL*LOVAL    DNBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    DNBONB           BOL Load Number
     C                     MOVEL*LOVAL    DNCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    DNB0DT           TH Kill Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A4HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A4BNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    A4BONB           BOL Load Number
     C                     MOVEL*LOVAL    A4CVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    A4B0DT           TH Kill Date
     C                     MOVEL*LOVAL    A4ETST           THC Comment Typ
     C                     MOVEL*LOVAL    A4BETX           THC Comment Lin
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBHMNB           BOH Company Num
     C                     MOVEL*LOVAL    WBBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    WBBONB           BOL Load Number
     C                     MOVEL*LOVAL    WBCVNB           TH Tattoo Numbe
      * Define work field Defect Count Usr
     C                     Z-ADD*ZERO     WUODNB  30
      * Define work field Tot Doa Usr
     C                     Z-ADD*ZERO     WULSA1  50
      * Define work field Tot Received Head Usr
     C                     Z-ADD*ZERO     WULTA1  50
      * Define work field Tot Yard Deads Usr
     C                     Z-ADD*ZERO     WULUA1  50
      * Define work field Tot Head Cmnd Usr
     C                     Z-ADD*ZERO     WULVA1  50
      * Define work field Tot Killed Head
     C                     Z-ADD*ZERO     WULWA1  50
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFINFN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002 10
     C                     MOVEL*BLANK    WL0003  2
     C                     Z-ADD*ZERO     WL0004  52
     C                     Z-ADD*ZERO     WL0005  72
     C                     Z-ADD*ZERO     WL0006  72
     C                     MOVEL*BLANK    WL0007  2
     C                     Z-ADD*ZERO     WL0008  52
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  1
     C                     Z-ADD*ZERO     WL0011  50
     C                     Z-ADD*ZERO     WL0012  50
     C                     Z-ADD*ZERO     WL0013  50
     C                     Z-ADD*ZERO     WL0014  50
     C                     Z-ADD*ZERO     WL0015  50
     C                     Z-ADD*ZERO     WL0016  50
     C                     Z-ADD*ZERO     WL0017  50
     C                     Z-ADD*ZERO     WL0018  50
     C                     Z-ADD*ZERO     WL0019  71
     C                     Z-ADD*ZERO     WL0020  71
     C                     Z-ADD*ZERO     WL0021  71
     C                     Z-ADD*ZERO     WL0022  61
     C                     Z-ADD*ZERO     WL0023  61
     C                     Z-ADD*ZERO     WL0024  61
     C                     Z-ADD*ZERO     WL0025  51
     C                     Z-ADD*ZERO     WL0026  51
     C                     Z-ADD*ZERO     WL0027  31
     C                     Z-ADD*ZERO     WL0028  31
     C                     Z-ADD*ZERO     WL0029  31
     C                     Z-ADD*ZERO     WL0030  31
     C                     Z-ADD*ZERO     WL0031  52
     C                     Z-ADD*ZERO     WL0032  52
     C                     Z-ADD*ZERO     WL0033  52
     C                     Z-ADD*ZERO     WL0034  52
     C                     Z-ADD*ZERO     WL0035  31
     C                     Z-ADD*ZERO     WL0036  52
     C                     Z-ADD*ZERO     WL0037  52
     C                     Z-ADD*ZERO     WL0038  72
     C                     Z-ADD*ZERO     WL0039  72
     C                     Z-ADD*ZERO     WL0040  72
     C                     Z-ADD*ZERO     WL0041  72
     C                     Z-ADD*ZERO     WL0042  72
     C                     Z-ADD*ZERO     WL0043  72
     C                     Z-ADD*ZERO     WL0044  72
     C                     Z-ADD*ZERO     WL0045  72
     C                     Z-ADD*ZERO     WL0046  72
     C                     Z-ADD*ZERO     WL0047  72
     C                     Z-ADD*ZERO     WL0048  72
     C                     Z-ADD*ZERO     WL0049  72
     C                     Z-ADD*ZERO     WL0050  80
     C                     Z-ADD*ZERO     WL0051  72
     C                     Z-ADD*ZERO     WL0052  72
     C                     Z-ADD*ZERO     WL0053  72
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055  2
     C                     MOVEL*BLANK    WL0056  1
     C                     MOVEL*BLANK    WL0057  1
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     Z-ADD*ZERO     WL0060  80
     C                     Z-ADD*ZERO     WL0061  70
     C                     MOVEL*BLANK    WL0062  1
     C                     MOVEL*BLANK    WL0063  1
     C                     MOVEL*BLANK    WL0064  1
     C                     Z-ADD*ZERO     WL0065  70
     C                     Z-ADD*ZERO     WL0066  70
     C                     Z-ADD*ZERO     WL0067  70
     C                     Z-ADD*ZERO     WL0068  71
     C                     Z-ADD*ZERO     WL0069  71
     C                     Z-ADD*ZERO     WL0070  31
     C                     Z-ADD*ZERO     WL0071  72
     C                     Z-ADD*ZERO     WL0072  72
     C                     Z-ADD*ZERO     WL0073  72
     C                     Z-ADD*ZERO     WL0074  50
     C                     Z-ADD*ZERO     WL0075  52
     C                     Z-ADD*ZERO     WL0076  52
     C                     Z-ADD*ZERO     WL0077  52
     C                     Z-ADD*ZERO     WL0078  52
     C                     Z-ADD*ZERO     WL0079  52
     C                     Z-ADD*ZERO     WL0080  52
     C                     Z-ADD*ZERO     WL0081  52
     C                     Z-ADD*ZERO     WL0082  52
     C                     Z-ADD*ZERO     WL0083  52
     C                     Z-ADD*ZERO     WL0084  52
     C                     Z-ADD*ZERO     WL0085  52
     C                     Z-ADD*ZERO     WL0086  52
     C                     MOVEL*BLANK    WL0087  1
     C                     MOVEL*BLANK    WL0088  1
     C                     MOVEL*BLANK    WL0089  1
     C                     Z-ADD*ZERO     WL0090  70
     C                     MOVEL*BLANK    WL0091  3
     C                     MOVEL*BLANK    WL0092  1
     C                     MOVEL*BLANK    WL0093  1
     C                     MOVEL*BLANK    WL0094  1
     C                     MOVEL*BLANK    WL0095  1
     C                     MOVEL*BLANK    WL0096  3
     C                     MOVEL*BLANK    WL0097  3
     C                     MOVEL*BLANK    WL0098  2
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  1
     C                     MOVEL*BLANK    WL0101  1
     C                     Z-ADD*ZERO     WL0102  71
     C                     Z-ADD*ZERO     WL0103  71
     C                     Z-ADD*ZERO     WL0104  50
     C                     Z-ADD*ZERO     WL0105  50
     C                     Z-ADD*ZERO     WL0106  72
     C                     Z-ADD*ZERO     WL0107  50
     C                     Z-ADD*ZERO     WL0108  52
     C                     Z-ADD*ZERO     WL0109  52
     C                     Z-ADD*ZERO     WL0110  50
     C                     Z-ADD*ZERO     WL0111  50
     C                     MOVEL*BLANK    WL0112  1
     C                     MOVEL*BLANK    WL0113  3
     C                     MOVEL*BLANK    WL0114  1
     C                     Z-ADD*ZERO     WL0115  52
     C                     Z-ADD*ZERO     WL0116  52
     C                     Z-ADD*ZERO     WL0117  52
     C                     Z-ADD*ZERO     WL0118  72
     C                     Z-ADD*ZERO     WL0119  50
     C                     Z-ADD*ZERO     WL0120  50
     C                     Z-ADD*ZERO     WL0121  70
     C                     Z-ADD*ZERO     WL0122  70
     C                     Z-ADD*ZERO     WL0123  72
     C                     Z-ADD*ZERO     WL0124  72
     C                     Z-ADD*ZERO     WL0125  71
     C                     Z-ADD*ZERO     WL0126  71
     C                     Z-ADD*ZERO     WL0127 111
     C                     Z-ADD*ZERO     WL0128 111
     C                     Z-ADD*ZERO     WL0129 112
     C                     Z-ADD*ZERO     WL0130 112
     C                     Z-ADD*ZERO     WL0131  52
     C                     Z-ADD*ZERO     WL0132  52
     C                     Z-ADD*ZERO     WL0133  52
     C                     Z-ADD*ZERO     WL0134  52
     C                     Z-ADD*ZERO     WL0135  92
     C                     Z-ADD*ZERO     WL0136  92
     C                     Z-ADD*ZERO     WL0137  90
     C                     Z-ADD*ZERO     WL0138  90
     C                     Z-ADD*ZERO     WL0139  70
     C                     Z-ADD*ZERO     WL0140  70
     C                     MOVEL*BLANK    WL0141  6
     C                     MOVEL*BLANK    WL0142  6
     C                     MOVEL*BLANK    WL0143  6
     C                     MOVEL*BLANK    WL0144  6
     C                     MOVEL*BLANK    WL0145  3
     C                     MOVEL*BLANK    WL0146  5
     C                     MOVEL*BLANK    WL0147  3
     C                     Z-ADD*ZERO     WL0148  70
     C                     MOVEL*BLANK    WL0149 10
     C                     MOVEL*BLANK    WL0150  2
     C                     Z-ADD*ZERO     WL0151  52
     C                     Z-ADD*ZERO     WL0152  72
     C                     Z-ADD*ZERO     WL0153  72
     C                     MOVEL*BLANK    WL0154  2
     C                     Z-ADD*ZERO     WL0155  52
     C                     Z-ADD*ZERO     WL0156  70
     C                     MOVEL*BLANK    WL0157  1
     C                     Z-ADD*ZERO     WL0158  50
     C                     Z-ADD*ZERO     WL0159  50
     C                     Z-ADD*ZERO     WL0160  50
     C                     Z-ADD*ZERO     WL0161  50
     C                     Z-ADD*ZERO     WL0162  50
     C                     Z-ADD*ZERO     WL0163  50
     C                     Z-ADD*ZERO     WL0164  50
     C                     Z-ADD*ZERO     WL0165  50
     C                     Z-ADD*ZERO     WL0166  71
     C                     Z-ADD*ZERO     WL0167  71
     C                     Z-ADD*ZERO     WL0168  71
     C                     Z-ADD*ZERO     WL0169  61
     C                     Z-ADD*ZERO     WL0170  61
     C                     Z-ADD*ZERO     WL0171  61
     C                     Z-ADD*ZERO     WL0172  51
     C                     Z-ADD*ZERO     WL0173  51
     C                     Z-ADD*ZERO     WL0174  31
     C                     Z-ADD*ZERO     WL0175  31
     C                     Z-ADD*ZERO     WL0176  31
     C                     Z-ADD*ZERO     WL0177  31
     C                     Z-ADD*ZERO     WL0178  52
     C                     Z-ADD*ZERO     WL0179  52
     C                     Z-ADD*ZERO     WL0180  52
     C                     Z-ADD*ZERO     WL0181  52
     C                     Z-ADD*ZERO     WL0182  31
     C                     Z-ADD*ZERO     WL0183  52
     C                     Z-ADD*ZERO     WL0184  52
     C                     Z-ADD*ZERO     WL0185  72
     C                     Z-ADD*ZERO     WL0186  72
     C                     Z-ADD*ZERO     WL0187  72
     C                     Z-ADD*ZERO     WL0188  72
     C                     Z-ADD*ZERO     WL0189  72
     C                     Z-ADD*ZERO     WL0190  72
     C                     Z-ADD*ZERO     WL0191  72
     C                     Z-ADD*ZERO     WL0192  72
     C                     Z-ADD*ZERO     WL0193  72
     C                     Z-ADD*ZERO     WL0194  72
     C                     Z-ADD*ZERO     WL0195  72
     C                     Z-ADD*ZERO     WL0196  72
     C                     Z-ADD*ZERO     WL0197  80
     C                     Z-ADD*ZERO     WL0198  72
     C                     Z-ADD*ZERO     WL0199  72
     C                     Z-ADD*ZERO     WL0200  72
     C                     MOVEL*BLANK    WL0201  1
     C                     MOVEL*BLANK    WL0202  2
     C                     MOVEL*BLANK    WL0203  1
     C                     MOVEL*BLANK    WL0204  1
     C                     MOVEL*BLANK    WL0205  1
     C                     MOVEL*BLANK    WL0206  1
     C                     Z-ADD*ZERO     WL0207  80
     C                     Z-ADD*ZERO     WL0208  70
     C                     MOVEL*BLANK    WL0209  1
     C                     MOVEL*BLANK    WL0210  1
     C                     MOVEL*BLANK    WL0211  1
     C                     Z-ADD*ZERO     WL0212  70
     C                     Z-ADD*ZERO     WL0213  70
     C                     Z-ADD*ZERO     WL0214  70
     C                     Z-ADD*ZERO     WL0215  71
     C                     Z-ADD*ZERO     WL0216  71
     C                     Z-ADD*ZERO     WL0217  31
     C                     Z-ADD*ZERO     WL0218  72
     C                     Z-ADD*ZERO     WL0219  72
     C                     Z-ADD*ZERO     WL0220  72
     C                     Z-ADD*ZERO     WL0221  50
     C                     Z-ADD*ZERO     WL0222  52
     C                     Z-ADD*ZERO     WL0223  52
     C                     Z-ADD*ZERO     WL0224  52
     C                     Z-ADD*ZERO     WL0225  52
     C                     Z-ADD*ZERO     WL0226  52
     C                     Z-ADD*ZERO     WL0227  52
     C                     Z-ADD*ZERO     WL0228  52
     C                     Z-ADD*ZERO     WL0229  52
     C                     Z-ADD*ZERO     WL0230  52
     C                     Z-ADD*ZERO     WL0231  52
     C                     Z-ADD*ZERO     WL0232  52
     C                     Z-ADD*ZERO     WL0233  52
     C                     MOVEL*BLANK    WL0234  1
     C                     MOVEL*BLANK    WL0235  1
     C                     MOVEL*BLANK    WL0236  1
     C                     Z-ADD*ZERO     WL0237  70
     C                     MOVEL*BLANK    WL0238  3
     C                     MOVEL*BLANK    WL0239  1
     C                     MOVEL*BLANK    WL0240  1
     C                     MOVEL*BLANK    WL0241  1
     C                     MOVEL*BLANK    WL0242  1
     C                     MOVEL*BLANK    WL0243  3
     C                     MOVEL*BLANK    WL0244  3
     C                     MOVEL*BLANK    WL0245  2
     C                     MOVEL*BLANK    WL0246  1
     C                     MOVEL*BLANK    WL0247  1
     C                     MOVEL*BLANK    WL0248  1
     C                     Z-ADD*ZERO     WL0249  71
     C                     Z-ADD*ZERO     WL0250  71
     C                     Z-ADD*ZERO     WL0251  50
     C                     Z-ADD*ZERO     WL0252  50
     C                     Z-ADD*ZERO     WL0253  72
     C                     Z-ADD*ZERO     WL0254  50
     C                     Z-ADD*ZERO     WL0255  52
     C                     Z-ADD*ZERO     WL0256  52
     C                     Z-ADD*ZERO     WL0257  50
     C                     Z-ADD*ZERO     WL0258  50
     C                     MOVEL*BLANK    WL0259  1
     C                     MOVEL*BLANK    WL0260  3
     C                     MOVEL*BLANK    WL0261  1
     C                     Z-ADD*ZERO     WL0262  52
     C                     Z-ADD*ZERO     WL0263  52
     C                     Z-ADD*ZERO     WL0264  52
     C                     Z-ADD*ZERO     WL0265  72
     C                     Z-ADD*ZERO     WL0266  50
     C                     Z-ADD*ZERO     WL0267  50
     C                     Z-ADD*ZERO     WL0268  70
     C                     Z-ADD*ZERO     WL0269  70
     C                     Z-ADD*ZERO     WL0270  72
     C                     Z-ADD*ZERO     WL0271  72
     C                     Z-ADD*ZERO     WL0272  71
     C                     Z-ADD*ZERO     WL0273  71
     C                     Z-ADD*ZERO     WL0274 111
     C                     Z-ADD*ZERO     WL0275 111
     C                     Z-ADD*ZERO     WL0276 112
     C                     Z-ADD*ZERO     WL0277 112
     C                     Z-ADD*ZERO     WL0278  52
     C                     Z-ADD*ZERO     WL0279  52
     C                     Z-ADD*ZERO     WL0280  52
     C                     Z-ADD*ZERO     WL0281  52
     C                     Z-ADD*ZERO     WL0282  92
     C                     Z-ADD*ZERO     WL0283  92
     C                     Z-ADD*ZERO     WL0284  90
     C                     Z-ADD*ZERO     WL0285  90
     C                     Z-ADD*ZERO     WL0286  70
     C                     Z-ADD*ZERO     WL0287  70
     C                     MOVEL*BLANK    WL0288  6
     C                     MOVEL*BLANK    WL0289  6
     C                     MOVEL*BLANK    WL0290  6
     C                     MOVEL*BLANK    WL0291  6
     C                     MOVEL*BLANK    WL0292  3
     C                     MOVEL*BLANK    WL0293  5
     C                     MOVEL*BLANK    WL0294  3
      * Define local work field Ded Line 1 Desc USR
     C                     MOVEL*BLANK    YL0001 20
      * Define null work field CMP Description
     C                     MOVEL*BLANK    YN0001 25
      * Define null work field CMP Carc Wgt Type
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field CMP Std Lean Percent
     C                     Z-ADD*ZERO     YN0003  31
      * Define null work field CMP Lean Factor
     C                     Z-ADD*ZERO     YN0004  31
      * Define null work field CMP Optimal Row Nbr f/srt
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field CMP Type
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field CMP Market Add/Deduct
     C                     Z-ADD*ZERO     YN0007  52
      * Define null work field CMP Fixed Cost Per Head
     C                     Z-ADD*ZERO     YN0008  52
      * Define null work field RS Record Status
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0010  6
      * Define local work field PSM Miles to Company
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field TH Purchase Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field TH Group Reference
     C                     MOVEL*BLANK    YL0004 10
      * Define local work field TH Live Purchase UOM
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field TH Live Purchase Price
     C                     Z-ADD*ZERO     YL0006  52
      * Define local work field TH Live Gross Amt
     C                     Z-ADD*ZERO     YL0007  72
      * Define local work field TH LIve Net Amt
     C                     Z-ADD*ZERO     YL0008  72
      * Define local work field TH Resale UOM
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field TH Recalc Live Wgt Yld
     C                     Z-ADD*ZERO     YL0010  52
      * Define local work field TH Pricing Date
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field TH Resale Spread Sts
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field TH Dead On Arrival
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field TH Head Received
     C                     Z-ADD*ZERO     YL0014  50
      * Define local work field TH Yard Deads
     C                     Z-ADD*ZERO     YL0015  50
      * Define local work field TH Held Over
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field TH Head Condemned
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field TH Head Killed
     C                     Z-ADD*ZERO     YL0018  50
      * Define local work field TH Head Adds
     C                     Z-ADD*ZERO     YL0019  50
      * Define local work field TH Head Accepted
     C                     Z-ADD*ZERO     YL0020  50
      * Define local work field TH Live Wgt
     C                     Z-ADD*ZERO     YL0021  71
      * Define local work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0022  71
      * Define local work field TH Hot Wgt
     C                     Z-ADD*ZERO     YL0023  71
      * Define local work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     YL0024  61
      * Define local work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     YL0025  61
      * Define local work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     YL0026  61
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0027  51
      * Define local work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0028  51
      * Define local work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     YL0029  31
      * Define local work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YL0030  31
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0031  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0032  31
      * Define local work field TH Std Yield Percent
     C                     Z-ADD*ZERO     YL0033  52
      * Define local work field TH Actual Yield %
     C                     Z-ADD*ZERO     YL0034  52
      * Define local work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     YL0035  52
      * Define local work field TH Yield Difference
     C                     Z-ADD*ZERO     YL0036  52
      * Define local work field TH Recalc Live Wgt
     C                     Z-ADD*ZERO     YL0037  31
      * Define local work field TH CM Market Price
     C                     Z-ADD*ZERO     YL0038  52
      * Define local work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YL0039  52
      * Define local work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     YL0040  72
      * Define local work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     YL0041  72
      * Define local work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     YL0042  72
      * Define local work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     YL0043  72
      * Define local work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     YL0044  72
      * Define local work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     YL0045  72
      * Define local work field TH Deduction Amt
     C                     Z-ADD*ZERO     YL0046  72
      * Define local work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     YL0047  72
      * Define local work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     YL0048  72
      * Define local work field TH Additions Amt
     C                     Z-ADD*ZERO     YL0049  72
      * Define local work field TH Payment Gross
     C                     Z-ADD*ZERO     YL0050  72
      * Define local work field Th Payment Net Amt
     C                     Z-ADD*ZERO     YL0051  72
      * Define local work field TH AP Voucher/Document#
     C                     Z-ADD*ZERO     YL0052  80
      * Define local work field TH Freight Amount
     C                     Z-ADD*ZERO     YL0053  72
      * Define local work field TH Accrual Amount
     C                     Z-ADD*ZERO     YL0054  72
      * Define local work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YL0055  72
      * Define local work field TH Calc Net Sts
     C                     MOVEL*BLANK    YL0056  1
      * Define local work field TH Payment Sts
     C                     MOVEL*BLANK    YL0057  2
      * Define local work field TH Header Error Sts
     C                     MOVEL*BLANK    YL0058  1
      * Define local work field TH Detail Error Sts
     C                     MOVEL*BLANK    YL0059  1
      * Define local work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    YL0060  1
      * Define local work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    YL0061  1
      * Define local work field TH Commission A/P Voucher
     C                     Z-ADD*ZERO     YL0062  80
      * Define local work field TH Voucher Payment Date
     C                     Z-ADD*ZERO     YL0063  70
      * Define local work field TH User Error Override
     C                     MOVEL*BLANK    YL0064  1
      * Define local work field TH Held Over Record
     C                     MOVEL*BLANK    YL0065  1
      * Define local work field TH Sex
     C                     MOVEL*BLANK    YL0066  1
      * Define local work field TH Held/Ovr Completed Dte
     C                     Z-ADD*ZERO     YL0067  70
      * Define local work field TH Commission Paid Date
     C                     Z-ADD*ZERO     YL0068  70
      * Define local work field TH Actual Check Date
     C                     Z-ADD*ZERO     YL0069  70
      * Define local work field TH Shipped Weight
     C                     Z-ADD*ZERO     YL0070  71
      * Define local work field TH Avg Hot Wgt EXC/ADD
     C                     Z-ADD*ZERO     YL0071  71
      * Define local work field TH FFLI
     C                     Z-ADD*ZERO     YL0072  31
      * Define local work field TH Kill Product Value
     C                     Z-ADD*ZERO     YL0073  72
      * Define local work field TH Cut Product Value
     C                     Z-ADD*ZERO     YL0074  72
      * Define local work field TH Render Product Value
     C                     Z-ADD*ZERO     YL0075  72
      * Define local work field TH Head Excluded
     C                     Z-ADD*ZERO     YL0076  50
      * Define local work field TH CM Bse Mkt Live /CWT
     C                     Z-ADD*ZERO     YL0077  52
      * Define local work field TH CM Bse Mkt Carc /CWT
     C                     Z-ADD*ZERO     YL0078  52
      * Define local work field TH CM Srt Dsc Live /CWT
     C                     Z-ADD*ZERO     YL0079  52
      * Define local work field TH CM Srt Dsc Carc /CWT
     C                     Z-ADD*ZERO     YL0080  52
      * Define local work field TH CM Yld G/L Live /CWT
     C                     Z-ADD*ZERO     YL0081  52
      * Define local work field TH CM Yld G/L Carc /CWT
     C                     Z-ADD*ZERO     YL0082  52
      * Define local work field TH CM Crc Val Live /CWT
     C                     Z-ADD*ZERO     YL0083  52
      * Define local work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     YL0084  52
      * Define local work field TH CM Lean Prem Live /CWT
     C                     Z-ADD*ZERO     YL0085  52
      * Define local work field TH CM Lean Prem Carc /CWT
     C                     Z-ADD*ZERO     YL0086  52
      * Define local work field TH CM Gross Live /CWT
     C                     Z-ADD*ZERO     YL0087  52
      * Define local work field TH CM Gross Carc /CWT
     C                     Z-ADD*ZERO     YL0088  52
      * Define local work field TH Source Type
     C                     MOVEL*BLANK    YL0089  1
      * Define local work field TH Scale Ticket Sts
     C                     MOVEL*BLANK    YL0090  1
      * Define local work field TH Payment Type
     C                     MOVEL*BLANK    YL0091  1
      * Define local work field TH HPS Movement Ref #
     C                     Z-ADD*ZERO     YL0092  70
      * Define local work field TH Source Code
     C                     MOVEL*BLANK    YL0093  3
      * Define local work field TH Hog Class Type
     C                     MOVEL*BLANK    YL0094  1
      * Define local work field TH Posted to HPS Flag
     C                     MOVEL*BLANK    YL0095  1
      * Define local work field TH Schedule Kill Shift
     C                     MOVEL*BLANK    YL0096  1
      * Define local work field TH Shift Held Over
     C                     MOVEL*BLANK    YL0097  1
      * Define local work field TH State
     C                     MOVEL*BLANK    YL0098  3
      * Define local work field TH Unused Code
     C                     MOVEL*BLANK    YL0099  3
      * Define local work field TH Unused Sts 2 Pos
     C                     MOVEL*BLANK    YL0100  2
      * Define local work field TH Commission Status
     C                     MOVEL*BLANK    YL0101  1
      * Define local work field TH Paid 2 Week Avg Y/N
     C                     MOVEL*BLANK    YL0102  1
      * Define local work field TH Unused Sts 1 Pos -3
     C                     MOVEL*BLANK    YL0103  1
      * Define local work field TH DOA Weight
     C                     Z-ADD*ZERO     YL0104  71
      * Define local work field TH Avg Lean % EXC/ADD
     C                     Z-ADD*ZERO     YL0105  71
      * Define local work field TH HPS Farm Site
     C                     Z-ADD*ZERO     YL0106  50
      * Define local work field TH Shift Held Over Head
     C                     Z-ADD*ZERO     YL0107  50
      * Define local work field TH Sorting Amount
     C                     Z-ADD*ZERO     YL0108  72
      * Define local work field TH Head Identified
     C                     Z-ADD*ZERO     YL0109  50
      * Define local work field TH Percent Identified
     C                     Z-ADD*ZERO     YL0110  52
      * Define local work field TH Percent Accepted
     C                     Z-ADD*ZERO     YL0111  52
      * Define local work field TH Head Adjusted-LN%
     C                     Z-ADD*ZERO     YL0112  50
      * Define local work field TH PHA Head Adds
     C                     Z-ADD*ZERO     YL0113  50
      * Define local work field TH PHA Add Type
     C                     MOVEL*BLANK    YL0114  1
      * Define local work field TH PHA Average Type
     C                     MOVEL*BLANK    YL0115  3
      * Define local work field TH PHA Add Reason
     C                     MOVEL*BLANK    YL0116  1
      * Define local work field TH PHA Yield Percent
     C                     Z-ADD*ZERO     YL0117  52
      * Define local work field TH PHA Lean Prm /Crc CWT
     C                     Z-ADD*ZERO     YL0118  52
      * Define local work field TH VC Gross Value /HD
     C                     Z-ADD*ZERO     YL0119  52
      * Define local work field TH Excluded Gross Value
     C                     Z-ADD*ZERO     YL0120  72
      * Define local work field TH Avg Lean %
     C                     Z-ADD*ZERO     YL0121  50
      * Define local work field TH Broken Back Hd Count
     C                     Z-ADD*ZERO     YL0122  50
      * Define local work field TH Hot Scl Upload Time
     C                     Z-ADD*ZERO     YL0123  70
      * Define local work field TH Unused Nbr 4
     C                     Z-ADD*ZERO     YL0124  70
      * Define local work field TH Excluded Carc Val
     C                     Z-ADD*ZERO     YL0125  72
      * Define local work field TH Excluded Premium
     C                     Z-ADD*ZERO     YL0126  72
      * Define local work field TH Unused Nbr 7
     C                     Z-ADD*ZERO     YL0127  71
      * Define local work field TH Unused Nbr 8
     C                     Z-ADD*ZERO     YL0128  71
      * Define local work field TH Unused Nbr 9
     C                     Z-ADD*ZERO     YL0129 111
      * Define local work field TH Unused Nbr 10
     C                     Z-ADD*ZERO     YL0130 111
      * Define local work field TH Break Even Price/CWT
     C                     Z-ADD*ZERO     YL0131 112
      * Define local work field TH Meat Value Factor Amt
     C                     Z-ADD*ZERO     YL0132 112
      * Define local work field TH Yld Parm Adj Yield%
     C                     Z-ADD*ZERO     YL0133  52
      * Define local work field TH PHA Sort Disc Fctr %
     C                     Z-ADD*ZERO     YL0134  52
      * Define local work field TH Avg Loin Eye - 2 dec
     C                     Z-ADD*ZERO     YL0135  52
      * Define local work field TH Avg Backfat - 2 Dec
     C                     Z-ADD*ZERO     YL0136  52
      * Define local work field TH HITCH Old Pay Net Amt
     C                     Z-ADD*ZERO     YL0137  92
      * Define local work field TH MPR Sort Loss
     C                     Z-ADD*ZERO     YL0138  92
      * Define local work field TH Unused Nbr 19
     C                     Z-ADD*ZERO     YL0139  90
      * Define local work field TH Unused Nbr 20
     C                     Z-ADD*ZERO     YL0140  90
      * Define local work field TH Cold Scl Upload Date
     C                     Z-ADD*ZERO     YL0141  70
      * Define local work field TH Cold Scl Upload Time
     C                     Z-ADD*ZERO     YL0142  70
      * Define local work field DF Defect Code
     C                     MOVEL*BLANK    YL0143  6
      * Define local work field THP Process Code
     C                     MOVEL*BLANK    YL0144  6
      * Define local work field PD Producer Code
     C                     MOVEL*BLANK    YL0145  6
      * Define local work field PL Location Code
     C                     MOVEL*BLANK    YL0146  6
      * Define local work field HB Buyer Code
     C                     MOVEL*BLANK    YL0147  3
      * Define local work field GN Genetic Code
     C                     MOVEL*BLANK    YL0148  5
      * Define local work field HC Class Code
     C                     MOVEL*BLANK    YL0149  3
      * Define local work field TH Kill Date
     C                     Z-ADD*ZERO     YL0150  70
      * Define local work field PD Name
     C                     MOVEL*BLANK    YL0151 40
      * Define local work field PL Name
     C                     MOVEL*BLANK    YL0152 40
      * Define local work field Pl VND Address Number
     C                     Z-ADD*ZERO     YL0153  80
      * Define local work field PL State Code
     C                     MOVEL*BLANK    YL0154  3
      * Define local work field Pass Name
     C                     MOVEL*BLANK    YL0155 40
      * Define local work field Address 1
     C                     MOVEL*BLANK    YL0156 40
      * Define local work field Address 2
     C                     MOVEL*BLANK    YL0157 40
      * Define local work field Address 3
     C                     MOVEL*BLANK    YL0158 40
      * Define local work field City
     C                     MOVEL*BLANK    YL0159 40
      * Define local work field State
     C                     MOVEL*BLANK    YL0160  3
      * Define local work field Zip
     C                     MOVEL*BLANK    YL0161 12
      * Define local work field Area Code
     C                     MOVEL*BLANK    YL0162  6
      * Define local work field Telephone
     C                     MOVEL*BLANK    YL0163 20
      * Define local work field Fax Area Code #
     C                     MOVEL*BLANK    YL0164  6
      * Define local work field Fax Telephone
     C                     MOVEL*BLANK    YL0165 20
      * Define local work field Fax Area Code # 2
     C                     MOVEL*BLANK    YL0166  6
      * Define local work field Fax Telephone 2
     C                     MOVEL*BLANK    YL0167 20
      * Define local work field Vendor 1099
     C                     MOVEL*BLANK    YL0168  1
      * Define local work field Vendor Tax Id.
     C                     MOVEL*BLANK    YL0169 16
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0170  3
      * Define local work field TH Live Wgt DRV
     C                     Z-ADD*ZERO     YL0171  70
      * Define local work field Th Live Adj Wgt Drv
     C                     Z-ADD*ZERO     YL0172  70
      * Define local work field TH Hot Wgt DRV
     C                     Z-ADD*ZERO     YL0173  70
      * Define local work field OMS Market Price Amt Usr
     C                     Z-ADD*ZERO     YL0174 114
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0175  70
      * Define null work field BOH Market Add/Deduct
     C                     Z-ADD*ZERO     YN0011  52
      * Define null work field BOH Quote Price Type
     C                     MOVEL*BLANK    YN0012  2
      * Define null work field BOH Quoted Base Mkt Price
     C                     Z-ADD*ZERO     YN0013  52
      * Define null work field BOH Commodity Market Code
     C                     MOVEL*BLANK    YN0014  3
      * Define null work field BOH Commodity Price Group
     C                     MOVEL*BLANK    YN0015  7
      * Define null work field BOH Market Date Method
     C                     MOVEL*BLANK    YN0016  3
      * Define null work field PO Option Code
     C                     MOVEL*BLANK    YN0017  3
      * Define null work field CMP Grading Type
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field CMP Sort Basis
     C                     MOVEL*BLANK    YN0019  1
      * Define local work field PrdLoc Trnsp Allow Rt Usr
     C                     Z-ADD*ZERO     YL0176  72
      * Define null work field TH State
     C                     MOVEL*BLANK    YN0020  3
      * Define null work field TH Unused Code
     C                     MOVEL*BLANK    YN0021  3
      * Define null work field TH Unused Sts 2 Pos
     C                     MOVEL*BLANK    YN0022  2
      * Define null work field TH Commission Status
     C                     MOVEL*BLANK    YN0023  1
      * Define null work field TH Paid 2 Week Avg Y/N
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field TH Unused Sts 1 Pos -3
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field TH DOA Weight
     C                     Z-ADD*ZERO     YN0026  71
      * Define null work field TH Avg Lean % EXC/ADD
     C                     Z-ADD*ZERO     YN0027  71
      * Define null work field TH HPS Farm Site
     C                     Z-ADD*ZERO     YN0028  50
      * Define null work field TH Shift Held Over Head
     C                     Z-ADD*ZERO     YN0029  50
      * Define null work field TH Sorting Amount
     C                     Z-ADD*ZERO     YN0030  72
      * Define null work field TH Head Identified
     C                     Z-ADD*ZERO     YN0031  50
      * Define null work field TH Percent Identified
     C                     Z-ADD*ZERO     YN0032  52
      * Define null work field TH Percent Accepted
     C                     Z-ADD*ZERO     YN0033  52
      * Define null work field TH PHA Add Type
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field TH PHA Average Type
     C                     MOVEL*BLANK    YN0035  3
      * Define null work field TH PHA Add Reason
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field TH VC Gross Value /HD
     C                     Z-ADD*ZERO     YN0037  52
      * Define null work field TH Avg Lean %
     C                     Z-ADD*ZERO     YN0038  50
      * Define null work field TH Broken Back Hd Count
     C                     Z-ADD*ZERO     YN0039  50
      * Define null work field TH Hot Scl Upload Time
     C                     Z-ADD*ZERO     YN0040  70
      * Define null work field TH Unused Nbr 4
     C                     Z-ADD*ZERO     YN0041  70
      * Define null work field TH Excluded Carc Val
     C                     Z-ADD*ZERO     YN0042  72
      * Define null work field TH Excluded Premium
     C                     Z-ADD*ZERO     YN0043  72
      * Define null work field TH Unused Nbr 7
     C                     Z-ADD*ZERO     YN0044  71
      * Define null work field TH Unused Nbr 8
     C                     Z-ADD*ZERO     YN0045  71
      * Define null work field TH Unused Nbr 9
     C                     Z-ADD*ZERO     YN0046 111
      * Define null work field TH Unused Nbr 10
     C                     Z-ADD*ZERO     YN0047 111
      * Define null work field TH Break Even Price/CWT
     C                     Z-ADD*ZERO     YN0048 112
      * Define null work field TH Meat Value Factor Amt
     C                     Z-ADD*ZERO     YN0049 112
      * Define null work field TH Yld Parm Adj Yield%
     C                     Z-ADD*ZERO     YN0050  52
      * Define null work field TH HITCH Old Pay Net Amt
     C                     Z-ADD*ZERO     YN0051  92
      * Define null work field TH MPR Sort Loss
     C                     Z-ADD*ZERO     YN0052  92
      * Define null work field TH Unused Nbr 19
     C                     Z-ADD*ZERO     YN0053  90
      * Define null work field TH Unused Nbr 20
     C                     Z-ADD*ZERO     YN0054  90
      * Define null work field TH Cold Scl Upload Date
     C                     Z-ADD*ZERO     YN0055  70
      * Define null work field TH Cold Scl Upload Time
     C                     Z-ADD*ZERO     YN0056  70
      * Define local work field TRK Trucker Code
     C                     MOVEL*BLANK    YL0177  3
      * Define local work field TRK Name
     C                     MOVEL*BLANK    YL0178 40
      * Define local work field CMP Grading Type
     C                     MOVEL*BLANK    YL0179  1
      * Define local work field Carcass Summary BOL USR
     C                     MOVEL*BLANK    YL0180 10
      * Define local work field Company Value Code    USR
     C                     MOVEL*BLANK    YL0181 10
      * Define local work field BOH Buy Order Date
     C                     Z-ADD*ZERO     YL0182  70
      * Define local work field Format Printed        USR
     C                     MOVEL*BLANK    YL0183  1
      * Define local work field EV Validation Code
     C                     MOVEL*BLANK    YL0184  3
      * Define local work field EV Description
     C                     MOVEL*BLANK    YL0185 25
      * Define local work field Hot Wgt < Usr
     C                     Z-ADD*ZERO     YL0186  71
      * Define local work field Hot Wgt > Usr
     C                     Z-ADD*ZERO     YL0187  71
      * Define local work field Lean Pct < Usr
     C                     Z-ADD*ZERO     YL0188  71
      * Define local work field Lean Pct > Usr
     C                     Z-ADD*ZERO     YL0189  71
      * Define local work field Backfat Inch < Usr
     C                     Z-ADD*ZERO     YL0190  52
      * Define local work field Backfat Inch > Usr
     C                     Z-ADD*ZERO     YL0191  52
      * Define local work field Loin Eye Inch < Usr
     C                     Z-ADD*ZERO     YL0192  52
      * Define local work field Loin Eye Inch > Usr
     C                     Z-ADD*ZERO     YL0193  52
      * Define local work field Status 4
     C                     MOVEL*BLANK    YL0194  1
      * Define local work field TH Payment Sts
     C                     MOVEL*BLANK    YL0195  2
      * Define local work field Text of 35 size  Usr
     C                     MOVEL*BLANK    YL0196 35
      * Define local work field Defect Desc Usr 1
     C                     MOVEL*BLANK    YL0197 10
      * Define local work field Defect HD user 1
     C                     Z-ADD*ZERO     YL0198  50
      * Define local work field Defect Desc Usr 2
     C                     MOVEL*BLANK    YL0199 10
      * Define local work field Defect HD user 2
     C                     Z-ADD*ZERO     YL0200  50
      * Define local work field Defect Desc Usr 3
     C                     MOVEL*BLANK    YL0201 10
      * Define local work field Defect HD user 3
     C                     Z-ADD*ZERO     YL0202  50
      * Define local work field Defect Desc Usr 4
     C                     MOVEL*BLANK    YL0203 10
      * Define local work field Defect HD user 4
     C                     Z-ADD*ZERO     YL0204  50
      * Define local work field Defect Desc Usr 5
     C                     MOVEL*BLANK    YL0205 10
      * Define local work field Defect HD user 5
     C                     Z-ADD*ZERO     YL0206  50
      * Define local work field Defect Desc Usr 6
     C                     MOVEL*BLANK    YL0207 10
      * Define local work field Defect HD user 6
     C                     Z-ADD*ZERO     YL0208  50
      * Define local work field Defect Desc Usr 7
     C                     MOVEL*BLANK    YL0209 10
      * Define local work field Defect HD user 7
     C                     Z-ADD*ZERO     YL0210  50
      * Define local work field Defect Desc Usr 8
     C                     MOVEL*BLANK    YL0211 10
      * Define local work field Defect HD user 8
     C                     Z-ADD*ZERO     YL0212  50
      * Define local work field Defect Desc Usr 9
     C                     MOVEL*BLANK    YL0213 10
      * Define local work field Defect HD user 9
     C                     Z-ADD*ZERO     YL0214  50
      * Define local work field Defect Desc Usr 10
     C                     MOVEL*BLANK    YL0215 10
      * Define local work field Defect HD user 10
     C                     Z-ADD*ZERO     YL0216  50
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modifications ---
     C                     EXSR UASUBR                     Modifications -
      * Rtv Lean Hdg/Rng      RT - Crc Sum Lean Dist Range  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    YL0001           Ded Line 1 Desc
     C                     MOVEL'Freight' YL0001           Ded Line 1 Desc
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 C O M P A R I S O N
00002 C A R C A S S   M E R I T
00003    Carcass
00004   Carc Wgt
00005 Carcass--
00006       Live
00007   Live Wgt
00008 Live Delivered Weight
00009   Average Live Weight
00010 Carcass Weight
00011   Average Carcass Weight
00012 Sort Factor
00013 Base Carcass Price
00014 Base Market Price
00015 Yield Gain/Loss
00016 Carcass Value
00017 Quality Premium/Deduct
00018 Fixed Cost
00019 Lean Premium/Deduct
00020 HPECSBOLLN
00021 ** This information is co
00022 nfidential between the
00023 Producer and
00024 ---Fixed Cost----
00025 --------Lean--------
00026 --Carcass Value--
00027 ------Quality-------
