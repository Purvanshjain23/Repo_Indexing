     H/TITLE Read all rcds for Prg XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 11/02/10  Time  : 11:46:25
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FARBDCPLHIF  E           K        DISK
      * RSQ : A/R Header                RSQ to read purge rcds
      *
     FARBECPL1IF  E           K        DISK
      * RTV : A/R Detail                Retrieval index       V
      *
     FPDNHCPL1IF  E           K        DISK
      * RTV : A/R OA/CM Transactions    Retrieval index
      *
     FPOBUREL1IF  E           K        DISK
      * RTV : A/R Header Notes OLD      Retrieval index
      *
     FPMEDCPL1IF  E           K        DISK
      * RTV : A/R Header Note Header    Retrieval index
      *
     FPMEFCPL1IF  E           K        DISK
      * RTV : A/R Header Note Detail    Retrieval index
      *
     FPPA4CPL1IF  E           K        DISK
      * RTV : A/R Header OA             Retrieval index
      *
     FARBDCPLCIF  E           K        DISK
      * RSQ : A/R Header                Trans Dt(D),Sel $00 Tran
      *
     FARBDCPRGIF  E           K        DISK                      A
      * UPD : A/R Header                Update Index for Purging
      *
     FARBDCPL0UF  E           K        DISK
      * UPD : A/R Header                Update index
      *
     FARBECPRGIF  E           K        DISK                      A
      * UPD : A/R Detail                Update index for purge
      *
     FARBECPL0UF  E           K        DISK
      * UPD : A/R Detail                Update index
      *
     FPDNHCPRGIF  E           K        DISK                      A
      * UPD : A/R OA/CM Transactions    Update Index for Purge
      *
     FPDNHCPL0UF  E           K        DISK
      * UPD : A/R OA/CM Transactions    Update index
      *
     FPOBUREL6IF  E           K        DISK                      A
      * UPD : A/R Header Notes OLD      Update Index for Purge
      *
     FPOBUREL0UF  E           K        DISK
      * UPD : A/R Header Notes OLD      Update index
      *
     FPMEFCPL3IF  E           K        DISK                      A
      * UPD : A/R Header Note Detail    Update Index -Purge
      *
     FPMEFCPL0UF  E           K        DISK
      * UPD : A/R Header Note Detail    Update index
      *
     FPMEDCPL6IF  E           K        DISK                      A
      * UPD : A/R Header Note Header    Update Index -Purge
      *
     FPMEDCPL0UF  E           K        DISK
      * UPD : A/R Header Note Header    Update index
      *
     FPPA4CPL3IF  E           K        DISK                      A
      * UPD : A/R Header OA             Update Index for Purge
      *
     FPPA4CPL0UF  E           K        DISK
      * UPD : A/R Header OA             Update index
      *
     I@BDCPDG
      * A/R Header                RSQ to read purge rcds
      * Renamed input format fields
     I              BDAIC3                          WAAIC3
     I              BDCONB                          WACONB
     I              BDCEST                          WACEST
     I              BDUHCD                          WAUHCD
     I              BDBSVA                          WABSVA
     I              BDAIVA                          WAAIVA
     I              BDAOVA                          WAAOVA
     I              BDBGVA                          WABGVA
     I              BDAJST                          WAAJST
     I              BDE3ST                          WAE3ST
     I              BDG4CD                          WAG4CD
     I              BDCKNB                          WACKNB
     I              BDCAC7                          WACAC7
     I              BDBKC7                          WABKC7
     I              BDBCCD                          WABCCD
     I              BDR4CD                          WAR4CD
     I              BDB4DT                          WAB4DT
     I              BDATDT                          WAATDT
     I              BDH0DT                          WAH0DT
     I              BDH3DT                          WAH3DT
     I              BDH4DT                          WAH4DT
     I              BDH5DT                          WAH5DT
     I              BDANC7                          WAANC7
     I              BDCPTX                          WACPTX
     I              BDBSDY                          WABSDY
     I              BDUVST                          WAUVST
     I              BDUWST                          WAUWST
     I              BDUXST                          WAUXST
     I              BDAATM                          WAAATM
     I              BDAYNA                          WAAYNA
     I              BDA0NA                          WAA0NA
     I              BDAXDT                          WAAXDT
      *
     I@BDCPDH
      * A/R Header                Update Index for Purging
      * Renamed input format fields
     I              BDAIC3                          WBAIC3
     I              BDCONB                          WBCONB
     I              BDCEST                          WBCEST
     I              BDUHCD                          WBUHCD
     I              BDBSVA                          WBBSVA
     I              BDAIVA                          WBAIVA
     I              BDAOVA                          WBAOVA
     I              BDBGVA                          WBBGVA
     I              BDAJST                          WBAJST
     I              BDE3ST                          WBE3ST
     I              BDG4CD                          WBG4CD
     I              BDCKNB                          WBCKNB
     I              BDCAC7                          WBCAC7
     I              BDBKC7                          WBBKC7
     I              BDBCCD                          WBBCCD
     I              BDR4CD                          WBR4CD
     I              BDB4DT                          WBB4DT
     I              BDATDT                          WBATDT
     I              BDH0DT                          WBH0DT
     I              BDH3DT                          WBH3DT
     I              BDH4DT                          WBH4DT
     I              BDH5DT                          WBH5DT
     I              BDANC7                          WBANC7
     I              BDCPTX                          WBCPTX
     I              BDBSDY                          WBBSDY
     I              BDUVST                          WBUVST
     I              BDUWST                          WBUWST
     I              BDUXST                          WBUXST
     I              BDAATM                          WBAATM
     I              BDAYNA                          WBAYNA
     I              BDA0NA                          WBA0NA
     I              BDAXDT                          WBAXDT
      *
     I@BDCPFG
      * A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WCAIC3
     I              BDCONB                          WCCONB
     I              BDCEST                          WCCEST
     I              BDUHCD                          WCUHCD
     I              BDBSVA                          WCBSVA
     I              BDAIVA                          WCAIVA
     I              BDAOVA                          WCAOVA
     I              BDBGVA                          WCBGVA
     I              BDAJST                          WCAJST
     I              BDE3ST                          WCE3ST
     I              BDG4CD                          WCG4CD
     I              BDCKNB                          WCCKNB
     I              BDCAC7                          WCCAC7
     I              BDBKC7                          WCBKC7
     I              BDBCCD                          WCBCCD
     I              BDR4CD                          WCR4CD
     I              BDB4DT                          WCB4DT
     I              BDATDT                          WCATDT
     I              BDH0DT                          WCH0DT
     I              BDH3DT                          WCH3DT
     I              BDH4DT                          WCH4DT
     I              BDH5DT                          WCH5DT
     I              BDANC7                          WCANC7
     I              BDCPTX                          WCCPTX
     I              BDBSDY                          WCBSDY
     I              BDUVST                          WCUVST
     I              BDUWST                          WCUWST
     I              BDUXST                          WCUXST
     I              BDAATM                          WCAATM
     I              BDAYNA                          WCAYNA
     I              BDA0NA                          WCA0NA
     I              BDAXDT                          WCAXDT
      *
     I@BFCPFO
      * A/R Detail                Retrieval index       V
      * Renamed input format fields
     I              BFAIC3                          WDAIC3
     I              BFCONB                          WDCONB
     I              BFCEST                          WDCEST
     I              BFDXNB                          WDDXNB
     I              BFUHCD                          WDUHCD
     I              BFBSVA                          WDBSVA
     I              BFCPTX                          WDCPTX
     I              BFNGNA                          WDNGNA
     I              BFB4DT                          WDB4DT
     I              BFDVDT                          WDDVDT
     I              BFYXNX                          WDYXNX
     I              BFHYDT                          WDHYDT
     I              BFG4CD                          WDG4CD
     I              BFCKNB                          WDCKNB
     I              BFA5ST                          WDA5ST
     I              BFAJST                          WDAJST
     I              BFB1VN                          WDB1VN
     I              BFEAZT                          WDEAZT
     I              BFC1NY                          WDC1NY
     I              BFIZTX                          WDIZTX
     I              BFETSX                          WDETSX
     I              BFW3SX                          WDW3SX
     I              BFW4SX                          WDW4SX
     I              BFW5SX                          WDW5SX
     I              BFW6SX                          WDW6SX
     I              BFW7SX                          WDW7SX
     I              BFW8SX                          WDW8SX
     I              BFQHDT                          WDQHDT
     I              BFQIDT                          WDQIDT
     I              BFQJDT                          WDQJDT
     I              BFQKDT                          WDQKDT
     I              BFQLDT                          WDQLDT
     I              BFGLVL                          WDGLVL
     I              BFGMVL                          WDGMVL
     I              BFGNVL                          WDGNVL
     I              BFGOVL                          WDGOVL
     I              BFGPVL                          WDGPVL
     I              BFUVST                          WDUVST
     I              BFUWST                          WDUWST
     I              BFUXST                          WDUXST
     I              BFAATM                          WDAATM
     I              BFAYNA                          WDAYNA
     I              BFA0NA                          WDA0NA
     I              BFAXDT                          WDAXDT
      *
     I@BECPDI
      * A/R Detail                Update index for purge
      * Renamed input format fields
     I              BFAIC3                          WEAIC3
     I              BFCONB                          WECONB
     I              BFCEST                          WECEST
     I              BFDXNB                          WEDXNB
     I              BFUHCD                          WEUHCD
     I              BFBSVA                          WEBSVA
     I              BFCPTX                          WECPTX
     I              BFNGNA                          WENGNA
     I              BFB4DT                          WEB4DT
     I              BFDVDT                          WEDVDT
     I              BFYXNX                          WEYXNX
     I              BFHYDT                          WEHYDT
     I              BFG4CD                          WEG4CD
     I              BFCKNB                          WECKNB
     I              BFA5ST                          WEA5ST
     I              BFAJST                          WEAJST
     I              BFB1VN                          WEB1VN
     I              BFEAZT                          WEEAZT
     I              BFC1NY                          WEC1NY
     I              BFIZTX                          WEIZTX
     I              BFETSX                          WEETSX
     I              BFW3SX                          WEW3SX
     I              BFW4SX                          WEW4SX
     I              BFW5SX                          WEW5SX
     I              BFW6SX                          WEW6SX
     I              BFW7SX                          WEW7SX
     I              BFW8SX                          WEW8SX
     I              BFQHDT                          WEQHDT
     I              BFQIDT                          WEQIDT
     I              BFQJDT                          WEQJDT
     I              BFQKDT                          WEQKDT
     I              BFQLDT                          WEQLDT
     I              BFGLVL                          WEGLVL
     I              BFGMVL                          WEGMVL
     I              BFGNVL                          WEGNVL
     I              BFGOVL                          WEGOVL
     I              BFGPVL                          WEGPVL
     I              BFUVST                          WEUVST
     I              BFUWST                          WEUWST
     I              BFUXST                          WEUXST
     I              BFAATM                          WEAATM
     I              BFAYNA                          WEAYNA
     I              BFA0NA                          WEA0NA
     I              BFAXDT                          WEAXDT
      *
     I@BFCPFN
      * A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WFAIC3
     I              BFCONB                          WFCONB
     I              BFCEST                          WFCEST
     I              BFDXNB                          WFDXNB
     I              BFUHCD                          WFUHCD
     I              BFBSVA                          WFBSVA
     I              BFCPTX                          WFCPTX
     I              BFNGNA                          WFNGNA
     I              BFB4DT                          WFB4DT
     I              BFDVDT                          WFDVDT
     I              BFYXNX                          WFYXNX
     I              BFHYDT                          WFHYDT
     I              BFG4CD                          WFG4CD
     I              BFCKNB                          WFCKNB
     I              BFA5ST                          WFA5ST
     I              BFAJST                          WFAJST
     I              BFB1VN                          WFB1VN
     I              BFEAZT                          WFEAZT
     I              BFC1NY                          WFC1NY
     I              BFIZTX                          WFIZTX
     I              BFETSX                          WFETSX
     I              BFW3SX                          WFW3SX
     I              BFW4SX                          WFW4SX
     I              BFW5SX                          WFW5SX
     I              BFW6SX                          WFW6SX
     I              BFW7SX                          WFW7SX
     I              BFW8SX                          WFW8SX
     I              BFQHDT                          WFQHDT
     I              BFQIDT                          WFQIDT
     I              BFQJDT                          WFQJDT
     I              BFQKDT                          WFQKDT
     I              BFQLDT                          WFQLDT
     I              BFGLVL                          WFGLVL
     I              BFGMVL                          WFGMVL
     I              BFGNVL                          WFGNVL
     I              BFGOVL                          WFGOVL
     I              BFGPVL                          WFGPVL
     I              BFUVST                          WFUVST
     I              BFUWST                          WFUWST
     I              BFUXST                          WFUXST
     I              BFAATM                          WFAATM
     I              BFAYNA                          WFAYNA
     I              BFA0NA                          WFA0NA
     I              BFAXDT                          WFAXDT
      *
     I@NHCPBH
      * A/R OA/CM Transactions    Retrieval index
      * Renamed input format fields
     I              NHAIC3                          WGAIC3
     I              NHCONB                          WGCONB
     I              NHCEST                          WGCEST
     I              NHJZNX                          WGJZNX
     I              NHHNSX                          WGHNSX
     I              NHBSVA                          WGBSVA
     I              NHVSST                          WGVSST
     I              NHMJDT                          WGMJDT
     I              NHBETM                          WGBETM
     I              NHCCVN                          WGCCVN
     I              NHCDVN                          WGCDVN
     I              NHMKDT                          WGMKDT
     I              NHBFTM                          WGBFTM
     I              NHCEVN                          WGCEVN
     I              NHCFVN                          WGCFVN
      *
     I@NHCPDJ
      * A/R OA/CM Transactions    Update Index for Purge
      * Renamed input format fields
     I              NHAIC3                          WHAIC3
     I              NHCONB                          WHCONB
     I              NHCEST                          WHCEST
     I              NHJZNX                          WHJZNX
     I              NHHNSX                          WHHNSX
     I              NHBSVA                          WHBSVA
     I              NHVSST                          WHVSST
     I              NHMJDT                          WHMJDT
     I              NHBETM                          WHBETM
     I              NHCCVN                          WHCCVN
     I              NHCDVN                          WHCDVN
     I              NHMKDT                          WHMKDT
     I              NHBFTM                          WHBFTM
     I              NHCEVN                          WHCEVN
     I              NHCFVN                          WHCFVN
      *
     I@NHCPBG
      * A/R OA/CM Transactions    Update index
      * Renamed input format fields
     I              NHAIC3                          WIAIC3
     I              NHCONB                          WICONB
     I              NHCEST                          WICEST
     I              NHJZNX                          WIJZNX
     I              NHHNSX                          WIHNSX
     I              NHBSVA                          WIBSVA
     I              NHVSST                          WIVSST
     I              NHMJDT                          WIMJDT
     I              NHBETM                          WIBETM
     I              NHCCVN                          WICCVN
     I              NHCDVN                          WICDVN
     I              NHMKDT                          WIMKDT
     I              NHBFTM                          WIBFTM
     I              NHCEVN                          WICEVN
     I              NHCFVN                          WICFVN
      *
     I@BURELN
      * A/R Header Notes OLD      Retrieval index
      * Renamed input format fields
     I              BUAIC3                          WJAIC3
     I              BUCONB                          WJCONB
     I              BUCEST                          WJCEST
     I              BUOTDT                          WJOTDT
     I              BUDXNB                          WJDXNB
     I              BUL5SX                          WJL5SX
     I              BUOUDT                          WJOUDT
     I              BUA3T1                          WJA3T1
     I              BUA4T1                          WJA4T1
     I              BUA5T1                          WJA5T1
     I              BUL6SX                          WJL6SX
     I              BUL7SX                          WJL7SX
     I              BUL8SX                          WJL8SX
     I              BUBKC7                          WJBKC7
      *
     I@BURELV
      * A/R Header Notes OLD      Update Index for Purge
      * Renamed input format fields
     I              BUAIC3                          WKAIC3
     I              BUCONB                          WKCONB
     I              BUCEST                          WKCEST
     I              BUOTDT                          WKOTDT
     I              BUDXNB                          WKDXNB
     I              BUL5SX                          WKL5SX
     I              BUOUDT                          WKOUDT
     I              BUA3T1                          WKA3T1
     I              BUA4T1                          WKA4T1
     I              BUA5T1                          WKA5T1
     I              BUL6SX                          WKL6SX
     I              BUL7SX                          WKL7SX
     I              BUL8SX                          WKL8SX
     I              BUBKC7                          WKBKC7
      *
     I@BURELM
      * A/R Header Notes OLD      Update index
      * Renamed input format fields
     I              BUAIC3                          WLAIC3
     I              BUCONB                          WLCONB
     I              BUCEST                          WLCEST
     I              BUOTDT                          WLOTDT
     I              BUDXNB                          WLDXNB
     I              BUL5SX                          WLL5SX
     I              BUOUDT                          WLOUDT
     I              BUA3T1                          WLA3T1
     I              BUA4T1                          WLA4T1
     I              BUA5T1                          WLA5T1
     I              BUL6SX                          WLL6SX
     I              BUL7SX                          WLL7SX
     I              BUL8SX                          WLL8SX
     I              BUBKC7                          WLBKC7
      *
     I@EDCPVF
      * A/R Header Note Header    Retrieval index
      * Renamed input format fields
     I              EDAIC3                          WMAIC3
     I              EDCONB                          WMCONB
     I              EDCEST                          WMCEST
     I              EDNBNY                          WMNBNY
     I              EDSLDT                          WMSLDT
     I              EDDETM                          WMDETM
     I              EDENVN                          WMENVN
     I              EDSMDT                          WMSMDT
     I              EDFUPS                          WMFUPS
     I              EDSNDT                          WMSNDT
     I              EDDFTM                          WMDFTM
     I              EDEMVN                          WMEMVN
     I              EDANC7                          WMANC7
     I              EDR4CD                          WMR4CD
     I              EDVSST                          WMVSST
     I              EDMJDT                          WMMJDT
     I              EDBETM                          WMBETM
     I              EDCCVN                          WMCCVN
     I              EDCDVN                          WMCDVN
     I              EDMKDT                          WMMKDT
     I              EDBFTM                          WMBFTM
     I              EDCEVN                          WMCEVN
     I              EDCFVN                          WMCFVN
      *
     I@EFCPVZ
      * A/R Header Note Detail    Retrieval index
      * Renamed input format fields
     I              EFAIC3                          WOAIC3
     I              EFCONB                          WOCONB
     I              EFCEST                          WOCEST
     I              EFNBNY                          WONBNY
     I              EFNCNY                          WONCNY
     I              EFSWNA                          WOSWNA
     I              EFVSST                          WOVSST
     I              EFMJDT                          WOMJDT
     I              EFBETM                          WOBETM
     I              EFCCVN                          WOCCVN
     I              EFCDVN                          WOCDVN
     I              EFMKDT                          WOMKDT
     I              EFBFTM                          WOBFTM
     I              EFCEVN                          WOCEVN
     I              EFCFVN                          WOCFVN
      *
     I@EFCPV8
      * A/R Header Note Detail    Update Index -Purge
      * Renamed input format fields
     I              EFAIC3                          WRAIC3
     I              EFCONB                          WRCONB
     I              EFCEST                          WRCEST
     I              EFNBNY                          WRNBNY
     I              EFNCNY                          WRNCNY
     I              EFSWNA                          WRSWNA
     I              EFVSST                          WRVSST
     I              EFMJDT                          WRMJDT
     I              EFBETM                          WRBETM
     I              EFCCVN                          WRCCVN
     I              EFCDVN                          WRCDVN
     I              EFMKDT                          WRMKDT
     I              EFBFTM                          WRBFTM
     I              EFCEVN                          WRCEVN
     I              EFCFVN                          WRCFVN
      *
     I@EFCPVY
      * A/R Header Note Detail    Update index
      * Renamed input format fields
     I              EFAIC3                          WSAIC3
     I              EFCONB                          WSCONB
     I              EFCEST                          WSCEST
     I              EFNBNY                          WSNBNY
     I              EFNCNY                          WSNCNY
     I              EFSWNA                          WSSWNA
     I              EFVSST                          WSVSST
     I              EFMJDT                          WSMJDT
     I              EFBETM                          WSBETM
     I              EFCCVN                          WSCCVN
     I              EFCDVN                          WSCDVN
     I              EFMKDT                          WSMKDT
     I              EFBFTM                          WSBFTM
     I              EFCEVN                          WSCEVN
     I              EFCFVN                          WSCFVN
      *
     I@EDCPV7
      * A/R Header Note Header    Update Index -Purge
      * Renamed input format fields
     I              EDAIC3                          WTAIC3
     I              EDCONB                          WTCONB
     I              EDCEST                          WTCEST
     I              EDNBNY                          WTNBNY
     I              EDSLDT                          WTSLDT
     I              EDDETM                          WTDETM
     I              EDENVN                          WTENVN
     I              EDSMDT                          WTSMDT
     I              EDFUPS                          WTFUPS
     I              EDSNDT                          WTSNDT
     I              EDDFTM                          WTDFTM
     I              EDEMVN                          WTEMVN
     I              EDANC7                          WTANC7
     I              EDR4CD                          WTR4CD
     I              EDVSST                          WTVSST
     I              EDMJDT                          WTMJDT
     I              EDBETM                          WTBETM
     I              EDCCVN                          WTCCVN
     I              EDCDVN                          WTCDVN
     I              EDMKDT                          WTMKDT
     I              EDBFTM                          WTBFTM
     I              EDCEVN                          WTCEVN
     I              EDCFVN                          WTCFVN
      *
     I@EDCPVE
      * A/R Header Note Header    Update index
      * Renamed input format fields
     I              EDAIC3                          WVAIC3
     I              EDCONB                          WVCONB
     I              EDCEST                          WVCEST
     I              EDNBNY                          WVNBNY
     I              EDSLDT                          WVSLDT
     I              EDDETM                          WVDETM
     I              EDENVN                          WVENVN
     I              EDSMDT                          WVSMDT
     I              EDFUPS                          WVFUPS
     I              EDSNDT                          WVSNDT
     I              EDDFTM                          WVDFTM
     I              EDEMVN                          WVEMVN
     I              EDANC7                          WVANC7
     I              EDR4CD                          WVR4CD
     I              EDVSST                          WVVSST
     I              EDMJDT                          WVMJDT
     I              EDBETM                          WVBETM
     I              EDCCVN                          WVCCVN
     I              EDCDVN                          WVCDVN
     I              EDMKDT                          WVMKDT
     I              EDBFTM                          WVBFTM
     I              EDCEVN                          WVCEVN
     I              EDCFVN                          WVCFVN
      *
     I@A4CPX7
      * A/R Header OA             Retrieval index
      * Renamed input format fields
     I              A4AIC3                          WWAIC3
     I              A4CONB                          WWCONB
     I              A4CEST                          WWCEST
     I              A4G4CD                          WWG4CD
     I              A4HXDT                          WWHXDT
     I              A4YXNX                          WWYXNX
     I              A4UTSX                          WWUTSX
      *
     I@A4CPLW
      * A/R Header OA             Update Index for Purge
      * Renamed input format fields
     I              A4AIC3                          WXAIC3
     I              A4CONB                          WXCONB
     I              A4CEST                          WXCEST
     I              A4G4CD                          WXG4CD
     I              A4HXDT                          WXHXDT
     I              A4YXNX                          WXYXNX
     I              A4UTSX                          WXUTSX
      *
     I@A4CPX6
      * A/R Header OA             Update index
      * Renamed input format fields
     I              A4AIC3                          WYAIC3
     I              A4CONB                          WYCONB
     I              A4CEST                          WYCEST
     I              A4G4CD                          WYG4CD
     I              A4HXDT                          WYHXDT
     I              A4YXNX                          WYYXNX
     I              A4UTSX                          WYUTSX
      *
     I@BDCPC4
      * A/R Header                Trans Dt(D),Sel $00 Tran
      * Renamed input format fields
     I              BDAIC3                          TAAIC3
     I              BDCONB                          TACONB
     I              BDCEST                          TACEST
     I              BDUHCD                          TAUHCD
     I              BDBSVA                          TABSVA
     I              BDAIVA                          TAAIVA
     I              BDAOVA                          TAAOVA
     I              BDBGVA                          TABGVA
     I              BDAJST                          TAAJST
     I              BDE3ST                          TAE3ST
     I              BDG4CD                          TAG4CD
     I              BDCKNB                          TACKNB
     I              BDCAC7                          TACAC7
     I              BDBKC7                          TABKC7
     I              BDBCCD                          TABCCD
     I              BDR4CD                          TAR4CD
     I              BDB4DT                          TAB4DT
     I              BDATDT                          TAATDT
     I              BDH0DT                          TAH0DT
     I              BDH3DT                          TAH3DT
     I              BDH4DT                          TAH4DT
     I              BDH5DT                          TAH5DT
     I              BDANC7                          TAANC7
     I              BDCPTX                          TACPTX
     I              BDBSDY                          TABSDY
     I              BDUVST                          TAUVST
     I              BDUWST                          TAUWST
     I              BDUXST                          TAUXST
     I              BDAATM                          TAAATM
     I              BDAYNA                          TAAYNA
     I              BDA0NA                          TAA0NA
     I              BDAXDT                          TAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQARBD1    E DSARBDCPRG
      * UPD : A/R Header                Update Index for Purging
      * Renamed input format fields
     I              BDAIC3                          WBAIC3
     I              BDCONB                          WBCONB
     I              BDCEST                          WBCEST
     I              BDUHCD                          WBUHCD
     I              BDBSVA                          WBBSVA
     I              BDAIVA                          WBAIVA
     I              BDAOVA                          WBAOVA
     I              BDBGVA                          WBBGVA
     I              BDAJST                          WBAJST
     I              BDE3ST                          WBE3ST
     I              BDG4CD                          WBG4CD
     I              BDCKNB                          WBCKNB
     I              BDCAC7                          WBCAC7
     I              BDBKC7                          WBBKC7
     I              BDBCCD                          WBBCCD
     I              BDR4CD                          WBR4CD
     I              BDB4DT                          WBB4DT
     I              BDATDT                          WBATDT
     I              BDH0DT                          WBH0DT
     I              BDH3DT                          WBH3DT
     I              BDH4DT                          WBH4DT
     I              BDH5DT                          WBH5DT
     I              BDANC7                          WBANC7
     I              BDCPTX                          WBCPTX
     I              BDBSDY                          WBBSDY
     I              BDUVST                          WBUVST
     I              BDUWST                          WBUWST
     I              BDUXST                          WBUXST
     I              BDAATM                          WBAATM
     I              BDAYNA                          WBAYNA
     I              BDA0NA                          WBA0NA
     I              BDAXDT                          WBAXDT
      *
     IQARBD2    E DSARBDCPL0
      * UPD : A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WCAIC3
     I              BDCONB                          WCCONB
     I              BDCEST                          WCCEST
     I              BDUHCD                          WCUHCD
     I              BDBSVA                          WCBSVA
     I              BDAIVA                          WCAIVA
     I              BDAOVA                          WCAOVA
     I              BDBGVA                          WCBGVA
     I              BDAJST                          WCAJST
     I              BDE3ST                          WCE3ST
     I              BDG4CD                          WCG4CD
     I              BDCKNB                          WCCKNB
     I              BDCAC7                          WCCAC7
     I              BDBKC7                          WCBKC7
     I              BDBCCD                          WCBCCD
     I              BDR4CD                          WCR4CD
     I              BDB4DT                          WCB4DT
     I              BDATDT                          WCATDT
     I              BDH0DT                          WCH0DT
     I              BDH3DT                          WCH3DT
     I              BDH4DT                          WCH4DT
     I              BDH5DT                          WCH5DT
     I              BDANC7                          WCANC7
     I              BDCPTX                          WCCPTX
     I              BDBSDY                          WCBSDY
     I              BDUVST                          WCUVST
     I              BDUWST                          WCUWST
     I              BDUXST                          WCUXST
     I              BDAATM                          WCAATM
     I              BDAYNA                          WCAYNA
     I              BDA0NA                          WCA0NA
     I              BDAXDT                          WCAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQARBE1    E DSARBECPRG
      * UPD : A/R Detail                Update index for purge
      * Renamed input format fields
     I              BFAIC3                          WEAIC3
     I              BFCONB                          WECONB
     I              BFCEST                          WECEST
     I              BFDXNB                          WEDXNB
     I              BFUHCD                          WEUHCD
     I              BFBSVA                          WEBSVA
     I              BFCPTX                          WECPTX
     I              BFNGNA                          WENGNA
     I              BFB4DT                          WEB4DT
     I              BFDVDT                          WEDVDT
     I              BFYXNX                          WEYXNX
     I              BFHYDT                          WEHYDT
     I              BFG4CD                          WEG4CD
     I              BFCKNB                          WECKNB
     I              BFA5ST                          WEA5ST
     I              BFAJST                          WEAJST
     I              BFB1VN                          WEB1VN
     I              BFEAZT                          WEEAZT
     I              BFC1NY                          WEC1NY
     I              BFIZTX                          WEIZTX
     I              BFETSX                          WEETSX
     I              BFW3SX                          WEW3SX
     I              BFW4SX                          WEW4SX
     I              BFW5SX                          WEW5SX
     I              BFW6SX                          WEW6SX
     I              BFW7SX                          WEW7SX
     I              BFW8SX                          WEW8SX
     I              BFQHDT                          WEQHDT
     I              BFQIDT                          WEQIDT
     I              BFQJDT                          WEQJDT
     I              BFQKDT                          WEQKDT
     I              BFQLDT                          WEQLDT
     I              BFGLVL                          WEGLVL
     I              BFGMVL                          WEGMVL
     I              BFGNVL                          WEGNVL
     I              BFGOVL                          WEGOVL
     I              BFGPVL                          WEGPVL
     I              BFUVST                          WEUVST
     I              BFUWST                          WEUWST
     I              BFUXST                          WEUXST
     I              BFAATM                          WEAATM
     I              BFAYNA                          WEAYNA
     I              BFA0NA                          WEA0NA
     I              BFAXDT                          WEAXDT
      *
     IQARBE2    E DSARBECPL0
      * UPD : A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WFAIC3
     I              BFCONB                          WFCONB
     I              BFCEST                          WFCEST
     I              BFDXNB                          WFDXNB
     I              BFUHCD                          WFUHCD
     I              BFBSVA                          WFBSVA
     I              BFCPTX                          WFCPTX
     I              BFNGNA                          WFNGNA
     I              BFB4DT                          WFB4DT
     I              BFDVDT                          WFDVDT
     I              BFYXNX                          WFYXNX
     I              BFHYDT                          WFHYDT
     I              BFG4CD                          WFG4CD
     I              BFCKNB                          WFCKNB
     I              BFA5ST                          WFA5ST
     I              BFAJST                          WFAJST
     I              BFB1VN                          WFB1VN
     I              BFEAZT                          WFEAZT
     I              BFC1NY                          WFC1NY
     I              BFIZTX                          WFIZTX
     I              BFETSX                          WFETSX
     I              BFW3SX                          WFW3SX
     I              BFW4SX                          WFW4SX
     I              BFW5SX                          WFW5SX
     I              BFW6SX                          WFW6SX
     I              BFW7SX                          WFW7SX
     I              BFW8SX                          WFW8SX
     I              BFQHDT                          WFQHDT
     I              BFQIDT                          WFQIDT
     I              BFQJDT                          WFQJDT
     I              BFQKDT                          WFQKDT
     I              BFQLDT                          WFQLDT
     I              BFGLVL                          WFGLVL
     I              BFGMVL                          WFGMVL
     I              BFGNVL                          WFGNVL
     I              BFGOVL                          WFGOVL
     I              BFGPVL                          WFGPVL
     I              BFUVST                          WFUVST
     I              BFUWST                          WFUWST
     I              BFUXST                          WFUXST
     I              BFAATM                          WFAATM
     I              BFAYNA                          WFAYNA
     I              BFA0NA                          WFA0NA
     I              BFAXDT                          WFAXDT
      *
     IQPDNH1    E DSPDNHCPRG
      * UPD : A/R OA/CM Transactions    Update Index for Purge
      * Renamed input format fields
     I              NHAIC3                          WHAIC3
     I              NHCONB                          WHCONB
     I              NHCEST                          WHCEST
     I              NHJZNX                          WHJZNX
     I              NHHNSX                          WHHNSX
     I              NHBSVA                          WHBSVA
     I              NHVSST                          WHVSST
     I              NHMJDT                          WHMJDT
     I              NHBETM                          WHBETM
     I              NHCCVN                          WHCCVN
     I              NHCDVN                          WHCDVN
     I              NHMKDT                          WHMKDT
     I              NHBFTM                          WHBFTM
     I              NHCEVN                          WHCEVN
     I              NHCFVN                          WHCFVN
      *
     IQPDNH2    E DSPDNHCPL0
      * UPD : A/R OA/CM Transactions    Update index
      * Renamed input format fields
     I              NHAIC3                          WIAIC3
     I              NHCONB                          WICONB
     I              NHCEST                          WICEST
     I              NHJZNX                          WIJZNX
     I              NHHNSX                          WIHNSX
     I              NHBSVA                          WIBSVA
     I              NHVSST                          WIVSST
     I              NHMJDT                          WIMJDT
     I              NHBETM                          WIBETM
     I              NHCCVN                          WICCVN
     I              NHCDVN                          WICDVN
     I              NHMKDT                          WIMKDT
     I              NHBFTM                          WIBFTM
     I              NHCEVN                          WICEVN
     I              NHCFVN                          WICFVN
      *
     IQPOBU1    E DSPOBUREL6
      * UPD : A/R Header Notes OLD      Update Index for Purge
      * Renamed input format fields
     I              BUAIC3                          WKAIC3
     I              BUCONB                          WKCONB
     I              BUCEST                          WKCEST
     I              BUOTDT                          WKOTDT
     I              BUDXNB                          WKDXNB
     I              BUL5SX                          WKL5SX
     I              BUOUDT                          WKOUDT
     I              BUA3T1                          WKA3T1
     I              BUA4T1                          WKA4T1
     I              BUA5T1                          WKA5T1
     I              BUL6SX                          WKL6SX
     I              BUL7SX                          WKL7SX
     I              BUL8SX                          WKL8SX
     I              BUBKC7                          WKBKC7
      *
     IQPOBU2    E DSPOBUREL0
      * UPD : A/R Header Notes OLD      Update index
      * Renamed input format fields
     I              BUAIC3                          WLAIC3
     I              BUCONB                          WLCONB
     I              BUCEST                          WLCEST
     I              BUOTDT                          WLOTDT
     I              BUDXNB                          WLDXNB
     I              BUL5SX                          WLL5SX
     I              BUOUDT                          WLOUDT
     I              BUA3T1                          WLA3T1
     I              BUA4T1                          WLA4T1
     I              BUA5T1                          WLA5T1
     I              BUL6SX                          WLL6SX
     I              BUL7SX                          WLL7SX
     I              BUL8SX                          WLL8SX
     I              BUBKC7                          WLBKC7
      *
     IQPMEF1    E DSPMEFCPL3
      * UPD : A/R Header Note Detail    Update Index -Purge
      * Renamed input format fields
     I              EFAIC3                          WRAIC3
     I              EFCONB                          WRCONB
     I              EFCEST                          WRCEST
     I              EFNBNY                          WRNBNY
     I              EFNCNY                          WRNCNY
     I              EFSWNA                          WRSWNA
     I              EFVSST                          WRVSST
     I              EFMJDT                          WRMJDT
     I              EFBETM                          WRBETM
     I              EFCCVN                          WRCCVN
     I              EFCDVN                          WRCDVN
     I              EFMKDT                          WRMKDT
     I              EFBFTM                          WRBFTM
     I              EFCEVN                          WRCEVN
     I              EFCFVN                          WRCFVN
      *
     IQPMEF2    E DSPMEFCPL0
      * UPD : A/R Header Note Detail    Update index
      * Renamed input format fields
     I              EFAIC3                          WSAIC3
     I              EFCONB                          WSCONB
     I              EFCEST                          WSCEST
     I              EFNBNY                          WSNBNY
     I              EFNCNY                          WSNCNY
     I              EFSWNA                          WSSWNA
     I              EFVSST                          WSVSST
     I              EFMJDT                          WSMJDT
     I              EFBETM                          WSBETM
     I              EFCCVN                          WSCCVN
     I              EFCDVN                          WSCDVN
     I              EFMKDT                          WSMKDT
     I              EFBFTM                          WSBFTM
     I              EFCEVN                          WSCEVN
     I              EFCFVN                          WSCFVN
      *
     IQPMED1    E DSPMEDCPL6
      * UPD : A/R Header Note Header    Update Index -Purge
      * Renamed input format fields
     I              EDAIC3                          WTAIC3
     I              EDCONB                          WTCONB
     I              EDCEST                          WTCEST
     I              EDNBNY                          WTNBNY
     I              EDSLDT                          WTSLDT
     I              EDDETM                          WTDETM
     I              EDENVN                          WTENVN
     I              EDSMDT                          WTSMDT
     I              EDFUPS                          WTFUPS
     I              EDSNDT                          WTSNDT
     I              EDDFTM                          WTDFTM
     I              EDEMVN                          WTEMVN
     I              EDANC7                          WTANC7
     I              EDR4CD                          WTR4CD
     I              EDVSST                          WTVSST
     I              EDMJDT                          WTMJDT
     I              EDBETM                          WTBETM
     I              EDCCVN                          WTCCVN
     I              EDCDVN                          WTCDVN
     I              EDMKDT                          WTMKDT
     I              EDBFTM                          WTBFTM
     I              EDCEVN                          WTCEVN
     I              EDCFVN                          WTCFVN
      *
     IQPMED2    E DSPMEDCPL0
      * UPD : A/R Header Note Header    Update index
      * Renamed input format fields
     I              EDAIC3                          WVAIC3
     I              EDCONB                          WVCONB
     I              EDCEST                          WVCEST
     I              EDNBNY                          WVNBNY
     I              EDSLDT                          WVSLDT
     I              EDDETM                          WVDETM
     I              EDENVN                          WVENVN
     I              EDSMDT                          WVSMDT
     I              EDFUPS                          WVFUPS
     I              EDSNDT                          WVSNDT
     I              EDDFTM                          WVDFTM
     I              EDEMVN                          WVEMVN
     I              EDANC7                          WVANC7
     I              EDR4CD                          WVR4CD
     I              EDVSST                          WVVSST
     I              EDMJDT                          WVMJDT
     I              EDBETM                          WVBETM
     I              EDCCVN                          WVCCVN
     I              EDCDVN                          WVCDVN
     I              EDMKDT                          WVMKDT
     I              EDBFTM                          WVBFTM
     I              EDCEVN                          WVCEVN
     I              EDCFVN                          WVCFVN
      *
     IQPPA41    E DSPPA4CPL3
      * UPD : A/R Header OA             Update Index for Purge
      * Renamed input format fields
     I              A4AIC3                          WXAIC3
     I              A4CONB                          WXCONB
     I              A4CEST                          WXCEST
     I              A4G4CD                          WXG4CD
     I              A4HXDT                          WXHXDT
     I              A4YXNX                          WXYXNX
     I              A4UTSX                          WXUTSX
      *
     IQPPA42    E DSPPA4CPL0
      * UPD : A/R Header OA             Update index
      * Renamed input format fields
     I              A4AIC3                          WYAIC3
     I              A4CONB                          WYCONB
     I              A4CEST                          WYCEST
     I              A4G4CD                          WYG4CD
     I              A4HXDT                          WYHXDT
     I              A4YXNX                          WYYXNX
     I              A4UTSX                          WYUTSX
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: A/R Header
      * I :  Paid in Full Date
     I                                    P   1   40P1H4DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1H4DT    PARM           WP0001  70       Paid in Full Da
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Read all rcds for Prg XF
      * ** E001078   11/02/2010
      * ** Change: Don't replace change or create dates with purge date
      * Read all rcds for Purge - A/R Header  * 
     C                     EXSR SARVGN
      * Purge invoices with $00 and 000000 date paid in full
      *   if Trans Date le purge date
      * Read all rcds Purge-$00 - A/R Header  * 
     C                     EXSR SVRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Read all rcds for Purge - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAH4DT           Paid in Full Da
      * Setup key
     C                     Z-ADDP1H4DT    WAH4DT           Paid in Full Da
      * Establish starting position
     C           KPSSA     SETLL@BDCPDG                    *
     C                     READ @BDCPDG                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT A/R Header for purge - A/R Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWACONB    WL0002           Invoice Number
     C                     MOVELWACEST    WL0003    P      Invoice Suffix
     C                     MOVELWAUHCD    WL0004    P      Adjustment Type
     C                     Z-ADDWABSVA    WL0005           Transaction Amo
     C                     Z-ADDWAAIVA    WL0006           Adjustment Amou
     C                     Z-ADDWAAOVA    WL0007           Amount Paid
     C                     Z-ADDWABGVA    WL0008           Remaining Balan
     C                     MOVELWAAJST    WL0009    P      A/R Processing
     C                     MOVELWAE3ST    WL0010    P      Purge Status
     C                     MOVELWAG4CD    WL0011    P      Bank Code
     C                     Z-ADDWACKNB    WL0012           G/L Document Nu
     C                     Z-ADDWACAC7    WL0013           Order Number Re
     C                     Z-ADDWABKC7    WL0014           Ship To Custome
     C                     MOVELWABCCD    WL0015    P      Salesperson Cod
     C                     MOVELWAR4CD    WL0016    P      Sales Route Cod
     C                     Z-ADDWAB4DT    WL0017           Transaction Dat
     C                     Z-ADDWAATDT    WL0018           Due Date
     C                     Z-ADDWAH0DT    WL0019           Last Payment Da
     C                     Z-ADDWAH3DT    WL0020           Unused Date Cod
     C                     Z-ADDWAH4DT    WL0021           Paid in Full Da
     C                     Z-ADDWAH5DT    WL0022           Last G/L Post D
     C                     Z-ADDWAANC7    WL0023           A/R Customer Nu
     C                     MOVELWACPTX    WL0024    P      A/R Check Numbe
     C                     Z-ADDWABSDY    WL0025           Days to Pay
     C                     MOVELWAUVST    WL0026    P      EDI Status 1
     C                     MOVELWAUWST    WL0027    P      EDI Status 2
     C                     MOVELWAUXST    WL0028    P      EDI Status 3
     C                     Z-ADDWAAATM    WL0029           Job Time
     C                     MOVELWAAYNA    WL0030    P      User Id
     C                     MOVELWAA0NA    WL0031    P      Job Name
     C                     Z-ADDWAAXDT    WL0032           Job Date
     C                     EXSR SBCRRC
      * DLT A/R Header for Purge - A/R Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0033           Company Number
     C                     Z-ADDWACONB    WL0034           Invoice Number
     C                     MOVELWACEST    WL0035    P      Invoice Suffix
     C                     EXSR SCDLRC
     C                     READ @BDCPDG                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * CRT A/R Header for purge - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BDCPDH
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBCONB           Invoice Number
     C                     MOVELWL0003    WBCEST           Invoice Suffix
     C                     MOVELWL0004    WBUHCD           Adjustment Type
     C                     Z-ADDWL0005    WBBSVA           Transaction Amo
     C                     Z-ADDWL0006    WBAIVA           Adjustment Amou
     C                     Z-ADDWL0007    WBAOVA           Amount Paid
     C                     Z-ADDWL0008    WBBGVA           Remaining Balan
     C                     MOVELWL0009    WBAJST           A/R Processing
     C                     MOVELWL0010    WBE3ST           Purge Status
     C                     MOVELWL0011    WBG4CD           Bank Code
     C                     Z-ADDWL0012    WBCKNB           G/L Document Nu
     C                     Z-ADDWL0013    WBCAC7           Order Number Re
     C                     Z-ADDWL0014    WBBKC7           Ship To Custome
     C                     MOVELWL0015    WBBCCD           Salesperson Cod
     C                     MOVELWL0016    WBR4CD           Sales Route Cod
     C                     Z-ADDWL0017    WBB4DT           Transaction Dat
     C                     Z-ADDWL0018    WBATDT           Due Date
     C                     Z-ADDWL0019    WBH0DT           Last Payment Da
     C                     Z-ADDWL0020    WBH3DT           Unused Date Cod
     C                     Z-ADDWL0021    WBH4DT           Paid in Full Da
     C                     Z-ADDWL0022    WBH5DT           Last G/L Post D
     C                     Z-ADDWL0023    WBANC7           A/R Customer Nu
     C                     MOVELWL0024    WBCPTX           A/R Check Numbe
     C                     Z-ADDWL0025    WBBSDY           Days to Pay
     C                     MOVELWL0026    WBUVST           EDI Status 1
     C                     MOVELWL0027    WBUWST           EDI Status 2
     C                     MOVELWL0028    WBUXST           EDI Status 3
     C                     Z-ADDWL0029    WBAATM           Job Time
     C                     MOVELWL0030    WBAYNA           User Id
     C                     MOVELWL0031    WBA0NA           Job Name
     C                     Z-ADDWL0032    WBAXDT           Job Date
      *
     C           KLCRSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBCONB           Invoice Number
     C                     KFLD           WBCEST           Invoice Suffix
      * Check for duplicate primary key
     C           KLCRSB    SETLL@BDCPDH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0175' W0RTN   7
      * Send message 'A/R Header             EX'
     C                     MOVEL'USR0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@BDCPDH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * DLT A/R Header for Purge - A/R Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BDCPFG
     C                     Z-ADDWL0033    WCAIC3           Company Number
     C                     Z-ADDWL0034    WCCONB           Invoice Number
     C                     MOVELWL0035    WCCEST           Invoice Suffix
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCCONB           Invoice Number
     C                     KFLD           WCCEST           Invoice Suffix
     C           KLDLSC    CHAIN@BDCPFG              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBDCPL0'MDACP
     C                     MOVEL'@BDCPFG' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BDCPFG                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
      * Read all rcds for purge - A/R Detail  * 
     C                     EXSR SDRVGN
      * Read all rcds for Purge - A/R OA/CM Transactions  * 
     C                     EXSR SGRVGN
      * ** 08/10/2007 LJB FP1009
      * RTV A/R Hdr Nts for Purge - A/R Header Notes OLD  * 
     C                     EXSR SJRVGN
      * RTV A/R Nts Hdr PURGE RT - A/R Header Note Header  * 
     C                     EXSR SMRVGN
      * RTV A/R Hdr OA for Purge - A/R Header OA  * 
     C                     EXSR SSRVGN
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Read all rcds for purge - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDCONB    WQSD02           Invoice Number
     C           *LIKE     DEFN WDCEST    WQSD03           Invoice Suffix
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Invoice Number
     C                     KFLD           WQSD03           Invoice Suffix
      * Setup key
     C                     Z-ADDWCAIC3    WQSD01           Company Number
     C                     Z-ADDWCCONB    WQSD02           Invoice Number
     C                     MOVELWCCEST    WQSD03           Invoice Suffix
      * Establish starting position
     C           KRSSD     SETLL@BFCPFO                    *
     C           KRSSD     READE@BFCPFO                  90*
      * Data record not found
     C   90                MOVEL'USR0178' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT A/R Detail for Purge - A/R Detail  * 
     C                     EXSR SECRRC
      * DLT A/R Detail         DL - A/R Detail  * 
     C                     EXSR SFDLRC
     C           KRSSD     READE@BFCPFO                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * CRT A/R Detail for Purge - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BECPDI
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDCONB    WECONB           Invoice Number
     C                     MOVELWDCEST    WECEST           Invoice Suffix
     C                     Z-ADDWDDXNB    WEDXNB           Sequence Number
     C                     MOVELWDUHCD    WEUHCD           Adjustment Type
     C                     Z-ADDWDBSVA    WEBSVA           Transaction Amo
     C                     MOVELWDCPTX    WECPTX           A/R Check Numbe
     C                     MOVELWDNGNA    WENGNA           Explanation
     C                     Z-ADDWDB4DT    WEB4DT           Transaction Dat
     C                     Z-ADDWDDVDT    WEDVDT           Payment/Deposit
     C                     Z-ADDWDYXNX    WEYXNX           Deposit Time
     C                     Z-ADDWDHYDT    WEHYDT           G/L Post Date
     C                     MOVELWDG4CD    WEG4CD           Bank Code
     C                     Z-ADDWDCKNB    WECKNB           G/L Document Nu
     C                     MOVELWDA5ST    WEA5ST           Cash/Adj
     C                     MOVELWDAJST    WEAJST           A/R Processing
     C                     MOVELWDB1VN    WEB1VN           Originating Pro
     C                     MOVELWDEAZT    WEEAZT           Effect on Accou
     C                     Z-ADDWDC1NY    WEC1NY           G/L Posting Com
     C                     MOVELWDIZTX    WEIZTX           G/L ID Code JDE
     C                     MOVELWDETSX    WEETSX           Post Adjustment
     C                     MOVELWDW3SX    WEW3SX           A/R TF Exempt C
     C                     MOVELWDW4SX    WEW4SX           A/R Dtl UnUsed
     C                     MOVELWDW5SX    WEW5SX           A/R Dtl UnUsed
     C                     MOVELWDW6SX    WEW6SX           A/R Dtl UnUsed
     C                     MOVELWDW7SX    WEW7SX           A/R Dtl UnUsed
     C                     MOVELWDW8SX    WEW8SX           A/R Dtl UnUsed
     C                     Z-ADDWDQHDT    WEQHDT           TFS Adj Week-En
     C                     Z-ADDWDQIDT    WEQIDT           A/R Dtl UnUsed
     C                     Z-ADDWDQJDT    WEQJDT           A/R Dtl UnUsed
     C                     Z-ADDWDQKDT    WEQKDT           A/R Dtl UnUsed
     C                     Z-ADDWDQLDT    WEQLDT           A/R Dtl UnUsed
     C                     Z-ADDWDGLVL    WEGLVL           G/L Sub-Ledger
     C                     Z-ADDWDGMVL    WEGMVL           A/R Dtl UnUsed
     C                     Z-ADDWDGNVL    WEGNVL           A/R Dtl UnUsed
     C                     Z-ADDWDGOVL    WEGOVL           A/R Dtl UnUsed
     C                     Z-ADDWDGPVL    WEGPVL           A/R Dtl UnUsed
     C                     MOVELWDUVST    WEUVST           EDI Status 1
     C                     MOVELWDUWST    WEUWST           EDI Status 2
     C                     MOVELWDUXST    WEUXST           EDI Status 3
     C                     Z-ADDWDAATM    WEAATM           Job Time
     C                     MOVELWDAYNA    WEAYNA           User Id
     C                     MOVELWDA0NA    WEA0NA           Job Name
     C                     Z-ADDWDAXDT    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * ** Don't replace change date with purge date   E001078
     C           KLCRSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WECONB           Invoice Number
     C                     KFLD           WECEST           Invoice Suffix
     C                     KFLD           WEDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSE    SETLL@BECPDI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0179' W0RTN   7
      * Send message 'A/R Detail             EX'
     C                     MOVEL'USR0179' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@BECPDI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * DLT A/R Detail         DL - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BFCPFN
     C                     Z-ADDWDAIC3    WFAIC3           Company Number
     C                     Z-ADDWDCONB    WFCONB           Invoice Number
     C                     MOVELWDCEST    WFCEST           Invoice Suffix
     C                     Z-ADDWDDXNB    WFDXNB           Sequence Number
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFCONB           Invoice Number
     C                     KFLD           WFCEST           Invoice Suffix
     C                     KFLD           WFDXNB           Sequence Number
     C           KLDLSF    CHAIN@BFCPFN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBECPL0'MDACP
     C                     MOVEL'@BFCPFN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BFCPFN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Read all rcds for Purge - A/R OA/CM Transactions  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGCONB    WQSG02           Invoice Number
     C           *LIKE     DEFN WGCEST    WQSG03           Invoice Suffix
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Invoice Number
     C                     KFLD           WQSG03           Invoice Suffix
      * Setup key
     C                     Z-ADDWCAIC3    WQSG01           Company Number
     C                     Z-ADDWCCONB    WQSG02           Invoice Number
     C                     MOVELWCCEST    WQSG03           Invoice Suffix
      * Establish starting position
     C           KRSSG     SETLL@NHCPBH                    *
     C           KRSSG     READE@NHCPBH                  90*
      * Data record not found
     C   90                MOVEL'USR2900' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT A/R OA/CM for Purge - A/R OA/CM Transactions  * 
     C                     EXSR SHCRRC
      * DLT A/R OA/CM Trans    DL - A/R OA/CM Transactions  * 
     C                     EXSR SIDLRC
     C           KRSSG     READE@NHCPBH                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT A/R OA/CM for Purge - A/R OA/CM Transactions  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NHCPDJ
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGCONB    WHCONB           Invoice Number
     C                     MOVELWGCEST    WHCEST           Invoice Suffix
     C                     Z-ADDWGJZNX    WHJZNX           Reference Numbe
     C                     MOVELWGHNSX    WHHNSX           Reference Suffi
     C                     Z-ADDWGBSVA    WHBSVA           Transaction Amo
     C                     MOVELWGVSST    WHVSST           Record Status
     C                     Z-ADDWGMJDT    WHMJDT           Create Date
     C                     Z-ADDWGBETM    WHBETM           Create Time
     C                     MOVELWGCCVN    WHCCVN           Create User
     C                     MOVELWGCDVN    WHCDVN           Create Program
     C                     Z-ADDWGMKDT    WHMKDT           Change Date
     C                     Z-ADDWGBFTM    WHBFTM           Change Time
     C                     MOVELWGCEVN    WHCEVN           Change User
     C                     MOVELWGCFVN    WHCFVN           Change Program
      *
     C           KLCRSH    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHCONB           Invoice Number
     C                     KFLD           WHCEST           Invoice Suffix
     C                     KFLD           WHJZNX           Reference Numbe
     C                     KFLD           WHHNSX           Reference Suffi
      * Check for duplicate primary key
     C           KLCRSH    SETLL@NHCPDJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2901' W0RTN   7
      * Send message 'A/R OA/CM Transactions EX'
     C                     MOVEL'USR2901' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@NHCPDJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * DLT A/R OA/CM Trans    DL - A/R OA/CM Transactions  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @NHCPBG
     C                     Z-ADDWGAIC3    WIAIC3           Company Number
     C                     Z-ADDWGCONB    WICONB           Invoice Number
     C                     MOVELWGCEST    WICEST           Invoice Suffix
     C                     Z-ADDWGJZNX    WIJZNX           Reference Numbe
     C                     MOVELWGHNSX    WIHNSX           Reference Suffi
      *
     C           KLDLSI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WICONB           Invoice Number
     C                     KFLD           WICEST           Invoice Suffix
     C                     KFLD           WIJZNX           Reference Numbe
     C                     KFLD           WIHNSX           Reference Suffi
     C           KLDLSI    CHAIN@NHCPBG              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDNHCPL0'MDACP
     C                     MOVEL'@NHCPBG' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@NHCPBG                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV A/R Hdr Nts for Purge - A/R Header Notes OLD  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WJCONB    WQSJ02           Invoice Number
     C           *LIKE     DEFN WJCEST    WQSJ03           Invoice Suffix
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Invoice Number
     C                     KFLD           WQSJ03           Invoice Suffix
      * Setup key
     C                     Z-ADDWCAIC3    WQSJ01           Company Number
     C                     Z-ADDWCCONB    WQSJ02           Invoice Number
     C                     MOVELWCCEST    WQSJ03           Invoice Suffix
      * Establish starting position
     C           KRSSJ     SETLL@BURELN                    *
     C           KRSSJ     READE@BURELN                  90*
      * Data record not found
     C   90                MOVEL'USR3122' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT A/R Hdr Nts for Purge - A/R Header Notes  * 
     C                     EXSR SKCRRC
      * Del A/R Header Notes  DO - A/R Header Notes  * 
     C                     EXSR SLDLRC
     C           KRSSJ     READE@BURELN                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT A/R Hdr Nts for Purge - A/R Header Notes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BURELV
     C                     Z-ADDWJAIC3    WKAIC3           Company Number
     C                     Z-ADDWJCONB    WKCONB           Invoice Number
     C                     MOVELWJCEST    WKCEST           Invoice Suffix
     C                     Z-ADDWJOTDT    WKOTDT           Note Date
     C                     Z-ADDWJDXNB    WKDXNB           Sequence Number
     C                     MOVELWJL5SX    WKL5SX           Note Type
     C                     Z-ADDWJOUDT    WKOUDT           Follow-up Date
     C                     MOVELWJA3T1    WKA3T1           Initials
     C                     MOVELWJA4T1    WKA4T1           Note Line 1
     C                     MOVELWJA5T1    WKA5T1           Note Line 2
     C                     MOVELWJL6SX    WKL6SX           Remaining Balan
     C                     MOVELWJL7SX    WKL7SX           Notes Unused St
     C                     MOVELWJL8SX    WKL8SX           Notes Unused St
     C                     Z-ADDWJBKC7    WKBKC7           Ship To Custome
      *
     C           KLCRSK    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKCONB           Invoice Number
     C                     KFLD           WKCEST           Invoice Suffix
     C                     KFLD           WKOTDT           Note Date
     C                     KFLD           WKDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSK    SETLL@BURELV                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3123' W0RTN   7
      * Send message 'A/R Header Notes OLD   EX'
     C                     MOVEL'USR3123' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@BURELV                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * Del A/R Header Notes  DO - A/R Header Notes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BURELM
     C                     Z-ADDWJAIC3    WLAIC3           Company Number
     C                     Z-ADDWJCONB    WLCONB           Invoice Number
     C                     MOVELWJCEST    WLCEST           Invoice Suffix
     C                     Z-ADDWJOTDT    WLOTDT           Note Date
     C                     Z-ADDWJDXNB    WLDXNB           Sequence Number
      *
     C           KLDLSL    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLCONB           Invoice Number
     C                     KFLD           WLCEST           Invoice Suffix
     C                     KFLD           WLOTDT           Note Date
     C                     KFLD           WLDXNB           Sequence Number
     C           KLDLSL    CHAIN@BURELM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POBUREL0'MDACP
     C                     MOVEL'@BURELM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BURELM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV A/R Nts Hdr PURGE RT - A/R Header Note Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WMCONB    WQSM02           Invoice Number
     C           *LIKE     DEFN WMCEST    WQSM03           Invoice Suffix
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Invoice Number
     C                     KFLD           WQSM03           Invoice Suffix
      * Setup key
     C                     Z-ADDWCAIC3    WQSM01           Company Number
     C                     Z-ADDWCCONB    WQSM02           Invoice Number
     C                     MOVELWCCEST    WQSM03           Invoice Suffix
      * Establish starting position
     C           KRSSM     SETLL@EDCPVF                    *
     C           KRSSM     READE@EDCPVF                  90*
      * Data record not found
     C   90                MOVEL'USR4014' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV A/R Nts Dtl Purge RT - A/R Header Note Detail  * 
     C                     EXSR SNRVGN
      * Crt Note Header Purge CR - A/R Header Note Header  * PMEDCPL6
     C                     EXSR SQCRRC
      * Del Note Header       DL - A/R Header Note Header  * 
     C                     EXSR SRDLRC
     C           KRSSM     READE@EDCPVF                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV A/R Nts Dtl Purge RT - A/R Header Note Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WOCONB    WQSN02           Invoice Number
     C           *LIKE     DEFN WOCEST    WQSN03           Invoice Suffix
     C           *LIKE     DEFN WONBNY    WQSN04           ARHN Note Numbe
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Invoice Number
     C                     KFLD           WQSN03           Invoice Suffix
     C                     KFLD           WQSN04           ARHN Note Numbe
      * Setup key
     C                     Z-ADDWMAIC3    WQSN01           Company Number
     C                     Z-ADDWMCONB    WQSN02           Invoice Number
     C                     MOVELWMCEST    WQSN03           Invoice Suffix
     C                     Z-ADDWMNBNY    WQSN04           ARHN Note Numbe
      * Establish starting position
     C           KRSSN     SETLL@EFCPVZ                    *
     C           KRSSN     READE@EFCPVZ                  90*
      * Data record not found
     C   90                MOVEL'USR4020' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Note Detail Purge CR - A/R Header Note Detail  * PMEFCPL3
     C                     EXSR SOCRRC
      * Del Note Detail       DL - A/R Header Note Detail  * PMEFCPL0
     C                     EXSR SPDLRC
     C           KRSSN     READE@EFCPVZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt Note Detail Purge CR - A/R Header Note Detail  * PMEFCPL3
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EFCPV8
     C                     Z-ADDWOAIC3    WRAIC3           Company Number
     C                     Z-ADDWOCONB    WRCONB           Invoice Number
     C                     MOVELWOCEST    WRCEST           Invoice Suffix
     C                     Z-ADDWONBNY    WRNBNY           ARHN Note Numbe
     C                     Z-ADDWONCNY    WRNCNY           ARHN Note Line
     C                     MOVELWOSWNA    WRSWNA           ARHN Detail Not
     C                     MOVELWOVSST    WRVSST           Record Status
     C                     Z-ADDWOMJDT    WRMJDT           Create Date
     C                     Z-ADDWOBETM    WRBETM           Create Time
     C                     MOVELWOCCVN    WRCCVN           Create User
     C                     MOVELWOCDVN    WRCDVN           Create Program
     C                     Z-ADDWOMKDT    WRMKDT           Change Date
     C                     Z-ADDWOBFTM    WRBFTM           Change Time
     C                     MOVELWOCEVN    WRCEVN           Change User
     C                     MOVELWOCFVN    WRCFVN           Change Program
      *
     C           KLCRSO    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRCONB           Invoice Number
     C                     KFLD           WRCEST           Invoice Suffix
     C                     KFLD           WRNBNY           ARHN Note Numbe
     C                     KFLD           WRNCNY           ARHN Note Line
      * Check for duplicate primary key
     C           KLCRSO    SETLL@EFCPV8                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4021' W0RTN   7
      * Send message 'A/R Header Note1899443'
     C                     MOVEL'USR4021' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@EFCPV8                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPDLRC    BEGSR
      *================================================================
      * Del Note Detail       DL - A/R Header Note Detail  * PMEFCPL0
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EFCPVY
     C                     Z-ADDWOAIC3    WSAIC3           Company Number
     C                     Z-ADDWOCONB    WSCONB           Invoice Number
     C                     MOVELWOCEST    WSCEST           Invoice Suffix
     C                     Z-ADDWONBNY    WSNBNY           ARHN Note Numbe
     C                     Z-ADDWONCNY    WSNCNY           ARHN Note Line
      *
     C           KLDLSP    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSCONB           Invoice Number
     C                     KFLD           WSCEST           Invoice Suffix
     C                     KFLD           WSNBNY           ARHN Note Numbe
     C                     KFLD           WSNCNY           ARHN Note Line
     C           KLDLSP    CHAIN@EFCPVY              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMEFCPL0'MDACP
     C                     MOVEL'@EFCPVY' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EFCPVY                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Crt Note Header Purge CR - A/R Header Note Header  * PMEDCPL6
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EDCPV7
     C                     Z-ADDWMAIC3    WTAIC3           Company Number
     C                     Z-ADDWMCONB    WTCONB           Invoice Number
     C                     MOVELWMCEST    WTCEST           Invoice Suffix
     C                     Z-ADDWMNBNY    WTNBNY           ARHN Note Numbe
     C                     Z-ADDWMSLDT    WTSLDT           ARHN Note Date
     C                     Z-ADDWMDETM    WTDETM           ARHN Note Time
     C                     MOVELWMENVN    WTENVN           ARHN Note Creat
     C                     Z-ADDWMSMDT    WTSMDT           ARHN Follow Up
     C                     MOVELWMFUPS    WTFUPS           ARHN Follow Up
     C                     Z-ADDWMSNDT    WTSNDT           ARHN Follow Up
     C                     Z-ADDWMDFTM    WTDFTM           ARHN Follow Up
     C                     MOVELWMEMVN    WTEMVN           ARHN Follow Up
     C                     Z-ADDWMANC7    WTANC7           A/R Customer Nu
     C                     MOVELWMR4CD    WTR4CD           Sales Route Cod
     C                     MOVELWMVSST    WTVSST           Record Status
     C                     Z-ADDWMMJDT    WTMJDT           Create Date
     C                     Z-ADDWMBETM    WTBETM           Create Time
     C                     MOVELWMCCVN    WTCCVN           Create User
     C                     MOVELWMCDVN    WTCDVN           Create Program
     C                     Z-ADDWMMKDT    WTMKDT           Change Date
     C                     Z-ADDWMBFTM    WTBFTM           Change Time
     C                     MOVELWMCEVN    WTCEVN           Change User
     C                     MOVELWMCFVN    WTCFVN           Change Program
      *
     C           KLCRSQ    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTCONB           Invoice Number
     C                     KFLD           WTCEST           Invoice Suffix
     C                     KFLD           WTNBNY           ARHN Note Numbe
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@EDCPV7                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4015' W0RTN   7
      * Send message 'A/R Header Note Header EX'
     C                     MOVEL'USR4015' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@EDCPV7                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRDLRC    BEGSR
      *================================================================
      * Del Note Header       DL - A/R Header Note Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EDCPVE
     C                     Z-ADDWMAIC3    WVAIC3           Company Number
     C                     Z-ADDWMCONB    WVCONB           Invoice Number
     C                     MOVELWMCEST    WVCEST           Invoice Suffix
     C                     Z-ADDWMNBNY    WVNBNY           ARHN Note Numbe
      *
     C           KLDLSR    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVCONB           Invoice Number
     C                     KFLD           WVCEST           Invoice Suffix
     C                     KFLD           WVNBNY           ARHN Note Numbe
     C           KLDLSR    CHAIN@EDCPVE              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMEDCPL0'MDACP
     C                     MOVEL'@EDCPVE' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EDCPVE                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV A/R Hdr OA for Purge - A/R Header OA  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWCONB           Invoice Number
     C                     KFLD           WWCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDWCAIC3    WWAIC3           Company Number
     C                     Z-ADDWCCONB    WWCONB           Invoice Number
     C                     MOVELWCCEST    WWCEST           Invoice Suffix
      * Establish starting position
     C           KRSSS     CHAIN@A4CPX7              90    *
      * Data record not found
     C   90                MOVEL'USR3460' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CRT A/R Hdr OA for Purge - A/R Header OA  * 
     C                     EXSR STCRRC
      * Dlt A/R Header OA     DL - A/R Header OA  * 
     C                     EXSR SUDLRC
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * CRT A/R Hdr OA for Purge - A/R Header OA  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @A4CPLW
     C                     Z-ADDWWAIC3    WXAIC3           Company Number
     C                     Z-ADDWWCONB    WXCONB           Invoice Number
     C                     MOVELWWCEST    WXCEST           Invoice Suffix
     C                     MOVELWWG4CD    WXG4CD           Bank Code
     C                     Z-ADDWWHXDT    WXHXDT           Deposit Date
     C                     Z-ADDWWYXNX    WXYXNX           Deposit Time
     C                     MOVELWWUTSX    WXUTSX           OA Unused Sts
      *
     C           KLCRST    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXCONB           Invoice Number
     C                     KFLD           WXCEST           Invoice Suffix
      * Check for duplicate primary key
     C           KLCRST    SETLL@A4CPLW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3461' W0RTN   7
      * Send message 'A/R Header OA          EX'
     C                     MOVEL'USR3461' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@A4CPLW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUDLRC    BEGSR
      *================================================================
      * Dlt A/R Header OA     DL - A/R Header OA  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @A4CPX6
     C                     Z-ADDWWAIC3    WYAIC3           Company Number
     C                     Z-ADDWWCONB    WYCONB           Invoice Number
     C                     MOVELWWCEST    WYCEST           Invoice Suffix
      *
     C           KLDLSU    KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYCONB           Invoice Number
     C                     KFLD           WYCEST           Invoice Suffix
     C           KLDLSU    CHAIN@A4CPX6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPA4CPL0'MDACP
     C                     MOVEL'@A4CPX6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@A4CPX6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Read all rcds Purge-$00 - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Define keylist
     C           KPSSV     KLIST
     C                     KFLD           TAB4DT           Transaction Dat
      * Setup key
     C                     Z-ADDP1H4DT    TAB4DT           Transaction Dat
      * Establish starting position
     C           KPSSV     SETLL@BDCPC4                    *
     C                     READ @BDCPC4                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT A/R Header for purge - A/R Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTAAIC3    WL0001           Company Number
     C                     Z-ADDTACONB    WL0002           Invoice Number
     C                     MOVELTACEST    WL0003    P      Invoice Suffix
     C                     MOVELTAUHCD    WL0004    P      Adjustment Type
     C                     Z-ADDTABSVA    WL0005           Transaction Amo
     C                     Z-ADDTAAIVA    WL0006           Adjustment Amou
     C                     Z-ADDTAAOVA    WL0007           Amount Paid
     C                     Z-ADDTABGVA    WL0008           Remaining Balan
     C                     MOVELTAAJST    WL0009    P      A/R Processing
     C                     MOVELTAE3ST    WL0010    P      Purge Status
     C                     MOVELTAG4CD    WL0011    P      Bank Code
     C                     Z-ADDTACKNB    WL0012           G/L Document Nu
     C                     Z-ADDTACAC7    WL0013           Order Number Re
     C                     Z-ADDTABKC7    WL0014           Ship To Custome
     C                     MOVELTABCCD    WL0015    P      Salesperson Cod
     C                     MOVELTAR4CD    WL0016    P      Sales Route Cod
     C                     Z-ADDTAB4DT    WL0017           Transaction Dat
     C                     Z-ADDTAATDT    WL0018           Due Date
     C                     Z-ADDTAH0DT    WL0019           Last Payment Da
     C                     Z-ADDTAH3DT    WL0020           Unused Date Cod
     C                     Z-ADDTAH4DT    WL0021           Paid in Full Da
     C                     Z-ADDTAH5DT    WL0022           Last G/L Post D
     C                     Z-ADDTAANC7    WL0023           A/R Customer Nu
     C                     MOVELTACPTX    WL0024    P      A/R Check Numbe
     C                     Z-ADDTABSDY    WL0025           Days to Pay
     C                     MOVELTAUVST    WL0026    P      EDI Status 1
     C                     MOVELTAUWST    WL0027    P      EDI Status 2
     C                     MOVELTAUXST    WL0028    P      EDI Status 3
     C                     Z-ADDTAAATM    WL0029           Job Time
     C                     MOVELTAAYNA    WL0030    P      User Id
     C                     MOVELTAA0NA    WL0031    P      Job Name
     C                     Z-ADDTAAXDT    WL0032           Job Date
     C                     EXSR SBCRRC
      * DLT A/R Header for Purge - A/R Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTAAIC3    WL0033           Company Number
     C                     Z-ADDTACONB    WL0034           Invoice Number
     C                     MOVELTACEST    WL0035    P      Invoice Suffix
     C                     EXSR SCDLRC
     C                     READ @BDCPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WABSVA           Transaction Amo
     C                     Z-ADD*ZERO     WAAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WAAOVA           Amount Paid
     C                     Z-ADD*ZERO     WABGVA           Remaining Balan
     C                     Z-ADD*ZERO     WACKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WACAC7           Order Number Re
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WAATDT           Due Date
     C                     Z-ADD*ZERO     WAH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WAH3DT           Unused Date Cod
     C                     Z-ADD*ZERO     WAH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WAH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABSDY           Days to Pay
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDDXNB           Sequence Number
     C                     Z-ADD*ZERO     WDBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WDB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WDDVDT           Payment/Deposit
     C                     Z-ADD*ZERO     WDYXNX           Deposit Time
     C                     Z-ADD*ZERO     WDHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WDCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WDC1NY           G/L Posting Com
     C                     Z-ADD*ZERO     WDQHDT           TFS Adj Week-En
     C                     Z-ADD*ZERO     WDQIDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDQJDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDQKDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDQLDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WDGMVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDGNVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDGOVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDGPVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGCONB           Invoice Number
     C                     Z-ADD*ZERO     WGJZNX           Reference Numbe
     C                     Z-ADD*ZERO     WGBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJCONB           Invoice Number
     C                     Z-ADD*ZERO     WJOTDT           Note Date
     C                     Z-ADD*ZERO     WJDXNB           Sequence Number
     C                     Z-ADD*ZERO     WJOUDT           Follow-up Date
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMCONB           Invoice Number
     C                     Z-ADD*ZERO     WMNBNY           ARHN Note Numbe
     C                     Z-ADD*ZERO     WMSLDT           ARHN Note Date
     C                     Z-ADD*ZERO     WMDETM           ARHN Note Time
     C                     Z-ADD*ZERO     WMSMDT           ARHN Follow Up
     C                     Z-ADD*ZERO     WMSNDT           ARHN Follow Up
     C                     Z-ADD*ZERO     WMDFTM           ARHN Follow Up
     C                     Z-ADD*ZERO     WMANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WMMJDT           Create Date
     C                     Z-ADD*ZERO     WMBETM           Create Time
     C                     Z-ADD*ZERO     WMMKDT           Change Date
     C                     Z-ADD*ZERO     WMBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOCONB           Invoice Number
     C                     Z-ADD*ZERO     WONBNY           ARHN Note Numbe
     C                     Z-ADD*ZERO     WONCNY           ARHN Note Line
     C                     Z-ADD*ZERO     WOMJDT           Create Date
     C                     Z-ADD*ZERO     WOBETM           Create Time
     C                     Z-ADD*ZERO     WOMKDT           Change Date
     C                     Z-ADD*ZERO     WOBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWCONB           Invoice Number
     C                     Z-ADD*ZERO     WWHXDT           Deposit Date
     C                     Z-ADD*ZERO     WWYXNX           Deposit Time
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBCRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     MOVEL*BLANK    WL0004  3
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008 112
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  6
     C                     Z-ADD*ZERO     WL0012  80
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  3
     C                     MOVEL*BLANK    WL0016  3
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024 10
     C                     Z-ADD*ZERO     WL0025  50
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
     C                     Z-ADD*ZERO     WL0029  60
     C                     MOVEL*BLANK    WL0030 10
     C                     MOVEL*BLANK    WL0031 10
     C                     Z-ADD*ZERO     WL0032  70
      * Define local variables for subroutine SCDLRC.
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  70
     C                     MOVEL*BLANK    WL0035  2
      *================================================================
     CSR         ZZEXIT    ENDSR
