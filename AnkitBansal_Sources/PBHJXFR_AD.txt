// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBHJXFR
// ?Date: 14.08.2025 Time: 03:47:59
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?E2378 RMC 01/03/13 Mark unprocessed PFS Shipping Trans for Invcd Orders
//?  as processed so other pgms wont read old records.
// LCL.Invoice Date = PAR.Invoice Date
LCL.Invoice_Date = PAR.Invoice_Date;

CASE;

// IF LCL.Invoice Date is not entered
IF LCL.Invoice_Date = *ZERO;

// LCL.Invoice Date = JOB.*Job date + CON.-1 *DAYS
LCL.Invoice_Date = DATEINCR(JOB.*Job_date '-1' 'DY' 1111100 'NONE' 'N' 1);

ENDIF;

EXECUTE FUNCTION(RTV by inv dte f/PFS  RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC2059188;
PARAMETER(LCL.Invoice_Date);
{
 //?USER: Process Data record

 //?(chk invoice date>0 in case this gets ran with a -0- date)
 CASE;

 // IF DB1.Invoice Date is entered
 IF DB1.Invoice_Date <> *ZERO;

 EXECUTE FUNCTION(PFS Inv Adj f/Inv ORD RT) TYPE(RTVOBJ) FILE(PPBGCPP)           AC2059189;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 {
  //?USER: Process Data record

  //?Mark rcd as processed -- the order is already invoiced
  // LCL.PFS Process Status = CND.Processed
  LCL.PFS_Process_Status = 1;

  // LCL.PFS Error Reason = CND.No Error
  LCL.PFS_Error_Reason = *BLANK;

  EXECUTE FUNCTION(Chg PrcSts/ErrRsn     CH) TYPE(CHGOBJ) FILE(PPBGCPP)           AC1735977;
  PARAMETER(DB1.PFS_Company_Number);
  PARAMETER(DB1.PFS_Inv_Adj_Seq_Nbr);
  PARAMETER(DB1.PFS_Transaction_Date);
  PARAMETER(DB1.PFS_Transaction_Time);
  PARAMETER(DB1.PFS_Transaction_Seq);
  PARAMETER(LCL.PFS_Process_Status);
  PARAMETER(LCL.PFS_Error_Reason);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Change Stamp      IF) TYPE(EXCINTFUN)                      AC1732163;
   PARAMETER(DB1.PFS_Change_Date);
   PARAMETER(DB1.PFS_Change_Time);
   {
    //?Execute internal function

    // PAR.PFS Change Date = JOB.*Job date
    PAR.PFS_Change_Date = JOB.*Job_date;

    // PAR.PFS Change time = JOB.*Job time
    PAR.PFS_Change_Time = JOB.*Job_time;

   }

  }

 }

 ENDIF;

}


