// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMCVXFR
// ?Date: 14.08.2025 Time: 03:44:44
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Cal LdPostWorkFls DatesRT) TYPE(RTVOBJ) FILE(PME2REP)          AC1913224;
PARAMETER('BLDPOSTFLS');
PARAMETER(PAR.Date_Alpha_USR);
{
 //?USER: Process Data record

 // LCL.PRP Completed Date = CON.*ZERO
 LCL.PRP_Completed_Date = *ZERO;

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 //?Record select of active
 CASE;

 // IF DB1.Record Status is Active
 IF DB1.Record_Status = 'A';

 //?Record select of active
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?Completed Record  completed date is entered
 CASE;

 // IF DB1.PRP Completed Date EQ LCL.PRP Completed Date
 IF DB1.PRP_Completed_Date = LCL.PRP_Completed_Date;

 //?Completed Record  completed date is entered
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 //?Calculate dates to be used by company
 DO;

 // LCL.*Job date = JOB.*Job date
 LCL.*Job_date = JOB.*Job_date;

 // LCL.Date (Alpha) USR = CON.0000000
 LCL.Date_Alpha_USR = 0000000;

 CASE;

 // IF PAR.Date (Alpha) USR EQ LCL.Date (Alpha) USR
 IF PAR.Date_Alpha_USR = LCL.Date_Alpha_USR;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.*Job date = CVTVAR(PAR.Date (Alpha) USR)
 LCL.*Job_date = CVTVAR(PAR.Date_Alpha_USR);

 ENDIF;

 //?Get the from date
 // LCL.USR Production Day 1 = CON.*ZERO
 LCL.USR_Production_Day_1 = *ZERO;

 // WRK.PFS Reefer Temp = CON.-1
 WRK.PFS_Reefer_Temp = -1;

 // LCL.Next Production Day Usr = LCL.*Job date + WRK.PFS Reefer Temp *DAYS
 LCL.Next_Production_Day_Usr = DATEINCR(LCL.*Job_date WRK.PFS_Reefer_Temp 'DY' 1111111
 'NONE' 'N' 1);

 EXECUTE FUNCTION(RTV Closest Prod Date  RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1449867;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(LCL.USR_Production_Day_1);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.USR Production Day 1 = DB1.Post to G/L Date
  PAR.USR_Production_Day_1 = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

 }

 // WRK.PRP From Date = LCL.USR Production Day 1
 WRK.PRP_From_Date = LCL.USR_Production_Day_1;

 // LCL.Next Production Day Usr = WRK.PRP From Date + WRK.PFS Reefer Temp *DAYS
 LCL.Next_Production_Day_Usr = DATEINCR(WRK.PRP_From_Date WRK.PFS_Reefer_Temp 'DY'
 1111111 'NONE' 'N' 1);

 EXECUTE FUNCTION(RTV Closest Prod Date  RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1449867;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(LCL.USR_Production_Day_1);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.USR Production Day 1 = DB1.Post to G/L Date
  PAR.USR_Production_Day_1 = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

 }

 // WRK.PRP From Date = LCL.USR Production Day 1
 WRK.PRP_From_Date = LCL.USR_Production_Day_1;

 //?equals 3 production days
 // LCL.Next Production Day Usr = WRK.PRP From Date + WRK.PFS Reefer Temp *DAYS
 LCL.Next_Production_Day_Usr = DATEINCR(WRK.PRP_From_Date WRK.PFS_Reefer_Temp 'DY'
 1111111 'NONE' 'N' 1);

 EXECUTE FUNCTION(RTV Closest Prod Date  RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1449867;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(LCL.USR_Production_Day_1);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.USR Production Day 1 = DB1.Post to G/L Date
  PAR.USR_Production_Day_1 = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

 }

 // WRK.PRP From Date = LCL.USR Production Day 1
 WRK.PRP_From_Date = LCL.USR_Production_Day_1;

 //?Get the next to date
 //?Get the next production days
 DO;

 //?FP1300 2/2/20009 ASK us to take the production date to 3
 //?FP1300 2/4/20009 ASK us to take the production date to 9 days out
 //?1
 // LCL.Next Production Day Usr = JOB.*Job date
 LCL.Next_Production_Day_Usr = JOB.*Job_date;

 EXECUTE FUNCTION(RTV Next Prod Date     RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1338022;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(WRK.PRP_To_Date);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
  IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

  // IF *OTHERWISE
  IF *OTHERWISE;

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.Production Date = DB1.Post to G/L Date
  PAR.Production_Date = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

  ENDIF;

 }

 //?2
 // LCL.Next Production Day Usr = WRK.PRP To Date
 LCL.Next_Production_Day_Usr = WRK.PRP_To_Date;

 EXECUTE FUNCTION(RTV Next Prod Date     RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1338022;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(WRK.PRP_To_Date);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
  IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

  // IF *OTHERWISE
  IF *OTHERWISE;

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.Production Date = DB1.Post to G/L Date
  PAR.Production_Date = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

  ENDIF;

 }

 //?3
 // LCL.Next Production Day Usr = WRK.PRP To Date
 LCL.Next_Production_Day_Usr = WRK.PRP_To_Date;

 EXECUTE FUNCTION(RTV Next Prod Date     RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1338022;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(WRK.PRP_To_Date);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
  IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

  // IF *OTHERWISE
  IF *OTHERWISE;

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.Production Date = DB1.Post to G/L Date
  PAR.Production_Date = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

  ENDIF;

 }

 //?4
 // LCL.Next Production Day Usr = WRK.PRP To Date
 LCL.Next_Production_Day_Usr = WRK.PRP_To_Date;

 EXECUTE FUNCTION(RTV Next Prod Date     RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1338022;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(WRK.PRP_To_Date);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
  IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

  // IF *OTHERWISE
  IF *OTHERWISE;

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.Production Date = DB1.Post to G/L Date
  PAR.Production_Date = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

  ENDIF;

 }

 //?5
 // LCL.Next Production Day Usr = WRK.PRP To Date
 LCL.Next_Production_Day_Usr = WRK.PRP_To_Date;

 EXECUTE FUNCTION(RTV Next Prod Date     RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1338022;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(WRK.PRP_To_Date);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
  IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

  // IF *OTHERWISE
  IF *OTHERWISE;

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.Production Date = DB1.Post to G/L Date
  PAR.Production_Date = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

  ENDIF;

 }

 //?6
 // LCL.Next Production Day Usr = WRK.PRP To Date
 LCL.Next_Production_Day_Usr = WRK.PRP_To_Date;

 EXECUTE FUNCTION(RTV Next Prod Date     RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1338022;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(WRK.PRP_To_Date);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
  IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

  // IF *OTHERWISE
  IF *OTHERWISE;

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.Production Date = DB1.Post to G/L Date
  PAR.Production_Date = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

  ENDIF;

 }

 //?7
 // LCL.Next Production Day Usr = WRK.PRP To Date
 LCL.Next_Production_Day_Usr = WRK.PRP_To_Date;

 EXECUTE FUNCTION(RTV Next Prod Date     RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1338022;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(WRK.PRP_To_Date);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
  IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

  // IF *OTHERWISE
  IF *OTHERWISE;

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.Production Date = DB1.Post to G/L Date
  PAR.Production_Date = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

  ENDIF;

 }

 //?8
 // LCL.Next Production Day Usr = WRK.PRP To Date
 LCL.Next_Production_Day_Usr = WRK.PRP_To_Date;

 EXECUTE FUNCTION(RTV Next Prod Date     RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1338022;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(WRK.PRP_To_Date);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
  IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

  // IF *OTHERWISE
  IF *OTHERWISE;

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.Production Date = DB1.Post to G/L Date
  PAR.Production_Date = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

  ENDIF;

 }

 //?9
 // LCL.Next Production Day Usr = WRK.PRP To Date
 LCL.Next_Production_Day_Usr = WRK.PRP_To_Date;

 EXECUTE FUNCTION(RTV Next Prod Date     RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1338022;
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Next_Production_Day_Usr);
 PARAMETER(WRK.PRP_To_Date);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Order
  IF DB1.Post_to_G_L_Date = PAR.Post_to_G_L_Date;

  // IF *OTHERWISE
  IF *OTHERWISE;

  CASE;

  // IF DB1.Production Day Status is yes
  IF DB1.Production_Day_Status = 'Y';

  // PAR.Production Date = DB1.Post to G/L Date
  PAR.Production_Date = DB1.Post_to_G_L_Date;

  QUIT;

  ENDIF;

  ENDIF;

 }

 ENDDO;

 EXECUTE FUNCTION(Chg LdPostWorkFlsPrcDtCO) TYPE(CHGOBJ) FILE(PME2REP)           AC1913226;
 PARAMETER(DB1.PRP_Type);
 PARAMETER(DB1.PRP_Sequence_Number);
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.PRP_Warehouse_Code);
 PARAMETER(WRK.PRP_From_Date);
 PARAMETER(WRK.PRP_To_Date);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 ENDDO;

 ENDIF;

}


EXECUTE FUNCTION(Rtv LdPostWorkFls DatesRT) TYPE(RTVOBJ) FILE(PME2REP)          AC1913230;
PARAMETER('BLDPOSTFLS');
{
 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 //?fp1054 Add process with production warehouse
 //?Process Request Event -- Warehouse
 //? I PRP Warehouse
 //? O LSP Prodution Warehouse
 //? O LSP Accounting Co
 EXECUTE FUNCTION(Rtv Productin Whs     RT) TYPE(RTVOBJ) FILE(CAADREP)           AC1498428;
 PARAMETER(DB1.PRP_Warehouse_Code);
 PARAMETER(LCL.LSP_Prodution_Warehouse);
 PARAMETER(LCL.LSP_Accounting_Co);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?*Prior
 //?BUILD FILES BY ORDER CO AND ORDER WAREHOUSE
 //?Exc Bld Ld Sch PsWF   XF - Load Schdlng Pos PMB8XFR comment
 //?Build Files by Company Order and Item
 //?Now
 // Call program Exc Bld Ld Sch PsWF   XF.
 CALL PROGRAM(Exc Bld Ld Sch PsWF   XF) ('PMB8XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.PRP_Warehouse_Code);
 PARAMETER(DB1.PRP_From_Date);
 PARAMETER(DB1.PRP_To_Date);
 PARAMETER(LCL.LSP_Accounting_Co);
 PARAMETER(LCL.LSP_Prodution_Warehouse);

 //?Update the Process records last used
 EXECUTE FUNCTION(RTVChg LdPostWrorkFlsDtRT) TYPE(RTVOBJ) FILE(PME2REP)          AC1913233;
 PARAMETER(DB1.PRP_Type);
 PARAMETER(DB1.Company_Number);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg LdPostWorkFlsCmpDteCO) TYPE(CHGOBJ) FILE(PME2REP)          AC1913232;
  PARAMETER(DB1.PRP_Type);
  PARAMETER(DB1.PRP_Sequence_Number);
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.PRP_Warehouse_Code);
  PARAMETER(DB1.PRP_From_Date);
  PARAMETER(DB1.PRP_To_Date);
  PARAMETER(JOB.*Job_date);
  PARAMETER(JOB.*Job_time);
  PARAMETER(DB1.PRP_Request_Type);
  PARAMETER(DB1.PRP_Completed_Date);
  PARAMETER(DB1.PRP_Unused_Status_1);
  PARAMETER(DB1.PRP_Unused_Status_2);
  PARAMETER(DB1.PRP_Unused_Status_3);
  PARAMETER(DB1.PRP_Unused_Status_4);
  PARAMETER(DB1.EDI_Status_1);
  PARAMETER(DB1.EDI_Status_2);
  PARAMETER(DB1.EDI_Status_3);
  PARAMETER(DB1.Record_Status);
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
 }

 // WRK.Record Selected       USR = CND.yes
 WRK.Record_Selected_USR = 'Y';

 ENDIF;

 //?USER: Exit processing

 CASE;

 // IF WRK.Record Selected       USR is yes
 IF WRK.Record_Selected_USR = 'Y';

 //?BUILD REMAING PROCESS WITHOUT THE COMPANY AND WARE HOUSE
 // Call program Exc Bld Ld Sch PsWF1TmXF.
 CALL PROGRAM(Exc Bld Ld Sch PsWF1TmXF) ('PNK9XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.PRP_Warehouse_Code);
 PARAMETER(DB1.PRP_From_Date);
 PARAMETER(DB1.PRP_To_Date);

 ENDIF;

}


