// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMBPXFR
// ?Date: 14.08.2025 Time: 03:42:33
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(FIX Act Frt in SlsHst RT) TYPE(RTVOBJ) FILE(OMFJCPP)           AC1797197;
{
 //?USER: Initialize routine

 // WRK.Date                  USR = CON.1160915
 WRK.Date_USR = 1160915;

 // WRK.Load ID = CON.66000
 WRK.Load_ID = 66000;

 //?USER: Process Data record

 //?1st run for ge 8/27/06
 //?2nd run for ge 10/9/06 to corr 10/9 and 10/10 frt. ww frt charges
 //?NEW run for MG  ge 9/15/2016
 //?POLTDFR -   had 2 more places that Alloc the frt using the wrong amt.
 CASE;

 // IF DB1.LH Carrier Paid Dte GE WRK.Date                  USR
 IF DB1.LH_Carrier_Paid_Dte >= WRK.Date_USR;

 // AND DB1.Load ID LE WRK.Load ID
 AND DB1.Load_ID <= WRK.Load_ID;

 // AND DB1.Load Status is Invoiced
 AND DB1.Load_Status = 'I';

 // WRK.Freight Amount = CON.*ZERO
 WRK.Freight_Amount = *ZERO;

 EXECUTE FUNCTION(RTV Act Frt sum       RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC1797203;
 PARAMETER(DB1.Load_ID);
 PARAMETER(WRK.Freight_Amount);
 {
  //?USER: Process Data record

  // PAR.Freight Amount = PAR.Freight Amount + DB1.Actual Freight Amount
  PAR.Freight_Amount = PAR.Freight_Amount + DB1.Actual_Freight_Amount;

 }

 //?do for all this time
 // WRK.Freight Amount = CON.*ZERO
 WRK.Freight_Amount = *ZERO;

 CASE;

 // IF WRK.Freight Amount NE DB1.Load Actual Freight
 IF WRK.Freight_Amount <> DB1.Load_Actual_Freight;

 // Call program UPD Alloc Frt to Hist  XF.
 CALL PROGRAM(UPD Alloc Frt to Hist  XF) ('PLABXFR');
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Load_Actual_Freight);
 PARAMETER(DB1.Load_Total_Freight);

 ENDIF;

 ENDIF;

 CASE;

 // IF DB1.Load ID GT WRK.Load ID
 IF DB1.Load_ID > WRK.Load_ID;

 QUIT;

 ENDIF;

}


