     H/TITLE Exc Auto Inv Rest Cmp  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 11/16/18  Time  : 10:23:47
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDJYREL3IF  E           K        DISK
      * RTV : Company Defaults Internal Plant Companies Only CO
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FOMHCCPL1IF  E           K        DISK
      * RTV : Physical Count Control    Retrieval index
      *
     FPDL5CPL7IF  E           K        DISK
      * RSQ : Item Lot Location         Co/Whs/Itm
      *
      * Long constants
     E                    @CN#    1  05  6   @CN    25
     I@JYREEY
      * Company Defaults Internal Plant Companies Only CO
      * Renamed input format fields
     I              JYAIC3                          WAAIC3
     I              JYZ9ST                          WAZ9ST
     I              JYCSST                          WACSST
     I              JYZ8ST                          WAZ8ST
     I              JYCXST                          WACXST
     I              JYSWST                          WASWST
     I              JYXXTM                          WAXXTM
     I              JYUECD                          WAUECD
     I              JYHSST                          WAHSST
     I              JYAMEO                          WAAMEO
     I              JYSSDF                          WASSDF
     I              JYPDFT                          WAPDFT
     I              JYYISX                          WAYISX
     I              JYYJSX                          WAYJSX
     I              JYYKSX                          WAYKSX
     I              JYYLSX                          WAYLSX
     I              JYYMSX                          WAYMSX
     I              JYYNSX                          WAYNSX
     I              JYUVST                          WAUVST
     I              JYUWST                          WAUWST
     I              JYUXST                          WAUXST
     I              JYVSST                          WAVSST
     I              JYAATM                          WAAATM
     I              JYAYNA                          WAAYNA
     I              JYA0NA                          WAA0NA
     I              JYAXDT                          WAAXDT
      *
     I@ADREWA
      * Warehouse                 ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
      *
     I@HCCPJ0
      * Physical Count Control    Retrieval index
      * Renamed input format fields
     I              HCAIC3                          WCAIC3
     I              HCAJCD                          WCAJCD
     I              HCDHDT                          WCDHDT
     I              HCOFCD                          WCOFCD
     I              HCTGST                          WCTGST
     I              HCUVST                          WCUVST
     I              HCUWST                          WCUWST
     I              HCUXST                          WCUXST
     I              HCAATM                          WCAATM
     I              HCAYNA                          WCAYNA
     I              HCA0NA                          WCA0NA
     I              HCAXDT                          WCAXDT
      *
     I@L5CPX4
      * Item Lot Location         Co/Whs/Itm
      * Renamed input format fields
     I              L5AIC3                          WDAIC3
     I              L5HGCD                          WDHGCD
     I              L5AJCD                          WDAJCD
     I              L5ELDT                          WDELDT
     I              L5LXNM                          WDLXNM
     I              L5YMCD                          WDYMCD
     I              L5YNCD                          WDYNCD
     I              L5J2QT                          WDJ2QT
     I              L5G5WG                          WDG5WG
     I              L5J3QT                          WDJ3QT
     I              L5G6WG                          WDG6WG
     I              L5J4QT                          WDJ4QT
     I              L5G7WG                          WDG7WG
     I              L5LODT                          WDLODT
     I              L5LPDT                          WDLPDT
     I              L5LQDT                          WDLQDT
     I              L5NBR                           WDNBR
     I              L5YTCD                          WDYTCD
     I              L5AMSX                          WDAMSX
     I              L5ASSX                          WDASSX
     I              L5ATSX                          WDATSX
     I              L5AUSX                          WDAUSX
     I              L5YSCD                          WDYSCD
     I              L5UVST                          WDUVST
     I              L5UWST                          WDUWST
     I              L5UXST                          WDUXST
     I              L5VSST                          WDVSST
     I              L5AATM                          WDAATM
     I              L5AYNA                          WDAYNA
     I              L5A0NA                          WDA0NA
     I              L5AXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Auto Inv Restorat'n Notfy'
      * Company Number Alpha
     I                                        1   3 ZA0001
      * Message data for 'ESNDMAIL-AutoInvRest-Co'
      * Email Address
     I                                        1  50 ZA0002
      * Subject Line USR
     I                                       51 150 ZA0003
      * Office Message USR
     I                                      151 282 ZA0004
      * Message data for 'ESNDMAIL-RESTORATION'
      * Email Address
     I                                        1  50 ZA0005
      * Office Message USR
     I                                       51 182 ZA0006
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Auto Inv Rest Cmp  XF
      * Rtv Auto Inv Rest Cmp RT - Company Defaults Internal  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Auto Inv Rest Cmp RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@JYREEY                    *
     C                     READ @JYREEY                  90*
      * Data record not found
     C   90                MOVEL'USR2025' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If record is active, process it
      * CASE: DB1.Record Status is Active
     C           WAVSST    IFEQ 'A'                        *IF
      * Determine if Auto Inventory Restoration set up for company
      * RTV WHS Auto Inv Rest  RT - Warehouse  * 
     C                     EXSR SBRVGN
      * Set WHS Auto Inv Rest USR or Send Email if not processed
      * CASE: LCL.WHS Auto Inv Rest Co  USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * If Count = zero
      * CASE: LCL.WHS Auto Inv Rest Cnt USR is Eq Zero
     C           YL0002    IFEQ 0                          *IF
      * No Warehouses were processed for Company
     C                     MOVEL'N'       YL0001           WHS Auto Inv Re
      * Send Email Message
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0001  30       Company Number
     C                     PARM @CN,002   WQ0002 10        Company Value C
     C           YL0005    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Email address is found, send email
      * CASE: LCL.Email Address is Entered
     C           YL0005    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0006           Company Number
     C                     MOVELWAAIC3    YL0006           Company Number
      * S13816 DN 09/28/18-Changed Message Content & use RTV MsgID USR509
      * Setup message data for message
     C                     MOVELYL0006    ZA0001           Company Number
      * Retrieve message Auto Inv Restorat'n Notfy
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR5090' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0007    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * S13816 DN 09/28/18-Commented Out. Doesn't Work & is Not Required.
      * Setup message data for message
     C                     MOVELYL0005    ZA0002           Email Address
     C                     MOVELYL0007    ZA0003           Subject Line US
     C                     MOVEL*BLANK    ZA0004           Office Message
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4974' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * At least one Warehouse was processed for the Company
     C                     MOVEL'Y'       YL0001           WHS Auto Inv Re
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * This Company is not using Auto Inventory Restoration
     C                     MOVEL'N'       YL0001           WHS Auto Inv Re
     C                     END                             *FI
      * Rtv Auto Inv Rest Cmp RT - Warehouse  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     READ @JYREEY                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV WHS Auto Inv Rest  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0001           WHS Auto Inv Re
     C                     Z-ADD0         YL0002           WHS Auto Inv Re
     C                     Z-ADD0         YL0003           WHS Auto Inv Re
     C                     Z-ADD##JDT     YL0004           Physical Start
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBWC3    WQSB01           Shipping Compan
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Shipping Compan
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Shipping Compan
      * Establish starting position
     C           KRSSB     SETLL@ADREWA                    *
     C           KRSSB     READE@ADREWA                  90*
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.WHS Auto Inv Restoration is Yes
     C           WBRPSX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0001           WHS Auto Inv Re
      * Rtv Auto Inv Rest Cmp  RT - Physical Count Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     MOVELWBAJCD    WL0002    P      Warehouse Code
     C                     Z-ADDYL0004    WL0003           Physical Start
     C                     EXSR SCRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     ADD  1         YL0003           WHS Auto Inv Re
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@ADREWA                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0003    YL0002           WHS Auto Inv Re
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Auto Inv Rest Cmp  RT - Physical Count Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCAJCD    WQSC02           Warehouse Code
     C           *LIKE     DEFN WCDHDT    WQSC03           Physical Start
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Warehouse Code
     C                     KFLD           WQSC03           Physical Start
      * Setup key
     C                     Z-ADDWL0001    WQSC01           Company Number
     C                     MOVELWL0002    WQSC02           Warehouse Code
     C                     Z-ADDWL0003    WQSC03           Physical Start
      * Establish starting position
     C           KRSSC     SETLL@HCCPJ0                    *
     C           KRSSC     READE@HCCPJ0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1487' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSC     READE@HCCPJ0                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Auto Inv Rest Cmp RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBWC3    WQSD01           Shipping Compan
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Shipping Compan
      * Setup key
     C                     Z-ADDWAAIC3    WQSD01           Shipping Compan
      * Establish starting position
     C           KRSSD     SETLL@ADREWA                    *
     C           KRSSD     READE@ADREWA                  90*
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If Warehouse Auto Inventory Restoration Company, check warehouse
      * CASE: PAR.WHS Auto Inv Rest Co  USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * If Whs Auto Inventory Restoration Company, get physical count
      * CASE: DB1.WHS Auto Inv Restoration is Yes
     C           WBRPSX    IFEQ 'Y'                        *IF
     C                     Z-ADD##JDT     YL0008           Physical Start
      * Rtv Auto Inv Rest Cmp  RT - Physical Count Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBBWC3    WL0001           Company Number
     C                     MOVELWBAJCD    WL0002    P      Warehouse Code
     C                     Z-ADDYL0008    WL0003           Physical Start
     C                     EXSR SCRVGN
      * If record not found, get quantity and weight from Inv Lot Loc
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     Z-ADD0         YL0009           Quantity Inv On
      * Rtv Item Loc Qty,Wgt  RT - Item Lot Location  * 
     C                     EXSR SERVGN
      * If retrieved quantity > 0, send email message
      * CASE: LCL.Quantity Inv On-Hand USR is Greater than Zero
     C           YL0009    IFGT 0                          *IF
      * Send Email Message
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBBWC3    WQ0004  30       Company Number
     C                     PARM @CN,002   WQ0005 10        Company Value C
     C           YL0011    PARM *BLANK    WQ0006 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If email address exists, build and send message
      * CASE: LCL.Email Address is Entered
     C           YL0011    IFNE *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,004   CAT  @CN,005:ZQYL0012    P      Text USR 43
     C                     Z-ADD2         ZQ      50
     C           YL0012    CAT  WBAJCD:ZQ YL0013    P      Office Message
      * Setup message data for message
     C                     MOVELYL0011    ZA0005           Email Address
     C                     MOVELYL0013    ZA0006           Office Message
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4703' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Item Loc Qty,Wgt  RT - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0009           Quantity Inv On
     C                     Z-ADD*ZERO     YL0010           Weight 1.2
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WDAJCD    WQSE02           Warehouse Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Warehouse Code
      * Setup key
     C                     Z-ADDWBBWC3    WQSE01           Company Number
     C                     MOVELWBAJCD    WQSE02           Warehouse Code
      * Establish starting position
     C           KRSSE     SETLL@L5CPX4                    *
     C           KRSSE     READE@L5CPX4                  90*
      * Data record not found
     C   90                MOVEL'USR2634' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WDJ2QT    YL0009           Quantity Inv On
     C                     ADD  WDG6WG    YL0010           Weight 1.2
     C           KRSSE     READE@L5CPX4                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAXXTM           Departure Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WBBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WBBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCDHDT           Physical Start
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDELDT           Production Date
     C                     Z-ADD*ZERO     WDLXNM           Lot Number
     C                     Z-ADD*ZERO     WDYNCD           Location Level
     C                     Z-ADD*ZERO     WDJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WDG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WDJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WDG6WG           ILl Item Wgt On
     C                     Z-ADD*ZERO     WDJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WDG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WDLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WDLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WDLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WDNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  3
     C                     Z-ADD*ZERO     WL0003  70
      * Define local work field WHS Auto Inv Rest Co  USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field WHS Auto Inv Rest Cnt USR
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field WHS Auto Inv Rest Cnt USR
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Physical Start Date
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0005 50
      * Define local work field Company Number Alpha
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field Subject Line USR
     C                     MOVEL*BLANK    YL0007100
      * Define local work field Physical Start Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Quantity Inv On-Hand USR
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Weight 1.2             .U
     C                     Z-ADD*ZERO     YL0010  92
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0011 50
      * Define local work field Text USR 43
     C                     MOVEL*BLANK    YL0012 43
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0013132
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0003
00002 INVRST
00003 Y2U0005
00004 Inventory Restoration
00005 Did NOT POST for:
