     H/TITLE Cnv Company Cust to newXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 03/29/10  Time  : 09:13:42
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOMGZCPL1IF  E           K        DISK
      * RTV : Company Customer G/L      Retrieval index
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAEOREL0IF  E           K        DISK                      A
      * UPD : Company Customer          Update index
      *
     FOMGZCPL0UF  E           K        DISK                      A
      * UPD : Company Customer G/L      Update index
      *
     FARBCREL0IF  E           K        DISK                      A
      * UPD : A/R Summary               Update index
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WBAIC3
     I              EOBKC7                          WBBKC7
     I              EOAQCD                          WBAQCD
     I              EOR4CD                          WBR4CD
     I              EOBYNA                          WBBYNA
     I              EOB6NA                          WBB6NA
     I              EOBZNA                          WBBZNA
     I              EOLLST                          WBLLST
     I              EOPPST                          WBPPST
     I              EOR5NB                          WBR5NB
     I              EOR6NB                          WBR6NB
     I              EOQGST                          WBQGST
     I              EOBOCD                          WBBOCD
     I              EOTBNB                          WBTBNB
     I              EOMTCU                          WBMTCU
     I              EOW2NB                          WBW2NB
     I              EORPCD                          WBRPCD
     I              EOAJCD                          WBAJCD
     I              EOX9ST                          WBX9ST
     I              EOT9CD                          WBT9CD
     I              EOUBCD                          WBUBCD
     I              EOISTX                          WBISTX
     I              EOLQCD                          WBLQCD
     I              EONJNA                          WBNJNA
     I              EOI0TX                          WBI0TX
     I              EONKNA                          WBNKNA
     I              EOI1TX                          WBI1TX
     I              EOVLST                          WBVLST
     I              EORLST                          WBRLST
     I              EOMMTX                          WBMMTX
     I              EOOHNA                          WBOHNA
     I              EOQ6ST                          WBQ6ST
     I              EOQ8ST                          WBQ8ST
     I              EORBST                          WBRBST
     I              EOREST                          WBREST
     I              EOUVST                          WBUVST
     I              EOUWST                          WBUWST
     I              EOUXST                          WBUXST
     I              EOVSST                          WBVSST
     I              EOAATM                          WBAATM
     I              EOAYNA                          WBAYNA
     I              EOA0NA                          WBA0NA
     I              EOAXDT                          WBAXDT
      *
     I@GZCPIH
      * Company Customer G/L      Retrieval index
      * Renamed input format fields
     I              GZAIC3                          WCAIC3
     I              GZBKC7                          WCBKC7
     I              GZOOVA                          WCOOVA
     I              GZZBNB                          WCZBNB
     I              GZSNST                          WCSNST
     I              GZAVNB                          WCAVNB
     I              GZDSCD                          WCDSCD
     I              GZUVST                          WCUVST
     I              GZUWST                          WCUWST
     I              GZUXST                          WCUXST
     I              GZAATM                          WCAATM
     I              GZAYNA                          WCAYNA
     I              GZA0NA                          WCA0NA
     I              GZAXDT                          WCAXDT
      *
     I@EOREXL
      * Company Customer          Update index
      * Renamed input format fields
     I              EOAIC3                          WDAIC3
     I              EOBKC7                          WDBKC7
     I              EOAQCD                          WDAQCD
     I              EOR4CD                          WDR4CD
     I              EOBYNA                          WDBYNA
     I              EOB6NA                          WDB6NA
     I              EOBZNA                          WDBZNA
     I              EOLLST                          WDLLST
     I              EOPPST                          WDPPST
     I              EOR5NB                          WDR5NB
     I              EOR6NB                          WDR6NB
     I              EOQGST                          WDQGST
     I              EOBOCD                          WDBOCD
     I              EOTBNB                          WDTBNB
     I              EOMTCU                          WDMTCU
     I              EOW2NB                          WDW2NB
     I              EORPCD                          WDRPCD
     I              EOAJCD                          WDAJCD
     I              EOX9ST                          WDX9ST
     I              EOT9CD                          WDT9CD
     I              EOUBCD                          WDUBCD
     I              EOISTX                          WDISTX
     I              EOLQCD                          WDLQCD
     I              EONJNA                          WDNJNA
     I              EOI0TX                          WDI0TX
     I              EONKNA                          WDNKNA
     I              EOI1TX                          WDI1TX
     I              EOVLST                          WDVLST
     I              EORLST                          WDRLST
     I              EOMMTX                          WDMMTX
     I              EOOHNA                          WDOHNA
     I              EOQ6ST                          WDQ6ST
     I              EOQ8ST                          WDQ8ST
     I              EORBST                          WDRBST
     I              EOREST                          WDREST
     I              EOUVST                          WDUVST
     I              EOUWST                          WDUWST
     I              EOUXST                          WDUXST
     I              EOVSST                          WDVSST
     I              EOAATM                          WDAATM
     I              EOAYNA                          WDAYNA
     I              EOA0NA                          WDA0NA
     I              EOAXDT                          WDAXDT
      *
     I@GZCPIG
      * Company Customer G/L      Update index
      * Renamed input format fields
     I              GZAIC3                          WEAIC3
     I              GZBKC7                          WEBKC7
     I              GZOOVA                          WEOOVA
     I              GZZBNB                          WEZBNB
     I              GZSNST                          WESNST
     I              GZAVNB                          WEAVNB
     I              GZDSCD                          WEDSCD
     I              GZUVST                          WEUVST
     I              GZUWST                          WEUWST
     I              GZUXST                          WEUXST
     I              GZAATM                          WEAATM
     I              GZAYNA                          WEAYNA
     I              GZA0NA                          WEA0NA
     I              GZAXDT                          WEAXDT
      *
     I@JEREWS
      * Sales Route               Active Records
      * Renamed input format fields
     I              JER4CD                          WFR4CD
     I              JEMZNA                          WFMZNA
     I              JEBCCD                          WFBCCD
     I              JEBFCD                          WFBFCD
     I              JEQ4CD                          WFQ4CD
     I              JEWOST                          WFWOST
     I              JER8CD                          WFR8CD
     I              JEUVST                          WFUVST
     I              JEUWST                          WFUWST
     I              JEUXST                          WFUXST
     I              JEVSST                          WFVSST
     I              JEAATM                          WFAATM
     I              JEAYNA                          WFAYNA
     I              JEA0NA                          WFA0NA
     I              JEAXDT                          WFAXDT
      *
     I@BCREFD
      * A/R Summary               Update index
      * Renamed input format fields
     I              BCAIC3                          WGAIC3
     I              BCANC7                          WGANC7
     I              BCAGVA                          WGAGVA
     I              BCACVA                          WGACVA
     I              BCADVA                          WGADVA
     I              BCAEVA                          WGAEVA
     I              BCAFVA                          WGAFVA
     I              BCAHVA                          WGAHVA
     I              BCVIVA                          WGVIVA
     I              BCVJVA                          WGVJVA
     I              BCVKVA                          WGVKVA
     I              BCVLVA                          WGVLVA
     I              BCVMVA                          WGVMVA
     I              BCVNVA                          WGVNVA
     I              BCEEVA                          WGEEVA
     I              BCAKTM                          WGAKTM
     I              BCAHDT                          WGAHDT
     I              BCANDT                          WGANDT
     I              BCANVA                          WGANVA
     I              BCALDT                          WGALDT
     I              BCAMVA                          WGAMVA
     I              BCAIDT                          WGAIDT
     I              BCALVA                          WGALVA
     I              BCDJNB                          WGDJNB
     I              BCDLNB                          WGDLNB
     I              BCDDNB                          WGDDNB
     I              BCDMNB                          WGDMNB
     I              BCDUDT                          WGDUDT
     I              BCLYNO                          WGLYNO
     I              BCLYNC                          WGLYNC
     I              BCLYNP                          WGLYNP
     I              BCLYNI                          WGLYNI
     I              BCADPM                          WGADPM
     I              BCVOVA                          WGVOVA
     I              BCBTDY                          WGBTDY
     I              BCBUDY                          WGBUDY
     I              BCVPVA                          WGVPVA
     I              BCVQVA                          WGVQVA
     I              BCBCCD                          WGBCCD
     I              BCR4CD                          WGR4CD
     I              BCCUMO                          WGCUMO
     I              BCUVST                          WGUVST
     I              BCUWST                          WGUWST
     I              BCUXST                          WGUXST
     I              BCAATM                          WGAATM
     I              BCAYNA                          WGAYNA
     I              BCA0NA                          WGA0NA
     I              BCAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAEO1    E DSCAEOREL0
      * UPD : Company Customer          Update index
      * Renamed input format fields
     I              EOAIC3                          WDAIC3
     I              EOBKC7                          WDBKC7
     I              EOAQCD                          WDAQCD
     I              EOR4CD                          WDR4CD
     I              EOBYNA                          WDBYNA
     I              EOB6NA                          WDB6NA
     I              EOBZNA                          WDBZNA
     I              EOLLST                          WDLLST
     I              EOPPST                          WDPPST
     I              EOR5NB                          WDR5NB
     I              EOR6NB                          WDR6NB
     I              EOQGST                          WDQGST
     I              EOBOCD                          WDBOCD
     I              EOTBNB                          WDTBNB
     I              EOMTCU                          WDMTCU
     I              EOW2NB                          WDW2NB
     I              EORPCD                          WDRPCD
     I              EOAJCD                          WDAJCD
     I              EOX9ST                          WDX9ST
     I              EOT9CD                          WDT9CD
     I              EOUBCD                          WDUBCD
     I              EOISTX                          WDISTX
     I              EOLQCD                          WDLQCD
     I              EONJNA                          WDNJNA
     I              EOI0TX                          WDI0TX
     I              EONKNA                          WDNKNA
     I              EOI1TX                          WDI1TX
     I              EOVLST                          WDVLST
     I              EORLST                          WDRLST
     I              EOMMTX                          WDMMTX
     I              EOOHNA                          WDOHNA
     I              EOQ6ST                          WDQ6ST
     I              EOQ8ST                          WDQ8ST
     I              EORBST                          WDRBST
     I              EOREST                          WDREST
     I              EOUVST                          WDUVST
     I              EOUWST                          WDUWST
     I              EOUXST                          WDUXST
     I              EOVSST                          WDVSST
     I              EOAATM                          WDAATM
     I              EOAYNA                          WDAYNA
     I              EOA0NA                          WDA0NA
     I              EOAXDT                          WDAXDT
      *
     IQOMGZ1    E DSOMGZCPL0
      * UPD : Company Customer G/L      Update index
      * Renamed input format fields
     I              GZAIC3                          WEAIC3
     I              GZBKC7                          WEBKC7
     I              GZOOVA                          WEOOVA
     I              GZZBNB                          WEZBNB
     I              GZSNST                          WESNST
     I              GZAVNB                          WEAVNB
     I              GZDSCD                          WEDSCD
     I              GZUVST                          WEUVST
     I              GZUWST                          WEUWST
     I              GZUXST                          WEUXST
     I              GZAATM                          WEAATM
     I              GZAYNA                          WEAYNA
     I              GZA0NA                          WEA0NA
     I              GZAXDT                          WEAXDT
      *
     IYARDCS      DS                             61
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
     IQARBC1    E DSARBCREL0
      * UPD : A/R Summary               Update index
      * Renamed input format fields
     I              BCAIC3                          WGAIC3
     I              BCANC7                          WGANC7
     I              BCAGVA                          WGAGVA
     I              BCACVA                          WGACVA
     I              BCADVA                          WGADVA
     I              BCAEVA                          WGAEVA
     I              BCAFVA                          WGAFVA
     I              BCAHVA                          WGAHVA
     I              BCVIVA                          WGVIVA
     I              BCVJVA                          WGVJVA
     I              BCVKVA                          WGVKVA
     I              BCVLVA                          WGVLVA
     I              BCVMVA                          WGVMVA
     I              BCVNVA                          WGVNVA
     I              BCEEVA                          WGEEVA
     I              BCAKTM                          WGAKTM
     I              BCAHDT                          WGAHDT
     I              BCANDT                          WGANDT
     I              BCANVA                          WGANVA
     I              BCALDT                          WGALDT
     I              BCAMVA                          WGAMVA
     I              BCAIDT                          WGAIDT
     I              BCALVA                          WGALVA
     I              BCDJNB                          WGDJNB
     I              BCDLNB                          WGDLNB
     I              BCDDNB                          WGDDNB
     I              BCDMNB                          WGDMNB
     I              BCDUDT                          WGDUDT
     I              BCLYNO                          WGLYNO
     I              BCLYNC                          WGLYNC
     I              BCLYNP                          WGLYNP
     I              BCLYNI                          WGLYNI
     I              BCADPM                          WGADPM
     I              BCVOVA                          WGVOVA
     I              BCBTDY                          WGBTDY
     I              BCBUDY                          WGBUDY
     I              BCVPVA                          WGVPVA
     I              BCVQVA                          WGVQVA
     I              BCBCCD                          WGBCCD
     I              BCR4CD                          WGR4CD
     I              BCCUMO                          WGCUMO
     I              BCUVST                          WGUVST
     I              BCUWST                          WGUWST
     I              BCUXST                          WGUXST
     I              BCAATM                          WGAATM
     I              BCAYNA                          WGAYNA
     I              BCA0NA                          WGA0NA
     I              BCAXDT                          WGAXDT
      *
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Cnv Company Cust to newXF
      * Change the "to" company number to the newly created company
      * Read the customer and then Company 360, & then create 363 & 364
      * Cnv Comp Cust  -  Co 362 - Customer  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Cnv Comp Cust  -  Co 362 - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@BBREE9                    *
     C                     READ @BBREE9                  90*
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Reading the Customer and now go after the company customer - 360
     C                     Z-ADD360       YL0001           Company Number
      * Cnv Co/Customer 360-newRT - Company Customer  * 
     C                     EXSR SBRVGN
     C                     READ @BBREE9                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Cnv Co/Customer 360-newRT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDYL0001    WBAIC3           Company Number
     C                     Z-ADDWABKC7    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSB     CHAIN@EOREXM              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Account info-Co/ShpRT - Company Customer G/L  * 
     C                     EXSR SCRVGN
      * Read 360 and now see if we need to create 362 and if so create 36
      * ** Missoula
     C                     Z-ADD363       WUAIC3           Company Number
     C                     MOVEL'MS1'     WUAJCD           Warehouse Code
     C                     MOVEL'N'       WUQ8ST           Default Shippin
     C                     Z-ADD*ZERO     WUTBNB           Absorbed Freigh
      * Cnv Company Cust new - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0001           Company Number
     C                     Z-ADDWBBKC7    WL0002           Ship To Custome
     C                     MOVELWBAQCD    WL0003    P      Terms Code
     C                     MOVELWBR4CD    WL0004    P      Sales Route Cod
     C                     MOVELWBBYNA    WL0005    P      Special Instruc
     C                     MOVELWBB6NA    WL0006    P      Special Instruc
     C                     MOVELWBBZNA    WL0007    P      Carrier Code
     C                     MOVELWBLLST    WL0008    P      Broker
     C                     MOVELWBPPST    WL0009    P      P.O. Required F
     C                     Z-ADDWBR5NB    WL0010           Deliver after t
     C                     Z-ADDWBR6NB    WL0011           Deliver before
     C                     MOVELWBQGST    WL0012    P      Alt Remittance
     C                     MOVELWBBOCD    WL0013    P      Type Code
     C                     Z-ADDWUTBNB    WL0014           Absorbed Freigh
     C                     Z-ADDWBMTCU    WL0015           Mileage To Cust
     C                     Z-ADDWBW2NB    WL0016           Co/Cust Overage
     C                     MOVELWBRPCD    WL0017    P      Age Code
     C                     MOVELWUAJCD    WL0018    P      Warehouse Code
     C                     MOVELWBX9ST    WL0019    P      Outside Warehou
     C                     MOVELWBT9CD    WL0020    P      Customer Group
     C                     MOVELWBUBCD    WL0021    P      Customer Group
     C                     MOVELWBISTX    WL0022    P      G/L Code
     C                     MOVELWBLQCD    WL0023    P      Commodity Marke
     C                     MOVELWBNJNA    WL0024    P      Credit Contact
     C                     MOVELWBI0TX    WL0025    P      Credit Contact
     C                     MOVELWBNKNA    WL0026    P      Credit Contact
     C                     MOVELWBI1TX    WL0027    P      Credit Contact
     C                     MOVELWBVLST    WL0028    P      Allow Man/Qt WO
     C                     MOVELWBRLST    WL0029    P      Fax Invoice Fla
     C                     MOVELWBMMTX    WL0030    P      Fax Invoice Fax
     C                     MOVELWBOHNA    WL0031    P      Fax Invoice Con
     C                     MOVELWBQ6ST    WL0032    P      Distributor
     C                     MOVELWUQ8ST    WL0033    P      Default Shippin
     C                     MOVELWBRBST    WL0034    P      Unused Co/Cust
     C                     MOVELWBREST    WL0035    P      Unused Co/Cust
     C                     MOVELWBUVST    WL0036    P      EDI Status 1
     C                     MOVELWBUWST    WL0037    P      EDI Status 2
     C                     MOVELWBUXST    WL0038    P      EDI Status 3
     C                     MOVELWBVSST    WL0039    P      Record Status
     C                     Z-ADDWAANC7    WL0040           A/R Customer Nu
     C                     Z-ADDWUOOVA    WL0041           Extra Amount 1
     C                     Z-ADDWUZBNB    WL0042           Extra Number 1
     C                     MOVELWUSNST    WL0043    P      Extra Status 1
     C                     MOVELWUAVNB    WL0044    P      G/L Account for
     C                     MOVELWUDSCD    WL0045    P      G/L Sub Account
     C                     EXSR SDRVGN
      * ** Salt Lake City
     C                     Z-ADD364       WUAIC3           Company Number
     C                     MOVEL'SL1'     WUAJCD           Warehouse Code
     C                     MOVEL'N'       WUQ8ST           Default Shippin
     C                     Z-ADD*ZERO     WUTBNB           Absorbed Freigh
      * Cnv Company Cust new - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0001           Company Number
     C                     Z-ADDWBBKC7    WL0002           Ship To Custome
     C                     MOVELWBAQCD    WL0003    P      Terms Code
     C                     MOVELWBR4CD    WL0004    P      Sales Route Cod
     C                     MOVELWBBYNA    WL0005    P      Special Instruc
     C                     MOVELWBB6NA    WL0006    P      Special Instruc
     C                     MOVELWBBZNA    WL0007    P      Carrier Code
     C                     MOVELWBLLST    WL0008    P      Broker
     C                     MOVELWBPPST    WL0009    P      P.O. Required F
     C                     Z-ADDWBR5NB    WL0010           Deliver after t
     C                     Z-ADDWBR6NB    WL0011           Deliver before
     C                     MOVELWBQGST    WL0012    P      Alt Remittance
     C                     MOVELWBBOCD    WL0013    P      Type Code
     C                     Z-ADDWUTBNB    WL0014           Absorbed Freigh
     C                     Z-ADDWBMTCU    WL0015           Mileage To Cust
     C                     Z-ADDWBW2NB    WL0016           Co/Cust Overage
     C                     MOVELWBRPCD    WL0017    P      Age Code
     C                     MOVELWUAJCD    WL0018    P      Warehouse Code
     C                     MOVELWBX9ST    WL0019    P      Outside Warehou
     C                     MOVELWBT9CD    WL0020    P      Customer Group
     C                     MOVELWBUBCD    WL0021    P      Customer Group
     C                     MOVELWBISTX    WL0022    P      G/L Code
     C                     MOVELWBLQCD    WL0023    P      Commodity Marke
     C                     MOVELWBNJNA    WL0024    P      Credit Contact
     C                     MOVELWBI0TX    WL0025    P      Credit Contact
     C                     MOVELWBNKNA    WL0026    P      Credit Contact
     C                     MOVELWBI1TX    WL0027    P      Credit Contact
     C                     MOVELWBVLST    WL0028    P      Allow Man/Qt WO
     C                     MOVELWBRLST    WL0029    P      Fax Invoice Fla
     C                     MOVELWBMMTX    WL0030    P      Fax Invoice Fax
     C                     MOVELWBOHNA    WL0031    P      Fax Invoice Con
     C                     MOVELWBQ6ST    WL0032    P      Distributor
     C                     MOVELWUQ8ST    WL0033    P      Default Shippin
     C                     MOVELWBRBST    WL0034    P      Unused Co/Cust
     C                     MOVELWBREST    WL0035    P      Unused Co/Cust
     C                     MOVELWBUVST    WL0036    P      EDI Status 1
     C                     MOVELWBUWST    WL0037    P      EDI Status 2
     C                     MOVELWBUXST    WL0038    P      EDI Status 3
     C                     MOVELWBVSST    WL0039    P      Record Status
     C                     Z-ADDWAANC7    WL0040           A/R Customer Nu
     C                     Z-ADDWUOOVA    WL0041           Extra Amount 1
     C                     Z-ADDWUZBNB    WL0042           Extra Number 1
     C                     MOVELWUSNST    WL0043    P      Extra Status 1
     C                     MOVELWUAVNB    WL0044    P      G/L Account for
     C                     MOVELWUDSCD    WL0045    P      G/L Sub Account
     C                     EXSR SDRVGN
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Account info-Co/ShpRT - Company Customer G/L  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBBKC7    WCBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@GZCPIH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1444' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUOOVA           Extra Amount 1
     C                     Z-ADD*ZERO     WUZBNB           Extra Number 1
     C                     MOVEL*BLANK    WUSNST           Extra Status 1
     C                     MOVEL*BLANK    WUAVNB           G/L Account for
     C                     MOVEL*BLANK    WUDSCD           G/L Sub Account
     C                     MOVEL*BLANK    WUAVNB           G/L Account for
     C                     MOVEL*BLANK    WUDSCD           G/L Sub Account
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCOOVA    WUOOVA           Extra Amount 1
     C                     Z-ADDWCZBNB    WUZBNB           Extra Number 1
     C                     MOVELWCSNST    WUSNST           Extra Status 1
     C                     MOVELWCAVNB    WUAVNB           G/L Account for
     C                     MOVELWCDSCD    WUDSCD           G/L Sub Account
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Cnv Company Cust new - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * Have created this RTV to only create record
      * CRT Co/Cust w/G/L PlnCVCR - Company Customer  * 
     C                     EXSR SECRRC
      * Automatically create A/R Summary after new Company/Customer
      * WRK.Current Month = JOB.*Job date *MONTH
     C           ##JDT     ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUCUMO
      * RTV Salesman Code      RT - Sales Route  * 
     C                     EXSR SHRVGN
      * Create A/R Summary for A/R Customers only
      * CASE: PAR.Ship To Customer EQ PAR.A/R Customer Number
     C           WL0002    IFEQ WL0040                     *IF
      * CRT A/R Summary        CR - A/R Summary  * 
     C                     EXSR SICRRC
     C                     END                             *FI
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * if the record does not exits - this will stop error on record
      * exits
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SDEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * CRT Co/Cust w/G/L PlnCVCR - Company Customer  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EOREXL
     C                     Z-ADDWL0001    WDAIC3           Company Number
     C                     Z-ADDWL0002    WDBKC7           Ship To Custome
     C                     MOVELWL0003    WDAQCD           Terms Code
     C                     MOVELWL0004    WDR4CD           Sales Route Cod
     C                     MOVELWL0005    WDBYNA           Special Instruc
     C                     MOVELWL0006    WDB6NA           Special Instruc
     C                     MOVELWL0007    WDBZNA           Carrier Code
     C                     MOVELWL0008    WDLLST           Broker
     C                     MOVELWL0009    WDPPST           P.O. Required F
     C                     Z-ADDWL0010    WDR5NB           Deliver after t
     C                     Z-ADDWL0011    WDR6NB           Deliver before
     C                     MOVELWL0012    WDQGST           Alt Remittance
     C                     MOVELWL0013    WDBOCD           Type Code
     C                     Z-ADDWL0014    WDTBNB           Absorbed Freigh
     C                     Z-ADDWL0015    WDMTCU           Mileage To Cust
     C                     Z-ADDWL0016    WDW2NB           Co/Cust Overage
     C                     MOVELWL0017    WDRPCD           Age Code
     C                     MOVELWL0018    WDAJCD           Warehouse Code
     C                     MOVELWL0019    WDX9ST           Outside Warehou
     C                     MOVELWL0020    WDT9CD           Customer Group
     C                     MOVELWL0021    WDUBCD           Customer Group
     C                     MOVELWL0022    WDISTX           G/L Code
     C                     MOVELWL0023    WDLQCD           Commodity Marke
     C                     MOVELWL0024    WDNJNA           Credit Contact
     C                     MOVELWL0025    WDI0TX           Credit Contact
     C                     MOVELWL0026    WDNKNA           Credit Contact
     C                     MOVELWL0027    WDI1TX           Credit Contact
     C                     MOVELWL0028    WDVLST           Allow Man/Qt WO
     C                     MOVELWL0029    WDRLST           Fax Invoice Fla
     C                     MOVELWL0030    WDMMTX           Fax Invoice Fax
     C                     MOVELWL0031    WDOHNA           Fax Invoice Con
     C                     MOVELWL0032    WDQ6ST           Distributor
     C                     MOVELWL0033    WDQ8ST           Default Shippin
     C                     MOVELWL0034    WDRBST           Unused Co/Cust
     C                     MOVELWL0035    WDREST           Unused Co/Cust
     C                     MOVELWL0036    WDUVST           EDI Status 1
     C                     MOVELWL0037    WDUWST           EDI Status 2
     C                     MOVELWL0038    WDUXST           EDI Status 3
     C                     MOVELWL0039    WDVSST           Record Status
      *
      * USER: Processing before Data update
     C                     MOVEL*BLANK    WDRPCD           Age Code
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAATM' defaulted for 'Job Time'.
      * Field '(DB1) WDAYNA' defaulted for 'User Id'.
      * Field '(DB1) WDA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WDAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C                     Z-ADD*ZERO     YL0002           A/R Customer Nu
     C           KLCRSE    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDBKC7           Ship To Custome
      * Check for duplicate primary key
     C           KLCRSE    SETLL@EOREXL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1008' W0RTN   7
      * Send message 'Company Customer       EX'
     C                     MOVEL'USR1008' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@EOREXL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CHG OM Company/Cust    CH - Company Customer G/L  * 
     C                     EXSR SFCHRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG OM Company/Cust    CH - Company Customer G/L  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  60       Job Time
     C                     MOVEL*BLANK    WN0006 10        User Id
     C                     MOVEL*BLANK    WN0007 10        Job Name
     C                     Z-ADD*ZERO     WN0008  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) WN0005' defaulted for 'Job Time'.
      * Field '(PAR) WN0006' defaulted for 'User Id'.
      * Field '(PAR) WN0007' defaulted for 'Job Name'.
      * Field '(PAR) WN0008' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WN0005           Job Time
     C                     MOVEL##USR     WN0006           User Id
     C                     MOVEL##JOB     WN0007           Job Name
     C                     Z-ADD##JDT     WN0008           Job Date
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @GZCPIG
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDBKC7    WEBKC7           Ship To Custome
      *
     C           KLCHSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEBKC7           Ship To Custome
     C           KLCHSF    CHAIN@GZCPIG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * CRT OM Company/Cust    CR - OM Company/Customer G/L  * 
     C                     EXSR SGCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMGZCPL0'MDACP
     C                     MOVEL'@GZCPIG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMGZ1    YARDCS
      * Move non-key fields to @GZCPIG
     C                     Z-ADDWL0041    WEOOVA           Extra Amount 1
     C                     Z-ADDWL0042    WEZBNB           Extra Number 1
     C                     MOVELWL0043    WESNST    P      Extra Status 1
     C                     MOVELWL0044    WEAVNB    P      G/L Account for
     C                     MOVELWL0045    WEDSCD    P      G/L Sub Account
     C                     MOVELWDUVST    WEUVST    P      EDI Status 1
     C                     MOVELWDUWST    WEUWST    P      EDI Status 2
     C                     MOVELWDUXST    WEUXST    P      EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C           QOMGZ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@GZCPIG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMGZCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * CRT OM Company/Cust    CR - OM Company/Customer G/L  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0009  60       Job Time
     C                     MOVEL*BLANK    WN0010 10        User Id
     C                     MOVEL*BLANK    WN0011 10        Job Name
     C                     Z-ADD*ZERO     WN0012  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @GZCPIG
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDBKC7    WEBKC7           Ship To Custome
     C                     Z-ADDWL0041    WEOOVA           Extra Amount 1
     C                     Z-ADDWL0042    WEZBNB           Extra Number 1
     C                     MOVELWL0043    WESNST           Extra Status 1
     C                     MOVELWL0044    WEAVNB           G/L Account for
     C                     MOVELWL0045    WEDSCD           G/L Sub Account
     C                     MOVELWDUVST    WEUVST           EDI Status 1
     C                     MOVELWDUWST    WEUWST           EDI Status 2
     C                     MOVELWDUXST    WEUXST           EDI Status 3
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WEAATM' defaulted for 'Job Time'.
      * Field '(DB1) WEAYNA' defaulted for 'User Id'.
      * Field '(DB1) WEA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WEAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSG    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEBKC7           Ship To Custome
      * Check for duplicate primary key
     C           KLCRSG    SETLL@GZCPIG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1445' W0RTN   7
      * Send message 'Company Customer G/L   EX'
     C                     MOVEL'USR1445' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@GZCPIG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WFR4CD           Sales Route Cod
      * Setup key
     C                     MOVELWL0004    WFR4CD           Sales Route Cod
      * Establish starting position
     C           KRSSH     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Salesperson Cod
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFBCCD    YL0003           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * CRT A/R Summary        CR - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0013  60       Job Time
     C                     MOVEL*BLANK    WN0014 10        User Id
     C                     MOVEL*BLANK    WN0015 10        Job Name
     C                     Z-ADD*ZERO     WN0016  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCREFD
     C                     Z-ADDWL0001    WGAIC3           Company Number
     C                     Z-ADDWL0002    WGANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WGAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WGACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WGADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WGAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WGAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WGAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WGVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WGVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WGVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WGVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WGVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WGVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WGEEVA           Value of Open O
     C                     Z-ADD*ZERO     WGAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WGAHDT           Date of First S
     C                     Z-ADD*ZERO     WGANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WGANVA           Amount of Last
     C                     Z-ADD*ZERO     WGALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WGAMVA           Amount of Last
     C                     Z-ADD*ZERO     WGAIDT           Date of Highest
     C                     Z-ADD*ZERO     WGALVA           Amount of Highe
     C                     Z-ADD*ZERO     WGDJNB           Number of Invoi
     C                     Z-ADD*ZERO     WGDLNB           Number of Order
     C                     Z-ADD*ZERO     WGDDNB           Number of Credi
     C                     Z-ADD*ZERO     WGDMNB           Number of Payme
     C                     Z-ADD*ZERO     WGDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WGLYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WGLYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WGLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WGLYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WGADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WGVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WGBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WGBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WGVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WGVQVA           Last Year Sales
     C                     MOVELYL0003    WGBCCD           Salesperson Cod
     C                     MOVELWL0004    WGR4CD           Sales Route Cod
     C                     Z-ADDWUCUMO    WGCUMO           Current Month
     C                     MOVELWL0036    WGUVST           EDI Status 1
     C                     MOVELWL0037    WGUWST           EDI Status 2
     C                     MOVELWL0038    WGUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRSI    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGANC7           A/R Customer Nu
      * Check for duplicate primary key
     C           KLCRSI    SETLL@BCREFD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0173' W0RTN   7
      * Send message 'A/R Summary            EX'
     C                     MOVEL'USR0173' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@BCREFD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D & B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBR5NB           Deliver after t
     C                     Z-ADD*ZERO     WBR6NB           Deliver before
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WBW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Extra Amount 1
     C                     Z-ADD*ZERO     WUOOVA 112
      * Define work field Extra Number 1
     C                     Z-ADD*ZERO     WUZBNB  50
      * Define work field Extra Status 1
     C                     MOVEL*BLANK    WUSNST  1
      * Define work field G/L Account for Dr
     C                     MOVEL*BLANK    WUAVNB  6
      * Define work field G/L Sub Account
     C                     MOVEL*BLANK    WUDSCD  8
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCOOVA           Extra Amount 1
     C                     Z-ADD*ZERO     WCZBNB           Extra Number 1
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Default Shipping Co Sts
     C                     MOVEL*BLANK    WUQ8ST  1
      * Define work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     WUTBNB  52
      * Clear all neither parameters
      * CRT Co/Cust w/G/L PlnCVCR - Company Customer  * 
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Clear all neither parameters
      * CRT OM Company/Cust    CR - OM Company/Customer G/L  * 
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Current Month
     C                     Z-ADD*ZERO     WUCUMO  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WGAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WGACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WGADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WGAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WGAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WGAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WGVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WGVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WGVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WGVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WGVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WGVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WGEEVA           Value of Open O
     C                     Z-ADD*ZERO     WGAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WGAHDT           Date of First S
     C                     Z-ADD*ZERO     WGANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WGANVA           Amount of Last
     C                     Z-ADD*ZERO     WGALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WGAMVA           Amount of Last
     C                     Z-ADD*ZERO     WGAIDT           Date of Highest
     C                     Z-ADD*ZERO     WGALVA           Amount of Highe
     C                     Z-ADD*ZERO     WGDJNB           Number of Invoi
     C                     Z-ADD*ZERO     WGDLNB           Number of Order
     C                     Z-ADD*ZERO     WGDDNB           Number of Credi
     C                     Z-ADD*ZERO     WGDMNB           Number of Payme
     C                     Z-ADD*ZERO     WGDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WGLYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WGLYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WGLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WGLYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WGADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WGVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WGBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WGBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WGVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WGVQVA           Last Year Sales
     C                     Z-ADD*ZERO     WGCUMO           Current Month
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     MOVEL*BLANK    WL0004  3
     C                     MOVEL*BLANK    WL0005 40
     C                     MOVEL*BLANK    WL0006 40
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009  1
     C                     Z-ADD*ZERO     WL0010  40
     C                     Z-ADD*ZERO     WL0011  40
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  2
     C                     Z-ADD*ZERO     WL0014  52
     C                     Z-ADD*ZERO     WL0015  92
     C                     Z-ADD*ZERO     WL0016 112
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  3
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  3
     C                     MOVEL*BLANK    WL0021  3
     C                     MOVEL*BLANK    WL0022  8
     C                     MOVEL*BLANK    WL0023  3
     C                     MOVEL*BLANK    WL0024 30
     C                     MOVEL*BLANK    WL0025 25
     C                     MOVEL*BLANK    WL0026 30
     C                     MOVEL*BLANK    WL0027 25
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030 25
     C                     MOVEL*BLANK    WL0031 30
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  1
     C                     MOVEL*BLANK    WL0039  1
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041 112
     C                     Z-ADD*ZERO     WL0042  50
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044  6
     C                     MOVEL*BLANK    WL0045  8
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0003  3
      *================================================================
     CSR         ZZEXIT    ENDSR
