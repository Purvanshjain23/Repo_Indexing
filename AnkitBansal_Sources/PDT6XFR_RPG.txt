     H/TITLE Rtv Hog Pop Hdg 4 HPE XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 05/06/09  Time  : 11:13:28
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDI0REL1IF  E           K        DISK
      * RTV : PS Cutout Matrix          Retrieval index
      *
     FPDJ0REL2IF  E           K        DISK
      * RSQ : PS Cutout Dist Backfat    Co/Mts/MoDy/BF Sts=A
      *
     FPDIZREL3IF  E           K        DISK
      * RSQ : PS Cutout Dist Lean %     Co/Mtx/MoDy/Ln%(d) Sts=A
      *
     FPDJ1REL2IF  E           K        DISK
      * RSQ : PS Cutout Dist Loin-Eye   Co/Mtx/MoDy/LE(d) Sts=A
      *
     I@I0RES3
      * PS Cutout Matrix          Retrieval index
      * Renamed input format fields
     I              I0AIC3                          WAAIC3
     I              I0RXCD                          WARXCD
     I              I0GHDT                          WAGHDT
     I              I0MXNA                          WAMXNA
     I              I0VTST                          WAVTST
     I              I0VUST                          WAVUST
     I              I0UVST                          WAUVST
     I              I0UWST                          WAUWST
     I              I0UXST                          WAUXST
     I              I0VSST                          WAVSST
     I              I0AATM                          WAAATM
     I              I0AYNA                          WAAYNA
     I              I0A0NA                          WAA0NA
     I              I0AXDT                          WAAXDT
      *
     I@J0REDA
      * PS Cutout Dist Backfat    Co/Mts/MoDy/BF Sts=A
      * Renamed input format fields
     I              J0AIC3                          WBAIC3
     I              J0RXCD                          WBRXCD
     I              J0GHDT                          WBGHDT
     I              J0UPNB                          WBUPNB
     I              J0UQNB                          WBUQNB
     I              J0BFIN                          WBBFIN
     I              J0UNNB                          WBUNNB
     I              J0UONB                          WBUONB
     I              J0DIPC                          WBDIPC
     I              J0Z0NB                          WBZ0NB
     I              J0AVLE                          WBAVLE
     I              J0QPNX                          WBQPNX
     I              J0UVST                          WBUVST
     I              J0UWST                          WBUWST
     I              J0UXST                          WBUXST
     I              J0VSST                          WBVSST
     I              J0AATM                          WBAATM
     I              J0AYNA                          WBAYNA
     I              J0A0NA                          WBA0NA
     I              J0AXDT                          WBAXDT
      *
     I@IZREC9
      * PS Cutout Dist Lean %     Co/Mtx/MoDy/Ln%(d) Sts=A
      * Renamed input format fields
     I              IZAIC3                          WCAIC3
     I              IZRXCD                          WCRXCD
     I              IZGHDT                          WCGHDT
     I              IZUPNB                          WCUPNB
     I              IZUQNB                          WCUQNB
     I              IZULNB                          WCULNB
     I              IZUNNB                          WCUNNB
     I              IZUONB                          WCUONB
     I              IZDIPC                          WCDIPC
     I              IZZ0NB                          WCZ0NB
     I              IZAVLE                          WCAVLE
     I              IZQPNX                          WCQPNX
     I              IZUVST                          WCUVST
     I              IZUWST                          WCUWST
     I              IZUXST                          WCUXST
     I              IZVSST                          WCVSST
     I              IZAATM                          WCAATM
     I              IZAYNA                          WCAYNA
     I              IZA0NA                          WCA0NA
     I              IZAXDT                          WCAXDT
      *
     I@J1REDB
      * PS Cutout Dist Loin-Eye   Co/Mtx/MoDy/LE(d) Sts=A
      * Renamed input format fields
     I              J1AIC3                          WDAIC3
     I              J1RXCD                          WDRXCD
     I              J1GHDT                          WDGHDT
     I              J1UPNB                          WDUPNB
     I              J1UQNB                          WDUQNB
     I              J1LEDP                          WDLEDP
     I              J1UVST                          WDUVST
     I              J1UWST                          WDUWST
     I              J1UXST                          WDUXST
     I              J1VSST                          WDVSST
     I              J1AATM                          WDAATM
     I              J1AYNA                          WDAYNA
     I              J1A0NA                          WDA0NA
     I              J1AXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  HPE Hog Pop Hdg Type USR
     I                                        1   1 P1HPHT
      * I :  Company Number
     I                                    P   2   30P1AIC3
      * I :  Kill Date
     I                                    P   4   70P1GGDT
      * O :  HPE Hog Pop Hdg 1 USR
     I                                    P   8   91P1HPH1
      * O :  HPE Hog Pop Hdg 2 USR
     I                                    P  10  111P1HPH2
      * O :  HPE Hog Pop Hdg 3 USR
     I                                    P  12  131P1HPH3
      * O :  HPE Hog Pop Hdg 4 USR
     I                                    P  14  151P1HPH4
      * O :  HPE Hog Pop Hdg 5 USR
     I                                    P  16  171P1HPH5
      * O :  HPE Hog Pop Hdg 6 USR
     I                                    P  18  191P1HPH6
      * O :  HPE Hog Pop Hdg 7 USR
     I                                    P  20  211P1HPH7
      * O :  HPE Hog Pop Hdg 8 USR
     I                                    P  22  231P1HPH8
      * O :  HPE Hog Pop Hdg 9 USR
     I                                    P  24  251P1HPH9
      * O :  HPE Hog Pop Hdg 10 USR
     I                                    P  26  271P1HP10
      * O :  HPE Hog Pop Hdg 11 USR
     I                                    P  28  291P1HP11
      * O :  HPE Hog Pop Hdg 12 USR
     I                                    P  30  311P1HP12
      * O :  HPE Hog Pop Hdg 13 USR
     I                                    P  32  331P1HP13
      * O :  HPE Hog Pop Hdg 14 USR
     I                                    P  34  351P1HP14
      * O :  HPE Hog Pop Hdg 15 USR
     I                                    P  36  371P1HP15
      * O :  HPE Hog Pop Hdg 16 USR
     I                                    P  38  391P1HP16
      * O :  HPE Hog Pop Hdg 17 USR
     I                                    P  40  411P1HP17
      * O :  HPE Hog Pop Hdg 18 USR
     I                                    P  42  431P1HP18
      * O :  HPE Hog Pop Hdg 19 USR
     I                                    P  44  451P1HP19
     IP2PARM      DS
      * FLD: PS Cutout Matrix
      * I :  Cutout Matrix Code
     I                                        1   6 P2RXCD
      * I :  Effective Month/Day
     I                                    P   7   90P2GHDT
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HPHT    PARM           WP0001  1        HPE Hog Pop Hdg
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1GGDT    PARM           WP0003  70       Kill Date
     C           P1HPH1    PARM P1HPH1    WP0004  31       HPE Hog Pop Hdg
     C           P1HPH2    PARM P1HPH2    WP0005  31       HPE Hog Pop Hdg
     C           P1HPH3    PARM P1HPH3    WP0006  31       HPE Hog Pop Hdg
     C           P1HPH4    PARM P1HPH4    WP0007  31       HPE Hog Pop Hdg
     C           P1HPH5    PARM P1HPH5    WP0008  31       HPE Hog Pop Hdg
     C           P1HPH6    PARM P1HPH6    WP0009  31       HPE Hog Pop Hdg
     C           P1HPH7    PARM P1HPH7    WP0010  31       HPE Hog Pop Hdg
     C           P1HPH8    PARM P1HPH8    WP0011  31       HPE Hog Pop Hdg
     C           P1HPH9    PARM P1HPH9    WP0012  31       HPE Hog Pop Hdg
     C           P1HP10    PARM P1HP10    WP0013  31       HPE Hog Pop Hdg
     C           P1HP11    PARM P1HP11    WP0014  31       HPE Hog Pop Hdg
     C           P1HP12    PARM P1HP12    WP0015  31       HPE Hog Pop Hdg
     C           P1HP13    PARM P1HP13    WP0016  31       HPE Hog Pop Hdg
     C           P1HP14    PARM P1HP14    WP0017  31       HPE Hog Pop Hdg
     C           P1HP15    PARM P1HP15    WP0018  31       HPE Hog Pop Hdg
     C           P1HP16    PARM P1HP16    WP0019  31       HPE Hog Pop Hdg
     C           P1HP17    PARM P1HP17    WP0020  31       HPE Hog Pop Hdg
     C           P1HP18    PARM P1HP18    WP0021  31       HPE Hog Pop Hdg
     C           P1HP19    PARM P1HP19    WP0022  31       HPE Hog Pop Hdg
     C           P2RXCD    PARM           WP0023  6        Cutout Matrix C
     C           P2GHDT    PARM           WP0024  40       Effective Month
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Rtv Hog Pop Hdg 4 HPE XF
      * Rtv Hog Pop Hdg 4 HPE RT - PS Cutout Matrix  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Hog Pop Hdg 4 HPE RT - PS Cutout Matrix  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     P1HPH1           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HPH2           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HPH3           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HPH4           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HPH5           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HPH6           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HPH7           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HPH8           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HPH9           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HP10           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HP11           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HP12           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HP13           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HP14           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HP15           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HP16           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HP17           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HP18           HPE Hog Pop Hdg
     C                     Z-ADD*ZERO     P1HP19           HPE Hog Pop Hdg
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WARXCD           Cutout Matrix C
     C                     KFLD           WAGHDT           Effective Month
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     MOVELP2RXCD    WARXCD           Cutout Matrix C
     C                     Z-ADDP2GHDT    WAGHDT           Effective Month
      * Establish starting position
     C           KRSSA     CHAIN@I0RES3              90    *
      * Data record not found
     C   90                MOVEL'USR1722' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: PAR.HPE Hog Pop Hdg Type USR is Backfat
     C           P1HPHT    IFEQ 'B'                        *IF
      * Rtv Bckfat Hdgs 4 HPE RT - PS Cutout Dist Backfat  * 
     C                     EXSR SBRVGN
     C                     ELSE
      * CASE: PAR.HPE Hog Pop Hdg Type USR is Lean %
     C           P1HPHT    IFEQ 'P'                        *IF
      * Rtv Lean % Hdgs 4 HPE RT - PS Cutout Dist Lean %  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: PAR.HPE Hog Pop Hdg Type USR is Loin Eye
     C           P1HPHT    IFEQ 'E'                        *IF
      * Rtv LoinEy Hdgs 4 HPE Rt - PS Cutout Dist Loin-Eye  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Bckfat Hdgs 4 HPE RT - PS Cutout Dist Backfat  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD1         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBRXCD    WQSB02           Cutout Matrix C
     C           *LIKE     DEFN WBGHDT    WQSB03           Effective Month
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Cutout Matrix C
     C                     KFLD           WQSB03           Effective Month
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     MOVELWARXCD    WQSB02           Cutout Matrix C
     C                     Z-ADDWAGHDT    WQSB03           Effective Month
      * Establish starting position
     C           KRSSB     SETLL@J0REDA                    *
     C           KRSSB     READE@J0REDA                  90*
      * Data record not found
     C   90                MOVEL'USR2035' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWBBFIN    WUBFIN           Backfat Inches
     C                     Z-ADDWBBFIN    P1HPH1           HPE Hog Pop Hdg
     C                     ADD  1         WUCNTU           Count USR
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Backfat Inches NE DB1.Backfat Inches
     C           WUBFIN    IFNE WBBFIN                     *IF
      * Move DB1 to PAR (2 - 19)
      * CASE: WRK.Count USR is Two
     C           WUCNTU    IFEQ 2                          *IF
     C                     Z-ADDWBBFIN    P1HPH2           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDWBBFIN    P1HPH3           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Four
     C           WUCNTU    IFEQ 4                          *IF
     C                     Z-ADDWBBFIN    P1HPH4           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Five
     C           WUCNTU    IFEQ 5                          *IF
     C                     Z-ADDWBBFIN    P1HPH5           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Six
     C           WUCNTU    IFEQ 6                          *IF
     C                     Z-ADDWBBFIN    P1HPH6           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Seven
     C           WUCNTU    IFEQ 7                          *IF
     C                     Z-ADDWBBFIN    P1HPH7           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Eight
     C           WUCNTU    IFEQ 8                          *IF
     C                     Z-ADDWBBFIN    P1HPH8           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Nine
     C           WUCNTU    IFEQ 9                          *IF
     C                     Z-ADDWBBFIN    P1HPH9           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Ten
     C           WUCNTU    IFEQ 10                         *IF
     C                     Z-ADDWBBFIN    P1HP10           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Eleven
     C           WUCNTU    IFEQ 11                         *IF
     C                     Z-ADDWBBFIN    P1HP11           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Twelve
     C           WUCNTU    IFEQ 12                         *IF
     C                     Z-ADDWBBFIN    P1HP12           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Thirteen
     C           WUCNTU    IFEQ 13                         *IF
     C                     Z-ADDWBBFIN    P1HP13           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Fourteen
     C           WUCNTU    IFEQ 14                         *IF
     C                     Z-ADDWBBFIN    P1HP14           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Fifteen
     C           WUCNTU    IFEQ 15                         *IF
     C                     Z-ADDWBBFIN    P1HP15           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Sixteen
     C           WUCNTU    IFEQ 16                         *IF
     C                     Z-ADDWBBFIN    P1HP16           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Seventeen
     C           WUCNTU    IFEQ 17                         *IF
     C                     Z-ADDWBBFIN    P1HP17           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Eighteen
     C           WUCNTU    IFEQ 18                         *IF
     C                     Z-ADDWBBFIN    P1HP18           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Nineteen
     C           WUCNTU    IFEQ 19                         *IF
     C                     Z-ADDWBBFIN    P1HP19           HPE Hog Pop Hdg
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWBBFIN    WUBFIN           Backfat Inches
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@J0REDA                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Lean % Hdgs 4 HPE RT - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD1         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCRXCD    WQSC02           Cutout Matrix C
     C           *LIKE     DEFN WCGHDT    WQSC03           Effective Month
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Cutout Matrix C
     C                     KFLD           WQSC03           Effective Month
      * Setup key
     C                     Z-ADDWAAIC3    WQSC01           Company Number
     C                     MOVELWARXCD    WQSC02           Cutout Matrix C
     C                     Z-ADDWAGHDT    WQSC03           Effective Month
      * Establish starting position
     C           KRSSC     SETLL@IZREC9                    *
     C           KRSSC     READE@IZREC9                  90*
      * Data record not found
     C   90                MOVEL'USR1720' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWCULNB    WUULNB           Lean Percent
     C                     Z-ADDWCULNB    P1HPH1           HPE Hog Pop Hdg
     C                     ADD  1         WUCNTU           Count USR
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Lean Percent NE DB1.Lean Percent
     C           WUULNB    IFNE WCULNB                     *IF
      * Move DB1 to PAR (2 - 19)
      * CASE: WRK.Count USR is Two
     C           WUCNTU    IFEQ 2                          *IF
     C                     Z-ADDWCULNB    P1HPH2           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDWCULNB    P1HPH3           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Four
     C           WUCNTU    IFEQ 4                          *IF
     C                     Z-ADDWCULNB    P1HPH4           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Five
     C           WUCNTU    IFEQ 5                          *IF
     C                     Z-ADDWCULNB    P1HPH5           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Six
     C           WUCNTU    IFEQ 6                          *IF
     C                     Z-ADDWCULNB    P1HPH6           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Seven
     C           WUCNTU    IFEQ 7                          *IF
     C                     Z-ADDWCULNB    P1HPH7           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Eight
     C           WUCNTU    IFEQ 8                          *IF
     C                     Z-ADDWCULNB    P1HPH8           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Nine
     C           WUCNTU    IFEQ 9                          *IF
     C                     Z-ADDWCULNB    P1HPH9           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Ten
     C           WUCNTU    IFEQ 10                         *IF
     C                     Z-ADDWCULNB    P1HP10           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Eleven
     C           WUCNTU    IFEQ 11                         *IF
     C                     Z-ADDWCULNB    P1HP11           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Twelve
     C           WUCNTU    IFEQ 12                         *IF
     C                     Z-ADDWCULNB    P1HP12           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Thirteen
     C           WUCNTU    IFEQ 13                         *IF
     C                     Z-ADDWCULNB    P1HP13           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Fourteen
     C           WUCNTU    IFEQ 14                         *IF
     C                     Z-ADDWCULNB    P1HP14           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Fifteen
     C           WUCNTU    IFEQ 15                         *IF
     C                     Z-ADDWCULNB    P1HP15           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Sixteen
     C           WUCNTU    IFEQ 16                         *IF
     C                     Z-ADDWCULNB    P1HP16           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Seventeen
     C           WUCNTU    IFEQ 17                         *IF
     C                     Z-ADDWCULNB    P1HP17           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Eighteen
     C           WUCNTU    IFEQ 18                         *IF
     C                     Z-ADDWCULNB    P1HP18           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Nineteen
     C           WUCNTU    IFEQ 19                         *IF
     C                     Z-ADDWCULNB    P1HP19           HPE Hog Pop Hdg
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWCULNB    WUULNB           Lean Percent
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@IZREC9                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv LoinEy Hdgs 4 HPE Rt - PS Cutout Dist Loin-Eye  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD1         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDRXCD    WQSD02           Cutout Matrix C
     C           *LIKE     DEFN WDGHDT    WQSD03           Effective Month
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Cutout Matrix C
     C                     KFLD           WQSD03           Effective Month
      * Setup key
     C                     Z-ADDWAAIC3    WQSD01           Company Number
     C                     MOVELWARXCD    WQSD02           Cutout Matrix C
     C                     Z-ADDWAGHDT    WQSD03           Effective Month
      * Establish starting position
     C           KRSSD     SETLL@J1REDB                    *
     C           KRSSD     READE@J1REDB                  90*
      * Data record not found
     C   90                MOVEL'USR2037' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWDLEDP    WULEDP           Loin-Eye Depth
     C                     Z-ADDWDLEDP    P1HPH1           HPE Hog Pop Hdg
     C                     ADD  1         WUCNTU           Count USR
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Loin-Eye Depth NE DB1.Loin-Eye Depth
     C           WULEDP    IFNE WDLEDP                     *IF
      * Move DB1 to PAR (2 - 19)
      * CASE: WRK.Count USR is Two
     C           WUCNTU    IFEQ 2                          *IF
     C                     Z-ADDWDLEDP    P1HPH2           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDWDLEDP    P1HPH3           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Four
     C           WUCNTU    IFEQ 4                          *IF
     C                     Z-ADDWDLEDP    P1HPH4           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Five
     C           WUCNTU    IFEQ 5                          *IF
     C                     Z-ADDWDLEDP    P1HPH5           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Six
     C           WUCNTU    IFEQ 6                          *IF
     C                     Z-ADDWDLEDP    P1HPH6           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Seven
     C           WUCNTU    IFEQ 7                          *IF
     C                     Z-ADDWDLEDP    P1HPH7           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Eight
     C           WUCNTU    IFEQ 8                          *IF
     C                     Z-ADDWDLEDP    P1HPH8           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Nine
     C           WUCNTU    IFEQ 9                          *IF
     C                     Z-ADDWDLEDP    P1HPH9           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Ten
     C           WUCNTU    IFEQ 10                         *IF
     C                     Z-ADDWDLEDP    P1HP10           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Eleven
     C           WUCNTU    IFEQ 11                         *IF
     C                     Z-ADDWDLEDP    P1HP11           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Twelve
     C           WUCNTU    IFEQ 12                         *IF
     C                     Z-ADDWDLEDP    P1HP12           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Thirteen
     C           WUCNTU    IFEQ 13                         *IF
     C                     Z-ADDWDLEDP    P1HP13           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Fourteen
     C           WUCNTU    IFEQ 14                         *IF
     C                     Z-ADDWDLEDP    P1HP14           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Fifteen
     C           WUCNTU    IFEQ 15                         *IF
     C                     Z-ADDWDLEDP    P1HP15           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Sixteen
     C           WUCNTU    IFEQ 16                         *IF
     C                     Z-ADDWDLEDP    P1HP16           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Seventeen
     C           WUCNTU    IFEQ 17                         *IF
     C                     Z-ADDWDLEDP    P1HP17           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Eighteen
     C           WUCNTU    IFEQ 18                         *IF
     C                     Z-ADDWDLEDP    P1HP18           HPE Hog Pop Hdg
     C                     ELSE
      * CASE: WRK.Count USR is Nineteen
     C           WUCNTU    IFEQ 19                         *IF
     C                     Z-ADDWDLEDP    P1HP19           HPE Hog Pop Hdg
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWDLEDP    WULEDP           Loin-Eye Depth
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@J1REDB                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAGHDT           Effective Month
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBGHDT           Effective Month
     C                     Z-ADD*ZERO     WBUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WBUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WBBFIN           Backfat Inches
     C                     Z-ADD*ZERO     WBUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     WBUONB           Population Perc
     C                     Z-ADD*ZERO     WBDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WBZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WBAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WBQPNX           Population Head
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Backfat Inches
     C                     Z-ADD*ZERO     WUBFIN  31
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCGHDT           Effective Month
     C                     Z-ADD*ZERO     WCUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WCUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WCULNB           Lean Percent
     C                     Z-ADD*ZERO     WCUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     WCUONB           Population Perc
     C                     Z-ADD*ZERO     WCDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WCZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WCAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WCQPNX           Population Head
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Lean Percent
     C                     Z-ADD*ZERO     WUULNB  31
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDGHDT           Effective Month
     C                     Z-ADD*ZERO     WDUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WDUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WDLEDP           Loin-Eye Depth
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Loin-Eye Depth
     C                     Z-ADD*ZERO     WULEDP  31
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
