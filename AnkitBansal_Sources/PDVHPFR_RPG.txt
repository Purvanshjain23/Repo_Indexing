     H/TITLE PRT Inv Post Rpt       PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/23/10  Time  : 08:55:00
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPM1IF  E           K        DISK
      * RSQ : Order Header TRG          Ready for Invoice Post
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOMCRWKL1IF  E           K        DISK
      * RTV : Order Detail Fin          Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOMCQWKL1IF  E           K        DISK
      * RTV : Order Header Fin          Retrieval index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPDVHPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Inv Post Rpt       PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1   4  6   @CN    25
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      * Outward parameters
     IPARC        DS                              4
      * KEY : Customer EXT              Retrieval index
      * I : RST Ship To Customer
     I                                    P   1   40PABKC7
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPBRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PBAIC3
      * I :  Order Number
     I                                    P   3   60PBC4NB
      * I :  Order Type - Sales
     I                                        7   8 PBJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PBANC7
      * I :  Ship To Customer
     I                                    P  13  160PBBKC7
      * I :  Ship To Name
     I                                       17  46 PBBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PBHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PBHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PBHPNA
      * I :  Ship To City
     I                                      137 156 PBHNNA
      * I :  Ship To State Code
     I                                      157 158 PBDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PBCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PBB0C7
      * I :  Bill to Name
     I                                      174 203 PBAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PBB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PBB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PBB4NA
      * I :  Bill to City
     I                                      294 313 PBB2NA
      * I :  Bill to State Code
     I                                      314 315 PBBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PBC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PBBCNA
      * I :  Order Date
     I                                    P 342 3450PBA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PBA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PBGNDT
      * I :  Cancel Date
     I                                    P 354 3570PBACDT
      * I :  Terms Code
     I                                      358 359 PBAQCD
      * I :  Special Instructions
     I                                      360 399 PBB6NA
      * I :  Special Instructions 2
     I                                      400 439 PBBYNA
      * I :  Carrier Code
     I                                      440 442 PBBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PBGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PBGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PBGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PBQFST
      * I :  Reason Code
     I                                      447 449 PBCQCD
      * I :  Order in Use
     I                                      450 450 PBGJST
      * I :  Header Status
     I                                      451 451 PBGWST
      * I :  Header Status Last
     I                                      452 452 PBGXST
      * I :  Order Type Print Status
     I                                      453 453 PBGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PBAODT
      * I :  User Original Entry
     I                                      458 467 PBAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PBCXDT
      * I :  Order Value Total
     I                                    P 472 4772PBJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PBA1WG
      * I :  Credit Hold
     I                                      484 484 PBXIST
      * I :  Production Hold
     I                                      485 485 PBXJST
      * I :  New Customer Hold
     I                                      486 486 PBXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PBEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PBAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PBE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PBE9CD
      * I :  Load ID
     I                                    P 510 5130PBRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PBTBNB
      * I :  Rated Freight
     I                                    P 517 5222PBR1NB
      * I :  LTL Flag
     I                                      523 523 PBPJST
      * I :  Price Audit
     I                                      524 524 PBU0ST
      * I :  Price Status
     I                                      525 525 PBU1ST
      * I :  Shipping Method
     I                                      526 527 PBQ2CD
      * I :  Export Status
     I                                      528 528 PBU2ST
      * I :  Palletize
     I                                      529 529 PBVEST
      * I :  Shrink Wrap
     I                                      530 530 PBVFST
      * I :  Slip Sheet
     I                                      531 531 PBVGST
      * I :  Age Code
     I                                      532 532 PBRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PBRNNB
      * I :  Load Type
     I                                      536 536 PBVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PBATIN
      * I :  Load Plan Order
     I                                      541 541 PBU4ST
      * I :  Print Pick Slip
     I                                      542 542 PBU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PBRSRN
      * I :  Special Comment 1
     I                                      547 576 PBMHNA
      * I :  Special Comment 2
     I                                      577 606 PBMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PBWBST
      * I :  Sales Route Code
     I                                      608 610 PBR4CD
      * I :  Manager Level Code
     I                                      611 612 PBBFCD
      * I :  VP Level Code
     I                                      613 615 PBQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PBT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PBSICD
      * I :  Invoice Number
     I                                    P 623 6260PBCONB
      * I :  Invoice Suffix
     I                                      627 628 PBCEST
      * I :  Invoice Date
     I                                    P 629 6320PBAWDT
      * I :  Event Code
     I                                      633 634 PBJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PBXUST
      * I :  Modified Flag
     I                                      636 636 PBZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PBVRVA
      * I :  Billing Activity Type
     I                                      643 643 PBOBST
      * I :  Block Order Flag
     I                                      644 644 PBBCST
      * I :  Order Certification Flag
     I                                      645 645 PBBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PBB7VL
      * I :  Invoice Price Type
     I                                      652 652 PBGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PBGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PBGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PBGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PBFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PBFOSX
      * I :  Order Emailed
     I                                      658 658 PBFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PBFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PBFRSX
      * I :  Broker Order Status
     I                                      661 661 PBFSSX
      * I :  Air Freight Order
     I                                      662 662 PBFTSX
      * I :  Signal Demand Send Sts
     I                                      663 664 PBFUSX
      * I :  EDI Nistevo Select Sts
     I                                      665 666 PBFVSX
      * I :  Export USDA Approved
     I                                      667 668 PBFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PBFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PBFYSX
      * I :  OH Unused Date 1
     I                                    P 675 6780PBNODT
      * I :  OH Unused Date 2
     I                                    P 679 6820PBNPDT
      * I :  OH Unused Date 3
     I                                    P 683 6860PBNQDT
      * I :  OH Unused Date 4
     I                                    P 687 6900PBNRDT
      * I :  OH Unused Date 5
     I                                    P 691 6940PBNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PBBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PBBQTM
      * I :  OH Unused Time 3
     I                                    P 703 7060PBBRTM
      * I :  OH Unused Time 4
     I                                    P 707 7100PBBSTM
      * I :  OH Unused Time 5
     I                                    P 711 7140PBBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PBH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PBH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PBH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PBH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PBH4NX
      * I :  Claim Number
     I                                    P 745 7480PBC0C7
      * I :  EDI Status 1
     I                                      749 749 PBUVST
      * I :  EDI Status 2
     I                                      750 750 PBUWST
      * I :  EDI Status 3
     I                                      751 751 PBUXST
      * I :  Job Time
     I                                    P 752 7550PBAATM
      * I :  User Id
     I                                      756 765 PBAYNA
      * I :  Job Name
     I                                      766 775 PBA0NA
      * I :  Job Date
     I                                    P 776 7790PBAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * N :  Actual Shipped Date
     I                                    P   3   60P1GNDT
      * N :  Load ID
     I                                    P   7  100P1RMNB
     IP2PARM      DS
      * FLD: Order Types
      * N :  Billing Activity Type
     I                                        1   1 P2OBST
     IP3PARM      DS
      * I :  Process Cust Types Usr
     I                                        1   2 P3YDSX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P3YDSX    PARM           WP0002  2        Process Cust Ty
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Inv Post Rpt       PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$KENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Inv Post Rpt       PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEAIC3    WQKA01           Company Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
      * Establish starting position
     C           KRSA      SETLL@BFCPDO                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Invoice Number
     C                     MOVEL'Y'       W0AL02  1        Order Number
     C                     MOVEL'Y'       W0AL03  1        Ship To Custome
     C                     MOVEL'Y'       W0AL04  1        Sales Route Cod
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $CAIC3           Company Number
     C                     MOVEL*BLANK    $CAPTX           Company Name
     C                     Z-ADD*ZERO     $CRMNB           Load ID
     C                     Z-ADD*ZERO     $CGNDT           Actual Shipped
      * Load related totals format
     C                     Z-ADD*ZERO     $JU4VA           Total Order Val
     C                     Z-ADD*ZERO     $JU5VA           Total Order Wei
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBEAIC3    $DAIC3           Company Number
     C                     Z-ADDBECONB    $DCONB           Invoice Number
     C                     MOVELBECEST    $DCEST           Invoice Suffix
     C                     Z-ADDBEGNDT    $DGNDT           Actual Shipped
     C                     Z-ADDBEBKC7    $DBKC7           Ship To Custome
     C                     MOVEL*BLANK    $DBOCD           Type Code
     C                     MOVEL*BLANK    $DP5ST           Customer Type
     C                     MOVEL*BLANK    $DBCCD           Salesperson Cod
     C                     Z-ADDBERMNB    $DRMNB           Load ID
     C                     MOVELBEBCNA    $DBCNA           Customer Purcha
     C                     MOVEL*BLANK    $DHUSX           One Invoice Per
     C                     Z-ADDBEC4NB    $DC4NB           Order Number
     C                     MOVELBEJNCD    $DJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $DANC7           A/R Customer Nu
     C                     MOVELBEBRTX    $DBRTX           Ship To Name
     C                     MOVELBEHMNA    $DHMNA           Ship To Address
     C                     MOVELBEHONA    $DHONA           Ship To Address
     C                     MOVELBEHPNA    $DHPNA           Ship To Address
     C                     MOVELBEHNNA    $DHNNA           Ship To City
     C                     MOVELBEDBCD    $DDBCD           Ship To State C
     C                     MOVELBECKTX    $DCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $DB0C7           Bill to Custome
     C                     MOVELBEAETX    $DAETX           Bill to Name
     C                     MOVELBEB1NA    $DB1NA           Bill to Address
     C                     MOVELBEB3NA    $DB3NA           Bill to Address
     C                     MOVELBEB4NA    $DB4NA           Bill to Address
     C                     MOVELBEB2NA    $DB2NA           Bill to City
     C                     MOVELBEBHCD    $DBHCD           Bill to State C
     C                     MOVELBEC8TX    $DC8TX           Bill to Zip/Pos
     C                     Z-ADDBEA0DT    $DA0DT           Order Date
     C                     Z-ADDBEA5DT    $DA5DT           Requested Ship
     C                     Z-ADDBEACDT    $DACDT           Cancel Date
     C                     MOVELBEAQCD    $DAQCD           Terms Code
     C                     MOVELBEB6NA    $DB6NA           Special Instruc
     C                     MOVELBEBYNA    $DBYNA           Special Instruc
     C                     MOVELBEBZNA    $DBZNA           Carrier Code
     C                     MOVELBEGTST    $DGTST           Comment Print A
     C                     MOVELBEGVST    $DGVST           Comment Print I
     C                     MOVELBEGUST    $DGUST           Comment Print P
     C                     MOVELBEQFST    $DQFST           Comment Print S
     C                     MOVELBECQCD    $DCQCD           Reason Code
     C                     MOVELBEGJST    $DGJST           Order in Use
     C                     MOVELBEGWST    $DGWST           Header Status
     C                     MOVELBEGXST    $DGXST           Header Status L
     C                     MOVELBEGYST    $DGYST           Order Type Prin
     C                     Z-ADDBEAODT    $DAODT           Scheduled Ship
     C                     MOVELBEAIVN    $DAIVN           User Original E
     C                     Z-ADDBECXDT    $DCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $DJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $DA1WG           Order Weight To
     C                     MOVEL*BLANK    $DAUNA           Description
     C                     MOVELBEXIST    $DXIST           Credit Hold
     C                     MOVELBEXJST    $DXJST           Production Hold
     C                     MOVELBEXKST    $DXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $DEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $DAFTM           Requested Deliv
     C                     MOVELBEE8CD    $DE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $DE9CD           Accounts Receiv
     C                     Z-ADDBETBNB    $DTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $DR1NB           Rated Freight
     C                     MOVELBEPJST    $DPJST           LTL Flag
     C                     MOVELBEU0ST    $DU0ST           Price Audit
     C                     MOVELBEU1ST    $DU1ST           Price Status
     C                     MOVELBEQ2CD    $DQ2CD           Shipping Method
     C                     MOVELBEU2ST    $DU2ST           Export Status
     C                     MOVELBEVEST    $DVEST           Palletize
     C                     MOVELBEVFST    $DVFST           Shrink Wrap
     C                     MOVELBEVGST    $DVGST           Slip Sheet
     C                     MOVELBERPCD    $DRPCD           Age Code
     C                     Z-ADDBERNNB    $DRNNB           Reefer Temperat
     C                     MOVELBEVDST    $DVDST           Load Type
     C                     Z-ADDBEATIN    $DATIN           Attach to Invoi
     C                     MOVELBEU4ST    $DU4ST           Load Plan Order
     C                     MOVELBEU5ST    $DU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $DRSRN           Resell Referenc
     C                     MOVELBEMHNA    $DMHNA           Special Comment
     C                     MOVELBEMINA    $DMINA           Special Comment
     C                     MOVELBEWBST    $DWBST           Affect Auto Acc
     C                     MOVELBER4CD    $DR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $DBFCD           Manager Level C
     C                     MOVELBEQ4CD    $DQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $DT3NB           Attach to Order
     C                     MOVELBESICD    $DSICD           Reason for Pric
     C                     Z-ADDBEAWDT    $DAWDT           Invoice Date
     C                     MOVELBEJPCD    $DJPCD           Event Code
     C                     MOVELBEXUST    $DXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $DZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $DVRVA           A/R order Value
     C                     MOVELBEOBST    $DOBST           Billing Activit
     C                     MOVELBEBCST    $DBCST           Block Order Fla
     C                     MOVELBEBDST    $DBDST           Order Certifica
     C                     Z-ADDBEB7VL    $DB7VL           Invoice Order V
     C                     MOVELBEGASX    $DGASX           Invoice Price T
     C                     MOVELBEGBSX    $DGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $DGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $DGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $DFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $DFOSX           Email Cust On O
     C                     MOVELBEFPSX    $DFPSX           Order Emailed
     C                     MOVELBEFQSX    $DFQSX           Export Docs Go
     C                     MOVELBEFRSX    $DFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $DFSSX           Broker Order St
     C                     MOVELBEFTSX    $DFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $DFUSX           Signal Demand S
     C                     MOVELBEFVSX    $DFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $DFWSX           Export USDA App
     C                     MOVELBEFXSX    $DFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $DFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $DNODT           OH Unused Date
     C                     Z-ADDBENPDT    $DNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $DNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $DNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $DNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $DBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $DBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $DBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $DBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $DBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $DH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $DH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $DH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $DH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $DH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $DC0C7           Claim Number
     C                     MOVELBEUVST    $DUVST           EDI Status 1
     C                     MOVELBEUWST    $DUWST           EDI Status 2
     C                     MOVELBEUXST    $DUXST           EDI Status 3
     C                     Z-ADDBEAATM    $DAATM           Job Time
     C                     MOVELBEAYNA    $DAYNA           User Id
     C                     MOVELBEA0NA    $DA0NA           Job Name
     C                     Z-ADDBEAXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Invoice Post Rpt   PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Invoice Post Fin.  PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Blank Line         PO
     C                     EXSR UESUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     MOVEL'Y'       WUGYST           Order Type Prin
      * CHG Ord Typ Prt Status CH - Order Header TRG  * 
     C                     EXSR SHCHRC
      * Combo PO Update the Order Type Print Status  Yes or No
     C                     EXSR UFSUBR                     Combo PO Update
     C                     ADD  $DJZVA    $JU4VA           Total Order Val
     C                     ADD  $DA1WG    $JU5VA           Total Order Wei
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BEAIC3    WZA001           Company Number
     C                     Z-ADDBEAIC3    WZA001
     C           *LIKE     DEFN BECONB    WZA002           Invoice Number
     C                     Z-ADDBECONB    WZA002
     C           *LIKE     DEFN BEC4NB    WZA003           Order Number
     C                     Z-ADDBEC4NB    WZA003
     C           *LIKE     DEFN BEBKC7    WZA004           Ship To Custome
     C                     Z-ADDBEBKC7    WZA004
     C           *LIKE     DEFN BER4CD    WZA005           Sales Route Cod
     C                     MOVELBER4CD    WZA005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@BFCPDO                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Sel Customer Type     XF - Company Customer  * 
     C                     CALL 'PPUOXFR'              90  Sel Customer Ty
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEAIC3    WQ0008  30       Company Number
     C                     PARM BEBKC7    WQ0009  70       Ship To Custome
     C           YL0002    PARM YL0002    WQ0010  2        Type Code
     C                     PARM P3YDSX    WQ0011  2        Process Cust Ty
     C           W0RSL     PARM W0RSL     WQ0012  1        *Record selecte
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPUOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Invoice Number
     C                     MOVEL*BLANK    W0AL02  1        Order Number
     C                     MOVEL*BLANK    W0AL03  1        Ship To Custome
     C                     MOVEL*BLANK    W0AL04  1        Sales Route Cod
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Invoice Number
     C                     MOVEL'Y'       W0AL02  1        Order Number
     C                     MOVEL'Y'       W0AL03  1        Ship To Custome
     C                     MOVEL'Y'       W0AL04  1        Sales Route Cod
     C                     ELSE
      * Next record - Detect level breaks
     C           BEAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           BECONB    IFNE WZA002                     Invoice Number
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           BEC4NB    IFNE WZA003                     Order Number
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           BEBKC7    IFNE WZA004                     Ship To Custome
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           BER4CD    IFNE WZA005                     Sales Route Cod
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Invoice Post Rpt   PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQKB01           Company Number
     C           *LIKE     DEFN OMC4NB    WQKB02           Order Number
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    WQKB01           Company Number
     C                     Z-ADD$DC4NB    WQKB02           Order Number
      * Establish starting position
     C           KRSB      SETLL@BGWKL1                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVEL*BLANK    $EM4CD           USR Substitutio
     C                     Z-ADDOMAVQT    $EAVQT           Quantity Ordere
     C                     Z-ADDOMCBQT    $ECBQT           Quantity Shippe
     C                     Z-ADDOMAIC3    $EAIC3           Company Number
     C                     Z-ADDOMC4NB    $EC4NB           Order Number
     C                     Z-ADDOMDPNB    $EDPNB           Order Sequence
     C                     Z-ADDOMUENB    $EUENB           Order Secondary
     C                     Z-ADDOMHGCD    $EHGCD           Item Code
     C                     Z-ADDOMD0WG    $ED0WG           Weight Ordered
     C                     MOVELOMAGCD    $EAGCD           U/M - Ordered
     C                     MOVELOMCRCD    $ECRCD           U/M - Base Pric
     C                     Z-ADDOMAKPR    $EAKPR           Unit Price
     C                     Z-ADDOMAVWG    $EAVWG           Unit Weight Ord
     C                     Z-ADDOMATWG    $EATWG           Weight Shipped
     C                     MOVELOMAJCD    $EAJCD           Warehouse Code
     C                     Z-ADDOMAYVA    $EAYVA           Extended Amount
     C                     Z-ADDOMAUPR    $EAUPR           Unit Price Orde
     C                     MOVELOMG7NA    $EG7NA           Order Desc. Lin
     C                     MOVELOMG8NA    $EG8NA           Order Desc. Lin
     C                     Z-ADDOMAGCS    $EAGCS           Unit Cost Per P
     C                     Z-ADDOMAQCS    $EAQCS           Unit Cost Prici
     C                     MOVELOMAMST    $EAMST           Affect Inventor
     C                     MOVELOMANST    $EANST           Affect Sales Do
     C                     MOVELOMVAST    $EVAST           Affect Sales Pn
     C                     Z-ADDOML6NB    $EL6NB           Contract Number
     C                     MOVEL*BLANK    $EF8NA           Warehouse Descr
     C                     Z-ADDOMCCQT    $ECCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    $EAUWG           Weight Schedule
     C                     Z-ADDOMBKC7    $EBKC7           Ship To Custome
     C                     Z-ADDOMCFC7    $ECFC7           Order Group Cod
     C                     MOVELOMFZST    $EFZST           Production Date
     C                     MOVELOMAVST    $EAVST           Catch Weight St
     C                     MOVELOMGMST    $EGMST           Detail Line Sta
     C                     MOVELOMGNST    $EGNST           Detail Line Sta
     C                     MOVELOMR4CD    $ER4CD           Sales Route Cod
     C                     MOVELOMGTST    $EGTST           Comment Print A
     C                     MOVELOMGVST    $EGVST           Comment Print I
     C                     MOVELOMGUST    $EGUST           Comment Print P
     C                     MOVELOMQFST    $EQFST           Comment Print S
     C                     MOVELOMKXCD    $EKXCD           Country Code
     C                     MOVELOMRZST    $ERZST           Work Confirm St
     C                     MOVELOMR0ST    $ER0ST           Work Over/Short
     C                     MOVELOMR1ST    $ER1ST           OD Production P
     C                     Z-ADDOMEXDT    $EEXDT           Market Pricing
     C                     Z-ADDOMBZPR    $EBZPR           Price Overage O
     C                     MOVELOMU1ST    $EU1ST           Price Status
     C                     MOVELOMU0ST    $EU0ST           Price Audit
     C                     MOVELOMRFCD    $ERFCD           Price Audit Rea
     C                     MOVELOMRPCD    $ERPCD           Age Code
     C                     MOVELOMVEST    $EVEST           Palletize
     C                     Z-ADDOMMAVA    $EMAVA           Billing Detail
     C                     Z-ADDOMKDVA    $EKDVA           Billing Detail
     C                     MOVELOMVGST    $EVGST           Slip Sheet
     C                     Z-ADDOML8VA    $EL8VA           Billing Detail
     C                     Z-ADDOML9VA    $EL9VA           Quantity to Sub
     C                     Z-ADDOMA4WG    $EA4WG           Tare Weight Tot
     C                     MOVELOMRDCD    $ERDCD           Date Method Cod
     C                     MOVELOMQ7CD    $EQ7CD           Price Method Co
     C                     MOVELOMLQCD    $ELQCD           Commodity Marke
     C                     MOVELOMCQCD    $ECQCD           Reason Code
     C                     MOVELOMHICD    $EHICD           Quality Level
     C                     MOVELOMRNCD    $ERNCD           Pricing Product
     C                     MOVELOMROCD    $EROCD           Season Product
     C                     Z-ADDOMCXDT    $ECXDT           Date of Origina
     C                     MOVELOMAJVN    $EAJVN           User Profile Na
     C                     MOVELOMRBCD    $ERBCD           Item Level
     C                     Z-ADDOMRGNB    $ERGNB           Item Structure
     C                     Z-ADDOMRHNB    $ERHNB           Item Structure
     C                     Z-ADDOMRINB    $ERINB           Item Structure
     C                     Z-ADDOMGIDT    $EGIDT           Pricing Date Us
     C                     Z-ADDOMGNDT    $EGNDT           Actual Shipped
     C                     Z-ADDOMA5DT    $EA5DT           Requested Ship
     C                     MOVELOMJPCD    $EJPCD           Event Code
     C                     MOVELOMZ1ST    $EZ1ST           Modified Flag
     C                     Z-ADDOMAODT    $EAODT           Scheduled Ship
     C                     MOVELOMZ3ST    $EZ3ST           Substituted Fla
     C                     MOVELOMZ4ST    $EZ4ST           OD Schedule Ove
     C                     Z-ADDOMDUPR    $EDUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    $EB6VL           Invoice Extende
     C                     Z-ADDOMA1AA    $EA1AA           Ham Group Numbe
     C                     MOVELOMFZSX    $EFZSX           OD Adj Type Ove
     C                     MOVELOMF0SX    $EF0SX           Affect Trade Fu
     C                     MOVELOMF1SX    $EF1SX           Affect Commissi
     C                     MOVELOMF2SX    $EF2SX           Affect Pricing
     C                     MOVELOMF3SX    $EF3SX           Released by Use
     C                     MOVELOMF4SX    $EF4SX           Ord TF Exempt C
     C                     MOVELOMF5SX    $EF5SX           OD Pallet Type
     C                     MOVELOMF6SX    $EF6SX           Production Ware
     C                     MOVELOMF7SX    $EF7SX           OD Price Type
     C                     Z-ADDOMNTDT    $ENTDT           Warehouse Palle
     C                     Z-ADDOMNUDT    $ENUDT           Consumed Item C
     C                     Z-ADDOMNVDT    $ENVDT           Deadline Depart
     C                     Z-ADDOMNWDT    $ENWDT           OD Price Type R
     C                     Z-ADDOMNXDT    $ENXDT           OD Unused Date
     C                     Z-ADDOMBUTM    $EBUTM           Deadline Depart
     C                     Z-ADDOMBVTM    $EBVTM           Price Code
     C                     Z-ADDOMBWTM    $EBWTM           Maximum Net Wei
     C                     Z-ADDOMBXTM    $EBXTM           Substitution Li
     C                     Z-ADDOMBYTM    $EBYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    $EH5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    $EH6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    $EH7NX           OD Item Target
     C                     Z-ADDOMH8NX    $EH8NX           OD Minimum Unit
     C                     Z-ADDOMH9NX    $EH9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    $EDVPR           Order Gate Pric
     C                     Z-ADDOMDWPR    $EDWPR           OD Base MKT Ovr
     C                     Z-ADDOMDXPR    $EDXPR           OD Unused Prc 3
     C                     Z-ADDOMDYPR    $EDYPR           OD Unused Prc 4
     C                     Z-ADDOMDZPR    $EDZPR           OD Unused Prc 5
     C                     Z-ADDOMGSPR    $EGSPR           OD Unused Prc 6
     C                     Z-ADDOMGTPR    $EGTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    $EGUPR           OD Unused Prc 8
     C                     MOVELOMHOST    $EHOST           OD UnUsed Price
     C                     MOVELOMHPST    $EHPST           OD UnUsed Price
     C                     MOVELOMIOST    $EIOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    $EPEWG           Weight Amount E
     C                     Z-ADDOMRINY    $ERINY           Delv Ageing Day
     C                     Z-ADDOMTIDT    $ETIDT           Production Ovr
     C                     Z-ADDOMTJDT    $ETJDT           Production Ovr
     C                     MOVELOMH2ST    $EH2ST           OD UnUsed Statu
     C                     MOVELOMH0ST    $EH0ST           OD UnUsed Statu
     C                     MOVELOMH1ST    $EH1ST           OD UnUsed Statu
     C                     Z-ADDOMTKDT    $ETKDT           OD UnUsed Date
     C                     Z-ADDOMTLDT    $ETLDT           OD UnUsed Date
     C                     Z-ADDOMTMDT    $ETMDT           OD UnUsed Date
     C                     MOVELOMUVST    $EUVST           EDI Status 1
     C                     MOVELOMUWST    $EUWST           EDI Status 2
     C                     MOVELOMUXST    $EUXST           EDI Status 3
     C                     Z-ADDOMAATM    $EAATM           Job Time
     C                     MOVELOMAYNA    $EAYNA           User Id
     C                     MOVELOMA0NA    $EA0NA           Job Name
     C                     Z-ADDOMAXDT    $EAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: DB1.Order Secondary Line Seq is EQ 1
     C           OMUENB    IFEQ 1                          *IF
     C                     MOVEL*BLANK    $EM4CD           USR Substitutio
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $EM4CD           USR Substitutio
     C                     MOVEL'SUBED'   $EM4CD           USR Substitutio
     C                     END                             *FI
      * Set flag for substituted lines
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     MOVEL'Y'       WN0001           Substitution Fl
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0001           Substitution Fl
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Inv Post Dtl Fin   PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN OMAIC3    WZB001           Company Number
     C                     Z-ADDOMAIC3    WZB001
     C           *LIKE     DEFN OMC4NB    WZB002           Order Number
     C                     Z-ADDOMC4NB    WZB002
     C           *LIKE     DEFN OMDPNB    WZB003           Order Sequence
     C                     Z-ADDOMDPNB    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@BGWKL1                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
      * CASE: DB1.Order Secondary Line Seq is GT 1
     C           OMUENB    IFGT 1                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL Substitute Item    RT - OM Shipping Detail  * 
     C                     EXSR SGRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Order Number
     C                     MOVEL*BLANK    W0BL02  1        Order Sequence
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
     C                     ELSE
      * Next record - Detect level breaks
     C           OMAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           OMC4NB    IFNE WZB002                     Order Number
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           OMDPNB    IFNE WZB003                     Order Sequence
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * PRT Inv Post Dtl Fin   PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN N1AIC3    WQKC01           Company Number
     C           *LIKE     DEFN N1C4NB    WQKC02           Order Number
     C           *LIKE     DEFN N1DPNB    WQKC03           Order Sequence
     C           *LIKE     DEFN N1UENB    WQKC04           Order Secondary
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
     C                     KFLD           WQKC03           Order Sequence
     C                     KFLD           WQKC04           Order Secondary
      * Setup key
     C                     Z-ADD$EAIC3    WQKC01           Company Number
     C                     Z-ADD$EC4NB    WQKC02           Order Number
     C                     Z-ADD$EDPNB    WQKC03           Order Sequence
     C                     Z-ADD$EUENB    WQKC04           Order Secondary
      * Establish starting position
     C           KRSC      SETLL@CRWKL1                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDN1AIC3    $FAIC3           Company Number
     C                     Z-ADDN1C4NB    $FC4NB           Order Number
     C                     Z-ADDN1DPNB    $FDPNB           Order Sequence
     C                     Z-ADDN1UENB    $FUENB           Order Secondary
     C                     Z-ADDN1DXNB    $FDXNB           Sequence Number
     C                     MOVELN1G4ST    $FG4ST           Financial Type
     C                     MOVELN1DQCD    $FDQCD           Enterprise Code
     C                     MOVELN1DRCD    $FDRCD           Enterprise Code
     C                     MOVELN1AVNB    $FAVNB           G/L Account for
     C                     MOVELN1DSCD    $FDSCD           G/L Sub Account
     C                     MOVELN1GFST    $FGFST           Financial Charg
     C                     Z-ADDN1SANB    $FSANB           Special Charge
     C                     MOVELN1OJCD    $FOJCD           Accrual Code
     C                     MOVELN1UVCD    $FUVCD           Financial Code
     C                     Z-ADDN1CKNB    $FCKNB           G/L Document Nu
     C                     MOVELN1BMST    $FBMST           G/L Update Stat
     C                     MOVELN1UVST    $FUVST           EDI Status 1
     C                     MOVELN1UWST    $FUWST           EDI Status 2
     C                     MOVELN1UXST    $FUXST           EDI Status 3
     C                     MOVELN1G5NA    $FG5NA           Financial Text
     C                     Z-ADDN1BSVA    $FBSVA           Transaction Amo
     C                     Z-ADDN1AATM    $FAATM           Job Time
     C                     MOVELN1AYNA    $FAYNA           User Id
     C                     MOVELN1A0NA    $FA0NA           Job Name
     C                     Z-ADDN1AXDT    $FAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN N1AIC3    WZC001           Company Number
     C                     Z-ADDN1AIC3    WZC001
     C           *LIKE     DEFN N1C4NB    WZC002           Order Number
     C                     Z-ADDN1C4NB    WZC002
     C           *LIKE     DEFN N1DPNB    WZC003           Order Sequence
     C                     Z-ADDN1DPNB    WZC003
     C           *LIKE     DEFN N1UENB    WZC004           Order Secondary
     C                     Z-ADDN1UENB    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@CRWKL1                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Order Number
     C                     MOVEL*BLANK    W0CL02  1        Order Sequence
     C                     MOVEL*BLANK    W0CL03  1        Order Secondary
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           N1AIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           N1C4NB    IFNE WZC002                     Order Number
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           N1DPNB    IFNE WZC003                     Order Sequence
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           N1UENB    IFNE WZC004                     Order Secondary
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * PRT Invoice Post Fin.  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN N2AIC3    WQKD01           Company Number
     C           *LIKE     DEFN N2C4NB    WQKD02           Order Number
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    WQKD01           Company Number
     C                     Z-ADD$DC4NB    WQKD02           Order Number
      * Establish starting position
     C           KRSD      SETLL@CQWKL1                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDN2AIC3    $GAIC3           Company Number
     C                     Z-ADDN2C4NB    $GC4NB           Order Number
     C                     Z-ADDN2DXNB    $GDXNB           Sequence Number
     C                     MOVELN2G4ST    $GG4ST           Financial Type
     C                     MOVELN2G5NA    $GG5NA           Financial Text
     C                     Z-ADDN2BSVA    $GBSVA           Transaction Amo
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN N2AIC3    WZD001           Company Number
     C                     Z-ADDN2AIC3    WZD001
     C           *LIKE     DEFN N2C4NB    WZD002           Order Number
     C                     Z-ADDN2C4NB    WZD002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@CQWKL1                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        Company Number
     C                     MOVEL*BLANK    W0DL01  1        Order Number
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           N2AIC3    IFNE WZD001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           N2C4NB    IFNE WZD002                     Order Number
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * PRT Blank Line         PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN ABAIC3    WQKE01           Company Number
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           Company Number
      * Setup key
     C                     Z-ADD$DAIC3    WQKE01           Company Number
      * Establish starting position
     C           KRSE      SETLL@ABREG3                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $IAUNA           Description
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDABAIC3    $HAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@ABREG3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     ELSE
      * Next record - Detect level breaks
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EOFE    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     MOVEL*BLANK    $IAUNA           Description
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$IFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Inv Post Rpt       PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Inv Post Rpt       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
     C                     Z-ADDP1AIC3    $CAIC3           Company Number
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $CAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$CAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCAIC3           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$C1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of PRT Inv Post Rpt       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Invoice Number of PRT Inv Post Rpt       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Order Number of PRT Inv Post Rpt       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Ship To Customer of PRT Inv Post Rpt       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Sales Route Code of PRT Inv Post Rpt       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Detail line. of PRT Inv Post Rpt       PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPARC
     C                     Z-ADDBEBKC7    PABKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Customer E
     C           $DHUSX    PARM *BLANK    WQ0001  1        One Invoice Per
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Salesman Code      RT - PD Sales Route  * 
     C                     EXSR SDRVGN
      * Reverse $ if credit memo
      * CASE: DB1.Billing Activity Type is Credit Memo
     C           BEOBST    IFEQ '2'                        *IF
     C           *ZERO     SUB  BEJZVA    $DJZVA           Order Value Tot
     C           *ZERO     SUB  BEA1WG    $DA1WG           Order Weight To
     C                     END                             *FI
     C                     MOVELBEOBST    WUOBST           Billing Activit
      * ** Put customer type on the report                E00351
      * Rtv Company/Cust Data  RT - Company Customer  * 
     C                     EXSR SERVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  $DGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDGNDT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DC4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  $DA0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDA0DT
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  $DA5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDA5DT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Invoice Post Rpt   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of PRT Invoice Post Rpt   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Order Number of PRT Invoice Post Rpt   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Invoice Post Rpt   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of PRT Invoice Post Rpt   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR SFRVGN
      * Reverse $ for Credit Memo
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           WUOBST    IFEQ '2'                        *IF
     C           *ZERO     SUB  OMAYVA    $EAYVA           Extended Amount
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEHGCD           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WN0001    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of PRT Inv Post Dtl Fin   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of PRT Inv Post Dtl Fin   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Order Number of PRT Inv Post Dtl Fin   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Inv Post Dtl Fin   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT Inv Post Dtl Fin   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of PRT Inv Post Dtl Fin   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Reverse $ for Credit Memo
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           WUOBST    IFEQ '2'                        *IF
     C           *ZERO     SUB  N1BSVA    $FBSVA           Transaction Amo
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of PRT Invoice Post Fin.  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Company Number of PRT Invoice Post Fin.  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print Order Number of PRT Invoice Post Fin.  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print Detail line. of PRT Invoice Post Fin.  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Reverse $ for Credit Memo
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           WUOBST    IFEQ '2'                        *IF
     C           *ZERO     SUB  N2BSVA    $GBSVA           Transaction Amo
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of PRT Blank Line         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print Detail line. of PRT Blank Line         PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$HDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Inv Post Rpt       PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Inv Post Rpt       PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Invoice Number of PRT Inv Post Rpt       PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Inv Post Rpt       PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of PRT Inv Post Rpt       PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Sales Route Code of PRT Inv Post Rpt       PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Inv Post Rpt       PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Invoice Post Rpt   PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Invoice Post Rpt   PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Invoice Post Rpt   PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Invoice Post Rpt   PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Invoice Post Rpt   PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Inv Post Dtl Fin   PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Inv Post Dtl Fin   PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Inv Post Dtl Fin   PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Inv Post Dtl Fin   PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT Inv Post Dtl Fin   PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Inv Post Dtl Fin   PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Invoice Post Fin.  PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Invoice Post Fin.  PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Invoice Post Fin.  PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Invoice Post Fin.  PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Blank Line         PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Blank Line         PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * Last part of title
      * CASE: PAR.Process Cust Types Usr is Inter-Co Customer's
     C           P3YDSX    IFEQ 'IC'                       *IF
     C                     Z-ADD1         ZQ      50
     C           $BHPT1    CAT  @CN,01:ZQ $BHPT1    P      Description Usr
     C                     ELSE
      * CASE: PAR.Process Cust Types Usr is 3rd Party Customer(s)
     C           P3YDSX    IFEQ 'TP'                       *IF
     C                     Z-ADD1         ZQ      50
     C           $BHPT1    CAT  @CN,02:ZQ $BHPT1    P      Description Usr
     C                     ELSE
      * CASE: PAR.Process Cust Types Usr is All Customers
     C           P3YDSX    IFEQ 'BT'                       *IF
     C                     Z-ADD1         ZQ      50
     C           $BHPT1    CAT  @CN,03:ZQ $BHPT1    P      Description Usr
     C                     ELSE
      * CASE: PAR.Process Cust Types Usr is Selection by Order/Load
     C           P3YDSX    IFEQ 'OR'                       *IF
     C                     Z-ADD1         ZQ      50
     C           $BHPT1    CAT  @CN,04:ZQ $BHPT1    P      Description Usr
     C                     Z-ADD0         ZQ      50
     C           $BHPT1    CAT  'Load':ZQ $BHPT1    P      Description Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$CAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $CAPTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $CAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - PD Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELBER4CD    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSD     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DBCCD           Salesperson Cod
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEBCCD    $DBCCD           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Company/Cust Data  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$DAIC3    EOAIC3           Company Number
     C                     Z-ADD$DBKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@EOREXM              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    $DBOCD           Type Code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL$EAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $EF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    $EF8NA           Warehouse Descr
     C                     MOVELADXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * VAL Substitute Item    RT - OM Shipping Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSG02           Order Number
     C           *LIKE     DEFN WADPNB    WQSG03           Order Sequence
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WQSG03           Order Sequence
      * Setup key
     C                     Z-ADDOMAIC3    WQSG01           Company Number
     C                     Z-ADDOMC4NB    WQSG02           Order Number
     C                     Z-ADDOMDPNB    WQSG03           Order Sequence
      * Establish starting position
     C           KRSSG     SETLL@BGWKAE                    *
     C           KRSSG     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * CHG Ord Typ Prt Status CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0003  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0004  70       Ship To Custome
     C                     MOVEL*BLANK    WN0005 30        Ship To Name
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 30        Ship To Address
     C                     MOVEL*BLANK    WN0009 20        Ship To City
     C                     MOVEL*BLANK    WN0010  2        Ship To State C
     C                     MOVEL*BLANK    WN0011 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0012  70       Bill to Custome
     C                     MOVEL*BLANK    WN0013 30        Bill to Name
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 30        Bill to Address
     C                     MOVEL*BLANK    WN0017 20        Bill to City
     C                     MOVEL*BLANK    WN0018  2        Bill to State C
     C                     MOVEL*BLANK    WN0019 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0020 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0021  70       Order Date
     C                     Z-ADD*ZERO     WN0022  70       Requested Ship
     C                     Z-ADD*ZERO     WN0023  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0024  70       Cancel Date
     C                     MOVEL*BLANK    WN0025  2        Terms Code
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027 40        Special Instruc
     C                     MOVEL*BLANK    WN0028  3        Carrier Code
     C                     MOVEL*BLANK    WN0029  1        Comment Print A
     C                     MOVEL*BLANK    WN0030  1        Comment Print I
     C                     MOVEL*BLANK    WN0031  1        Comment Print P
     C                     MOVEL*BLANK    WN0032  1        Comment Print S
     C                     MOVEL*BLANK    WN0033  3        Reason Code
     C                     MOVEL*BLANK    WN0034  1        Order in Use
     C                     MOVEL*BLANK    WN0035  1        Header Status
     C                     MOVEL*BLANK    WN0036  1        Header Status L
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     Z-ADD*ZERO     WN0040 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0041 112       Order Weight To
     C                     MOVEL*BLANK    WN0042  1        Credit Hold
     C                     MOVEL*BLANK    WN0043  1        Production Hold
     C                     MOVEL*BLANK    WN0044  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0045  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0046  40       Requested Deliv
     C                     MOVEL*BLANK    WN0047  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0048 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0049  70       Load ID
     C                     Z-ADD*ZERO     WN0050  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0051 112       Rated Freight
     C                     MOVEL*BLANK    WN0052  1        LTL Flag
     C                     MOVEL*BLANK    WN0053  1        Price Audit
     C                     MOVEL*BLANK    WN0054  1        Price Status
     C                     MOVEL*BLANK    WN0055  2        Shipping Method
     C                     MOVEL*BLANK    WN0056  1        Export Status
     C                     MOVEL*BLANK    WN0057  1        Palletize
     C                     MOVEL*BLANK    WN0058  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0059  1        Slip Sheet
     C                     MOVEL*BLANK    WN0060  1        Age Code
     C                     Z-ADD*ZERO     WN0061  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0062  1        Load Type
     C                     Z-ADD*ZERO     WN0063  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0064  1        Load Plan Order
     C                     MOVEL*BLANK    WN0065  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0066  70       Resell Referenc
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068 30        Special Comment
     C                     MOVEL*BLANK    WN0069  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0070  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0071  2        Manager Level C
     C                     MOVEL*BLANK    WN0072  3        VP Level Code
     C                     Z-ADD*ZERO     WN0073  70       Attach to Order
     C                     MOVEL*BLANK    WN0074  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0075  70       Invoice Number
     C                     MOVEL*BLANK    WN0076  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0077  70       Invoice Date
     C                     MOVEL*BLANK    WN0078  2        Event Code
     C                     MOVEL*BLANK    WN0079  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0080  1        Modified Flag
     C                     Z-ADD*ZERO     WN0081 112       A/R order Value
     C                     MOVEL*BLANK    WN0082  1        Billing Activit
     C                     MOVEL*BLANK    WN0083  1        Block Order Fla
     C                     MOVEL*BLANK    WN0084  1        Order Certifica
     C                     Z-ADD*ZERO     WN0085 112       Invoice Order V
     C                     MOVEL*BLANK    WN0086  1        Invoice Price T
     C                     MOVEL*BLANK    WN0087  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0088  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0089  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0090  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0091  1        Email Cust On O
     C                     MOVEL*BLANK    WN0092  1        Order Emailed
     C                     MOVEL*BLANK    WN0093  1        Export Docs Go
     C                     MOVEL*BLANK    WN0094  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0095  1        Broker Order St
     C                     MOVEL*BLANK    WN0096  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0097  2        Signal Demand S
     C                     MOVEL*BLANK    WN0098  2        EDI Nistevo Sel
     C                     MOVEL*BLANK    WN0099  2        Export USDA App
     C                     MOVEL*BLANK    WN0100  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0101  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0102  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0103  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0104  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0105  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0106  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0107  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0108  60       Time of Origina
     C                     Z-ADD*ZERO     WN0109  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0110  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0111  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0112 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0113 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0114 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0115 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0116 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0117  70       Claim Number
     C                     MOVEL*BLANK    WN0118  1        EDI Status 1
     C                     MOVEL*BLANK    WN0119  1        EDI Status 2
     C                     MOVEL*BLANK    WN0120  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0121  60       Job Time
     C                     MOVEL*BLANK    WN0122 10        User Id
     C                     MOVEL*BLANK    WN0123 10        Job Name
     C                     Z-ADD*ZERO     WN0124  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD$DAIC3    WBAIC3           Company Number
     C                     Z-ADD$DC4NB    WBC4NB           Order Number
      *
     C           KLCHSH    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C           KLCHSH    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWUGYST    WBGYST    P      Order Type Prin
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPBRC
     C                     Z-ADDWBAIC3    PBAIC3           Company Number
     C                     Z-ADDWBC4NB    PBC4NB           Order Number
     C                     MOVELWBJNCD    PBJNCD    P      Order Type - Sa
     C                     Z-ADDWBANC7    PBANC7           A/R Customer Nu
     C                     Z-ADDWBBKC7    PBBKC7           Ship To Custome
     C                     MOVELWBBRTX    PBBRTX    P      Ship To Name
     C                     MOVELWBHMNA    PBHMNA    P      Ship To Address
     C                     MOVELWBHONA    PBHONA    P      Ship To Address
     C                     MOVELWBHPNA    PBHPNA    P      Ship To Address
     C                     MOVELWBHNNA    PBHNNA    P      Ship To City
     C                     MOVELWBDBCD    PBDBCD    P      Ship To State C
     C                     MOVELWBCKTX    PBCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWBB0C7    PBB0C7           Bill to Custome
     C                     MOVELWBAETX    PBAETX    P      Bill to Name
     C                     MOVELWBB1NA    PBB1NA    P      Bill to Address
     C                     MOVELWBB3NA    PBB3NA    P      Bill to Address
     C                     MOVELWBB4NA    PBB4NA    P      Bill to Address
     C                     MOVELWBB2NA    PBB2NA    P      Bill to City
     C                     MOVELWBBHCD    PBBHCD    P      Bill to State C
     C                     MOVELWBC8TX    PBC8TX    P      Bill to Zip/Pos
     C                     MOVELWBBCNA    PBBCNA    P      Customer Purcha
     C                     Z-ADDWBA0DT    PBA0DT           Order Date
     C                     Z-ADDWBA5DT    PBA5DT           Requested Ship
     C                     Z-ADDWBGNDT    PBGNDT           Actual Shipped
     C                     Z-ADDWBACDT    PBACDT           Cancel Date
     C                     MOVELWBAQCD    PBAQCD    P      Terms Code
     C                     MOVELWBB6NA    PBB6NA    P      Special Instruc
     C                     MOVELWBBYNA    PBBYNA    P      Special Instruc
     C                     MOVELWBBZNA    PBBZNA    P      Carrier Code
     C                     MOVELWBGTST    PBGTST    P      Comment Print A
     C                     MOVELWBGVST    PBGVST    P      Comment Print I
     C                     MOVELWBGUST    PBGUST    P      Comment Print P
     C                     MOVELWBQFST    PBQFST    P      Comment Print S
     C                     MOVELWBCQCD    PBCQCD    P      Reason Code
     C                     MOVELWBGJST    PBGJST    P      Order in Use
     C                     MOVELWBGWST    PBGWST    P      Header Status
     C                     MOVELWBGXST    PBGXST    P      Header Status L
     C                     MOVELWUGYST    PBGYST    P      Order Type Prin
     C                     Z-ADDWBAODT    PBAODT           Scheduled Ship
     C                     MOVELWBAIVN    PBAIVN    P      User Original E
     C                     Z-ADDWBCXDT    PBCXDT           Date of Origina
     C                     Z-ADDWBJZVA    PBJZVA           Order Value Tot
     C                     Z-ADDWBA1WG    PBA1WG           Order Weight To
     C                     MOVELWBXIST    PBXIST    P      Credit Hold
     C                     MOVELWBXJST    PBXJST    P      Production Hold
     C                     MOVELWBXKST    PBXKST    P      New Customer Ho
     C                     Z-ADDWBEIDT    PBEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    PBAFTM           Requested Deliv
     C                     MOVELWBE8CD    PBE8CD    P      Accounts Receiv
     C                     MOVELWBE9CD    PBE9CD    P      Accounts Receiv
     C                     Z-ADDWBRMNB    PBRMNB           Load ID
     C                     Z-ADDWBTBNB    PBTBNB           Absorbed Freigh
     C                     Z-ADDWBR1NB    PBR1NB           Rated Freight
     C                     MOVELWBPJST    PBPJST    P      LTL Flag
     C                     MOVELWBU0ST    PBU0ST    P      Price Audit
     C                     MOVELWBU1ST    PBU1ST    P      Price Status
     C                     MOVELWBQ2CD    PBQ2CD    P      Shipping Method
     C                     MOVELWBU2ST    PBU2ST    P      Export Status
     C                     MOVELWBVEST    PBVEST    P      Palletize
     C                     MOVELWBVFST    PBVFST    P      Shrink Wrap
     C                     MOVELWBVGST    PBVGST    P      Slip Sheet
     C                     MOVELWBRPCD    PBRPCD    P      Age Code
     C                     Z-ADDWBRNNB    PBRNNB           Reefer Temperat
     C                     MOVELWBVDST    PBVDST    P      Load Type
     C                     Z-ADDWBATIN    PBATIN           Attach to Invoi
     C                     MOVELWBU4ST    PBU4ST    P      Load Plan Order
     C                     MOVELWBU5ST    PBU5ST    P      Print Pick Slip
     C                     Z-ADDWBRSRN    PBRSRN           Resell Referenc
     C                     MOVELWBMHNA    PBMHNA    P      Special Comment
     C                     MOVELWBMINA    PBMINA    P      Special Comment
     C                     MOVELWBWBST    PBWBST    P      Affect Auto Acc
     C                     MOVELWBR4CD    PBR4CD    P      Sales Route Cod
     C                     MOVELWBBFCD    PBBFCD    P      Manager Level C
     C                     MOVELWBQ4CD    PBQ4CD    P      VP Level Code
     C                     Z-ADDWBT3NB    PBT3NB           Attach to Order
     C                     MOVELWBSICD    PBSICD    P      Reason for Pric
     C                     Z-ADDWBCONB    PBCONB           Invoice Number
     C                     MOVELWBCEST    PBCEST    P      Invoice Suffix
     C                     Z-ADDWBAWDT    PBAWDT           Invoice Date
     C                     MOVELWBJPCD    PBJPCD    P      Event Code
     C                     MOVELWBXUST    PBXUST    P      Trans Contol AS
     C                     MOVELWBZ1ST    PBZ1ST    P      Modified Flag
     C                     Z-ADDWBVRVA    PBVRVA           A/R order Value
     C                     MOVELWBOBST    PBOBST    P      Billing Activit
     C                     MOVELWBBCST    PBBCST    P      Block Order Fla
     C                     MOVELWBBDST    PBBDST    P      Order Certifica
     C                     Z-ADDWBB7VL    PBB7VL           Invoice Order V
     C                     MOVELWBGASX    PBGASX    P      Invoice Price T
     C                     MOVELWBGBSX    PBGBSX    P      Order Conf Fax
     C                     MOVELWBGCSX    PBGCSX    P      Manifest Fax St
     C                     MOVELWBGDSX    PBGDSX    P      Invoice Fax Sts
     C                     MOVELWBFNSX    PBFNSX    P      Transfer in Sto
     C                     MOVELWBFOSX    PBFOSX    P      Email Cust On O
     C                     MOVELWBFPSX    PBFPSX    P      Order Emailed
     C                     MOVELWBFQSX    PBFQSX    P      Export Docs Go
     C                     MOVELWBFRSX    PBFRSX    P      Shipping Temp C
     C                     MOVELWBFSSX    PBFSSX    P      Broker Order St
     C                     MOVELWBFTSX    PBFTSX    P      Air Freight Ord
     C                     MOVELWBFUSX    PBFUSX    P      Signal Demand S
     C                     MOVELWBFVSX    PBFVSX    P      EDI Nistevo Sel
     C                     MOVELWBFWSX    PBFWSX    P      Export USDA App
     C                     MOVELWBFXSX    PBFXSX    P      HPB Ship to War
     C                     MOVELWBFYSX    PBFYSX    P      OH TF Exempt Co
     C                     Z-ADDWBNODT    PBNODT           OH Unused Date
     C                     Z-ADDWBNPDT    PBNPDT           OH Unused Date
     C                     Z-ADDWBNQDT    PBNQDT           OH Unused Date
     C                     Z-ADDWBNRDT    PBNRDT           OH Unused Date
     C                     Z-ADDWBNSDT    PBNSDT           OH Unused Date
     C                     Z-ADDWBBPTM    PBBPTM           Maximum Gross W
     C                     Z-ADDWBBQTM    PBBQTM           Time of Origina
     C                     Z-ADDWBBRTM    PBBRTM           OH Unused Time
     C                     Z-ADDWBBSTM    PBBSTM           OH Unused Time
     C                     Z-ADDWBBTTM    PBBTTM           OH Unused Time
     C                     Z-ADDWBH0NX    PBH0NX           Act Frt Referen
     C                     Z-ADDWBH1NX    PBH1NX           Act Non-Ref Frt
     C                     Z-ADDWBH2NX    PBH2NX           OH Fuel Surchar
     C                     Z-ADDWBH3NX    PBH3NX           OH Total Non-Re
     C                     Z-ADDWBH4NX    PBH4NX           OH Total Ref Fr
     C                     Z-ADDWBC0C7    PBC0C7           Claim Number
     C                     MOVELWBUVST    PBUVST    P      EDI Status 1
     C                     MOVELWBUWST    PBUWST    P      EDI Status 2
     C                     MOVELWBUXST    PBUXST    P      EDI Status 3
     C                     Z-ADDWBAATM    PBAATM           Job Time
     C                     MOVELWBAYNA    PBAYNA    P      User Id
     C                     MOVELWBA0NA    PBA0NA    P      Job Name
     C                     Z-ADDWBAXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Order Head
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 05/13/2009 LJB E00351
      * ** Put customer type on the report so Daily's IP customers will
      * ** be noticed.
      * *****
      * ** 06/13/2006 LJB OMS047
      * ** Changed the printer file to use a new Standard Header and
      * ** Footer template. Once we removed the SBDPRTOVR command the
      * ** lines per inch were not correct. The new template has
      * ** 98 lines per page, 168 columns, 12 lines per inch, and
      * ** 15 characters per inch. Overflow is line 90.
      * *****
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Invoice Post Rpt   PO
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Substitution Fl
      *
      * PRT Invoice Post Rpt   PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Inv Post Dtl Fin   PO
      *================================================================
      * PRT Inv Post Dtl Fin   PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Invoice Post Fin.  PO
      *================================================================
      * PRT Invoice Post Fin.  PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Blank Line         PO
      *================================================================
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CUR) $DAIC3' defaulted for 'Company Number'.
      * PRT Blank Line         PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Combo PO Update the Order Type Print Status  Yes or No
      *================================================================
      * 04/27 SLM Put in the Combo PO, change all other orders to YES
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPARC
     C                     Z-ADDBEBKC7    PABKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Customer E
     C           YL0001    PARM *BLANK    WQ0002  1        One Invoice Per
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.One Invoice Per PO is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * CHG Po and its Ords    XF - Order Header TRG  * 
     C                     CALL 'PMF8XFR'              90  CHG Po and its
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEAIC3    WQ0003  30       Company Number
     C                     PARM BEBKC7    WQ0004  70       Ship To Custome
     C                     PARM BEBCNA    WQ0005 15        Customer Purcha
     C                     PARM WUGYST    WQ0006  1        Order Type Prin
     C                     PARM BEAODT    WQ0007  70       Scheduled Ship
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMF8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1GNDT           Actual Shipped
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     MOVEL*BLANK    P2OBST           Billing Activit
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BEAIC3           Company Number
     C                     MOVEL*LOVAL    BECONB           Invoice Number
     C                     MOVEL*LOVAL    BEC4NB           Order Number
     C                     MOVEL*LOVAL    BEBKC7           Ship To Custome
     C                     MOVEL*LOVAL    BER4CD           Sales Route Cod
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Billing Activity Type
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    OMAIC3           Company Number
     C                     MOVEL*LOVAL    OMC4NB           Order Number
     C                     MOVEL*LOVAL    OMDPNB           Order Sequence
     C                     MOVEL*LOVAL    OMUENB           Order Secondary
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    N1AIC3           Company Number
     C                     MOVEL*LOVAL    N1C4NB           Order Number
     C                     MOVEL*LOVAL    N1DPNB           Order Sequence
     C                     MOVEL*LOVAL    N1UENB           Order Secondary
     C                     MOVEL*LOVAL    N1DXNB           Sequence Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Unused Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WADWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WADXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WADYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WADZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WAGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WATLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WATMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    N2AIC3           Company Number
     C                     MOVEL*LOVAL    N2C4NB           Order Number
     C                     MOVEL*LOVAL    N2DXNB           Sequence Number
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    ABAIC3           Company Number
      * Define work field Order Type Print Status
     C                     MOVEL*BLANK    WUGYST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Unused Date
     C                     Z-ADD*ZERO     WBNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0001  2
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0003 40
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0004 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0005  3
      * Define null work field Broker
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field P.O. Required Flag
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field Deliver after time
     C                     Z-ADD*ZERO     YN0008  40
      * Define null work field Deliver before time
     C                     Z-ADD*ZERO     YN0009  40
      * Define null work field Alt Remittance Flag
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0011  52
      * Define null work field Mileage To Customer
     C                     Z-ADD*ZERO     YN0012  92
      * Define null work field Co/Cust Overage Rate CWT
     C                     Z-ADD*ZERO     YN0013 112
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0015  3
      * Define null work field Outside Warehouse Flag
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Customer Group Code
     C                     MOVEL*BLANK    YN0017  3
      * Define null work field Customer Group Code 2
     C                     MOVEL*BLANK    YN0018  3
      * Define null work field G/L Code
     C                     MOVEL*BLANK    YN0019  8
      * Define null work field Commodity Market Code
     C                     MOVEL*BLANK    YN0020  3
      * Define null work field Credit Contact Name
     C                     MOVEL*BLANK    YN0021 30
      * Define null work field Credit Contact Telephone
     C                     MOVEL*BLANK    YN0022 25
      * Define null work field Credit Contact Bus. Title
     C                     MOVEL*BLANK    YN0023 30
      * Define null work field Credit Contact Fax Number
     C                     MOVEL*BLANK    YN0024 25
      * Define null work field Allow Man/Qt WO/Approval
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field Fax Invoice Flag
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field Fax Invoice Fax Number
     C                     MOVEL*BLANK    YN0027 25
      * Define null work field Fax Invoice Contact Name
     C                     MOVEL*BLANK    YN0028 30
      * Define null work field Distributor
     C                     MOVEL*BLANK    YN0029  1
      * Define null work field Default Shipping Co Sts
     C                     MOVEL*BLANK    YN0030  1
      * Define local work field One Invoice Per PO
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0002  2
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 ** Inter-Co Customers
00002 ** 3rd Party Customers
00003   *All Customers
00004 ** Selection by Order/
