     H/TITLE UPL MPR - UPLOAD FOB OMAHA RATES                   USRPGM
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version:  1000
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 11/19/12  Time  : 10:30:00
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FMPROMAHAIF  E                    DISK
     F            MPROMAHA                          KRENAMEMPROMAHR
      * UPLOAD MPR FOB OMAHA RATES
      *
     FPBARCPL0UF  E           K        DISK                      A
      * RTV : MPR FOB OMAHA RATES
     C           *ENTRY    PLIST
     C                     PARM           RTN     7
     C                     PARM           JOBDTA  7         JOB DT
     C                     PARM           JOBUSR 10         JOB USER
     C*
     C           KEY       KLIST
     C                     KFLD           ARPZAA            COUNTRY
     C                     KFLD           ARW5NY            REGION
     C                     KFLD           ARP0AA            STATE
     C                     KFLD           ARW6NY            ZIP
     C*
     C                     MOVEL'USA   '  ARPZAA            COUNTRY
     C                     MOVELJOBDTA    JOBDTE  70        JOB DT
     C*
     C           *IN90     DOWEQ'0'
     C                     READ MPROMAHR                 90*
     C           *IN90     IFEQ '0'
     C                     MOVELF3        ARW5NY              REGION
     C                     MOVELF2        ARP0AA              STATE
     C                     Z-ADDF1        ARW6NY              ZIP
      * USER: Process Data record
     C           KEY       CHAIN@ARCPOT              91
     C           *IN91     IFEQ '1'
     C* CREATE NEW REGION AND RATE
     C                     Z-ADDJOBDTE    ARMJDT
     C                     MOVELJOBUSR    ARCCVN
     C                     TIME           ARBETM
     C                     MOVELJOBUSR    ARCCVN
     C                     MOVEL'PBGOUPR' ARCDVN
     C                     MOVE 'A'       ARVSST
     C*
     C                     Z-ADDF4        ARHSPR              RATE
     C*
     C                     WRITE@ARCPOT
     C                     ELSE
     C* UPDATE REGION AND RATE
     C                     Z-ADDJOBDTE    ARMKDT
     C                     MOVELJOBUSR    ARCCVN
     C                     TIME           ARBFTM
     C                     MOVELJOBUSR    ARCEVN
     C                     MOVEL'PBGOUPR' ARCFVN
     C*
     C                     Z-ADDF4        ARHSPR              RATE
     C*
     C                     UPDAT@ARCPOT
     C                     END
     C                     END
     C                     END
     C           END       TAG
     C                     SETON                     LR
