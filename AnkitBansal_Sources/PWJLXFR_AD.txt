// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWJLXFR
// ?Date: 14.08.2025 Time: 02:56:39
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Rtv Update after Run  RT) TYPE(RTVOBJ) FILE(PWARREP)           AB1352380;
PARAMETER(PAR.Company);
PARAMETER(PAR.MPR_Last_Kill_Dt_Reported);
{
 //?USER: Process Data record

 //?Update if the Job date n= Last Job date(means the job ran normal next day)
 CASE;

 // IF DB1.MPR Date of Last Job EQ JOB.*Job date
 IF DB1.MPR_Date_of_Last_Job = JOB.*Job_date;

 //?Update if the Job date n= Last Job date(means the job ran normal next day)
 // IF *OTHERWISE
 IF *OTHERWISE;

 //? Then Roll the Last job date, prior kill dt reported, last kill dt
 // LCL.MPR Prior Kill Dt Reportd = DB1.MPR Last Kill Dt Reported
 LCL.MPR_Prior_Kill_Dt_Reportd = DB1.MPR_Last_Kill_Dt_Reported;

 // LCL.MPR Last Kill Dt Reported = PAR.MPR Last Kill Dt Reported
 LCL.MPR_Last_Kill_Dt_Reported = PAR.MPR_Last_Kill_Dt_Reported;

 // LCL.MPR Date of Last Job = JOB.*Job date
 LCL.MPR_Date_of_Last_Job = JOB.*Job_date;

 EXECUTE FUNCTION(Chg MPR Control       CH) TYPE(CHGOBJ) FILE(PWARREP)           AB1352357;
 PARAMETER(DB1.Company);
 PARAMETER(LCL.MPR_Last_Kill_Dt_Reported);
 PARAMETER(LCL.MPR_Prior_Kill_Dt_Reportd);
 PARAMETER(LCL.MPR_Date_of_Last_Job);
 PARAMETER(DB1.MPR_date_unused);
 PARAMETER(DB1.MPR_Status);
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp-SysDtIF) TYPE(EXCINTFUN)                      AB1237006;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // Call program Rtv System Date & Tim UP.
   CALL PROGRAM(Rtv System Date & Tim UP) ('PKWDUPC');
   PARAMETER(PAR.RS_Date_Changed);
   PARAMETER(PAR.RS_Time_Changed);

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 ENDIF;

}


