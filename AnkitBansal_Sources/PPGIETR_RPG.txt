     H/TITLE Edt Bill of Material  ET  Edit transaction
     H            Y
     Z* CRTSQLRPG
     Z* COMMIT(*NONE) DATFMT(*ISO) DATSEP(-) TIMFMT(*ISO)
     Z* TIMSEP('.')
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Maintain DBF header and associated DBF detail records
     H* - DBF header record fields appear on SFL control record
     H* - DBF detail records appear on SFL detail record
     H* - Program functions in two modes : *ADD and *CHANGE
     H* - Existing records may be updated or deleted
     H*   But key changes are not allowed
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit transaction
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPJAKH
     H* Date          : 11/26/24  Time  : 02:42:35
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPPGIETR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Edt Bill of Material  ET  Edit transaction
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 023  5 0A
     E                    W0END   7 023  5 0A
     E                    W0NAM   7 023 10
      * Long constants
     E                    @CN#    1  08  6   @CN    25
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC      DS
      * UPD : Company Item              Update index
     I                                    P   1   20BZAIC3
     I                                    P   3   60BZHGCD
     I                                        7  36 BZAVNA
     I                                       37  66 BZAWNA
     I                                       67  98 BZL7NA
     I                                       99 130 BZL8NA
     I                                      131 162 BZL6NA
     I                                      163 194 BZMFNA
     I                                      195 196 BZADCD
     I                                    P 197 2014BZAWPC
     I                                      202 202 BZLXST
     I                                      203 204 BZAECD
     I                                    P 205 2094BZAXPC
     I                                      210 210 BZLYST
     I                                      211 212 BZAFCD
     I                                      213 214 BZAICD
     I                                    P 215 2202BZAIWG
     I                                      221 222 BZHICD
     I                                      223 224 BZRBCD
     I                                      225 225 BZFZST
     I                                      226 226 BZAVST
     I                                    P 227 2322BZCZWG
     I                                    P 233 2382BZC0WG
     I                                    P 239 2410BZURTN
     I                                    P 242 2460BZAJC8
     I                                    P 247 2480BZRINB
     I                                    P 249 2500BZRHNB
     I                                    P 251 2520BZRGNB
     I                                      253 255 BZLNCD
     I                                    P 256 2570BZTFNB
     I                                      258 260 BZN0CD
     I                                      261 261 BZX4ST
     I                                    P 262 2672BZTMVA
     I                                    P 268 2732BZTNVA
     I                                    P 274 2794BZBLPR
     I                                    P 280 2854BZBMPR
     I                                      286 292 BZLRCD
     I                                      293 293 BZU9ST
     I                                    P 294 2994BZCMCO
     I                                      300 302 BZQ1CD
     I                                      303 305 BZQ8CD
     I                                    P 306 3082BZCHTM
     I                                      309 310 BZQZCD
     I                                      311 311 BZXWST
     I                                      312 312 BZXXST
     I                                      313 313 BZVMST
     I                                    P 314 3192BZSWGH
     I                                    P 320 3230BZPPHE
     I                                      324 329 BZR3CD
     I                                      330 330 BZSDCD
     I                                    P 331 3320BZICN1
     I                                      333 335 BZSVCD
     I                                    P 336 3370BZICN2
     I                                      338 340 BZSWCD
     I                                    P 341 3420BZV2NB
     I                                      343 345 BZSXCD
     I                                    P 346 3470BZITCN
     I                                      348 350 BZSYCD
     I                                    P 351 3520BZITC5
     I                                      353 355 BZSZCD
     I                                    P 356 3570BZICN6
     I                                      358 360 BZS0CD
     I                                    P 361 3620BZICN7
     I                                      363 365 BZS1CD
     I                                    P 366 3670BZICN8
     I                                      368 370 BZS2CD
     I                                    P 371 3720BZICN9
     I                                      373 375 BZS3CD
     I                                    P 376 3770BZICN0
     I                                      378 380 BZS4CD
     I                                    P 381 3832BZSFNB
     I                                    P 384 3862BZA3WG
     I                                    P 387 3880BZSJNB
     I                                      389 391 BZLLCD
     I                                      392 394 BZLMCD
     I                                      395 395 BZP3ST
     I                                    P 396 3970BZSKNB
     I                                    P 398 3980BZSLNB
     I                                    P 399 4000BZSMNB
     I                                      401 401 BZP4ST
     I                                    P 402 4074BZCFNB
     I                                    P 408 4114BZCGNB
     I                                    P 412 4154BZILNB
     I                                    P 416 4170BZCHNB
     I                                    P 418 4234BZCINB
     I                                    P 424 4294BZCJNB
     I                                    P 430 4330BZCMNB
     I                                    P 434 4370BZCNNB
     I                                    P 438 4410BZCRNB
     I                                    P 442 4462BZCSNB
     I                                    P 447 4512BZCVNB
     I                                    P 452 4574BZCWNB
     I                                    P 458 4634BZCXNB
     I                                    P 464 4694BZCZNB
     I                                    P 470 4754BZC0NB
     I                                      476 478 BZN1CD
     I                                    P 479 4800BZB4NB
     I                                    P 481 4830BZB5NB
     I                                      484 484 BZX5ST
     I                                      485 486 BZX6ST
     I                                      487 489 BZX7ST
     I                                      490 490 BZPCCT
     I                                    P 491 4940BZBDNB
     I                                    P 495 4980BZBJNB
     I                                      499 499 BZSUST
     I                                      500 500 BZSVST
     I                                      501 501 BZSYST
     I                                      502 502 BZSZST
     I                                      503 503 BZS1ST
     I                                      504 509 BZXRCD
     I                                      510 521 BZXTCD
     I                                      522 533 BZXUCD
     I                                    P 534 5392BZF5WG
     I                                    P 540 5452BZF6WG
     I                                    P 546 5512BZF7WG
     I                                    P 552 5550BZBLNB
     I                                    P 556 5590BZBNNB
     I                                      560 560 BZS2ST
     I                                      561 561 BZS4ST
     I                                      562 562 BZS5ST
     I                                      563 563 BZS6ST
     I                                      564 565 BZS8ST
     I                                      566 567 BZS9ST
     I                                      568 570 BZTCST
     I                                      571 573 BZTDST
     I                                      574 574 BZUVST
     I                                      575 575 BZUWST
     I                                      576 576 BZUXST
     I                                      577 577 BZVSST
     I                                    P 578 5810BZAATM
     I                                      582 591 BZAYNA
     I                                      592 601 BZA0NA
     I                                    P 602 6050BZAXDT
      *
      *
     I@2DBRC      DS
      * UPD : Item Bill Of Material     Update index
     I                                    P   1   20IOAIC3
     I                                    P   3   60IOHGCD
     I                                    P   7  100IOC9NB
     I                                       11  11 IOV2ST
     I                                    P  12  142IOBOPR
     I                                    P  15  172IOBPPR
     I                                    P  18  232IOHGQT
     I                                       24  25 IOHHCD
     I                                       26  26 IOYAST
     I                                    P  27  290IOCNSM
     I                                    P  30  322IOBMY1
     I                                    P  33  352IOBMY2
     I                                    P  36  412IOIXQT
     I                                    P  42  472IOIYQT
     I                                       48  48 IORSST
     I                                       49  50 IORTST
     I                                       51  51 IOUVST
     I                                       52  52 IOUWST
     I                                       53  53 IOUXST
     I                                       54  54 IOVSST
     I                                    P  55  580IOAATM
     I                                       59  68 IOAYNA
     I                                       69  78 IOA0NA
     I                                    P  79  820IOAXDT
      *
      *
      * Rename fields of major file
     IQCABZ1    E DSCABZRELC
      * SPN : Company Item              SPN Item/BOM
     I              BZAIC3                          X@AIC3
     I              BZHGCD                          X@HGCD
     I              BZAVNA                          X@AVNA
     I              BZAWNA                          X@AWNA
     I              BZL7NA                          X@L7NA
     I              BZL8NA                          X@L8NA
     I              BZL6NA                          X@L6NA
     I              BZMFNA                          X@MFNA
     I              BZADCD                          X@ADCD
     I              BZAWPC                          X@AWPC
     I              BZLXST                          X@LXST
     I              BZAECD                          X@AECD
     I              BZAXPC                          X@AXPC
     I              BZLYST                          X@LYST
     I              BZAFCD                          X@AFCD
     I              BZAICD                          X@AICD
     I              BZAIWG                          X@AIWG
     I              BZHICD                          X@HICD
     I              BZRBCD                          X@RBCD
     I              BZFZST                          X@FZST
     I              BZAVST                          X@AVST
     I              BZCZWG                          X@CZWG
     I              BZC0WG                          X@C0WG
     I              BZURTN                          X@URTN
     I              BZAJC8                          X@AJC8
     I              BZRINB                          X@RINB
     I              BZRHNB                          X@RHNB
     I              BZRGNB                          X@RGNB
     I              BZLNCD                          X@LNCD
     I              BZTFNB                          X@TFNB
     I              BZN0CD                          X@N0CD
     I              BZX4ST                          X@X4ST
     I              BZTMVA                          X@TMVA
     I              BZTNVA                          X@TNVA
     I              BZBLPR                          X@BLPR
     I              BZBMPR                          X@BMPR
     I              BZLRCD                          X@LRCD
     I              BZU9ST                          X@U9ST
     I              BZCMCO                          X@CMCO
     I              BZQ1CD                          X@Q1CD
     I              BZQ8CD                          X@Q8CD
     I              BZCHTM                          X@CHTM
     I              BZQZCD                          X@QZCD
     I              BZXWST                          X@XWST
     I              BZXXST                          X@XXST
     I              BZVMST                          X@VMST
     I              BZSWGH                          X@SWGH
     I              BZPPHE                          X@PPHE
     I              BZR3CD                          X@R3CD
     I              BZSDCD                          X@SDCD
     I              BZSFNB                          X@SFNB
     I              BZA3WG                          X@A3WG
     I              BZSJNB                          X@SJNB
     I              BZLLCD                          X@LLCD
     I              BZLMCD                          X@LMCD
     I              BZP3ST                          X@P3ST
     I              BZSKNB                          X@SKNB
     I              BZSLNB                          X@SLNB
     I              BZSMNB                          X@SMNB
     I              BZP4ST                          X@P4ST
     I              BZCFNB                          X@CFNB
     I              BZCGNB                          X@CGNB
     I              BZILNB                          X@ILNB
     I              BZCHNB                          X@CHNB
     I              BZCINB                          X@CINB
     I              BZCJNB                          X@CJNB
     I              BZCMNB                          X@CMNB
     I              BZCNNB                          X@CNNB
     I              BZCRNB                          X@CRNB
     I              BZCSNB                          X@CSNB
     I              BZCVNB                          X@CVNB
     I              BZCWNB                          X@CWNB
     I              BZCXNB                          X@CXNB
     I              BZCZNB                          X@CZNB
     I              BZC0NB                          X@C0NB
     I              BZN1CD                          X@N1CD
     I              BZB4NB                          X@B4NB
     I              BZB5NB                          X@B5NB
     I              BZX5ST                          X@X5ST
     I              BZX6ST                          X@X6ST
     I              BZX7ST                          X@X7ST
     I              BZPCCT                          X@PCCT
     I              BZBDNB                          X@BDNB
     I              BZBJNB                          X@BJNB
     I              BZSUST                          X@SUST
     I              BZSVST                          X@SVST
     I              BZSYST                          X@SYST
     I              BZSZST                          X@SZST
     I              BZS1ST                          X@S1ST
     I              BZXRCD                          X@XRCD
     I              BZXTCD                          X@XTCD
     I              BZXUCD                          X@XUCD
     I              BZF5WG                          X@F5WG
     I              BZF6WG                          X@F6WG
     I              BZF7WG                          X@F7WG
     I              BZBLNB                          X@BLNB
     I              BZBNNB                          X@BNNB
     I              BZS2ST                          X@S2ST
     I              BZS4ST                          X@S4ST
     I              BZS5ST                          X@S5ST
     I              BZS6ST                          X@S6ST
     I              BZS8ST                          X@S8ST
     I              BZS9ST                          X@S9ST
     I              BZTCST                          X@TCST
     I              BZTDST                          X@TDST
     I              BZUVST                          X@UVST
     I              BZUWST                          X@UWST
     I              BZUXST                          X@UXST
     I              BZVSST                          X@VSST
     I              BZAATM                          X@AATM
     I              BZAYNA                          X@AYNA
     I              BZA0NA                          X@A0NA
     I              BZAXDT                          X@AXDT
      * Rename fields of major file
     IQCABZ2    E DSCABZRELCV
      * SPN : Company Item              SPN Item/BOM
     I              IOAIC3                          X#AIC3
     I              IOHGCD                          X#HGCD
     I              IOC9NB                          X#C9NB
     I              IOV2ST                          X#V2ST
     I              IOBOPR                          X#BOPR
     I              IOBPPR                          X#BPPR
     I              IOHGQT                          X#HGQT
     I              IOHHCD                          X#HHCD
     I              IOYAST                          X#YAST
     I              IOCNSM                          X#CNSM
     I              IOBMY1                          X#BMY1
     I              IOBMY2                          X#BMY2
     I              IOIXQT                          X#IXQT
     I              IOIYQT                          X#IYQT
     I              IORSST                          X#RSST
     I              IORTST                          X#RTST
     I              IOUVST                          X#UVST
     I              IOUWST                          X#UWST
     I              IOUXST                          X#UXST
     I              IOVSST                          X#VSST
     I              IOAATM                          X#AATM
     I              IOAYNA                          X#AYNA
     I              IOA0NA                          X#A0NA
     I              IOAXDT                          X#AXDT
     IQPDIO1      DS
      * RSQ : Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
     I                                    P   1   20WAAIC3
     I                                    P   3   60WAHGCD
     I                                    P   7  100WAC9NB
     I                                       11  11 WAV2ST
     I                                    P  12  142WABOPR
     I                                    P  15  172WABPPR
     I                                    P  18  232WAHGQT
     I                                       24  25 WAHHCD
     I                                       26  26 WAYAST
     I                                    P  27  290WACNSM
     I                                    P  30  322WABMY1
     I                                    P  33  352WABMY2
     I                                    P  36  412WAIXQT
     I                                    P  42  472WAIYQT
     I                                       48  48 WARSST
     I                                       49  50 WARTST
     I                                       51  51 WAUVST
     I                                       52  52 WAUWST
     I                                       53  53 WAUXST
     I                                       54  54 WAVSST
     I                                    P  55  580WAAATM
     I                                       59  68 WAAYNA
     I                                       69  78 WAA0NA
     I                                    P  79  820WAAXDT
      *
     IQPMFD1      DS
      * RTV : Company Item Ext          Retrieval index
     I                                    P   1   20FDAIC3
     I                                    P   3   60FDHGCD
     I                                        7   7 FDD0ST
     I                                        8   8 FDD2ST
     I                                        9   9 FDD6ST
     I                                       10  10 FDWESP
     I                                       11  11 FDEDST
     I                                       12  12 FDEFST
     I                                       13  13 FDEHST
     I                                       14  14 FDEMST
     I                                       15  15 FDENST
     I                                       16  16 FDEOST
     I                                       17  18 FDEPST
     I                                       19  20 FDEQST
     I                                    P  21  262FDOQNY
     I                                    P  27  320FDORNY
     I                                    P  33  360FDS2DT
     I                                       37  61 FDUFT1
     I                                       62  67 FDKUAA
     I                                       68  68 FDVSST
     I                                    P  69  720FDMJDT
     I                                    P  73  760FDBETM
     I                                       77  86 FDCCVN
     I                                       87  96 FDCDVN
     I                                    P  97 1000FDMKDT
     I                                    P 101 1040FDBFTM
     I                                      105 114 FDCEVN
     I                                      115 124 FDCFVN
      *
     IQCABZ3      DS
      * RTV : Company Item              Retrieval index       NV
     I                                    P   1   20WBAIC3
     I                                    P   3   60WBHGCD
     I                                        7  36 WBAVNA
     I                                       37  66 WBAWNA
     I                                       67  98 WBL7NA
     I                                       99 130 WBL8NA
     I                                      131 162 WBL6NA
     I                                      163 194 WBMFNA
     I                                      195 196 WBADCD
     I                                    P 197 2014WBAWPC
     I                                      202 202 WBLXST
     I                                      203 204 WBAECD
     I                                    P 205 2094WBAXPC
     I                                      210 210 WBLYST
     I                                      211 212 WBAFCD
     I                                      213 214 WBAICD
     I                                    P 215 2202WBAIWG
     I                                      221 222 WBHICD
     I                                      223 224 WBRBCD
     I                                      225 225 WBFZST
     I                                      226 226 WBAVST
     I                                    P 227 2322WBCZWG
     I                                    P 233 2382WBC0WG
     I                                    P 239 2410WBURTN
     I                                    P 242 2460WBAJC8
     I                                    P 247 2480WBRINB
     I                                    P 249 2500WBRHNB
     I                                    P 251 2520WBRGNB
     I                                      253 255 WBLNCD
     I                                    P 256 2570WBTFNB
     I                                      258 260 WBN0CD
     I                                      261 261 WBX4ST
     I                                    P 262 2672WBTMVA
     I                                    P 268 2732WBTNVA
     I                                    P 274 2794WBBLPR
     I                                    P 280 2854WBBMPR
     I                                      286 292 WBLRCD
     I                                      293 293 WBU9ST
     I                                    P 294 2994WBCMCO
     I                                      300 302 WBQ1CD
     I                                      303 305 WBQ8CD
     I                                    P 306 3082WBCHTM
     I                                      309 310 WBQZCD
     I                                      311 311 WBXWST
     I                                      312 312 WBXXST
     I                                      313 313 WBVMST
     I                                    P 314 3192WBSWGH
     I                                    P 320 3230WBPPHE
     I                                      324 329 WBR3CD
     I                                      330 330 WBSDCD
     I                                    P 331 3320WBICN1
     I                                      333 335 WBSVCD
     I                                    P 336 3370WBICN2
     I                                      338 340 WBSWCD
     I                                    P 341 3420WBV2NB
     I                                      343 345 WBSXCD
     I                                    P 346 3470WBITCN
     I                                      348 350 WBSYCD
     I                                    P 351 3520WBITC5
     I                                      353 355 WBSZCD
     I                                    P 356 3570WBICN6
     I                                      358 360 WBS0CD
     I                                    P 361 3620WBICN7
     I                                      363 365 WBS1CD
     I                                    P 366 3670WBICN8
     I                                      368 370 WBS2CD
     I                                    P 371 3720WBICN9
     I                                      373 375 WBS3CD
     I                                    P 376 3770WBICN0
     I                                      378 380 WBS4CD
     I                                    P 381 3832WBSFNB
     I                                    P 384 3862WBA3WG
     I                                    P 387 3880WBSJNB
     I                                      389 391 WBLLCD
     I                                      392 394 WBLMCD
     I                                      395 395 WBP3ST
     I                                    P 396 3970WBSKNB
     I                                    P 398 3980WBSLNB
     I                                    P 399 4000WBSMNB
     I                                      401 401 WBP4ST
     I                                    P 402 4074WBCFNB
     I                                    P 408 4114WBCGNB
     I                                    P 412 4154WBILNB
     I                                    P 416 4170WBCHNB
     I                                    P 418 4234WBCINB
     I                                    P 424 4294WBCJNB
     I                                    P 430 4330WBCMNB
     I                                    P 434 4370WBCNNB
     I                                    P 438 4410WBCRNB
     I                                    P 442 4462WBCSNB
     I                                    P 447 4512WBCVNB
     I                                    P 452 4574WBCWNB
     I                                    P 458 4634WBCXNB
     I                                    P 464 4694WBCZNB
     I                                    P 470 4754WBC0NB
     I                                      476 478 WBN1CD
     I                                    P 479 4800WBB4NB
     I                                    P 481 4830WBB5NB
     I                                      484 484 WBX5ST
     I                                      485 486 WBX6ST
     I                                      487 489 WBX7ST
     I                                      490 490 WBPCCT
     I                                    P 491 4940WBBDNB
     I                                    P 495 4980WBBJNB
     I                                      499 499 WBSUST
     I                                      500 500 WBSVST
     I                                      501 501 WBSYST
     I                                      502 502 WBSZST
     I                                      503 503 WBS1ST
     I                                      504 509 WBXRCD
     I                                      510 521 WBXTCD
     I                                      522 533 WBXUCD
     I                                    P 534 5392WBF5WG
     I                                    P 540 5452WBF6WG
     I                                    P 546 5512WBF7WG
     I                                    P 552 5550WBBLNB
     I                                    P 556 5590WBBNNB
     I                                      560 560 WBS2ST
     I                                      561 561 WBS4ST
     I                                      562 562 WBS5ST
     I                                      563 563 WBS6ST
     I                                      564 565 WBS8ST
     I                                      566 567 WBS9ST
     I                                      568 570 WBTCST
     I                                      571 573 WBTDST
     I                                      574 574 WBUVST
     I                                      575 575 WBUWST
     I                                      576 576 WBUXST
     I                                      577 577 WBVSST
     I                                    P 578 5810WBAATM
     I                                      582 591 WBAYNA
     I                                      592 601 WBA0NA
     I                                    P 602 6050WBAXDT
      *
     IQCAAM1      DS
      * RTV : Unit of Measure           Retrieval index       NV
     I                                        1   2 AMHHCD
     I                                        3  32 AMAUNA
     I                                       33  33 AMUVST
     I                                       34  34 AMUWST
     I                                       35  35 AMUXST
     I                                       36  36 AMVSST
     I                                    P  37  400AMAATM
     I                                       41  50 AMAYNA
     I                                       51  60 AMA0NA
     I                                    P  61  640AMAXDT
      *
     IQCAAI1      DS
      * RTV : Quality Level             Retrieval index       NV
     I                                        1   2 AIHICD
     I                                        3  32 AIAUNA
     I                                    P  33  350AIA7DT
     I                                    P  36  380AIA8DT
     I                                       39  39 AIUVST
     I                                       40  40 AIUWST
     I                                       41  41 AIUXST
     I                                       42  42 AIVSST
     I                                    P  43  460AIAATM
     I                                       47  56 AIAYNA
     I                                       57  66 AIA0NA
     I                                    P  67  700AIAXDT
      *
     IQPDIL1      DS
      * RTV : Item Level Codes          Retrieval index
     I                                        1   2 ILRBCD
     I                                        3  32 ILAUNA
     I                                       33  33 ILUVST
     I                                       34  34 ILUWST
     I                                       35  35 ILUXST
     I                                       36  36 ILVSST
     I                                    P  37  400ILAATM
     I                                       41  50 ILAYNA
     I                                       51  60 ILA0NA
     I                                    P  61  640ILAXDT
      *
     IQCABJ1      DS
      * RTV : Vendor Master             Retrieval index       NV
     I                                    P   1   50BJACC8
     I                                        6  35 BJBATX
     I                                       36  65 BJACNA
     I                                       66  95 BJADNA
     I                                       96 125 BJAENA
     I                                      126 145 BJAJNA
     I                                      146 147 BJBGCD
     I                                      148 153 BJG5CD
     I                                      154 164 BJBTTX
     I                                      165 189 BJBVTX
     I                                      190 214 BJBWTX
     I                                      215 239 BJABTX
     I                                      240 259 BJA2NA
     I                                    P 260 2652BJASVA
     I                                    P 266 2690BJNLNB
     I                                      270 271 BJBOCD
     I                                    P 272 2760BJADC8
     I                                    P 277 2810BJAFC8
     I                                      282 282 BJUVST
     I                                      283 283 BJUWST
     I                                      284 284 BJUXST
     I                                      285 285 BJVSST
     I                                    P 286 2890BJAATM
     I                                      290 299 BJAYNA
     I                                      300 309 BJA0NA
     I                                    P 310 3130BJAXDT
      *
     IQOMFA1      DS
      * RTV : Item Structure Class      Retrieval index
     I                                    P   1   20FARINB
     I                                    P   3   40FARHNB
     I                                        5  34 FADETX
     I                                       35  35 FAUVST
     I                                       36  36 FAUWST
     I                                       37  37 FAUXST
     I                                       38  38 FAVSST
     I                                    P  39  420FAAATM
     I                                       43  52 FAAYNA
     I                                       53  62 FAA0NA
     I                                    P  63  660FAAXDT
      *
     IQOME91      DS
      * RTV : Item Structure Group      Retrieval index
     I                                    P   1   20E9RHNB
     I                                    P   3   40E9RGNB
     I                                        5  34 E9DDTX
     I                                       35  35 E9UVST
     I                                       36  36 E9UWST
     I                                       37  37 E9UXST
     I                                       38  38 E9VSST
     I                                    P  39  420E9AATM
     I                                       43  52 E9AYNA
     I                                       53  62 E9A0NA
     I                                    P  63  660E9AXDT
      *
     IQOME81      DS
      * RTV : Item Structure Type       Retrieval index
     I                                    P   1   20E8RGNB
     I                                        3  32 E8DCTX
     I                                       33  33 E8UVST
     I                                       34  34 E8UWST
     I                                       35  35 E8UXST
     I                                       36  36 E8VSST
     I                                    P  37  400E8AATM
     I                                       41  50 E8AYNA
     I                                       51  60 E8A0NA
     I                                    P  61  640E8AXDT
      *
     IQOMFZ1    E DSOMFZREL0
      * RTV : Commodity Group           Retrieval index
      *
     IQCAAD1      DS
      * RTV : Warehouse Codes           Retrieval index       NV
     I                                        1   3 ADAJCD
     I                                        4  33 ADF8NA
     I                                       34  63 ADACNA
     I                                       64  93 ADADNA
     I                                       94 123 ADAENA
     I                                      124 143 ADAJNA
     I                                      144 154 ADBTTX
     I                                      155 157 ADAOCD
     I                                      158 159 ADBGCD
     I                                      160 160 ADVHST
     I                                      161 170 ADMPNA
     I                                      171 172 ADWPST
     I                                      173 173 ADXUST
     I                                      174 174 ADT0ST
     I                                      175 175 ADT1ST
     I                                    P 176 1782ADDBNB
     I                                      179 179 ADT2ST
     I                                      180 180 ADT3ST
     I                                      181 181 ADT4ST
     I                                      182 182 ADT6ST
     I                                    P 183 1840ADBWC3
     I                                    P 185 1860ADBTC3
     I                                    P 187 1880ADBUC3
     I                                    P 189 1900ADBVC3
     I                                      191 193 ADFCAA
     I                                      194 194 ADRQSX
     I                                      195 195 ADRRSX
     I                                      196 196 ADRSSX
     I                                      197 197 ADRTSX
     I                                      198 199 ADT7ST
     I                                      200 201 ADT8ST
     I                                      202 204 ADRNSX
     I                                      205 207 ADROSX
     I                                      208 210 ADRPSX
     I                                      211 211 ADUVST
     I                                      212 212 ADUWST
     I                                      213 213 ADUXST
     I                                      214 214 ADVSST
     I                                    P 215 2180ADAATM
     I                                      219 228 ADAYNA
     I                                      229 238 ADA0NA
     I                                    P 239 2420ADAXDT
     I                                      243 243 ADQDSC
      *
     IQPDIH1    E DSPDIHREL0
      * RTV : Price Method Header       Retrieval index
      *
     IQPDI51      DS
      * RTV : PS Production Department  Retrieval index
     I                                    P   1   20I5AIC3
     I                                        3   8 I5R3CD
     I                                        9  38 I5MYNA
     I                                       39  39 I5DPT1
     I                                       40  40 I5UVST
     I                                       41  41 I5UWST
     I                                       42  42 I5UXST
     I                                       43  43 I5VSST
     I                                    P  44  470I5AATM
     I                                       48  57 I5AYNA
     I                                       58  67 I5A0NA
     I                                    P  68  710I5AXDT
      *
     IQPDJG1      DS
      * RTV : Item Category Packaging   Retrieval index
     I                                    P   1   20JGAIC3
     I                                        3   3 JGSDCD
     I                                        4  33 JGM0NA
     I                                       34  34 JGUVST
     I                                       35  35 JGUWST
     I                                       36  36 JGUXST
     I                                       37  37 JGVSST
     I                                    P  38  410JGAATM
     I                                       42  51 JGAYNA
     I                                       52  61 JGA0NA
     I                                    P  62  650JGAXDT
      *
     IQPMG11      DS
      * RTV : PM R/M Type Master        Retrieval index
     I                                    P   1   20G1B4NB
     I                                        3   3 G1UVST
     I                                        4   4 G1UWST
     I                                        5   5 G1UXST
     I                                    P   6   90G1AATM
     I                                       10  19 G1AYNA
     I                                       20  29 G1A0NA
     I                                    P  30  330G1AXDT
     I                                       34  63 G1KVNA
      *
     IQPMG21      DS
      * RTV : PM Line Master            Retrieval index
     I                                    P   1   20G2AIC3
     I                                    P   3   50G2B5NB
     I                                        6  35 G2KWNA
     I                                    P  36  370G2B6NB
     I                                    P  38  402G2B7NB
     I                                    P  41  444G2B8NB
     I                                       45  45 G2UVST
     I                                       46  46 G2UWST
     I                                       47  47 G2UXST
     I                                    P  48  510G2AATM
     I                                       52  61 G2AYNA
     I                                       62  71 G2A0NA
     I                                    P  72  750G2AXDT
      *
     IQPDLL1      DS
      * RTV : PS Primal Group           Retrieval index
     I                                        1   6 LLXRCD
     I                                        7  36 LLOJNA
     I                                       37  37 LLR9ST
     I                                       38  38 LLSAST
     I                                       39  39 LLSEST
     I                                       40  41 LLSFST
     I                                       42  43 LLSJST
     I                                       44  44 LLUVST
     I                                       45  45 LLUWST
     I                                       46  46 LLUXST
     I                                       47  47 LLVSST
     I                                    P  48  510LLAATM
     I                                       52  61 LLAYNA
     I                                       62  71 LLA0NA
     I                                    P  72  750LLAXDT
      *
     IQPBBL1      DS
      * RTV : Company Item Std Prd Dflt Retrieval index
     I                                    P   1   20BLAIC3
     I                                    P   3   60BLHGCD
     I                                        7   7 BLBLSP
     I                                        8   8 BLUVST
     I                                        9   9 BLUWST
     I                                       10  10 BLUXST
     I                                       11  11 BLVSST
     I                                    P  12  150BLAATM
     I                                       16  25 BLAYNA
     I                                       26  35 BLA0NA
     I                                    P  36  390BLAXDT
      *
     IQPDJY1      DS
      * RTV : Company Defaults Internal Active Records
     I                                    P   1   20JYAIC3
     I                                        3   4 JYZ9ST
     I                                        5   5 JYCSST
     I                                        6   6 JYZ8ST
     I                                        7   7 JYCXST
     I                                        8   8 JYSWST
     I                                    P   9  110JYXXTM
     I                                       12  17 JYUECD
     I                                       18  18 JYHSST
     I                                       19  19 JYAMEO
     I                                       20  20 JYSSDF
     I                                       21  21 JYPDFT
     I                                       22  22 JYYISX
     I                                       23  23 JYYJSX
     I                                       24  24 JYYKSX
     I                                       25  25 JYYLSX
     I                                       26  27 JYYMSX
     I                                       28  29 JYYNSX
     I                                       30  30 JYUVST
     I                                       31  31 JYUWST
     I                                       32  32 JYUXST
     I                                       33  33 JYVSST
     I                                    P  34  370JYAATM
     I                                       38  47 JYAYNA
     I                                       48  57 JYA0NA
     I                                    P  58  610JYAXDT
      *
     IQPDIO2      DS
      * RTV : Item Bill Of Material     Retrieval index
     I                                    P   1   20WCAIC3
     I                                    P   3   60WCHGCD
     I                                    P   7  100WCC9NB
     I                                       11  11 WCV2ST
     I                                    P  12  142WCBOPR
     I                                    P  15  172WCBPPR
     I                                    P  18  232WCHGQT
     I                                       24  25 WCHHCD
     I                                       26  26 WCYAST
     I                                    P  27  290WCCNSM
     I                                    P  30  322WCBMY1
     I                                    P  33  352WCBMY2
     I                                    P  36  412WCIXQT
     I                                    P  42  472WCIYQT
     I                                       48  48 WCRSST
     I                                       49  50 WCRTST
     I                                       51  51 WCUVST
     I                                       52  52 WCUWST
     I                                       53  53 WCUXST
     I                                       54  54 WCVSST
     I                                    P  55  580WCAATM
     I                                       59  68 WCAYNA
     I                                       69  78 WCA0NA
     I                                    P  79  820WCAXDT
      *
     IYARDCS      DS                             82
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPMFD2      DS
      * UPD : Company Item Ext          Update index
     I                                    P   1   20WDAIC3
     I                                    P   3   60WDHGCD
     I                                        7   7 WDD0ST
     I                                        8   8 WDD2ST
     I                                        9   9 WDD6ST
     I                                       10  10 WDWESP
     I                                       11  11 WDEDST
     I                                       12  12 WDEFST
     I                                       13  13 WDEHST
     I                                       14  14 WDEMST
     I                                       15  15 WDENST
     I                                       16  16 WDEOST
     I                                       17  18 WDEPST
     I                                       19  20 WDEQST
     I                                    P  21  262WDOQNY
     I                                    P  27  320WDORNY
     I                                    P  33  360WDS2DT
     I                                       37  61 WDUFT1
     I                                       62  67 WDKUAA
     I                                       68  68 WDVSST
     I                                    P  69  720WDMJDT
     I                                    P  73  760WDBETM
     I                                       77  86 WDCCVN
     I                                       87  96 WDCDVN
     I                                    P  97 1000WDMKDT
     I                                    P 101 1040WDBFTM
     I                                      105 114 WDCEVN
     I                                      115 124 WDCFVN
      *
     IYBRDCS      DS                            124
     IQCAAB1      DS
      * RTV : Company Name and Address  Retrieval index       V
     I                                    P   1   20ABAIC3
     I                                        3  32 ABADTX
     I                                       33  62 ABACNA
     I                                       63  92 ABADNA
     I                                       93 122 ABAENA
     I                                      123 142 ABAJNA
     I                                      143 153 ABBTTX
     I                                      154 178 ABBVTX
     I                                      179 203 ABBWTX
     I                                      204 223 ABA2NA
     I                                      224 248 ABABTX
     I                                      249 250 ABBGCD
     I                                      251 256 ABKXCD
     I                                      257 257 ABUVST
     I                                      258 258 ABUWST
     I                                      259 259 ABUXST
     I                                      260 260 ABVSST
     I                                    P 261 2640ABAATM
     I                                      265 274 ABAYNA
     I                                      275 284 ABA0NA
     I                                    P 285 2880ABAXDT
      *
     IQCADN1      DS
      * RSQ : Application               RSQ Application Code
     I                                        1   6 DNDNCD
     I                                        7  36 DNAUNA
     I                                       37  37 DNVKST
     I                                       38  43 DNRSCD
     I                                       44  44 DNUVST
     I                                       45  45 DNUWST
     I                                       46  46 DNUXST
     I                                    P  47  500DNAATM
     I                                       51  60 DNAYNA
     I                                       61  70 DNA0NA
     I                                    P  71  740DNAXDT
      *
     IQPDKM1      DS
      * RTV : Company Values            Retrieval index
     I                                    P   1   20KMAIC3
     I                                        3  12 KMV8CD
     I                                       13  42 KMAUNA
     I                                       43  43 KMI5ST
     I                                       44  83 KMBXTX
     I                                    P  84  915KMM8NB
     I                                       92  92 KMUVST
     I                                       93  93 KMUWST
     I                                       94  94 KMUXST
     I                                       95  95 KMVSST
     I                                    P  96  990KMAATM
     I                                      100 109 KMAYNA
     I                                      110 119 KMA0NA
     I                                    P 120 1230KMAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * N :  USR Display field
     I                                        1   1 P1GGST
     IP2PARM      DS
      * FLD: Item Bill Of Material
      * I : RST Company Number
     I                                    P   1   20P2AIC3
      * I : RST Item Code
     I                                    P   3   60P2HGCD
      * N :  Component Item Code
     I                                    P   7  100P2C9NB
      * N :  BOM Type
     I                                       11  11 P2V2ST
      * N :  Record Status
     I                                       12  12 P2VSST
     IP3PARM      DS
      * N :  Error Status
     I                                        1   1 P3ECST
     IP4PARM      DS
      * N :  Item Code USR
     I                                    P   1   40P4B6C7
     IP5PARM      DS
      * FLD: AS Product
      * N :  AS Product Code
     I                                        1   5 P5ASPD
      * N :  AS Product Description 1
     I                                        6  30 P5IDTX
      * N :  AS Product Description 2
     I                                       31  55 P5IETX
      * N :  AS Product Description 3
     I                                       56  80 P5I7TX
      * N :  AS Manufacturers Code
     I                                       81  87 P5ASMC
      * N :  AS Nominal Weight
     I                                       88  93 P5EJWG
      * N :  AS Hi Weight Limit
     I                                       94  99 P5EKWG
      * N :  AS Lo Weight Limit
     I                                      100 105 P5ELWG
      * N :  AS Box ID
     I                                      106 107 P5ASBX
      * N :  AS Misc Tare Weight
     I                                      108 112 P5ASTW
      * N :  AS Pallet Quantity
     I                                      113 115 P5ASPQ
      * N :  AS Warehouse ID Code
     I                                      116 118 P5UYCD
      * N :  AS Add/Change/Delete
     I                                      119 119 P5Y5ST
      * N :  AS Carriage Return
     I                                      120 120 P5TVCD
     IP6PARM      DS
      * I :  BOM Type Usr
     I                                        1   1 P6YYST
     IP7PARM      DS
      * N :  Edt SlsYld,Pump%&Meat$Co?
     I                                        1   1 P7ELSC
     IP8PARM      DS
      * N :  Sync with Company USR
     I                                    P   1   20P8DEC3
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Prod Yield for Consumed'
      * Production Yield
     I                                    P   1   32ZA0001
      * Message data for 'Sales Yield for Consumed'
      * Sales Yield
     I                                    P   1   32ZA0002
      * Message data for 'Prod Yield for Produced'
      * Production Yield
     I                                    P   1   32ZA0003
      * Message data for 'Meat Cost Consume %'
      * BOM Meat Cost ConsumedPCT
     I                                    P   1   62ZA0004
      * Message data for 'Sales Yield for Produced'
      * Sales Yield
     I                                    P   1   32ZA0005
      * Message data for 'Consume Pty % not 100%'
      * Consume Priority Percent
     I                                    P   1   32ZA0006
      * Message data for 'Consume Pty % Last ne 100'
      * Consume Priority Percent
     I                                    P   1   32ZA0007
      * Message data for 'CD7 Non numeric data'
      * Message data for 'User cant maint. Bom type'
      * Message data for 'User cant maint. Bom type'
      * Message data for 'Consume Pty Req'
      * Consume Priority
     I                                    P   1   30ZA0008
      * Message data for 'Consume Pty % Req'
      * Consume Priority Percent
     I                                    P   1   32ZA0009
      * Message data for 'Consume pty and % s/b 0'
      * Consume Priority
     I                                    P   1   30ZA0010
      * Consume Priority Percent
     I                                    P   4   62ZA0011
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0012
      * Message data for 'Consumd Itm must be RM/WP'
      * Component Item Code
     I                                        1   7 ZA0013
      * Message data for 'Consumd Itm must be FG/WP'
      * Component Item Code
     I                                        1   7 ZA0014
      * Message data for 'Item Type must be PS'
      * BOM Type
     I                                        1   1 ZA0015
      * Message data for 'Packaging Qty can't be 0'
      * Packaging Quantity
     I                                    P   1   62ZA0016
      * Message data for 'Packaging UOM can't be BL'
      * UOM Primary Dft
     I                                        1   2 ZA0017
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P2AIC3    PARM           WP0001  30       Company Number
     C           P2HGCD    PARM           WP0002  70       Item Code
     C           P6YYST    PARM           WP0003  1        BOM Type Usr
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct program process
     C                     DO   *HIVAL                     DO
      * Initialize screen
     C                     EXSR ABIZSF
      * Set screen bypass indicator
     C           W0PMD     IFNE 'ADD'
     C                     MOVEL'Y'       W0BYP   1
     C                     ELSE
     C                     MOVEL'N'       W0BYP
     C                     END
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'                        DO
      * Convert fields to external form
     C                     EXSR MOCV#1
      * Bypass first screen for new transaction
     C           W0BYP     IFNE 'Y'
      * Display screen
     C                     EXSR CAEXFM
     C                     ELSE
      * Ensure all command keys set off
     C                     MOVE *ALL'0'   WKIN30 30
     C                     MOVEAWKIN30    *IN,1
     C                     END
      * Cancel screen bypass indicator
     C                     MOVEL'N'       W0BYP
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG           CAS
      * HOME: Request subfile reload
     C   30                CAS            ADHMKY
     C                     END                             SAC
     C           W0TRN     IFEQ 'Y'
      * Convert header fields to internal form
     C                     EXSR MPCV#1
      * Display next SFL page
     C   27                CAS            BAIZSF
      * Validate screen input
     C                     CAS            DAPRSF
     C                     END                             SAC
     C                     END                             FI
      * Close cursor
     C                     EXSR FTCLOS
      *
     C                     END                             OD
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
     C                     END                             OD
      *****************************************************************
      /EJECT
     CSR         ABIZSF    BEGSR
      *================================================================
      * Initialize screen
      *================================================================
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0 14
     C                     MOVE *ALL'1'   WKIND1 14
     C                     MOVEAWKIND0    *IN,32
     C                     SETOF                     81    *
      * Initialise subfile control
     C                     EXSR MAIZ#1
      * Clear subfile
     C                     SETON                     80    *
     C                     WRITE#SFLCTL
     C                     SETOF                     80    *
      * Reset count of SFL records
     C                     Z-ADD*ZERO     ##RRMX  50
     C                     Z-ADD*ZERO     ##RR    50
     C                     MOVEL'KEY'     W0SCR   3
      * Position subfile on page 1
     C                     Z-ADD1         ##SFRC
     C                     MOVEL'Y'       W0TRN   1
     C                     MOVEL'Y'       W0FST   1
      *================================================================
     CSR         ABEXIT    ENDSR
      /EJECT
     CSR         ADHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN   1
      *================================================================
     CSR         ADEXIT    ENDSR
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Fill remainder of subfile page with blank records
      *================================================================
      * Setof record error indicators
     C                     MOVEAWKIND0    *IN,32
      * Load subfile
     C                     Z-ADD##RRMX    ##RR    50
     C           1         DO   ##SFPG                     DO
     C                     ADD  1         ##RR
     C                     EXSR MDIZ#2
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile record (new record)
     C                     MOVEL'N'       #RQKST           Display Flag
     C                     MOVEL'Y'       #RDJST           Select Status
      * R9547 DN 03/13/17-Set Sales Yield, Meat Cost Consumed% & Pumped%
      * CASE: *OTHERWISE
     C                     MOVELP7ELSC    #RELSC           Edt SlsYld,Pump
     C                     END
      * Convert fields to external form
     C                     EXSR MNCV#2
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           ##RR      DIV  ##SFPG    WK5N0   50
     C                     MVR            WK5N0          90*
     C  N90                END                             OD
      * Save highest SFL record number used
     C                     Z-ADD##RR      ##RRMX     81    *
     C           ##RRMX    SUB  ##SFPG    ##SFRC
     C                     ADD  1         ##SFRC
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     MOVELW0SCR     W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END                              UOD
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSF    BEGSR
      *================================================================
      * Process subfile records
      *================================================================
      * Confirm/update is not deferred
     C           YPMTFD    IFEQ *BLANKS
     C                     MOVEL'N'       W0DCF   1
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MJIZ#2
     C                     END
      * Validate SFL control keys if input
     C           W0SCR     IFEQ 'KEY'
     C                     EXSR DCVLH1
      * QUIT if error:
     C   99                GOTO DAEXIT
     C                     END
      * If keys only, now get the rest of the data
     C           W0SCR     IFEQ 'KEY'
     C           YPMTFD    ANDEQ*BLANKS
     C                     EXSR DBLDSF
     C                     GOTO DAEXIT
     C                     END
      * Validate SFL control non keys
     C                     EXSR DEVLH2
      *................................................................
      * Process subfile records
     C           *IN81     IFEQ '1'
     C           1         DO   ##RRMX    ##RR
     C           ##RR      CHAIN#SFLRCD              92    *
      * Setof record error indicators
     C                     MOVEAWKIND0    *IN,32
     C                     SETOF                     98    No errors
      * Copy header keys to detail record for validation
     C                     Z-ADD#1AIC3    #2AIC3           Company Number
     C                     Z-ADD#1HGCD    #2HGCD           Item Code
      * Check for null record
     C                     EXSR DGNLRC
     C           W0NLR     IFEQ 'Y'
      * Null record - clear value mapped fields
     C                     EXSR MQIZ#2
     C                     END
      * Validate non-null subfile record
     C           W0NLR     IFEQ 'N'
     C           ##RR      OREQ YPMRRN
     C                     EXSR DIVLSF
     C                     END
      * If SFLRCD invalid, note that errors present
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      * Convert fields to external form
     C                     EXSR MNCV#2
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     END                             OD
     C                     END                             FI
      *................................................................
      * Quit if subfile invalid:
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Validate totals
      * VAL: Consumed Production Yield
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Production Yield SUM is 100%
      *   |- c2    : CTL.Production Yield SUM is Equal zero
      *   '-
     C           #CCIPR    IFEQ 100                        *IF
     C           #CCIPR    OREQ *ZERO                      *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#CCIPR    ZA0001           Production Yiel
      * Send message 'Prod Yield for Consumed'
     C                     MOVEL'USR1900' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * VAL: Consumed Sales Yield
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Sales Yield  SUM is 100%
      *   |- c2    : CTL.Sales Yield  SUM is Equal zero
      *   '-
     C           #CCJPR    IFEQ 100                        *IF
     C           #CCJPR    OREQ *ZERO                      *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#CCJPR    ZA0002           Sales Yield  SU
      * Send message 'Sales Yield for Consumed'
     C                     MOVEL'USR1913' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * VAL: Produced Production Yield
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Production Yield SUM 2 is 100%
      *   |- c2    : CTL.Production Yield SUM 2 is Equal zero
      *   '-
     C           #CCUPR    IFEQ 100                        *IF
     C           #CCUPR    OREQ *ZERO                      *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#CCUPR    ZA0003           Production Yiel
      * Send message 'Prod Yield for Produced'
     C                     MOVEL'USR2168' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * VAL: Meat Cost Consume Percent
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Meat Cost Consume% SUM is EQ 100
      *   |- c2    : CTL.Meat Cost Consume% SUM is Equal to zero
      *   '-
     C           #CGBPR    IFEQ 100                        *IF
     C           #CGBPR    OREQ *ZERO                      *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#CGBPR    ZA0004           Meat Cost Consu
      * Send message 'Meat Cost Consume %'
     C                     MOVEL'USR3689' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * VAL: Produced Sales Yield
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Sales Yield SUM 2 is 100%
      *   |- c2    : CTL.Sales Yield SUM 2 is Equal zero
      *   '-
     C           #CCVPR    IFEQ 100                        *IF
     C           #CCVPR    OREQ *ZERO                      *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#CCVPR    ZA0005           Sales Yield SUM
      * Send message 'Sales Yield for Produced'
     C                     MOVEL'USR2169' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * T12017 DN 11/03/17-Commented Out Off Line Yield Validation.
      * VAL: Boxes
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : CTL.Total Box Comp Items SUM is Greater than 1
      *   |- c2    : PAR.BOM Type Usr is Meat Items
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CTBCI    IFGT 1                          *IF
     C           P6YYST    IFEQ 'C'                        *IF
     C           P6YYST    OREQ 'P'
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Only 1 Box BOM can be ent'
     C                     MOVEL'USR1907' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Quit if user errors signalled
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Update DBF from screen
     C                     EXSR EAUPFL
      * Quit if DBF updates failed:
     C           *IN99     CABEQ'1'       DAEXIT
      *
      * USER: Process command keys
     C                     MOVEL'N'       YL0001           Error Status
      * CASE: CTL.Base/Conv/Loss Item is Converted
     C           #1QZCD    IFEQ 'C'                        *IF
      * VAL: Consume Pty Percent          FP1054 3/17/09
      * CASE: CTL.Consume Pty %         Sum is EQ 100
     C           #COTNY    IFEQ 100                        *IF
     C                     MOVEL'N'       YL0001           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Consumed Pty Pct  RT - Item Bill Of Material  * 
     C                     EXSR SARVGN
      * CASE: LCL.Consume Pty % Sum is NE 100 Pct
     C           YL0003    IFNE 100                        *IF
      * Setup message data for message
     C                     Z-ADD#COTNY    ZA0006           Consume Pty %
      * Send message 'Consume Pty % not 100%'
     C                     MOVEL'USR4128' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       YL0001           Error Status
     C                     END                             *FI
      * CASE: LCL.Consume Priority % is Not Equal to 100 PCt
     C           YL0002    IFNE 100                        *IF
      * Setup message data for message
     C                     Z-ADD#COTNY    ZA0007           Consume Pty %
      * Send message 'Consume Pty % Last ne 100'
     C                     MOVEL'USR4129' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       YL0001           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Error Status is no
     C           YL0001    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0TRN            *Continue trans
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Exit after successful update
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBLDSF    BEGSR
      *================================================================
      * Load screen fields from DBF
      *================================================================
      * Load subfile control from DBF
     C                     EXSR MBFL#1
      * Validate SFL control non keys
     C                     EXSR DFVLH3
     C           YPMTFD    IFEQ *BLANKS
      * USER: Load existing header
      * Rtv Adj Credit Pieces RT - Company Item Ext  * 
     C                     EXSR SBRVGN
      * CTL.Condition Name USR = Condition name of CTL.Adjust Credit Piec
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1973389   Y2LSNO  70       List number
     C                     PARM #CEOST    W0INVL 25        Adjust Credit P
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CGUTX    PARM           W0CNNM 25        Condition Name
      *
      * CASE: PAR.BOM Type Usr is Meat Items
     C           P6YYST    IFEQ 'C'                        *IF
     C           P6YYST    OREQ 'P'
     C                     MOVEL@CN,001   #CM8NA           BOM Type Descri
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,002   #CM8NA           BOM Type Descri
     C                     END                             *FI
     C                     END
      * Read all DBF detail records for header
      * Read ahead
     C/EXEC SQL
     C+     DECLARE CABZRELCVXCSR    CURSOR FOR
     C+       SELECT * FROM CABZRELCV
     C+       WHERE ( IOAIC3     = :X@AIC3     AND
     C+               IOHGCD     = :X@HGCD        )
     C+       ORDER BY  IOAIC3        ASC,
     C+                 IOHGCD        ASC,
     C+                 IOC9NB        ASC
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN CABZRELCVXCSR
     C/END-EXEC
     C           SQLCOD    IFEQ -502
     C/EXEC SQL
     C+   CLOSE CABZRELCVXCSR
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN CABZRELCVXCSR
     C/END-EXEC
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     ENDIF
     C                     ENDIF
     C/EXEC SQL
     C+   FETCH CABZRELCVXCSR
     C+     INTO :QCABZ2
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       92  *92=No Rcd
     C                     ELSE
     C           SQLCOD    IFEQ 0
     C                     SETOF                       92  *
     C                     ELSE
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     END
     C           *IN92     DOWEQ'0'
      * For each DBF detail record read:
     C                     ADD  1         ##RR    50
      * Setof record error indicators
     C                     MOVEAWKIND0    *IN,32
      * Initialise and load subfile record from DBF
     C                     EXSR MDIZ#2
     C                     EXSR MEFL#2
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile record (old record)
     C                     Z-ADDX#IYQT    #RGVPC           Off Line Yield
      * Rtv Descriptions      RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDX#AIC3    WL0001           Company Number
     C                     Z-ADDX#C9NB    WL0002           Item Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    #RCJTX    P      Description Lin
     C                     MOVELWL0004    WUAWNA    P      Description Lin
     C                     MOVELWL0005    WUADCD    P      UOM Primary
     C                     MOVELWL0006    WUAECD    P      UOM Second
     C                     MOVELWL0007    WUAFCD    P      UOM Third
     C                     MOVEL'N'       #RQKST           Display Flag
      * R9547 DN 03/13/17-Set Sales Yield, Meat Cost Consumed% & Pumped%
      * CASE: *OTHERWISE
      * *Set Cursor: RCD.Component Item Code  (*Override=*YES)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  010       W0ROW0
     C                     Z-ADD004       W0COL0
     C                     MOVEL'1'       W0OVR0           *YES
     C                     MOVELP7ELSC    #RELSC           Edt SlsYld,Pump
      * Check user authority to maintain BOM Types. 10/01/01 T896
      * CASE:
      *  - (c1ANDc2)OR(c3ANDc4)
      *   |- c1    : PAR.BOM Type Usr is Consumed - Meat
      *   |- c2    : DB2.BOM Type is Supplies
      *   |- c3    : PAR.BOM Type Usr is Supplies
      *   |- c4    : DB2.BOM Type is Meat Items
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6YYST    IFEQ 'C'                        *IF
     C           X#V2ST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P6YYST    IFEQ 'S'                        *IF
     C           X#V2ST    IFEQ 'C'                        *IF
     C           X#V2ST    OREQ 'P'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       #RQKST           Display Flag
     C                     MOVEL'Y'       #RDJST           Select Status
      * R9547 DN 03/13/17-Don't Allow Edt of SalesYield, Meat$ Consumed%
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RELSC           Edt SlsYld,Pump
     C                     END                             *FI
     C                     END
      * Validate details
     C                     EXSR DJVLSF
      * Output DBF to subfile
      * Convert fields to external form
     C                     EXSR MNCV#2
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
      * Read next Data record
     C/EXEC SQL
     C+   FETCH CABZRELCVXCSR
     C+     INTO :QCABZ2
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       92  *92=No Rcd
     C                     ELSE
     C           SQLCOD    IFEQ 0
     C                     SETOF                       92  *
     C                     ELSE
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     END
     C                     END                             WOD
     C                     Z-ADD##RR      ##RRMX     81    *
      * Fill to end of page with blank records
     C           ##RR      DIV  ##SFPG    WK5N0   50
     C                     MVR            WK5N0          90*
     C   90      ##RR      COMP *ZERO                9090  *
     C  N90                EXSR BAIZSF
     C                     MOVEL'DTL'     W0SCR
      * Position subfile on page 1
     C                     Z-ADD1         ##SFRC
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCVLH1    BEGSR
      *================================================================
      * Validate header keys
      *================================================================
      * Check restriction within
     C                     EXSR VACKRL
      * Check existence of header
     C           YPMTFD    IFEQ *BLANKS
     C                     EXSR DDRDH1
      * If header not found, error
     C           *IN90     IFEQ '1'
     C                     SETON                     99    PC
      * Send message 'Company Item           NF'
     C                     MOVEL'USR0326' ZAMSID
     C                     EXSR ZASNMS
     C                     END
     C                     END
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DDRDH1    BEGSR
      *================================================================
      * Read header record
      *================================================================
      * Setup key
     C                     Z-ADD#1AIC3    X@AIC3
     C                     Z-ADD#1HGCD    X@HGCD
     C/EXEC SQL
     C+     SELECT * INTO :QCABZ1
     C+       FROM  CABZRELC
     C+       WHERE ( BZAIC3       = :X@AIC3     AND
     C+               BZHGCD       = :X@HGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *
     C                     ELSE
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     END
      *================================================================
     CSR         DDEXIT    ENDSR
      /EJECT
     CSR         DEVLH2    BEGSR
      *================================================================
      * Validate header non-key fields
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate header non-key fields
      * CTL.Condition Name USR = Condition name of CTL.Adjust Credit Piec
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1973389   Y2LSNO  70       List number
     C                     PARM #CEOST    W0INVL 25        Adjust Credit P
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CGUTX    PARM           W0CNNM 25        Condition Name
      *
     C                     END
      * Validate relations
     C                     EXSR DFVLH3
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFVLH3    BEGSR
      *================================================================
      * Validate header non-key relations
      *================================================================
      * Check reference to Unit of Measure
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Level Codes
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Vendor Master
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Class
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Group
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Type
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Commodity Group
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Warehouse Codes
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Price Method Header
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to PS Production Department
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Category Packaging
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to PM R/M Type Master
     C                     EXSR VQCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to PM Line Master
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to PS Primal Group
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate header non-key relations
     C                     END
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DGNLRC    BEGSR
      *================================================================
      * Check for null record
      *================================================================
     C                     MOVEL'N'       W0NLR   1
      * Existing records are never null
     C           #2OLRC    CABNE*BLANK    DGEXIT
     C           V2C9NB    CABNE*BLANK    DGEXIT           Component Item
     C           #2V2ST    CABNE*BLANK    DGEXIT           BOM Type
     C           #2BOPR    CABNE*ZERO     DGEXIT           Sales Yield
     C           #2BPPR    CABNE*ZERO     DGEXIT           Production Yiel
     C           #2RTST    CABNE*BLANK    DGEXIT           BOM Group Prod
     C           #2CNSM    CABNE*ZERO     DGEXIT           Consume Priorit
     C           #2BMY1    CABNE*ZERO     DGEXIT           Consume Priorit
     C           #2RSST    CABNE*BLANK    DGEXIT           BOM Multi RM Op
     C           #2IXQT    CABNE*ZERO     DGEXIT           BOM Meat Cost C
     C           #2BMY2    CABNE*ZERO     DGEXIT           BOM Pumped Perc
     C           #2HGQT    CABNE*ZERO     DGEXIT           Packaging Quant
     C           #2HHCD    CABNE*BLANK    DGEXIT           UOM Primary Dft
     C           #2VSST    CABNE*BLANK    DGEXIT           Record Status
     C                     MOVEL'Y'       W0NLR
      *================================================================
     CSR         DGEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#1
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     MOVELW0SCR     W0GRP   1
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         DIVLSF    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Component Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C9NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     Z-ADD*ZERO     #2C9NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C9NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate BOM Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2V2ST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * BOM Type
     C                     MOVEL#2V2ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHV2ST
     C                     SELEC
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD1         ZHV2ST
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD2         ZHV2ST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZHV2ST
     C                     ENDSL
      * Window width
     C                     Z-ADD20        YWWDWD
      * Window depth
     C                     Z-ADD3         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD10        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD43        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG01RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG01CL
     C                     EXFMTZGV2ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHV2ST    WHEQ 1
     C                     MOVEL'P'       W0INVL           P
     C           ZHV2ST    WHEQ 2
     C                     MOVEL'C'       W0INVL           C
     C           ZHV2ST    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2V2ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate BOM Group Prod Yield
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2RTST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * BOM Group Prod Yield
     C                     MOVEL#2RTST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHRTST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHRTST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD2         ZHRTST
     C                     ENDSL
      * Window width
     C                     Z-ADD8         YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD10        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD63        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG02RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG02CL
     C                     EXFMTZGRTST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHRTST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHRTST    WHEQ 2
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2RTST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate BOM Multi RM Option
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2RSST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * BOM Multi RM Option
     C                     MOVEL#2RSST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHRSST
     C                     SELEC
     C           W0INVL    WHEQ 'O'                        O
     C                     Z-ADD1         ZHRSST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD2         ZHRSST
     C                     ENDSL
      * Window width
     C                     Z-ADD14        YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD10        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD87        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG03RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG03CL
     C                     EXFMTZGRSST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHRSST    WHEQ 1
     C                     MOVEL'O'       W0INVL           O
     C           ZHRSST    WHEQ 2
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2RSST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Record Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2VSST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * Record Status
     C                     MOVEL#2VSST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVSST
     C                     SELEC
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD1         ZHVSST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD2         ZHVSST
     C           W0INVL    WHEQ 'D'                        D
     C                     Z-ADD3         ZHVSST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD4         ZHVSST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD5         ZHVSST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD6         ZHVSST
     C                     ENDSL
      * Window width
     C                     Z-ADD20        YWWDWD
      * Window depth
     C                     Z-ADD6         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD10        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD130       YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG04RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG04CL
     C                     EXFMTZGVSST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVSST    WHEQ 1
     C                     MOVEL'A'       W0INVL           A
     C           ZHVSST    WHEQ 2
     C                     MOVEL'I'       W0INVL           I
     C           ZHVSST    WHEQ 3
     C                     MOVEL'D'       W0INVL           D
     C           ZHVSST    WHEQ 4
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHVSST    WHEQ 5
     C                     MOVEL'N'       W0INVL           N
     C           ZHVSST    WHEQ 6
     C                     MOVEL'E'       W0INVL           E
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2VSST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * DEFAULT: Production Yield Start Weight Calculation Group
      * CASE: RCD.Item Code EQ RCD.Component Item Code
     C           #2HGCD    IFEQ #2C9NB                     *IF
     C                     MOVEL*BLANK    #2RTST           BOM Group Prod
     C                     MOVEL'Y'       #2RTST           BOM Group Prod
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.BOM Type is Consumed - Meat
      *   |- c2    : RCD.BOM Type is Supplies
      *   '-
     C           #2V2ST    IFEQ 'C'                        *IF
     C           #2V2ST    OREQ 'S'                        *OR
     C                     MOVEL*BLANK    #2RTST           BOM Group Prod
     C                     END                             *FI
     C                     END                             *FI
      * Prompt for component item control field
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> RCD.Component Item Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'V2C9NB'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Company Item       SR - Item  * 
     C                     CALL 'CAP1SRR'              90  SEL Company Ite
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0023  30       Company Number
     C           #2C9NB    PARM #2C9NB    WQ0024  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAP1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Rtv Descriptions      RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#2C9NB    WL0002           Item Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    #RCJTX    P      Description Lin
     C                     MOVELWL0004    WUAWNA    P      Description Lin
     C                     MOVELWL0005    WUADCD    P      UOM Primary
     C                     MOVELWL0006    WUAECD    P      UOM Second
     C                     MOVELWL0007    WUAFCD    P      UOM Third
      * 06/24/2014 JJH E3160 - Average if WPA is now Upd Standard Product
      * Default Update Standard Production value
      * CASE: RCD.BOM Type is Produced - Meat
     C           #2V2ST    IFEQ 'P'                        *IF
      * Rtv Co Itm Std Prd Dft RT - Company Item Std Prd Dflt  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0008           Company Number
     C                     Z-ADD#2C9NB    WL0009           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    #2YAST    P      Company Item Up
     C                     END                             *FI
      * If status is blank, move in active
      * CASE: RCD.Record Status EQ WRK.BLANK
     C           #2VSST    IFEQ WUGSTX                     *IF
     C                     MOVEL'A'       #2VSST           Record Status
     C                     END                             *FI
      * 10/03/01 T896  CHECK USER AUTHORITY TO MAINTAIN A BOM TYPE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : RCD.Select Status is yes
      *   |- c2    : RCD.Display Flag is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RDJST    IFEQ 'Y'                        *IF
     C           #RQKST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 10/03/01   T896 Check user authority to add a bom type
      * CASE: RCD.BOM Type is Meat Items
     C           #2V2ST    IFEQ 'C'                        *IF
     C           #2V2ST    OREQ 'P'
      * Cannot enter a Supply bom
      * CASE: PAR.BOM Type Usr is Supplies
     C           P6YYST    IFEQ 'S'                        *IF
      * Setup message data for message
      * Send message 'User cant maint. Bom type'
     C                     MOVEL'USR3089' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.BOM Type is Supplies
     C           #2V2ST    IFEQ 'S'                        *IF
      * Cannot enter a C/P bom
      * CASE: PAR.BOM Type Usr is Meat Items
     C           P6YYST    IFEQ 'C'                        *IF
     C           P6YYST    OREQ 'P'
      * Setup message data for message
      * Send message 'User cant maint. Bom type'
     C                     MOVEL'USR3089' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Requirements for BOM type "C"onsumed
      * CASE: RCD.BOM Type is Consumed - Meat
     C           #2V2ST    IFEQ 'C'                        *IF
      * 05/08/08 PKD Changed the validation where if the percent is enter
      *              then only the priority must be entered.
      * VAL: Consume Priority
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Consume Priority % is Greater than zero
      *   |- c2    : RCD.Consume Priority is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2BMY1    IFGT *ZERO                      *IF
     C           #2CNSM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#2CNSM    ZA0008           Consume Priorit
      * Send message 'Consume Pty Req'
     C                     MOVEL'USR3941' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     END                             *FI
      * VAL: Consume Priority Percent
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Consume Priority is NE Zero
      *   |- c2    : RCD.Consume Priority % is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2CNSM    IFNE *ZERO                      *IF
     C           #2BMY1    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#2BMY1    ZA0009           Consume Priorit
      * Send message 'Consume Pty % Req'
     C                     MOVEL'USR3942' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Requirements for BOM type "S" or "P"
      * CASE: RCD.BOM Type is Not Consumed
     C           #2V2ST    IFEQ 'P'                        *IF
     C           #2V2ST    OREQ 'S'
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Consume Priority is NE Zero
      *   |- c2    : RCD.Consume Priority % is not equal to zeros
      *   '-
     C           #2CNSM    IFNE *ZERO                      *IF
     C           #2BMY1    ORNE *ZERO                      *OR
      * Setup message data for message
     C                     Z-ADD#2CNSM    ZA0010           Consume Priorit
     C                     Z-ADD#2BMY1    ZA0011           Consume Priorit
      * Send message 'Consume pty and % s/b 0'
     C                     MOVEL'USR2525' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983839*
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate relations
     C                     EXSR DJVLSF
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Component Item Code required
     C           #2C9NB    IFEQ *ZERO                      IF
     C           *IN77     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9833  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * BOM Type required
     C           #2V2ST    IFEQ *BLANK                     IF
     C           *IN76     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9834  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Record Status required
     C           #2VSST    IFEQ *BLANK                     IF
     C           *IN76     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9845  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DIEXIT    ENDSR
      /EJECT
     CSR         DJVLSF    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      * Check reference to Company Item
     C                     EXSR VTCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9833  *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VUCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9844  *
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record relations
      * CASE: RCD.*SFLSEL is *Delete request
     C           #2SEL     IFEQ '4'                        *IF
     C           #2SEL     OREQ ' 4'
      * R9547 DN 03/15/17-Commented out info msg & will use it below.
      * R9547 DN 03/15/17-If Sync with Company USR is Populated, Send Inf
      * CASE: PAR.Sync with Company USR is not equal to zero
     C           P8DEC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    YL0005           Company Number
     C                     MOVELP8DEC3    YL0005           Company Number
     C                     Z-ADD1         ZQ      50
     C           @CN,004   CAT  @CN,005:ZQYL0006    P      Generic Message
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0006    CAT  @CN,006:ZQYL0006    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  YL0005:ZQ YL0006    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  'BOM.':ZQ YL0006    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0006    ZA0012           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Delete pending'
     C                     MOVEL'USR0597' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Item Type/BsCv    RT - Company Item  * 
     C                     EXSR SERVGN
      * If BOM type is 'C', check for errors
      * CASE: RCD.BOM Type is Consumed - Meat
     C           #2V2ST    IFEQ 'C'                        *IF
      * CASE: CTL.Item Type Code is Finished Goods
     C           #1N0CD    IFEQ 'FG'                       *IF
      * CASE: CTL.Converted/Base Item is Base
     C           #1QZCD    IFEQ 'B'                        *IF
      * Consumed Item must be Raw Material or Work in Process  (PK0318 5/
      * CASE:
      *  - c1 OR (c2 AND c3)
      *   |- c1    : WRK.Item Type Code is RM/WP
      *   |- c2    : WRK.Item Type Code is Finished Good
      *   |- c3    : LCL.Base/Conv/Loss Item is Base
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUN0CD    IFEQ 'RM'                       *IF
     C           WUN0CD    OREQ 'WP'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WUN0CD    IFEQ 'FG'                       *IF
     C           YL0007    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Component Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C9NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0013           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0013           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Consumd Itm must be RM/WP'
     C                     MOVEL'USR2166' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Converted/Base Item is Converted/Fabricated
     C           #1QZCD    IFEQ 'C'                        *IF
     C           #1QZCD    OREQ 'F'
      * Consumed Item must be Finished Goods /Work in process  (PK0318 5/
      * CASE: WRK.Item Type Code is FG/WP
     C           WUN0CD    IFEQ 'FG'                       *IF
     C           WUN0CD    OREQ 'WP'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Component Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C9NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0014           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0014           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Consumd Itm must be FG/WP'
     C                     MOVEL'USR2167' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If BOM type is 'P', check for errors
      * CASE: RCD.BOM Type is Produced - Meat
     C           #2V2ST    IFEQ 'P'                        *IF
      * CASE: CTL.Item Type Code is Finished Goods
     C           #1N0CD    IFEQ 'FG'                       *IF
      * Rtv Credit Item Sts   RT - Company/Item  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
     C                     END                             *FI
      * If BOM type is 'S', check for errors
      * CASE: RCD.BOM Type is Supplies
     C           #2V2ST    IFEQ 'S'                        *IF
      * Rtv Item Type Code     RT - Company Item  * 
     C                     EXSR SGRVGN
      * Item type must be 'PS'
      * CASE: WRK.Item Type Code is Packaging and Supplies
     C           WUN0CD    IFEQ 'PS'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#2V2ST    ZA0015           BOM Type
      * Send message 'Item Type must be PS'
     C                     MOVEL'USR1901' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     END                             *FI
      * Packaging quantity must be entered
      * CASE: RCD.Packaging Quantity is Equal to zero
     C           #2HGQT    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#2HGQT    ZA0016           Packaging Quant
      * Send message 'Packaging Qty can't be 0'
     C                     MOVEL'USR1896' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
      * Packaging UOM must be entered
      * CASE: RCD.U/M - Primary Dft is Not Entered
     C           #2HHCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#2HHCD    ZA0017           UOM Primary Dft
      * Send message 'Packaging UOM can't be BL'
     C                     MOVEL'USR1897' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9844  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 04/08/09 SLM E00367 add with FP1054
      * 04/08/09 SLM Validation move here due not need when
      * user is selecting 4 = delete
      * CASE: RCD.BOM Type is Not Consumed
     C           #2V2ST    IFEQ 'P'                        *IF
     C           #2V2ST    OREQ 'S'
     C                     MOVEL*BLANK    #2RSST           BOM Multi RM Op
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile record function fields
      * Add up sales yield and prod yield for Consumed Items,& consumed p
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Record Status is Active
      *   |- c2    : RCD.BOM Type is Consumed - Meat
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2VSST    IFEQ 'A'                        *IF
     C           #2V2ST    IFEQ 'C'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  #2BPPR    #CCIPR           Production Yiel
     C                     ADD  #2BOPR    #CCJPR           Sales Yield  SU
     C                     ADD  #2IXQT    #CGBPR           Meat Cost Consu
      * FP1054 added consumed pty sum  3/17/09
     C                     ADD  #2BMY1    #COTNY           Consume Pty %
     C                     END                             *FI
      * Add up sales yield and production yield for Produced Items
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Record Status is Active
      *   |- c2    : RCD.BOM Type is Produced - Meat
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2VSST    IFEQ 'A'                        *IF
     C           #2V2ST    IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  #2BPPR    #CCUPR           Production Yiel
     C                     ADD  #2BOPR    #CCVPR           Sales Yield SUM
     C                     ADD  #RGVPC    #CGWPC           Off Line Yield
     C                     END                             *FI
      * Rtv Item Type/Pack Cd2 RT - Company Item  * 
     C                     EXSR SHRVGN
      * Add up number of boxes
      * CASE: WRK.Item Type Code is Packaging and Supplies
     C           WUN0CD    IFEQ 'PS'                       *IF
      * Process Box Type Code = Box
      * CASE: WRK.Package Type Code is Box
     C           WUX4ST    IFEQ 'B'                        *IF
     C                     Z-ADD1         WUJGNB           USR number
     C                     ADD  WUJGNB    #CTBCI           Total Box Comp
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DJEXIT    ENDSR
      /EJECT
     CSR         EAUPFL    BEGSR
      *================================================================
      * Update DBFs from screen
      *================================================================
      * Process header record
      * Change header
     C                     CAS            ECCHHD
     C                     END
      * Quit if header update failed
     C   99                GOTO EAEXIT
      * Process subfile records
     C           1         DO   ##RRMX    ##RR
     C           ##RR      CHAIN#SFLRCD              92    *
     C  N92                DO
      * Setof record error indicators
     C                     MOVEAWKIND0    *IN,32
      * Copy header keys to detail record for update
     C                     Z-ADD#1AIC3    #2AIC3           Company Number
     C                     Z-ADD#1HGCD    #2HGCD           Item Code
      * Process add line request
     C           #2OLRC    CASEQ*BLANK    EEADLN
      * Process change request
     C                     CAS            EFCHLN
     C                     END
      * USER: Process detail record
      * Process Delete
      * CASE: RCD.*SFLSEL is *Delete
     C           #2SEL     IFEQ '4'                        *IF
      * Crt/Chg ITM BOM AllPLN IF - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0011           Company Number
     C                     Z-ADD#2HGCD    WL0012           Item Code
     C                     Z-ADD#2C9NB    WL0013           Component Item
     C                     MOVEL#2V2ST    WL0014    P      BOM Type
     C                     Z-ADD#2BOPR    WL0015           Sales Yield
     C                     Z-ADD#2BPPR    WL0016           Production Yiel
     C                     Z-ADD#2HGQT    WL0017           Packaging Quant
     C                     MOVEL#2HHCD    WL0018    P      UOM Primary Dft
     C                     MOVEL#2YAST    WL0019    P      Upd Standard Pr
     C                     Z-ADD#2CNSM    WL0020           Consume Priorit
     C                     Z-ADD#2BMY1    WL0021           Consume Priorit
     C                     Z-ADD#2BMY2    WL0022           BOM Pumped Perc
     C                     Z-ADD#2IXQT    WL0023           BOM Meat Cost C
     C                     Z-ADD#RGVPC    WL0024           BOM Off Line Yi
     C                     MOVEL#2RSST    WL0025    P      BOM Multi RM Op
     C                     MOVEL#2RTST    WL0026    P      BOM Group Prod
     C                     MOVEL#2UVST    WL0027    P      EDI Status 1
     C                     MOVEL#2UWST    WL0028    P      EDI Status 2
     C                     MOVEL#2UXST    WL0029    P      EDI Status 3
     C                     MOVEL#2VSST    WL0030    P      Record Status
     C                     MOVEL'DEL'     WL0031    P      *Delete Mode  U
     C                     MOVEL'Y'       WL0032    P      Record Found US
     C                     Z-ADDP8DEC3    WL0033           Sync with Compa
     C                     EXSR SIINFN
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * Convert fields to external form
     C                     EXSR MNCV#2
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     END                             OD
     C  N92                END                             OD
      *
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         ECCHHD    BEGSR
      *================================================================
      * Change header record
      *================================================================
      * USER: Change header DBF record
      * Chg Co/Item BOM-EDT   IF
      * This Change User must exist for this application, but
      * no change to the Company/Item must occur.
      * --------
      * Upd Adj Credit Pieces RT - Company Item  * 
     C                     EXSR SQRVGN
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    PC
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EEADLN    BEGSR
      *================================================================
      * Add detail record
      *================================================================
      * Check for null record
     C                     EXSR DGNLRC
     C           W0NLR     CABEQ'Y'       EEEXIT
      * USER: Create detail DBF record
      * Crt/Chg ITM BOM AllPLN IF - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0011           Company Number
     C                     Z-ADD#2HGCD    WL0012           Item Code
     C                     Z-ADD#2C9NB    WL0013           Component Item
     C                     MOVEL#2V2ST    WL0014    P      BOM Type
     C                     Z-ADD#2BOPR    WL0015           Sales Yield
     C                     Z-ADD#2BPPR    WL0016           Production Yiel
     C                     Z-ADD#2HGQT    WL0017           Packaging Quant
     C                     MOVEL#2HHCD    WL0018    P      UOM Primary Dft
     C                     MOVEL#2YAST    WL0019    P      Upd Standard Pr
     C                     Z-ADD#2CNSM    WL0020           Consume Priorit
     C                     Z-ADD#2BMY1    WL0021           Consume Priorit
     C                     Z-ADD#2BMY2    WL0022           BOM Pumped Perc
     C                     Z-ADD#2IXQT    WL0023           BOM Meat Cost C
     C                     Z-ADD#RGVPC    WL0024           BOM Off Line Yi
     C                     MOVEL#2RSST    WL0025    P      BOM Multi RM Op
     C                     MOVEL#2RTST    WL0026    P      BOM Group Prod
     C                     MOVEL#2UVST    WL0027    P      EDI Status 1
     C                     MOVEL#2UWST    WL0028    P      EDI Status 2
     C                     MOVEL#2UXST    WL0029    P      EDI Status 3
     C                     MOVEL#2VSST    WL0030    P      Record Status
     C                     MOVEL*BLANK    WL0031           *Delete Mode  U
     C                     MOVEL'N'       WL0032    P      Record Found US
     C                     Z-ADDP8DEC3    WL0033           Sync with Compa
     C                     EXSR SIINFN
     C           W0RTN     IFNE *BLANK
      * Set on record error indicators
     C                     MOVEAWKIND1    *IN,32
     C                     SETON                         99*
     C                     ELSE
     C                     MOVEL@2DBRC    #2DBRC
     C                     MOVEL'Y'       #2OLRC
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         EFCHLN    BEGSR
      *================================================================
      * Change detail record
      *================================================================
      * USER: Change detail DBF record
      * Crt/Chg ITM BOM AllPLN IF - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0011           Company Number
     C                     Z-ADD#2HGCD    WL0012           Item Code
     C                     Z-ADD#2C9NB    WL0013           Component Item
     C                     MOVEL#2V2ST    WL0014    P      BOM Type
     C                     Z-ADD#2BOPR    WL0015           Sales Yield
     C                     Z-ADD#2BPPR    WL0016           Production Yiel
     C                     Z-ADD#2HGQT    WL0017           Packaging Quant
     C                     MOVEL#2HHCD    WL0018    P      UOM Primary Dft
     C                     MOVEL#2YAST    WL0019    P      Upd Standard Pr
     C                     Z-ADD#2CNSM    WL0020           Consume Priorit
     C                     Z-ADD#2BMY1    WL0021           Consume Priorit
     C                     Z-ADD#2BMY2    WL0022           BOM Pumped Perc
     C                     Z-ADD#2IXQT    WL0023           BOM Meat Cost C
     C                     Z-ADD#RGVPC    WL0024           BOM Off Line Yi
     C                     MOVEL#2RSST    WL0025    P      BOM Multi RM Op
     C                     MOVEL#2RTST    WL0026    P      BOM Group Prod
     C                     MOVEL#2UVST    WL0027    P      EDI Status 1
     C                     MOVEL#2UWST    WL0028    P      EDI Status 2
     C                     MOVEL#2UXST    WL0029    P      EDI Status 3
     C                     MOVEL#2VSST    WL0030    P      Record Status
     C                     MOVEL*BLANK    WL0031           *Delete Mode  U
     C                     MOVEL'Y'       WL0032    P      Record Found US
     C                     Z-ADDP8DEC3    WL0033           Sync with Compa
     C                     EXSR SIINFN
     C           W0RTN     IFNE *BLANK
      * Set on record error indicators
     C                     MOVEAWKIND1    *IN,32
     C                     SETON                         99*
     C                     END
      *================================================================
     CSR         EFEXIT    ENDSR
      /EJECT
     CSR         FTCLOS    BEGSR
      *================================================================
      * Close cursor
      *================================================================
     C/EXEC SQL
     C+   CLOSE CABZRELCVXCSR
     C/END-EXEC
      *================================================================
     CSR         FTEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
      * Protect detail key fields if existing record
     C           #2OLRC    COMP 'Y'                      82*
     C                     MOVEL'0'       *IN78
     C           #RDJST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL*IN82     *IN77
     C                     MOVEL'0'       *IN76
     C           #RQKST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           #RELSC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     SETOF                     89    *
     C           W0SCR     COMP 'KEY'                    88*
      * Protect header key fields in change mode, full screen
     C                     SETOF                     87    *
     C  N88N89             SETON                     87    *
     C                     MOVEL'0'       *IN79
     C           P6YYST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise header fields
      *================================================================
      * Existing record indicator
     C                     MOVEL*BLANK    #1OLRC
     C                     Z-ADD*ZERO     #COTNY           Consume Pty %
     C                     Z-ADD*ZERO     #CGWPC           Off Line Yield
     C                     Z-ADD*ZERO     #CGBPR           Meat Cost Consu
     C                     Z-ADD*ZERO     #CCVPR           Sales Yield SUM
     C                     Z-ADD*ZERO     #CCUPR           Production Yiel
     C                     Z-ADD*ZERO     #CCJPR           Sales Yield  SU
     C                     Z-ADD*ZERO     #CTBCI           Total Box Comp
     C                     Z-ADD*ZERO     #CTWWE           Tare Weight SUM
     C                     Z-ADD*ZERO     #CPTWS           Package Tare We
     C                     Z-ADD*ZERO     #CCIPR           Production Yiel
     C                     MOVEL*BLANK    #1AWNA           Description Lin
     C                     MOVEL*BLANK    #1L7NA           Item Label Line
     C                     MOVEL*BLANK    #1L8NA           Item Label Line
     C                     MOVEL*BLANK    #1L6NA           Item Label Line
     C                     MOVEL*BLANK    #1MFNA           Item Label Line
     C                     MOVEL*BLANK    #1ADCD           UOM Primary
     C                     Z-ADD*ZERO     #1AWPC           Conversion Fact
     C                     MOVEL*BLANK    #1LXST           Operation Facto
     C                     MOVEL*BLANK    #1AECD           UOM Second
     C                     Z-ADD*ZERO     #1AXPC           Conversion Fact
     C                     MOVEL*BLANK    #1LYST           Operation Facto
     C                     MOVEL*BLANK    #1AFCD           UOM Third
     C                     MOVEL*BLANK    #1AICD           UOM Pricing
     C                     Z-ADD*ZERO     #1AIWG           Unit Weight
     C                     MOVEL*BLANK    #1HICD           Quality Level
     C                     MOVEL*BLANK    #1RBCD           Item Level
     C                     MOVEL*BLANK    #1FZST           Production Date
     C                     MOVEL*BLANK    #1AVST           Catch Weight St
     C                     Z-ADD*ZERO     #1CZWG           Minimum Weight
     C                     Z-ADD*ZERO     #1C0WG           Maximum Weight
     C                     Z-ADD*ZERO     #1URTN           Number Cases On
     C                     Z-ADD*ZERO     #1AJC8           Vendor Item Def
     C                     Z-ADD*ZERO     #1RINB           Item Structure
     C                     Z-ADD*ZERO     #1RHNB           Item Structure
     C                     Z-ADD*ZERO     #1RGNB           Item Structure
     C                     MOVEL*BLANK    #1LNCD           Default Commod
     C                     Z-ADD*ZERO     #1TFNB           Transportation
     C                     MOVEL*BLANK    #1N0CD           Item Type Code
     C                     MOVEL*BLANK    #1X4ST           Package Type Co
     C                     Z-ADD*ZERO     #1TMVA           Maximum Audit V
     C                     Z-ADD*ZERO     #1TNVA           Minimum Audit V
     C                     Z-ADD*ZERO     #1BLPR           Market Overage
     C                     Z-ADD*ZERO     #1BMPR           Standard Overag
     C                     MOVEL*BLANK    #1LRCD           Commodity Price
     C                     MOVEL*BLANK    #1U9ST           Item Pricing Op
     C                     Z-ADD*ZERO     #1CMCO           Item Pricing Co
     C                     MOVEL*BLANK    #1Q1CD           Default Warehou
     C                     MOVEL*BLANK    #1Q8CD           Price Method De
     C                     Z-ADD*ZERO     #1CHTM           Fresh Chilling
     C                     MOVEL*BLANK    #1QZCD           Base_Conv_Loss
     C                     MOVEL*BLANK    #1XWST           Variety_Rendere
     C                     MOVEL*BLANK    #1XXST           Frozen Make to
     C                     MOVEL*BLANK    #1VMST           Credit Item Sta
     C                     Z-ADD*ZERO     #1SWGH           Std Weight_Head
     C                     Z-ADD*ZERO     #1PPHE           Pieces Per Head
     C                     MOVEL*BLANK    #1R3CD           Department Code
     C                     MOVEL*BLANK    #1SDCD           Group for Packa
     C                     Z-ADD*ZERO     #1SFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     #1A3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     #1SJNB           Production Lead
     C                     MOVEL*BLANK    #1LLCD           Packaging Code
     C                     MOVEL*BLANK    #1LMCD           Item Market Cod
     C                     MOVEL*BLANK    #1P3ST           TF Co_Ownership
     C                     Z-ADD*ZERO     #1SKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     #1SLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     #1SMNB           Agrimetrics gra
     C                     MOVEL*BLANK    #1P4ST           PA Base Avail R
     C                     Z-ADD*ZERO     #1CFNB           PM Pounds per H
     C                     Z-ADD*ZERO     #1CGNB           Item Frt Overag
     C                     Z-ADD*ZERO     #1ILNB           Packages per ca
     C                     Z-ADD*ZERO     #1CHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     #1CINB           PM Batch Size
     C                     Z-ADD*ZERO     #1CJNB           Package Level s
     C                     Z-ADD*ZERO     #1CMNB           Partial Item Co
     C                     Z-ADD*ZERO     #1CNNB           WIP Item Code
     C                     Z-ADD*ZERO     #1CRNB           WIP Reject Code
     C                     Z-ADD*ZERO     #1CSNB           Std Costing Uni
     C                     Z-ADD*ZERO     #1CVNB           FP Std Green We
     C                     Z-ADD*ZERO     #1CWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     #1CXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     #1CZNB           PM Formula LBS
     C                     Z-ADD*ZERO     #1C0NB           PM Finished LBS
     C                     MOVEL*BLANK    #1N1CD           SH Unused_was b
     C                     Z-ADD*ZERO     #1B4NB           PM Raw Material
     C                     Z-ADD*ZERO     #1B5NB           PM Line Number
     C                     MOVEL*BLANK    #1X5ST           Seconds Item
     C                     MOVEL*BLANK    #1X6ST           Print on Realiz
     C                     MOVEL*BLANK    #1X7ST           Unit Weight Cha
     C                     MOVEL*BLANK    #1PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     #1BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     #1BJNB           Bags Per Unit
     C                     MOVEL*BLANK    #1SUST           Export_Domestic
     C                     MOVEL*BLANK    #1SVST           Print On Schedu
     C                     MOVEL*BLANK    #1SYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    #1SZST           Fresh Sched As
     C                     MOVEL*BLANK    #1S1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    #1XRCD           Primal Group Co
     C                     MOVEL*BLANK    #1XTCD           Item Meat Cost
     C                     MOVEL*BLANK    #1XUCD           UPC Code 2
     C                     Z-ADD*ZERO     #1F5WG           Item Target Pri
     C                     Z-ADD*ZERO     #1F6WG           Minimum Piece W
     C                     Z-ADD*ZERO     #1F7WG           Maximum Piece W
     C                     Z-ADD*ZERO     #1BLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     #1BNNB           Production Qty
     C                     MOVEL*BLANK    #1S2ST           Scheduling Posi
     C                     MOVEL*BLANK    #1S4ST           Sold 100 Percen
     C                     MOVEL*BLANK    #1S5ST           Maximum Shifts
     C                     MOVEL*BLANK    #1S6ST           Value Added Sts
     C                     MOVEL*BLANK    #1S8ST           Label Type
     C                     MOVEL*BLANK    #1S9ST           Item TF Exempt
     C                     MOVEL*BLANK    #1TCST           Item TF Classif
     C                     MOVEL*BLANK    #1TDST           Default Workcen
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #CC9NB           Component Item
     C                     MOVEL*BLANK    #CCJTX           USR Item Descri
     C                     MOVEL*BLANK    #CV2ST           BOM Type
     C                     Z-ADD*ZERO     #CBOPR           Sales Yield
     C                     Z-ADD*ZERO     #CBPPR           Production Yiel
     C                     Z-ADD*ZERO     #CHGQT           Packaging Quant
     C                     MOVEL*BLANK    #CHHCD           UOM Primary Dft
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     MOVEL*BLANK    #CM8NA           BOM Type Descri
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDP2HGCD    #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     MOVEL*BLANK    #1AVNA           Description Lin
     C                     MOVEL*BLANK    #CEOST           Adjust Credit P
     C                     MOVEL*BLANK    #CGUTX           Condition Name
      * Check restriction within
     C                     EXSR VVCKRL
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move header DBF record fields to header screen
      *================================================================
      * Existing record indicator
     C                     MOVEL'Y'       #1OLRC
     C                     MOVELX@AWNA    #1AWNA           Description Lin
     C                     MOVELX@L7NA    #1L7NA           Item Label Line
     C                     MOVELX@L8NA    #1L8NA           Item Label Line
     C                     MOVELX@L6NA    #1L6NA           Item Label Line
     C                     MOVELX@MFNA    #1MFNA           Item Label Line
     C                     MOVELX@ADCD    #1ADCD           UOM Primary
     C                     Z-ADDX@AWPC    #1AWPC           Conversion Fact
     C                     MOVELX@LXST    #1LXST           Operation Facto
     C                     MOVELX@AECD    #1AECD           UOM Second
     C                     Z-ADDX@AXPC    #1AXPC           Conversion Fact
     C                     MOVELX@LYST    #1LYST           Operation Facto
     C                     MOVELX@AFCD    #1AFCD           UOM Third
     C                     MOVELX@AICD    #1AICD           UOM Pricing
     C                     Z-ADDX@AIWG    #1AIWG           Unit Weight
     C                     MOVELX@HICD    #1HICD           Quality Level
     C                     MOVELX@RBCD    #1RBCD           Item Level
     C                     MOVELX@FZST    #1FZST           Production Date
     C                     MOVELX@AVST    #1AVST           Catch Weight St
     C                     Z-ADDX@CZWG    #1CZWG           Minimum Weight
     C                     Z-ADDX@C0WG    #1C0WG           Maximum Weight
     C                     Z-ADDX@URTN    #1URTN           Number Cases On
     C                     Z-ADDX@AJC8    #1AJC8           Vendor Item Def
     C                     Z-ADDX@RINB    #1RINB           Item Structure
     C                     Z-ADDX@RHNB    #1RHNB           Item Structure
     C                     Z-ADDX@RGNB    #1RGNB           Item Structure
     C                     MOVELX@LNCD    #1LNCD           Default Commod
     C                     Z-ADDX@TFNB    #1TFNB           Transportation
     C                     MOVELX@N0CD    #1N0CD           Item Type Code
     C                     MOVELX@X4ST    #1X4ST           Package Type Co
     C                     Z-ADDX@TMVA    #1TMVA           Maximum Audit V
     C                     Z-ADDX@TNVA    #1TNVA           Minimum Audit V
     C                     Z-ADDX@BLPR    #1BLPR           Market Overage
     C                     Z-ADDX@BMPR    #1BMPR           Standard Overag
     C                     MOVELX@LRCD    #1LRCD           Commodity Price
     C                     MOVELX@U9ST    #1U9ST           Item Pricing Op
     C                     Z-ADDX@CMCO    #1CMCO           Item Pricing Co
     C                     MOVELX@Q1CD    #1Q1CD           Default Warehou
     C                     MOVELX@Q8CD    #1Q8CD           Price Method De
     C                     Z-ADDX@CHTM    #1CHTM           Fresh Chilling
     C                     MOVELX@QZCD    #1QZCD           Base_Conv_Loss
     C                     MOVELX@XWST    #1XWST           Variety_Rendere
     C                     MOVELX@XXST    #1XXST           Frozen Make to
     C                     MOVELX@VMST    #1VMST           Credit Item Sta
     C                     Z-ADDX@SWGH    #1SWGH           Std Weight_Head
     C                     Z-ADDX@PPHE    #1PPHE           Pieces Per Head
     C                     MOVELX@R3CD    #1R3CD           Department Code
     C                     MOVELX@SDCD    #1SDCD           Group for Packa
     C                     Z-ADDX@SFNB    #1SFNB           Pallet Tare Wei
     C                     Z-ADDX@A3WG    #1A3WG           Misc Tare Weigh
     C                     Z-ADDX@SJNB    #1SJNB           Production Lead
     C                     MOVELX@LLCD    #1LLCD           Packaging Code
     C                     MOVELX@LMCD    #1LMCD           Item Market Cod
     C                     MOVELX@P3ST    #1P3ST           TF Co_Ownership
     C                     Z-ADDX@SKNB    #1SKNB           Agrimetrics gro
     C                     Z-ADDX@SLNB    #1SLNB           Agrimetrics pac
     C                     Z-ADDX@SMNB    #1SMNB           Agrimetrics gra
     C                     MOVELX@P4ST    #1P4ST           PA Base Avail R
     C                     Z-ADDX@CFNB    #1CFNB           PM Pounds per H
     C                     Z-ADDX@CGNB    #1CGNB           Item Frt Overag
     C                     Z-ADDX@ILNB    #1ILNB           Packages per ca
     C                     Z-ADDX@CHNB    #1CHNB           Use_Freeze_Sell
     C                     Z-ADDX@CINB    #1CINB           PM Batch Size
     C                     Z-ADDX@CJNB    #1CJNB           Package Level s
     C                     Z-ADDX@CMNB    #1CMNB           Partial Item Co
     C                     Z-ADDX@CNNB    #1CNNB           WIP Item Code
     C                     Z-ADDX@CRNB    #1CRNB           WIP Reject Code
     C                     Z-ADDX@CSNB    #1CSNB           Std Costing Uni
     C                     Z-ADDX@CVNB    #1CVNB           FP Std Green We
     C                     Z-ADDX@CWNB    #1CWNB           PM Std LBS Man
     C                     Z-ADDX@CXNB    #1CXNB           PM Raw Meat LBS
     C                     Z-ADDX@CZNB    #1CZNB           PM Formula LBS
     C                     Z-ADDX@C0NB    #1C0NB           PM Finished LBS
     C                     MOVELX@N1CD    #1N1CD           SH Unused_was b
     C                     Z-ADDX@B4NB    #1B4NB           PM Raw Material
     C                     Z-ADDX@B5NB    #1B5NB           PM Line Number
     C                     MOVELX@X5ST    #1X5ST           Seconds Item
     C                     MOVELX@X6ST    #1X6ST           Print on Realiz
     C                     MOVELX@X7ST    #1X7ST           Unit Weight Cha
     C                     MOVELX@PCCT    #1PCCT           Piece Count Ite
     C                     Z-ADDX@BDNB    #1BDNB           Pieces Per Bag
     C                     Z-ADDX@BJNB    #1BJNB           Bags Per Unit
     C                     MOVELX@SUST    #1SUST           Export_Domestic
     C                     MOVELX@SVST    #1SVST           Print On Schedu
     C                     MOVELX@SYST    #1SYST           Fresh Inv Alloc
     C                     MOVELX@SZST    #1SZST           Fresh Sched As
     C                     MOVELX@S1ST    #1S1ST           Frozen Inv Allo
     C                     MOVELX@XRCD    #1XRCD           Primal Group Co
     C                     MOVELX@XTCD    #1XTCD           Item Meat Cost
     C                     MOVELX@XUCD    #1XUCD           UPC Code 2
     C                     Z-ADDX@F5WG    #1F5WG           Item Target Pri
     C                     Z-ADDX@F6WG    #1F6WG           Minimum Piece W
     C                     Z-ADDX@F7WG    #1F7WG           Maximum Piece W
     C                     Z-ADDX@BLNB    #1BLNB           Seaboard Equiva
     C                     Z-ADDX@BNNB    #1BNNB           Production Qty
     C                     MOVELX@S2ST    #1S2ST           Scheduling Posi
     C                     MOVELX@S4ST    #1S4ST           Sold 100 Percen
     C                     MOVELX@S5ST    #1S5ST           Maximum Shifts
     C                     MOVELX@S6ST    #1S6ST           Value Added Sts
     C                     MOVELX@S8ST    #1S8ST           Label Type
     C                     MOVELX@S9ST    #1S9ST           Item TF Exempt
     C                     MOVELX@TCST    #1TCST           Item TF Classif
     C                     MOVELX@TDST    #1TDST           Default Workcen
     C                     MOVELX@UVST    #1UVST           EDI Status 1
     C                     MOVELX@UWST    #1UWST           EDI Status 2
     C                     MOVELX@UXST    #1UXST           EDI Status 3
     C                     Z-ADDX@AATM    #1AATM           Job Time
     C                     MOVELX@AYNA    #1AYNA           User Id
     C                     MOVELX@A0NA    #1A0NA           Job Name
     C                     Z-ADDX@AXDT    #1AXDT           Job Date
     C                     MOVELX@VSST    #1VSST           Record Status
     C                     Z-ADDX@AIC3    #1AIC3           Company Number
     C                     Z-ADDX@HGCD    #1HGCD           Item Code
     C                     MOVELX@AVNA    #1AVNA           Description Lin
      * Update saved record image
     C                     MOVELX@AWNA    BZAWNA           Description Lin
     C                     MOVELX@L7NA    BZL7NA           Item Label Line
     C                     MOVELX@L8NA    BZL8NA           Item Label Line
     C                     MOVELX@L6NA    BZL6NA           Item Label Line
     C                     MOVELX@MFNA    BZMFNA           Item Label Line
     C                     MOVELX@ADCD    BZADCD           UOM Primary
     C                     Z-ADDX@AWPC    BZAWPC           Conversion Fact
     C                     MOVELX@LXST    BZLXST           Operation Facto
     C                     MOVELX@AECD    BZAECD           UOM Second
     C                     Z-ADDX@AXPC    BZAXPC           Conversion Fact
     C                     MOVELX@LYST    BZLYST           Operation Facto
     C                     MOVELX@AFCD    BZAFCD           UOM Third
     C                     MOVELX@AICD    BZAICD           UOM Pricing
     C                     Z-ADDX@AIWG    BZAIWG           Unit Weight
     C                     MOVELX@HICD    BZHICD           Quality Level
     C                     MOVELX@RBCD    BZRBCD           Item Level
     C                     MOVELX@FZST    BZFZST           Production Date
     C                     MOVELX@AVST    BZAVST           Catch Weight St
     C                     Z-ADDX@CZWG    BZCZWG           Minimum Weight
     C                     Z-ADDX@C0WG    BZC0WG           Maximum Weight
     C                     Z-ADDX@URTN    BZURTN           Number Cases On
     C                     Z-ADDX@AJC8    BZAJC8           Vendor Item Def
     C                     Z-ADDX@RINB    BZRINB           Item Structure
     C                     Z-ADDX@RHNB    BZRHNB           Item Structure
     C                     Z-ADDX@RGNB    BZRGNB           Item Structure
     C                     MOVELX@LNCD    BZLNCD           Default Commod
     C                     Z-ADDX@TFNB    BZTFNB           Transportation
     C                     MOVELX@N0CD    BZN0CD           Item Type Code
     C                     MOVELX@X4ST    BZX4ST           Package Type Co
     C                     Z-ADDX@TMVA    BZTMVA           Maximum Audit V
     C                     Z-ADDX@TNVA    BZTNVA           Minimum Audit V
     C                     Z-ADDX@BLPR    BZBLPR           Market Overage
     C                     Z-ADDX@BMPR    BZBMPR           Standard Overag
     C                     MOVELX@LRCD    BZLRCD           Commodity Price
     C                     MOVELX@U9ST    BZU9ST           Item Pricing Op
     C                     Z-ADDX@CMCO    BZCMCO           Item Pricing Co
     C                     MOVELX@Q1CD    BZQ1CD           Default Warehou
     C                     MOVELX@Q8CD    BZQ8CD           Price Method De
     C                     Z-ADDX@CHTM    BZCHTM           Fresh Chilling
     C                     MOVELX@QZCD    BZQZCD           Base_Conv_Loss
     C                     MOVELX@XWST    BZXWST           Variety_Rendere
     C                     MOVELX@XXST    BZXXST           Frozen Make to
     C                     MOVELX@VMST    BZVMST           Credit Item Sta
     C                     Z-ADDX@SWGH    BZSWGH           Std Weight_Head
     C                     Z-ADDX@PPHE    BZPPHE           Pieces Per Head
     C                     MOVELX@R3CD    BZR3CD           Department Code
     C                     MOVELX@SDCD    BZSDCD           Group for Packa
     C                     Z-ADDX@SFNB    BZSFNB           Pallet Tare Wei
     C                     Z-ADDX@A3WG    BZA3WG           Misc Tare Weigh
     C                     Z-ADDX@SJNB    BZSJNB           Production Lead
     C                     MOVELX@LLCD    BZLLCD           Packaging Code
     C                     MOVELX@LMCD    BZLMCD           Item Market Cod
     C                     MOVELX@P3ST    BZP3ST           TF Co_Ownership
     C                     Z-ADDX@SKNB    BZSKNB           Agrimetrics gro
     C                     Z-ADDX@SLNB    BZSLNB           Agrimetrics pac
     C                     Z-ADDX@SMNB    BZSMNB           Agrimetrics gra
     C                     MOVELX@P4ST    BZP4ST           PA Base Avail R
     C                     Z-ADDX@CFNB    BZCFNB           PM Pounds per H
     C                     Z-ADDX@CGNB    BZCGNB           Item Frt Overag
     C                     Z-ADDX@ILNB    BZILNB           Packages per ca
     C                     Z-ADDX@CHNB    BZCHNB           Use_Freeze_Sell
     C                     Z-ADDX@CINB    BZCINB           PM Batch Size
     C                     Z-ADDX@CJNB    BZCJNB           Package Level s
     C                     Z-ADDX@CMNB    BZCMNB           Partial Item Co
     C                     Z-ADDX@CNNB    BZCNNB           WIP Item Code
     C                     Z-ADDX@CRNB    BZCRNB           WIP Reject Code
     C                     Z-ADDX@CSNB    BZCSNB           Std Costing Uni
     C                     Z-ADDX@CVNB    BZCVNB           FP Std Green We
     C                     Z-ADDX@CWNB    BZCWNB           PM Std LBS Man
     C                     Z-ADDX@CXNB    BZCXNB           PM Raw Meat LBS
     C                     Z-ADDX@CZNB    BZCZNB           PM Formula LBS
     C                     Z-ADDX@C0NB    BZC0NB           PM Finished LBS
     C                     MOVELX@N1CD    BZN1CD           SH Unused_was b
     C                     Z-ADDX@B4NB    BZB4NB           PM Raw Material
     C                     Z-ADDX@B5NB    BZB5NB           PM Line Number
     C                     MOVELX@X5ST    BZX5ST           Seconds Item
     C                     MOVELX@X6ST    BZX6ST           Print on Realiz
     C                     MOVELX@X7ST    BZX7ST           Unit Weight Cha
     C                     MOVELX@PCCT    BZPCCT           Piece Count Ite
     C                     Z-ADDX@BDNB    BZBDNB           Pieces Per Bag
     C                     Z-ADDX@BJNB    BZBJNB           Bags Per Unit
     C                     MOVELX@SUST    BZSUST           Export_Domestic
     C                     MOVELX@SVST    BZSVST           Print On Schedu
     C                     MOVELX@SYST    BZSYST           Fresh Inv Alloc
     C                     MOVELX@SZST    BZSZST           Fresh Sched As
     C                     MOVELX@S1ST    BZS1ST           Frozen Inv Allo
     C                     MOVELX@XRCD    BZXRCD           Primal Group Co
     C                     MOVELX@XTCD    BZXTCD           Item Meat Cost
     C                     MOVELX@XUCD    BZXUCD           UPC Code 2
     C                     Z-ADDX@F5WG    BZF5WG           Item Target Pri
     C                     Z-ADDX@F6WG    BZF6WG           Minimum Piece W
     C                     Z-ADDX@F7WG    BZF7WG           Maximum Piece W
     C                     Z-ADDX@BLNB    BZBLNB           Seaboard Equiva
     C                     Z-ADDX@BNNB    BZBNNB           Production Qty
     C                     MOVELX@S2ST    BZS2ST           Scheduling Posi
     C                     MOVELX@S4ST    BZS4ST           Sold 100 Percen
     C                     MOVELX@S5ST    BZS5ST           Maximum Shifts
     C                     MOVELX@S6ST    BZS6ST           Value Added Sts
     C                     MOVELX@S8ST    BZS8ST           Label Type
     C                     MOVELX@S9ST    BZS9ST           Item TF Exempt
     C                     MOVELX@TCST    BZTCST           Item TF Classif
     C                     MOVELX@TDST    BZTDST           Default Workcen
     C                     MOVELX@UVST    BZUVST           EDI Status 1
     C                     MOVELX@UWST    BZUWST           EDI Status 2
     C                     MOVELX@UXST    BZUXST           EDI Status 3
     C                     Z-ADDX@AATM    BZAATM           Job Time
     C                     MOVELX@AYNA    BZAYNA           User Id
     C                     MOVELX@A0NA    BZA0NA           Job Name
     C                     Z-ADDX@AXDT    BZAXDT           Job Date
     C                     MOVELX@VSST    BZVSST           Record Status
     C                     Z-ADDX@AIC3    BZAIC3           Company Number
     C                     Z-ADDX@HGCD    BZHGCD           Item Code
     C                     MOVELX@AVNA    BZAVNA           Description Lin
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#2    BEGSR
      *================================================================
      * Initialise screen detail record
      *================================================================
      * Existing record indicator
     C                     MOVEL*BLANK    #2OLRC
     C                     Z-ADD#1AIC3    #2AIC3           Company Number
     C                     Z-ADD#1HGCD    #2HGCD           Item Code
     C                     Z-ADD*ZERO     #2IYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     #RGVPC           Off Line Yield
     C                     MOVEL*BLANK    #2UVST           EDI Status 1
     C                     MOVEL*BLANK    #2UWST           EDI Status 2
     C                     MOVEL*BLANK    #2UXST           EDI Status 3
     C                     MOVEL*BLANK    #RELSC           Edt SlsYld,Pump
     C                     MOVEL*BLANK    #RDJST           Select Status
     C                     MOVEL*BLANK    #RQKST           Display Flag
     C                     Z-ADD*ZERO     #2AATM           Job Time
     C                     MOVEL*BLANK    #2AYNA           User Id
     C                     MOVEL*BLANK    #2A0NA           Job Name
     C                     Z-ADD*ZERO     #2AXDT           Job Date
     C                     MOVEL*BLANK    #2SEL            *SFLSEL
     C                     Z-ADD*ZERO     #2C9NB           Component Item
      * Clear external version also
     C                     MOVEL*BLANK    V2C9NB
     C                     MOVEL*BLANK    #RCJTX           USR Item Descri
     C                     MOVEL*BLANK    #2V2ST           BOM Type
     C                     Z-ADD*ZERO     #2BOPR           Sales Yield
     C                     Z-ADD*ZERO     #2BPPR           Production Yiel
     C                     MOVEL*BLANK    #2RTST           BOM Group Prod
     C                     MOVEL*BLANK    #2YAST           Upd Standard Pr
     C                     Z-ADD*ZERO     #2CNSM           Consume Priorit
     C                     Z-ADD*ZERO     #2BMY1           Consume Priorit
     C                     MOVEL*BLANK    #2RSST           BOM Multi RM Op
     C                     Z-ADD*ZERO     #2IXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     #2BMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     #2HGQT           Packaging Quant
     C                     MOVEL*BLANK    #2HHCD           UOM Primary Dft
     C                     MOVEL*BLANK    #2VSST           Record Status
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MEFL#2    BEGSR
      *================================================================
      * Load screen detail record
      *================================================================
      * Existing record indicator
     C                     MOVEL'Y'       #2OLRC
     C                     Z-ADDX#AIC3    #2AIC3           Company Number
     C                     Z-ADDX#HGCD    #2HGCD           Item Code
     C                     Z-ADDX#IYQT    #2IYQT           BOM Off Line Yi
     C                     MOVELX#UVST    #2UVST           EDI Status 1
     C                     MOVELX#UWST    #2UWST           EDI Status 2
     C                     MOVELX#UXST    #2UXST           EDI Status 3
     C                     Z-ADDX#AATM    #2AATM           Job Time
     C                     MOVELX#AYNA    #2AYNA           User Id
     C                     MOVELX#A0NA    #2A0NA           Job Name
     C                     Z-ADDX#AXDT    #2AXDT           Job Date
     C                     Z-ADDX#C9NB    #2C9NB           Component Item
     C                     MOVELX#V2ST    #2V2ST           BOM Type
     C                     Z-ADDX#BOPR    #2BOPR           Sales Yield
     C                     Z-ADDX#BPPR    #2BPPR           Production Yiel
     C                     MOVELX#RTST    #2RTST           BOM Group Prod
     C                     MOVELX#YAST    #2YAST           Upd Standard Pr
     C                     Z-ADDX#CNSM    #2CNSM           Consume Priorit
     C                     Z-ADDX#BMY1    #2BMY1           Consume Priorit
     C                     MOVELX#RSST    #2RSST           BOM Multi RM Op
     C                     Z-ADDX#IXQT    #2IXQT           BOM Meat Cost C
     C                     Z-ADDX#BMY2    #2BMY2           BOM Pumped Perc
     C                     Z-ADDX#HGQT    #2HGQT           Packaging Quant
     C                     MOVELX#HHCD    #2HHCD           UOM Primary Dft
     C                     MOVELX#VSST    #2VSST           Record Status
      * Update saved record image
     C                     Z-ADDX#AIC3    IOAIC3           Company Number
     C                     Z-ADDX#HGCD    IOHGCD           Item Code
     C                     Z-ADDX#IYQT    IOIYQT           BOM Off Line Yi
     C                     MOVELX#UVST    IOUVST           EDI Status 1
     C                     MOVELX#UWST    IOUWST           EDI Status 2
     C                     MOVELX#UXST    IOUXST           EDI Status 3
     C                     Z-ADDX#AATM    IOAATM           Job Time
     C                     MOVELX#AYNA    IOAYNA           User Id
     C                     MOVELX#A0NA    IOA0NA           Job Name
     C                     Z-ADDX#AXDT    IOAXDT           Job Date
     C                     Z-ADDX#C9NB    IOC9NB           Component Item
     C                     MOVELX#V2ST    IOV2ST           BOM Type
     C                     Z-ADDX#BOPR    IOBOPR           Sales Yield
     C                     Z-ADDX#BPPR    IOBPPR           Production Yiel
     C                     MOVELX#RTST    IORTST           BOM Group Prod
     C                     MOVELX#YAST    IOYAST           Upd Standard Pr
     C                     Z-ADDX#CNSM    IOCNSM           Consume Priorit
     C                     Z-ADDX#BMY1    IOBMY1           Consume Priorit
     C                     MOVELX#RSST    IORSST           BOM Multi RM Op
     C                     Z-ADDX#IXQT    IOIXQT           BOM Meat Cost C
     C                     Z-ADDX#BMY2    IOBMY2           BOM Pumped Perc
     C                     Z-ADDX#HGQT    IOHGQT           Packaging Quant
     C                     MOVELX#HHCD    IOHHCD           UOM Primary Dft
     C                     MOVELX#VSST    IOVSST           Record Status
     C                     MOVEL@2DBRC    #2DBRC
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MJIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     Z-ADD*ZERO     #COTNY           Consume Pty %
     C                     Z-ADD*ZERO     #CGWPC           Off Line Yield
     C                     Z-ADD*ZERO     #CGBPR           Meat Cost Consu
     C                     Z-ADD*ZERO     #CCVPR           Sales Yield SUM
     C                     Z-ADD*ZERO     #CCUPR           Production Yiel
     C                     Z-ADD*ZERO     #CCJPR           Sales Yield  SU
     C                     Z-ADD*ZERO     #CTBCI           Total Box Comp
     C                     Z-ADD*ZERO     #CTWWE           Tare Weight SUM
     C                     Z-ADD*ZERO     #CPTWS           Package Tare We
     C                     Z-ADD*ZERO     #CCIPR           Production Yiel
      *================================================================
     CSR         MJEXIT    ENDSR
      /EJECT
     CSR         MNCV#2    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Component Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C9NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C9NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C9NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C9NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#1    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         MPCV#1    BEGSR
      *================================================================
      * Convert control fields into internal form
      *================================================================
      * Quit if only keys available
     C           W0SCR     CABEQ'KEY'     MPEXIT
      * Validate Adjust Credit Pieces
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CEOST'  IFEQ YPMTFD
      * Adjust Credit Pieces
     C                     MOVEL#CEOST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFEOST
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZFEOST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZFEOST
     C                     ENDSL
     C                     EXFMTZEEOST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFEOST    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFEOST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CEOST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      *================================================================
     CSR         MPEXIT    ENDSR
      /EJECT
     CSR         MQIZ#2    BEGSR
      *================================================================
      * Clear value mapped fields
      *================================================================
     C                     Z-ADD*ZERO     #2C9NB           Component Item
      *================================================================
     CSR         MQEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Val Consumed Pty Pct  RT - Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0004           Consume Priorit
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAHGCD    WQSA02           Item Code
     C           *LIKE     DEFN WAV2ST    WQSA03           BOM Type
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3           Company Number
     C                     Z-ADD#1HGCD    WAHGCD           Item Code
     C                     MOVEL'C'       WAV2ST           BOM Type
      * Establish starting position
     C                     MOVEL'Y'       SASQLX  1
     C/EXEC SQL
     C+     DECLARE PDIOREL6XCSR     CURSOR FOR
     C+       SELECT * FROM PDIOREP
     C+           WHERE (IOAIC3       =  :WAAIC3
     C+           AND    IOHGCD       =  :WAHGCD
     C+           AND    IOV2ST       =  :WAV2ST
     C+                 )
     C+         AND (    (     IOV2ST       IN(  'C'
     C+                                     ,'P'
     C+                                   )
     C+                  )
     C+             )
     C+       ORDER BY  IOAIC3        ASC,
     C+                 IOHGCD        ASC,
     C+                 IOV2ST        ASC,
     C+                 IOCNSM        ASC,
     C+                 IOC9NB        ASC
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN PDIOREL6XCSR
     C/END-EXEC
     C           SQLCOD    IFEQ -502
     C/EXEC SQL
     C+   CLOSE PDIOREL6XCSR
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN PDIOREL6XCSR
     C/END-EXEC
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     ENDIF
     C                     ENDIF
     C/EXEC SQL
     C+   FETCH PDIOREL6XCSR
     C+     INTO :QPDIO1
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Consume Priority is EQ 1
     C           WACNSM    IFEQ 1                          *IF
     C                     ADD  WABMY1    YL0003           Consume Pty % S
     C                     ELSE
      * CASE: *OTHERWISE
      * Save last consume pty %
      * CASE: DB1.Consume Priority GT LCL.Consume Priority
     C           WACNSM    IFGT YL0004                     *IF
     C                     Z-ADDWABMY1    YL0002           Consume Priorit
     C                     END                             *FI
     C                     END                             *FI
     C/EXEC SQL
     C+   FETCH PDIOREL6XCSR
     C+     INTO :QPDIO1
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C                     ENDDO
     C           SAEXIT    TAG
     C           SASQLX    IFEQ 'Y'
     C/EXEC SQL
     C+   CLOSE PDIOREL6XCSR
     C/END-EXEC
     C                     MOVEL*BLANK    SASQLX
     C                     ENDIF
      *================================================================
     CSR                   ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Adj Credit Pieces RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADD#1AIC3    FDAIC3           Company Number
     C                     Z-ADD#1HGCD    FDHGCD           Item Code
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QPMFD1
     C+       FROM  PMFDREP
     C+       WHERE ( FDAIC3       = :FDAIC3     AND
     C+               FDHGCD       = :FDHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CEOST           Adjust Credit P
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFDEOST    #CEOST           Adjust Credit P
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Descriptions      RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBHGCD           Item Code
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QCABZ3
     C+       FROM  CABZREP
     C+       WHERE ( BZAIC3       = :WBAIC3     AND
     C+               BZHGCD       = :WBHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAVNA    WL0003           Description Lin
     C                     MOVELWBAWNA    WL0004           Description Lin
     C                     MOVELWBADCD    WL0005           UOM Primary
     C                     MOVELWBAECD    WL0006           UOM Second
     C                     MOVELWBAFCD    WL0007           UOM Third
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Co Itm Std Prd Dft RT - Company Item Std Prd Dflt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADDWL0008    BLAIC3           Company Number
     C                     Z-ADDWL0009    BLHGCD           Item Code
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QPBBL1
     C+       FROM  PBBLREP
     C+       WHERE ( BLAIC3       = :BLAIC3     AND
     C+               BLHGCD       = :BLHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4723' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           Company Item Up
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBLBLSP    WL0010           Company Item Up
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Item Type/BsCv    RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     Z-ADD#2C9NB    WBHGCD           Item Code
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QCABZ3
     C+       FROM  CABZREP
     C+       WHERE ( BZAIC3       = :WBAIC3     AND
     C+               BZHGCD       = :WBHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    YL0007           Base_Conv_Loss
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBN0CD    WUN0CD           Item Type Code
     C                     MOVELWBQZCD    YL0007           Base_Conv_Loss
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Credit Item Sts   RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADD#2AIC3    WBAIC3           Company Number
     C                     Z-ADD#2C9NB    WBHGCD           Item Code
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QCABZ3
     C+       FROM  CABZREP
     C+       WHERE ( BZAIC3       = :WBAIC3     AND
     C+               BZHGCD       = :WBHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUVMST           Credit Item Sta
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBVMST    WUVMST           Credit Item Sta
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Item Type Code     RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     Z-ADD#2C9NB    WBHGCD           Item Code
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QCABZ3
     C+       FROM  CABZREP
     C+       WHERE ( BZAIC3       = :WBAIC3     AND
     C+               BZHGCD       = :WBHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBN0CD    WUN0CD           Item Type Code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Item Type/Pack Cd2 RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADD#2AIC3    WBAIC3           Company Number
     C                     Z-ADD#2C9NB    WBHGCD           Item Code
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QCABZ3
     C+       FROM  CABZREP
     C+       WHERE ( BZAIC3       = :WBAIC3     AND
     C+               BZHGCD       = :WBHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WUX4ST           Package Type Co
     C                     Z-ADD*ZERO     WUSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WUA3WG           Misc Tare Weigh
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAIWG    WUAIWG           Unit Weight
     C                     MOVELWBN0CD    WUN0CD           Item Type Code
     C                     MOVELWBX4ST    WUX4ST           Package Type Co
     C                     Z-ADDWBSFNB    WUSFNB           Pallet Tare Wei
     C                     Z-ADDWBA3WG    WUA3WG           Misc Tare Weigh
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIINFN    BEGSR
      *================================================================
      * Crt/Chg ITM BOM AllPLN IF - Item Bill Of Material  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
      * Crt/Chg ITM BOM AllPLN IF
      * CASE: PAR.BOM Type is Meat Items
     C           WL0014    IFEQ 'C'                        *IF
     C           WL0014    OREQ 'P'
      * DLY029  RMC 06/06/07  Dont pos on a company. read/upd all plant c
      * R9547 DN 03/14/17-Change Access Path to Read/Upd by Company/Item.
      * Rtv BOM - Update Plant RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0011    WL0034           Company Number
     C                     Z-ADDWL0012    WL0035           Item Code
     C                     Z-ADDWL0013    WL0036           Component Item
     C                     MOVELWL0014    WL0037    P      BOM Type
     C                     Z-ADDWL0015    WL0038           Sales Yield
     C                     Z-ADDWL0016    WL0039           Production Yiel
     C                     Z-ADDWL0017    WL0040           Packaging Quant
     C                     MOVELWL0018    WL0041    P      UOM Primary Dft
     C                     MOVELWL0019    WL0042    P      Upd Standard Pr
     C                     Z-ADDWL0020    WL0043           Consume Priorit
     C                     Z-ADDWL0021    WL0044           Consume Priorit
     C                     Z-ADDWL0022    WL0045           BOM Pumped Perc
     C                     Z-ADDWL0023    WL0046           BOM Meat Cost C
     C                     Z-ADDWL0024    WL0047           BOM Off Line Yi
     C                     MOVELWL0025    WL0048    P      BOM Multi RM Op
     C                     MOVELWL0026    WL0049    P      BOM Group Prod
     C                     MOVELWL0030    WL0050    P      Record Status
     C                     MOVELWL0031    WL0051    P      *Delete Mode  U
     C                     Z-ADDWL0033    WL0052           Sync with Compa
     C                     EXSR SJRVGN
     C                     ELSE
      * CASE: PAR.BOM Type is Supplies
     C           WL0014    IFEQ 'S'                        *IF
      * CASE: PAR.*Delete Mode  Usr is *del mode
     C           WL0031    IFEQ 'DEL'                      *IF
      * DLT Item BOM           DL - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0011    WL0073           Company Number
     C                     Z-ADDWL0012    WL0074           Item Code
     C                     Z-ADDWL0013    WL0075           Component Item
     C                     EXSR SNDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * This routine will select on this company
      * and update this item's BOM for this comp item.
      * CASE: PAR.Record Found USR is Record Found
     C           WL0032    IFEQ 'Y'                        *IF
      * CHG Item BOM           CH - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0011    WL0076           Company Number
     C                     Z-ADDWL0012    WL0077           Item Code
     C                     Z-ADDWL0013    WL0078           Component Item
     C                     MOVELWL0014    WL0079    P      BOM Type
     C                     Z-ADDWL0015    WL0080           Sales Yield
     C                     Z-ADDWL0016    WL0081           Production Yiel
     C                     Z-ADDWL0017    WL0082           Packaging Quant
     C                     MOVELWL0018    WL0083    P      UOM Primary Dft
     C                     MOVELWL0019    WL0084    P      Upd Standard Pr
     C                     Z-ADDWL0020    WL0085           Consume Priorit
     C                     Z-ADDWL0021    WL0086           Consume Priorit
     C                     Z-ADDWL0022    WL0087           BOM Pumped Perc
     C                     Z-ADDWL0023    WL0088           BOM Meat Cost C
     C                     Z-ADDWL0024    WL0089           BOM Off Line Yi
     C                     MOVELWL0025    WL0090    P      BOM Multi RM Op
     C                     MOVELWL0026    WL0091    P      BOM Group Prod
     C                     MOVELWL0027    WL0092    P      EDI Status 1
     C                     MOVELWL0028    WL0093    P      EDI Status 2
     C                     MOVELWL0029    WL0094    P      EDI Status 3
     C                     MOVELWL0030    WL0095    P      Record Status
     C                     EXSR SOCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * E3160 JJH 07/14/14 - Get Co Item Std Prd Dflt
      * Rtv Co Itm Std Prd Dft RT - Company Item Std Prd Dflt  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0011    WL0008           Company Number
     C                     Z-ADDWL0013    WL0009           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YL0008    P      Company Item Up
      * CRT Item BOM           CR - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0011    WL0053           Company Number
     C                     Z-ADDWL0012    WL0054           Item Code
     C                     Z-ADDWL0013    WL0055           Component Item
     C                     MOVELWL0014    WL0056    P      BOM Type
     C                     Z-ADDWL0015    WL0057           Sales Yield
     C                     Z-ADDWL0016    WL0058           Production Yiel
     C                     Z-ADDWL0017    WL0059           Packaging Quant
     C                     MOVELWL0018    WL0060    P      UOM Primary Dft
     C                     MOVELYL0008    WL0061    P      Upd Standard Pr
     C                     Z-ADDWL0020    WL0062           Consume Priorit
     C                     Z-ADDWL0021    WL0063           Consume Priorit
     C                     Z-ADDWL0022    WL0064           BOM Pumped Perc
     C                     Z-ADDWL0023    WL0065           BOM Meat Cost C
     C                     Z-ADDWL0024    WL0066           BOM Off Line Yi
     C                     MOVELWL0025    WL0067    P      BOM Multi RM Op
     C                     MOVELWL0026    WL0068    P      BOM Group Prod
     C                     MOVELWL0027    WL0069    P      EDI Status 1
     C                     MOVELWL0028    WL0070    P      EDI Status 2
     C                     MOVELWL0029    WL0071    P      EDI Status 3
     C                     MOVELWL0030    WL0072    P      Record Status
     C                     EXSR SMCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv BOM - Update Plant RT - Company Item  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0005  1        EDI Status 1
     C                     MOVEL*BLANK    WN0006  1        EDI Status 2
     C                     MOVEL*BLANK    WN0007  1        EDI Status 3
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADDWL0034    WBAIC3           Company Number
     C                     Z-ADDWL0035    WBHGCD           Item Code
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QCABZ3
     C+       FROM  CABZREP
     C+       WHERE ( BZAIC3       = :WBAIC3     AND
     C+               BZHGCD       = :WBHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
     C                     EXSR SKRVGN
      * CASE: WRK.Plant Company Sts is Plant Company
     C           WUYISX    IFEQ 'P'                        *IF
      * Rtv BOM - Update Plant RT - Item Bill Of Material  * 
     C                     EXSR SLRVGN
      * R9547 DN 03/14/17-Sync Sales Yield, Meat$ Consumed% & Pumped%.
      * CASE: PAR.Sync with Company USR is not equal to zero
     C           WL0052    IFNE 0                          *IF
      * Upd Sync SlsY,Meat$C,Pmp% - Item Bill Of Material  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADDWBAIC3    JYAIC3           Company Number
      * Establish starting position
     C                     MOVEL'Y'       SKSQLX  1
     C/EXEC SQL
     C+     DECLARE PDJYREL2XCSR     CURSOR FOR
     C+       SELECT * FROM PDJYREP
     C+           WHERE (JYAIC3     =  :JYAIC3
     C+                 )
     C+         AND (    (     JYVSST      = 'A'
     C+                  )
     C+             )
     C+       ORDER BY  JYAIC3        ASC
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN PDJYREL2XCSR
     C/END-EXEC
     C           SQLCOD    IFEQ -502
     C/EXEC SQL
     C+   CLOSE PDJYREL2XCSR
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN PDJYREL2XCSR
     C/END-EXEC
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     ENDIF
     C                     ENDIF
     C/EXEC SQL
     C+   FETCH PDJYREL2XCSR
     C+     INTO :QPDJY1
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUYISX           Plant Company S
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYISX    WUYISX           Plant Company S
     C                     ENDIF
     C           SKEXIT    TAG
     C           SKSQLX    IFEQ 'Y'
     C/EXEC SQL
     C+   CLOSE PDJYREL2XCSR
     C/END-EXEC
     C                     MOVEL*BLANK    SKSQLX
     C                     ENDIF
      *================================================================
     CSR                   ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv BOM - Update Plant RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008  60       Job Time
     C                     MOVEL*BLANK    WN0009 10        User Id
     C                     MOVEL*BLANK    WN0010 10        Job Name
     C                     Z-ADD*ZERO     WN0011  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWL0035    WCHGCD           Item Code
     C                     Z-ADDWL0036    WCC9NB           Component Item
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QPDIO2
     C+       FROM  PDIOREP
     C+       WHERE ( IOAIC3       = :WCAIC3     AND
     C+               IOHGCD       = :WCHGCD     AND
     C+               IOC9NB       = :WCC9NB    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.*Delete Mode  Usr is *other mode
     C           WL0051    IFEQ *BLANK                     *IF
      * CRT Item BOM           CR - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0053           Company Number
     C                     Z-ADDWL0035    WL0054           Item Code
     C                     Z-ADDWL0036    WL0055           Component Item
     C                     MOVELWL0037    WL0056    P      BOM Type
     C                     Z-ADDWL0038    WL0057           Sales Yield
     C                     Z-ADDWL0039    WL0058           Production Yiel
     C                     Z-ADDWL0040    WL0059           Packaging Quant
     C                     MOVELWL0041    WL0060    P      UOM Primary Dft
     C                     MOVELWL0042    WL0061    P      Upd Standard Pr
     C                     Z-ADDWL0043    WL0062           Consume Priorit
     C                     Z-ADDWL0044    WL0063           Consume Priorit
     C                     Z-ADDWL0045    WL0064           BOM Pumped Perc
     C                     Z-ADDWL0046    WL0065           BOM Meat Cost C
     C                     Z-ADDWL0047    WL0066           BOM Off Line Yi
     C                     MOVELWL0048    WL0067    P      BOM Multi RM Op
     C                     MOVELWL0049    WL0068    P      BOM Group Prod
     C                     MOVELWN0005    WL0069    P      EDI Status 1
     C                     MOVELWN0006    WL0070    P      EDI Status 2
     C                     MOVELWN0007    WL0071    P      EDI Status 3
     C                     MOVELWL0050    WL0072    P      Record Status
     C                     EXSR SMCRRC
     C                     END                             *FI
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: PAR.*Delete Mode  Usr is *del mode
     C           WL0051    IFEQ 'DEL'                      *IF
      * DLT Item BOM           DL - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0073           Company Number
     C                     Z-ADDWL0035    WL0074           Item Code
     C                     Z-ADDWL0036    WL0075           Component Item
     C                     EXSR SNDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Item BOM           CH - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0076           Company Number
     C                     Z-ADDWL0035    WL0077           Item Code
     C                     Z-ADDWL0036    WL0078           Component Item
     C                     MOVELWL0037    WL0079    P      BOM Type
     C                     Z-ADDWL0038    WL0080           Sales Yield
     C                     Z-ADDWL0039    WL0081           Production Yiel
     C                     Z-ADDWL0040    WL0082           Packaging Quant
     C                     MOVELWL0041    WL0083    P      UOM Primary Dft
     C                     MOVELWL0042    WL0084    P      Upd Standard Pr
     C                     Z-ADDWL0043    WL0085           Consume Priorit
     C                     Z-ADDWL0044    WL0086           Consume Priorit
     C                     Z-ADDWL0045    WL0087           BOM Pumped Perc
     C                     Z-ADDWL0046    WL0088           BOM Meat Cost C
     C                     Z-ADDWL0047    WL0089           BOM Off Line Yi
     C                     MOVELWL0048    WL0090    P      BOM Multi RM Op
     C                     MOVELWL0049    WL0091    P      BOM Group Prod
     C                     MOVELWN0005    WL0092    P      EDI Status 1
     C                     MOVELWN0006    WL0093    P      EDI Status 2
     C                     MOVELWN0007    WL0094    P      EDI Status 3
     C                     MOVELWL0050    WL0095    P      Record Status
     C                     EXSR SOCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * CRT Item BOM           CR - Item Bill Of Material  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0012  60       Job Time
     C                     MOVEL*BLANK    WN0013 10        User Id
     C                     MOVEL*BLANK    WN0014 10        Job Name
     C                     Z-ADD*ZERO     WN0015  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @IORETH
     C                     Z-ADDWL0053    IOAIC3           Company Number
     C                     Z-ADDWL0054    IOHGCD           Item Code
     C                     Z-ADDWL0055    IOC9NB           Component Item
     C                     MOVELWL0056    IOV2ST           BOM Type
     C                     Z-ADDWL0057    IOBOPR           Sales Yield
     C                     Z-ADDWL0058    IOBPPR           Production Yiel
     C                     Z-ADDWL0059    IOHGQT           Packaging Quant
     C                     MOVELWL0060    IOHHCD           UOM Primary Dft
     C                     MOVELWL0061    IOYAST           Upd Standard Pr
     C                     Z-ADDWL0062    IOCNSM           Consume Priorit
     C                     Z-ADDWL0063    IOBMY1           Consume Priorit
     C                     Z-ADDWL0064    IOBMY2           BOM Pumped Perc
     C                     Z-ADDWL0065    IOIXQT           BOM Meat Cost C
     C                     Z-ADDWL0066    IOIYQT           BOM Off Line Yi
     C                     MOVELWL0067    IORSST           BOM Multi RM Op
     C                     MOVELWL0068    IORTST           BOM Group Prod
     C                     MOVELWL0069    IOUVST           EDI Status 1
     C                     MOVELWL0070    IOUWST           EDI Status 2
     C                     MOVELWL0071    IOUXST           EDI Status 3
     C                     MOVELWL0072    IOVSST           Record Status
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       IOVSST           Record Status
     C                     Z-ADD##JTM     IOAATM           Job Time
     C                     MOVEL##USR     IOAYNA           User Id
     C                     MOVEL##PGM     IOA0NA           Job Name
     C                     Z-ADD##JDT     IOAXDT           Job Date
     C/EXEC SQL
     C+     INSERT  INTO PDIOREP
     C+       VALUES( :IOAIC3
     C+             , :IOHGCD
     C+             , :IOC9NB
     C+             , :IOV2ST
     C+             , :IOBOPR
     C+             , :IOBPPR
     C+             , :IOHGQT
     C+             , :IOHHCD
     C+             , :IOYAST
     C+             , :IOCNSM
     C+             , :IOBMY1
     C+             , :IOBMY2
     C+             , :IOIXQT
     C+             , :IOIYQT
     C+             , :IORSST
     C+             , :IORTST
     C+             , :IOUVST
     C+             , :IOUWST
     C+             , :IOUXST
     C+             , :IOVSST
     C+             , :IOAATM
     C+             , :IOAYNA
     C+             , :IOA0NA
     C+             , :IOAXDT
     C+             )
     C/END-EXEC
     C           SQLCOD    IFNE 0
     C                     SETON                       91  *91=ERR
     C                     ELSE
     C                     SETOF                       91  *91=ERR
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNDLRC    BEGSR
      *================================================================
      * DLT Item BOM           DL - Item Bill Of Material  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @IORETH
     C                     Z-ADDWL0073    IOAIC3           Company Number
     C                     Z-ADDWL0074    IOHGCD           Item Code
     C                     Z-ADDWL0075    IOC9NB           Component Item
      *
      *................................................................
     C/EXEC SQL
     C+     DELETE FROM PDIOREP
     C+       WHERE ( IOAIC3       = :IOAIC3     AND
     C+               IOHGCD       = :IOHGCD     AND
     C+               IOC9NB       = :IOC9NB    )
     C/END-EXEC
     C           SQLCOD    IFNE 0
     C                     SETON                       91  *91=ERR
     C                     ELSE
     C                     SETOF                       91  *91=ERR
     C                     END
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * CHG Item BOM           CH - Item Bill Of Material  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0016  60       Job Time
     C                     MOVEL*BLANK    WN0017 10        User Id
     C                     MOVEL*BLANK    WN0018 10        Job Name
     C                     Z-ADD*ZERO     WN0019  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @IORETH
     C                     Z-ADDWL0076    IOAIC3           Company Number
     C                     Z-ADDWL0077    IOHGCD           Item Code
     C                     Z-ADDWL0078    IOC9NB           Component Item
      *
     C/EXEC SQL
     C+     SELECT
     C+       IOAIC3    ,
     C+       IOHGCD    ,
     C+       IOC9NB    ,
     C+       IOV2ST    ,
     C+       IOBOPR    ,
     C+       IOBPPR    ,
     C+       IOHGQT    ,
     C+       IOHHCD    ,
     C+       IOYAST    ,
     C+       IOCNSM    ,
     C+       IOBMY1    ,
     C+       IOBMY2    ,
     C+       IOIXQT    ,
     C+       IOIYQT    ,
     C+       IORSST    ,
     C+       IORTST    ,
     C+       IOUVST    ,
     C+       IOUWST    ,
     C+       IOUXST    ,
     C+       IOVSST    ,
     C+       IOAATM    ,
     C+       IOAYNA    ,
     C+       IOA0NA    ,
     C+       IOAXDT
     C+     INTO
     C+       :IOAIC3    ,
     C+       :IOHGCD    ,
     C+       :IOC9NB    ,
     C+       :IOV2ST    ,
     C+       :IOBOPR    ,
     C+       :IOBPPR    ,
     C+       :IOHGQT    ,
     C+       :IOHHCD    ,
     C+       :IOYAST    ,
     C+       :IOCNSM    ,
     C+       :IOBMY1    ,
     C+       :IOBMY2    ,
     C+       :IOIXQT    ,
     C+       :IOIYQT    ,
     C+       :IORSST    ,
     C+       :IORTST    ,
     C+       :IOUVST    ,
     C+       :IOUWST    ,
     C+       :IOUXST    ,
     C+       :IOVSST    ,
     C+       :IOAATM    ,
     C+       :IOAYNA    ,
     C+       :IOA0NA    ,
     C+       :IOAXDT
     C+       FROM  PDIOREP
     C+       WHERE ( IOAIC3       = :IOAIC3     AND
     C+               IOHGCD       = :IOHGCD     AND
     C+               IOC9NB       = :IOC9NB    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C                     SETOF                       90  *
     C                     END
     C           SQLCOD    IFEQ -913
     C           SQLCOD    OREQ -7958
     C                     SETON                       91  *91=Rcd Lock
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       91  *
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIOREL0'MDACP
     C                     MOVEL'@IORETH' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @2DBRC    YARDCS
      * Move non-key fields to @IORETH
     C                     MOVELWL0079    IOV2ST    P      BOM Type
     C                     Z-ADDWL0080    IOBOPR           Sales Yield
     C                     Z-ADDWL0081    IOBPPR           Production Yiel
     C                     Z-ADDWL0082    IOHGQT           Packaging Quant
     C                     MOVELWL0083    IOHHCD    P      UOM Primary Dft
     C                     MOVELWL0084    IOYAST    P      Upd Standard Pr
     C                     Z-ADDWL0085    IOCNSM           Consume Priorit
     C                     Z-ADDWL0086    IOBMY1           Consume Priorit
     C                     Z-ADDWL0087    IOBMY2           BOM Pumped Perc
     C                     Z-ADDWL0088    IOIXQT           BOM Meat Cost C
     C                     Z-ADDWL0089    IOIYQT           BOM Off Line Yi
     C                     MOVELWL0090    IORSST    P      BOM Multi RM Op
     C                     MOVELWL0091    IORTST    P      BOM Group Prod
     C                     MOVELWL0092    IOUVST    P      EDI Status 1
     C                     MOVELWL0093    IOUWST    P      EDI Status 2
     C                     MOVELWL0094    IOUXST    P      EDI Status 3
     C                     MOVELWL0095    IOVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           @2DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     IOAATM           Job Time
     C                     MOVEL##USR     IOAYNA           User Id
     C                     MOVEL##JOB     IOA0NA           Job Name
     C                     Z-ADD##JDT     IOAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @2DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
     C                     SETOF                       91  *91=ERR
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C/EXEC SQL
     C+     UPDATE PDIOREP
     C+            SET IOV2ST       = :IOV2ST
     C+             ,  IOBOPR       = :IOBOPR
     C+             ,  IOBPPR       = :IOBPPR
     C+             ,  IOHGQT       = :IOHGQT
     C+             ,  IOHHCD       = :IOHHCD
     C+             ,  IOYAST       = :IOYAST
     C+             ,  IOCNSM       = :IOCNSM
     C+             ,  IOBMY1       = :IOBMY1
     C+             ,  IOBMY2       = :IOBMY2
     C+             ,  IOIXQT       = :IOIXQT
     C+             ,  IOIYQT       = :IOIYQT
     C+             ,  IORSST       = :IORSST
     C+             ,  IORTST       = :IORTST
     C+             ,  IOUVST       = :IOUVST
     C+             ,  IOUWST       = :IOUWST
     C+             ,  IOUXST       = :IOUXST
     C+             ,  IOVSST       = :IOVSST
     C+             ,  IOAATM       = :IOAATM
     C+             ,  IOAYNA       = :IOAYNA
     C+             ,  IOA0NA       = :IOA0NA
     C+             ,  IOAXDT       = :IOAXDT
     C+       WHERE ( IOAIC3       = :IOAIC3     AND
     C+               IOHGCD       = :IOHGCD     AND
     C+               IOC9NB       = :IOC9NB    )
     C/END-EXEC
     C           SQLCOD    IFNE 0
     C                     SETON                       91  *91=ERR
     C                     ELSE
     C                     SETOF                       91  *91=ERR
     C                     END
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Upd Sync SlsY,Meat$C,Pmp% - Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0020  1        BOM Multi RM Op
     C                     MOVEL*BLANK    WN0021  2        BOM Group Prod
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADDWL0052    WCAIC3           Company Number
     C                     Z-ADDWL0035    WCHGCD           Item Code
     C                     Z-ADDWL0036    WCC9NB           Component Item
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QPDIO2
     C+       FROM  PDIOREP
     C+       WHERE ( IOAIC3       = :WCAIC3     AND
     C+               IOHGCD       = :WCHGCD     AND
     C+               IOC9NB       = :WCC9NB    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Item BOM           CR - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0052    WL0053           Company Number
     C                     Z-ADDWL0035    WL0054           Item Code
     C                     Z-ADDWL0036    WL0055           Component Item
     C                     MOVELWL0037    WL0056    P      BOM Type
     C                     Z-ADDWL0038    WL0057           Sales Yield
     C                     Z-ADD*ZERO     WL0058           Production Yiel
     C                     Z-ADD*ZERO     WL0059           Packaging Quant
     C                     MOVEL*BLANK    WL0060           UOM Primary Dft
     C                     MOVEL*BLANK    WL0061           Upd Standard Pr
     C                     Z-ADD*ZERO     WL0062           Consume Priorit
     C                     Z-ADD*ZERO     WL0063           Consume Priorit
     C                     Z-ADDWL0045    WL0064           BOM Pumped Perc
     C                     Z-ADDWL0046    WL0065           BOM Meat Cost C
     C                     Z-ADD*ZERO     WL0066           BOM Off Line Yi
     C                     MOVELWN0020    WL0067    P      BOM Multi RM Op
     C                     MOVELWN0021    WL0068    P      BOM Group Prod
     C                     MOVELWN0005    WL0069    P      EDI Status 1
     C                     MOVELWN0006    WL0070    P      EDI Status 2
     C                     MOVELWN0007    WL0071    P      EDI Status 3
     C                     MOVELWL0050    WL0072    P      Record Status
     C                     EXSR SMCRRC
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: PAR.*Delete Mode  Usr is *del mode
     C           WL0051    IFEQ 'DEL'                      *IF
      * Zero Out Sales Yield, Meat $ Consumed % & Pumped %.
      * CHG Item BOM           CH - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0076           Company Number
     C                     Z-ADDWCHGCD    WL0077           Item Code
     C                     Z-ADDWCC9NB    WL0078           Component Item
     C                     MOVELWCV2ST    WL0079    P      BOM Type
     C                     Z-ADD*ZERO     WL0080           Sales Yield
     C                     Z-ADDWCBPPR    WL0081           Production Yiel
     C                     Z-ADDWCHGQT    WL0082           Packaging Quant
     C                     MOVELWCHHCD    WL0083    P      UOM Primary Dft
     C                     MOVELWCYAST    WL0084    P      Upd Standard Pr
     C                     Z-ADDWCCNSM    WL0085           Consume Priorit
     C                     Z-ADDWCBMY1    WL0086           Consume Priorit
     C                     Z-ADD*ZERO     WL0087           BOM Pumped Perc
     C                     Z-ADD*ZERO     WL0088           BOM Meat Cost C
     C                     Z-ADDWCIYQT    WL0089           BOM Off Line Yi
     C                     MOVELWCRSST    WL0090    P      BOM Multi RM Op
     C                     MOVELWCRTST    WL0091    P      BOM Group Prod
     C                     MOVELWCUVST    WL0092    P      EDI Status 1
     C                     MOVELWCUWST    WL0093    P      EDI Status 2
     C                     MOVELWCUXST    WL0094    P      EDI Status 3
     C                     MOVELWCVSST    WL0095    P      Record Status
     C                     EXSR SOCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Item BOM           CH - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0076           Company Number
     C                     Z-ADDWCHGCD    WL0077           Item Code
     C                     Z-ADDWCC9NB    WL0078           Component Item
     C                     MOVELWCV2ST    WL0079    P      BOM Type
     C                     Z-ADDWL0038    WL0080           Sales Yield
     C                     Z-ADDWCBPPR    WL0081           Production Yiel
     C                     Z-ADDWCHGQT    WL0082           Packaging Quant
     C                     MOVELWCHHCD    WL0083    P      UOM Primary Dft
     C                     MOVELWCYAST    WL0084    P      Upd Standard Pr
     C                     Z-ADDWCCNSM    WL0085           Consume Priorit
     C                     Z-ADDWCBMY1    WL0086           Consume Priorit
     C                     Z-ADDWL0045    WL0087           BOM Pumped Perc
     C                     Z-ADDWL0046    WL0088           BOM Meat Cost C
     C                     Z-ADDWCIYQT    WL0089           BOM Off Line Yi
     C                     MOVELWCRSST    WL0090    P      BOM Multi RM Op
     C                     MOVELWCRTST    WL0091    P      BOM Group Prod
     C                     MOVELWCUVST    WL0092    P      EDI Status 1
     C                     MOVELWCUWST    WL0093    P      EDI Status 2
     C                     MOVELWCUXST    WL0094    P      EDI Status 3
     C                     MOVELWCVSST    WL0095    P      Record Status
     C                     EXSR SOCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Upd Adj Credit Pieces RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     Z-ADD#1HGCD    WBHGCD           Item Code
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QCABZ3
     C+       FROM  CABZREP
     C+       WHERE ( BZAIC3       = :WBAIC3     AND
     C+               BZHGCD       = :WBHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Adj Credit Pieces CH - Company Item Ext  * 
     C                     EXSR SRCHRC
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Adj Credit Pieces CH - Company Item Ext  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0022  1        Produce on Sund
     C                     MOVEL*BLANK    WN0023  1        Produce on Mond
     C                     MOVEL*BLANK    WN0024  1        Produce on Tues
     C                     MOVEL*BLANK    WN0025  1        Produce on Wedn
     C                     MOVEL*BLANK    WN0026  1        Produce on Thur
     C                     MOVEL*BLANK    WN0027  1        Produce on Frid
     C                     MOVEL*BLANK    WN0028  1        Produce on Satu
     C                     MOVEL*BLANK    WN0029  1        Plan Production
     C                     MOVEL*BLANK    WN0030  1        Allocation Meth
     C                     MOVEL*BLANK    WN0031  2        CIE Use Age Day
     C                     MOVEL*BLANK    WN0032  2        CIE MPR Report
     C                     Z-ADD*ZERO     WN0033 112       CIE Unused Numb
     C                     Z-ADD*ZERO     WN0034 110       CIE Unused Numb
     C                     Z-ADD*ZERO     WN0035  70       CIE Unused Date
     C                     MOVEL*BLANK    WN0036 25        CIE TPM Equipme
     C                     MOVEL*BLANK    WN0037  6        CIE Capacity Co
     C                     MOVEL*BLANK    WN0038  1        Record Status
     C                     Z-ADD*ZERO     WN0039  70       Create Date
     C                     Z-ADD*ZERO     WN0040  60       Create Time
     C                     MOVEL*BLANK    WN0041 10        Create User
     C                     MOVEL*BLANK    WN0042 10        Create Program
     C                     Z-ADD*ZERO     WN0043  70       Change Date
     C                     Z-ADD*ZERO     WN0044  60       Change Time
     C                     MOVEL*BLANK    WN0045 10        Change User
     C                     MOVEL*BLANK    WN0046 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FDREAO
     C                     Z-ADDWBAIC3    WDAIC3           Company Number
     C                     Z-ADD#1HGCD    WDHGCD           Item Code
      *
     C/EXEC SQL
     C+     SELECT
     C+       FDAIC3    ,
     C+       FDHGCD    ,
     C+       FDD0ST    ,
     C+       FDD2ST    ,
     C+       FDD6ST    ,
     C+       FDWESP    ,
     C+       FDEDST    ,
     C+       FDEFST    ,
     C+       FDEHST    ,
     C+       FDEMST    ,
     C+       FDENST    ,
     C+       FDEOST    ,
     C+       FDEPST    ,
     C+       FDEQST    ,
     C+       FDOQNY    ,
     C+       FDORNY    ,
     C+       FDS2DT    ,
     C+       FDUFT1    ,
     C+       FDKUAA    ,
     C+       FDVSST    ,
     C+       FDMJDT    ,
     C+       FDBETM    ,
     C+       FDCCVN    ,
     C+       FDCDVN    ,
     C+       FDMKDT    ,
     C+       FDBFTM    ,
     C+       FDCEVN    ,
     C+       FDCFVN
     C+     INTO
     C+       :WDAIC3    ,
     C+       :WDHGCD    ,
     C+       :WDD0ST    ,
     C+       :WDD2ST    ,
     C+       :WDD6ST    ,
     C+       :WDWESP    ,
     C+       :WDEDST    ,
     C+       :WDEFST    ,
     C+       :WDEHST    ,
     C+       :WDEMST    ,
     C+       :WDENST    ,
     C+       :WDEOST    ,
     C+       :WDEPST    ,
     C+       :WDEQST    ,
     C+       :WDOQNY    ,
     C+       :WDORNY    ,
     C+       :WDS2DT    ,
     C+       :WDUFT1    ,
     C+       :WDKUAA    ,
     C+       :WDVSST    ,
     C+       :WDMJDT    ,
     C+       :WDBETM    ,
     C+       :WDCCVN    ,
     C+       :WDCDVN    ,
     C+       :WDMKDT    ,
     C+       :WDBFTM    ,
     C+       :WDCEVN    ,
     C+       :WDCFVN
     C+       FROM  PMFDREP
     C+       WHERE ( FDAIC3       = :WDAIC3     AND
     C+               FDHGCD       = :WDHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C                     SETOF                       90  *
     C                     END
     C           SQLCOD    IFEQ -913
     C           SQLCOD    OREQ -7958
     C                     SETON                       91  *91=Rcd Lock
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       91  *
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Company Item Ext  CR - Company Item Ext  * 
     C                     EXSR SSCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMFDREL0'MDACP
     C                     MOVEL'@FDREAO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMFD2    YBRDCS
      * Move non-key fields to @FDREAO
     C                     MOVEL#CEOST    WDEOST    P      Adjust Credit P
      *
      * Set PGM.*Record Data Changed flag
     C           QPMFD2    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WDMKDT           Change Date
     C                     Z-ADD##JTM     WDBFTM           Change Time
     C                     MOVEL##USR     WDCEVN           Change User
     C                     MOVEL##PGM     WDCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPMFD2    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
     C                     SETOF                       91  *91=ERR
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C/EXEC SQL
     C+     UPDATE PMFDREP
     C+            SET FDD0ST       = :WDD0ST
     C+             ,  FDD2ST       = :WDD2ST
     C+             ,  FDD6ST       = :WDD6ST
     C+             ,  FDWESP       = :WDWESP
     C+             ,  FDEDST       = :WDEDST
     C+             ,  FDEFST       = :WDEFST
     C+             ,  FDEHST       = :WDEHST
     C+             ,  FDEMST       = :WDEMST
     C+             ,  FDENST       = :WDENST
     C+             ,  FDEOST       = :WDEOST
     C+             ,  FDEPST       = :WDEPST
     C+             ,  FDEQST       = :WDEQST
     C+             ,  FDOQNY       = :WDOQNY
     C+             ,  FDORNY       = :WDORNY
     C+             ,  FDS2DT       = :WDS2DT
     C+             ,  FDUFT1       = :WDUFT1
     C+             ,  FDKUAA       = :WDKUAA
     C+             ,  FDVSST       = :WDVSST
     C+             ,  FDMJDT       = :WDMJDT
     C+             ,  FDBETM       = :WDBETM
     C+             ,  FDCCVN       = :WDCCVN
     C+             ,  FDCDVN       = :WDCDVN
     C+             ,  FDMKDT       = :WDMKDT
     C+             ,  FDBFTM       = :WDBFTM
     C+             ,  FDCEVN       = :WDCEVN
     C+             ,  FDCFVN       = :WDCFVN
     C+       WHERE ( FDAIC3       = :WDAIC3     AND
     C+               FDHGCD       = :WDHGCD    )
     C/END-EXEC
     C           SQLCOD    IFNE 0
     C                     SETON                       91  *91=ERR
     C                     ELSE
     C                     SETOF                       91  *91=ERR
     C                     END
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt Company Item Ext  CR - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FDREAO
     C                     Z-ADDWBAIC3    WDAIC3           Company Number
     C                     Z-ADD#1HGCD    WDHGCD           Item Code
     C                     MOVELWN0022    WDD0ST           Produce on Sund
     C                     MOVELWN0023    WDD2ST           Produce on Mond
     C                     MOVELWN0024    WDD6ST           Produce on Tues
     C                     MOVELWN0025    WDWESP           Produce on Wedn
     C                     MOVELWN0026    WDEDST           Produce on Thur
     C                     MOVELWN0027    WDEFST           Produce on Frid
     C                     MOVELWN0028    WDEHST           Produce on Satu
     C                     MOVELWN0029    WDEMST           Plan Production
     C                     MOVELWN0030    WDENST           Allocation Meth
     C                     MOVEL#CEOST    WDEOST           Adjust Credit P
     C                     MOVELWN0031    WDEPST           CIE Use Age Day
     C                     MOVELWN0032    WDEQST           CIE MPR Report
     C                     Z-ADDWN0033    WDOQNY           CIE Unused Numb
     C                     Z-ADDWN0034    WDORNY           CIE Unused Numb
     C                     Z-ADDWN0035    WDS2DT           CIE Unused Date
     C                     MOVELWN0036    WDUFT1           CIE TPM Equipme
     C                     MOVELWN0037    WDKUAA           CIE Capacity Co
     C                     MOVELWN0038    WDVSST           Record Status
     C                     Z-ADDWN0039    WDMJDT           Create Date
     C                     Z-ADDWN0040    WDBETM           Create Time
     C                     MOVELWN0041    WDCCVN           Create User
     C                     MOVELWN0042    WDCDVN           Create Program
     C                     Z-ADDWN0043    WDMKDT           Change Date
     C                     Z-ADDWN0044    WDBFTM           Change Time
     C                     MOVELWN0045    WDCEVN           Change User
     C                     MOVELWN0046    WDCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WDVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WDMJDT           Create Date
     C                     Z-ADD##JTM     WDBETM           Create Time
     C                     MOVEL##USR     WDCCVN           Create User
     C                     MOVEL##PGM     WDCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
     C                     MOVEL*BLANK    WDCEVN           Change User
     C                     MOVEL*BLANK    WDCFVN           Change Program
     C/EXEC SQL
     C+     INSERT  INTO PMFDREP
     C+       VALUES( :WDAIC3
     C+             , :WDHGCD
     C+             , :WDD0ST
     C+             , :WDD2ST
     C+             , :WDD6ST
     C+             , :WDWESP
     C+             , :WDEDST
     C+             , :WDEFST
     C+             , :WDEHST
     C+             , :WDEMST
     C+             , :WDENST
     C+             , :WDEOST
     C+             , :WDEPST
     C+             , :WDEQST
     C+             , :WDOQNY
     C+             , :WDORNY
     C+             , :WDS2DT
     C+             , :WDUFT1
     C+             , :WDKUAA
     C+             , :WDVSST
     C+             , :WDMJDT
     C+             , :WDBETM
     C+             , :WDCCVN
     C+             , :WDCDVN
     C+             , :WDMKDT
     C+             , :WDBFTM
     C+             , :WDCEVN
     C+             , :WDCFVN
     C+             )
     C/END-EXEC
     C           SQLCOD    IFNE 0
     C                     SETON                       91  *91=ERR
     C                     ELSE
     C                     SETOF                       91  *91=ERR
     C                     END
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Box Item code      RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0047  1        Package Type Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0098           Component Item
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQST01           Company Number
     C           *LIKE     DEFN WCHGCD    WQST02           Item Code
      * Setup key
     C                     Z-ADDWL0096    WCAIC3           Company Number
     C                     Z-ADDWL0097    WCHGCD           Item Code
      * Establish starting position
     C                     MOVEL'Y'       STSQLX  1
     C/EXEC SQL
     C+     DECLARE PDIOREL1XCSR     CURSOR FOR
     C+       SELECT * FROM PDIOREP
     C+           WHERE (IOAIC3       =  :WCAIC3
     C+           AND    IOHGCD       =  :WCHGCD
     C+                 )
     C+       ORDER BY  IOAIC3        ASC,
     C+                 IOHGCD        ASC,
     C+                 IOC9NB        ASC
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN PDIOREL1XCSR
     C/END-EXEC
     C           SQLCOD    IFEQ -502
     C/EXEC SQL
     C+   CLOSE PDIOREL1XCSR
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN PDIOREL1XCSR
     C/END-EXEC
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     ENDIF
     C                     ENDIF
     C/EXEC SQL
     C+   FETCH PDIOREL1XCSR
     C+     INTO :QPDIO2
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Item Type/Pack Cd  RT - Company Item  * 
     C                     EXSR SURVGN
      * CASE: PAR.Package Type Code is Box
     C           WN0047    IFEQ 'B'                        *IF
     C                     Z-ADDWCC9NB    WL0098           Component Item
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C/EXEC SQL
     C+   FETCH PDIOREL1XCSR
     C+     INTO :QPDIO2
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C                     ENDDO
     C           STEXIT    TAG
     C           STSQLX    IFEQ 'Y'
     C/EXEC SQL
     C+   CLOSE PDIOREL1XCSR
     C/END-EXEC
     C                     MOVEL*BLANK    STSQLX
     C                     ENDIF
      *================================================================
     CSR                   ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Item Type/Pack Cd  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADDWCAIC3    WBAIC3           Company Number
     C                     Z-ADDWCC9NB    WBHGCD           Item Code
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QCABZ3
     C+       FROM  CABZREP
     C+       WHERE ( BZAIC3       = :WBAIC3     AND
     C+               BZHGCD       = :WBHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WN0047           Package Type Co
     C                     Z-ADD*ZERO     WUSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WUA3WG           Misc Tare Weigh
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBN0CD    WUN0CD           Item Type Code
     C                     MOVELWBX4ST    WN0047           Package Type Co
     C                     Z-ADDWBSFNB    WUSFNB           Pallet Tare Wei
     C                     Z-ADDWBA3WG    WUA3WG           Misc Tare Weigh
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSV01           Application Cod
      * Setup key
     C                     MOVE *BLANK    DNDNCD           Application Cod
     C                     MOVEL'C/S'     DNDNCD           Application Cod
      * Establish starting position
     C                     MOVEL'Y'       SVSQLX  1
     C/EXEC SQL
     C+     DECLARE CADNREL2XCSR     CURSOR FOR
     C+       SELECT * FROM CADNREP
     C+           WHERE (DNDNCD     =  :DNDNCD
     C+                 )
     C+       ORDER BY  DNDNCD        ASC
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN CADNREL2XCSR
     C/END-EXEC
     C           SQLCOD    IFEQ -502
     C/EXEC SQL
     C+   CLOSE CADNREL2XCSR
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN CADNREL2XCSR
     C/END-EXEC
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     ENDIF
     C                     ENDIF
     C/EXEC SQL
     C+   FETCH CADNREL2XCSR
     C+     INTO :QCADN1
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     C/EXEC SQL
     C+   FETCH CADNREL2XCSR
     C+     INTO :QCADN1
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C                     ENDDO
     C           SVEXIT    TAG
     C           SVSQLX    IFEQ 'Y'
     C/EXEC SQL
     C+   CLOSE CADNREL2XCSR
     C/END-EXEC
     C                     MOVEL*BLANK    SVSQLX
     C                     ENDIF
      *================================================================
     CSR                   ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSW01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    DNDNCD           Application Cod
      * Establish starting position
     C                     MOVEL'Y'       SWSQLX  1
     C/EXEC SQL
     C+     DECLARE CADNREL2YCSR     CURSOR FOR
     C+       SELECT * FROM CADNREP
     C+           WHERE (DNDNCD     =  :DNDNCD
     C+                 )
     C+       ORDER BY  DNDNCD        ASC
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN CADNREL2YCSR
     C/END-EXEC
     C           SQLCOD    IFEQ -502
     C/EXEC SQL
     C+   CLOSE CADNREL2YCSR
     C/END-EXEC
     C/EXEC SQL
     C+   OPEN CADNREL2YCSR
     C/END-EXEC
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     ENDIF
     C                     ENDIF
     C/EXEC SQL
     C+   FETCH CADNREL2YCSR
     C+     INTO :QCADN1
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C/EXEC SQL
     C+   FETCH CADNREL2YCSR
     C+     INTO :QCADN1
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C                     ENDDO
     C           SWEXIT    TAG
     C           SWSQLX    IFEQ 'Y'
     C/EXEC SQL
     C+   CLOSE CADNREL2YCSR
     C/END-EXEC
     C                     MOVEL*BLANK    SWSQLX
     C                     ENDIF
      *================================================================
     CSR                   ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADDP2AIC3    KMAIC3           Company Number
     C                     MOVEL@CN,007   KMV8CD           Company Value C
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QPDKM1
     C+       FROM  PDKMREP
     C+       WHERE ( KMAIC3       = :KMAIC3     AND
     C+               KMV8CD       = :KMV8CD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    P8DEC3           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Setup key
     C                     Z-ADDP2AIC3    KMAIC3           Company Number
     C                     MOVEL@CN,008   KMV8CD           Company Value C
      * Establish starting position
     C/EXEC SQL
     C+     SELECT * INTO :QPDKM1
     C+       FROM  PDKMREP
     C+       WHERE ( KMAIC3       = :KMAIC3     AND
     C+               KMV8CD       = :KMV8CD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 100
     C                     SETON                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETOF                       90  *
     C                     END
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    P7ELSC           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1HGCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
      * Field '(CTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #1HGCD' defaulted for 'Item Code'.
     C                     CALL 'PDCCSRR'              90  Zzz Item Number
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0001  30       Company Number
     C           #1HGCD    PARM *ZERO     WQ0002  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ADCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1ADCD'
      * Field '(CTL) #1ADCD' defaulted for 'UOM Primary'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1ADCD    PARM #1ADCD    WQ0003  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ADCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ADCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VBEXIT
     C                     END
      *
      * Setup key
     C                     MOVEL#1ADCD    AMHHCD
     C/EXEC SQL
     C+     SELECT * INTO :QCAAM1
     C+       FROM  CAAMREP
     C+       WHERE ( AMHHCD       = :AMHHCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AECD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1AECD'
      * Field '(CTL) #1AECD' defaulted for 'UOM Second'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AECD    PARM #1AECD    WQ0004  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AECD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VCEXIT
     C                     END
      *
      * Setup key
     C                     MOVEL#1AECD    AMHHCD
     C/EXEC SQL
     C+     SELECT * INTO :QCAAM1
     C+       FROM  CAAMREP
     C+       WHERE ( AMHHCD       = :AMHHCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AFCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1AFCD'
      * Field '(CTL) #1AFCD' defaulted for 'UOM Third'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AFCD    PARM #1AFCD    WQ0005  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AFCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AFCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VDEXIT
     C                     END
      *
      * Setup key
     C                     MOVEL#1AFCD    AMHHCD
     C/EXEC SQL
     C+     SELECT * INTO :QCAAM1
     C+       FROM  CAAMREP
     C+       WHERE ( AMHHCD       = :AMHHCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AICD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1AICD'
      * Field '(CTL) #1AICD' defaulted for 'UOM Pricing'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AICD    PARM #1AICD    WQ0006  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AICD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AICD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VEEXIT
     C                     END
      *
      * Setup key
     C                     MOVEL#1AICD    AMHHCD
     C/EXEC SQL
     C+     SELECT * INTO :QCAAM1
     C+       FROM  CAAMREP
     C+       WHERE ( AMHHCD       = :AMHHCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1HICD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1HICD'
      * Field '(CTL) #1VSST' defaulted for 'Record Status'.
     C                     CALL 'PDHJSRR'              90  Zzz Rcd Sts-Act
     C                     PARM *BLANK    W0RTN   7
     C           #1VSST    PARM #1VSST    WQ0007  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HICD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HICD    IFEQ *BLANK                     Quality Level
     C                     GOTO VFEXIT
     C                     END
      *
      * Setup key
     C                     MOVEL#1HICD    AIHICD
     C/EXEC SQL
     C+     SELECT * INTO :QCAAI1
     C+       FROM  CAAIREP
     C+       WHERE ( AIHICD       = :AIHICD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Item Level Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Item Level
     C           YPMTFD    OREQ '#1RBCD'
      * Field '(CTL) #1RBCD' defaulted for 'Item Level'.
     C                     CALL 'PDBPSRR'              90  SEL PD Item Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1RBCD    PARM #1RBCD    WQ0008  2        Item Level
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RBCD    IFNE *BLANK                     Item Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RBCD    IFEQ *BLANK                     Item Level
     C                     GOTO VGEXIT
     C                     END
      *
      * Setup key
     C                     MOVEL#1RBCD    ILRBCD
     C/EXEC SQL
     C+     SELECT * INTO :QPDIL1
     C+       FROM  PDILREP
     C+       WHERE ( ILRBCD       = :ILRBCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Item Level Codes       NF'
     C                     MOVEL'USR1673' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1673' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Vendor Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1AJC8'
      * Field '(CTL) #1AJC8' defaulted for 'Vendor Item Default'.
     C                     CALL 'PDE2SRR'              90  SEL Vendor Acti
     C                     PARM *BLANK    W0RTN   7
     C           #1AJC8    PARM #1AJC8    WQ0009  80       Vendor item Def
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AJC8    IFNE *ZERO                      Vendor item Def
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJC8    IFEQ *ZERO                      Vendor item Def
     C                     GOTO VHEXIT
     C                     END
      *
      * Setup key
     C                     Z-ADD#1AJC8    BJACC8
     C/EXEC SQL
     C+     SELECT * INTO :QCABJ1
     C+       FROM  CABJREP
     C+       WHERE ( BJACC8       = :BJACC8    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Vendor Master          NF'
     C                     MOVEL'USR0213' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0213' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Class
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RINB'
      * Field '(CTL) #1RINB' defaulted for 'Item Structure Class Code'.
     C                     CALL 'PDELSRR'              90  SEL Item Class
     C                     PARM *BLANK    W0RTN   7
     C           #1RINB    PARM #1RINB    WQ0010  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDELSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RINB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RINB    IFEQ *ZERO                      Item Structure
     C                     GOTO VIEXIT
     C                     END
      *
      * Setup key
     C                     Z-ADD#1RINB    FARINB
     C/EXEC SQL
     C+     SELECT * INTO :QOMFA1
     C+       FROM  OMFAREP
     C+       WHERE ( FARINB       = :FARINB    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Item Structure Class   NF'
     C                     MOVEL'USR1170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1170' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RHNB'
      * Field '(CTL) #1RHNB' defaulted for 'Item Structure Group Code'.
     C                     CALL 'PDEMSRR'              90  SEL Item Group
     C                     PARM *BLANK    W0RTN   7
     C           #1RHNB    PARM #1RHNB    WQ0011  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RHNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RHNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VJEXIT
     C                     END
      *
      * Setup key
     C                     Z-ADD#1RHNB    E9RHNB
     C/EXEC SQL
     C+     SELECT * INTO :QOME91
     C+       FROM  OME9REP
     C+       WHERE ( E9RHNB       = :E9RHNB    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Item Structure Group   NF'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1168' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RGNB'
      * Field '(CTL) #1RGNB' defaulted for 'Item Structure Type Code'.
     C                     CALL 'PDENSRR'              90  SEL Item Type A
     C                     PARM *BLANK    W0RTN   7
     C           #1RGNB    PARM #1RGNB    WQ0012  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDENSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RGNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VKEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RGNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VKEXIT
     C                     END
      *
      * Setup key
     C                     Z-ADD#1RGNB    E8RGNB
     C/EXEC SQL
     C+     SELECT * INTO :QOME81
     C+       FROM  OME8REP
     C+       WHERE ( E8RGNB       = :E8RGNB    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Item Structure Type    NF'
     C                     MOVEL'USR1166' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1166' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Commodity Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Commodity Price
     C           YPMTFD    OREQ '#1LRCD'
      * Field '(CTL) #1LRCD' defaulted for 'Commodity Price Group'.
     C                     CALL 'PDECSRR'              90  SEL Commod Grp
     C                     PARM *BLANK    W0RTN   7
     C           #1LRCD    PARM #1LRCD    WQ0013  7        Commodity Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDECSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1LRCD    IFNE *BLANK                     Commodity Price
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VLEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LRCD    IFEQ *BLANK                     Commodity Price
     C                     GOTO VLEXIT
     C                     END
      *
      * Setup key
     C                     MOVEL#1LRCD    FZLRCD
     C/EXEC SQL
     C+     SELECT * INTO :QOMFZ1
     C+       FROM  OMFZREL0
     C+       WHERE ( FZLRCD       = :FZLRCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Commodity Group        NF'
     C                     MOVEL'USR1220' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1220' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Warehouse Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q1CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1Q1CD'
      * Field '(CTL) #1Q1CD' defaulted for 'Default Warehouse'.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1Q1CD    PARM #1Q1CD    WQ0014  3        Warehouse Code
     C                     PARM *ZERO     WQ0015  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1Q1CD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q1CD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VMEXIT
     C                     END
      *
      * Setup key
     C                     MOVEL#1Q1CD    ADAJCD
     C/EXEC SQL
     C+     SELECT * INTO :QCAAD1
     C+       FROM  CAADREP
     C+       WHERE ( ADAJCD       = :ADAJCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to Price Method Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q8CD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Price Method Co
     C           YPMTFD    OREQ '#1Q8CD'
      * Field '(CTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #1Q8CD' defaulted for 'Price Method Default'.
     C                     CALL 'PDZDSRR'              90  SEL PD Price Me
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0016  30       Company Number
     C           #1Q8CD    PARM #1Q8CD    WQ0017  3        Price Method Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1Q8CD    IFNE *BLANK                     Price Method Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q8CD    IFEQ *BLANK                     Price Method Co
     C                     GOTO VNEXIT
     C                     END
      *
      * Setup key
     C                     Z-ADD#1AIC3    IHAIC3
     C                     MOVEL#1Q8CD    IHQ7CD
     C/EXEC SQL
     C+     SELECT * INTO :QPDIH1
     C+       FROM  PDIHREL0
     C+       WHERE ( IHAIC3       = :IHAIC3     AND
     C+               IHQ7CD       = :IHQ7CD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'Price Method Header    NF'
     C                     MOVEL'USR1665' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1665' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to PS Production Department
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R3CD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Department Code
     C           YPMTFD    OREQ '#1R3CD'
      * Field '(CTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #1R3CD' defaulted for 'Department Code'.
     C                     CALL 'PDCXSRR'              90  Sel Prod. Depar
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0018  30       Company Number
     C           #1R3CD    PARM #1R3CD    WQ0019  6        Department Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCXSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1R3CD    IFNE *BLANK                     Department Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VOEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R3CD    IFEQ *BLANK                     Department Code
     C                     GOTO VOEXIT
     C                     END
      *
      * Setup key
     C                     Z-ADD#1AIC3    I5AIC3
     C                     MOVEL#1R3CD    I5R3CD
     C/EXEC SQL
     C+     SELECT * INTO :QPDI51
     C+       FROM  PDI5REP
     C+       WHERE ( I5AIC3       = :I5AIC3     AND
     C+               I5R3CD       = :I5R3CD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VOEXIT
     C                     END
      * Send message 'PS Production Departme NF'
     C                     MOVEL'USR1757' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1757' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to Item Category Packaging
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1SDCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Group for Packa
     C           YPMTFD    OREQ '#1SDCD'
      * Field '(CTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #1SDCD' defaulted for 'Group for Packaging'.
     C                     CALL 'PDHPSRR'              90  Sel Item Avl Di
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0020  30       Company Number
     C           #1SDCD    PARM #1SDCD    WQ0021  1        Group for Packa
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1SDCD    IFNE *BLANK                     Group for Packa
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VPEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1SDCD    IFEQ *BLANK                     Group for Packa
     C                     GOTO VPEXIT
     C                     END
      *
      * Setup key
     C                     Z-ADD#1AIC3    JGAIC3
     C                     MOVEL#1SDCD    JGSDCD
     C/EXEC SQL
     C+     SELECT * INTO :QPDJG1
     C+       FROM  PDJGREP
     C+       WHERE ( JGAIC3       = :JGAIC3     AND
     C+               JGSDCD       = :JGSDCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VPEXIT
     C                     END
      * Send message 'Item Category Packagin NF'
     C                     MOVEL'USR1830' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1830' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to PM R/M Type Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B4NB    IFEQ *ZERO                      PM Raw Material
     C                     GOTO VQEXIT
     C                     END
      *
      * Setup key
     C                     Z-ADD#1B4NB    G1B4NB
     C/EXEC SQL
     C+     SELECT * INTO :QPMG11
     C+       FROM  PMG1REP
     C+       WHERE ( G1B4NB       = :G1B4NB    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VQEXIT
     C                     END
      * Send message 'PM R/M Type Master     NF'
     C                     MOVEL'USR1454' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1454' W0RTN
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to PM Line Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B5NB    IFEQ *ZERO                      PM Line Number
     C                     GOTO VREXIT
     C                     END
      *
      * Setup key
     C                     Z-ADD#1AIC3    G2AIC3
     C                     Z-ADD#1B5NB    G2B5NB
     C/EXEC SQL
     C+     SELECT * INTO :QPMG21
     C+       FROM  PMG2REP
     C+       WHERE ( G2AIC3       = :G2AIC3     AND
     C+               G2B5NB       = :G2B5NB    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VREXIT
     C                     END
      * Send message 'PM Line Master         NF'
     C                     MOVEL'USR1456' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1456' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to PS Primal Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1XRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Primal Group Co
     C           YPMTFD    OREQ '#1XRCD'
      * Field '(CTL) #1XRCD' defaulted for 'Primal Group Code'.
     C                     CALL 'PDAFSRR'              90  Sel PS Primal G
     C                     PARM *BLANK    W0RTN   7
     C           #1XRCD    PARM #1XRCD    WQ0022  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1XRCD    IFNE *BLANK                     Primal Group Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VSEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1XRCD    IFEQ *BLANK                     Primal Group Co
     C                     GOTO VSEXIT
     C                     END
      *
      * Setup key
     C                     MOVEL#1XRCD    LLXRCD
     C/EXEC SQL
     C+     SELECT * INTO :QPDLL1
     C+       FROM  PDLLREP
     C+       WHERE ( LLXRCD       = :LLXRCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VSEXIT
     C                     END
      * Send message 'PS Primal Group        NF'
     C                     MOVEL'USR2505' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2505' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         VTCKRL    BEGSR
      *================================================================
      * Check reference to Company Item
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV2C9NB    WK1X02  1
     C           WK1X02    IFEQ '?'                        Item Code
     C           YPMTFD    OREQ '#2C9NB'
     C           ##RR      ANDEQYPMRRN
      * Field '(RCD) #2AIC3' defaulted for 'Company Number'.
      * Field '(RCD) #2C9NB' defaulted for 'Component Item Code'.
     C                     CALL 'CAOSSRR'              90  Sel Item
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0025  30       Company Number
     C           #2C9NB    PARM #2C9NB    WQ0026  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAOSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9833  *
     C                     END
      *
     C           #2C9NB    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VTEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #2C9NB    IFEQ *ZERO                      Item Code
     C                     GOTO VTEXIT
     C                     END
      *
      * Setup key
     C                     Z-ADD#2AIC3    WBAIC3
     C                     Z-ADD#2C9NB    WBHGCD
     C/EXEC SQL
     C+     SELECT * INTO :QCABZ3
     C+       FROM  CABZREP
     C+       WHERE ( BZAIC3       = :WBAIC3     AND
     C+               BZHGCD       = :WBHGCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VTEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VTEXIT
     C                     END
      * Send message 'Company Item           NF'
     C                     MOVEL'USR0326' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0326' W0RTN
      *================================================================
     CSR         VTEXIT    ENDSR
      /EJECT
     CSR         VUCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#2HHCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#2HHCD'
     C           ##RR      ANDEQYPMRRN
      * Field '(RCD) #2HHCD' defaulted for 'UOM Primary Dft'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #2HHCD    PARM #2HHCD    WQ0027  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9844  *
     C                     END
      *
     C           #2HHCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VUEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #2HHCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VUEXIT
     C                     END
      *
      * Setup key
     C                     MOVEL#2HHCD    AMHHCD
     C/EXEC SQL
     C+     SELECT * INTO :QCAAM1
     C+       FROM  CAAMREP
     C+       WHERE ( AMHHCD       = :AMHHCD    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VUEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VUEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VUEXIT    ENDSR
      /EJECT
     CSR         VVCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
      * Field '(RCD) #2AIC3' defaulted for 'Company Number'.
     C                     CALL 'PDL7SRR'              90  SEL Co - Rtn 0
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0028  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VV999
     C                     END
     C                     END
      *................................................................
      *
      * Setup key
     C                     Z-ADD#1AIC3    ABAIC3
     C/EXEC SQL
     C+     SELECT * INTO :QCAAB1
     C+       FROM  CAABREP
     C+       WHERE ( ABAIC3       = :ABAIC3    )
     C/END-EXEC
     C           SQLCOD    IFEQ 0
     C                     SETOF                       90  *90=No Rcd
     C                     ELSE
     C           SQLCOD    IFLT 0
     C                     EXSR ZWEXPG                     STOP RUN
     C                     END
     C                     SETON                       90  *
     C                     END
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VVEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VVEXIT
     C                     END
     C           VV999     TAG
      * Restrictor relation not satisfied
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VVEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 02560
     C           ZINPOS    ANDLE06144
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  10        W0CSRR  50
     C           02560     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD10        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDEQ094
     C           @#DFMT    ANDEQ'#SFLCTL'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#CEOST'  YPMTFD           Adjust Credit P
     C                     END
      *
     C           ZHF4RW    IFEQ 010
     C           ZHCSCL    ANDGE004
     C           ZHCSCL    ANDLE010
     C           *IN77     ANDEQ'0'
     C           *IN82     ANDNE'1'
     C                     MOVEL'#2C9NB'  YPMTFD           Component Item
     C                     END
      *
     C           ZHF4RW    IFEQ 010
     C           ZHCSCL    ANDEQ043
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#2V2ST'  YPMTFD           BOM Type
     C                     END
      *
     C           ZHF4RW    IFEQ 010
     C           ZHCSCL    ANDGE063
     C           ZHCSCL    ANDLE064
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#2RTST'  YPMTFD           BOM Group Prod
     C                     END
      *
     C           ZHF4RW    IFEQ 010
     C           ZHCSCL    ANDEQ087
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#2RSST'  YPMTFD           BOM Multi RM Op
     C                     END
      *
     C           ZHF4RW    IFEQ 010
     C           ZHCSCL    ANDGE125
     C           ZHCSCL    ANDLE126
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#2HHCD'  YPMTFD           UOM Primary Dft
     C                     END
      *
     C           ZHF4RW    IFEQ 010
     C           ZHCSCL    ANDEQ130
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#2VSST'  YPMTFD           Record Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZWEXPG    BEGSR
      *================================================================
      * Derive SQL error message & send
      *================================================================
      *
     C           SQLCOD    IFLT 0
     C                     Z-SUBSQLCOD    YRWH             *Synon (5,0) wo
     C                     ELSE
     C                     Z-ADDSQLCOD    YRWH             *Synon (5,0) wo
     C                     ENDIF
      *
      * Form message id.
     C                     MOVE YRWH      ZAMSID
     C                     MOVELYRWH      YRWI             *Synon (1,0) wo
      *
     C           YRWI      IFGT 0
     C                     MOVEL'SQ'      ZAMSID
     C                     ELSE
     C                     MOVEL'SQL'     ZAMSID
     C                     ENDIF
      *
     C                     MOVELZAMSID    P0RTN
     C                     MOVELSQLERM    ZAMSDA
     C                     MOVE *BLANK    ZAMSGF
     C                     MOVEL'QSQLMSG' ZAMSGF
      *
     C                     EXSR ZASNMS
      *
      * If no error handling provided, exit.
     C           W0RTN     IFNE 'NOEXIT'
     C                     MOVELP0RTN     W0RTN
     C                     EXSR ZXEXPG
     C                     ENDIF
      *
      *================================================================
     CSR         ZWEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * RTV Box Item code      RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0096           Company Number
     C                     Z-ADD#1HGCD    WL0097           Item Code
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0098    WUB6C7           Component Item
      * CASE: PAR.Item Code USR NE WRK.Item Code USR
     C           P4B6C7    IFNE WUB6C7                     *IF
     C                     Z-ADDWUB6C7    P4B6C7           Item Code USR
      * If Box ID is Invalid, then flag to write delete item rcd to carli
      * CASE: WRK.Item Code USR is Not Entered
     C           WUB6C7    IFEQ *ZERO                      *IF
     C                     MOVEL'D'       P5Y5ST           AS Add/Change/D
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'A'       P5Y5ST           AS Add/Change/D
     C                     END                             *FI
      * PFS One Prod/Box Rec  XF - Company Item  * 
     C                     CALL 'PDK1XFR'              90  PFS One Prod/Bo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0029  30       Company Number
     C                     PARM #1HGCD    WQ0030  70       Item Code
     C                     PARM #1AVNA    WQ0031 30        Description Lin
     C                     PARM #1L7NA    WQ0032 32        Item Label Line
     C                     PARM #1L8NA    WQ0033 32        Item Label Line
     C                     PARM #1L6NA    WQ0034 32        Item Label Line
     C                     PARM #1AIWG    WQ0035 112       Unit Weight
     C                     PARM #1AVST    WQ0036  1        Catch Weight St
     C                     PARM #1CZWG    WQ0037 112       Minimum Weight
     C                     PARM #1C0WG    WQ0038 112       Maximum Weight
     C                     PARM #1URTN    WQ0039  50       Number Cases On
     C                     PARM #1N0CD    WQ0040  3        Item Type Code
     C                     PARM #1X4ST    WQ0041  1        Package Type Co
     C                     PARM #1Q1CD    WQ0042  3        Default Warehou
     C                     PARM #1CHTM    WQ0043  52       Fresh Chilling
     C                     PARM #1A3WG    WQ0044  52       Misc Tare Weigh
     C                     PARM P5Y5ST    WQ0045  1        AS Add/Change/D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDK1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1GGST           USR Display fie
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2C9NB           Component Item
     C                     MOVEL*BLANK    P2V2ST           BOM Type
     C                     MOVEL*BLANK    P2VSST           Record Status
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3ECST           Error Status
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4B6C7           Item Code USR
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5ASPD           AS Product Code
     C                     MOVEL*BLANK    P5IDTX           AS Product Desc
     C                     MOVEL*BLANK    P5IETX           AS Product Desc
     C                     MOVEL*BLANK    P5I7TX           AS Product Desc
     C                     MOVEL*BLANK    P5ASMC           AS Manufacturer
     C                     MOVEL*BLANK    P5EJWG           AS Nominal Weig
     C                     MOVEL*BLANK    P5EKWG           AS Hi Weight Li
     C                     MOVEL*BLANK    P5ELWG           AS Lo Weight Li
     C                     MOVEL*BLANK    P5ASBX           AS Box ID
     C                     MOVEL*BLANK    P5ASTW           AS Misc Tare We
     C                     MOVEL*BLANK    P5ASPQ           AS Pallet Quant
     C                     MOVEL*BLANK    P5UYCD           AS Warehouse ID
     C                     MOVEL*BLANK    P5Y5ST           AS Add/Change/D
     C                     MOVEL*BLANK    P5TVCD           AS Carriage Ret
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7ELSC           Edt SlsYld,Pump
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P8DEC3           Sync with Compa
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field UOM Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field UOM Second
     C                     MOVEL*BLANK    WUAECD  2
      * Define work field UOM Third
     C                     MOVEL*BLANK    WUAFCD  2
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Package Type Code
     C                     MOVEL*BLANK    WUX4ST  1
      * Define work field Pallet Tare Weight
     C                     Z-ADD*ZERO     WUSFNB  52
      * Define work field Misc Tare Weight
     C                     Z-ADD*ZERO     WUA3WG  52
      * Define work field USR number
     C                     Z-ADD*ZERO     WUJGNB  60
      * Define work field Plant Company Sts
     C                     MOVEL*BLANK    WUYISX  1
      * Clear all neither parameters
      * CRT Item BOM           CR - Item Bill Of Material  * 
     C                     Z-ADD*ZERO     IOAATM           Job Time
     C                     Z-ADD*ZERO     IOAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Item Code USR
     C                     Z-ADD*ZERO     WUB6C7  70
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0TRN   1        *Continue trans
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
     C                     Z-ADD*ZEROS    YRWH    50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRWI    10       *Synon (1,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005  2
     C                     MOVEL*BLANK    WL0006  2
     C                     MOVEL*BLANK    WL0007  2
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SIINFN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015  52
     C                     Z-ADD*ZERO     WL0016  52
     C                     Z-ADD*ZERO     WL0017 112
     C                     MOVEL*BLANK    WL0018  2
     C                     MOVEL*BLANK    WL0019  1
     C                     Z-ADD*ZERO     WL0020  50
     C                     Z-ADD*ZERO     WL0021  52
     C                     Z-ADD*ZERO     WL0022  52
     C                     Z-ADD*ZERO     WL0023 112
     C                     Z-ADD*ZERO     WL0024 112
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  2
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  3
     C                     MOVEL*BLANK    WL0032  1
     C                     Z-ADD*ZERO     WL0033  30
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0034  30
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037  1
     C                     Z-ADD*ZERO     WL0038  52
     C                     Z-ADD*ZERO     WL0039  52
     C                     Z-ADD*ZERO     WL0040 112
     C                     MOVEL*BLANK    WL0041  2
     C                     MOVEL*BLANK    WL0042  1
     C                     Z-ADD*ZERO     WL0043  50
     C                     Z-ADD*ZERO     WL0044  52
     C                     Z-ADD*ZERO     WL0045  52
     C                     Z-ADD*ZERO     WL0046 112
     C                     Z-ADD*ZERO     WL0047 112
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  2
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  3
     C                     Z-ADD*ZERO     WL0052  30
      * Define local variables for subroutine SMCRRC.
     C                     Z-ADD*ZERO     WL0053  30
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  70
     C                     MOVEL*BLANK    WL0056  1
     C                     Z-ADD*ZERO     WL0057  52
     C                     Z-ADD*ZERO     WL0058  52
     C                     Z-ADD*ZERO     WL0059 112
     C                     MOVEL*BLANK    WL0060  2
     C                     MOVEL*BLANK    WL0061  1
     C                     Z-ADD*ZERO     WL0062  50
     C                     Z-ADD*ZERO     WL0063  52
     C                     Z-ADD*ZERO     WL0064  52
     C                     Z-ADD*ZERO     WL0065 112
     C                     Z-ADD*ZERO     WL0066 112
     C                     MOVEL*BLANK    WL0067  1
     C                     MOVEL*BLANK    WL0068  2
     C                     MOVEL*BLANK    WL0069  1
     C                     MOVEL*BLANK    WL0070  1
     C                     MOVEL*BLANK    WL0071  1
     C                     MOVEL*BLANK    WL0072  1
      * Define local variables for subroutine SNDLRC.
     C                     Z-ADD*ZERO     WL0073  30
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  70
      * Define local variables for subroutine SOCHRC.
     C                     Z-ADD*ZERO     WL0076  30
     C                     Z-ADD*ZERO     WL0077  70
     C                     Z-ADD*ZERO     WL0078  70
     C                     MOVEL*BLANK    WL0079  1
     C                     Z-ADD*ZERO     WL0080  52
     C                     Z-ADD*ZERO     WL0081  52
     C                     Z-ADD*ZERO     WL0082 112
     C                     MOVEL*BLANK    WL0083  2
     C                     MOVEL*BLANK    WL0084  1
     C                     Z-ADD*ZERO     WL0085  50
     C                     Z-ADD*ZERO     WL0086  52
     C                     Z-ADD*ZERO     WL0087  52
     C                     Z-ADD*ZERO     WL0088 112
     C                     Z-ADD*ZERO     WL0089 112
     C                     MOVEL*BLANK    WL0090  1
     C                     MOVEL*BLANK    WL0091  2
     C                     MOVEL*BLANK    WL0092  1
     C                     MOVEL*BLANK    WL0093  1
     C                     MOVEL*BLANK    WL0094  1
     C                     MOVEL*BLANK    WL0095  1
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0096  30
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098  70
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Consume Priority Percent
     C                     Z-ADD*ZERO     YL0002  52
      * Define local work field Consume Pty % Sum
     C                     Z-ADD*ZERO     YL0003  72
      * Define local work field Consume Priority
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field Company Number Alpha
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0006 80
      * Define local work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Upd Standard Production
     C                     MOVEL*BLANK    YL0008  1
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Subfile page size
     C                     Z-ADD14        ##SFPG  30       SFLPAG
      * Initialise subfile positioner
     C                     Z-ADD1         ##SFRC
      *
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SVRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'N'       P1GGST           USR Display fie
      * RTV Box Item code      RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0096           Company Number
     C                     Z-ADD#1HGCD    WL0097           Item Code
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0098    P4B6C7           Component Item
      * R9547 DN 03/13/17-Cmp Allow to Edit/Sync SalesYield, Meat$Consmd%
      * CASE: *OTHERWISE
      * Sync will occur for Sales Yield, Meat Cost Consumed %, & Pumped %
      * if 'Sync with Company USR' is populated.
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SXRVGN
      * Allow Sales Yield, Meat Cost Consumed %, & Pumped % input capable
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SYRVGN
      *****************************************************************
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
00795010380105101060011180112201538
02562025640257202603026060261402623
02630026330263902647026500266402671
0268502690
** W0END
00809010400105701089011180114601667
02562025700260002603026120262002624
02630026370264402647026620266902683
0268602690
** W0NAM
#CM8NA    V1AIC3    V1HGCD    #1AVNA    #CEOST    #CGUTX    #2ST1
#2SEL     V2C9NB    #RCJTX    #2V2ST    #2BOPR    #2BPPR    #2RTST
#2YAST    #2CNSM    #2BMY1    #2RSST    #2IXQT    #2BMY2    #2HGQT
#2HHCD    #2VSST
** @CN
00001 ** Meat BOM **
00002 ** Supplies **
00003 USR0752
00004 Delete pending. Confirm Y
00005 or N. After delete, check
00006  Company
00007 BOMGROUPU1
00008 BOMGROUPE1
