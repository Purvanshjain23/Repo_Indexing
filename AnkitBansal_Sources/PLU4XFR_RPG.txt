     H/TITLE CRT/CHG Eval UplErp   XP  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISSMASO
     H* Date          : 08/27/14  Time  : 16:04:51
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPLBUCPL1IF  E           K        DISK
      * RTV : Eval Trans UPL ERP        Retrieval index
      *
     FPLBUCPL0UF  E           K        DISK                      A
      * UPD : Eval Trans UPL ERP        Update index
      *
     I@BUCPS2
      * Eval Trans UPL ERP        Retrieval index
      * Renamed input format fields
     I              BUVDA1                          WAVDA1
     I              BUG1DT                          WAG1DT
     I              BUVEA1                          WAVEA1
     I              BUVFA1                          WAVFA1
     I              BUVGA1                          WAVGA1
     I              BUF9SS                          WAF9SS
     I              BUVHA1                          WAVHA1
     I              BUISPC                          WAISPC
     I              BUITPC                          WAITPC
     I              BUP3CD                          WAP3CD
     I              BUGASS                          WAGASS
     I              BUGBSS                          WAGBSS
     I              BUGCSS                          WAGCSS
     I              BUGDSS                          WAGDSS
     I              BUGESS                          WAGESS
     I              BUGFSS                          WAGFSS
     I              BUB8DT                          WAB8DT
     I              BUAOTM                          WAAOTM
     I              BUZCTX                          WAZCTX
     I              BUZDTX                          WAZDTX
     I              BUVCA1                          WAVCA1
     I              BUP6CD                          WAP6CD
     I              BUP7CD                          WAP7CD
     I              BUG2DT                          WAG2DT
     I              BUG3DT                          WAG3DT
     I              BUVYA1                          WAVYA1
     I              BUQGCD                          WAQGCD
     I              BUACDX                          WAACDX
     I              BUAAVN                          WAAAVN
     I              BUAADT                          WAAADT
     I              BUAMTM                          WAAMTM
     I              BUAJST                          WAAJST
     I              BUAHVN                          WAAHVN
     I              BUAGVN                          WAAGVN
     I              BUABVN                          WAABVN
     I              BUABDT                          WAABDT
     I              BUABTM                          WAABTM
      *
     I@BUCPS1
      * Eval Trans UPL ERP        Update index
      * Renamed input format fields
     I              BUVDA1                          WBVDA1
     I              BUG1DT                          WBG1DT
     I              BUVEA1                          WBVEA1
     I              BUVFA1                          WBVFA1
     I              BUVGA1                          WBVGA1
     I              BUF9SS                          WBF9SS
     I              BUVHA1                          WBVHA1
     I              BUISPC                          WBISPC
     I              BUITPC                          WBITPC
     I              BUP3CD                          WBP3CD
     I              BUGASS                          WBGASS
     I              BUGBSS                          WBGBSS
     I              BUGCSS                          WBGCSS
     I              BUGDSS                          WBGDSS
     I              BUGESS                          WBGESS
     I              BUGFSS                          WBGFSS
     I              BUB8DT                          WBB8DT
     I              BUAOTM                          WBAOTM
     I              BUZCTX                          WBZCTX
     I              BUZDTX                          WBZDTX
     I              BUVCA1                          WBVCA1
     I              BUP6CD                          WBP6CD
     I              BUP7CD                          WBP7CD
     I              BUG2DT                          WBG2DT
     I              BUG3DT                          WBG3DT
     I              BUVYA1                          WBVYA1
     I              BUQGCD                          WBQGCD
     I              BUACDX                          WBACDX
     I              BUAAVN                          WBAAVN
     I              BUAADT                          WBAADT
     I              BUAMTM                          WBAMTM
     I              BUAJST                          WBAJST
     I              BUAHVN                          WBAHVN
     I              BUAGVN                          WBAGVN
     I              BUABVN                          WBABVN
     I              BUABDT                          WBABDT
     I              BUABTM                          WBABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPLBU1    E DSPLBUCPL0
      * UPD : Eval Trans UPL ERP        Update index
      * Renamed input format fields
     I              BUVDA1                          WBVDA1
     I              BUG1DT                          WBG1DT
     I              BUVEA1                          WBVEA1
     I              BUVFA1                          WBVFA1
     I              BUVGA1                          WBVGA1
     I              BUF9SS                          WBF9SS
     I              BUVHA1                          WBVHA1
     I              BUISPC                          WBISPC
     I              BUITPC                          WBITPC
     I              BUP3CD                          WBP3CD
     I              BUGASS                          WBGASS
     I              BUGBSS                          WBGBSS
     I              BUGCSS                          WBGCSS
     I              BUGDSS                          WBGDSS
     I              BUGESS                          WBGESS
     I              BUGFSS                          WBGFSS
     I              BUB8DT                          WBB8DT
     I              BUAOTM                          WBAOTM
     I              BUZCTX                          WBZCTX
     I              BUZDTX                          WBZDTX
     I              BUVCA1                          WBVCA1
     I              BUP6CD                          WBP6CD
     I              BUP7CD                          WBP7CD
     I              BUG2DT                          WBG2DT
     I              BUG3DT                          WBG3DT
     I              BUVYA1                          WBVYA1
     I              BUQGCD                          WBQGCD
     I              BUACDX                          WBACDX
     I              BUAAVN                          WBAAVN
     I              BUAADT                          WBAADT
     I              BUAMTM                          WBAMTM
     I              BUAJST                          WBAJST
     I              BUAHVN                          WBAHVN
     I              BUAGVN                          WBAGVN
     I              BUABVN                          WBABVN
     I              BUABDT                          WBABDT
     I              BUABTM                          WBABTM
      *
     IYARDCS      DS                            176
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Eval Trans UPL ERP
      * I :  ER Company Number
     I                                    P   1   20P1VDA1
      * I :  ER Kill Date
     I                                    P   3   60P1G1DT
      * I :  ER Scale Sequence Number
     I                                    P   7  100P1VEA1
      * I :  ER Tattoo Number
     I                                    P  11  130P1VFA1
      * I :  ER Hot Weight
     I                                    P  14  161P1VGA1
      * I :  ER Record Processed
     I                                       17  17 P1F9SS
      * I :  ER Backfat MM
     I                                    P  18  191P1VHA1
      * I :  ER LoinEye MM
     I                                    P  20  211P1ISPC
      * I :  ER Light Refl MM
     I                                    P  22  231P1ITPC
      * I :  ER Trolley Id
     I                                       24  29 P1P3CD
      * I :  ER Broken Back Sts
     I                                       30  30 P1GASS
      * I :  ER Unused Sts 1
     I                                       31  31 P1GBSS
      * I :  ER Unused Sts 2
     I                                       32  32 P1GCSS
      * I :  ER Unused Sts 3
     I                                       33  33 P1GDSS
      * I :  ER Unused Sts 4
     I                                       34  34 P1GESS
      * I :  ER Unused Sts 5
     I                                       35  35 P1GFSS
      * I :  RU Date
     I                                    P  36  390P1B8DT
      * I :  RU Time
     I                                    P  40  430P1AOTM
      * I :  ER Sp Producer/Text
     I                                       44  58 P1ZCTX
      * I :  ER HOTRGS Description
     I                                       59  88 P1ZDTX
      * I :  ER HOTRGS WGT Group
     I                                    P  89  910P1VCA1
      * I :  ER Producer Code
     I                                       92  97 P1P6CD
      * I :  ER Producer Location
     I                                       98 103 P1P7CD
      * I :  ER Period From
     I                                    P 104 1070P1G2DT
      * I :  ER Period To
     I                                    P 108 1110P1G3DT
      * I :  ER Week
     I                                    P 112 1130P1VYA1
      * I :  ER Process
     I                                      114 1140P1QGCD
      * I :  ER Kill Date long
     I                                    P 115 1190P1ACDX
      * I :  RS User Changed
     I                                      120 129 P1AAVN
      * I :  RS Date Changed
     I                                    P 130 1330P1AADT
      * I :  RS Time Changed
     I                                    P 134 1370P1AMTM
      * I :  RS Record Status
     I                                      138 138 P1AJST
      * I :  RS Job
     I                                      139 148 P1AHVN
      * I :  RS Program
     I                                      149 158 P1AGVN
      * I :  RS User Added
     I                                      159 168 P1ABVN
      * I :  RS Date Added
     I                                    P 169 1720P1ABDT
      * I :  RS Time Added
     I                                    P 173 1760P1ABTM
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1VDA1    PARM           WP0001  30       ER Company Numb
     C           P1G1DT    PARM           WP0002  70       ER Kill Date
     C           P1VEA1    PARM           WP0003  60       ER Scale Sequen
     C           P1VFA1    PARM           WP0004  50       ER Tattoo Numbe
     C           P1VGA1    PARM           WP0005  51       ER Hot Weight
     C           P1F9SS    PARM           WP0006  1        ER Record Proce
     C           P1VHA1    PARM           WP0007  31       ER Backfat MM
     C           P1ISPC    PARM           WP0008  31       ER LoinEye MM
     C           P1ITPC    PARM           WP0009  31       ER Light Refl M
     C           P1P3CD    PARM           WP0010  6        ER Trolley Id
     C           P1GASS    PARM           WP0011  1        ER Broken Back
     C           P1GBSS    PARM           WP0012  1        ER Unused Sts 1
     C           P1GCSS    PARM           WP0013  1        ER Unused Sts 2
     C           P1GDSS    PARM           WP0014  1        ER Unused Sts 3
     C           P1GESS    PARM           WP0015  1        ER Unused Sts 4
     C           P1GFSS    PARM           WP0016  1        ER Unused Sts 5
     C           P1B8DT    PARM           WP0017  70       RU Date
     C           P1AOTM    PARM           WP0018  60       RU Time
     C           P1ZCTX    PARM           WP0019 15        ER Sp Producer/
     C           P1ZDTX    PARM           WP0020 30        ER HOTRGS Descr
     C           P1VCA1    PARM           WP0021  50       ER HOTRGS WGT G
     C           P1P6CD    PARM           WP0022  6        ER Producer Cod
     C           P1P7CD    PARM           WP0023  6        ER Producer Loc
     C           P1G2DT    PARM           WP0024  70       ER Period From
     C           P1G3DT    PARM           WP0025  70       ER Period To
     C           P1VYA1    PARM           WP0026  20       ER Week
     C           P1QGCD    PARM           WP0027  10       ER Process
     C           P1ACDX    PARM           WP0028  80       ER Kill Date lo
     C           P1AAVN    PARM           WP0029 10        RS User Changed
     C           P1AADT    PARM           WP0030  70       RS Date Changed
     C           P1AMTM    PARM           WP0031  60       RS Time Changed
     C           P1AJST    PARM           WP0032  1        RS Record Statu
     C           P1AHVN    PARM           WP0033 10        RS Job
     C           P1AGVN    PARM           WP0034 10        RS Program
     C           P1ABVN    PARM           WP0035 10        RS User Added
     C           P1ABDT    PARM           WP0036  70       RS Date Added
     C           P1ABTM    PARM           WP0037  60       RS Time Added
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CRT/CHG Eval UplErp   XP
      * CRT/CHG Eval UplErp   RT - Eval Trans UPL ERP  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * CRT/CHG Eval UplErp   RT - Eval Trans UPL ERP  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAVDA1           ER Company Numb
     C                     KFLD           WAG1DT           ER Kill Date
     C                     KFLD           WAVEA1           ER Scale Sequen
      * Setup key
     C                     Z-ADDP1VDA1    WAVDA1           ER Company Numb
     C                     Z-ADDP1G1DT    WAG1DT           ER Kill Date
     C                     Z-ADDP1VEA1    WAVEA1           ER Scale Sequen
      * Establish starting position
     C           KRSSA     CHAIN@BUCPS2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1303' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Eval Trans UPL ERPCR - Eval Trans UPL ERP  * 
     C                     EXSR SBCRRC
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Eval Trans UPL ERPCH - Eval Trans UPL ERP  * 
     C                     EXSR SCCHRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt Eval Trans UPL ERPCR - Eval Trans UPL ERP  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BUCPS1
     C                     Z-ADDP1VDA1    WBVDA1           ER Company Numb
     C                     Z-ADDP1G1DT    WBG1DT           ER Kill Date
     C                     Z-ADDP1VEA1    WBVEA1           ER Scale Sequen
     C                     Z-ADDP1VFA1    WBVFA1           ER Tattoo Numbe
     C                     Z-ADDP1VGA1    WBVGA1           ER Hot Weight
     C                     MOVELP1F9SS    WBF9SS           ER Record Proce
     C                     Z-ADDP1VHA1    WBVHA1           ER Backfat MM
     C                     Z-ADDP1ISPC    WBISPC           ER LoinEye MM
     C                     Z-ADDP1ITPC    WBITPC           ER Light Refl M
     C                     MOVELP1P3CD    WBP3CD           ER Trolley Id
     C                     MOVELP1GASS    WBGASS           ER Broken Back
     C                     MOVELP1GBSS    WBGBSS           ER Unused Sts 1
     C                     MOVELP1GCSS    WBGCSS           ER Unused Sts 2
     C                     MOVELP1GDSS    WBGDSS           ER Unused Sts 3
     C                     MOVELP1GESS    WBGESS           ER Unused Sts 4
     C                     MOVELP1GFSS    WBGFSS           ER Unused Sts 5
     C                     Z-ADDP1B8DT    WBB8DT           RU Date
     C                     Z-ADDP1AOTM    WBAOTM           RU Time
     C                     MOVELP1ZCTX    WBZCTX           ER Sp Producer/
     C                     MOVELP1ZDTX    WBZDTX           ER HOTRGS Descr
     C                     Z-ADDP1VCA1    WBVCA1           ER HOTRGS WGT G
     C                     MOVELP1P6CD    WBP6CD           ER Producer Cod
     C                     MOVELP1P7CD    WBP7CD           ER Producer Loc
     C                     Z-ADDP1G2DT    WBG2DT           ER Period From
     C                     Z-ADDP1G3DT    WBG3DT           ER Period To
     C                     Z-ADDP1VYA1    WBVYA1           ER Week
     C                     Z-ADDP1QGCD    WBQGCD           ER Process
     C                     Z-ADDP1ACDX    WBACDX           ER Kill Date lo
     C                     MOVELYL0001    WBAAVN           RS User Changed
     C                     Z-ADDYL0002    WBAADT           RS Date Changed
     C                     Z-ADDYL0003    WBAMTM           RS Time Changed
     C                     MOVELYL0004    WBAJST           RS Record Statu
     C                     MOVELYL0005    WBAHVN           RS Job
     C                     MOVELYL0006    WBAGVN           RS Program
     C                     MOVELYL0007    WBABVN           RS User Added
     C                     Z-ADDYL0008    WBABDT           RS Date Added
     C                     Z-ADDYL0009    WBABTM           RS Time Added
      *
     C           KLCRSB    KLIST
     C                     KFLD           WBVDA1           ER Company Numb
     C                     KFLD           WBG1DT           ER Kill Date
     C                     KFLD           WBVEA1           ER Scale Sequen
      * Check for duplicate primary key
     C           KLCRSB    SETLL@BUCPS1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1304' W0RTN   7
      * Send message 'Eval Trans UPL ERP     EX'
     C                     MOVEL'PRK1304' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@BUCPS1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Eval Trans UPL ERPCH - Eval Trans UPL ERP  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 10        RS User Changed
     C                     Z-ADD*ZERO     WN0002  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0003  60       RS Time Changed
     C                     MOVEL*BLANK    WN0004  1        RS Record Statu
     C                     MOVEL*BLANK    WN0005 10        RS Job
     C                     MOVEL*BLANK    WN0006 10        RS Program
     C                     MOVEL*BLANK    WN0007 10        RS User Added
     C                     Z-ADD*ZERO     WN0008  70       RS Date Added
     C                     Z-ADD*ZERO     WN0009  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BUCPS1
     C                     Z-ADDWAVDA1    WBVDA1           ER Company Numb
     C                     Z-ADDWAG1DT    WBG1DT           ER Kill Date
     C                     Z-ADDWAVEA1    WBVEA1           ER Scale Sequen
      *
     C           KLCHSC    KLIST
     C                     KFLD           WBVDA1           ER Company Numb
     C                     KFLD           WBG1DT           ER Kill Date
     C                     KFLD           WBVEA1           ER Scale Sequen
     C           KLCHSC    CHAIN@BUCPS1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLBUCPL0'MDACP
     C                     MOVEL'@BUCPS1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLBU1    YARDCS
      * Move non-key fields to @BUCPS1
     C                     Z-ADDP1VFA1    WBVFA1           ER Tattoo Numbe
     C                     Z-ADDP1VGA1    WBVGA1           ER Hot Weight
     C                     MOVELP1F9SS    WBF9SS    P      ER Record Proce
     C                     Z-ADDP1VHA1    WBVHA1           ER Backfat MM
     C                     Z-ADDP1ISPC    WBISPC           ER LoinEye MM
     C                     Z-ADDP1ITPC    WBITPC           ER Light Refl M
     C                     MOVELP1P3CD    WBP3CD    P      ER Trolley Id
     C                     MOVELP1GASS    WBGASS    P      ER Broken Back
     C                     MOVELP1GBSS    WBGBSS    P      ER Unused Sts 1
     C                     MOVELP1GCSS    WBGCSS    P      ER Unused Sts 2
     C                     MOVELP1GDSS    WBGDSS    P      ER Unused Sts 3
     C                     MOVELP1GESS    WBGESS    P      ER Unused Sts 4
     C                     MOVELP1GFSS    WBGFSS    P      ER Unused Sts 5
     C                     Z-ADDP1B8DT    WBB8DT           RU Date
     C                     Z-ADDP1AOTM    WBAOTM           RU Time
     C                     MOVELP1ZCTX    WBZCTX    P      ER Sp Producer/
     C                     MOVELP1ZDTX    WBZDTX    P      ER HOTRGS Descr
     C                     Z-ADDP1VCA1    WBVCA1           ER HOTRGS WGT G
     C                     MOVELP1P6CD    WBP6CD    P      ER Producer Cod
     C                     MOVELP1P7CD    WBP7CD    P      ER Producer Loc
     C                     Z-ADDP1G2DT    WBG2DT           ER Period From
     C                     Z-ADDP1G3DT    WBG3DT           ER Period To
     C                     Z-ADDP1VYA1    WBVYA1           ER Week
     C                     Z-ADD0         WBQGCD           ER Process
     C                     Z-ADDP1ACDX    WBACDX           ER Kill Date lo
      *
      * Set PGM.*Record Data Changed flag
     C           QPLBU1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BUCPS1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLBUCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAVDA1           ER Company Numb
     C                     Z-ADD*ZERO     WAG1DT           ER Kill Date
     C                     Z-ADD*ZERO     WAVEA1           ER Scale Sequen
     C                     Z-ADD*ZERO     WAVFA1           ER Tattoo Numbe
     C                     Z-ADD*ZERO     WAVGA1           ER Hot Weight
     C                     Z-ADD*ZERO     WAVHA1           ER Backfat MM
     C                     Z-ADD*ZERO     WAISPC           ER LoinEye MM
     C                     Z-ADD*ZERO     WAITPC           ER Light Refl M
     C                     Z-ADD*ZERO     WAB8DT           RU Date
     C                     Z-ADD*ZERO     WAAOTM           RU Time
     C                     Z-ADD*ZERO     WAVCA1           ER HOTRGS WGT G
     C                     Z-ADD*ZERO     WAG2DT           ER Period From
     C                     Z-ADD*ZERO     WAG3DT           ER Period To
     C                     Z-ADD*ZERO     WAVYA1           ER Week
     C                     Z-ADD*ZERO     WAQGCD           ER Process
     C                     Z-ADD*ZERO     WAACDX           ER Kill Date lo
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      * Define local work field RS User Changed
     C                     MOVEL*BLANK    YL0001 10
      * Define local work field RS Date Changed
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field RS Time Changed
     C                     Z-ADD*ZERO     YL0003  60
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field RS Job
     C                     MOVEL*BLANK    YL0005 10
      * Define local work field RS Program
     C                     MOVEL*BLANK    YL0006 10
      * Define local work field RS User Added
     C                     MOVEL*BLANK    YL0007 10
      * Define local work field RS Date Added
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field RS Time Added
     C                     Z-ADD*ZERO     YL0009  60
      *================================================================
     CSR         ZZEXIT    ENDSR
