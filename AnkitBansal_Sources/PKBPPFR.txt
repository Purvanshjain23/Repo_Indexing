     H/TITLE PRT TATTOO HDR/SCL/TD     Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : COOL:2E  Version: 62050
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISPPATE
     H* Date          : 11/01/99  Time  : 17:05:26
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKB3CPL1IF  E           K        DISK
      * RTV : Tattoo Scale Ticket       Retrieval index
      *
     FPKA2CPL1IF  E           K        DISK
      * RTV : Tattoo Detail             Retrieval index
      *
     FPKBPPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT TATTOO HDR/SCL/TD     Print file
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             15
      * KEY: Tattoo Header             Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   50P1BNNB
      * I : RST BOL Load Number
     I                                    P   6   80P1BONB
      * I : RST TH Tattoo Number
     I                                    P   9  110P1CVNB
      * I : MAP TH Kill Date
     I                                    P  12  150P1B0DT
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Tattoo Hea
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT TATTOO HDR/SCL/TD: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE#NENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT TATTOO HDR/SCL/TD: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKA01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQKA02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQKA03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQKA04           TH Tattoo Numbe
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
     C                     KFLD           WQKA02           BOH Buy Order N
     C                     KFLD           WQKA03           BOL Load Number
     C                     KFLD           WQKA04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQKA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQKA03           BOL Load Number
     C                     Z-ADDP1CVNB    WQKA04           TH Tattoo Numbe
      * Establish starting position
     C           KRSA      SETLL@A1CPC4                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0AL02  1        BOL Load Number
     C                     MOVEL'Y'       W0AL03  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $DHMNB           BOH Company Num
      * Load related totals format
     C                     Z-ADDA1HMNB    #LHMNB           BOH Company Num
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $EHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $EBNNB           BOH Buy Order N
      * Load related totals format
     C                     Z-ADDA1HMNB    #KHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    #KBNNB           BOH Buy Order N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $FHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $FBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $FBONB           BOL Load Number
      * Load related totals format
     C                     Z-ADDA1HMNB    #JHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    #JBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    #JBONB           BOL Load Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $GHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $GBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $GBONB           BOL Load Number
     C                     Z-ADDA1CVNB    $GCVNB           TH Tattoo Numbe
      * Load related totals format
     C                     Z-ADDA1HMNB    #IHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    #IBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    #IBONB           BOL Load Number
     C                     Z-ADDA1CVNB    #ICVNB           TH Tattoo Numbe
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA1HMNB    $HHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $HBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $HBONB           BOL Load Number
     C                     Z-ADDA1CVNB    $HCVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    $HB0DT           TH Kill Date
     C                     Z-ADDA1AWDT    $HAWDT           TH Purchase Dat
     C                     MOVELA1BICD    $HBICD           TH Tattoo Refer
     C                     MOVELA1CPST    $HCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $HACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    $HB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $HCAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    $HC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $HAIPR           TH Resale Price
     C                     Z-ADDA1A6DT    $HA6DT           TH Pricing Date
     C                     MOVELA1C2ST    $HC2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    $HCXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    $HCWNB           TH Head Receive
     C                     Z-ADDA1CYNB    $HCYNB           TH Live Wgt
     C                     Z-ADDA1F7NB    $HF7NB           TH Avg Live Wgt
     C                     Z-ADDA1FCNB    $HFCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    $HH9NB           TH Held Over
     C                     Z-ADDA1FDNB    $HFDNB           TH Head Condemn
     C                     Z-ADDA1FENB    $HFENB           TH Head Killed
     C                     Z-ADDA1HENB    $HHENB           TH Head Adds
     C                     Z-ADDA1HFNB    $HHFNB           TH Head Analyze
     C                     Z-ADDA1LRNB    $HLRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    $HE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    $HA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $HFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $HA4PC           TH Tot Light Re
     C                     Z-ADDA1HDNB    $HHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    $HF5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    $HF4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    $HF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    $HF2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    $HAVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    $HAWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    $HCWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    $HA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $HA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    $HB8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    $HAMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    $HANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    $HAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    $HAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    $HAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    $HAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    $HAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    $HASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    $HA4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    $HATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    $HA5VA           TH Additions Am
     C                     Z-ADDA1CBPR    $HCBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    $HCCPR           Th Payment Net
     C                     Z-ADDA1LPNB    $HLPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $HCDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $HA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    $HA2PR           TH Actual Value
     C                     MOVELA1JWST    $HJWST           TH Calc Net Sts
     C                     MOVELA1CWST    $HCWST           TH Payment Sts
     C                     MOVELA1D7ST    $HD7ST           TH Header Error
     C                     MOVELA1D8ST    $HD8ST           TH Detail Error
     C                     MOVELA1DWST    $HDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $HD6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $HGHNB           TH Commission A
     C                     Z-ADDA1BYDT    $HBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $HE0ST           TH User Error O
     C                     MOVELA1E1ST    $HE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $HE2ST           TH Sex
     C                     Z-ADDA1BSDT    $HBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $HBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $HBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    $HHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $HHHNB           TH Unused Wgt 2
     C                     Z-ADDA1HINB    $HHINB           TH FFLI
     C                     Z-ADDA1A3PR    $HA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $HA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $HA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    $HJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    $HD6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $HD7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $HD8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $HD9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $HEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $HEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $HECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $HEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $HEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $HEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $HEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $HEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $HKAST           TH Source Type
     C                     MOVELA1J7ST    $HJ7ST           TH Scale Ticket
     C                     MOVELA1J9ST    $HJ9ST           TH Payment Type
     C                     Z-ADDA1OXNB    $HOXNB           TH Movement Ref
     C                     MOVELA1LKST    $HLKST           TH Source Code
     C                     MOVELA1LLST    $HLLST           TH Hog Class Ty
     C                     MOVELA1J8ST    $HJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $HLIST           TH Schedule Kil
     C                     MOVELA1LJST    $HLJST           TH Shift Held O
     C                     MOVELA1NZTX    $HNZTX           TH State
     C                     MOVELA1HJCD    $HHJCD           TH Unused Code
     C                     MOVELA1R4ST    $HR4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    $HR5ST           TH Commission S
     C                     MOVELA1R6ST    $HR6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    $HR7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    $HTHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    $HT2WT           TH Unused Weigh
     C                     Z-ADDA1THHD    $HTHHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    $HT2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    $HOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    $HKOER           TH Head Identif
     C                     Z-ADDA1OPIR    $HOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    $HOPEM           TH Percent Anal
     C                     Z-ADDA1IORP    $HIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    $HOWEO           TH PHA Head Add
     C                     MOVELA1OQET    $HOQET           TH PHA Add Type
     C                     MOVELA1URST    $HURST           TH PHA Average
     C                     MOVELA1USST    $HUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    $HHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $HS9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    $HTAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    $HTBPR           TH Head Exclude
     C                     Z-ADDA1JFUR    $HJFUR           TH Unused Nbr 1
     C                     Z-ADDA1KRIF    $HKRIF           TH Unused Nbr 2
     C                     Z-ADDA1KORF    $HKORF           TH Unused Nbr 3
     C                     Z-ADDA1KAPR    $HKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    $HKROT           TH Unsued Nbr 5
     C                     Z-ADDA1OTJG    $HOTJG           TH Unused Nbr 6
     C                     Z-ADDA1IRJG    $HIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    $HIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    $HIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    $HKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    $HOJRF           TH Unused Nbr 1
     C                     Z-ADDA1KFOR    $HKFOR           TH Unsued Nbr 1
     C                     Z-ADDA1ORJK    $HORJK           TH Unused Nbr 1
     C                     Z-ADDA1OMVJ    $HOMVJ           TH Unused Nbr 1
     C                     Z-ADDA1MVNF    $HMVNF           TH Unused Nbr 1
     C                     Z-ADDA1MCNF    $HMCNF           TH Unused Nbr 1
     C                     Z-ADDA1NCNF    $HNCNF           TH Unsued Nbr 1
     C                     Z-ADDA1NCHF    $HNCHF           TH Unused Nbr 1
     C                     Z-ADDA1IGIR    $HIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    $HKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    $HEADT           TH Unused Date
     C                     Z-ADDA1EBDT    $HEBDT           TH Unused Date
     C                     Z-ADDA1ECDT    $HECDT           TH Unused Date
     C                     Z-ADDA1EDDT    $HEDDT           TH Unused Date
     C                     Z-ADDA1EEDT    $HEEDT           TH Unused Date
     C                     MOVELA1U4ST    $HU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    $HU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    $HU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    $HU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    $HU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    $HU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    $HVAST           TH Unused Sts 7
     C                     MOVELA1VBST    $HVBST           TH Unused Sts 8
     C                     MOVELA1AGCD    $HAGCD           GN Genetic Code
     C                     MOVELA1BECD    $HBECD           HC Class Code
     C                     MOVELA1BDCD    $HBDCD           DF Defect Code
     C                     MOVELA1CSCD    $HCSCD           THP Process Cod
     C                     MOVELA1ABCD    $HABCD           PD Producer Cod
     C                     MOVELA1AECD    $HAECD           PL Location Cod
     C                     MOVELA1ACCD    $HACCD           HB Buyer Code
     C                     MOVELA1AAVN    $HAAVN           RS User Changed
     C                     Z-ADDA1AADT    $HAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $HAMTM           RS Time Changed
     C                     MOVELA1AJST    $HAJST           RS Record Statu
     C                     MOVELA1AHVN    $HAHVN           RS Job
     C                     MOVELA1AGVN    $HAGVN           RS Program
     C                     MOVELA1ABVN    $HABVN           RS User Added
     C                     Z-ADDA1ABDT    $HABDT           RS Date Added
     C                     Z-ADDA1ABTM    $HABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Tattoo Scl Tck
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Tattoo Detail Scl
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZA001           BOH Company Num
     C                     Z-ADDA1HMNB    WZA001
     C           *LIKE     DEFN A1BNNB    WZA002           BOH Buy Order N
     C                     Z-ADDA1BNNB    WZA002
     C           *LIKE     DEFN A1BONB    WZA003           BOL Load Number
     C                     Z-ADDA1BONB    WZA003
     C           *LIKE     DEFN A1CVNB    WZA004           TH Tattoo Numbe
     C                     Z-ADDA1CVNB    WZA004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@A1CPC4                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0AL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0AL03  1        TH Tattoo Numbe
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0AL02  1        BOL Load Number
     C                     MOVEL'Y'       W0AL03  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           A1BNNB    IFNE WZA002                     BOH Buy Order N
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           A1BONB    IFNE WZA003                     BOL Load Number
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           A1CVNB    IFNE WZA004                     TH Tattoo Numbe
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL03    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE#IKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE#JKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE#KKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE#LKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE#MFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Scl Tck    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN B3HMNB    WQKB01           BOH Company Num
     C           *LIKE     DEFN B3BNNB    WQKB02           BOH Buy Order N
     C           *LIKE     DEFN B3BONB    WQKB03           BOL Load Number
     C           *LIKE     DEFN B3CVNB    WQKB04           TH Tattoo Numbe
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           BOH Buy Order N
     C                     KFLD           WQKB03           BOL Load Number
     C                     KFLD           WQKB04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#IHMNB    WQKB01           BOH Company Num
     C                     Z-ADD#IBNNB    WQKB02           BOH Buy Order N
     C                     Z-ADD#IBONB    WQKB03           BOL Load Number
     C                     Z-ADD#ICVNB    WQKB04           TH Tattoo Numbe
      * Establish starting position
     C           KRSB      SETLL@B3CPHL                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDB3HMNB    $JHMNB           BOH Company Num
      * Load related totals format
     C                     Z-ADDB3HMNB    $THMNB           BOH Company Num
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDB3HMNB    $KHMNB           BOH Company Num
     C                     Z-ADDB3BNNB    $KBNNB           BOH Buy Order N
      * Load related totals format
     C                     Z-ADDB3HMNB    $SHMNB           BOH Company Num
     C                     Z-ADDB3BNNB    $SBNNB           BOH Buy Order N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDB3HMNB    $LHMNB           BOH Company Num
     C                     Z-ADDB3BNNB    $LBNNB           BOH Buy Order N
     C                     Z-ADDB3BONB    $LBONB           BOL Load Number
      * Load related totals format
     C                     Z-ADDB3HMNB    $RHMNB           BOH Company Num
     C                     Z-ADDB3BNNB    $RBNNB           BOH Buy Order N
     C                     Z-ADDB3BONB    $RBONB           BOL Load Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDB3HMNB    $MHMNB           BOH Company Num
     C                     Z-ADDB3BNNB    $MBNNB           BOH Buy Order N
     C                     Z-ADDB3BONB    $MBONB           BOL Load Number
     C                     Z-ADDB3CVNB    $MCVNB           TH Tattoo Numbe
      * Load related totals format
     C                     Z-ADDB3HMNB    $QHMNB           BOH Company Num
     C                     Z-ADDB3BNNB    $QBNNB           BOH Buy Order N
     C                     Z-ADDB3BONB    $QBONB           BOL Load Number
     C                     Z-ADDB3CVNB    $QCVNB           TH Tattoo Numbe
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDB3HMNB    $NHMNB           BOH Company Num
     C                     Z-ADDB3BNNB    $NBNNB           BOH Buy Order N
     C                     Z-ADDB3BONB    $NBONB           BOL Load Number
     C                     Z-ADDB3CVNB    $NCVNB           TH Tattoo Numbe
     C                     Z-ADDB3B0DT    $NB0DT           TH Kill Date
      * Load related totals format
     C                     Z-ADDB3HMNB    $PHMNB           BOH Company Num
     C                     Z-ADDB3BNNB    $PBNNB           BOH Buy Order N
     C                     Z-ADDB3BONB    $PBONB           BOL Load Number
     C                     Z-ADDB3CVNB    $PCVNB           TH Tattoo Numbe
     C                     Z-ADDB3B0DT    $PB0DT           TH Kill Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDB3HMNB    $OHMNB           BOH Company Num
     C                     Z-ADDB3BNNB    $OBNNB           BOH Buy Order N
     C                     Z-ADDB3BONB    $OBONB           BOL Load Number
     C                     Z-ADDB3CVNB    $OCVNB           TH Tattoo Numbe
     C                     Z-ADDB3B0DT    $OB0DT           TH Kill Date
     C                     Z-ADDB3FKNB    $OFKNB           TST Sequence Nu
     C                     Z-ADDB3FMNB    $OFMNB           TST Head
     C                     Z-ADDB3FLNB    $OFLNB           TST Wgt
     C                     Z-ADDB3B6DT    $OB6DT           TST Wgt Date
     C                     Z-ADDB3ANTM    $OANTM           TST Wgt Time
     C                     Z-ADDB3CFDT    $OCFDT           TST Last Zero D
     C                     Z-ADDB3APTM    $OAPTM           TST Last Zero T
     C                     MOVELB3I3ST    $OI3ST           TST Record Crea
     C                     Z-ADDB3HVNB    $OHVNB           Pen Company Num
     C                     MOVELB3CMCD    $OCMCD           Pen Number
     C                     MOVELB3AAVN    $OAAVN           RS User Changed
     C                     Z-ADDB3AADT    $OAADT           RS Date Changed
     C                     Z-ADDB3AMTM    $OAMTM           RS Time Changed
     C                     MOVELB3AJST    $OAJST           RS Record Statu
     C                     MOVELB3AHVN    $OAHVN           RS Job
     C                     MOVELB3AGVN    $OAGVN           RS Program
     C                     MOVELB3ABVN    $OABVN           RS User Added
     C                     Z-ADDB3ABDT    $OABDT           RS Date Added
     C                     Z-ADDB3ABTM    $OABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN B3HMNB    WZB001           BOH Company Num
     C                     Z-ADDB3HMNB    WZB001
     C           *LIKE     DEFN B3BNNB    WZB002           BOH Buy Order N
     C                     Z-ADDB3BNNB    WZB002
     C           *LIKE     DEFN B3BONB    WZB003           BOL Load Number
     C                     Z-ADDB3BONB    WZB003
     C           *LIKE     DEFN B3CVNB    WZB004           TH Tattoo Numbe
     C                     Z-ADDB3CVNB    WZB004
     C           *LIKE     DEFN B3B0DT    WZB005           TH Kill Date
     C                     Z-ADDB3B0DT    WZB005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@B3CPHL                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0BL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0BL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0BL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0BL04  1        TH Kill Date
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           B3HMNB    IFNE WZB001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           B3BNNB    IFNE WZB002                     BOH Buy Order N
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           B3BONB    IFNE WZB003                     BOL Load Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           B3CVNB    IFNE WZB004                     TH Tattoo Numbe
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           B3B0DT    IFNE WZB005                     TH Kill Date
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL04    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$PKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$QKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$RKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$SKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$TKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$UFINTTL
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Detail Scl: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A2HMNB    WQKC01           BOH Company Num
     C           *LIKE     DEFN A2BNNB    WQKC02           BOH Buy Order N
     C           *LIKE     DEFN A2BONB    WQKC03           BOL Load Number
     C           *LIKE     DEFN A2CVNB    WQKC04           TH Tattoo Numbe
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           BOH Buy Order N
     C                     KFLD           WQKC03           BOL Load Number
     C                     KFLD           WQKC04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#IHMNB    WQKC01           BOH Company Num
     C                     Z-ADD#IBNNB    WQKC02           BOH Buy Order N
     C                     Z-ADD#IBONB    WQKC03           BOL Load Number
     C                     Z-ADD#ICVNB    WQKC04           TH Tattoo Numbe
      * Establish starting position
     C           KRSC      SETLL@A2CPDG                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0CL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA2HMNB    $WHMNB           BOH Company Num
      * Load related totals format
     C                     Z-ADDA2HMNB    #GHMNB           BOH Company Num
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA2HMNB    $XHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    $XBNNB           BOH Buy Order N
      * Load related totals format
     C                     Z-ADDA2HMNB    #FHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    #FBNNB           BOH Buy Order N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA2HMNB    $YHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    $YBNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    $YBONB           BOL Load Number
      * Load related totals format
     C                     Z-ADDA2HMNB    #EHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    #EBNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    #EBONB           BOL Load Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA2HMNB    $ZHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    $ZBNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    $ZBONB           BOL Load Number
     C                     Z-ADDA2CVNB    $ZCVNB           TH Tattoo Numbe
      * Load related totals format
     C                     Z-ADDA2HMNB    #DHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    #DBNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    #DBONB           BOL Load Number
     C                     Z-ADDA2CVNB    #DCVNB           TH Tattoo Numbe
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA2HMNB    #AHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    #ABNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    #ABONB           BOL Load Number
     C                     Z-ADDA2CVNB    #ACVNB           TH Tattoo Numbe
     C                     Z-ADDA2B0DT    #AB0DT           TH Kill Date
      * Load related totals format
     C                     Z-ADDA2HMNB    #CHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    #CBNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    #CBONB           BOL Load Number
     C                     Z-ADDA2CVNB    #CCVNB           TH Tattoo Numbe
     C                     Z-ADDA2B0DT    #CB0DT           TH Kill Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA2HMNB    #BHMNB           BOH Company Num
     C                     Z-ADDA2BNNB    #BBNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    #BBONB           BOL Load Number
     C                     Z-ADDA2CVNB    #BCVNB           TH Tattoo Numbe
     C                     Z-ADDA2B0DT    #BB0DT           TH Kill Date
     C                     Z-ADDA2C2NB    #BC2NB           TD Sequence Num
     C                     Z-ADDA2CZNB    #BCZNB           TD Live Wgt
     C                     Z-ADDA2C0NB    #BC0NB           TD Pen Head
     C                     Z-ADDA2D8NB    #BD8NB           TD Yard Dead
     C                     Z-ADDA2D7NB    #BD7NB           TD Avg Live Wgt
     C                     Z-ADDA2H7NB    #BH7NB           TD Held Over
     C                     MOVELA2GGST    #BGGST           TD Held Over St
     C                     Z-ADDA2AJTM    #BAJTM           TD Drive Time
     C                     Z-ADDA2B7CD    #BB7CD           TD Drive Card N
     C                     MOVELA2D9ST    #BD9ST           TD Gen Bal To K
     C                     MOVELA2E3ST    #BE3ST           TD User Status
     C                     MOVELA2E4ST    #BE4ST           TD User Status
     C                     MOVELA2E5ST    #BE5ST           TD User Status
     C                     Z-ADDA2BVDT    #BBVDT           TD User Date 1
     C                     Z-ADDA2BWDT    #BBWDT           TD User Date 2
     C                     Z-ADDA2BXDT    #BBXDT           TD Drive Date
     C                     Z-ADDA2HVNB    #BHVNB           Pen Company Num
     C                     MOVELA2CMCD    #BCMCD           Pen Number
     C                     MOVELA2B9CD    #BB9CD           TDP Process Cod
     C                     Z-ADDA2H8NB    #BH8NB           Held Over Pen C
     C                     MOVELA2CYCD    #BCYCD           Held Over Pen N
     C                     MOVELA2AAVN    #BAAVN           RS User Changed
     C                     Z-ADDA2AADT    #BAADT           RS Date Changed
     C                     Z-ADDA2AMTM    #BAMTM           RS Time Changed
     C                     MOVELA2AJST    #BAJST           RS Record Statu
     C                     MOVELA2AHVN    #BAHVN           RS Job
     C                     MOVELA2AGVN    #BAGVN           RS Program
     C                     MOVELA2ABVN    #BABVN           RS User Added
     C                     Z-ADDA2ABDT    #BABDT           RS Date Added
     C                     Z-ADDA2ABTM    #BABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A2HMNB    WZC001           BOH Company Num
     C                     Z-ADDA2HMNB    WZC001
     C           *LIKE     DEFN A2BNNB    WZC002           BOH Buy Order N
     C                     Z-ADDA2BNNB    WZC002
     C           *LIKE     DEFN A2BONB    WZC003           BOL Load Number
     C                     Z-ADDA2BONB    WZC003
     C           *LIKE     DEFN A2CVNB    WZC004           TH Tattoo Numbe
     C                     Z-ADDA2CVNB    WZC004
     C           *LIKE     DEFN A2B0DT    WZC005           TH Kill Date
     C                     Z-ADDA2B0DT    WZC005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@A2CPDG                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0CL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0CL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0CL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0CL04  1        TH Kill Date
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0CL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           A2HMNB    IFNE WZC001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           A2BNNB    IFNE WZC002                     BOH Buy Order N
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           A2BONB    IFNE WZC003                     BOL Load Number
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           A2CVNB    IFNE WZC004                     TH Tattoo Numbe
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           A2B0DT    IFNE WZC005                     TH Kill Date
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL04    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE#CKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE#DKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE#EKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE#FKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE#GKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE#HFINTTL
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT TATTOO HDR/SCL/TD
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT TATTOO HDR/SCL/TD
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of PRT TATTOO HDR/SCL/TD
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$DKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print BOH Buy Order Number of PRT TATTOO HDR/SCL/TD
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$EKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print BOL Load Number of PRT TATTOO HDR/SCL/TD
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$FKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print TH Tattoo Number of PRT TATTOO HDR/SCL/TD
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$GKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Detail line. of PRT TATTOO HDR/SCL/TD
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $HB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHB0DT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Scl Tck    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Print format
     C                     WRITE$I1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Scl Tck    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$JKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Scl Tck    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$KKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Scl Tck    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$LKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Scl Tck    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$MKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Scl Tck    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$NKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Scl Tck    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert TST Wgt Date to display format
      * Convert date
     C           1000000   ADD  $OB6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VOB6DT
      * Convert TST Last Zero Date to display format
      * Convert date
     C           1000000   ADD  $OCFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VOCFDT
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$OCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$ODTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Detail Scl
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Print format
     C                     WRITE$V1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Detail Scl
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$WKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Detail Scl
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$XKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Detail Scl
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$YKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Detail Scl
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$ZKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Detail Scl
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE#AKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Detail Scl
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Convert fields to external form
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE#BCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE#BDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C                     Z-ADD@$CLN     W0FSUM  30
     C                     Z-ADD*ZERO     W0DTLN  30
     C                     Z-ADD*ZERO     W0COLN  30
      * * First Page Format of PRT TATTOO HDR/SCL/TD
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of PRT TATTOO HDR/SCL/TD
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of PRT TATTOO HDR/SCL/TD
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of PRT TATTOO HDR/SCL/TD
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of PRT TATTOO HDR/SCL/TD
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT TATTOO HDR/SCL/TD
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Scl Tck    PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Scl Tck    PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Scl Tck    PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Scl Tck    PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Scl Tck    PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Scl Tck    PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Scl Tck    PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Detail Scl
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Detail Scl
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Detail Scl
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Detail Scl
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Detail Scl
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Detail Scl
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Detail Scl
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Scl Tck
      *================================================================
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(NXT) #IHMNB' defaulted for 'BOH Company Number'.
      * Field '(NXT) #IBNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(NXT) #IBONB' defaulted for 'BOL Load Number'.
      * Field '(NXT) #ICVNB' defaulted for 'TH Tattoo Number'.
      * Prt Tattoo Scl Tck    PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Detail Scl
      *================================================================
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(NXT) #IHMNB' defaulted for 'BOH Company Number'.
      * Field '(NXT) #IBNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(NXT) #IBONB' defaulted for 'BOL Load Number'.
      * Field '(NXT) #ICVNB' defaulted for 'TH Tattoo Number'.
      * Prt Tattoo Detail Scl: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1BNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    A1BONB           BOL Load Number
     C                     MOVEL*LOVAL    A1CVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    A1B0DT           TH Kill Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    B3HMNB           BOH Company Num
     C                     MOVEL*LOVAL    B3BNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    B3BONB           BOL Load Number
     C                     MOVEL*LOVAL    B3CVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    B3B0DT           TH Kill Date
     C                     MOVEL*LOVAL    B3FKNB           TST Sequence Nu
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A2HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A2BNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    A2BONB           BOL Load Number
     C                     MOVEL*LOVAL    A2CVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    A2B0DT           TH Kill Date
     C                     MOVEL*LOVAL    A2C2NB           TD Sequence Num
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
