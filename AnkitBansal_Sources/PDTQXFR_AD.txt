// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDTQXFR
// ?Date: 14.08.2025 Time: 03:36:06
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?This external function uses the sbdprtovr and open query functions
//?a little bit differently.  All CL's and PRTFIL's are called from
//?this external function, rather than from the CL's.  Doing the print
//?this way will allow the IS staff to find out where a particular
//?PRTFIL is used by using the 'Usage' (putting a 'U' before the function
//?in the Edit Functions or Display all Functions areas).
//?          John Tremper, October 6 1998
//?RMC 11/10/05 added Detail/Summary report type and ctl in CLP,
//?      new summary report is PPU2PFR
//?1.  Performing the Seaboard Print Override
DO;

// WRK.Nbr of Copies-Alpha   USR = PAR.PRT Number of Copies
WRK.Nbr_of_Copies_Alpha_USR = PAR.PRT_Number_of_Copies;

CASE;

// IF PAR.Report Type USR is Detail
IF PAR.Report_Type_USR = 'D';

// Call program EXC Command SBDOVR     UP.
CALL PROGRAM(EXC Command SBDOVR     UP) ('PDPOUPR');
PARAMETER('PDTRPFR$');
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(WRK.Nbr_of_Copies_Alpha_USR);

// IF *OTHERWISE
IF *OTHERWISE;

// Call program EXC Command SBDOVR     UP.
CALL PROGRAM(EXC Command SBDOVR     UP) ('PDPOUPR');
PARAMETER('PPU2PFR$');
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(WRK.Nbr_of_Copies_Alpha_USR);

ENDIF;

ENDDO;

//?2.  Run the Open Query File
DO;

// Call program PRT Lot/Location Trans UP.
CALL PROGRAM(PRT Lot/Location Trans UP) ('PDTSUPC');
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Item_Code);
PARAMETER(PAR.Warehouse_Code);
PARAMETER(PAR.LLT_Transaction_Type);
PARAMETER(PAR.Date_1_PASS_USR);
PARAMETER(PAR.Date_2_PASS_USR);
PARAMETER(PAR.Report_Type_USR);

ENDDO;

//?3.  Print Report
DO;

// WRK.LLT Trans Date = PAR.Date 1          PASS  USR
WRK.LLT_Transaction_Date = PAR.Date_1_PASS_USR;

// WRK.Date                  USR = PAR.Date 2          PASS  USR
WRK.Date_USR = PAR.Date_2_PASS_USR;

CASE;

// IF PAR.Report Type USR is Detail
IF PAR.Report_Type_USR = 'D';

// Call program Zzz Lot/Location Trans PF.
CALL PROGRAM(Zzz Lot/Location Trans PF) ('PDTRPFR');
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Item_Code);
PARAMETER(PAR.Warehouse_Code);
PARAMETER(PAR.LLT_Transaction_Type);
PARAMETER(WRK.LLT_Transaction_Date);
PARAMETER(PAR.User_Id);
PARAMETER(WRK.Date_USR);
PARAMETER(PAR.Dtl_Sum_Ttl_Typ_Sts_USR);
PARAMETER(PAR.No_Activity_Report_Usr);
PARAMETER(PAR.Detail_Summary_Report_Usr);

// Execute command - 'CLOF'
EXECUTE COMMAND(USR3607);
PARAMETER('PDL7CPL5');

// IF *OTHERWISE
IF *OTHERWISE;

// Call program PRT Lot/Loc Trans Summ PF.
CALL PROGRAM(PRT Lot/Loc Trans Summ PF) ('PPU2PFR');
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Item_Code);
PARAMETER(PAR.Warehouse_Code);
PARAMETER(PAR.LLT_Transaction_Type);
PARAMETER(WRK.LLT_Transaction_Date);
PARAMETER(PAR.User_Id);
PARAMETER(WRK.Date_USR);
PARAMETER(PAR.Dtl_Sum_Ttl_Typ_Sts_USR);
PARAMETER(PAR.No_Activity_Report_Usr);
PARAMETER(PAR.Detail_Summary_Report_Usr);

// Execute command - 'CLOF'
EXECUTE COMMAND(USR3607);
PARAMETER('PDL7CPLA');

ENDIF;

//?The executable message below is required to delete the override
//?that was called in the Open Query CL Program in step 2.
// Execute command - 'DLTOVR'
EXECUTE COMMAND(USR2787);

ENDDO;

