     H/TITLE EDT Order Details More EF Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated
     H* - Key changes are not allowed
     H* - New records cannot be added
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISABANS
     H* Date          : 05/05/25  Time  : 05:29:44
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDO4EFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: EDT Order Details More EF Edit file
      *
     FOPBGWKL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Detail              Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FOMHLREL1IF  E           K        DISK
      * RTV : Accrual Program           Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FPOC7REL1IF  E           K        DISK
      * RTV : Customer Price Detail     Retrieval index
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country Master            Retrieval index
      *
     FOPEZREL1IF  E           K        DISK
      * RTV : Event Types               Retrieval index       NV
      *
     FOPCXREL1IF  E           K        DISK
      * RTV : OP Reason Codes           Retrieval index
      *
     FPDM0REL1IF  E           K        DISK
      * RTV : Ham Group Master          Retrieval index
      *
     FPDMSREL2IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Order/Seq
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPDMSREL0UF  E           K        DISK
      * UPD : Export Doc Order Dtl      Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  10  6   @CN    25
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
     I              ADQDSC                          WBQDSC
      *
     I@MSREW4
      * Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WCAIC3
     I              MSC4NB                          WCC4NB
     I              MSDGSX                          WCDGSX
     I              MSKXCD                          WCKXCD
     I              MSDPNB                          WCDPNB
     I              MSUENB                          WCUENB
     I              MSDIC7                          WCDIC7
     I              MSO3NA                          WCO3NA
     I              MSO4NA                          WCO4NA
     I              MSRMTX                          WCRMTX
     I              MSPTTX                          WCPTTX
     I              MSHJWG                          WCHJWG
     I              MSHKWG                          WCHKWG
     I              MSRNTX                          WCRNTX
     I              MSAONX                          WCAONX
     I              MSROTX                          WCROTX
     I              MSORNA                          WCORNA
     I              MSAMNX                          WCAMNX
     I              MSANNX                          WCANNX
     I              MSAPNX                          WCAPNX
     I              MSDKPR                          WCDKPR
     I              MSA9VL                          WCA9VL
     I              MSC8SX                          WCC8SX
     I              MSRATX                          WCRATX
     I              MSRBTX                          WCRBTX
     I              MSAJNX                          WCAJNX
     I              MSZWTX                          WCZWTX
     I              MSZXTX                          WCZXTX
     I              MSZYTX                          WCZYTX
     I              MSZZTX                          WCZZTX
     I              MSK0U1                          WCK0U1
     I              MSK1U1                          WCK1U1
     I              MSIJSC                          WCIJSC
     I              MSIKSC                          WCIKSC
     I              MSK2U1                          WCK2U1
     I              MSW0DT                          WCW0DT
     I              MSUVST                          WCUVST
     I              MSUWST                          WCUWST
     I              MSUXST                          WCUXST
     I              MSVSST                          WCVSST
     I              MSAATM                          WCAATM
     I              MSAYNA                          WCAYNA
     I              MSA0NA                          WCA0NA
     I              MSAXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Current/previous master file format fields for change control
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      * Outward parameters
     IPBRC        DS                             12
      * KEY : Order Detail              Ship To/Price Code/Item
      * I :  Ship To Customer
     I                                    P   1   40PBBKC7
      * I :  Price Code
     I                                    P   5   80PBBVTM
      * I :  Item Code
     I                                    P   9  120PBHGCD
      *
     IQPDMS1    E DSPDMSREL0
      * UPD : Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WCAIC3
     I              MSC4NB                          WCC4NB
     I              MSDGSX                          WCDGSX
     I              MSKXCD                          WCKXCD
     I              MSDPNB                          WCDPNB
     I              MSUENB                          WCUENB
     I              MSDIC7                          WCDIC7
     I              MSO3NA                          WCO3NA
     I              MSO4NA                          WCO4NA
     I              MSRMTX                          WCRMTX
     I              MSPTTX                          WCPTTX
     I              MSHJWG                          WCHJWG
     I              MSHKWG                          WCHKWG
     I              MSRNTX                          WCRNTX
     I              MSAONX                          WCAONX
     I              MSROTX                          WCROTX
     I              MSORNA                          WCORNA
     I              MSAMNX                          WCAMNX
     I              MSANNX                          WCANNX
     I              MSAPNX                          WCAPNX
     I              MSDKPR                          WCDKPR
     I              MSA9VL                          WCA9VL
     I              MSC8SX                          WCC8SX
     I              MSRATX                          WCRATX
     I              MSRBTX                          WCRBTX
     I              MSAJNX                          WCAJNX
     I              MSZWTX                          WCZWTX
     I              MSZXTX                          WCZXTX
     I              MSZYTX                          WCZYTX
     I              MSZZTX                          WCZZTX
     I              MSK0U1                          WCK0U1
     I              MSK1U1                          WCK1U1
     I              MSIJSC                          WCIJSC
     I              MSIKSC                          WCIKSC
     I              MSK2U1                          WCK2U1
     I              MSW0DT                          WCW0DT
     I              MSUVST                          WCUVST
     I              MSUWST                          WCUWST
     I              MSUXST                          WCUXST
     I              MSVSST                          WCVSST
     I              MSAATM                          WCAATM
     I              MSAYNA                          WCAYNA
     I              MSA0NA                          WCA0NA
     I              MSAXDT                          WCAXDT
      *
     IYBRDCS      DS                            525
     IYCRDCS      DS                            525
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * N :  Order Type_Sales
     I                                        7   8 P1JNCD
      * N :  AR Customer Number
     I                                    P   9  120P1ANC7
      * I : MAP Ship To Customer
     I                                    P  13  160P1BKC7
      * N :  Bill to Customer
     I                                    P  17  200P1B0C7
      * N :  Requested Ship Date
     I                                    P  21  240P1A5DT
      * N :  Comment Print Acknowledge
     I                                       25  25 P1GTST
      * N :  Comment Print Inv_Cr_Memo
     I                                       26  26 P1GVST
      * N :  Comment Print Pick Slip
     I                                       27  27 P1GUST
      * N :  Comment Print Ship Doc
     I                                       28  28 P1QFST
      * N :  Header Status
     I                                       29  29 P1GWST
      * N :  Order Value Total
     I                                    P  30  352P1JZVA
      * N :  Order Weight Total
     I                                    P  36  412P1A1WG
      * N :  Credit Hold
     I                                       42  42 P1XIST
      * N :  Production Hold
     I                                       43  43 P1XJST
      * N :  Load ID
     I                                    P  44  470P1RMNB
      * N :  Shipping Method
     I                                       48  49 P1Q2CD
      * N :  Palletize
     I                                       50  50 P1VEST
      * N :  Slip Sheet
     I                                       51  51 P1VGST
      * N :  Age Code
     I                                       52  52 P1RPCD
      * N :  Reefer Temperature
     I                                    P  53  552P1RNNB
      * N :  Load Type
     I                                       56  56 P1VDST
      * N :  Sales Route Code
     I                                       57  59 P1R4CD
      * N :  Event Code
     I                                       60  61 P1JPCD
      * N :  Trans Contol AS400_Plant
     I                                       62  62 P1XUST
      * N :  Billing Activity Type
     I                                       63  63 P1OBST
      * N :  Block Order Flag
     I                                       64  64 P1BCST
      * N :  Broker Order Status
     I                                       65  65 P1FSSX
      * N :  OH Load Plan Ready
     I                                       66  67 P1FVSX
      * N :  HPB Ship to Warehouse
     I                                       68  70 P1FXSX
     IP2PARM      DS
      * B :  Next Program Name
     I                                        1  10 P2BYVN
     IP3PARM      DS
      * I :  USR Change existing order
     I                                        1   1 P3G6ST
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P4AJCD
      * I :  Application Code
     I                                        4   9 P4DNCD
      * N :  Enterprise Code 1
     I                                       10  13 P4DQCD
      * N :  Enterprise Code 2
     I                                       14  25 P4DRCD
      * N :  Salesperson Code
     I                                       26  28 P4BCCD
      * N :  System Date Format
     I                                       29  31 P4B8NA
      * N :  User Profile Name
     I                                       32  41 P4AJVN
      * N :  Allow Multi_Company
     I                                       42  42 P4I6ST
      * N :  Default Printer
     I                                       43  52 P4MPNA
      * N :  First Time Flag
     I                                       53  53 P4TAST
     IP5PARM      DS
      * FLD: *Arrays
      * N :  Cntrt Enter no QT Price
     I                                        1   1 P5WDST
      * N :  Cntrt.# does not Exit
     I                                        2   2 P5WEST
      * N :  Qty ordered > Contract
     I                                        3   3 P5WFST
      * N :  Contract Expired
     I                                        4   4 P5WGST
      * N :  Price Override Required
     I                                        5   5 P5WHST
      * N :  Price Method QT & Cntrt 0
     I                                        6   6 P5WIST
      * N :  Prc Code FRM or MKT
     I                                        7   7 P5WJST
      * N :  Mkt Pricing Date not 0
     I                                        8   8 P5WKST
      * N :  Mkt Meth. and Date both
     I                                        9   9 P5WLST
      * N :  Price Override Req. EXT
     I                                       10  10 P5WMST
      * N :  Contract Exists for Item
     I                                       11  11 P5XSST
      * N :  Price Override not Allowd
     I                                       12  12 P5YXST
     IP6PARM      DS
      * FLD: Price Method Header
      * N :  Price Method Type
     I                                        1   1 P6V8ST
     IP7PARM      DS
      * FLD: Company Defaults Internal
      * N :  Allow Mult Whse to Order
     I                                        1   1 P7HSST
      * N :  Allow Multi Export On Ord
     I                                        2   2 P7AMEO
     IP8PARM      DS
      * FLD: *Arrays
      * N :  Transportation Temp
     I                                    P   1   20P8TFNB
      * N :  USR Update Flag
     I                                        3   3 P8R4ST
      * N :  USR First Time
     I                                        4   4 P8TMST
      * N :  USR Display field
     I                                        5   5 P8GGST
      * N :  Effective Date
     I                                    P   6   90P8AUDT
      * N :  End Date Effective
     I                                    P  10  130P8CWDT
      * N :  Maximum Quantity
     I                                    P  14  192P8DQQT
      * N :  Contract Mkt Price Date
     I                                    P  20  230P8GBDT
      * N :  Quantity Sold
     I                                    P  24  292P8HFQT
      * N :  Affect Inventory Default
     I                                       30  30 P8OEST
      * N :  Affect Sales Doll Default
     I                                       31  31 P8OFST
      * N :  Affect Sales Pnds Default
     I                                       32  32 P8VBST
      * N :  Affect Accruals Default
     I                                       33  33 P8X8ST
      * N :  Quantity Ordered
     I                                    P  34  392P8AVQT
     IP9PARM      DS
      * N :  USR Warehouse Code
     I                                        1   3 P9CPCD
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(ORDER-    1 256 #S0001
     I              '_ACK)               '
     I            DS
     I I            'SBMJOB     JOB(GETRE-    1 256 #S0002
     I              'ADY) JOBD(*USRPRF)  '
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Quantity is required'
      * Message data for 'Warehouse Codes        NF'
      * Warehouse Code
     I                                        1   3 ZA0001
      * Message data for 'Warehouse Ctl not allowed'
      * Warehouse Code
     I                                        1   3 ZA0002
      * Trans Contol AS400_Plant
     I                                        4   4 ZA0003
      * USR Trans Control A/P
     I                                        5   5 ZA0004
      * Message data for 'Warehouse must differ tr.'
      * Message data for 'Item Balance           NF'
      * Company Number
     I                                        1   3 ZA0005
      * Item Code
     I                                        4  10 ZA0006
      * Warehouse Code
     I                                       11  13 ZA0007
      * Message data for 'Price Code not val f/item'
      * Price Code
     I                                    P   1   40ZA0008
      * Item Code
     I                                        5  11 ZA0009
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0010
      * Weight Allocated USR
     I                                    P   5   92ZA0011
      * Maximum Contract Units
     I                                    P  10  152ZA0012
      * Item Code
     I                                       16  22 ZA0013
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0014
      * Weight Allocated USR
     I                                    P   5   92ZA0015
      * Maximum Contract Units
     I                                    P  10  152ZA0016
      * Item Code
     I                                       16  22 ZA0017
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1BKC7    PARM           WP0003  70       Ship To Custome
     C           P2BYVN    PARM P2BYVN    WP0004 10        Next Program Na
     C           P3G6ST    PARM           WP0005  1        USR Change exis
     C           P4DNCD    PARM           WP0006  6        Application Cod
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
      * CASE: PAR.First Time Flag is Yes
     C           P4TAST    IFEQ 'Y'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SARVGN
      * RTV for Order Dtl Ent. RT - Order Header TRG  * 
     C                     EXSR SBRVGN
     C                     Z-ADD#2EIDT    #CK3DT           USR Requested D
     C                     Z-ADD#2AFTM    #CRUNY           Usr Request Del
     C                     Z-ADDP1A5DT    #CCZDT           USR Requested s
     C                     Z-ADDWUAODT    #CHODT           Scheduled Ship
     C                     MOVEL*BLANK    #CUWTX           Ship To Name
      * Ship To Name          DRV
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SCRVGN
      * fp1309 bring in the deadline dep date for the first record
      * Rtv All Fields/1 line XF - Order Detail  * 
     C                     CALL 'PNQYXFR'              90  Rtv All Fields/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0001  30       Company Number
     C                     PARM #2C4NB    WQ0002  70       Order Number
     C                     PARM *BLANK    WQ0003  1        Credit Hold
     C                     PARM *BLANK    WQ0004  1        Production Hold
     C                     PARM *BLANK    WQ0005  1        Header Status
     C                     PARM *BLANK    WQ0006  2        Order Type_Sale
     C                     PARM *ZERO     WQ0007  70       Load ID
     C                     PARM *BLANK    WQ0008  1        Export Status
     C                     PARM *BLANK    WQ0009 20        Ship To City
     C                     PARM *BLANK    WQ0010  2        Ship To State C
     C                     PARM *BLANK    WQ0011  1        Order in Use
     C                     PARM *ZERO     WQ0012  30       Order Sequence
     C                     PARM *ZERO     WQ0013  30       Order Secondary
     C                     PARM *ZERO     WQ0014  70       Item Code
     C                     PARM *BLANK    WQ0015  3        Warehouse Code
     C                     PARM *ZERO     WQ0016  70       Ship To Custome
     C                     PARM *ZERO     WQ0017  70       Order Group Cod
     C                     PARM *BLANK    WQ0018  1        Detail Line Sta
     C                     PARM *BLANK    WQ0019  1        Detail Line Sta
     C                     PARM *ZERO     WQ0020 112       Billing Detail
     C                     PARM *ZERO     WQ0021 112       Billing Detail
     C                     PARM *ZERO     WQ0022 112       Billing Detail
     C                     PARM *ZERO     WQ0023 112       Quantity to Sub
     C                     PARM *BLANK    WQ0024  1        Comment Print A
     C                     PARM *BLANK    WQ0025  1        Comment Print I
     C                     PARM *BLANK    WQ0026  1        Comment Print P
     C                     PARM *BLANK    WQ0027  1        Comment Print S
     C                     PARM *ZERO     WQ0028 112       Extended Amount
     C                     PARM *ZERO     WQ0029  70       Market Pricing
     C                     PARM *BLANK    WQ0030  3        Commodity Marke
     C                     PARM *BLANK    WQ0031  3        Date Method Cod
     C                     PARM *BLANK    WQ0032  3        Price Method Co
     C                     PARM *ZERO     WQ0033 114       Price Overage O
     C                     PARM *ZERO     WQ0034  70       Contract Number
     C                     PARM *BLANK    WQ0035  1        Price Status
     C                     PARM *ZERO     WQ0036  70       Pricing Date Us
     C                     PARM *BLANK    WQ0037  2        U_M_Base Price
     C                     PARM *BLANK    WQ0038  2        U_M_Ordered
     C                     PARM *BLANK    WQ0039  1        Work Confirm St
     C                     PARM *BLANK    WQ0040  1        Work Over_Short
     C                     PARM *BLANK    WQ0041  1        OD Production P
     C                     PARM *BLANK    WQ0042 30        Order Desc_Line
     C                     PARM *BLANK    WQ0043 30        Order Desc_Line
     C                     PARM *BLANK    WQ0044  1        Age Code
     C                     PARM *BLANK    WQ0045  1        Palletize
     C                     PARM *BLANK    WQ0046  1        Slip Sheet
     C                     PARM *BLANK    WQ0047  1        Catch Weight St
     C                     PARM *BLANK    WQ0048  1        Price Audit
     C                     PARM *BLANK    WQ0049  3        Price Audit Rea
     C                     PARM *BLANK    WQ0050  1        Production Date
     C                     PARM *ZERO     WQ0051 112       Rated Freight
     C                     PARM *ZERO     WQ0052 112       Quantity Ordere
     C                     PARM *ZERO     WQ0053 112       Weight Ordered
     C                     PARM *ZERO     WQ0054 112       Quantity Schedu
     C                     PARM *ZERO     WQ0055 112       Weight Schedule
     C                     PARM *ZERO     WQ0056 112       Quantity Shippe
     C                     PARM *ZERO     WQ0057 112       Weight Shipped
     C                     PARM *ZERO     WQ0058 114       Unit Cost Prici
     C                     PARM *ZERO     WQ0059 114       Unit Cost Per P
     C                     PARM *ZERO     WQ0060 114       Unit Price
     C                     PARM *ZERO     WQ0061 114       Unit Price_Cred
     C                     PARM *ZERO     WQ0062 114       Unit Price Orde
     C                     PARM *ZERO     WQ0063 112       Unit Weight Ord
     C                     PARM *ZERO     WQ0064 112       Tare Weight Tot
     C                     PARM *ZERO     WQ0065  70       Requested Ship
     C                     PARM *ZERO     WQ0066  70       Scheduled Ship
     C                     PARM *ZERO     WQ0067  70       Actual Shipped
     C                     PARM *BLANK    WQ0068  1        Affect Inventor
     C                     PARM *BLANK    WQ0069  1        Affect Sales Do
     C                     PARM *BLANK    WQ0070  1        Affect Sales Pn
     C                     PARM *ZERO     WQ0071  30       Item Structure
     C                     PARM *ZERO     WQ0072  30       Item Structure
     C                     PARM *ZERO     WQ0073  30       Item Structure
     C                     PARM *BLANK    WQ0074  2        Item Level
     C                     PARM *BLANK    WQ0075  2        Quality Level
     C                     PARM *BLANK    WQ0076  2        Pricing Product
     C                     PARM *BLANK    WQ0077  2        Season Product
     C                     PARM *ZERO     WQ0078  70       Date of Origina
     C                     PARM *BLANK    WQ0079 10        User Profile Na
     C                     PARM *BLANK    WQ0080  6        Country Code
     C                     PARM *BLANK    WQ0081  2        Event Code
     C                     PARM *BLANK    WQ0082  3        Reason Code
     C                     PARM *BLANK    WQ0083  3        Sales Route Cod
     C                     PARM *BLANK    WQ0084  1        Modified Flag
     C                     PARM *BLANK    WQ0085  1        Substituted Fla
     C                     PARM *BLANK    WQ0086  1        OD Schedule Ove
     C                     PARM *ZERO     WQ0087 114       Invoice Unit Pr
     C                     PARM *ZERO     WQ0088 112       Invoice Extende
     C                     PARM *ZERO     WQ0089  30       Ham Group Numbe
     C                     PARM *BLANK    WQ0090  1        OD Adj Type Ove
     C                     PARM *BLANK    WQ0091  1        Affect Trade Fu
     C                     PARM *BLANK    WQ0092  1        Affect Commissi
     C                     PARM *BLANK    WQ0093  1        Affect Pricing
     C                     PARM *BLANK    WQ0094  1        Released by Use
     C                     PARM *BLANK    WQ0095  2        Ord TF Exempt C
     C                     PARM *BLANK    WQ0096  2        OD Pallet Type
     C                     PARM *BLANK    WQ0097  3        Production Ware
     C                     PARM *BLANK    WQ0098  3        OD Price Type
     C                     PARM *ZERO     WQ0099  70       Warehouse Palle
     C                     PARM *ZERO     WQ0100  70       Consumed Item C
     C           #CNVDT    PARM *ZERO     WQ0101  70       Deadline Depart
     C                     PARM *ZERO     WQ0102  70       OD Price Type R
     C                     PARM *ZERO     WQ0103  70       OD Firm Date
     C           #CBUTM    PARM *ZERO     WQ0104  60       Deadline Depart
     C                     PARM *ZERO     WQ0105  60       Price Code
     C                     PARM *ZERO     WQ0106  60       Maximum Net Wei
     C                     PARM *ZERO     WQ0107  60       Substitution Li
     C                     PARM *ZERO     WQ0108  60       Max Qty to sche
     C                     PARM *ZERO     WQ0109 112       Warehouse Palle
     C                     PARM *ZERO     WQ0110 112       Warehouse Avg P
     C                     PARM *ZERO     WQ0111 112       OD Item Target
     C                     PARM *ZERO     WQ0112 112       OD Estimated Gr
     C                     PARM *ZERO     WQ0113 112       OD Maximum Unit
     C                     PARM *ZERO     WQ0114 114       Order Gate_Fina
     C                     PARM *ZERO     WQ0115 114       OD Ceiling Pric
     C                     PARM *ZERO     WQ0116 114       OD Gate_Final P
     C                     PARM *ZERO     WQ0117 114       OD Weighted Avg
     C                     PARM *ZERO     WQ0118 114       OD Original Ord
     C                     PARM *ZERO     WQ0119 114       OD Cancel Date
     C                     PARM *ZERO     WQ0120 114       OD Unused Prc 7
     C                     PARM *ZERO     WQ0121 114       OD Unused Prc 8
     C                     PARM *BLANK    WQ0122  1        OD MPR Sent to
     C                     PARM *BLANK    WQ0123  1        OD MPR Prc Read
     C                     PARM *BLANK    WQ0124  1        OD UnUsed Price
     C                     PARM *ZERO     WQ0125 112       Weight Amount E
     C                     PARM *ZERO     WQ0126  40       Item Age Days
     C                     PARM *ZERO     WQ0127  70       Production Ovr
     C                     PARM *ZERO     WQ0128  70       Production Ovr
     C                     PARM *BLANK    WQ0129  1        OD Spot Buy
     C                     PARM *BLANK    WQ0130  2        OD Clm Full Ret
     C                     PARM *BLANK    WQ0131  3        Order Line Erro
     C                     PARM *ZERO     WQ0132  70       OD Market Begin
     C                     PARM *ZERO     WQ0133  70       OD Market Endin
     C                     PARM *ZERO     WQ0134  70       OD Atch to Ord
     C                     PARM *ZERO     WQ0135  70       Requested Deliv
     C                     PARM *ZERO     WQ0136  40       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Get Customer Type
      * Rtv Co/Customer Type - Company Customer  * 
     C                     EXSR SDRVGN
      * Set Customer Type Desc Usr
      * CASE: WRK.Type Code is Inter Company
     C           WUBOCD    IFEQ 'IC'                       *IF
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL@CN,001   #CRHNA           Customer Type D
     C                     ELSE
      * CASE: WRK.Type Code is Inter-Comp Sales Agreemnt
     C           WUBOCD    IFEQ 'IS'                       *IF
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL@CN,002   #CRHNA           Customer Type D
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL@CN,003   #CRHNA           Customer Type D
     C                     END                             *FI
     C                     END                             *FI
      * Hold customer's warehouse code (outside whse) in Par.usr warehous
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           P1OBST    IFEQ '4'                        *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
     C                     EXSR SERVGN
     C                     END                             *FI
      * 08/19/19 DN R15322-Allow Original Ordered Qty to be Change?
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Block Order Flag is Firm Order
      *   |- c2    : LCL.User Appl Profile Exist U is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1BCST    IFEQ 'F'                        *IF
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Allow for Edit of Original Ordered Qty.
     C                     MOVEL'Y'       YL0002           Edit Orig Order
     C                     ELSE
      * CASE: *OTHERWISE
      * Do NOT Allow for Edit of Original Ordered Qty.
     C                     MOVEL'N'       YL0002           Edit Orig Order
     C                     END                             *FI
     C                     MOVEL'N'       P4TAST           First Time Flag
     C                     END                             *FI
      * RTV Weight Ord & Sched RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     Z-ADD#2C4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     Z-ADD#CAVQT    WL0005           Quantity Ordere
     C                     Z-ADD#CD0WG    WL0006           Weight Ordered
     C                     Z-ADD#CAUWG    WL0007           Weight Schedule
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #CAVQT           Quantity Ordere
     C                     Z-ADDWL0006    #CD0WG           Weight Ordered
     C                     Z-ADDWL0007    #CAUWG           Weight Schedule
      * ** PK0519 Accrual Exists  12/02/03**
      * ** DLY029 Accrual Exists if one exists with Affect Inv Price=Y
      * Val Mkt Accrual Exist RT - Customer Accrual  * 
     C                     EXSR SGRVGN
     C                     END
      *................................................................
      * Position file
     C           KPOS      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C                     Z-ADD#2DPNB    OMDPNB
     C                     Z-ADD#2UENB    OMUENB
      * 82=EOF
     C           KPOS      SETLL@BGWKL1              82    *
      * 82=EOF
     C           KRST      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C  N82      KRST      READE@BGWKL1                9182*
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BGWKL1                  90*
     C  N82                READ @BGWKL1                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  7
     C                     MOVE *ALL'1'   WKIND1  7
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * Load SFL fields
     C                     EXSR MBFL#1
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
      * OMS112C:  Use qty to substitute if this is a substitution.
      * Quantity ordered
      * CASE: DB1.Order Secondary Line Seq is GT 1
     C           OMUENB    IFGT 1                          *IF
     C                     Z-ADDOML9VA    #RHHQT           Qty Ordered USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDOMAVQT    #RHHQT           Qty Ordered USR
     C                     END                             *FI
      * SAZ 05/20/08 Move unit price to smaller field to display on scree
     C                     Z-ADDOMAKPR    #RDTPR           Unit Price (DSP
     C                     Z-ADD#RHHQT    #RINQT           Quantity 11.2 U
      * 08/19/19 DN R15322-Set OD Original Ordered Qty U on Screen.
     C                     Z-ADDOMDZPR    #REDNZ           OD Original Ord
     C                     Z-ADDOMCCQT    #RH1QT           Scheduled Quant
     C                     Z-ADDOMAUWG    #REVWG           Weight Schedule
     C                     MOVELOMAJCD    #RCPCD           USR Warehouse C
     C                     MOVELOMAJCD    YL0006           Warehouse Code
     C                     MOVELP8GGST    #RGGST           USR Display fie
     C                     MOVELP7HSST    #RTIST           USR Display 1
     C                     MOVELP7AMEO    #RTJST           USR Display 2
     C                     MOVEL#1KXCD    YL0007           USR Country Cod
      * Set to not allow updates if line is cancelled
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     MOVEL'N'       #RGGST           USR Display fie
     C                     MOVEL'N'       #RTIST           USR Display 1
     C                     MOVEL'N'       #RTJST           USR Display 2
     C                     END                             *FI
      * RTV Primal Grp Code   RT - Company Item  * 
     C                     EXSR SIRVGN
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * 82=EOF
     C           KRST      READE@BGWKL1                  82*
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * CASE: CTL.*CMD key is *Option Toggle
     C           *IN08     IFEQ '1'                        *IF
      * CASE: PAR.USR Display field is yes
     C           P8GGST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       P8GGST           USR Display fie
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P8GGST           USR Display fie
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * F15=Order Header
      * CASE: CTL.*CMD key is *Order Header
     C           *IN15     IFEQ '1'                        *IF
      * RTV Weight Ord & Sched RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     Z-ADD#2C4NB    WL0002           Order Number
     C                     Z-ADD#2DPNB    WL0003           Order Sequence
     C                     Z-ADD#2UENB    WL0004           Order Secondary
     C                     Z-ADD#CAVQT    WL0005           Quantity Ordere
     C                     Z-ADD#CD0WG    WL0006           Weight Ordered
     C                     Z-ADDP1A1WG    WL0007           Weight Schedule
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #CAVQT           Quantity Ordere
     C                     Z-ADDWL0006    #CD0WG           Weight Ordered
     C                     Z-ADDWL0007    P1A1WG           Weight Schedule
      * CHG Order Value,Wgt    CH - Order Header TRG  * 
     C                     EXSR SJCHRC
      * CASE: PAR.Load ID is NE Blank
     C           P1RMNB    IFNE *ZERO                      *IF
      * RTV UPD Ld Abs.Frt/Wgt XF - Order Header TRG  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1RMNB    WQ0137  70       Load ID
     C           WURPNB    PARM WURPNB    WQ0138  70       Total Load Orde
     C           WURQNB    PARM WURQNB    WQ0139 112       Total Freight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL@CN,004   P2BYVN           Next Program Na
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F18=Details
      * CASE: CTL.*CMD key is *Order Details
     C           *IN18     IFEQ '1'                        *IF
     C                     MOVEL@CN,005   P2BYVN           Next Program Na
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F16=Product Availability   Disable if Live w/TPM      E4119O
      * CASE: CTL.*CMD key is *Product Availability
     C           *IN16     IFEQ '1'                        *IF
      * WW Product Availablty DF - Company Item Avail Group  * 
     C                     CALL 'PDFPDFR'              90  WW Product Avai
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0140  30       Company Number
     C                     PARM YL0006    WQ0141  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFPDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F20=Post
      * CASE: CTL.*CMD key is *Post/Update Open Order
     C           *IN20     IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
     C                     MOVEL'Y'       WUQ2ST           Status Flag 2
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'N'       WUFMST           Status Flag 4
     C                     MOVEL'Y'       WUAJTX           Status Flag 5
     C                     MOVEL'N'       WUAKTX           Status Flag 7
      * ** 03/12/13 slm add email on Acknowledgement by the Warehouse Dis
     C                     MOVEL'N'       WUAFTX           Status Flag 8
     C                     MOVEL'N'       WUDITX           Status Flag 12
     C                     MOVEL*BLANK    YL0008           OH Load Plan Re
     C                     MOVEL*BLANK    WURJAA           Email to Wareho
      * 08/21/2017 DN T11489-Added Salesperson Code/Name to Parm.
      * 08/06/24 SP S312312-Start (Get field "Email to Broker Usr")
      * SEL Confirm Prompt     PV - Order Header TRG  * 
     C                     CALL 'PDS0PVR'              90  SEL Confirm Pro
     C                     PARM *BLANK    W0RTN   7
     C           WUB8ST    PARM WUB8ST    WQ0142  1        Status - Y or N
     C                     PARM #2AIC3    WQ0143  30       Company Number
     C                     PARM #2C4NB    WQ0144  70       Order Number
     C                     PARM #PBKC7    WQ0145  70       Ship To Custome
     C                     PARM P1BCST    WQ0146  1        Block Order Fla
     C           YL0008    PARM YL0008    WQ0147  2        OH Load Plan Re
     C           WUDTSX    PARM WUDTSX    WQ0148  1        Print (Yes/No)
     C           WUQ2ST    PARM WUQ2ST    WQ0149  1        Status Flag 2
     C           WUQ3ST    PARM WUQ3ST    WQ0150  1        Status Flag 3
     C           WUFMST    PARM WUFMST    WQ0151  1        Status Flag 4
     C           WUAJTX    PARM WUAJTX    WQ0152  1        Status Flag 5
     C           WUACTX    PARM WUACTX    WQ0153  1        Status Flag 6
     C           WUAKTX    PARM WUAKTX    WQ0154  1        Status Flag 7
     C           WUAFTX    PARM WUAFTX    WQ0155  1        Status Flag 8
     C           WUDITX    PARM WUDITX    WQ0156  1        Status Flag 12
     C           WURJAA    PARM WURJAA    WQ0157  3        Email to Wareho
     C           WUVQSX    PARM WUVQSX    WQ0158  1        Email Selection
     C           P4BCCD    PARM P4BCCD    WQ0159  3        Salesperson Cod
     C           YL0009    PARM YL0009    WQ0160 30        Salesperson Nam
     C           YL0010    PARM YL0010    WQ0161  1        Email to Broker
     C           YL0011    PARM YL0011    WQ0162  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDS0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 08/06/24 SP S312312-End
      * CASE: WRK.Status - Y or N is no
     C           WUB8ST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P2BYVN           Next Program Na
      * EDT Post Open Orders 2 XF - Order Header TRG  * 
     C                     CALL 'POI4XFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0163  30       Company Number
     C                     PARM #2C4NB    WQ0164  70       Order Number
     C                     PARM #PBKC7    WQ0165  70       Ship To Custome
     C           WUNFNN    PARM WUNFNN    WQ0166 112       Order Value Tot
     C           WUNFNN    PARM *ZERO     WQ0167 112       Order Weight To
     C                     PARM YL0007    WQ0168  6        USR Country Cod
     C                     PARM P9CPCD    WQ0169  3        USR Warehouse C
     C                     PARM 'OE'      WQ0170  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Acknowledgement if flag is yes from the confirm prompt
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : WRK.Print (Yes/No) USR is Yes
      *   |- c2    : WRK.Status Flag 8  Y/N is Yes
      *   |- c3    : LCL.Email to Salesperson Usr is Yes
      *   '-
     C           WUDTSX    IFEQ 'Y'                        *IF
     C           WUAFTX    OREQ 'Y'                        *OR
     C           YL0011    OREQ 'Y'                        *OR
     C                     MOVEL'N'       WUWUST           PRT Night Queue
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,006   WQ0171 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0172 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0173  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0174  4        PRT Save Output
     C           WUDYNB    PARM WUDYNB    WQ0175  20       PRT Number of C
     C           WUWUST    PARM WUWUST    WQ0176  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0177 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0178  6        Application Cod
     C                     PARM WUA7ST    WQ0179  1        Paper Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Print (Yes/No) USR is No
     C           WUDTSX    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    WUWRST           PRT Printer Dev
     C                     END                             *FI
      * SBMJOB: PRT Acknowledgements UP - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PDJWPCLP'#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#2AIC3    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#2C4NB    #SPAK  309       Order Number 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#2C4NB    #SPAK  309       Order Number 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Thru Date Pass
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Order Type_Sale
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUOTTX    #SSTR     P      Shipping Method
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 2         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'1'       #SSTR     P      Billing Activit
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'A'       #SSTR     P      Export Sales
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR Warehouse C
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 1
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 2
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 3
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 4
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 5
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 6
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 7
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 8
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      USR CDE Parm 9
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'S'       #SSTR     P      USR Select/Omit
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWRST    #SSTR     P      PRT Printer Dev
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWSST    #SSTR     P      PRT Hold Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWTST    #SSTR     P      PRT Save Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUDYNB    #SPAK  309       System Value Nu
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'*JOBD'   #SSTR     P      PRT Night Queue
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 3
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUAFTX    #SSTR     P      Email To Whs
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWURJAA    #SSTR     P      Email to Wareho
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELYL0011    #SSTR     P      Email to Salesp
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 1         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PDJWPCLP'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Print Get Ready Report if flag is yes from the confirm prompt
      * CASE: WRK.Status Flag 5  Y/N is Yes
     C           WUAJTX    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUWUST           PRT Night Queue
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,008   WQ0180 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0181 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0182  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0183  4        PRT Save Output
     C           WUDYNB    PARM WUDYNB    WQ0184  20       PRT Number of C
     C           WUWUST    PARM WUWUST    WQ0185  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0186 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0187  6        Application Cod
     C                     PARM WUA7ST    WQ0188  1        Paper Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * SBMJOB: PRT Get Ready Report   UP - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0002    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PMH5UPC '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     Z-ADD#2AIC3    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#2C4NB    #SPAK  309       Order Number 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD#2C4NB    #SPAK  309       Order Number 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADD*ZERO     #SPAK  309       Date 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWRST    #SSTR     P      PRT Printer Dev
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWSST    #SSTR     P      PRT Hold Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUWTST    #SSTR     P      PRT Save Output
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 4         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUDYNB    #SPAK  309       System Value Nu
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL'*JOBD'   #SSTR     P      PRT Night Queue
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 10        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVEL*BLANK    #SSTR     P      Department Code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 6         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PMH5UPC 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMH5UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * 08/06/24 SP S312312-Start (Add new condition c5)
      * Fax Acknwlg to buyer/rep/brkr/Cust if slctd at confirm pmt 12/03/
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : WRK.Status Flag 4  Y/N is yes
      *   |- c2    : WRK.Status Flag 2  Y/N is Yes
      *   |- c3    : WRK.Status Flag 3  Y/N is Yes
      *   |- c4    : WRK.Status Flag 7  Y/N is Yes
      *   |- c5    : LCL.Email to Broker Usr is Yes
      *   '-
     C           WUFMST    IFEQ 'Y'                        *IF
     C           WUQ2ST    OREQ 'Y'                        *OR
     C           WUQ3ST    OREQ 'Y'                        *OR
     C           WUAKTX    OREQ 'Y'                        *OR
     C           YL0010    OREQ 'Y'                        *OR
      * RMC  05/08/13 C2586-Status 3 - Regional Sales Rep changed to EMAI
      *                    -Status 2 - Buyer - will email and/or fax
      * RMC  06/23/04        LJB 12/03/2008
      * ** Status Flag 2=Buyer Fax/email, Status Flag 3=Regional Sales Ma
      * ** Status Flag 4=Broker Fax-which is not used at this level
      * ** Status Flag 7=Customer Fax
      * 08/21/2017 DN T11489-Added Salesperson Code to Parm.
      * 08/06/24 SP S312312 (Passing parameter "Email to Broker Usr")
      * EXC Fax Acknwgmnt     XF - Order Header TRG  * 
     C                     CALL 'PPFDXFR'              90  EXC Fax Acknwgm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0189  30       Company Number
     C                     PARM #2C4NB    WQ0190  70       Order Number
     C                     PARM #PBKC7    WQ0191  70       Ship To Custome
     C                     PARM P1FXSX    WQ0192  3        HPB Ship to War
     C                     PARM P4BCCD    WQ0193  3        Salesperson Cod
     C                     PARM WUQ2ST    WQ0194  1        USR Update Flag
     C                     PARM WUQ3ST    WQ0195  1        USR Check Y/N S
     C                     PARM WUFMST    WQ0196  1        Status - Y or N
     C                     PARM WUAKTX    WQ0197  1        Status Flag 7
     C                     PARM YL0010    WQ0198  1        Email to Broker
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPFDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * 08/06/24 SP S312312-End
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
      * No errors
     C                     SETOF                     98
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * E2393 RMC 1/09/13 ALLOW 0 QTY FOR BLOCK/TRANSFER ORDERS
      * CASE: RCD.Qty Ordered USR is Equal to Zero
     C           #RHHQT    IFEQ *ZERO                      *IF
      * Allow for TR Block order only
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Order Type - Sales is Transfer Order
      *   |- c2    : PAR.Block Order Flag is Block Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1JNCD    IFEQ 'TR'                       *IF
     C           P1BCST    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * E2393 allow for TR block order only
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Quantity is required'
     C                     MOVEL'USR0394' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If MAN price method then do not change the price status
      * CASE: RCD.Price Method Code is Manual
     C           #1Q7CD    IFEQ 'MAN'                      *IF
     C                     MOVEL#1U1ST    WUYBST           Price Status US
     C                     END                             *FI
      * fill file fields with quantity
      * CASE: RCD.Order Secondary Line Seq is GT 1
     C           #1UENB    IFGT 1                          *IF
     C                     Z-ADD#RHHQT    #1L9VA           Quantity to Sub
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#RHHQT    #1AVQT           Quantity Ordere
     C                     END                             *FI
     C                     Z-ADD#RHHQT    #RINQT           Quantity 11.2 U
      * 08/19/19 DN R15322-Move Screen Original Ordered Qty to RCD Before
     C                     Z-ADD#REDNZ    #1DZPR           OD Original Ord
      * Seq #
      * CASE: RCD.Order Sequence Number is Equal to zero
     C           #1DPNB    IFEQ *ZERO                      *IF
     C           WUDPNB    ADD  1         #1DPNB           Order Sequence
     C                     Z-ADD#1DPNB    WUDPNB           Order Sequence
     C                     END                             *FI
      * Validate entered fields and load data to output record
      * Fields from Item Master Checking
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
     C                     ELSE
      * CASE: *OTHERWISE
      * Warehouse edits
      * CASE: PAR.Allow Mult Whse to Order is yes
     C           P7HSST    IFEQ 'Y'                        *IF
      * RTV Actv Descr, Ctrl   RT - Warehouse  * 
     C                     EXSR SKRVGN
      * Warehouse code from Item master
      * CASE: RCD.Warehouse Code is Warehouse Code Blank
     C           #1AJCD    IFEQ *BLANK                     *IF
     C                     MOVELWUAJCD    #1AJCD           Warehouse Code
     C                     END                             *FI
      * Error condition warehouse not found/control error
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,009                    *IF
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0001           Warehouse Code
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     ELSE
      * CASE: WRK.Trans Contol AS400/Plant NE PAR.Trans Contol AS400/Plan
     C           WUXUST    IFNE P1XUST                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0002           Warehouse Code
     C                     MOVELWUXUST    ZA0003           Trans Contol AS
     C                     MOVELP1XUST    ZA0004           Trans Contol AS
      * Send message 'Warehouse Ctl not allowed'
     C                     MOVEL'USR1920' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     ELSE
      * CASE: From Warehouse = To Warehouse
      *  - c1 AND c2
      *   |- c1    : PAR.Billing Activity Type is Warehouse Transfer
      *   |- c2    : RCD.Warehouse Code EQ PAR.USR Warehouse Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1OBST    IFEQ '4'                        *IF
     C           #1AJCD    IFEQ P9CPCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
      * Send message 'Warehouse must differ tr.'
     C                     MOVEL'USR0433' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * XF VAL Itm Bal. Exists XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDCUXFR'              90  VAL Itm Bal. Ex
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0199  30       Company Number
     C                     PARM #1HGCD    WQ0200  70       Item Code
     C                     PARM #1AJCD    WQ0201  3        Warehouse Code
     C           WUECST    PARM *BLANK    WQ0202  1        Error Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9836  *
     C                     END
      * Error if no item balance
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0005           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0006           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1AJCD    ZA0007           Warehouse Code
      * Send message 'Item Balance           NF'
     C                     MOVEL'USR0328' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
     C           #1AVQT    MULT #1AVWG    #1D0WG           Weight Ordered
      * Weight ordered/subbed
      * CASE: RCD.Order Secondary Line Seq is GT 1
     C           #1UENB    IFGT 1                          *IF
     C           #RINQT    MULT #1AVWG    #RFHWG           Weight 11.2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1D0WG    #RFHWG           Weight 11.2 USR
     C                     END                             *FI
      * CASE: RCD.Price Code is Entered
     C           #1BVTM    IFGT *ZERO                      *IF
      * Rtv Max Wt and price  RT - Customer Price Detail  * 
     C                     EXSR SLRVGN
      * Price Code /  max wgt validations             PK0519 12/09/03
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,009                    *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0008           Price Code
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0009           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0009           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code not val f/item'
     C                     MOVEL'USR3319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Sum weights shipped/ordered for ship to /price code
      * DLY029: Replaced with Internal Function & Added new UOMs
      *
     C                     Z-ADD*ZERO     WN0123 112       Total Weight Or
     C                     Z-ADD*ZERO     WN0124 112       Total Quantity
     C                     Z-ADD*ZERO     WN0125 112       Maximum Contrac
     C                     Z-ADD*ZERO     WN0126 114       Customer Price_
     C                     MOVEL*BLANK    WN0127  1        Contract Unit T
      *
      * Clc Sum Ship/Ord Unit IF
     C                     MOVEL'N'       WUECST           Error Status
     C           #1AVQT    MULT #1AVWG    YL0018           Weight Ordered
      * CLC Sum Ship/Ord Unit XF - Order Detail  * 
     C                     CLEARPBRC
     C                     Z-ADD#1BKC7    PBBKC7           Ship To Custome
     C                     Z-ADD#1BVTM    PBBVTM           Price Code
     C                     Z-ADD#1HGCD    PBHGCD           Item Code
      *
     C                     CALL 'PPA6XFR'              90  CLC Sum Ship/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Order Deta
     C           WN0123    PARM WN0123    WQ0203 112       Total Weight Or
     C                     PARM #1C4NB    WQ0204  70       Order Number
     C           WN0124    PARM WN0124    WQ0205 112       Total Quantity
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ADD  YL0018    WN0123           Total Weight Or
     C                     ADD  #1AVQT    WN0124           Total Quantity
      * 5/13/10 SAZ P205-Add parm for Max Unit Type;rtv Contract Unit Typ
      * Rtv Cust Prc hdr/dtl  XF - Customer Price Header  * 
     C                     CALL 'PPA7XFR'              90  Rtv Cust Prc hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1BKC7    WQ0206  70       Ship To Custome
     C                     PARM #1BVTM    WQ0207  60       Price Code
     C           WUPLDT    PARM *ZERO     WQ0208  70       Price Start Dat
     C           WUPMDT    PARM *ZERO     WQ0209  70       Price End Date
     C                     PARM #1HGCD    WQ0210  70       Item Code
     C           WN0125    PARM *ZERO     WQ0211 112       Maximum Contrac
     C           WN0126    PARM *ZERO     WQ0212 114       Customer Price_
     C           #1LQCD    PARM *BLANK    WQ0213  3        Commodity Marke
     C           YL0019    PARM *BLANK    WQ0214  3        Price Method Co
     C           #1RDCD    PARM *BLANK    WQ0215  3        Date Method Cod
     C           WN0127    PARM *BLANK    WQ0216  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVELYL0019    #1Q7CD           Price Method Co
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
     C                     EXSR SMRVGN
      * 5/13/10 SAZ P205-Use Contract Unit Type to check Qty or Weight-Lb
      * Use Contract Unit Type to check Qty or Weight-Lbs
      * VAL: Total Weight and Quantity w/Maximum
      * CASE: PAR.Contract Unit Type is Weight-LB
     C           WN0127    IFEQ 'W'                        *IF
      * CASE: PAR.Total Weight Ordered USR GT PAR.Maximum Contract Units
     C           WN0123    IFGT WN0125                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C           WN0123    SUB  WN0125    YL0020           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0010           Price Code
     C                     Z-ADDYL0020    ZA0011           Weight Allocate
     C                     Z-ADDWN0125    ZA0012           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0013           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0013           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Contract Unit type = Quantity
      * CASE: PAR.Total Quantity Ordered GT PAR.Maximum Contract Units
     C           WN0124    IFGT WN0125                     *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C           WN0124    SUB  WN0125    YL0020           Weight Allocate
      * Setup message data for message
     C                     Z-ADD#1BVTM    ZA0014           Price Code
     C                     Z-ADDYL0020    ZA0015           Weight Allocate
     C                     Z-ADDWN0125    ZA0016           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0017           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0017           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Original code
      * OUT: No Errors
      * CASE: PAR.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
     C                     Z-ADDWN0126    #1BZPR           Price Overage O
      * CASE: PAR.PMH Price Type is Invoice Price
     C           YL0017    IFEQ 'I'                        *IF
     C                     Z-ADDWN0126    #1BZPR           Price Overage O
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     ELSE
      * CASE: PAR.PMH Price Type is Ceiling Price
     C           YL0017    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     #1BZPR           Price Overage O
     C                     Z-ADDWN0126    #1DWPR           OD Ceiling Pric
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process no errors
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * NOTE:  If this program changes to have Confirm, put this after up
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0217  30       Company Number
     C                     PARM #1C4NB    WQ0218  70       Order Number
     C                     PARM #1DPNB    WQ0219  30       Order Sequence
     C                     PARM #1UENB    WQ0220  30       Order Secondary
     C                     PARM #1HGCD    WQ0221  70       Item Code
     C                     PARM #1AJCD    WQ0222  3        Warehouse Code
     C                     PARM #1A5DT    WQ0223  70       Ship Date USR
     C                     PARM *ZERO     WQ0224 112       Quantity Ordere
     C                     PARM *ZERO     WQ0225 112       Weight Ordered
     C           #1CCQT    PARM #1CCQT    WQ0226 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0227 112       Weight Schedule
     C                     PARM 'OD'      WQ0228  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0229 10        PSAA Program Na
     C                     PARM #1RINY    WQ0230  40       Item Age Days
     C                     PARM #1TIDT    WQ0231  70       Production Ovr
     C                     PARM #1TJDT    WQ0232  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9836  *
     C                     END
      * *-------------------------------------------------*
     C                     ELSE
      * CASE: *OTHERWISE
      * Update allocations
      * CASE:
      *  - c1ORc2
      *   |- c1    : RCD.*SFLSEL is *Delete request
      *   |- c2    : RCD.Detail Line Status is Cancelled
      *   '-
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
     C           #1GMST    OREQ 'X'                        *OR
      * RMC 8/21/19 added check for if line is already cancelled-dont all
     C                     ELSE
      * CASE: *OTHERWISE
      * NOTE:  If this program changes to have Confirm, put this after up
      * FP1054-commented these...the new CASE will deallocate from the or
      *    warehouse and qty AND reallocate from the new whse,qty
      * Allocate or deallocate changes - fp1054 for qty,whse deallc all o
      * CASE:
      *  - (c1 ORc3)AND c2
      *   |- c1    : RCD.Quantity 11.2 USR NE RCD.Quantity Scheduled
      *   |- c3    : RCD.Warehouse Code NE RCD.USR Warehouse Code
      *   |- c2    : PGM.*Program mode is *CHANGE
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #RINQT    IFNE #1CCQT                     *IF
     C           #1AJCD    ORNE #RCPCD                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0233  30       Company Number
     C                     PARM #1C4NB    WQ0234  70       Order Number
     C                     PARM #1DPNB    WQ0235  30       Order Sequence
     C                     PARM #1UENB    WQ0236  30       Order Secondary
     C                     PARM #1HGCD    WQ0237  70       Item Code
     C                     PARM #RCPCD    WQ0238  3        Warehouse Code
     C                     PARM #1A5DT    WQ0239  70       Ship Date USR
     C                     PARM *ZERO     WQ0240 112       Quantity Ordere
     C                     PARM *ZERO     WQ0241 112       Weight Ordered
     C           #1CCQT    PARM #1CCQT    WQ0242 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0243 112       Weight Schedule
     C                     PARM 'OD'      WQ0244  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0245 10        PSAA Program Na
     C                     PARM #1RINY    WQ0246  40       Item Age Days
     C                     PARM #1TIDT    WQ0247  70       Production Ovr
     C                     PARM #1TJDT    WQ0248  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0249  30       Company Number
     C                     PARM #1C4NB    WQ0250  70       Order Number
     C                     PARM #1DPNB    WQ0251  30       Order Sequence
     C                     PARM #1UENB    WQ0252  30       Order Secondary
     C                     PARM #1HGCD    WQ0253  70       Item Code
     C                     PARM #1AJCD    WQ0254  3        Warehouse Code
     C                     PARM #1A5DT    WQ0255  70       Ship Date USR
     C                     PARM #RINQT    WQ0256 112       Quantity Ordere
     C                     PARM #RFHWG    WQ0257 112       Weight Ordered
     C           #1CCQT    PARM #1CCQT    WQ0258 112       Quantity Schedu
     C           #1AUWG    PARM #1AUWG    WQ0259 112       Weight Schedule
     C                     PARM 'OA'      WQ0260  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0261 10        PSAA Program Na
     C                     PARM #1RINY    WQ0262  40       Item Age Days
     C                     PARM #1TIDT    WQ0263  70       Production Ovr
     C                     PARM #1TJDT    WQ0264  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9836  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      *    no further action; quantity ordered = quantity allocated
     C                     END                             *FI
     C           #1AVQT    MULT #1AUPR    #1AYVA    H      Extended Amount
     C                     END                             *FI
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * PK0034
     C                     MOVEL#1AJCD    YL0006           Warehouse Code
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Warehouse Code required
     C           #1AJCD    IFEQ *BLANK                     IF
     C           *IN71     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9836  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      * Check reference to Warehouse Codes
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9836  *
     C                     END
      * Check reference to Customer Master
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Price Method Header
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Country Master
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9834  *
     C                     END
      * Check reference to Event Types
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to OP Reason Codes
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Ham Group Master
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record relations
      * Subfile options
      * CASE: RCD.*SFLSEL is *Comments
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * EDT Detail Comments    EF - Order Detail Comment  * 
     C                     CALL 'PDDWEFR'              90  EDT Detail Comm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0280  30       Company Number
     C                     PARM #1C4NB    WQ0281  70       Order Number
     C                     PARM #1DPNB    WQ0282  30       Order Sequence
     C                     PARM #1UENB    WQ0283  30       Order Secondary
     C                     PARM #1HGCD    WQ0284  70       Item Code
     C                     PARM #CUWTX    WQ0285 30        Ship To Name
     C                     PARM #1A5DT    WQ0286  70       Requested Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDWEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * DSP Ord   Detail Line  D1 - PD Order Detail  * 
     C                     CALL 'PDPYD1R'              90  DSP Order Entry
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0287  30       Company Number
     C                     PARM #1C4NB    WQ0288  70       Order Number
     C                     PARM #1DPNB    WQ0289  30       Order Sequence
     C                     PARM #1UENB    WQ0290  30       Order Secondary
     C                     PARM 'O/P'     WQ0291  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPYD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C                     MOVEL'N'       W0RSF
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     MOVEL*BLANK    #1SEL
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98
      *
      * Process change request
     C                     EXSR EECHRQ
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     ELSE
      * USER: Extra processing after DBF update
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * 10/20/05 PKD Always delete the line item.
      * 12/21/05 PKD Changed to not delete cancelled items.   Caused issu
      *              with Carlisle not getting the deletes. Commented out
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0008           Company Number
     C                     Z-ADD#1C4NB    WL0009           Order Number
     C                     Z-ADD#1DPNB    WL0010           Order Sequence
     C                     Z-ADD#1UENB    WL0011           Order Secondary
     C                     EXSR SNRVGN
      * Delete line or change line status
      * CASE: RCD.Detail Line Status is Entered
     C           #1GMST    IFEQ 'E'                        *IF
      * DEL PD Order Detail    DL - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0012           Company Number
     C                     Z-ADD#1C4NB    WL0013           Order Number
     C                     Z-ADD#1DPNB    WL0014           Order Sequence
     C                     Z-ADD#1UENB    WL0015           Order Secondary
     C                     EXSR SPDLRC
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0008           Company Number
     C                     Z-ADD#1C4NB    WL0009           Order Number
     C                     Z-ADD#1DPNB    WL0010           Order Sequence
     C                     Z-ADD#1UENB    WL0011           Order Secondary
     C                     EXSR SNRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1GMST    #1GNST           Detail Line Sta
     C                     MOVEL'X'       #1GMST           Detail Line Sta
      * CHG Detail Status      CH - PD Order Detail  * 
     C                     EXSR SQCHRC
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0008           Company Number
     C                     Z-ADD#1C4NB    WL0009           Order Number
     C                     Z-ADD#1DPNB    WL0010           Order Sequence
     C                     Z-ADD#1UENB    WL0011           Order Secondary
     C                     EXSR SNRVGN
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1KXCD    YL0007           USR Country Cod
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG PD Order Detail    CH - Order Detail  * 
     C                     EXSR SRCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
     C                     MOVEL*IN87     *IN76
     C           #RGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           #1UENB    IFEQ 1                          *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL*IN87     *IN74
     C           #1GMST    IFEQ 'X'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL*IN87     *IN73
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL*IN87     *IN72
     C           #RTJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL*IN87     *IN71
     C           #RTIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL*IN87     *IN70
     C           #RXRCD    IFNE 'UNID'                     *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           #CNVDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           #CBUTM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     MOVEL*BLANK    #RGGST           USR Display fie
     C                     Z-ADD*ZERO     #1DZPR           OD Original Ord
     C                     Z-ADD*ZERO     #RINQT           Quantity 11.2 U
     C                     Z-ADD*ZERO     #RFHWG           Weight 11.2 USR
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     Z-ADD*ZERO     #1DPNB           Order Sequence
     C                     Z-ADD*ZERO     #1UENB           Order Secondary
     C                     Z-ADD*ZERO     #1AKPR           Unit Price
     C                     MOVEL*BLANK    #RTJST           USR Display 2
     C                     MOVEL*BLANK    #RCPCD           USR Warehouse C
     C                     MOVEL*BLANK    #RTIST           USR Display 1
     C                     Z-ADDP1BKC7    #1BKC7           Ship To Custome
     C                     Z-ADD*ZERO     #1CFC7           Order Group Cod
     C                     MOVEL*BLANK    #RXRCD           Primal Group Co
     C                     MOVEL*BLANK    #1GNST           Detail Line Sta
     C                     Z-ADD*ZERO     #1MAVA           Billing Detail
     C                     Z-ADD*ZERO     #1KDVA           Billing Detail
     C                     Z-ADD*ZERO     #1L8VA           Billing Detail
     C                     Z-ADD*ZERO     #1L9VA           Quantity to Sub
     C                     MOVEL*BLANK    #1GTST           Comment Print A
     C                     MOVEL*BLANK    #1GVST           Comment Print I
     C                     MOVEL*BLANK    #1GUST           Comment Print P
     C                     MOVEL*BLANK    #1QFST           Comment Print S
     C                     Z-ADD*ZERO     #1EXDT           Market Pricing
     C                     MOVEL*BLANK    #1LQCD           Commodity Marke
     C                     MOVEL*BLANK    #1RDCD           Date Method Cod
     C                     MOVEL*BLANK    #1Q7CD           Price Method Co
     C                     Z-ADD*ZERO     #1BZPR           Price Overage O
     C                     Z-ADD*ZERO     #1L6NB           Contract Number
     C                     MOVEL*BLANK    #1U1ST           Price Status
     C                     Z-ADD*ZERO     #1GIDT           Pricing Date Us
     C                     MOVEL*BLANK    #1CRCD           U_M_Base Price
     C                     MOVEL*BLANK    #1AGCD           U_M_Ordered
     C                     MOVEL*BLANK    #1RZST           Work Confirm St
     C                     MOVEL*BLANK    #1R0ST           Work Over_Short
     C                     MOVEL*BLANK    #1R1ST           OD Production P
     C                     MOVEL*BLANK    #1G8NA           Order Desc_Line
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     MOVEL*BLANK    #1VEST           Palletize
     C                     MOVEL*BLANK    #1VGST           Slip Sheet
     C                     MOVEL*BLANK    #1AVST           Catch Weight St
     C                     MOVEL*BLANK    #1U0ST           Price Audit
     C                     MOVEL*BLANK    #1RFCD           Price Audit Rea
     C                     MOVEL*BLANK    #1FZST           Production Date
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     Z-ADD*ZERO     #1AVQT           Quantity Ordere
     C                     Z-ADD*ZERO     #1D0WG           Weight Ordered
     C                     Z-ADD*ZERO     #1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     #1AUWG           Weight Schedule
     C                     Z-ADD*ZERO     #1CBQT           Quantity Shippe
     C                     Z-ADD*ZERO     #1ATWG           Weight Shipped
     C                     Z-ADD*ZERO     #1AQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     #1AGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     #1ALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     #1AUPR           Unit Price Orde
     C                     Z-ADD*ZERO     #1AVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     #1A4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     #1A5DT           Requested Ship
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     MOVEL*BLANK    #1AMST           Affect Inventor
     C                     MOVEL*BLANK    #1ANST           Affect Sales Do
     C                     MOVEL*BLANK    #1VAST           Affect Sales Pn
     C                     Z-ADD*ZERO     #1RGNB           Item Structure
     C                     Z-ADD*ZERO     #1RHNB           Item Structure
     C                     Z-ADD*ZERO     #1RINB           Item Structure
     C                     MOVEL*BLANK    #1RBCD           Item Level
     C                     MOVEL*BLANK    #1HICD           Quality Level
     C                     MOVEL*BLANK    #1RNCD           Pricing Product
     C                     MOVEL*BLANK    #1ROCD           Season Product
     C                     Z-ADD*ZERO     #1CXDT           Date of Origina
     C                     MOVEL*BLANK    #1AJVN           User Profile Na
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #1Z1ST           Modified Flag
     C                     MOVEL*BLANK    #1Z3ST           Substituted Fla
     C                     MOVEL*BLANK    #1Z4ST           OD Schedule Ove
     C                     Z-ADD*ZERO     #1DUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     #1B6VL           Invoice Extende
     C                     Z-ADD*ZERO     #1A1AA           Ham Group Numbe
     C                     MOVEL*BLANK    #1FZSX           OD Adj Type Ove
     C                     MOVEL*BLANK    #1F0SX           Affect Trade Fu
     C                     MOVEL*BLANK    #1F1SX           Affect Commissi
     C                     MOVEL*BLANK    #1F2SX           Affect Pricing
     C                     MOVEL*BLANK    #1F3SX           Released by Use
     C                     MOVEL*BLANK    #1F4SX           Ord TF Exempt C
     C                     MOVEL*BLANK    #1F5SX           OD Pallet Type
     C                     MOVEL*BLANK    #1F6SX           Production Ware
     C                     MOVEL*BLANK    #1F7SX           OD Price Type
     C                     Z-ADD*ZERO     #1NTDT           Warehouse Palle
     C                     Z-ADD*ZERO     #1NUDT           Consumed Item C
     C                     Z-ADD*ZERO     #1NVDT           Deadline Depart
     C                     Z-ADD*ZERO     #1NWDT           OD Price Type R
     C                     Z-ADD*ZERO     #1NXDT           OD Firm Date
     C                     Z-ADD*ZERO     #1BUTM           Deadline Depart
     C                     Z-ADD*ZERO     #1BVTM           Price Code
     C                     Z-ADD*ZERO     #1BXTM           Substitution Li
     C                     Z-ADD*ZERO     #1BYTM           Max Qty to sche
     C                     Z-ADD*ZERO     #1H5NX           Warehouse Palle
     C                     Z-ADD*ZERO     #1H6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     #1H7NX           OD Item Target
     C                     Z-ADD*ZERO     #1H8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     #1H9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     #1DVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     #1DWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     #1DXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     #1DYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     #1GSPR           OD Cancel Date
     C                     Z-ADD*ZERO     #1GTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     #1GUPR           OD Unused Prc 8
     C                     MOVEL*BLANK    #1HOST           OD MPR Sent to
     C                     MOVEL*BLANK    #1HPST           OD MPR Prc Read
     C                     MOVEL*BLANK    #1IOST           OD UnUsed Price
     C                     Z-ADD*ZERO     #1PEWG           Weight Amount E
     C                     Z-ADD*ZERO     #1RINY           Item Age Days
     C                     Z-ADD*ZERO     #1TIDT           Production Ovr
     C                     Z-ADD*ZERO     #1TJDT           Production Ovr
     C                     MOVEL*BLANK    #1H2ST           OD Spot Buy
     C                     MOVEL*BLANK    #1H0ST           OD Clm Full Ret
     C                     MOVEL*BLANK    #1H1ST           Order Line Erro
     C                     Z-ADD*ZERO     #1TKDT           OD Market Begin
     C                     Z-ADD*ZERO     #1TLDT           OD Market Endin
     C                     Z-ADD*ZERO     #1TMDT           OD Atch to Ord
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RHHQT           Qty Ordered USR
     C                     Z-ADD*ZERO     #REDNZ           OD Original Ord
     C                     Z-ADD*ZERO     #RH1QT           Scheduled Quant
     C                     Z-ADD*ZERO     #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     Z-ADD*ZERO     #RDTPR           Unit Price (DSP
     C                     Z-ADD*ZERO     #1AYVA           Extended Amount
     C                     Z-ADD*ZERO     #REVWG           Weight Schedule
     C                     MOVEL*BLANK    #1KXCD           Country Code
     C                     Z-ADD*ZERO     #1BWTM           Maximum Net Wei
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     MOVEL*BLANK    #1GMST           Detail Line Sta
     C                     MOVEL*BLANK    #1G7NA           Order Desc_Line
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BGWKL1 fields to subfile
      *================================================================
     C                     Z-ADDOMDZPR    #1DZPR           OD Original Ord
     C                     Z-ADDOMAIC3    #1AIC3           Company Number
     C                     Z-ADDOMC4NB    #1C4NB           Order Number
     C                     Z-ADDOMDPNB    #1DPNB           Order Sequence
     C                     Z-ADDOMUENB    #1UENB           Order Secondary
     C                     Z-ADDOMAKPR    #1AKPR           Unit Price
     C                     Z-ADDOMBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDOMCFC7    #1CFC7           Order Group Cod
     C                     MOVELOMGNST    #1GNST           Detail Line Sta
     C                     Z-ADDOMMAVA    #1MAVA           Billing Detail
     C                     Z-ADDOMKDVA    #1KDVA           Billing Detail
     C                     Z-ADDOML8VA    #1L8VA           Billing Detail
     C                     Z-ADDOML9VA    #1L9VA           Quantity to Sub
     C                     MOVELOMGTST    #1GTST           Comment Print A
     C                     MOVELOMGVST    #1GVST           Comment Print I
     C                     MOVELOMGUST    #1GUST           Comment Print P
     C                     MOVELOMQFST    #1QFST           Comment Print S
     C                     Z-ADDOMEXDT    #1EXDT           Market Pricing
     C                     MOVELOMLQCD    #1LQCD           Commodity Marke
     C                     MOVELOMRDCD    #1RDCD           Date Method Cod
     C                     MOVELOMQ7CD    #1Q7CD           Price Method Co
     C                     Z-ADDOMBZPR    #1BZPR           Price Overage O
     C                     Z-ADDOML6NB    #1L6NB           Contract Number
     C                     MOVELOMU1ST    #1U1ST           Price Status
     C                     Z-ADDOMGIDT    #1GIDT           Pricing Date Us
     C                     MOVELOMCRCD    #1CRCD           U_M_Base Price
     C                     MOVELOMAGCD    #1AGCD           U_M_Ordered
     C                     MOVELOMRZST    #1RZST           Work Confirm St
     C                     MOVELOMR0ST    #1R0ST           Work Over_Short
     C                     MOVELOMR1ST    #1R1ST           OD Production P
     C                     MOVELOMG8NA    #1G8NA           Order Desc_Line
     C                     MOVELOMRPCD    #1RPCD           Age Code
     C                     MOVELOMVEST    #1VEST           Palletize
     C                     MOVELOMVGST    #1VGST           Slip Sheet
     C                     MOVELOMAVST    #1AVST           Catch Weight St
     C                     MOVELOMU0ST    #1U0ST           Price Audit
     C                     MOVELOMRFCD    #1RFCD           Price Audit Rea
     C                     MOVELOMFZST    #1FZST           Production Date
     C                     Z-ADDOMR1NB    #1R1NB           Rated Freight
     C                     Z-ADDOMAVQT    #1AVQT           Quantity Ordere
     C                     Z-ADDOMD0WG    #1D0WG           Weight Ordered
     C                     Z-ADDOMCCQT    #1CCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    #1AUWG           Weight Schedule
     C                     Z-ADDOMCBQT    #1CBQT           Quantity Shippe
     C                     Z-ADDOMATWG    #1ATWG           Weight Shipped
     C                     Z-ADDOMAQCS    #1AQCS           Unit Cost Prici
     C                     Z-ADDOMAGCS    #1AGCS           Unit Cost Per P
     C                     Z-ADDOMALPR    #1ALPR           Unit Price_Cred
     C                     Z-ADDOMAUPR    #1AUPR           Unit Price Orde
     C                     Z-ADDOMAVWG    #1AVWG           Unit Weight Ord
     C                     Z-ADDOMA4WG    #1A4WG           Tare Weight Tot
     C                     Z-ADDOMA5DT    #1A5DT           Requested Ship
     C                     Z-ADDOMAODT    #1AODT           Scheduled Ship
     C                     Z-ADDOMGNDT    #1GNDT           Actual Shipped
     C                     MOVELOMAMST    #1AMST           Affect Inventor
     C                     MOVELOMANST    #1ANST           Affect Sales Do
     C                     MOVELOMVAST    #1VAST           Affect Sales Pn
     C                     Z-ADDOMRGNB    #1RGNB           Item Structure
     C                     Z-ADDOMRHNB    #1RHNB           Item Structure
     C                     Z-ADDOMRINB    #1RINB           Item Structure
     C                     MOVELOMRBCD    #1RBCD           Item Level
     C                     MOVELOMHICD    #1HICD           Quality Level
     C                     MOVELOMRNCD    #1RNCD           Pricing Product
     C                     MOVELOMROCD    #1ROCD           Season Product
     C                     Z-ADDOMCXDT    #1CXDT           Date of Origina
     C                     MOVELOMAJVN    #1AJVN           User Profile Na
     C                     MOVELOMJPCD    #1JPCD           Event Code
     C                     MOVELOMCQCD    #1CQCD           Reason Code
     C                     MOVELOMR4CD    #1R4CD           Sales Route Cod
     C                     MOVELOMZ1ST    #1Z1ST           Modified Flag
     C                     MOVELOMZ3ST    #1Z3ST           Substituted Fla
     C                     MOVELOMZ4ST    #1Z4ST           OD Schedule Ove
     C                     Z-ADDOMDUPR    #1DUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    #1B6VL           Invoice Extende
     C                     Z-ADDOMA1AA    #1A1AA           Ham Group Numbe
     C                     MOVELOMFZSX    #1FZSX           OD Adj Type Ove
     C                     MOVELOMF0SX    #1F0SX           Affect Trade Fu
     C                     MOVELOMF1SX    #1F1SX           Affect Commissi
     C                     MOVELOMF2SX    #1F2SX           Affect Pricing
     C                     MOVELOMF3SX    #1F3SX           Released by Use
     C                     MOVELOMF4SX    #1F4SX           Ord TF Exempt C
     C                     MOVELOMF5SX    #1F5SX           OD Pallet Type
     C                     MOVELOMF6SX    #1F6SX           Production Ware
     C                     MOVELOMF7SX    #1F7SX           OD Price Type
     C                     Z-ADDOMNTDT    #1NTDT           Warehouse Palle
     C                     Z-ADDOMNUDT    #1NUDT           Consumed Item C
     C                     Z-ADDOMNVDT    #1NVDT           Deadline Depart
     C                     Z-ADDOMNWDT    #1NWDT           OD Price Type R
     C                     Z-ADDOMNXDT    #1NXDT           OD Firm Date
     C                     Z-ADDOMBUTM    #1BUTM           Deadline Depart
     C                     Z-ADDOMBVTM    #1BVTM           Price Code
     C                     Z-ADDOMBXTM    #1BXTM           Substitution Li
     C                     Z-ADDOMBYTM    #1BYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    #1H5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    #1H6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    #1H7NX           OD Item Target
     C                     Z-ADDOMH8NX    #1H8NX           OD Estimated Gr
     C                     Z-ADDOMH9NX    #1H9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    #1DVPR           Order Gate_Fina
     C                     Z-ADDOMDWPR    #1DWPR           OD Ceiling Pric
     C                     Z-ADDOMDXPR    #1DXPR           OD Gate_Final P
     C                     Z-ADDOMDYPR    #1DYPR           OD Weighted Avg
     C                     Z-ADDOMGSPR    #1GSPR           OD Cancel Date
     C                     Z-ADDOMGTPR    #1GTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    #1GUPR           OD Unused Prc 8
     C                     MOVELOMHOST    #1HOST           OD MPR Sent to
     C                     MOVELOMHPST    #1HPST           OD MPR Prc Read
     C                     MOVELOMIOST    #1IOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    #1PEWG           Weight Amount E
     C                     Z-ADDOMRINY    #1RINY           Item Age Days
     C                     Z-ADDOMTIDT    #1TIDT           Production Ovr
     C                     Z-ADDOMTJDT    #1TJDT           Production Ovr
     C                     MOVELOMH2ST    #1H2ST           OD Spot Buy
     C                     MOVELOMH0ST    #1H0ST           OD Clm Full Ret
     C                     MOVELOMH1ST    #1H1ST           Order Line Erro
     C                     Z-ADDOMTKDT    #1TKDT           OD Market Begin
     C                     Z-ADDOMTLDT    #1TLDT           OD Market Endin
     C                     Z-ADDOMTMDT    #1TMDT           OD Atch to Ord
     C                     MOVELOMUVST    #1UVST           EDI Status 1
     C                     MOVELOMUWST    #1UWST           EDI Status 2
     C                     MOVELOMUXST    #1UXST           EDI Status 3
     C                     Z-ADDOMAATM    #1AATM           Job Time
     C                     MOVELOMAYNA    #1AYNA           User Id
     C                     MOVELOMA0NA    #1A0NA           Job Name
     C                     Z-ADDOMAXDT    #1AXDT           Job Date
     C                     Z-ADDOMHGCD    #1HGCD           Item Code
     C                     Z-ADDOMAYVA    #1AYVA           Extended Amount
     C                     MOVELOMKXCD    #1KXCD           Country Code
     C                     Z-ADDOMBWTM    #1BWTM           Maximum Net Wei
     C                     MOVELOMAJCD    #1AJCD           Warehouse Code
     C                     MOVELOMGMST    #1GMST           Detail Line Sta
     C                     MOVELOMG7NA    #1G7NA           Order Desc_Line
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #2XIST           Credit Hold
     C                     MOVEL*BLANK    #2XJST           Production Hold
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #2U2ST           Export Status
     C                     MOVEL*BLANK    #2HNNA           Ship To City
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
     C                     Z-ADD*ZERO     #2AFTM           Requested Deliv
     C                     MOVEL*BLANK    #2GJST           Order in Use
     C                     Z-ADD*ZERO     #2DPNB           Order Sequence
     C                     Z-ADD*ZERO     #2UENB           Order Secondary
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CAGTX           USR Company Nam
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     MOVEL*BLANK    #2JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     #CK3DT           USR Requested D
      * Clear external version also
     C                     Z-ADD*ZERO     VCK3DT
     C                     Z-ADD*ZERO     #CRUNY           Usr Request Del
     C                     Z-ADDP1BKC7    #PBKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    VPBKC7
     C                     MOVEL*BLANK    #CUWTX           Ship To Name
     C                     Z-ADD*ZERO     #CAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     #CCZDT           USR Requested s
      * Clear external version also
     C                     Z-ADD*ZERO     VCCZDT
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     Z-ADD*ZERO     #CD0WG           Weight Ordered
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCHODT
     C                     Z-ADD*ZERO     #CAUWG           Weight Schedule
     C                     Z-ADD*ZERO     #CNVDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     VCNVDT
     C                     Z-ADD*ZERO     #CBUTM           Deadline Depart
      * Check restriction within
     C                     EXSR VJCKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert USR Requested Deliver Dte to display format
      * Convert date
     C           1000000   ADD  #CK3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCK3DT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert USR Requested ship date s to display format
      * Convert date
     C           1000000   ADD  #CCZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCCZDT
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCHODT
      * Convert Deadline Depart Date LH to display format
      * Convert date
     C           1000000   ADD  #CNVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCNVDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CAGTX           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #CAGTX           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV for Order Dtl Ent. RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    BEAIC3           Company Number
     C                     Z-ADDP1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEJNCD    P1JNCD           Order Type_Sale
     C                     Z-ADDBEA0DT    WUA0DT           Order Date
     C                     Z-ADDBEA5DT    P1A5DT           Requested Ship
     C                     MOVELBEGTST    P1GTST           Comment Print A
     C                     MOVELBEGVST    P1GVST           Comment Print I
     C                     MOVELBEGUST    P1GUST           Comment Print P
     C                     MOVELBEQFST    P1QFST           Comment Print S
     C                     Z-ADDBEAODT    WUAODT           Scheduled Ship
     C                     Z-ADDBEJZVA    P1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    P1A1WG           Order Weight To
     C                     Z-ADDBEEIDT    #2EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #2AFTM           Requested Deliv
     C                     Z-ADDBERMNB    P1RMNB           Load ID
     C                     MOVELBEQ2CD    P1Q2CD           Shipping Method
     C                     MOVELBEVEST    P1VEST           Palletize
     C                     MOVELBEVFST    WUVFST           Shrink Wrap
     C                     MOVELBEVGST    P1VGST           Slip Sheet
     C                     Z-ADDBERNNB    P1RNNB           Reefer Temperat
     C                     MOVELBEVDST    P1VDST           Load Type
     C                     MOVELBEJPCD    P1JPCD           Event Code
     C                     MOVELBEXUST    P1XUST           Trans Contol AS
     C                     MOVELBEOBST    P1OBST           Billing Activit
     C                     MOVELBEBCST    P1BCST           Block Order Fla
     C                     MOVELBEFSSX    P1FSSX           Broker Order St
     C                     MOVELBEFVSX    P1FVSX           OH Load Plan Re
     C                     MOVELBEFXSX    P1FXSX           HPB Ship to War
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#PBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CUWTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    #CUWTX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Co/Customer Type - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#2AIC3    EOAIC3           Company Number
     C                     Z-ADD#PBKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     MOVEL*BLANK    WUBOCD           Type Code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    WUBOCD           Type Code
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SDEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#2AIC3    EOAIC3           Company Number
     C                     Z-ADD#PBKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P9CPCD           Warehouse Code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOAJCD    P9CPCD           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Weight Ord & Sched RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0006           Weight Ordered
     C                     Z-ADD*ZERO     WL0007           Weight Schedule
     C                     Z-ADD*ZERO     WL0005           Quantity Ordere
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSF01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSF01           Company Number
     C                     Z-ADDWL0002    WQSF02           Order Number
     C                     Z-ADDWL0003    OMDPNB           Order Sequence
     C                     Z-ADDWL0004    OMUENB           Order Secondary
      * Establish starting position
     C           KPSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Avail/Alloc/Enter/Hold
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C                     ADD  OMAVQT    WL0005           Quantity Ordere
     C                     ADD  OMD0WG    WL0006           Weight Ordered
     C                     ADD  OMAUWG    WL0007           Weight Schedule
     C                     END                             *FI
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Val Mkt Accrual Exist RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0003           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN HOBKC7    WQSG01           Ship To Custome
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Ship To Custome
      * Setup key
     C                     Z-ADD#PBKC7    WQSG01           Ship To Custome
      * Establish starting position
     C           KRSSG     SETLL@HORELA                    *
     C           KRSSG     READE@HORELA                  90*
      * Data record not found
     C   90                MOVEL'USR1520' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Accrual Info       RT - Accrual Code Master  * 
     C                     EXSR SHRVGN
      * New for DLY029   6/19/07 RMC
      * CASE: LCL.Affect Invoice Price is yes
     C           YL0005    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0003           Record Found US
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@HORELA                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Accrual Info       RT - Accrual Code Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           HLOJCD           Accrual Code
      * Setup key
     C                     MOVELHOOJCD    HLOJCD           Accrual Code
      * Establish starting position
     C           KRSSH     CHAIN@HLREK4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Accrual Type
     C                     MOVEL*BLANK    YL0005           Affect Invoice
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELHLOKCD    YL0004           Accrual Type
     C                     MOVELHLFFTX    YL0005           Affect Invoice
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Primal Grp Code   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    BZAIC3           Company Number
     C                     Z-ADD#1HGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSI     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RXRCD           Primal Group Co
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZXRCD    #RXRCD           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * CHG Order Value,Wgt    CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0002  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Order in Use
     C                     MOVEL*BLANK    WN0034  1        Header Status
     C                     MOVEL*BLANK    WN0035  1        Header Status L
     C                     MOVEL*BLANK    WN0036  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     MOVEL*BLANK    WN0040  1        Credit Hold
     C                     MOVEL*BLANK    WN0041  1        Production Hold
     C                     MOVEL*BLANK    WN0042  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0043  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0044  40       Requested Deliv
     C                     MOVEL*BLANK    WN0045  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0046 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0047  70       Load ID
     C                     Z-ADD*ZERO     WN0048  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0049 112       Rated Freight
     C                     MOVEL*BLANK    WN0050  1        LTL Flag
     C                     MOVEL*BLANK    WN0051  1        Price Audit
     C                     MOVEL*BLANK    WN0052  1        Price Status
     C                     MOVEL*BLANK    WN0053  2        Shipping Method
     C                     MOVEL*BLANK    WN0054  1        Export Status
     C                     MOVEL*BLANK    WN0055  1        Palletize
     C                     MOVEL*BLANK    WN0056  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0057  1        Slip Sheet
     C                     MOVEL*BLANK    WN0058  1        Age Code
     C                     Z-ADD*ZERO     WN0059  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0060  1        Load Type
     C                     Z-ADD*ZERO     WN0061  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0062  1        Load Plan Order
     C                     MOVEL*BLANK    WN0063  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0064  70       Resell Referenc
     C                     MOVEL*BLANK    WN0065 30        Special Comment
     C                     MOVEL*BLANK    WN0066 30        Special Comment
     C                     MOVEL*BLANK    WN0067  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0068  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0069  2        Manager Level C
     C                     MOVEL*BLANK    WN0070  3        VP Level Code
     C                     Z-ADD*ZERO     WN0071  70       Attach to Order
     C                     MOVEL*BLANK    WN0072  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0073  70       Invoice Number
     C                     MOVEL*BLANK    WN0074  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0075  70       Invoice Date
     C                     MOVEL*BLANK    WN0076  2        Event Code
     C                     MOVEL*BLANK    WN0077  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0078  1        Modified Flag
     C                     Z-ADD*ZERO     WN0079 112       A_R order Value
     C                     MOVEL*BLANK    WN0080  1        Billing Activit
     C                     MOVEL*BLANK    WN0081  1        Block Order Fla
     C                     MOVEL*BLANK    WN0082  1        Order Certifica
     C                     Z-ADD*ZERO     WN0083 112       Invoice Order V
     C                     MOVEL*BLANK    WN0084  1        Process Sts for
     C                     MOVEL*BLANK    WN0085  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0086  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0087  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0088  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0089  1        Email Cust On O
     C                     MOVEL*BLANK    WN0090  1        Order Emailed
     C                     MOVEL*BLANK    WN0091  1        Export Docs Go
     C                     MOVEL*BLANK    WN0092  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0093  1        Broker Order St
     C                     MOVEL*BLANK    WN0094  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0095  2        Order Requires
     C                     MOVEL*BLANK    WN0096  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0097  2        Export USDA App
     C                     MOVEL*BLANK    WN0098  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0099  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0100  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0101  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0102  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0103  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0104  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0105  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0106  60       Time of Origina
     C                     Z-ADD*ZERO     WN0107  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0108  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0109  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0110 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0111 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0112 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0113 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0114 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0115  70       Claim Number
     C                     MOVEL*BLANK    WN0116  1        EDI Status 1
     C                     MOVEL*BLANK    WN0117  1        EDI Status 2
     C                     MOVEL*BLANK    WN0118  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0119  60       Job Time
     C                     MOVEL*BLANK    WN0120 10        User Id
     C                     MOVEL*BLANK    WN0121 10        Job Name
     C                     Z-ADD*ZERO     WN0122  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#2AIC3    WAAIC3           Company Number
     C                     Z-ADD#2C4NB    WAC4NB           Order Number
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C           KLCHSJ    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDP1JZVA    WAJZVA           Order Value Tot
     C                     Z-ADDP1A1WG    WAA1WG           Order Weight To
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWAAIC3    PAAIC3           Company Number
     C                     Z-ADDWAC4NB    PAC4NB           Order Number
     C                     MOVELWAJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWAANC7    PAANC7           AR Customer Num
     C                     Z-ADDWABKC7    PABKC7           Ship To Custome
     C                     MOVELWABRTX    PABRTX    P      Ship To Name
     C                     MOVELWAHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWAHONA    PAHONA    P      Ship To Address
     C                     MOVELWAHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWAHNNA    PAHNNA    P      Ship To City
     C                     MOVELWADBCD    PADBCD    P      Ship To State C
     C                     MOVELWACKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWAB0C7    PAB0C7           Bill to Custome
     C                     MOVELWAAETX    PAAETX    P      Bill to Name
     C                     MOVELWAB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWAB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWAB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWAB2NA    PAB2NA    P      Bill to City
     C                     MOVELWABHCD    PABHCD    P      Bill to State C
     C                     MOVELWAC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWABCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWAA0DT    PAA0DT           Order Date
     C                     Z-ADDWAA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWAGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWAACDT    PAACDT           Cancel Date
     C                     MOVELWAAQCD    PAAQCD    P      Terms Code
     C                     MOVELWAB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWABYNA    PABYNA    P      Special Instruc
     C                     MOVELWABZNA    PABZNA    P      Carrier Code
     C                     MOVELWAGTST    PAGTST    P      Comment Print A
     C                     MOVELWAGVST    PAGVST    P      Comment Print I
     C                     MOVELWAGUST    PAGUST    P      Comment Print P
     C                     MOVELWAQFST    PAQFST    P      Comment Print S
     C                     MOVELWACQCD    PACQCD    P      Reason Code
     C                     MOVELWAGJST    PAGJST    P      Order in Use
     C                     MOVELWAGWST    PAGWST    P      Header Status
     C                     MOVELWAGXST    PAGXST    P      Header Status L
     C                     MOVELWAGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWAAODT    PAAODT           Scheduled Ship
     C                     MOVELWAAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWACXDT    PACXDT           Date of Origina
     C                     Z-ADDWAJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWAA1WG    PAA1WG           Order Weight To
     C                     MOVELWAXIST    PAXIST    P      Credit Hold
     C                     MOVELWAXJST    PAXJST    P      Production Hold
     C                     MOVELWAXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWAEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWAAFTM    PAAFTM           Requested Deliv
     C                     MOVELWAE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWAE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWARMNB    PARMNB           Load ID
     C                     Z-ADDWATBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWAR1NB    PAR1NB           Rated Freight
     C                     MOVELWAPJST    PAPJST    P      LTL Flag
     C                     MOVELWAU0ST    PAU0ST    P      Price Audit
     C                     MOVELWAU1ST    PAU1ST    P      Price Status
     C                     MOVELWAQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWAU2ST    PAU2ST    P      Export Status
     C                     MOVELWAVEST    PAVEST    P      Palletize
     C                     MOVELWAVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWAVGST    PAVGST    P      Slip Sheet
     C                     MOVELWARPCD    PARPCD    P      Age Code
     C                     Z-ADDWARNNB    PARNNB           Reefer Temperat
     C                     MOVELWAVDST    PAVDST    P      Load Type
     C                     Z-ADDWAATIN    PAATIN           Attach to Invoi
     C                     MOVELWAU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWAU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWARSRN    PARSRN           Resell Referenc
     C                     MOVELWAMHNA    PAMHNA    P      Special Comment
     C                     MOVELWAMINA    PAMINA    P      Special Comment
     C                     MOVELWAWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWAR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWABFCD    PABFCD    P      Manager Level C
     C                     MOVELWAQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWAT3NB    PAT3NB           Attach to Order
     C                     MOVELWASICD    PASICD    P      Reason for Pric
     C                     Z-ADDWACONB    PACONB           Invoice Number
     C                     MOVELWACEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWAAWDT    PAAWDT           Invoice Date
     C                     MOVELWAJPCD    PAJPCD    P      Event Code
     C                     MOVELWAXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWAZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWAVRVA    PAVRVA           A_R order Value
     C                     MOVELWAOBST    PAOBST    P      Billing Activit
     C                     MOVELWABCST    PABCST    P      Block Order Fla
     C                     MOVELWABDST    PABDST    P      Order Certifica
     C                     Z-ADDWAB7VL    PAB7VL           Invoice Order V
     C                     MOVELWAGASX    PAGASX    P      Process Sts for
     C                     MOVELWAGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWAGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWAGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWAFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWAFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWAFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWAFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWAFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWAFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWAFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWAFUSX    PAFUSX    P      Order Requires
     C                     MOVELWAFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWAFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWAFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWAFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWANODT    PANODT           OH Appt Confirm
     C                     Z-ADDWANPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWANQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWANRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWANSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWABPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWABQTM    PABQTM           Time of Origina
     C                     Z-ADDWABRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWABSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWABTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWAH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWAH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWAH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWAH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWAH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWAC0C7    PAC0C7           Claim Number
     C                     MOVELWAUVST    PAUVST    P      EDI Status 1
     C                     MOVELWAUWST    PAUWST    P      EDI Status 2
     C                     MOVELWAUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWAAATM    PAAATM           Job Time
     C                     MOVELWAAYNA    PAAYNA    P      User Id
     C                     MOVELWAA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWAAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Actv Descr, Ctrl   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    WUG0TX           Warehouse Descr
     C                     MOVELADXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Max Wt and price  RT - Customer Price Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           C7BKC7           Ship To Custome
     C                     KFLD           C7BVTM           Price Code
     C                     KFLD           C7HGCD           Item Code
      * Setup key
     C                     Z-ADD#1BKC7    C7BKC7           Ship To Custome
     C                     Z-ADD#1BVTM    C7BVTM           Price Code
     C                     Z-ADD#1HGCD    C7HGCD           Item Code
      * Establish starting position
     C           KRSSL     CHAIN@C7RESR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3292' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0012           Maximum Contrac
     C                     Z-ADD*ZERO     YL0013           Customer Price_
     C                     MOVEL*BLANK    YL0014           Commodity Marke
     C                     MOVEL*BLANK    YL0015           Price Method Co
     C                     MOVEL*BLANK    YL0016           Date Method Cod
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDC7KWWG    YL0012           Maximum Contrac
     C                     Z-ADDC7FIPR    YL0013           Customer Price_
     C                     MOVELC7LQCD    YL0014           Commodity Marke
     C                     MOVELC7Q7CD    YL0015           Price Method Co
     C                     MOVELC7RDCD    YL0016           Date Method Cod
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SLEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    IHAIC3           Company Number
     C                     MOVELYL0019    IHQ7CD           Price Method Co
      * Establish starting position
     C           KRSSM     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P6V8ST           Price Method Ty
     C                     MOVEL*BLANK    YL0017           PMH Price Type
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIHV8ST    P6V8ST           Price Method Ty
     C                     MOVELIHH3ST    YL0017           PMH Price Type
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN MSAIC3    WQSN01           Company Number
     C           *LIKE     DEFN MSC4NB    WQSN02           Order Number
     C           *LIKE     DEFN MSDPNB    WQSN03           Order Sequence
     C           *LIKE     DEFN MSUENB    WQSN04           Order Secondary
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
     C                     KFLD           WQSN03           Order Sequence
     C                     KFLD           WQSN04           Order Secondary
      * Setup key
     C                     Z-ADDWL0008    WQSN01           Company Number
     C                     Z-ADDWL0009    WQSN02           Order Number
     C                     Z-ADDWL0010    WQSN03           Order Sequence
     C                     Z-ADDWL0011    WQSN04           Order Secondary
      * Establish starting position
     C           KRSSN     SETLL@MSREX2                    *
     C           KRSSN     READE@MSREX2                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
     C                     EXSR SODLRC
     C           KRSSN     READE@MSREX2                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SODLRC    BEGSR
      *================================================================
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @MSREW4
     C                     Z-ADDMSAIC3    WCAIC3           Company Number
     C                     Z-ADDMSC4NB    WCC4NB           Order Number
     C                     MOVELMSDGSX    WCDGSX           ED Export Docum
     C                     MOVELMSKXCD    WCKXCD           Country Code
     C                     Z-ADDMSDPNB    WCDPNB           Order Sequence
     C                     Z-ADDMSUENB    WCUENB           Order Secondary
      *
     C           KLDLSO    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDGSX           ED Export Docum
     C                     KFLD           WCKXCD           Country Code
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C           KLDLSO    CHAIN@MSREW4              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMSREL0'MDACP
     C                     MOVEL'@MSREW4' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@MSREW4                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPDLRC    BEGSR
      *================================================================
      * DEL PD Order Detail    DL - PD Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0012    OMAIC3           Company Number
     C                     Z-ADDWL0013    OMC4NB           Order Number
     C                     Z-ADDWL0014    OMDPNB           Order Sequence
     C                     Z-ADDWL0015    OMUENB           Order Secondary
      *
     C           KLDLSP    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLDLSP    CHAIN@BGWKL0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BGWKL0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG Detail Status      CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0128  70       Item Code
     C                     MOVEL*BLANK    WN0129  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0130  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0131  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0132 112       Billing Detail
     C                     Z-ADD*ZERO     WN0133 112       Billing Detail
     C                     Z-ADD*ZERO     WN0134 112       Billing Detail
     C                     Z-ADD*ZERO     WN0135 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0136  1        Comment Print A
     C                     MOVEL*BLANK    WN0137  1        Comment Print I
     C                     MOVEL*BLANK    WN0138  1        Comment Print P
     C                     MOVEL*BLANK    WN0139  1        Comment Print S
     C                     Z-ADD*ZERO     WN0140 112       Extended Amount
     C                     Z-ADD*ZERO     WN0141  70       Market Pricing
     C                     MOVEL*BLANK    WN0142  3        Commodity Marke
     C                     MOVEL*BLANK    WN0143  3        Date Method Cod
     C                     MOVEL*BLANK    WN0144  3        Price Method Co
     C                     Z-ADD*ZERO     WN0145 114       Price Overage O
     C                     Z-ADD*ZERO     WN0146  70       Contract Number
     C                     MOVEL*BLANK    WN0147  1        Price Status
     C                     Z-ADD*ZERO     WN0148  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0149  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0150  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0151  1        Work Confirm St
     C                     MOVEL*BLANK    WN0152  1        Work Over_Short
     C                     MOVEL*BLANK    WN0153  1        OD Production P
     C                     MOVEL*BLANK    WN0154 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0155 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0156  1        Age Code
     C                     MOVEL*BLANK    WN0157  1        Palletize
     C                     MOVEL*BLANK    WN0158  1        Slip Sheet
     C                     MOVEL*BLANK    WN0159  1        Catch Weight St
     C                     MOVEL*BLANK    WN0160  1        Price Audit
     C                     MOVEL*BLANK    WN0161  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0162  1        Production Date
     C                     Z-ADD*ZERO     WN0163 112       Rated Freight
     C                     Z-ADD*ZERO     WN0164 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0165 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0166 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0167 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0168 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0169 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0170 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0171 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0172 114       Unit Price
     C                     Z-ADD*ZERO     WN0173 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0174 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0175 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0176 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0177  70       Requested Ship
     C                     Z-ADD*ZERO     WN0178  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0179  70       Actual Shipped
     C                     MOVEL*BLANK    WN0180  1        Affect Inventor
     C                     MOVEL*BLANK    WN0181  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0182  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0183  30       Item Structure
     C                     Z-ADD*ZERO     WN0184  30       Item Structure
     C                     Z-ADD*ZERO     WN0185  30       Item Structure
     C                     MOVEL*BLANK    WN0186  2        Item Level
     C                     MOVEL*BLANK    WN0187  2        Quality Level
     C                     MOVEL*BLANK    WN0188  2        Pricing Product
     C                     MOVEL*BLANK    WN0189  2        Season Product
     C                     Z-ADD*ZERO     WN0190  70       Date of Origina
     C                     MOVEL*BLANK    WN0191 10        User Profile Na
     C                     MOVEL*BLANK    WN0192  6        Country Code
     C                     MOVEL*BLANK    WN0193  2        Event Code
     C                     MOVEL*BLANK    WN0194  3        Reason Code
     C                     MOVEL*BLANK    WN0195  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0196  1        Modified Flag
     C                     MOVEL*BLANK    WN0197  1        Substituted Fla
     C                     MOVEL*BLANK    WN0198  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0199 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0200 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0201  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0202  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0203  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0204  1        Affect Commissi
     C                     MOVEL*BLANK    WN0205  1        Affect Pricing
     C                     MOVEL*BLANK    WN0206  1        Released by Use
     C                     MOVEL*BLANK    WN0207  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0208  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0209  3        Production Ware
     C                     MOVEL*BLANK    WN0210  3        OD Price Type
     C                     Z-ADD*ZERO     WN0211  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0212  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0213  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0214  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0215  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0216  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0217  60       Price Code
     C                     Z-ADD*ZERO     WN0218  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0219  60       Substitution Li
     C                     Z-ADD*ZERO     WN0220  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0221 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0222 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0223 112       OD Item Target
     C                     Z-ADD*ZERO     WN0224 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0225 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0226 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0227 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0228 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0229 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0230 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0231 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0232 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0233 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0234  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0235  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0236  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0237 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0238  40       Item Age Days
     C                     Z-ADD*ZERO     WN0239  70       Production Ovr
     C                     Z-ADD*ZERO     WN0240  70       Production Ovr
     C                     MOVEL*BLANK    WN0241  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0242  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0243  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0244  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0245  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0246  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0247  1        EDI Status 1
     C                     MOVEL*BLANK    WN0248  1        EDI Status 2
     C                     MOVEL*BLANK    WN0249  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0250  60       Job Time
     C                     MOVEL*BLANK    WN0251 10        User Id
     C                     MOVEL*BLANK    WN0252 10        Job Name
     C                     Z-ADD*ZERO     WN0253  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#1AIC3    OMAIC3           Company Number
     C                     Z-ADD#1C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#1UENB    OMUENB           Order Secondary
      *
     C           KLCHSQ    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHSQ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#1GMST    OMGMST    P      Detail Line Sta
     C                     MOVEL#1GNST    OMGNST    P      Detail Line Sta
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##PGM     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * CHG PD Order Detail    CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0254  60       Job Time
     C                     MOVEL*BLANK    WN0255 10        User Id
     C                     MOVEL*BLANK    WN0256 10        Job Name
     C                     Z-ADD*ZERO     WN0257  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADD#1AIC3    OMAIC3           Company Number
     C                     Z-ADD#1C4NB    OMC4NB           Order Number
     C                     Z-ADD#1DPNB    OMDPNB           Order Sequence
     C                     Z-ADD#1UENB    OMUENB           Order Secondary
      *
     C           KLCHSR    KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
     C           KLCHSR    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     GOTO SREXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * USER: Processing after Data read
      * E2247 RMC 10/03/12 Crt chg log if dtl has been sent to MPR USDA
      * CASE: DB1.OD MPR Sent to USDA Sts is yes
     C           OMHOST    IFEQ 'Y'                        *IF
      * If price type changes, then create type: ORDPRT
      * CASE: DB1.OD Price Type NE PAR.OD Price Type
     C           OMF7SX    IFNE #1F7SX                     *IF
      * change log prior has seq in pos 1-3, price type 5-7: '001 NEG
     C                     MOVELOMDPNB    YL0023           Text 3 Length U
     C                     Z-ADD1         ZQ      50
     C           YL0023    CAT  OMF7SX:ZQ YL0024    P      Change Log Prio
     C                     MOVEL*BLANK    YL0025           Change Log New
     C                     MOVEL#1F7SX    YL0025           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0292  70       Load ID
     C                     PARM 'ORDPRT'  WQ0293  6        Load Change Typ
     C                     PARM 'SLS'     WQ0294  3        Department Cont
     C                     PARM YL0024    WQ0295 12        Change Log Prio
     C                     PARM YL0025    WQ0296 12        Change Log New
     C                     PARM OMAIC3    WQ0297  30       Company Number
     C                     PARM OMC4NB    WQ0298  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If not the transfer order nbr 9999999 -> crt chg logs
      * CASE: DB1.Order Number is ne 9999999
     C           OMC4NB    IFNE 9999999                    *IF
      * If qty changes, then create type: ORDWGT & ORDQTY ->ALWAYS 6/14/1
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Quantity Ordered NE PAR.Quantity Ordered
      *   |- c2    : PAR.Detail Line Status is Cancelled
      *   '-
     C           OMAVQT    IFNE #1AVQT                     *IF
     C           #1GMST    OREQ 'X'                        *OR
      * (do this off of qty, because wgt can change often since unit wgt
      * change log prior has seq in pos 1-3, weight in 5-11: '001 0000nnn
     C                     MOVELOMDPNB    YL0023           Text 3 Length U
     C                     Z-ADDOMD0WG    YL0026           Weight Beg Inv
     C                     MOVELYL0026    YL0027           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0023    CAT  YL0027:ZQ YL0024    P      Change Log Prio
     C                     Z-ADD#1D0WG    YL0026           Weight Beg Inv
      * WI642-For cancelled item line new weight is zero for log only.
      * CASE: PAR.Detail Line Status is Cancelled
     C           #1GMST    IFEQ 'X'                        *IF
     C                     Z-ADD*ZERO     YL0026           Weight Beg Inv
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0025           Change Log New
     C                     MOVELYL0026    YL0025           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0299  70       Load ID
     C                     PARM 'ORDWGT'  WQ0300  6        Load Change Typ
     C                     PARM 'SLS'     WQ0301  3        Department Cont
     C                     PARM YL0024    WQ0302 12        Change Log Prio
     C                     PARM YL0025    WQ0303 12        Change Log New
     C                     PARM OMAIC3    WQ0304  30       Company Number
     C                     PARM OMC4NB    WQ0305  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDOMAVQT    YL0026           Weight Beg Inv
     C                     MOVELYL0026    YL0027           Text USR 7
     C                     Z-ADD1         ZQ      50
     C           YL0023    CAT  YL0027:ZQ YL0024    P      Change Log Prio
     C                     Z-ADD#1AVQT    YL0026           Weight Beg Inv
      * WI642-For cancelled item line new quantity is zero for log only.
      * CASE: PAR.Detail Line Status is Cancelled
     C           #1GMST    IFEQ 'X'                        *IF
     C                     Z-ADD*ZERO     YL0026           Weight Beg Inv
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0025           Change Log New
     C                     MOVELYL0026    YL0025           Change Log New
      * CRT Load/OrderChg n/ld XF - Load Order Change Log  * 
     C                     CALL 'PBFLXFR'              90  CRT Load/OrderC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0306  70       Load ID
     C                     PARM 'ORDQTY'  WQ0307  6        Load Change Typ
     C                     PARM 'SLS'     WQ0308  3        Department Cont
     C                     PARM YL0024    WQ0309 12        Change Log Prio
     C                     PARM YL0025    WQ0310 12        Change Log New
     C                     PARM OMAIC3    WQ0311  30       Company Number
     C                     PARM OMC4NB    WQ0312  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBFLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#1HGCD    OMHGCD           Item Code
     C                     MOVEL#1AJCD    OMAJCD    P      Warehouse Code
     C                     Z-ADD#1BKC7    OMBKC7           Ship To Custome
     C                     Z-ADD#1CFC7    OMCFC7           Order Group Cod
     C                     MOVEL#1GMST    OMGMST    P      Detail Line Sta
     C                     MOVEL#1GNST    OMGNST    P      Detail Line Sta
     C                     Z-ADD#1MAVA    OMMAVA           Billing Detail
     C                     Z-ADD#1KDVA    OMKDVA           Billing Detail
     C                     Z-ADD#1L8VA    OML8VA           Billing Detail
     C                     Z-ADD#1L9VA    OML9VA           Quantity to Sub
     C                     MOVEL#1GTST    OMGTST    P      Comment Print A
     C                     MOVEL#1GVST    OMGVST    P      Comment Print I
     C                     MOVEL#1GUST    OMGUST    P      Comment Print P
     C                     MOVEL#1QFST    OMQFST    P      Comment Print S
     C                     Z-ADD#1AYVA    OMAYVA           Extended Amount
     C                     Z-ADD#1EXDT    OMEXDT           Market Pricing
     C                     MOVEL#1LQCD    OMLQCD    P      Commodity Marke
     C                     MOVEL#1RDCD    OMRDCD    P      Date Method Cod
     C                     MOVEL#1Q7CD    OMQ7CD    P      Price Method Co
     C                     Z-ADD#1BZPR    OMBZPR           Price Overage O
     C                     Z-ADD#1L6NB    OML6NB           Contract Number
     C                     MOVEL#1U1ST    OMU1ST    P      Price Status
     C                     Z-ADD#1GIDT    OMGIDT           Pricing Date Us
     C                     MOVEL#1CRCD    OMCRCD    P      U_M_Base Price
     C                     MOVEL#1AGCD    OMAGCD    P      U_M_Ordered
     C                     MOVEL#1RZST    OMRZST    P      Work Confirm St
     C                     MOVEL#1R0ST    OMR0ST    P      Work Over_Short
     C                     MOVEL#1R1ST    OMR1ST    P      OD Production P
     C                     MOVEL#1G7NA    OMG7NA    P      Order Desc_Line
     C                     MOVEL#1G8NA    OMG8NA    P      Order Desc_Line
     C                     MOVEL#1RPCD    OMRPCD    P      Age Code
     C                     MOVEL#1VEST    OMVEST    P      Palletize
     C                     MOVEL#1VGST    OMVGST    P      Slip Sheet
     C                     MOVEL#1AVST    OMAVST    P      Catch Weight St
     C                     MOVEL#1U0ST    OMU0ST    P      Price Audit
     C                     MOVEL#1RFCD    OMRFCD    P      Price Audit Rea
     C                     MOVEL#1FZST    OMFZST    P      Production Date
     C                     Z-ADD#1R1NB    OMR1NB           Rated Freight
     C                     Z-ADD#1AVQT    OMAVQT           Quantity Ordere
     C                     Z-ADD#1D0WG    OMD0WG           Weight Ordered
     C                     Z-ADD#1CCQT    OMCCQT           Quantity Schedu
     C                     Z-ADD#1AUWG    OMAUWG           Weight Schedule
     C                     Z-ADD#1CBQT    OMCBQT           Quantity Shippe
     C                     Z-ADD#1ATWG    OMATWG           Weight Shipped
     C                     Z-ADD#1AQCS    OMAQCS           Unit Cost Prici
     C                     Z-ADD#1AGCS    OMAGCS           Unit Cost Per P
     C                     Z-ADD#1AKPR    OMAKPR           Unit Price
     C                     Z-ADD#1ALPR    OMALPR           Unit Price_Cred
     C                     Z-ADD#1AUPR    OMAUPR           Unit Price Orde
     C                     Z-ADD#1AVWG    OMAVWG           Unit Weight Ord
     C                     Z-ADD#1A4WG    OMA4WG           Tare Weight Tot
     C                     Z-ADD#1A5DT    OMA5DT           Requested Ship
     C                     Z-ADD#1AODT    OMAODT           Scheduled Ship
     C                     Z-ADD#1GNDT    OMGNDT           Actual Shipped
     C                     MOVEL#1AMST    OMAMST    P      Affect Inventor
     C                     MOVEL#1ANST    OMANST    P      Affect Sales Do
     C                     MOVEL#1VAST    OMVAST    P      Affect Sales Pn
     C                     Z-ADD#1RGNB    OMRGNB           Item Structure
     C                     Z-ADD#1RHNB    OMRHNB           Item Structure
     C                     Z-ADD#1RINB    OMRINB           Item Structure
     C                     MOVEL#1RBCD    OMRBCD    P      Item Level
     C                     MOVEL#1HICD    OMHICD    P      Quality Level
     C                     MOVEL#1RNCD    OMRNCD    P      Pricing Product
     C                     MOVEL#1ROCD    OMROCD    P      Season Product
     C                     Z-ADD#1CXDT    OMCXDT           Date of Origina
     C                     MOVEL#1AJVN    OMAJVN    P      User Profile Na
     C                     MOVEL#1KXCD    OMKXCD    P      Country Code
     C                     MOVEL#1JPCD    OMJPCD    P      Event Code
     C                     MOVEL#1CQCD    OMCQCD    P      Reason Code
     C                     MOVEL#1R4CD    OMR4CD    P      Sales Route Cod
     C                     MOVEL#1Z1ST    OMZ1ST    P      Modified Flag
     C                     MOVEL#1Z3ST    OMZ3ST    P      Substituted Fla
     C                     MOVEL#1Z4ST    OMZ4ST    P      OD Schedule Ove
     C                     Z-ADD#1DUPR    OMDUPR           Invoice Unit Pr
     C                     Z-ADD#1B6VL    OMB6VL           Invoice Extende
     C                     Z-ADD#1A1AA    OMA1AA           Ham Group Numbe
     C                     MOVEL#1FZSX    OMFZSX    P      OD Adj Type Ove
     C                     MOVEL#1F0SX    OMF0SX    P      Affect Trade Fu
     C                     MOVEL#1F1SX    OMF1SX    P      Affect Commissi
     C                     MOVEL#1F2SX    OMF2SX    P      Affect Pricing
     C                     MOVEL#1F3SX    OMF3SX    P      Released by Use
     C                     MOVEL#1F4SX    OMF4SX    P      Ord TF Exempt C
     C                     MOVEL#1F5SX    OMF5SX    P      OD Pallet Type
     C                     MOVEL#1F6SX    OMF6SX    P      Production Ware
     C                     MOVEL#1F7SX    OMF7SX    P      OD Price Type
     C                     Z-ADD#1NTDT    OMNTDT           Warehouse Palle
     C                     Z-ADD#1NUDT    OMNUDT           Consumed Item C
     C                     Z-ADD#1NVDT    OMNVDT           Deadline Depart
     C                     Z-ADD#1NWDT    OMNWDT           OD Price Type R
     C                     Z-ADD#1NXDT    OMNXDT           OD Firm Date
     C                     Z-ADD#1BUTM    OMBUTM           Deadline Depart
     C                     Z-ADD#1BVTM    OMBVTM           Price Code
     C                     Z-ADD#1BWTM    OMBWTM           Maximum Net Wei
     C                     Z-ADD#1BXTM    OMBXTM           Substitution Li
     C                     Z-ADD#1BYTM    OMBYTM           Max Qty to sche
     C                     Z-ADD#1H5NX    OMH5NX           Warehouse Palle
     C                     Z-ADD#1H6NX    OMH6NX           Warehouse Avg P
     C                     Z-ADD#1H7NX    OMH7NX           OD Item Target
     C                     Z-ADD#1H8NX    OMH8NX           OD Estimated Gr
     C                     Z-ADD#1H9NX    OMH9NX           OD Maximum Unit
     C                     Z-ADD#1DVPR    OMDVPR           Order Gate_Fina
     C                     Z-ADD#1DWPR    OMDWPR           OD Ceiling Pric
     C                     Z-ADD#1DXPR    OMDXPR           OD Gate_Final P
     C                     Z-ADD#1DYPR    OMDYPR           OD Weighted Avg
     C                     Z-ADD#1DZPR    OMDZPR           OD Original Ord
     C                     Z-ADD#1GSPR    OMGSPR           OD Cancel Date
     C                     Z-ADD#1GTPR    OMGTPR           OD Unused Prc 7
     C                     Z-ADD#1GUPR    OMGUPR           OD Unused Prc 8
     C                     MOVEL#1HOST    OMHOST    P      OD MPR Sent to
     C                     MOVEL#1HPST    OMHPST    P      OD MPR Prc Read
     C                     MOVEL#1IOST    OMIOST    P      OD UnUsed Price
     C                     Z-ADD#1PEWG    OMPEWG           Weight Amount E
     C                     Z-ADD#1RINY    OMRINY           Item Age Days
     C                     Z-ADD#1TIDT    OMTIDT           Production Ovr
     C                     Z-ADD#1TJDT    OMTJDT           Production Ovr
     C                     MOVEL#1H2ST    OMH2ST    P      OD Spot Buy
     C                     MOVEL#1H0ST    OMH0ST    P      OD Clm Full Ret
     C                     MOVEL#1H1ST    OMH1ST    P      Order Line Erro
     C                     Z-ADD#1TKDT    OMTKDT           OD Market Begin
     C                     Z-ADD#1TLDT    OMTLDT           OD Market Endin
     C                     Z-ADD#1TMDT    OMTMDT           OD Atch to Ord
     C                     MOVEL#1UVST    OMUVST    P      EDI Status 1
     C                     MOVEL#1UWST    OMUWST    P      EDI Status 2
     C                     MOVEL#1UXST    OMUXST    P      EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL*BLANK    OMRPCD           Age Code
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     OMAATM           Job Time
     C                     MOVEL##USR     OMAYNA           User Id
     C                     MOVEL##PGM     OMA0NA           Job Name
     C                     Z-ADD##JDT     OMAXDT           Job Date
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
     C                     EXSR SSRVGN
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELOMAJCD    WL0016    P      Warehouse Code
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    OMF6SX    P      Production Ware
     C                     Z-ADDWL0018    YN0142           Accounting Comp
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt func
     C                     EXSR UASUBR                     Calc Gross Weig
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDOMAIC3    BZAIC3           Company Number
     C                     Z-ADDOMHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSS     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZRINB    OMRINB           Item Structure
     C                     Z-ADDBZRHNB    OMRHNB           Item Structure
     C                     Z-ADDBZRGNB    OMRGNB           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0016    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSST     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0017           Production Ware
     C                     Z-ADD*ZERO     WL0018           Accounting Comp
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADAOCD    WL0017           Production Ware
     C                     Z-ADDADBTC3    WL0018           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSU01           Application Cod
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSU01           Application Cod
     C                     MOVEL'OMS'     WQSU01           Application Cod
      * Establish starting position
     C           KRSSU     SETLL@DNRESF                    *
     C           KRSSU     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
     C           KRSSU     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSV01           Application Cod
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSV01           Application Cod
      * Establish starting position
     C           KRSSV     SETLL@DNRESF                    *
     C           KRSSV     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSV     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSW     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0036           User Code Model
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRBUVN    YL0036           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV for Existence     RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0019    DTAJVN           User Profile Na
     C                     MOVELWL0020    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSX     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt fun
      *================================================================
      * Rtv Tare Weight        XF - Company Item  * 
     C                     CALL 'PBI3XFR'              90  Rtv Tare Weight
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0313  30       Company Number
     C                     PARM OMHGCD    WQ0314  70       Item Code
     C           YL0028    PARM YL0028    WQ0315  52       Misc Tare Weigh
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * wi464 change
      * RTV Itm BxID & Tares  XF - Item Bill Of Material  * 
     C                     CALL 'PBI4XFR'              90  RTV Itm BxID &
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0316  30       Company Number
     C                     PARM OMHGCD    WQ0317  70       Item Code
     C           YL0029    PARM *ZERO     WQ0318  52       Box Weight
     C           YL0030    PARM *ZERO     WQ0319  50       Number Cases On
     C           YL0031    PARM *ZERO     WQ0320  52       Pallet Tare Wei
     C           YL0032    PARM *ZERO     WQ0321  70       Box iD
     C                     PARM OMF5SX    WQ0322  2        OD Pallet Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           YL0029    ADD  YL0028    YL0033           Total Tare USR
      * Box + Misc Tare
      * LCL.Weight 1.1             .U =
      *    *COMPUTE ((x1 + x2) * x3)
      * x1    : LCL.Box Weight
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Misc Tare Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Quantity Ordered
     C           YL0029    ADD  YL0028    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT OMAVQT    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0034           Weight 1.1
      * Pallet Tare
      * CASE: DB1.Palletize is yes
     C           OMVEST    IFEQ 'Y'                        *IF
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C           YL0030    IFGT 0                          *IF
      * Pallet Weight
      * LCL.Weight 1.2             .U =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Number Cases On A Pallet
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Pallet Tare Weight
     C           OMAVQT    DIV  YL0030    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT YL0031    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0035           Weight 1.2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0035           Weight 1.2
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0035           Weight 1.2
     C                     END                             *FI
      * Estimated Gross
      * DB1.OD Minimum Unit Weight =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : DB1.Weight Ordered
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Weight 1.1             .U
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.Weight 1.2             .U
     C           OMD0WG    ADD  YL0034    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  YL0035    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    OMH8NX           OD Estimated Gr
      * E00196 RMC 8/24/12 chk pfs interface SHPTRN too
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Warehouse Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AJCD' defaulted for 'Warehouse Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0265  3        Warehouse Code
     C                     PARM *ZERO     WQ0266  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9836  *
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJCD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWB    KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    WBAJCD
     C           KLVAWB    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Customer Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1BKC7'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1ANC7' defaulted for 'AR Customer Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0021' defaulted for 'G/L Vendor Number USR'.
     C                     CALL 'PMFRSRR'              90  SEL A/R Cust W/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ANC7    WQ0267  70       AR Customer Num
     C           YL0021    PARM *ZERO     WQ0268  80       G/L Vendor Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1BKC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BKC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7
     C           KLVBBB    CHAIN@BBREE9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Customer Master        NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Price Method Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q7CD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Price Method Co
     C           YPMTFD    OREQ '#1Q7CD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AIC3' defaulted for 'Company Number'.
      * Field '(RCD) #1Q7CD' defaulted for 'Price Method Code'.
     C                     CALL 'PDZDSRR'              90  SEL PD Price Me
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0269  30       Company Number
     C           #1Q7CD    PARM #1Q7CD    WQ0270  3        Price Method Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1Q7CD    IFNE *BLANK                     Price Method Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q7CD    IFEQ *BLANK                     Price Method Co
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCIH    KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    IHAIC3
     C                     MOVEL#1Q7CD    IHQ7CD
     C           KLVCIH    CHAIN@IHRERN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Price Method Header    NF'
     C                     MOVEL'USR1665' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1665' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1CRCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1CRCD' defaulted for 'U_M_Base Price'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1CRCD    PARM #1CRCD    WQ0271  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1CRCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CRCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDAM    KLIST
     C                     KFLD           AMHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1CRCD    AMHHCD
     C           KLVDAM    CHAIN@AMREB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1AGCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1AGCD' defaulted for 'U_M_Ordered'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AGCD    PARM #1AGCD    WQ0272  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1AGCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AGCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAM    KLIST
     C                     KFLD           AMHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1AGCD    AMHHCD
     C           KLVEAM    CHAIN@AMREB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Country Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1KXCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Country Code
     C           YPMTFD    OREQ '#1KXCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1KXCD' defaulted for 'Country Code'.
     C                     CALL 'OMZASRR'              90  SEL Select Coun
     C                     PARM *BLANK    W0RTN   7
     C           #1KXCD    PARM #1KXCD    WQ0273  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMZASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9834  *
     C                     END
      *
     C           #1KXCD    IFNE *BLANK                     Country Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1KXCD    IFEQ *BLANK                     Country Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFE5    KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVEL#1KXCD    E5KXCD
     C           KLVFE5    CHAIN@E5REB8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Country Master         NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1158' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Event Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Event Code
     C           YPMTFD    OREQ '#1JPCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1JPCD' defaulted for 'Event Code'.
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #1JPCD    PARM #1JPCD    WQ0274  2        Event Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1JPCD    IFNE *BLANK                     Event Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JPCD    IFEQ *BLANK                     Event Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGEZ    KLIST
     C                     KFLD           EZJPCD           Event Code
      * Setup key
     C                     MOVEL#1JPCD    EZJPCD
     C           KLVGEZ    CHAIN@EZREYT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Event Types            NF'
     C                     MOVEL'USR1076' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1076' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to OP Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1CQCD' defaulted for 'Reason Code'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1C4NB' defaulted for 'Order Number'.
      * Field '(CTL) #2GWST' defaulted for 'Header Status'.
     C                     CALL 'PDG8SRR'              90  SEL for Order R
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0275  3        Reason Code
     C                     PARM #1C4NB    WQ0276  70       Order Number
     C                     PARM #2GWST    WQ0277  1        Header Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG8SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHCX    KLIST
     C                     KFLD           CXCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    CXCQCD
     C           KLVHCX    CHAIN@CXRENA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'OP Reason Codes        NF'
     C                     MOVEL'USR0504' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0504' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Ham Group Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1A1AA'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1A1AA' defaulted for 'Ham Group Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0022' defaulted for 'Exit Selection USR'.
     C                     CALL 'PDVYSRR'              90  SEL Ham Group
     C                     PARM *BLANK    W0RTN   7
     C           #1A1AA    PARM #1A1AA    WQ0278  30       Ham Group Numbe
     C           YL0022    PARM YL0022    WQ0279  1        Exit Selection
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1A1AA    IFNE *ZERO                      Ham Group Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1A1AA    IFEQ *ZERO                      Ham Group Numbe
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIM0    KLIST
     C                     KFLD           M0A1AA           Ham Group Numbe
      * Setup key
     C                     Z-ADD#1A1AA    M0A1AA
     C           KLVIM0    CHAIN@M0REZH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Ham Group Master       NF'
     C                     MOVEL'USR2837' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2837' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C                     MOVELV2C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#2C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #2C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0323  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0324  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VJ999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVJBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3
     C                     Z-ADD#2C4NB    BEC4NB
     C           KLVJBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     MOVELBEXIST    #2XIST           Credit Hold
     C                     MOVELBEXJST    #2XJST           Production Hold
     C                     MOVELBEGWST    #2GWST           Header Status
     C                     MOVELBEJNCD    #2JNCD           Order Type_Sale
     C                     Z-ADDBERMNB    #2RMNB           Load ID
     C                     MOVELBEU2ST    #2U2ST           Export Status
     C                     MOVELBEHNNA    #2HNNA           Ship To City
     C                     MOVELBEDBCD    #2DBCD           Ship To State C
     C                     Z-ADDBEEIDT    #2EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #2AFTM           Requested Deliv
     C                     MOVELBEGJST    #2GJST           Order in Use
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
     C           VJ999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD13        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           ZHF4RW    IFEQ 013
     C           ZHCSCL    ANDGE076
     C           ZHCSCL    ANDLE081
     C           *IN72     ANDEQ'0'
     C                     MOVEL'#1KXCD'  YPMTFD           Country Code
     C                     END
      *
     C           ZHF4RW    IFEQ 013
     C           ZHCSCL    ANDGE090
     C           ZHCSCL    ANDLE092
     C           *IN71     ANDEQ'0'
     C                     MOVEL'#1AJCD'  YPMTFD           Warehouse Code
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
      * USER: Exit program processing
      * Disable *Exit key
      * CASE: CTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO ZXEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     P1ANC7           AR Customer Num
     C                     Z-ADD*ZERO     P1B0C7           Bill to Custome
     C                     Z-ADD*ZERO     P1A5DT           Requested Ship
     C                     MOVEL*BLANK    P1GTST           Comment Print A
     C                     MOVEL*BLANK    P1GVST           Comment Print I
     C                     MOVEL*BLANK    P1GUST           Comment Print P
     C                     MOVEL*BLANK    P1QFST           Comment Print S
     C                     MOVEL*BLANK    P1GWST           Header Status
     C                     Z-ADD*ZERO     P1JZVA           Order Value Tot
     C                     Z-ADD*ZERO     P1A1WG           Order Weight To
     C                     MOVEL*BLANK    P1XIST           Credit Hold
     C                     MOVEL*BLANK    P1XJST           Production Hold
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     MOVEL*BLANK    P1Q2CD           Shipping Method
     C                     MOVEL*BLANK    P1VEST           Palletize
     C                     MOVEL*BLANK    P1VGST           Slip Sheet
     C                     MOVEL*BLANK    P1RPCD           Age Code
     C                     Z-ADD*ZERO     P1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    P1VDST           Load Type
     C                     MOVEL*BLANK    P1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    P1JPCD           Event Code
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     MOVEL*BLANK    P1OBST           Billing Activit
     C                     MOVEL*BLANK    P1BCST           Block Order Fla
     C                     MOVEL*BLANK    P1FSSX           Broker Order St
     C                     MOVEL*BLANK    P1FVSX           OH Load Plan Re
     C                     MOVEL*BLANK    P1FXSX           HPB Ship to War
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4AJCD           Warehouse Code
     C                     MOVEL*BLANK    P4DQCD           Enterprise Code
     C                     MOVEL*BLANK    P4DRCD           Enterprise Code
     C                     MOVEL*BLANK    P4BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P4B8NA           System Date For
     C                     MOVEL*BLANK    P4AJVN           User Profile Na
     C                     MOVEL*BLANK    P4I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P4MPNA           Default Printer
     C                     MOVEL*BLANK    P4TAST           First Time Flag
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5WDST           Cntrt Enter no
     C                     MOVEL*BLANK    P5WEST           Cntrt.# does no
     C                     MOVEL*BLANK    P5WFST           Qty ordered > C
     C                     MOVEL*BLANK    P5WGST           Contract Expire
     C                     MOVEL*BLANK    P5WHST           Price Override
     C                     MOVEL*BLANK    P5WIST           Price Method QT
     C                     MOVEL*BLANK    P5WJST           Prc Code FRM or
     C                     MOVEL*BLANK    P5WKST           Mkt Pricing Dat
     C                     MOVEL*BLANK    P5WLST           Mkt Meth. and D
     C                     MOVEL*BLANK    P5WMST           Price Override
     C                     MOVEL*BLANK    P5XSST           Contract Exists
     C                     MOVEL*BLANK    P5YXST           Price Override
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6V8ST           Price Method Ty
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7HSST           Allow Mult Whse
     C                     MOVEL*BLANK    P7AMEO           Allow Multi Exp
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P8TFNB           Transportation
     C                     MOVEL*BLANK    P8R4ST           USR Update Flag
     C                     MOVEL*BLANK    P8TMST           USR First Time
     C                     MOVEL*BLANK    P8GGST           USR Display fie
     C                     Z-ADD*ZERO     P8AUDT           Effective Date
     C                     Z-ADD*ZERO     P8CWDT           End Date Effect
     C                     Z-ADD*ZERO     P8DQQT           Maximum Quantit
     C                     Z-ADD*ZERO     P8GBDT           Contract Mkt Pr
     C                     Z-ADD*ZERO     P8HFQT           Quantity Sold
     C                     MOVEL*BLANK    P8OEST           Affect Inventor
     C                     MOVEL*BLANK    P8OFST           Affect Sales Do
     C                     MOVEL*BLANK    P8VBST           Affect Sales Pn
     C                     MOVEL*BLANK    P8X8ST           Affect Accruals
     C                     Z-ADD*ZERO     P8AVQT           Quantity Ordere
      * Clear all neither parameters
     C                     MOVEL*BLANK    P9CPCD           USR Warehouse C
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Order Date
     C                     Z-ADD*ZERO     WUA0DT  70
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Shrink Wrap
     C                     MOVEL*BLANK    WUVFST  1
      * Define work field Type Code
     C                     MOVEL*BLANK    WUBOCD  2
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A_R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Freight
     C                     Z-ADD*ZERO     WURQNB 112
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Define work field Status Flag 2  Y/N
     C                     MOVEL*BLANK    WUQ2ST  1
      * Define work field Status Flag 3  Y/N
     C                     MOVEL*BLANK    WUQ3ST  1
      * Define work field Status Flag 4  Y/N
     C                     MOVEL*BLANK    WUFMST  1
      * Define work field Status Flag 5  Y/N
     C                     MOVEL*BLANK    WUAJTX  1
      * Define work field Status Flag 7  Y/N
     C                     MOVEL*BLANK    WUAKTX  1
      * Define work field Status Flag 8  Y/N
     C                     MOVEL*BLANK    WUAFTX  1
      * Define work field Status Flag 12 Y/N
     C                     MOVEL*BLANK    WUDITX  1
      * Define work field Email to Warehouse Code
     C                     MOVEL*BLANK    WURJAA  3
      * Define work field Status Flag 6  Y/N
     C                     MOVEL*BLANK    WUACTX  1
      * Define work field Email Selection usr
     C                     MOVEL*BLANK    WUVQSX  1
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Number of Copies
     C                     Z-ADD*ZERO     WUDYNB  20
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field Paper Type USR
     C                     MOVEL*BLANK    WUA7ST  1
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Price Status USR
     C                     MOVEL*BLANK    WUYBST  1
      * Define work field Order Sequence Number
     C                     Z-ADD*ZERO     WUDPNB  30
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Price Start Date
     C                     Z-ADD*ZERO     WUPLDT  70
      * Define work field Price End Date
     C                     Z-ADD*ZERO     WUPMDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WBBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WBBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCDIC7           ED Item Code
     C                     Z-ADD*ZERO     WCHJWG           ED Product Net
     C                     Z-ADD*ZERO     WCHKWG           ED Product Net
     C                     Z-ADD*ZERO     WCAONX           ED Product Nbr
     C                     Z-ADD*ZERO     WCAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     WCANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     WCAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     WCDKPR           ED Product Unit
     C                     Z-ADD*ZERO     WCA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     WCAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WCW0DT           ED Nbr of Packi
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
     C                     Z-ADD*ZERO     WL0007 112
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  30
      * Define local variables for subroutine SPDLRC.
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  30
      * Define local variables for subroutine STRVGN.
     C                     MOVEL*BLANK    WL0016  3
     C                     MOVEL*BLANK    WL0017  3
     C                     Z-ADD*ZERO     WL0018  30
      * Define local variables for subroutine SXRVGN.
     C                     MOVEL*BLANK    WL0019 10
     C                     MOVEL*BLANK    WL0020  6
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Order Type_Sales
     C                     MOVEL*BLANK    YN0004  2
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0005  70
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0007 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0008  2
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field Order Sequence Number
     C                     Z-ADD*ZERO     YN0010  30
      * Define null work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YN0011  30
      * Define null work field Item Code
     C                     Z-ADD*ZERO     YN0012  70
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0013  3
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0014  70
      * Define null work field Order Group Code
     C                     Z-ADD*ZERO     YN0015  70
      * Define null work field Detail Line Status
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Detail Line Status Last
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Billing Detail Cost Dol
     C                     Z-ADD*ZERO     YN0018 112
      * Define null work field Billing Detail Gross Dol
     C                     Z-ADD*ZERO     YN0019 112
      * Define null work field Billing Detail Net Dol
     C                     Z-ADD*ZERO     YN0020 112
      * Define null work field Quantity to Substitute
     C                     Z-ADD*ZERO     YN0021 112
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0022  1
      * Define null work field Comment Print Inv_Cr_Memo
     C                     MOVEL*BLANK    YN0023  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field Extended Amount
     C                     Z-ADD*ZERO     YN0026 112
      * Define null work field Market Pricing Date
     C                     Z-ADD*ZERO     YN0027  70
      * Define null work field Commodity Market Code
     C                     MOVEL*BLANK    YN0028  3
      * Define null work field Date Method Code
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field Price Method Code
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field Price Overage Override
     C                     Z-ADD*ZERO     YN0031 114
      * Define null work field Contract Number
     C                     Z-ADD*ZERO     YN0032  70
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Pricing Date Used
     C                     Z-ADD*ZERO     YN0034  70
      * Define null work field U_M_Base Price
     C                     MOVEL*BLANK    YN0035  2
      * Define null work field U_M_Ordered
     C                     MOVEL*BLANK    YN0036  2
      * Define null work field Work Confirm Status
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field Work Over_Short Status
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field OD Production Plan Sts
     C                     MOVEL*BLANK    YN0039  1
      * Define null work field Order Desc_Line One
     C                     MOVEL*BLANK    YN0040 30
      * Define null work field Order Desc_Line Two
     C                     MOVEL*BLANK    YN0041 30
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0042  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0043  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0044  1
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Price Audit Reason Code
     C                     MOVEL*BLANK    YN0047  3
      * Define null work field Production Date Control
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0049 112
      * Define null work field Quantity Ordered
     C                     Z-ADD*ZERO     YN0050 112
      * Define null work field Weight Ordered
     C                     Z-ADD*ZERO     YN0051 112
      * Define null work field Quantity Scheduled
     C                     Z-ADD*ZERO     YN0052 112
      * Define null work field Weight Scheduled
     C                     Z-ADD*ZERO     YN0053 112
      * Define null work field Quantity Shipped Total
     C                     Z-ADD*ZERO     YN0054 112
      * Define null work field Weight Shipped Total
     C                     Z-ADD*ZERO     YN0055 112
      * Define null work field Unit Cost Pricing U_M
     C                     Z-ADD*ZERO     YN0056 114
      * Define null work field Unit Cost Per Pound
     C                     Z-ADD*ZERO     YN0057 114
      * Define null work field Unit Price
     C                     Z-ADD*ZERO     YN0058 114
      * Define null work field Unit Price_Credit
     C                     Z-ADD*ZERO     YN0059 114
      * Define null work field Unit Price Ordered U_M
     C                     Z-ADD*ZERO     YN0060 114
      * Define null work field Unit Weight Ordered U_M
     C                     Z-ADD*ZERO     YN0061 112
      * Define null work field Tare Weight Total
     C                     Z-ADD*ZERO     YN0062 112
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0063  70
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0064  70
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0065  70
      * Define null work field Affect Inventory Status
     C                     MOVEL*BLANK    YN0066  1
      * Define null work field Affect Sales Doll Status
     C                     MOVEL*BLANK    YN0067  1
      * Define null work field Affect Sales Pnds Status
     C                     MOVEL*BLANK    YN0068  1
      * Define null work field Item Structure Type Code
     C                     Z-ADD*ZERO     YN0069  30
      * Define null work field Item Structure Group Code
     C                     Z-ADD*ZERO     YN0070  30
      * Define null work field Item Structure Class Code
     C                     Z-ADD*ZERO     YN0071  30
      * Define null work field Item Level
     C                     MOVEL*BLANK    YN0072  2
      * Define null work field Quality Level
     C                     MOVEL*BLANK    YN0073  2
      * Define null work field Pricing Product Class Rep
     C                     MOVEL*BLANK    YN0074  2
      * Define null work field Season Product Class Repo
     C                     MOVEL*BLANK    YN0075  2
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0076  70
      * Define null work field User Profile Name
     C                     MOVEL*BLANK    YN0077 10
      * Define null work field Country Code
     C                     MOVEL*BLANK    YN0078  6
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0079  2
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0080  3
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0081  3
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0082  1
      * Define null work field Substituted Flag
     C                     MOVEL*BLANK    YN0083  1
      * Define null work field OD Schedule Override Sts
     C                     MOVEL*BLANK    YN0084  1
      * Define null work field Invoice Unit Price
     C                     Z-ADD*ZERO     YN0085 114
      * Define null work field Invoice Extended Amt
     C                     Z-ADD*ZERO     YN0086 112
      * Define null work field Ham Group Number
     C                     Z-ADD*ZERO     YN0087  30
      * Define null work field OD Adj Type Override
     C                     MOVEL*BLANK    YN0088  1
      * Define null work field Affect Trade Fund
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field Affect Commission
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field Affect Pricing
     C                     MOVEL*BLANK    YN0091  1
      * Define null work field Released by User Sts Y_N
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Ord TF Exempt Code
     C                     MOVEL*BLANK    YN0093  2
      * Define null work field OD Pallet Type
     C                     MOVEL*BLANK    YN0094  2
      * Define null work field Production Warehouse
     C                     MOVEL*BLANK    YN0095  3
      * Define null work field OD Price Type
     C                     MOVEL*BLANK    YN0096  3
      * Define null work field Warehouse Pallets Loaded
     C                     Z-ADD*ZERO     YN0097  70
      * Define null work field Consumed Item Code
     C                     Z-ADD*ZERO     YN0098  70
      * Define null work field OD Price Type Ref Num
     C                     Z-ADD*ZERO     YN0099  70
      * Define null work field OD Firm Date
     C                     Z-ADD*ZERO     YN0100  70
      * Define null work field Price Code
     C                     Z-ADD*ZERO     YN0101  60
      * Define null work field Maximum Net Weight
     C                     Z-ADD*ZERO     YN0102  60
      * Define null work field Substitution Line Number
     C                     Z-ADD*ZERO     YN0103  60
      * Define null work field Max Qty to sched per day
     C                     Z-ADD*ZERO     YN0104  60
      * Define null work field Warehouse Pallet Tare
     C                     Z-ADD*ZERO     YN0105 112
      * Define null work field Warehouse Avg Pallet Tare
     C                     Z-ADD*ZERO     YN0106 112
      * Define null work field OD Item Target Price
     C                     Z-ADD*ZERO     YN0107 112
      * Define null work field OD Estimated Gross Weight
     C                     Z-ADD*ZERO     YN0108 112
      * Define null work field OD Maximum Unit Weight
     C                     Z-ADD*ZERO     YN0109 112
      * Define null work field Order Gate_Final Price
     C                     Z-ADD*ZERO     YN0110 114
      * Define null work field OD Ceiling Price
     C                     Z-ADD*ZERO     YN0111 114
      * Define null work field OD Gate_Final Price Adj
     C                     Z-ADD*ZERO     YN0112 114
      * Define null work field OD Weighted Avg Price
     C                     Z-ADD*ZERO     YN0113 114
      * Define null work field OD Original Ordered Qty
     C                     Z-ADD*ZERO     YN0114 114
      * Define null work field OD Cancel Date
     C                     Z-ADD*ZERO     YN0115 114
      * Define null work field OD Unused Prc 7
     C                     Z-ADD*ZERO     YN0116 114
      * Define null work field OD Unused Prc 8
     C                     Z-ADD*ZERO     YN0117 114
      * Define null work field OD MPR Sent to USDA Sts
     C                     MOVEL*BLANK    YN0118  1
      * Define null work field OD MPR Prc Ready to Send
     C                     MOVEL*BLANK    YN0119  1
      * Define null work field OD UnUsed Price Sts 3
     C                     MOVEL*BLANK    YN0120  1
      * Define null work field Weight Amount Entered
     C                     Z-ADD*ZERO     YN0121 112
      * Define null work field Item Age Days
     C                     Z-ADD*ZERO     YN0122  40
      * Define null work field Production Ovr AgeDte Fr
     C                     Z-ADD*ZERO     YN0123  70
      * Define null work field Production Ovr AgeDte To
     C                     Z-ADD*ZERO     YN0124  70
      * Define null work field OD Spot Buy
     C                     MOVEL*BLANK    YN0125  1
      * Define null work field OD Clm Full Return to Plt
     C                     MOVEL*BLANK    YN0126  2
      * Define null work field Order Line Error Type
     C                     MOVEL*BLANK    YN0127  3
      * Define null work field OD Market Begin Date
     C                     Z-ADD*ZERO     YN0128  70
      * Define null work field OD Market Ending Date
     C                     Z-ADD*ZERO     YN0129  70
      * Define null work field OD Atch to Ord ActShpDte
     C                     Z-ADD*ZERO     YN0130  70
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0131  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0132  40
      * Define local work field User Appl Profile Exist U
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Edit Orig Ordered Qty U
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0003  1
      * Define null work field Accrual Description
     C                     MOVEL*BLANK    YN0133 30
      * Define null work field Automatic Accrual_Y_N
     C                     MOVEL*BLANK    YN0134  1
      * Define null work field Print On Invoice_Y_N
     C                     MOVEL*BLANK    YN0135  1
      * Define null work field Rate Usage
     C                     MOVEL*BLANK    YN0136  1
      * Define null work field Add-on_Allowance
     C                     MOVEL*BLANK    YN0137  1
      * Define local work field Accrual Type
     C                     MOVEL*BLANK    YL0004  2
      * Define null work field Sub Ledger Code
     C                     MOVEL*BLANK    YN0138  2
      * Define null work field Reverse Accrual Code
     C                     MOVEL*BLANK    YN0139  3
      * Define null work field UOM Primary Dft
     C                     MOVEL*BLANK    YN0140  2
      * Define local work field Affect Invoice Price
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field USR Country Code
     C                     MOVEL*BLANK    YL0007  6
      * Define local work field OH Load Plan Ready
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Salesperson Name
     C                     MOVEL*BLANK    YL0009 30
      * Define local work field Email to Broker Usr
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Email to Salesperson Usr
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Maximum Contract Units
     C                     Z-ADD*ZERO     YL0012 112
      * Define local work field Customer Price_UM Prc
     C                     Z-ADD*ZERO     YL0013 114
      * Define local work field Commodity Market Code
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0015  3
      * Define local work field Date Method Code
     C                     MOVEL*BLANK    YL0016  3
      * Define null work field Contract Unit Type
     C                     MOVEL*BLANK    YN0141  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0018 112
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0019  3
      * Define local work field Weight Allocated USR
     C                     Z-ADD*ZERO     YL0020  92
      * Define local work field G/L Vendor Number USR
     C                     Z-ADD*ZERO     YL0021  80
      * Define local work field Exit Selection USR
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Text 3 Length USR
     C                     MOVEL*BLANK    YL0023  3
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0024 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0025 12
      * Define local work field Weight Beg Inv usr
     C                     Z-ADD*ZERO     YL0026  70
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0027  7
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0142  30
      * Define local work field Misc Tare Weight
     C                     Z-ADD*ZERO     YL0028  52
      * Define local work field Box Weight
     C                     Z-ADD*ZERO     YL0029  52
      * Define local work field Number Cases On A Pallet
     C                     Z-ADD*ZERO     YL0030  50
      * Define local work field Pallet Tare Weight
     C                     Z-ADD*ZERO     YL0031  52
      * Define local work field Box iD
     C                     Z-ADD*ZERO     YL0032  70
      * Define local work field Total Tare USR
     C                     Z-ADD*ZERO     YL0033  52
      * Define local work field Weight 1.1             .U
     C                     Z-ADD*ZERO     YL0034  92
      * Define local work field Weight 1.2             .U
     C                     Z-ADD*ZERO     YL0035  92
      * Define local work field User Code Model
     C                     MOVEL*BLANK    YL0036 10
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0143  1
      * Define null work field Company Organization
     C                     MOVEL*BLANK    YN0144  1
      * Define null work field CDI Valuation Grouping
     C                     MOVEL*BLANK    YN0145  1
      * Define null work field CDI Unused Sts 3
     C                     MOVEL*BLANK    YN0146  1
      * Define null work field CDI Shipper
     C                     MOVEL*BLANK    YN0147  2
      * Define null work field CDI Produced by co
     C                     MOVEL*BLANK    YN0148  2
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD11        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL@CN,010   P2BYVN           Next Program Na
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SURVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * 08/19/19 DN R15322-Check User Exist to Edit Original Ordered Qty.
      * CASE: *OTHERWISE
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR SWRVGN
      * CASE: LCL.User Code Model is equal to blank
     C           YL0036    IFEQ *BLANK                     *IF
      * RTV for Existence     RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0019    P      User Profile Na
     C                     MOVEL'ORDUPD'  WL0020    P      Application Cod
     C                     EXSR SXRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV for Existence     RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0036    WL0019    P      User Profile Na
     C                     MOVEL'ORDUPD'  WL0020    P      Application Cod
     C                     EXSR SXRVGN
     C                     END                             *FI
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       YL0001           User Appl Profi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0001           User Appl Profi
     C                     END                             *FI
      * had RTV LAST Seq # from order detail; can't add on this screen
     C                     MOVEL'Y'       P4TAST           First Time Flag
      * RTV Co. Dflt Int All   XF - Company Defaults Internal  * 
     C                     CALL 'PDSTXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0325  30       Company Number
     C           WUG0TX    PARM *BLANK    WQ0326  2        Shipping Method
     C           WUG0TX    PARM *BLANK    WQ0327  1        Load Type Dft
     C           WUG0TX    PARM *BLANK    WQ0328  1        LTL Flag Dft
     C           WUG0TX    PARM *BLANK    WQ0329  1        Export Status D
     C           WUG0TX    PARM *BLANK    WQ0330  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0331  40       Departure Time
     C           WUG0TX    PARM *BLANK    WQ0332  6        Export Code Dft
     C           P7HSST    PARM *BLANK    WQ0333  1        Allow Mult Whse
     C           P7AMEO    PARM *BLANK    WQ0334  1        Allow Multi Exp
     C           WUG0TX    PARM *BLANK    WQ0335  1        Slip Sheet Dft
     C           WUG0TX    PARM *BLANK    WQ0336  1        Palletize Dft
     C                     PARM *BLANK    WQ0337  1        Plant Company S
     C                     PARM *BLANK    WQ0338  1        Company Organiz
     C                     PARM *BLANK    WQ0339  1        CDI Valuation G
     C                     PARM *BLANK    WQ0340  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0341  2        CDI Shipper
     C                     PARM *BLANK    WQ0342  2        CDI Produced by
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'N'       P8GGST           USR Display fie
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 * Internal Company *
00002 * Inter-Co Sales Agrmnt *
00003 * 3rd Party *
00004 PMGFE2R
00005 PDN9EFR
00006 Print Acknowledgement
00007 Y2U9999
00008 Print Get Ready Report
00009 Y2U0005
00010 PDO4EFR
