/*********************************************************************/
/*     Program: POA0UPC                                              */
/*       Title: Pork A/R CB Aging Reports  (SUBMIT)                  */
/*        Date: 06/02/99                                             */
/* Description: -                                                    */
/*********************************************************************/
/* Modifications:                                                    */
/*                                                                   */
/*   Date     Pgmr     Description                                   */
/* -------- ---------- --------------------------------------------  */
/*  12/18/01  RMC      ADD PARM REPORT TYPE 2 FOR NEW RPT BY SALESPR */
/*  01/29/04  RMC      PRINT ON PRKPRT02 INSTEAD OF PRKPRT04         */
/*  01/31/06  LJB      ADD PARM FOR COMPANY NUMBER                   */
/*  11/28/06  LJB      ADD A/R AGE CODE, EMAIL ADDRESS & FORMAT      */
/*  02/07/08  RMC      FP1271 ADDED EMAIL SUMMARY TABLE PARM &TABLE */
/*  08/24/16  JBB      ADD INCLUDE CHARGE BACK AND INCLUDE REBILL   */
/*                     FLAGS TO PARAMETERS.                         */
/*********************************************************************/
 POA0UPC:    PGM        PARM(&REPORT &SLS &CONBR &AGECODE &EMAILFMT +
                          &EMAIL &TABLE &INCLCB &INCLRB)

   /*-------------------*/
   /* Declare Variables */
   /*-------------------*/

             DCL  VAR(&REPORT) TYPE(*CHAR) LEN(1)
             DCL  VAR(&SLS) TYPE(*CHAR) LEN(3)
             DCL  VAR(&TABLE) TYPE(*CHAR) LEN(1)
             DCL  VAR(&INCLCB) TYPE(*CHAR) LEN(1)
             DCL  VAR(&INCLRB) TYPE(*CHAR) LEN(1)

             /* Parameter Fields */

             /* Internal Work Fields */
             DCL  VAR(&COPYN)    TYPE(*DEC)  LEN(2 0)
             DCL  VAR(&COPY)     TYPE(*DEC)
             DCL  VAR(&RETURN)   TYPE(*CHAR) LEN(7)
             DCL  VAR(&DESC)     TYPE(*CHAR) LEN(25)
             DCL  VAR(&APPLIC)   TYPE(*CHAR) LEN(6)
             DCL  VAR(&OUTQ)     TYPE(*CHAR) LEN(10)
             DCL  VAR(&HOLD)     TYPE(*CHAR) LEN(4)
             DCL  VAR(&SAVE)     TYPE(*CHAR) LEN(4)
             DCL  VAR(&NQSTAT)   TYPE(*CHAR) LEN(1)
             DCL  VAR(&NIGHTQ)   TYPE(*CHAR) LEN(10)
             DCL  VAR(&CONBR)    TYPE(*DEC)  LEN(15 5)
             DCL  VAR(&AGECODE)  TYPE(*CHAR) LEN(6)  /* A/R AGE CODE */
             DCL  VAR(&EMAIL)    TYPE(*CHAR) LEN(50) /* EMAIL ADDRESS*/
             DCL  VAR(&EMAILFMT) TYPE(*CHAR) LEN(5)  /* EMAIL FORMAT */
             DCL  VAR(&USER)     TYPE(*CHAR) LEN(10)
             DCL  VAR(&GRPPRF)   TYPE(*CHAR) LEN(10)

   /*----------------------*/
   /* Initialize Variables */
   /*----------------------*/
             CHGVAR VAR(&RETURN) VALUE(' ')
             CHGVAR VAR(&DESC)   VALUE('A/R CB Aging Report')
             CHGVAR VAR(&OUTQ)   VALUE('PRKPRT02')
             CHGVAR VAR(&HOLD)   VALUE('*NO ')
             CHGVAR VAR(&SAVE)   VALUE('*NO ')
             CHGVAR VAR(&COPYN)  VALUE(1)
             CHGVAR VAR(&NQSTAT) VALUE('N')
             CHGVAR VAR(&NIGHTQ) VALUE(' ')
             CHGVAR VAR(&APPLIC) VALUE('ARS')

 TEST:       RTVUSRPRF  RTNUSRPRF(&USER) GRPPRF(&GRPPRF)
 /***        IF         COND(&GRPPRF *EQ 'SBDPGMR') THEN(CHGVAR +
                          VAR(&OUTQ) VALUE('ISPRT01'))         ******/

   /*------------------------------*/
   /* Prompt for Report Parameters */
   /*------------------------------*/
             CALL PGM(PDG0PVR) +
                  PARM(&RETURN &DESC &OUTQ &HOLD +
                       &SAVE &COPYN &NQSTAT &NIGHTQ &APPLIC)
             IF COND(&RETURN *NE ' ') THEN(GOTO CMDLBL(END))

   /*--------------------------------------*/
   /* PRINT NIGHTLY AGING FOR CHARGEBACKS  */
   /*--------------------------------------*/
             CHGVAR VAR(&COPY) VALUE(&COPYN)
             SBMJOB     CMD(CALL PGM(POAZUPC) PARM(&REPORT &SLS +
                          &CONBR &OUTQ &HOLD &SAVE &COPY &AGECODE +
                          &EMAILFMT &EMAIL &TABLE &INCLCB &INCLRB)) +
                          JOB(CBAGING)

 /*TEST2:      CALL       PGM(POAZUPC) PARM(&REPORT &SLS &CONBR &OUTQ +
                          &HOLD &SAVE &COPY &AGECODE &EMAILFMT +
                          &EMAIL &TABLE &INCLCB &INCLRB) */

 END:
             ENDPGM
