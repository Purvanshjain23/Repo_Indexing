     H/TITLE Bal 1 Tattoo          XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 06/12/18  Time  : 10:20:17
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKBVCPL9IF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/KillDt/Tattoo
      *
     FPKBVCPL2IF  E           K        DISK
      * RSQ : Eval Trans                Next Eval Trans
      *
     FPKCGCPL4IF  E           K        DISK
      * RSQ : Producer History WKLY     Co/Prod/WkEndDte(D)/Type
      *
     FPKB6CPL1IF  E           K        DISK
      * RTV : Eval/Loss Error           Retrieval index
      *
     FPKBVCPL0UF  E           K        DISK                      A
      * UPD : Eval Trans                Update index
      *
     FPKB6CPL0IF  E           K        DISK                      A
      * UPD : Eval/Loss Error           Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     I@BOREFN
      * Evaluation Validation     Retrieval index
      * Renamed input format fields
     I              BOBVCD                          WABVCD
     I              BOCBTX                          WACBTX
     I              BOC5ST                          WAC5ST
     I              BOAFPC                          WAAFPC
     I              BOAGPC                          WAAGPC
     I              BOFEST                          WAFEST
     I              BOAAVN                          WAAAVN
     I              BOAADT                          WAAADT
     I              BOAMTM                          WAAMTM
     I              BOAJST                          WAAJST
     I              BOAHVN                          WAAHVN
     I              BOAGVN                          WAAGVN
     I              BOABVN                          WAABVN
     I              BOABDT                          WAABDT
     I              BOABTM                          WAABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@BVCPQ9
      * Eval Trans                Co/Bol/KillDt/Tattoo
      * Renamed input format fields
     I              BVHSNB                          WCHSNB
     I              BVA9DT                          WCA9DT
     I              BVFJNB                          WCFJNB
     I              BVHCNB                          WCHCNB
     I              BVGDNB                          WCGDNB
     I              BVFINB                          WCFINB
     I              BVLKNB                          WCLKNB
     I              BVEAST                          WCEAST
     I              BVAMPC                          WCAMPC
     I              BVAIPC                          WCAIPC
     I              BVAJPC                          WCAJPC
     I              BVAKPC                          WCAKPC
     I              BVX8NB                          WCX8NB
     I              BVFVPC                          WCFVPC
     I              BVFWPC                          WCFWPC
     I              BVFXPC                          WCFXPC
     I              BVALPC                          WCALPC
     I              BVDIST                          WCDIST
     I              BVFYST                          WCFYST
     I              BVD2ST                          WCD2ST
     I              BVEHST                          WCEHST
     I              BVG1ST                          WCG1ST
     I              BVH4ST                          WCH4ST
     I              BVJLST                          WCJLST
     I              BVUUST                          WCUUST
     I              BVVHST                          WCVHST
     I              BVVIST                          WCVIST
     I              BVVJST                          WCVJST
     I              BVVKST                          WCVKST
     I              BVVLST                          WCVLST
     I              BVHMNB                          WCHMNB
     I              BVBNNB                          WCBNNB
     I              BVBONB                          WCBONB
     I              BVCVNB                          WCCVNB
     I              BVB0DT                          WCB0DT
     I              BVAAVN                          WCAAVN
     I              BVAADT                          WCAADT
     I              BVAMTM                          WCAMTM
     I              BVAJST                          WCAJST
     I              BVAHVN                          WCAHVN
     I              BVAGVN                          WCAGVN
     I              BVABVN                          WCABVN
     I              BVABDT                          WCABDT
     I              BVABTM                          WCABTM
     I              BVB8DT                          WCB8DT
     I              BVAOTM                          WCAOTM
      *
     I@BVCPNE
      * Eval Trans                Next Eval Trans
      * Renamed input format fields
     I              BVHSNB                          WDHSNB
     I              BVA9DT                          WDA9DT
     I              BVFJNB                          WDFJNB
     I              BVHCNB                          WDHCNB
     I              BVGDNB                          WDGDNB
     I              BVFINB                          WDFINB
     I              BVLKNB                          WDLKNB
     I              BVEAST                          WDEAST
     I              BVAMPC                          WDAMPC
     I              BVAIPC                          WDAIPC
     I              BVAJPC                          WDAJPC
     I              BVAKPC                          WDAKPC
     I              BVX8NB                          WDX8NB
     I              BVFVPC                          WDFVPC
     I              BVFWPC                          WDFWPC
     I              BVFXPC                          WDFXPC
     I              BVALPC                          WDALPC
     I              BVDIST                          WDDIST
     I              BVFYST                          WDFYST
     I              BVD2ST                          WDD2ST
     I              BVEHST                          WDEHST
     I              BVG1ST                          WDG1ST
     I              BVH4ST                          WDH4ST
     I              BVJLST                          WDJLST
     I              BVUUST                          WDUUST
     I              BVVHST                          WDVHST
     I              BVVIST                          WDVIST
     I              BVVJST                          WDVJST
     I              BVVKST                          WDVKST
     I              BVVLST                          WDVLST
     I              BVHMNB                          WDHMNB
     I              BVBNNB                          WDBNNB
     I              BVBONB                          WDBONB
     I              BVCVNB                          WDCVNB
     I              BVB0DT                          WDB0DT
     I              BVAAVN                          WDAAVN
     I              BVAADT                          WDAADT
     I              BVAMTM                          WDAMTM
     I              BVAJST                          WDAJST
     I              BVAHVN                          WDAHVN
     I              BVAGVN                          WDAGVN
     I              BVABVN                          WDABVN
     I              BVABDT                          WDABDT
     I              BVABTM                          WDABTM
     I              BVB8DT                          WDB8DT
     I              BVAOTM                          WDAOTM
      *
     I@BVCPF0
      * Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WEHSNB
     I              BVA9DT                          WEA9DT
     I              BVFJNB                          WEFJNB
     I              BVHCNB                          WEHCNB
     I              BVGDNB                          WEGDNB
     I              BVFINB                          WEFINB
     I              BVLKNB                          WELKNB
     I              BVEAST                          WEEAST
     I              BVAMPC                          WEAMPC
     I              BVAIPC                          WEAIPC
     I              BVAJPC                          WEAJPC
     I              BVAKPC                          WEAKPC
     I              BVX8NB                          WEX8NB
     I              BVFVPC                          WEFVPC
     I              BVFWPC                          WEFWPC
     I              BVFXPC                          WEFXPC
     I              BVALPC                          WEALPC
     I              BVDIST                          WEDIST
     I              BVFYST                          WEFYST
     I              BVD2ST                          WED2ST
     I              BVEHST                          WEEHST
     I              BVG1ST                          WEG1ST
     I              BVH4ST                          WEH4ST
     I              BVJLST                          WEJLST
     I              BVUUST                          WEUUST
     I              BVVHST                          WEVHST
     I              BVVIST                          WEVIST
     I              BVVJST                          WEVJST
     I              BVVKST                          WEVKST
     I              BVVLST                          WEVLST
     I              BVHMNB                          WEHMNB
     I              BVBNNB                          WEBNNB
     I              BVBONB                          WEBONB
     I              BVCVNB                          WECVNB
     I              BVB0DT                          WEB0DT
     I              BVAAVN                          WEAAVN
     I              BVAADT                          WEAADT
     I              BVAMTM                          WEAMTM
     I              BVAJST                          WEAJST
     I              BVAHVN                          WEAHVN
     I              BVAGVN                          WEAGVN
     I              BVABVN                          WEABVN
     I              BVABDT                          WEABDT
     I              BVABTM                          WEABTM
     I              BVB8DT                          WEB8DT
     I              BVAOTM                          WEAOTM
      *
     I@CGCPEJ
      * Producer History WKLY     Co/Prod/WkEndDte(D)/Type
      * Renamed input format fields
     I              CGY3A1                          WFY3A1
     I              CGABCD                          WFABCD
     I              CGUVST                          WFUVST
     I              CGDZDT                          WFDZDT
     I              CGOJJF                          WFOJJF
     I              CGALHD                          WFALHD
     I              CGKDUR                          WFKDUR
     I              CGKJOQ                          WFKJOQ
     I              CGJOWR                          WFJOWR
     I              CGOIWE                          WFOIWE
     I              CGIOTR                          WFIOTR
     I              CGJOWK                          WFJOWK
     I              CGUQWP                          WFUQWP
     I              CGO6PC                          WFO6PC
     I              CGJKSE                          WFJKSE
     I              CGG8PC                          WFG8PC
     I              CGHAPC                          WFHAPC
     I              CGORJG                          WFORJG
     I              CGHDPC                          WFHDPC
     I              CGHFPC                          WFHFPC
     I              CGS1PR                          WFS1PR
     I              CGTCPR                          WFTCPR
     I              CGS3PR                          WFS3PR
     I              CGTDPR                          WFTDPR
     I              CGS5PR                          WFS5PR
     I              CGTEPR                          WFTEPR
     I              CGS7PR                          WFS7PR
     I              CGTFPR                          WFTFPR
     I              CGB6A1                          WFB6A1
     I              CGJKOS                          WFJKOS
     I              CGALRC                          WFALRC
     I              CGKDIE                          WFKDIE
     I              CGJOEW                          WFJOEW
     I              CGOWUI                          WFOWUI
     I              CGIOWN                          WFIOWN
     I              CGORMB                          WFORMB
     I              CGJOQR                          WFJOQR
     I              CGPRUR                          WFPRUR
     I              CGG7PC                          WFG7PC
     I              CGIOOG                          WFIOOG
     I              CGG9PC                          WFG9PC
     I              CGHBPC                          WFHBPC
     I              CGUWOE                          WFUWOE
     I              CGHEPC                          WFHEPC
     I              CGHGPC                          WFHGPC
     I              CGS2PR                          WFS2PR
     I              CGTGPR                          WFTGPR
     I              CGS4PR                          WFS4PR
     I              CGTHPR                          WFTHPR
     I              CGS6PR                          WFS6PR
     I              CGTIPR                          WFTIPR
     I              CGS8PR                          WFS8PR
     I              CGTJPR                          WFTJPR
     I              CGB8A1                          WFB8A1
     I              CGAAVN                          WFAAVN
     I              CGAADT                          WFAADT
     I              CGAMTM                          WFAMTM
     I              CGAJST                          WFAJST
     I              CGAHVN                          WFAHVN
     I              CGAGVN                          WFAGVN
     I              CGABVN                          WFABVN
     I              CGABDT                          WFABDT
     I              CGABTM                          WFABTM
      *
     I@B6CPGX
      * Eval/Loss Error           Retrieval index
      * Renamed input format fields
     I              B6HRNB                          WGHRNB
     I              B6BPDT                          WGBPDT
     I              B6IRNB                          WGIRNB
     I              B6BONM                          WGBONM
     I              B6LDNM                          WGLDNM
     I              B6FPNB                          WGFPNB
     I              B6DYST                          WGDYST
     I              B6DXST                          WGDXST
     I              B6B7TX                          WGB7TX
     I              B6AAVN                          WGAAVN
     I              B6AADT                          WGAADT
     I              B6AMTM                          WGAMTM
     I              B6AJST                          WGAJST
     I              B6AHVN                          WGAHVN
     I              B6AGVN                          WGAGVN
     I              B6ABVN                          WGABVN
     I              B6ABDT                          WGABDT
     I              B6ABTM                          WGABTM
      *
     I@B6CPGW
      * Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WHHRNB
     I              B6BPDT                          WHBPDT
     I              B6IRNB                          WHIRNB
     I              B6BONM                          WHBONM
     I              B6LDNM                          WHLDNM
     I              B6FPNB                          WHFPNB
     I              B6DYST                          WHDYST
     I              B6DXST                          WHDXST
     I              B6B7TX                          WHB7TX
     I              B6AAVN                          WHAAVN
     I              B6AADT                          WHAADT
     I              B6AMTM                          WHAMTM
     I              B6AJST                          WHAJST
     I              B6AHVN                          WHAHVN
     I              B6AGVN                          WHAGVN
     I              B6ABVN                          WHABVN
     I              B6ABDT                          WHABDT
     I              B6ABTM                          WHABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WIHMNB
     I              A1BNNB                          WIBNNB
     I              A1BONB                          WIBONB
     I              A1CVNB                          WICVNB
     I              A1B0DT                          WIB0DT
     I              A1AWDT                          WIAWDT
     I              A1BICD                          WIBICD
     I              A1CPST                          WICPST
     I              A1ACPR                          WIACPR
     I              A1B9PR                          WIB9PR
     I              A1CAPR                          WICAPR
     I              A1C4ST                          WIC4ST
     I              A1AIPR                          WIAIPR
     I              A1A6DT                          WIA6DT
     I              A1C2ST                          WIC2ST
     I              A1CXNB                          WICXNB
     I              A1CWNB                          WICWNB
     I              A1FCNB                          WIFCNB
     I              A1H9NB                          WIH9NB
     I              A1FDNB                          WIFDNB
     I              A1FENB                          WIFENB
     I              A1HENB                          WIHENB
     I              A1HFNB                          WIHFNB
     I              A1CYNB                          WICYNB
     I              A1LRNB                          WILRNB
     I              A1E0NB                          WIE0NB
     I              A1A5PC                          WIA5PC
     I              A1FBNB                          WIFBNB
     I              A1A4PC                          WIA4PC
     I              A1F7NB                          WIF7NB
     I              A1HDNB                          WIHDNB
     I              A1F5NB                          WIF5NB
     I              A1F4NB                          WIF4NB
     I              A1F3NB                          WIF3NB
     I              A1F2NB                          WIF2NB
     I              A1AVPC                          WIAVPC
     I              A1AWPC                          WIAWPC
     I              A1CWPC                          WICWPC
     I              A1A8PC                          WIA8PC
     I              A1A7PC                          WIA7PC
     I              A1B8PR                          WIB8PR
     I              A1AMPR                          WIAMPR
     I              A1ANPR                          WIANPR
     I              A1AYVA                          WIAYVA
     I              A1AWVA                          WIAWVA
     I              A1AOPR                          WIAOPR
     I              A1AXVA                          WIAXVA
     I              A1APPR                          WIAPPR
     I              A1ASPR                          WIASPR
     I              A1A4VA                          WIA4VA
     I              A1ATPR                          WIATPR
     I              A1A5VA                          WIA5VA
     I              A1CBPR                          WICBPR
     I              A1CCPR                          WICCPR
     I              A1LPNB                          WILPNB
     I              A1CDPR                          WICDPR
     I              A1A7VA                          WIA7VA
     I              A1A2PR                          WIA2PR
     I              A1JWST                          WIJWST
     I              A1CWST                          WICWST
     I              A1D7ST                          WID7ST
     I              A1D8ST                          WID8ST
     I              A1DWST                          WIDWST
     I              A1D6ST                          WID6ST
     I              A1GHNB                          WIGHNB
     I              A1BYDT                          WIBYDT
     I              A1E0ST                          WIE0ST
     I              A1E1ST                          WIE1ST
     I              A1E2ST                          WIE2ST
     I              A1BSDT                          WIBSDT
     I              A1BTDT                          WIBTDT
     I              A1BUDT                          WIBUDT
     I              A1HGNB                          WIHGNB
     I              A1HHNB                          WIHHNB
     I              A1HINB                          WIHINB
     I              A1A3PR                          WIA3PR
     I              A1A4PR                          WIA4PR
     I              A1A6PR                          WIA6PR
     I              A1J9NB                          WIJ9NB
     I              A1D6PR                          WID6PR
     I              A1D7PR                          WID7PR
     I              A1D8PR                          WID8PR
     I              A1D9PR                          WID9PR
     I              A1EAPR                          WIEAPR
     I              A1EBPR                          WIEBPR
     I              A1ECPR                          WIECPR
     I              A1EDPR                          WIEDPR
     I              A1EEPR                          WIEEPR
     I              A1EFPR                          WIEFPR
     I              A1EGPR                          WIEGPR
     I              A1EHPR                          WIEHPR
     I              A1KAST                          WIKAST
     I              A1J7ST                          WIJ7ST
     I              A1J9ST                          WIJ9ST
     I              A1OXNB                          WIOXNB
     I              A1LKST                          WILKST
     I              A1LLST                          WILLST
     I              A1J8ST                          WIJ8ST
     I              A1LIST                          WILIST
     I              A1LJST                          WILJST
     I              A1NZTX                          WINZTX
     I              A1HJCD                          WIHJCD
     I              A1R4ST                          WIR4ST
     I              A1R5ST                          WIR5ST
     I              A1R6ST                          WIR6ST
     I              A1R7ST                          WIR7ST
     I              A1THWT                          WITHWT
     I              A1T2WT                          WIT2WT
     I              A1THHD                          WITHHD
     I              A1T2HD                          WIT2HD
     I              A1OBPR                          WIOBPR
     I              A1KOER                          WIKOER
     I              A1OPIR                          WIOPIR
     I              A1OPEM                          WIOPEM
     I              A1IORP                          WIIORP
     I              A1OWEO                          WIOWEO
     I              A1OQET                          WIOQET
     I              A1URST                          WIURST
     I              A1USST                          WIUSST
     I              A1HHPC                          WIHHPC
     I              A1S9PR                          WIS9PR
     I              A1TAPR                          WITAPR
     I              A1TBPR                          WITBPR
     I              A1JFUR                          WIJFUR
     I              A1KRIF                          WIKRIF
     I              A1KORF                          WIKORF
     I              A1KAPR                          WIKAPR
     I              A1KROT                          WIKROT
     I              A1OTJG                          WIOTJG
     I              A1IRJG                          WIIRJG
     I              A1IMJF                          WIIMJF
     I              A1IRGF                          WIIRGF
     I              A1KRJF                          WIKRJF
     I              A1OJRF                          WIOJRF
     I              A1KFOR                          WIKFOR
     I              A1ORJK                          WIORJK
     I              A1OMVJ                          WIOMVJ
     I              A1MVNF                          WIMVNF
     I              A1MCNF                          WIMCNF
     I              A1NCNF                          WINCNF
     I              A1NCHF                          WINCHF
     I              A1IGIR                          WIIGIR
     I              A1KFJR                          WIKFJR
     I              A1EADT                          WIEADT
     I              A1EBDT                          WIEBDT
     I              A1ECDT                          WIECDT
     I              A1EDDT                          WIEDDT
     I              A1EEDT                          WIEEDT
     I              A1U4ST                          WIU4ST
     I              A1U5ST                          WIU5ST
     I              A1U6ST                          WIU6ST
     I              A1U7ST                          WIU7ST
     I              A1U8ST                          WIU8ST
     I              A1U9ST                          WIU9ST
     I              A1VAST                          WIVAST
     I              A1VBST                          WIVBST
     I              A1BDCD                          WIBDCD
     I              A1CSCD                          WICSCD
     I              A1ABCD                          WIABCD
     I              A1AECD                          WIAECD
     I              A1ACCD                          WIACCD
     I              A1AGCD                          WIAGCD
     I              A1BECD                          WIBECD
     I              A1AAVN                          WIAAVN
     I              A1AADT                          WIAADT
     I              A1AMTM                          WIAMTM
     I              A1AJST                          WIAJST
     I              A1AHVN                          WIAHVN
     I              A1AGVN                          WIAGVN
     I              A1ABVN                          WIABVN
     I              A1ABDT                          WIABDT
     I              A1ABTM                          WIABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKBV1    E DSPKBVCPL0
      * UPD : Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WEHSNB
     I              BVA9DT                          WEA9DT
     I              BVFJNB                          WEFJNB
     I              BVHCNB                          WEHCNB
     I              BVGDNB                          WEGDNB
     I              BVFINB                          WEFINB
     I              BVLKNB                          WELKNB
     I              BVEAST                          WEEAST
     I              BVAMPC                          WEAMPC
     I              BVAIPC                          WEAIPC
     I              BVAJPC                          WEAJPC
     I              BVAKPC                          WEAKPC
     I              BVX8NB                          WEX8NB
     I              BVFVPC                          WEFVPC
     I              BVFWPC                          WEFWPC
     I              BVFXPC                          WEFXPC
     I              BVALPC                          WEALPC
     I              BVDIST                          WEDIST
     I              BVFYST                          WEFYST
     I              BVD2ST                          WED2ST
     I              BVEHST                          WEEHST
     I              BVG1ST                          WEG1ST
     I              BVH4ST                          WEH4ST
     I              BVJLST                          WEJLST
     I              BVUUST                          WEUUST
     I              BVVHST                          WEVHST
     I              BVVIST                          WEVIST
     I              BVVJST                          WEVJST
     I              BVVKST                          WEVKST
     I              BVVLST                          WEVLST
     I              BVHMNB                          WEHMNB
     I              BVBNNB                          WEBNNB
     I              BVBONB                          WEBONB
     I              BVCVNB                          WECVNB
     I              BVB0DT                          WEB0DT
     I              BVAAVN                          WEAAVN
     I              BVAADT                          WEAADT
     I              BVAMTM                          WEAMTM
     I              BVAJST                          WEAJST
     I              BVAHVN                          WEAHVN
     I              BVAGVN                          WEAGVN
     I              BVABVN                          WEABVN
     I              BVABDT                          WEABDT
     I              BVABTM                          WEABTM
     I              BVB8DT                          WEB8DT
     I              BVAOTM                          WEAOTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            582
      * RCD : Tattoo Header             Retrieval index
      * I :  BOH Company Number
     I                                    P   1   20PAHMNB
      * I :  BOH Buy Order Number
     I                                    P   3   50PABNNB
      * I :  BOL Load Number
     I                                    P   6   80PABONB
      * I :  TH Tattoo Number
     I                                    P   9  110PACVNB
      * I :  TH Kill Date
     I                                    P  12  150PAB0DT
      * I :  TH Purchase Date
     I                                    P  16  190PAAWDT
      * I :  TH Group Reference
     I                                       20  29 PABICD
      * I :  TH Live Purchase UOM
     I                                       30  31 PACPST
      * I :  TH Live Purchase Price
     I                                    P  32  342PAACPR
      * I :  TH Live Gross Amt
     I                                    P  35  382PAB9PR
      * I :  TH LIve Net Amt
     I                                    P  39  422PACAPR
      * I :  TH Resale UOM
     I                                       43  44 PAC4ST
      * I :  TH Recalc Live Wgt Yld
     I                                    P  45  472PAAIPR
      * I :  TH Pricing Date
     I                                    P  48  510PAA6DT
      * I :  TH Resale Spread Sts
     I                                       52  52 PAC2ST
      * I :  TH Dead On Arrival
     I                                    P  53  550PACXNB
      * I :  TH Head Received
     I                                    P  56  580PACWNB
      * I :  TH Yard Deads
     I                                    P  59  610PAFCNB
      * I :  TH Held Over
     I                                    P  62  640PAH9NB
      * I :  TH Head Condemned
     I                                    P  65  670PAFDNB
      * I :  TH Head Killed
     I                                    P  68  700PAFENB
      * I :  TH Head Adds
     I                                    P  71  730PAHENB
      * I :  TH Head Accepted
     I                                    P  74  760PAHFNB
      * I :  TH Live Wgt
     I                                    P  77  801PACYNB
      * I :  TH Adj Live Wgt
     I                                    P  81  841PALRNB
      * I :  TH Hot Wgt
     I                                    P  85  881PAE0NB
      * I :  TH Tot Loin Eye Depth
     I                                    P  89  921PAA5PC
      * I :  TH Tot Backfat Inches
     I                                    P  93  961PAFBNB
      * I :  TH Tot Light Reflectance
     I                                    P  97 1001PAA4PC
      * I :  TH Avg Live Wgt
     I                                    P 101 1031PAF7NB
      * I :  TH Avg Hot Wgt
     I                                    P 104 1061PAHDNB
      * I :  TH Avg Light Reflectance
     I                                    P 107 1081PAF5NB
      * I :  TH Avg Lean Percent
     I                                    P 109 1101PAF4NB
      * I :  TH Avg Loin Eye Depth
     I                                    P 111 1121PAF3NB
      * I :  TH Avg Backfat
     I                                    P 113 1141PAF2NB
      * I :  TH Std Yield Percent
     I                                    P 115 1172PAAVPC
      * I :  TH Actual Yield %
     I                                    P 118 1202PAAWPC
      * I :  TH Adj Actual Yield %
     I                                    P 121 1232PACWPC
      * I :  TH Yield Difference
     I                                    P 124 1262PAA8PC
      * I :  TH Recalc Live Wgt
     I                                    P 127 1281PAA7PC
      * I :  TH CM Market Price
     I                                    P 129 1312PAB8PR
      * I :  TH CM Base Mkt Price
     I                                    P 132 1342PAAMPR
      * I :  TH CM Base Mkt Price Amt
     I                                    P 135 1382PAANPR
      * I :  TH CM Sort Discount Amt
     I                                    P 139 1422PAAYVA
      * I :  TH CM Yield Gain/Loss Amt
     I                                    P 143 1462PAAWVA
      * I :  TH CM Base Carcass Value
     I                                    P 147 1502PAAOPR
      * I :  TH CM LN AddOn/Deduct Amt
     I                                    P 151 1542PAAXVA
      * I :  TH CM Carcass Gross Amt
     I                                    P 155 1582PAAPPR
      * I :  TH Deduction Amt
     I                                    P 159 1622PAASPR
      * I :  TH Total Net WO Adds
     I                                    P 163 1662PAA4VA
      * I :  TH Carcass Net Amt
     I                                    P 167 1702PAATPR
      * I :  TH Additions Amt
     I                                    P 171 1742PAA5VA
      * I :  TH Payment Gross
     I                                    P 175 1782PACBPR
      * I :  Th Payment Net Amt
     I                                    P 179 1822PACCPR
      * I :  TH AP Voucher/Document#
     I                                    P 183 1870PALPNB
      * I :  TH Freight Amount
     I                                    P 188 1912PACDPR
      * I :  TH Accrual Amount
     I                                    P 192 1952PAA7VA
      * I :  TH Fixed Cost Amount
     I                                    P 196 1992PAA2PR
      * I :  TH Calc Net Sts
     I                                      200 200 PAJWST
      * I :  TH Payment Sts
     I                                      201 202 PACWST
      * N :  TH Header Error Sts
     I                                      203 203 PAD7ST
      * N :  TH Detail Error Sts
     I                                      204 204 PAD8ST
      * N :  TH Kill Balancing Sts
     I                                      205 205 PADWST
      * I :  TH Bal to Kill Gen
     I                                      206 206 PAD6ST
      * I :  TH Commission A/P Voucher
     I                                      207 2140PAGHNB
      * I :  TH Voucher Payment Date
     I                                    P 215 2180PABYDT
      * I :  TH User Error Override
     I                                      219 219 PAE0ST
      * I :  TH Held Over Record
     I                                      220 220 PAE1ST
      * I :  TH Sex
     I                                      221 221 PAE2ST
      * I :  TH Held/Ovr Completed Dte
     I                                    P 222 2250PABSDT
      * I :  TH Commission Paid Date
     I                                    P 226 2290PABTDT
      * I :  TH Actual Check Date
     I                                    P 230 2330PABUDT
      * I :  TH Shipped Weight
     I                                    P 234 2371PAHGNB
      * I :  TH Avg Hot Wgt EXC/ADD
     I                                    P 238 2411PAHHNB
      * I :  TH FFLI
     I                                    P 242 2431PAHINB
      * I :  TH Kill Product Value
     I                                    P 244 2472PAA3PR
      * I :  TH Cut Product Value
     I                                    P 248 2512PAA4PR
      * I :  TH Render Product Value
     I                                    P 252 2552PAA6PR
      * I :  TH Head Excluded
     I                                    P 256 2580PAJ9NB
      * I :  TH CM Bse Mkt Live /CWT
     I                                    P 259 2612PAD6PR
      * I :  TH CM Bse Mkt Carc /CWT
     I                                    P 262 2642PAD7PR
      * I :  TH CM Srt Dsc Live /CWT
     I                                    P 265 2672PAD8PR
      * I :  TH CM Srt Dsc Carc /CWT
     I                                    P 268 2702PAD9PR
      * I :  TH CM Yld G/L Live /CWT
     I                                    P 271 2732PAEAPR
      * I :  TH CM Yld G/L Carc /CWT
     I                                    P 274 2762PAEBPR
      * I :  TH CM Crc Val Live /CWT
     I                                    P 277 2792PAECPR
      * I :  TH CM Crc Val Carc /CWT
     I                                    P 280 2822PAEDPR
      * I :  TH CM Lean Prem Live /CWT
     I                                    P 283 2852PAEEPR
      * I :  TH CM Lean Prem Carc /CWT
     I                                    P 286 2882PAEFPR
      * I :  TH CM Gross Live /CWT
     I                                    P 289 2912PAEGPR
      * I :  TH CM Gross Carc /CWT
     I                                    P 292 2942PAEHPR
      * I :  TH Source Type
     I                                      295 295 PAKAST
      * I :  TH Scale Ticket Sts
     I                                      296 296 PAJ7ST
      * I :  TH Payment Type
     I                                      297 297 PAJ9ST
      * I :  TH HPS Movement Ref #
     I                                    P 298 3010PAOXNB
      * I :  TH Source Code
     I                                      302 304 PALKST
      * I :  TH Hog Class Type
     I                                      305 305 PALLST
      * I :  TH Posted to HPS Flag
     I                                      306 306 PAJ8ST
      * I :  TH Schedule Kill Shift
     I                                      307 307 PALIST
      * I :  TH Shift Held Over
     I                                      308 308 PALJST
      * I :  DF Defect Code
     I                                      491 496 PABDCD
      * I :  THP Process Code
     I                                      497 502 PACSCD
      * I :  PD Producer Code
     I                                      503 508 PAABCD
      * I :  PL Location Code
     I                                      509 514 PAAECD
      * I :  HB Buyer Code
     I                                      515 517 PAACCD
      * I :  GN Genetic Code
     I                                      518 522 PAAGCD
      * I :  HC Class Code
     I                                      523 525 PABECD
      * I :  RS User Changed
     I                                      526 535 PAAAVN
      * I :  RS Date Changed
     I                                    P 536 5390PAAADT
      * I :  RS Time Changed
     I                                    P 540 5430PAAMTM
      * I :  RS Record Status
     I                                      544 544 PAAJST
      * I :  RS Job
     I                                      545 554 PAAHVN
      * I :  RS Program
     I                                      555 564 PAAGVN
      * I :  RS User Added
     I                                      565 574 PAABVN
      * I :  RS Date Added
     I                                    P 575 5780PAABDT
      * I :  RS Time Added
     I                                    P 579 5820PAABTM
      *
     IQPKB61    E DSPKB6CPL0
      * UPD : Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WHHRNB
     I              B6BPDT                          WHBPDT
     I              B6IRNB                          WHIRNB
     I              B6BONM                          WHBONM
     I              B6LDNM                          WHLDNM
     I              B6FPNB                          WHFPNB
     I              B6DYST                          WHDYST
     I              B6DXST                          WHDXST
     I              B6B7TX                          WHB7TX
     I              B6AAVN                          WHAAVN
     I              B6AADT                          WHAADT
     I              B6AMTM                          WHAMTM
     I              B6AJST                          WHAJST
     I              B6AHVN                          WHAHVN
     I              B6AGVN                          WHAGVN
     I              B6ABVN                          WHABVN
     I              B6ABDT                          WHABDT
     I              B6ABTM                          WHABTM
      *
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WIHMNB
     I              A1BNNB                          WIBNNB
     I              A1BONB                          WIBONB
     I              A1CVNB                          WICVNB
     I              A1B0DT                          WIB0DT
     I              A1AWDT                          WIAWDT
     I              A1BICD                          WIBICD
     I              A1CPST                          WICPST
     I              A1ACPR                          WIACPR
     I              A1B9PR                          WIB9PR
     I              A1CAPR                          WICAPR
     I              A1C4ST                          WIC4ST
     I              A1AIPR                          WIAIPR
     I              A1A6DT                          WIA6DT
     I              A1C2ST                          WIC2ST
     I              A1CXNB                          WICXNB
     I              A1CWNB                          WICWNB
     I              A1FCNB                          WIFCNB
     I              A1H9NB                          WIH9NB
     I              A1FDNB                          WIFDNB
     I              A1FENB                          WIFENB
     I              A1HENB                          WIHENB
     I              A1HFNB                          WIHFNB
     I              A1CYNB                          WICYNB
     I              A1LRNB                          WILRNB
     I              A1E0NB                          WIE0NB
     I              A1A5PC                          WIA5PC
     I              A1FBNB                          WIFBNB
     I              A1A4PC                          WIA4PC
     I              A1F7NB                          WIF7NB
     I              A1HDNB                          WIHDNB
     I              A1F5NB                          WIF5NB
     I              A1F4NB                          WIF4NB
     I              A1F3NB                          WIF3NB
     I              A1F2NB                          WIF2NB
     I              A1AVPC                          WIAVPC
     I              A1AWPC                          WIAWPC
     I              A1CWPC                          WICWPC
     I              A1A8PC                          WIA8PC
     I              A1A7PC                          WIA7PC
     I              A1B8PR                          WIB8PR
     I              A1AMPR                          WIAMPR
     I              A1ANPR                          WIANPR
     I              A1AYVA                          WIAYVA
     I              A1AWVA                          WIAWVA
     I              A1AOPR                          WIAOPR
     I              A1AXVA                          WIAXVA
     I              A1APPR                          WIAPPR
     I              A1ASPR                          WIASPR
     I              A1A4VA                          WIA4VA
     I              A1ATPR                          WIATPR
     I              A1A5VA                          WIA5VA
     I              A1CBPR                          WICBPR
     I              A1CCPR                          WICCPR
     I              A1LPNB                          WILPNB
     I              A1CDPR                          WICDPR
     I              A1A7VA                          WIA7VA
     I              A1A2PR                          WIA2PR
     I              A1JWST                          WIJWST
     I              A1CWST                          WICWST
     I              A1D7ST                          WID7ST
     I              A1D8ST                          WID8ST
     I              A1DWST                          WIDWST
     I              A1D6ST                          WID6ST
     I              A1GHNB                          WIGHNB
     I              A1BYDT                          WIBYDT
     I              A1E0ST                          WIE0ST
     I              A1E1ST                          WIE1ST
     I              A1E2ST                          WIE2ST
     I              A1BSDT                          WIBSDT
     I              A1BTDT                          WIBTDT
     I              A1BUDT                          WIBUDT
     I              A1HGNB                          WIHGNB
     I              A1HHNB                          WIHHNB
     I              A1HINB                          WIHINB
     I              A1A3PR                          WIA3PR
     I              A1A4PR                          WIA4PR
     I              A1A6PR                          WIA6PR
     I              A1J9NB                          WIJ9NB
     I              A1D6PR                          WID6PR
     I              A1D7PR                          WID7PR
     I              A1D8PR                          WID8PR
     I              A1D9PR                          WID9PR
     I              A1EAPR                          WIEAPR
     I              A1EBPR                          WIEBPR
     I              A1ECPR                          WIECPR
     I              A1EDPR                          WIEDPR
     I              A1EEPR                          WIEEPR
     I              A1EFPR                          WIEFPR
     I              A1EGPR                          WIEGPR
     I              A1EHPR                          WIEHPR
     I              A1KAST                          WIKAST
     I              A1J7ST                          WIJ7ST
     I              A1J9ST                          WIJ9ST
     I              A1OXNB                          WIOXNB
     I              A1LKST                          WILKST
     I              A1LLST                          WILLST
     I              A1J8ST                          WIJ8ST
     I              A1LIST                          WILIST
     I              A1LJST                          WILJST
     I              A1NZTX                          WINZTX
     I              A1HJCD                          WIHJCD
     I              A1R4ST                          WIR4ST
     I              A1R5ST                          WIR5ST
     I              A1R6ST                          WIR6ST
     I              A1R7ST                          WIR7ST
     I              A1THWT                          WITHWT
     I              A1T2WT                          WIT2WT
     I              A1THHD                          WITHHD
     I              A1T2HD                          WIT2HD
     I              A1OBPR                          WIOBPR
     I              A1KOER                          WIKOER
     I              A1OPIR                          WIOPIR
     I              A1OPEM                          WIOPEM
     I              A1IORP                          WIIORP
     I              A1OWEO                          WIOWEO
     I              A1OQET                          WIOQET
     I              A1URST                          WIURST
     I              A1USST                          WIUSST
     I              A1HHPC                          WIHHPC
     I              A1S9PR                          WIS9PR
     I              A1TAPR                          WITAPR
     I              A1TBPR                          WITBPR
     I              A1JFUR                          WIJFUR
     I              A1KRIF                          WIKRIF
     I              A1KORF                          WIKORF
     I              A1KAPR                          WIKAPR
     I              A1KROT                          WIKROT
     I              A1OTJG                          WIOTJG
     I              A1IRJG                          WIIRJG
     I              A1IMJF                          WIIMJF
     I              A1IRGF                          WIIRGF
     I              A1KRJF                          WIKRJF
     I              A1OJRF                          WIOJRF
     I              A1KFOR                          WIKFOR
     I              A1ORJK                          WIORJK
     I              A1OMVJ                          WIOMVJ
     I              A1MVNF                          WIMVNF
     I              A1MCNF                          WIMCNF
     I              A1NCNF                          WINCNF
     I              A1NCHF                          WINCHF
     I              A1IGIR                          WIIGIR
     I              A1KFJR                          WIKFJR
     I              A1EADT                          WIEADT
     I              A1EBDT                          WIEBDT
     I              A1ECDT                          WIECDT
     I              A1EDDT                          WIEDDT
     I              A1EEDT                          WIEEDT
     I              A1U4ST                          WIU4ST
     I              A1U5ST                          WIU5ST
     I              A1U6ST                          WIU6ST
     I              A1U7ST                          WIU7ST
     I              A1U8ST                          WIU8ST
     I              A1U9ST                          WIU9ST
     I              A1VAST                          WIVAST
     I              A1VBST                          WIVBST
     I              A1BDCD                          WIBDCD
     I              A1CSCD                          WICSCD
     I              A1ABCD                          WIABCD
     I              A1AECD                          WIAECD
     I              A1ACCD                          WIACCD
     I              A1AGCD                          WIAGCD
     I              A1BECD                          WIBECD
     I              A1AAVN                          WIAAVN
     I              A1AADT                          WIAADT
     I              A1AMTM                          WIAMTM
     I              A1AJST                          WIAJST
     I              A1AHVN                          WIAHVN
     I              A1AGVN                          WIAGVN
     I              A1ABVN                          WIABVN
     I              A1ABDT                          WIABDT
     I              A1ABTM                          WIABTM
      *
     IYARDCS      DS                            582
     IYBRDCS      DS                            582
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * I :  BOH Buy Order Number
     I                                    P   3   50P1BNNB
      * I :  BOL Load Number
     I                                    P   6   80P1BONB
      * I :  TH Tattoo Number
     I                                    P   9  110P1CVNB
      * I :  TH Kill Date
     I                                    P  12  150P1B0DT
     IP2PARM      DS
      * I :  Oms System Value Alpha
     I                                        1  40 P2EVTX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'SBM Prt Bal to Kill Rpt'
      * BOH Company Number
     I                                    P   1   20ZA0001
      * Date Alpha USR
     I                                        3   9 ZA0002
      * PRT Printer Device
     I                                       10  19 ZA0003
      * PRT Hold Output Sts
     I                                       20  23 ZA0004
      * PRT Save Output Sts
     I                                       24  27 ZA0005
      * PRT Copies
     I                                    P  28  290ZA0006
      * PRT Night Queue
     I                                       30  39 ZA0007
      * Oms System Value Alpha
     I                                       40  79 ZA0008
      * TH Schedule Kill Shift
     I                                       80  80 ZA0009
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  50       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P2EVTX    PARM           WP0006 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EnhBal 1 Tattoo        XF
      * Enhancement E00394
      * 3/31/2017 slm *all new and susan is not done
      * Load all validation errors for min/max
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SARVGN
      * Bal 1 Tattoo          RT - Tattoo Header  * 
     C                     EXSR SBRVGN
      * Print Balance to Kill Report.
     E* Y2V3108 - Field not found in context of type PAR
     C                     MOVEL*BLANK    YL0052           Date Alpha USR
     C                     MOVEL?PAR??????YL0052           Date Alpha USR
      * Rtv Company Values    XF - STR Order Management Sys  * 
     E* Y2V3108 - Field not found in context of type PAR
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ?PAR??????WQ0160  30       BOH Company Num
     C                     PARM @CN,004   WQ0161 10        Company Value C
     C           YL0053    PARM *BLANK    WQ0162 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0053    YL0054           PRT Printer Dev
     C                     MOVELYL0056    YL0055           TH Schedule Kil
      * Setup message data for message
     E* Y2V3108 - Field not found in context of type PAR
     C                     Z-ADD?PAR??????ZA0001           CC Company Numb
     C                     MOVELYL0052    ZA0002           Date Alpha USR
     C                     MOVELYL0054    ZA0003           PRT Printer Dev
     C                     MOVEL'*NO'     ZA0004           PRT Hold Output
     C                     MOVEL'*YES'    ZA0005           PRT Save Output
     C                     Z-ADD1         ZA0006           PRT Copies
     C                     MOVEL'*JOBD'   ZA0007           PRT Night Queue
     C                     MOVELP2EVTX    ZA0008           Oms System Valu
     C                     MOVELYL0055    ZA0009           TH Schedule Kil
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0686' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0001           Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0002           Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0003           Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0004           Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0005           %Lean High Min
     C                     Z-ADD*ZERO     YL0006           %Lean High Max
     C                     Z-ADD*ZERO     YL0007           %Lean Low Min
     C                     Z-ADD*ZERO     YL0008           %Lean Low Max
     C                     Z-ADD*ZERO     YL0009           High Yield Min
     C                     Z-ADD*ZERO     YL0010           High Yield Max
     C                     Z-ADD*ZERO     YL0011           Low Yield Min
     C                     Z-ADD*ZERO     YL0012           Low Yield Max
     C                     Z-ADD*ZERO     YL0013           Head < Percent
     C                     Z-ADD*ZERO     YL0014           Head < Percent
     C                     Z-ADD*ZERO     YL0015           Head > Percent
     C                     Z-ADD*ZERO     YL0016           Head > Percent
     C                     Z-ADD*ZERO     YL0017           BackFat High Mi
     C                     Z-ADD*ZERO     YL0018           BackFat High Ma
     C                     Z-ADD*ZERO     YL0019           BackFat Low Min
     C                     Z-ADD*ZERO     YL0020           Backfat Low Max
     C                     Z-ADD*ZERO     YL0021           LoinEye High Mi
     C                     Z-ADD*ZERO     YL0022           LoinEye High Ma
     C                     Z-ADD*ZERO     YL0023           LoinEye Low Min
     C                     Z-ADD*ZERO     YL0024           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           WABVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDWAAFPC    YL0001           Carcass Dbw Min
     C                     Z-ADDWAAGPC    YL0002           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           WABVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDWAAFPC    YL0003           Carcass Lgt Min
     C                     Z-ADDWAAGPC    YL0004           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           WABVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDWAAFPC    YL0017           BackFat High Mi
     C                     Z-ADDWAAGPC    YL0018           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           WABVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDWAAFPC    YL0019           BackFat Low Min
     C                     Z-ADDWAAGPC    YL0020           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           WABVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDWAAFPC    YL0021           LoinEye High Mi
     C                     Z-ADDWAAGPC    YL0022           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           WABVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDWAAFPC    YL0023           LoinEye Low Min
     C                     Z-ADDWAAGPC    YL0024           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           WABVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDWAAFPC    YL0005           %Lean High Min
     C                     Z-ADDWAAGPC    YL0006           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           WABVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDWAAFPC    YL0007           %Lean Low Min
     C                     Z-ADDWAAGPC    YL0008           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           WABVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDWAAFPC    YL0013           Head < Percent
     C                     Z-ADDWAAGPC    YL0014           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           WABVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDWAAFPC    YL0015           Head > Percent
     C                     Z-ADDWAAGPC    YL0016           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           WABVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDWAAFPC    YL0009           High Yield Min
     C                     Z-ADDWAAGPC    YL0010           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           WABVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDWAAFPC    YL0011           Low Yield Min
     C                     Z-ADDWAAGPC    YL0012           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Bal 1 Tattoo          RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0001  30       BOH Company Num
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           YL0025    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WBBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WBB0DT           TH Kill Date
      * Establish starting position
     C           KRSSB     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Process Subject & Market Hogs
      * CASE: check for hog class type of market, or subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WBLLST    IFEQ 'M'                        *IF
     C           WBLLST    OREQ 'S'                        *OR
      * If receiving or slaughter processing code
      * CASE: Receiving or Slaughter
      *  - c1 OR c2
      *   |- c1    : DB1.THP Process Code is Receiving
      *   |- c2    : DB1.THP Process Code is Slaughter
      *   '-
     C           WBCSCD    IFEQ 'RECV'                     *IF
     C           WBCSCD    OREQ 'SLG'                      *OR
      * Transfer Carcasses for Hold Over.
      * CASE: DB1.TH Held Over Record is Yes
     C           WBE1ST    IFEQ 'Y'                        *IF
      * Rtv/Trnsfr Eval Trns  RT - Tattoo Header  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
     C                     Z-ADDWBAWDT    PAAWDT           TH Purchase Dat
     C                     MOVELWBBICD    PABICD    P      TH Group Refere
     C                     MOVELWBCPST    PACPST    P      TH Live Purchas
     C                     Z-ADDWBACPR    PAACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    PAB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    PACAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWBAIPR    PAAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    PAA6DT           TH Pricing Date
     C                     MOVELWBC2ST    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWBCXNB    PACXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    PACWNB           TH Head Receive
     C                     Z-ADDWBFCNB    PAFCNB           TH Yard Deads
     C                     Z-ADDWBH9NB    PAH9NB           TH Held Over
     C                     Z-ADDWBFDNB    PAFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    PAFENB           TH Head Killed
     C                     Z-ADDWBHENB    PAHENB           TH Head Adds
     C                     Z-ADDWBHFNB    PAHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    PACYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    PAE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    PAFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    PAA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    PAF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    PAF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    PAAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    PACWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    PAA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    PAA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    PAB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    PAANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    PAAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    PAAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    PAASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    PAA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    PAATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    PAA5VA           TH Additions Am
     C                     Z-ADDWBCBPR    PACBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    PACCPR           Th Payment Net
     C                     Z-ADDWBLPNB    PALPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    PACDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    PAA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    PAA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    PAJWST    P      TH Calc Net Sts
     C                     MOVELWBCWST    PACWST    P      TH Payment Sts
     C                     MOVELWBD6ST    PAD6ST    P      TH Bal to Kill
     C                     Z-ADDWBGHNB    PAGHNB           TH Commission A
     C                     Z-ADDWBBYDT    PABYDT           TH Voucher Paym
     C                     MOVELWBE0ST    PAE0ST    P      TH User Error O
     C                     MOVELWBE1ST    PAE1ST    P      TH Held Over Re
     C                     MOVELWBE2ST    PAE2ST    P      TH Sex
     C                     Z-ADDWBBSDT    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    PABTDT           TH Commission P
     C                     Z-ADDWBBUDT    PABUDT           TH Actual Check
     C                     Z-ADDWBHGNB    PAHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    PAHINB           TH FFLI
     C                     Z-ADDWBA3PR    PAA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    PAA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    PAA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    PAJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    PAECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    PAEHPR           TH CM Gross Car
     C                     MOVELWBKAST    PAKAST    P      TH Source Type
     C                     MOVELWBJ7ST    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWBJ9ST    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWBOXNB    PAOXNB           TH HPS Movement
     C                     MOVELWBLKST    PALKST    P      TH Source Code
     C                     MOVELWBLLST    PALLST    P      TH Hog Class Ty
     C                     MOVELWBJ8ST    PAJ8ST    P      TH Posted to HP
     C                     MOVELWBLIST    PALIST    P      TH Schedule Kil
     C                     MOVELWBLJST    PALJST    P      TH Shift Held O
     C                     MOVELWBBDCD    PABDCD    P      DF Defect Code
     C                     MOVELWBCSCD    PACSCD    P      THP Process Cod
     C                     MOVELWBABCD    PAABCD    P      PD Producer Cod
     C                     MOVELWBAECD    PAAECD    P      PL Location Cod
     C                     MOVELWBACCD    PAACCD    P      HB Buyer Code
     C                     MOVELWBAGCD    PAAGCD    P      GN Genetic Code
     C                     MOVELWBBECD    PABECD    P      HC Class Code
     C                     MOVELWBAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    PAAADT           RS Date Changed
     C                     Z-ADDWBAMTM    PAAMTM           RS Time Changed
     C                     MOVELWBAJST    PAAJST    P      RS Record Statu
     C                     MOVELWBAHVN    PAAHVN    P      RS Job
     C                     MOVELWBAGVN    PAAGVN    P      RS Program
     C                     MOVELWBABVN    PAABVN    P      RS User Added
     C                     Z-ADDWBABDT    PAABDT           RS Date Added
     C                     Z-ADDWBABTM    PAABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM YL0001    WQ0082  71       Carcass Dbw Min
     C                     PARM YL0002    WQ0083  71       Carcass Dbw Max
     C                     PARM YL0003    WQ0084  71       Carcass Lgt Min
     C                     PARM YL0004    WQ0085  71       Carcass Lgt Max
     C                     PARM YL0005    WQ0086  71       %Lean High Min
     C                     PARM YL0006    WQ0087  71       %Lean High Max
     C                     PARM YL0007    WQ0088  71       %Lean Low Min
     C                     PARM YL0008    WQ0089  71       %Lean Low Max
     C                     PARM YL0009    WQ0090  71       High Yield Min
     C                     PARM YL0010    WQ0091  71       High Yield Max
     C                     PARM YL0011    WQ0092  71       Low Yield Min
     C                     PARM YL0012    WQ0093  71       Low Yield Max
     C                     PARM YL0013    WQ0094  71       Head < Percent
     C                     PARM YL0014    WQ0095  71       Head < Percent
     C                     PARM YL0015    WQ0096  71       Head > Percent
     C                     PARM YL0016    WQ0097  71       Head > Percent
     C                     PARM YL0017    WQ0098  71       BackFat High Mi
     C                     PARM YL0018    WQ0099  71       BackFat High Ma
     C                     PARM YL0019    WQ0100  71       BackFat Low Min
     C                     PARM YL0020    WQ0101  71       Backfat Low Max
     C                     PARM YL0021    WQ0102  71       LoinEye High Mi
     C                     PARM YL0022    WQ0103  71       LoinEye High Ma
     C                     PARM YL0023    WQ0104  71       LoinEye Low Min
     C                     PARM YL0024    WQ0105  71       LoinEye Low Max
     C                     PARM 'N'       WQ0106  1        Requested by Us
     C                     PARM *BLANK    WQ0107  1        Bal w/History
     C                     PARM *BLANK    WQ0108  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0109  3        TH PHA Average
     C                     PARM *BLANK    WQ0110  1        TH PHA Add Reas
     C                     PARM 0         WQ0111  51       PH GA Avg Live
     C                     PARM 0         WQ0112  52       PH GA Adjusted
     C                     PARM 0         WQ0113  31       PH GA Avg Lean%
     C                     PARM 0         WQ0114  31       PH GA Avg Backf
     C                     PARM 0         WQ0115  31       PH GA Avg Loin
     C                     PARM 0         WQ0116  31       PH GA Avg Light
     C                     PARM 0         WQ0117  52       PH GA Lean Prm
     C                     PARM 0         WQ0118  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0119  1        Undo MPR USR
     C           YL0032    PARM *BLANK    WQ0120  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Balance First Day USR is Yes
     C           YL0032    IFEQ 'Y'                        *IF
      * Rtv Balance Info      RT - Tattoo Header  * 
     C                     EXSR SNRVGN
      * CASE: LCL.TH PHA Add Type is Historical Avg Balanced
     C           YL0033    IFEQ 'B'                        *IF
     C           YL0033    OREQ 'E'
     C                     MOVEL'P'       YL0036           Bal w/History
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR SORVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0036           Bal w/History
     C                     END                             *FI
      * Bal Held Over Tattoo  RT - Tattoo Header  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * This tattoo header is in the process code at the incorrect time
      * either this is wip or payment
     C                     MOVEL'K'       YL0050           TH Header Error
     C                     MOVEL'E'       YL0051           TH Kill Balanci
      * RTV Check For Pay Err RT - Eval/Loss Error  * 
     C                     EXSR SQRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SRCRRC
     C                     END                             *FI
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Chg Tattoo Hdr Bal Sts CH - Tattoo Header  * 
     C                     EXSR STCHRC
     C                     END                             *FI
     C                     END                             *FI
      * Process Resale Hogs
      * CASE: DB1.TH Hog Class Type is Resale
     C           WBLLST    IFEQ 'R'                        *IF
      * RESALE UPDATE ADJUSTED LIVE WEIGHT
     C           WBCWNB    SUB  WBFCNB    WUF6NB           Net Head Usr
     C                     SUB  WBFDNB    WUF6NB           Net Head Usr
      * Calculate Adj Live Weight
      * CASE: DB1.TH Head Received EQ WRK.Net Head Usr
     C           WBCWNB    IFEQ WUF6NB                     *IF
     C                     Z-ADDWBCYNB    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUF6NB    MULT WBF7NB    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
      * Chg Adj lv Wgt/Adj Yld CH - Tattoo Header  * 
     C                     EXSR SUCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv/Trnsfr Eval Trns  RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0002 10        TH Group Refere
     C                     MOVEL*BLANK    WN0003  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0004  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0005  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0006  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0008  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0009  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0010  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0013  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0014  50       TH Held Over
     C                     Z-ADD*ZERO     WN0015  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0016  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0017  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0018  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0019  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0020  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0033  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0035  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0036  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0045  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0046  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0047  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0048  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0049  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0050  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0052  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0056  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0057  80       TH Commission A
     C                     Z-ADD*ZERO     WN0058  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0059  1        TH User Error O
     C                     MOVEL*BLANK    WN0060  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0061  1        TH Sex
     C                     Z-ADD*ZERO     WN0062  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0063  70       TH Commission P
     C                     Z-ADD*ZERO     WN0064  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0065  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0066  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0067  31       TH FFLI
     C                     Z-ADD*ZERO     WN0068  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0069  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0070  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0071  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0072  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0073  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0074  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0075  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0076  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0077  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0078  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0079  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0080  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0081  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0083  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0084  1        TH Source Type
     C                     MOVEL*BLANK    WN0085  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0086  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0087  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0088  3        TH Source Code
     C                     MOVEL*BLANK    WN0089  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0090  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0091  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0092  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0093  6        DF Defect Code
     C                     MOVEL*BLANK    WN0094  6        THP Process Cod
     C                     MOVEL*BLANK    WN0095  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0096  6        PL Location Cod
     C                     MOVEL*BLANK    WN0097  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0098  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0099  3        HC Class Code
     C                     MOVEL*BLANK    WN0100 10        RS User Changed
     C                     Z-ADD*ZERO     WN0101  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0102  60       RS Time Changed
     C                     MOVEL*BLANK    WN0103  1        RS Record Statu
     C                     MOVEL*BLANK    WN0104 10        RS Job
     C                     MOVEL*BLANK    WN0105 10        RS Program
     C                     MOVEL*BLANK    WN0106 10        RS User Added
     C                     Z-ADD*ZERO     WN0107  70       RS Date Added
     C                     Z-ADD*ZERO     WN0108  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S13236 RMC 6/12/18 fixed parms on call to rebalance the FROM date
      *   was passing in DB1. which is from the last day's records. it ne
      *   pass in the PAR context previousely retrieved.  and only do it
      *  are transfer carcasses
     C                     MOVEL'Y'       YL0026           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSC03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSC04           TH Tattoo Numbe
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
     C                     KFLD           WQSC04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHMNB    WQSC01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSC02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSC03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSC04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSC     SETLL@A1CPC4                    *
     C           KRSSC     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0026    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0026           First Time Flag
      * Net Head Usr
      * LCL.Net Head Usr =
      *    *COMPUTE (x1 - x2 - x3)
      * x1    : DB1.TH Head Received
      * -     : PGM.*Synon (15,0) work field
      * x2    : DB1.TH Yard Deads
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.TH Head Condemned
     C           WBCWNB    SUB  WBFCNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WBFDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0027           Net Head Usr
     C           YL0027    SUB  WBFENB    YL0028           Transfer Carcas
     C                     Z-ADDWBB0DT    YL0029           TH Kill Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBB0DT    YL0030           Kill Date Usr
     C                     END                             *FI
     C           KRSSC     READE@A1CPC4                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.Transfer Carcasses    USR is *Zeros
     C           YL0028    IFEQ 0                          *IF
     C                     ELSE
      * CASE: LCL.Transfer Carcasses    USR is GT Zero
     C           YL0028    IFGT 0                          *IF
      * Transfer from the Held Over To Date.
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
     C                     EXSR SDRVGN
      * RMC - moved here from below
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
     C                     EXSR SHRVGN
      * RMC chg to PAR to pick up orig kill date fields
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDYL0029    PAB0DT           TH Kill Date
     C                     Z-ADDWN0001    PAAWDT           TH Purchase Dat
     C                     MOVELWN0002    PABICD    P      TH Group Refere
     C                     MOVELWN0003    PACPST    P      TH Live Purchas
     C                     Z-ADDWN0004    PAACPR           TH Live Purchas
     C                     Z-ADDWN0005    PAB9PR           TH Live Gross A
     C                     Z-ADDWN0006    PACAPR           TH LIve Net Amt
     C                     MOVELWN0007    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWN0008    PAAIPR           TH Recalc Live
     C                     Z-ADDWN0009    PAA6DT           TH Pricing Date
     C                     MOVELWN0010    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWN0011    PACXNB           TH Dead On Arri
     C                     Z-ADDWN0012    PACWNB           TH Head Receive
     C                     Z-ADDWN0013    PAFCNB           TH Yard Deads
     C                     Z-ADDWN0014    PAH9NB           TH Held Over
     C                     Z-ADDWN0015    PAFDNB           TH Head Condemn
     C                     Z-ADDWN0016    PAFENB           TH Head Killed
     C                     Z-ADDWN0017    PAHENB           TH Head Adds
     C                     Z-ADDWN0018    PAHFNB           TH Head Accepte
     C                     Z-ADDWN0019    PACYNB           TH Live Wgt
     C                     Z-ADDWN0020    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWN0021    PAE0NB           TH Hot Wgt
     C                     Z-ADDWN0022    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWN0023    PAFBNB           TH Tot Backfat
     C                     Z-ADDWN0024    PAA4PC           TH Tot Light Re
     C                     Z-ADDWN0025    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWN0026    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWN0027    PAF5NB           TH Avg Light Re
     C                     Z-ADDWN0028    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWN0029    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWN0030    PAF2NB           TH Avg Backfat
     C                     Z-ADDWN0031    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWN0032    PAAWPC           TH Actual Yield
     C                     Z-ADDWN0033    PACWPC           TH Adj Actual Y
     C                     Z-ADDWN0034    PAA8PC           TH Yield Differ
     C                     Z-ADDWN0035    PAA7PC           TH Recalc Live
     C                     Z-ADDWN0036    PAB8PR           TH CM Market Pr
     C                     Z-ADDWN0037    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWN0038    PAANPR           TH CM Base Mkt
     C                     Z-ADDWN0039    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWN0040    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWN0041    PAAOPR           TH CM Base Carc
     C                     Z-ADDWN0042    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWN0043    PAAPPR           TH CM Carcass G
     C                     Z-ADDWN0044    PAASPR           TH Deduction Am
     C                     Z-ADDWN0045    PAA4VA           TH Total Net WO
     C                     Z-ADDWN0046    PAATPR           TH Carcass Net
     C                     Z-ADDWN0047    PAA5VA           TH Additions Am
     C                     Z-ADDWN0048    PACBPR           TH Payment Gros
     C                     Z-ADDWN0049    PACCPR           Th Payment Net
     C                     Z-ADDWN0050    PALPNB           TH AP Voucher/D
     C                     Z-ADDWN0051    PACDPR           TH Freight Amou
     C                     Z-ADDWN0052    PAA7VA           TH Accrual Amou
     C                     Z-ADDWN0053    PAA2PR           TH Fixed Cost A
     C                     MOVELWN0054    PAJWST    P      TH Calc Net Sts
     C                     MOVELWN0055    PACWST    P      TH Payment Sts
     C                     MOVEL*BLANK    PAD6ST    P      TH Bal to Kill
     C                     Z-ADDWN0057    PAGHNB           TH Commission A
     C                     Z-ADDWN0058    PABYDT           TH Voucher Paym
     C                     MOVELWN0059    PAE0ST    P      TH User Error O
     C                     MOVELWN0060    PAE1ST    P      TH Held Over Re
     C                     MOVELWN0061    PAE2ST    P      TH Sex
     C                     Z-ADDWN0062    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWN0063    PABTDT           TH Commission P
     C                     Z-ADDWN0064    PABUDT           TH Actual Check
     C                     Z-ADDWN0065    PAHGNB           TH Shipped Weig
     C                     Z-ADDWN0066    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWN0067    PAHINB           TH FFLI
     C                     Z-ADDWN0068    PAA3PR           TH Kill Product
     C                     Z-ADDWN0069    PAA4PR           TH Cut Product
     C                     Z-ADDWN0070    PAA6PR           TH Render Produ
     C                     Z-ADDWN0071    PAJ9NB           TH Head Exclude
     C                     Z-ADDWN0072    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWN0073    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWN0074    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWN0075    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWN0076    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWN0077    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWN0078    PAECPR           TH CM Crc Val L
     C                     Z-ADDWN0079    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWN0080    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWN0081    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWN0082    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWN0083    PAEHPR           TH CM Gross Car
     C                     MOVELWN0084    PAKAST    P      TH Source Type
     C                     MOVELWN0085    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWN0086    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWN0087    PAOXNB           TH HPS Movement
     C                     MOVELWN0088    PALKST    P      TH Source Code
     C                     MOVELWN0089    PALLST    P      TH Hog Class Ty
     C                     MOVELWN0090    PAJ8ST    P      TH Posted to HP
     C                     MOVELWN0091    PALIST    P      TH Schedule Kil
     C                     MOVELWN0092    PALJST    P      TH Shift Held O
     C                     MOVELWN0093    PABDCD    P      DF Defect Code
     C                     MOVELWN0094    PACSCD    P      THP Process Cod
     C                     MOVELWN0095    PAABCD    P      PD Producer Cod
     C                     MOVELWN0096    PAAECD    P      PL Location Cod
     C                     MOVELWN0097    PAACCD    P      HB Buyer Code
     C                     MOVELWN0098    PAAGCD    P      GN Genetic Code
     C                     MOVELWN0099    PABECD    P      HC Class Code
     C                     MOVELWN0100    PAAAVN    P      RS User Changed
     C                     Z-ADDWN0101    PAAADT           RS Date Changed
     C                     Z-ADDWN0102    PAAMTM           RS Time Changed
     C                     MOVELWN0103    PAAJST    P      RS Record Statu
     C                     MOVELWN0104    PAAHVN    P      RS Job
     C                     MOVELWN0105    PAAGVN    P      RS Program
     C                     MOVELWN0106    PAABVN    P      RS User Added
     C                     Z-ADDWN0107    PAABDT           RS Date Added
     C                     Z-ADDWN0108    PAABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM YL0001    WQ0004  71       Carcass Dbw Min
     C                     PARM YL0002    WQ0005  71       Carcass Dbw Max
     C                     PARM YL0003    WQ0006  71       Carcass Lgt Min
     C                     PARM YL0004    WQ0007  71       Carcass Lgt Max
     C                     PARM YL0005    WQ0008  71       %Lean High Min
     C                     PARM YL0006    WQ0009  71       %Lean High Max
     C                     PARM YL0007    WQ0010  71       %Lean Low Min
     C                     PARM YL0008    WQ0011  71       %Lean Low Max
     C                     PARM YL0009    WQ0012  71       High Yield Min
     C                     PARM YL0010    WQ0013  71       High Yield Max
     C                     PARM YL0011    WQ0014  71       Low Yield Min
     C                     PARM YL0012    WQ0015  71       Low Yield Max
     C                     PARM YL0013    WQ0016  71       Head < Percent
     C                     PARM YL0014    WQ0017  71       Head < Percent
     C                     PARM YL0015    WQ0018  71       Head > Percent
     C                     PARM YL0016    WQ0019  71       Head > Percent
     C                     PARM YL0017    WQ0020  71       BackFat High Mi
     C                     PARM YL0018    WQ0021  71       BackFat High Ma
     C                     PARM YL0019    WQ0022  71       BackFat Low Min
     C                     PARM YL0020    WQ0023  71       Backfat Low Max
     C                     PARM YL0021    WQ0024  71       LoinEye High Mi
     C                     PARM YL0022    WQ0025  71       LoinEye High Ma
     C                     PARM YL0023    WQ0026  71       LoinEye Low Min
     C                     PARM YL0024    WQ0027  71       LoinEye Low Max
     C                     PARM 'N'       WQ0028  1        Requested by Us
     C                     PARM *BLANK    WQ0029  1        Bal w/History
     C                     PARM *BLANK    WQ0030  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0031  3        TH PHA Average
     C                     PARM *BLANK    WQ0032  1        TH PHA Add Reas
     C                     PARM 0         WQ0033  51       PH GA Avg Live
     C                     PARM 0         WQ0034  52       PH GA Adjusted
     C                     PARM 0         WQ0035  31       PH GA Avg Lean%
     C                     PARM 0         WQ0036  31       PH GA Avg Backf
     C                     PARM 0         WQ0037  31       PH GA Avg Loin
     C                     PARM 0         WQ0038  31       PH GA Avg Light
     C                     PARM 0         WQ0039  52       PH GA Lean Prm
     C                     PARM 0         WQ0040  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0041  1        Undo MPR USR
     C           YL0031    PARM *BLANK    WQ0042  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.Transfer Carcasses    USR is LT Zero
     C           YL0028    IFLT 0                          *IF
      * Transfer from the Held Over From Date.
     C                     MULT -1        YL0028           Transfer Carcas
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
     C                     EXSR SIRVGN
      * RMC - moved here from below
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
     C                     EXSR SMRVGN
      * RMC chg to PAR to pick up orig kill date fields
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDYL0029    PAB0DT           TH Kill Date
     C                     Z-ADDWN0001    PAAWDT           TH Purchase Dat
     C                     MOVELWN0002    PABICD    P      TH Group Refere
     C                     MOVELWN0003    PACPST    P      TH Live Purchas
     C                     Z-ADDWN0004    PAACPR           TH Live Purchas
     C                     Z-ADDWN0005    PAB9PR           TH Live Gross A
     C                     Z-ADDWN0006    PACAPR           TH LIve Net Amt
     C                     MOVELWN0007    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWN0008    PAAIPR           TH Recalc Live
     C                     Z-ADDWN0009    PAA6DT           TH Pricing Date
     C                     MOVELWN0010    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWN0011    PACXNB           TH Dead On Arri
     C                     Z-ADDWN0012    PACWNB           TH Head Receive
     C                     Z-ADDWN0013    PAFCNB           TH Yard Deads
     C                     Z-ADDWN0014    PAH9NB           TH Held Over
     C                     Z-ADDWN0015    PAFDNB           TH Head Condemn
     C                     Z-ADDWN0016    PAFENB           TH Head Killed
     C                     Z-ADDWN0017    PAHENB           TH Head Adds
     C                     Z-ADDWN0018    PAHFNB           TH Head Accepte
     C                     Z-ADDWN0019    PACYNB           TH Live Wgt
     C                     Z-ADDWN0020    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWN0021    PAE0NB           TH Hot Wgt
     C                     Z-ADDWN0022    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWN0023    PAFBNB           TH Tot Backfat
     C                     Z-ADDWN0024    PAA4PC           TH Tot Light Re
     C                     Z-ADDWN0025    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWN0026    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWN0027    PAF5NB           TH Avg Light Re
     C                     Z-ADDWN0028    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWN0029    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWN0030    PAF2NB           TH Avg Backfat
     C                     Z-ADDWN0031    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWN0032    PAAWPC           TH Actual Yield
     C                     Z-ADDWN0033    PACWPC           TH Adj Actual Y
     C                     Z-ADDWN0034    PAA8PC           TH Yield Differ
     C                     Z-ADDWN0035    PAA7PC           TH Recalc Live
     C                     Z-ADDWN0036    PAB8PR           TH CM Market Pr
     C                     Z-ADDWN0037    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWN0038    PAANPR           TH CM Base Mkt
     C                     Z-ADDWN0039    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWN0040    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWN0041    PAAOPR           TH CM Base Carc
     C                     Z-ADDWN0042    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWN0043    PAAPPR           TH CM Carcass G
     C                     Z-ADDWN0044    PAASPR           TH Deduction Am
     C                     Z-ADDWN0045    PAA4VA           TH Total Net WO
     C                     Z-ADDWN0046    PAATPR           TH Carcass Net
     C                     Z-ADDWN0047    PAA5VA           TH Additions Am
     C                     Z-ADDWN0048    PACBPR           TH Payment Gros
     C                     Z-ADDWN0049    PACCPR           Th Payment Net
     C                     Z-ADDWN0050    PALPNB           TH AP Voucher/D
     C                     Z-ADDWN0051    PACDPR           TH Freight Amou
     C                     Z-ADDWN0052    PAA7VA           TH Accrual Amou
     C                     Z-ADDWN0053    PAA2PR           TH Fixed Cost A
     C                     MOVELWN0054    PAJWST    P      TH Calc Net Sts
     C                     MOVELWN0055    PACWST    P      TH Payment Sts
     C                     MOVEL*BLANK    PAD6ST    P      TH Bal to Kill
     C                     Z-ADDWN0057    PAGHNB           TH Commission A
     C                     Z-ADDWN0058    PABYDT           TH Voucher Paym
     C                     MOVELWN0059    PAE0ST    P      TH User Error O
     C                     MOVELWN0060    PAE1ST    P      TH Held Over Re
     C                     MOVELWN0061    PAE2ST    P      TH Sex
     C                     Z-ADDWN0062    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWN0063    PABTDT           TH Commission P
     C                     Z-ADDWN0064    PABUDT           TH Actual Check
     C                     Z-ADDWN0065    PAHGNB           TH Shipped Weig
     C                     Z-ADDWN0066    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWN0067    PAHINB           TH FFLI
     C                     Z-ADDWN0068    PAA3PR           TH Kill Product
     C                     Z-ADDWN0069    PAA4PR           TH Cut Product
     C                     Z-ADDWN0070    PAA6PR           TH Render Produ
     C                     Z-ADDWN0071    PAJ9NB           TH Head Exclude
     C                     Z-ADDWN0072    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWN0073    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWN0074    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWN0075    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWN0076    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWN0077    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWN0078    PAECPR           TH CM Crc Val L
     C                     Z-ADDWN0079    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWN0080    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWN0081    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWN0082    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWN0083    PAEHPR           TH CM Gross Car
     C                     MOVELWN0084    PAKAST    P      TH Source Type
     C                     MOVELWN0085    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWN0086    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWN0087    PAOXNB           TH HPS Movement
     C                     MOVELWN0088    PALKST    P      TH Source Code
     C                     MOVELWN0089    PALLST    P      TH Hog Class Ty
     C                     MOVELWN0090    PAJ8ST    P      TH Posted to HP
     C                     MOVELWN0091    PALIST    P      TH Schedule Kil
     C                     MOVELWN0092    PALJST    P      TH Shift Held O
     C                     MOVELWN0093    PABDCD    P      DF Defect Code
     C                     MOVELWN0094    PACSCD    P      THP Process Cod
     C                     MOVELWN0095    PAABCD    P      PD Producer Cod
     C                     MOVELWN0096    PAAECD    P      PL Location Cod
     C                     MOVELWN0097    PAACCD    P      HB Buyer Code
     C                     MOVELWN0098    PAAGCD    P      GN Genetic Code
     C                     MOVELWN0099    PABECD    P      HC Class Code
     C                     MOVELWN0100    PAAAVN    P      RS User Changed
     C                     Z-ADDWN0101    PAAADT           RS Date Changed
     C                     Z-ADDWN0102    PAAMTM           RS Time Changed
     C                     MOVELWN0103    PAAJST    P      RS Record Statu
     C                     MOVELWN0104    PAAHVN    P      RS Job
     C                     MOVELWN0105    PAAGVN    P      RS Program
     C                     MOVELWN0106    PAABVN    P      RS User Added
     C                     Z-ADDWN0107    PAABDT           RS Date Added
     C                     Z-ADDWN0108    PAABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM YL0001    WQ0043  71       Carcass Dbw Min
     C                     PARM YL0002    WQ0044  71       Carcass Dbw Max
     C                     PARM YL0003    WQ0045  71       Carcass Lgt Min
     C                     PARM YL0004    WQ0046  71       Carcass Lgt Max
     C                     PARM YL0005    WQ0047  71       %Lean High Min
     C                     PARM YL0006    WQ0048  71       %Lean High Max
     C                     PARM YL0007    WQ0049  71       %Lean Low Min
     C                     PARM YL0008    WQ0050  71       %Lean Low Max
     C                     PARM YL0009    WQ0051  71       High Yield Min
     C                     PARM YL0010    WQ0052  71       High Yield Max
     C                     PARM YL0011    WQ0053  71       Low Yield Min
     C                     PARM YL0012    WQ0054  71       Low Yield Max
     C                     PARM YL0013    WQ0055  71       Head < Percent
     C                     PARM YL0014    WQ0056  71       Head < Percent
     C                     PARM YL0015    WQ0057  71       Head > Percent
     C                     PARM YL0016    WQ0058  71       Head > Percent
     C                     PARM YL0017    WQ0059  71       BackFat High Mi
     C                     PARM YL0018    WQ0060  71       BackFat High Ma
     C                     PARM YL0019    WQ0061  71       BackFat Low Min
     C                     PARM YL0020    WQ0062  71       Backfat Low Max
     C                     PARM YL0021    WQ0063  71       LoinEye High Mi
     C                     PARM YL0022    WQ0064  71       LoinEye High Ma
     C                     PARM YL0023    WQ0065  71       LoinEye Low Min
     C                     PARM YL0024    WQ0066  71       LoinEye Low Max
     C                     PARM 'N'       WQ0067  1        Requested by Us
     C                     PARM *BLANK    WQ0068  1        Bal w/History
     C                     PARM *BLANK    WQ0069  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0070  3        TH PHA Average
     C                     PARM *BLANK    WQ0071  1        TH PHA Add Reas
     C                     PARM 0         WQ0072  51       PH GA Avg Live
     C                     PARM 0         WQ0073  52       PH GA Adjusted
     C                     PARM 0         WQ0074  31       PH GA Avg Lean%
     C                     PARM 0         WQ0075  31       PH GA Avg Backf
     C                     PARM 0         WQ0076  31       PH GA Avg Loin
     C                     PARM 0         WQ0077  31       PH GA Avg Light
     C                     PARM 0         WQ0078  52       PH GA Lean Prm
     C                     PARM 0         WQ0079  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0080  1        Undo MPR USR
     C           YL0031    PARM *BLANK    WQ0081  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Balance Held From Date.
      * RMC chg to PAR to pick up orig kill date fields - and moved up
      *      to run only if a transfer is necessary     6/11/18
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSD02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSD03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSD04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSD05           TH Kill Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
     C                     KFLD           WQSD03           BOL Load Number
     C                     KFLD           WQSD04           TH Tattoo Numbe
     C                     KFLD           WQSD05           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WQSD01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSD02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSD03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSD04           TH Tattoo Numbe
     C                     Z-ADDYL0030    WQSD05           TH Kill Date
      * Establish starting position
     C           KRSSD     SETLL@BVCPQ9                    *
     C           KRSSD     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Transfer Carcasses    USR is GT Zero
     C           YL0028    IFGT 0                          *IF
      * 9/29/2010 slm check for deleted record
      * do not move the record if this is a deleted record
      * CASE: DB1.RS Record Status is Flag for Purge
     C           WCAJST    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR SERVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR SFCRRC
      * Dlt Eval Trans        DL - Eval Trans  * 
     C                     EXSR SGDLRC
     C                     SUB  1         YL0028           Transfer Carcas
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHSNB    WQSE01           ET Company Numb
     C           *LIKE     DEFN WDA9DT    WQSE02           ET Kill Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           ET Company Numb
     C                     KFLD           WQSE02           ET Kill Date
      * Setup key
     C                     Z-ADDWCHSNB    WQSE01           ET Company Numb
     C                     Z-ADDYL0029    WQSE02           ET Kill Date
      * Establish starting position
     C           KRSSE     SETLL@BVCPNE                    *
     C           KRSSE     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUFJNB           ET Scale Sequen
     C                     GOTO SEEXIT                     *QUIT
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WDFJNB    IFGE 000001                     *IF
     C           WDFJNB    ANDLE699999
     C           WDFJNB    ADD  1         WUFJNB           ET Scale Sequen
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDWCHSNB    WEHSNB           ET Company Numb
     C                     Z-ADDYL0029    WEA9DT           ET Kill Date
     C                     Z-ADDWUFJNB    WEFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WEHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WEGDNB           ET Carcass Numb
     C                     Z-ADDWBCVNB    WEFINB           ET Tattoo Numbe
     C                     Z-ADDWCLKNB    WELKNB           ET Lot
     C                     MOVELWCEAST    WEEAST           ET Shift
     C                     Z-ADDWCAMPC    WEAMPC           ET Hot Wgt
     C                     Z-ADDWCAIPC    WEAIPC           ET Backfat Thic
     C                     Z-ADDWCAJPC    WEAJPC           ET Loin-Eye Dep
     C                     Z-ADDWCAKPC    WEAKPC           ET Lean Percent
     C                     Z-ADDWCX8NB    WEX8NB           ET Backfat Thic
     C                     Z-ADDWCFVPC    WEFVPC           ET Loineye Dept
     C                     Z-ADDWCFWPC    WEFWPC           ET Light Reflec
     C                     Z-ADDWCFXPC    WEFXPC           ET Lean Percent
     C                     Z-ADDWCALPC    WEALPC           ET Light Reflec
     C                     MOVELWCDIST    WEDIST           ET Trim Area
     C                     MOVELWCFYST    WEFYST           ET Carcass Sex
     C                     MOVELWCD2ST    WED2ST           ET Error Sts
     C                     MOVELWCEHST    WEEHST           ET Record Add/D
     C                     MOVELWCG1ST    WEG1ST           ET Record Creat
     C                     MOVELWCH4ST    WEH4ST           ET Record Creat
     C                     MOVELWCJLST    WEJLST           ET User Error O
     C                     MOVELWCUUST    WEUUST           ET Adjust/Add T
     C                     MOVELWCVHST    WEVHST           ET Broken Back
     C                     MOVELWCVIST    WEVIST           ET Unused Sts 2
     C                     MOVELWCVJST    WEVJST           ET Adjust/Add S
     C                     MOVELWCVKST    WEVKST           ET Unused Sts 4
     C                     MOVELWCVLST    WEVLST           ET Unused Sts 5
     C                     Z-ADDWCHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDYL0029    WEB0DT           TH Kill Date
     C                     MOVEL*BLANK    WEAAVN           RS User Changed
     C                     Z-ADD0         WEAADT           RS Date Changed
     C                     Z-ADD0         WEAMTM           RS Time Changed
     C                     MOVELWCAJST    WEAJST           RS Record Statu
     C                     MOVELWCAHVN    WEAHVN           RS Job
     C                     MOVELWCAGVN    WEAGVN           RS Program
     C                     MOVELWCABVN    WEABVN           RS User Added
     C                     Z-ADDWCABDT    WEABDT           RS Date Added
     C                     Z-ADDWCABTM    WEABTM           RS Time Added
     C                     Z-ADDWCB8DT    WEB8DT           RU Date
     C                     Z-ADDWCAOTM    WEAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WEAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WEAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSF    KLIST
     C                     KFLD           WEHSNB           ET Company Numb
     C                     KFLD           WEA9DT           ET Kill Date
     C                     KFLD           WEFJNB           ET Scale Sequen
     C                     KFLD           WEHCNB           ET Carcass Numb
     C                     KFLD           WEGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRSF    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * Dlt Eval Trans        DL - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WEHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WEA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WEFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WEHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WEGDNB           ET Carcass Numb
      *
     C           KLDLSG    KLIST
     C                     KFLD           WEHSNB           ET Company Numb
     C                     KFLD           WEA9DT           ET Kill Date
     C                     KFLD           WEFJNB           ET Scale Sequen
     C                     KFLD           WEHCNB           ET Carcass Numb
     C                     KFLD           WEGDNB           ET Carcass Numb
     C           KLDLSG    CHAIN@BVCPF0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BVCPF0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WBBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDYL0029    WBB0DT           TH Kill Date
      * Establish starting position
     C           KRSSH     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           TH Purchase Dat
     C                     MOVEL*BLANK    WN0002           TH Group Refere
     C                     MOVEL*BLANK    WN0003           TH Live Purchas
     C                     Z-ADD*ZERO     WN0004           TH Live Purchas
     C                     Z-ADD*ZERO     WN0005           TH Live Gross A
     C                     Z-ADD*ZERO     WN0006           TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007           TH Resale UOM
     C                     Z-ADD*ZERO     WN0008           TH Recalc Live
     C                     Z-ADD*ZERO     WN0009           TH Pricing Date
     C                     MOVEL*BLANK    WN0010           TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011           TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012           TH Head Receive
     C                     Z-ADD*ZERO     WN0013           TH Yard Deads
     C                     Z-ADD*ZERO     WN0014           TH Held Over
     C                     Z-ADD*ZERO     WN0015           TH Head Condemn
     C                     Z-ADD*ZERO     WN0016           TH Head Killed
     C                     Z-ADD*ZERO     WN0017           TH Head Adds
     C                     Z-ADD*ZERO     WN0018           TH Head Accepte
     C                     Z-ADD*ZERO     WN0019           TH Live Wgt
     C                     Z-ADD*ZERO     WN0020           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021           TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023           TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024           TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027           TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028           TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030           TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031           TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032           TH Actual Yield
     C                     Z-ADD*ZERO     WN0033           TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034           TH Yield Differ
     C                     Z-ADD*ZERO     WN0035           TH Recalc Live
     C                     Z-ADD*ZERO     WN0036           TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039           TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040           TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041           TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043           TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044           TH Deduction Am
     C                     Z-ADD*ZERO     WN0045           TH Total Net WO
     C                     Z-ADD*ZERO     WN0046           TH Carcass Net
     C                     Z-ADD*ZERO     WN0047           TH Additions Am
     C                     Z-ADD*ZERO     WN0048           TH Payment Gros
     C                     Z-ADD*ZERO     WN0049           Th Payment Net
     C                     Z-ADD*ZERO     WN0050           TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051           TH Freight Amou
     C                     Z-ADD*ZERO     WN0052           TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053           TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054           TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055           TH Payment Sts
     C                     MOVEL*BLANK    WN0056           TH Bal to Kill
     C                     Z-ADD*ZERO     WN0057           TH Commission A
     C                     Z-ADD*ZERO     WN0058           TH Voucher Paym
     C                     MOVEL*BLANK    WN0059           TH User Error O
     C                     MOVEL*BLANK    WN0060           TH Held Over Re
     C                     MOVEL*BLANK    WN0061           TH Sex
     C                     Z-ADD*ZERO     WN0062           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0063           TH Commission P
     C                     Z-ADD*ZERO     WN0064           TH Actual Check
     C                     Z-ADD*ZERO     WN0065           TH Shipped Weig
     C                     Z-ADD*ZERO     WN0066           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0067           TH FFLI
     C                     Z-ADD*ZERO     WN0068           TH Kill Product
     C                     Z-ADD*ZERO     WN0069           TH Cut Product
     C                     Z-ADD*ZERO     WN0070           TH Render Produ
     C                     Z-ADD*ZERO     WN0071           TH Head Exclude
     C                     Z-ADD*ZERO     WN0072           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0073           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0074           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0075           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0076           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0077           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0078           TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0079           TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0080           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0081           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082           TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0083           TH CM Gross Car
     C                     MOVEL*BLANK    WN0084           TH Source Type
     C                     MOVEL*BLANK    WN0085           TH Scale Ticket
     C                     MOVEL*BLANK    WN0086           TH Payment Type
     C                     Z-ADD*ZERO     WN0087           TH HPS Movement
     C                     MOVEL*BLANK    WN0088           TH Source Code
     C                     MOVEL*BLANK    WN0089           TH Hog Class Ty
     C                     MOVEL*BLANK    WN0090           TH Posted to HP
     C                     MOVEL*BLANK    WN0091           TH Schedule Kil
     C                     MOVEL*BLANK    WN0092           TH Shift Held O
     C                     MOVEL*BLANK    WN0093           DF Defect Code
     C                     MOVEL*BLANK    WN0094           THP Process Cod
     C                     MOVEL*BLANK    WN0095           PD Producer Cod
     C                     MOVEL*BLANK    WN0096           PL Location Cod
     C                     MOVEL*BLANK    WN0097           HB Buyer Code
     C                     MOVEL*BLANK    WN0098           GN Genetic Code
     C                     MOVEL*BLANK    WN0099           HC Class Code
     C                     MOVEL*BLANK    WN0100           RS User Changed
     C                     Z-ADD*ZERO     WN0101           RS Date Changed
     C                     Z-ADD*ZERO     WN0102           RS Time Changed
     C                     MOVEL*BLANK    WN0103           RS Record Statu
     C                     MOVEL*BLANK    WN0104           RS Job
     C                     MOVEL*BLANK    WN0105           RS Program
     C                     MOVEL*BLANK    WN0106           RS User Added
     C                     Z-ADD*ZERO     WN0107           RS Date Added
     C                     Z-ADD*ZERO     WN0108           RS Time Added
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAWDT    WN0001           TH Purchase Dat
     C                     MOVELWBBICD    WN0002           TH Group Refere
     C                     MOVELWBCPST    WN0003           TH Live Purchas
     C                     Z-ADDWBACPR    WN0004           TH Live Purchas
     C                     Z-ADDWBB9PR    WN0005           TH Live Gross A
     C                     Z-ADDWBCAPR    WN0006           TH LIve Net Amt
     C                     MOVELWBC4ST    WN0007           TH Resale UOM
     C                     Z-ADDWBAIPR    WN0008           TH Recalc Live
     C                     Z-ADDWBA6DT    WN0009           TH Pricing Date
     C                     MOVELWBC2ST    WN0010           TH Resale Sprea
     C                     Z-ADDWBCXNB    WN0011           TH Dead On Arri
     C                     Z-ADDWBCWNB    WN0012           TH Head Receive
     C                     Z-ADDWBFCNB    WN0013           TH Yard Deads
     C                     Z-ADDWBH9NB    WN0014           TH Held Over
     C                     Z-ADDWBFDNB    WN0015           TH Head Condemn
     C                     Z-ADDWBFENB    WN0016           TH Head Killed
     C                     Z-ADDWBHENB    WN0017           TH Head Adds
     C                     Z-ADDWBHFNB    WN0018           TH Head Accepte
     C                     Z-ADDWBCYNB    WN0019           TH Live Wgt
     C                     Z-ADDWBLRNB    WN0020           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    WN0021           TH Hot Wgt
     C                     Z-ADDWBA5PC    WN0022           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    WN0023           TH Tot Backfat
     C                     Z-ADDWBA4PC    WN0024           TH Tot Light Re
     C                     Z-ADDWBF7NB    WN0025           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    WN0026           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    WN0027           TH Avg Light Re
     C                     Z-ADDWBF4NB    WN0028           TH Avg Lean Per
     C                     Z-ADDWBF3NB    WN0029           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    WN0030           TH Avg Backfat
     C                     Z-ADDWBAVPC    WN0031           TH Std Yield Pe
     C                     Z-ADDWBAWPC    WN0032           TH Actual Yield
     C                     Z-ADDWBCWPC    WN0033           TH Adj Actual Y
     C                     Z-ADDWBA8PC    WN0034           TH Yield Differ
     C                     Z-ADDWBA7PC    WN0035           TH Recalc Live
     C                     Z-ADDWBB8PR    WN0036           TH CM Market Pr
     C                     Z-ADDWBAMPR    WN0037           TH CM Base Mkt
     C                     Z-ADDWBANPR    WN0038           TH CM Base Mkt
     C                     Z-ADDWBAYVA    WN0039           TH CM Sort Disc
     C                     Z-ADDWBAWVA    WN0040           TH CM Yield Gai
     C                     Z-ADDWBAOPR    WN0041           TH CM Base Carc
     C                     Z-ADDWBAXVA    WN0042           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    WN0043           TH CM Carcass G
     C                     Z-ADDWBASPR    WN0044           TH Deduction Am
     C                     Z-ADDWBA4VA    WN0045           TH Total Net WO
     C                     Z-ADDWBATPR    WN0046           TH Carcass Net
     C                     Z-ADDWBA5VA    WN0047           TH Additions Am
     C                     Z-ADDWBCBPR    WN0048           TH Payment Gros
     C                     Z-ADDWBCCPR    WN0049           Th Payment Net
     C                     Z-ADDWBLPNB    WN0050           TH AP Voucher/D
     C                     Z-ADDWBCDPR    WN0051           TH Freight Amou
     C                     Z-ADDWBA7VA    WN0052           TH Accrual Amou
     C                     Z-ADDWBA2PR    WN0053           TH Fixed Cost A
     C                     MOVELWBJWST    WN0054           TH Calc Net Sts
     C                     MOVELWBCWST    WN0055           TH Payment Sts
     C                     MOVELWBD6ST    WN0056           TH Bal to Kill
     C                     Z-ADDWBGHNB    WN0057           TH Commission A
     C                     Z-ADDWBBYDT    WN0058           TH Voucher Paym
     C                     MOVELWBE0ST    WN0059           TH User Error O
     C                     MOVELWBE1ST    WN0060           TH Held Over Re
     C                     MOVELWBE2ST    WN0061           TH Sex
     C                     Z-ADDWBBSDT    WN0062           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    WN0063           TH Commission P
     C                     Z-ADDWBBUDT    WN0064           TH Actual Check
     C                     Z-ADDWBHGNB    WN0065           TH Shipped Weig
     C                     Z-ADDWBHHNB    WN0066           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    WN0067           TH FFLI
     C                     Z-ADDWBA3PR    WN0068           TH Kill Product
     C                     Z-ADDWBA4PR    WN0069           TH Cut Product
     C                     Z-ADDWBA6PR    WN0070           TH Render Produ
     C                     Z-ADDWBJ9NB    WN0071           TH Head Exclude
     C                     Z-ADDWBD6PR    WN0072           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    WN0073           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    WN0074           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    WN0075           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    WN0076           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    WN0077           TH CM Yld G/L C
     C                     Z-ADDWBECPR    WN0078           TH CM Crc Val L
     C                     Z-ADDWBEDPR    WN0079           TH CM Crc Val C
     C                     Z-ADDWBEEPR    WN0080           TH CM Lean Prem
     C                     Z-ADDWBEFPR    WN0081           TH CM Lean Prem
     C                     Z-ADDWBEGPR    WN0082           TH CM Gross Liv
     C                     Z-ADDWBEHPR    WN0083           TH CM Gross Car
     C                     MOVELWBKAST    WN0084           TH Source Type
     C                     MOVELWBJ7ST    WN0085           TH Scale Ticket
     C                     MOVELWBJ9ST    WN0086           TH Payment Type
     C                     Z-ADDWBOXNB    WN0087           TH HPS Movement
     C                     MOVELWBLKST    WN0088           TH Source Code
     C                     MOVELWBLLST    WN0089           TH Hog Class Ty
     C                     MOVELWBJ8ST    WN0090           TH Posted to HP
     C                     MOVELWBLIST    WN0091           TH Schedule Kil
     C                     MOVELWBLJST    WN0092           TH Shift Held O
     C                     MOVELWBBDCD    WN0093           DF Defect Code
     C                     MOVELWBCSCD    WN0094           THP Process Cod
     C                     MOVELWBABCD    WN0095           PD Producer Cod
     C                     MOVELWBAECD    WN0096           PL Location Cod
     C                     MOVELWBACCD    WN0097           HB Buyer Code
     C                     MOVELWBAGCD    WN0098           GN Genetic Code
     C                     MOVELWBBECD    WN0099           HC Class Code
     C                     MOVELWBAAVN    WN0100           RS User Changed
     C                     Z-ADDWBAADT    WN0101           RS Date Changed
     C                     Z-ADDWBAMTM    WN0102           RS Time Changed
     C                     MOVELWBAJST    WN0103           RS Record Statu
     C                     MOVELWBAHVN    WN0104           RS Job
     C                     MOVELWBAGVN    WN0105           RS Program
     C                     MOVELWBABVN    WN0106           RS User Added
     C                     Z-ADDWBABDT    WN0107           RS Date Added
     C                     Z-ADDWBABTM    WN0108           RS Time Added
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSI02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSI03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSI04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSI05           TH Kill Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
     C                     KFLD           WQSI03           BOL Load Number
     C                     KFLD           WQSI04           TH Tattoo Numbe
     C                     KFLD           WQSI05           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WQSI01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSI02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSI03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSI04           TH Tattoo Numbe
     C                     Z-ADDYL0029    WQSI05           TH Kill Date
      * Establish starting position
     C           KRSSI     SETLL@BVCPQ9                    *
     C           KRSSI     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Transfer Carcasses    USR is GT Zero
     C           YL0028    IFGT 0                          *IF
      * 9/29/2010 slm check for deleted record
      * do not move the record if this is a deleted record
      * CASE: DB1.RS Record Status is Flag for Purge
     C           WCAJST    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR SJRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR SKCRRC
      * Dlt Eval Trans        DL - Eval Trans  * 
     C                     EXSR SLDLRC
     C                     SUB  1         YL0028           Transfer Carcas
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHSNB    WQSJ01           ET Company Numb
     C           *LIKE     DEFN WDA9DT    WQSJ02           ET Kill Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           ET Company Numb
     C                     KFLD           WQSJ02           ET Kill Date
      * Setup key
     C                     Z-ADDWCHSNB    WQSJ01           ET Company Numb
     C                     Z-ADDYL0030    WQSJ02           ET Kill Date
      * Establish starting position
     C           KRSSJ     SETLL@BVCPNE                    *
     C           KRSSJ     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUFJNB           ET Scale Sequen
     C                     GOTO SJEXIT                     *QUIT
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WDFJNB    IFGE 000001                     *IF
     C           WDFJNB    ANDLE699999
     C           WDFJNB    ADD  1         WUFJNB           ET Scale Sequen
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSJ     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDWCHSNB    WEHSNB           ET Company Numb
     C                     Z-ADDYL0030    WEA9DT           ET Kill Date
     C                     Z-ADDWUFJNB    WEFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WEHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WEGDNB           ET Carcass Numb
     C                     Z-ADDWBCVNB    WEFINB           ET Tattoo Numbe
     C                     Z-ADDWCLKNB    WELKNB           ET Lot
     C                     MOVELWCEAST    WEEAST           ET Shift
     C                     Z-ADDWCAMPC    WEAMPC           ET Hot Wgt
     C                     Z-ADDWCAIPC    WEAIPC           ET Backfat Thic
     C                     Z-ADDWCAJPC    WEAJPC           ET Loin-Eye Dep
     C                     Z-ADDWCAKPC    WEAKPC           ET Lean Percent
     C                     Z-ADDWCX8NB    WEX8NB           ET Backfat Thic
     C                     Z-ADDWCFVPC    WEFVPC           ET Loineye Dept
     C                     Z-ADDWCFWPC    WEFWPC           ET Light Reflec
     C                     Z-ADDWCFXPC    WEFXPC           ET Lean Percent
     C                     Z-ADDWCALPC    WEALPC           ET Light Reflec
     C                     MOVELWCDIST    WEDIST           ET Trim Area
     C                     MOVELWCFYST    WEFYST           ET Carcass Sex
     C                     MOVELWCD2ST    WED2ST           ET Error Sts
     C                     MOVELWCEHST    WEEHST           ET Record Add/D
     C                     MOVELWCG1ST    WEG1ST           ET Record Creat
     C                     MOVELWCH4ST    WEH4ST           ET Record Creat
     C                     MOVELWCJLST    WEJLST           ET User Error O
     C                     MOVELWCUUST    WEUUST           ET Adjust/Add T
     C                     MOVELWCVHST    WEVHST           ET Broken Back
     C                     MOVELWCVIST    WEVIST           ET Unused Sts 2
     C                     MOVELWCVJST    WEVJST           ET Adjust/Add S
     C                     MOVELWCVKST    WEVKST           ET Unused Sts 4
     C                     MOVELWCVLST    WEVLST           ET Unused Sts 5
     C                     Z-ADDWCHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDYL0030    WEB0DT           TH Kill Date
     C                     MOVEL*BLANK    WEAAVN           RS User Changed
     C                     Z-ADD0         WEAADT           RS Date Changed
     C                     Z-ADD0         WEAMTM           RS Time Changed
     C                     MOVELWCAJST    WEAJST           RS Record Statu
     C                     MOVELWCAHVN    WEAHVN           RS Job
     C                     MOVELWCAGVN    WEAGVN           RS Program
     C                     MOVELWCABVN    WEABVN           RS User Added
     C                     Z-ADDWCABDT    WEABDT           RS Date Added
     C                     Z-ADDWCABTM    WEABTM           RS Time Added
     C                     Z-ADDWCB8DT    WEB8DT           RU Date
     C                     Z-ADDWCAOTM    WEAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WEAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WEAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSK    KLIST
     C                     KFLD           WEHSNB           ET Company Numb
     C                     KFLD           WEA9DT           ET Kill Date
     C                     KFLD           WEFJNB           ET Scale Sequen
     C                     KFLD           WEHCNB           ET Carcass Numb
     C                     KFLD           WEGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRSK    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * Dlt Eval Trans        DL - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WEHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WEA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WEFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WEHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WEGDNB           ET Carcass Numb
      *
     C           KLDLSL    KLIST
     C                     KFLD           WEHSNB           ET Company Numb
     C                     KFLD           WEA9DT           ET Kill Date
     C                     KFLD           WEFJNB           ET Scale Sequen
     C                     KFLD           WEHCNB           ET Carcass Numb
     C                     KFLD           WEGDNB           ET Carcass Numb
     C           KLDLSL    CHAIN@BVCPF0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BVCPF0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WBBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDYL0029    WBB0DT           TH Kill Date
      * Establish starting position
     C           KRSSM     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           TH Purchase Dat
     C                     MOVEL*BLANK    WN0002           TH Group Refere
     C                     MOVEL*BLANK    WN0003           TH Live Purchas
     C                     Z-ADD*ZERO     WN0004           TH Live Purchas
     C                     Z-ADD*ZERO     WN0005           TH Live Gross A
     C                     Z-ADD*ZERO     WN0006           TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007           TH Resale UOM
     C                     Z-ADD*ZERO     WN0008           TH Recalc Live
     C                     Z-ADD*ZERO     WN0009           TH Pricing Date
     C                     MOVEL*BLANK    WN0010           TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011           TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012           TH Head Receive
     C                     Z-ADD*ZERO     WN0013           TH Yard Deads
     C                     Z-ADD*ZERO     WN0014           TH Held Over
     C                     Z-ADD*ZERO     WN0015           TH Head Condemn
     C                     Z-ADD*ZERO     WN0016           TH Head Killed
     C                     Z-ADD*ZERO     WN0017           TH Head Adds
     C                     Z-ADD*ZERO     WN0018           TH Head Accepte
     C                     Z-ADD*ZERO     WN0019           TH Live Wgt
     C                     Z-ADD*ZERO     WN0020           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021           TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023           TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024           TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027           TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028           TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030           TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031           TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032           TH Actual Yield
     C                     Z-ADD*ZERO     WN0033           TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034           TH Yield Differ
     C                     Z-ADD*ZERO     WN0035           TH Recalc Live
     C                     Z-ADD*ZERO     WN0036           TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039           TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040           TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041           TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043           TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044           TH Deduction Am
     C                     Z-ADD*ZERO     WN0045           TH Total Net WO
     C                     Z-ADD*ZERO     WN0046           TH Carcass Net
     C                     Z-ADD*ZERO     WN0047           TH Additions Am
     C                     Z-ADD*ZERO     WN0048           TH Payment Gros
     C                     Z-ADD*ZERO     WN0049           Th Payment Net
     C                     Z-ADD*ZERO     WN0050           TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051           TH Freight Amou
     C                     Z-ADD*ZERO     WN0052           TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053           TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054           TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055           TH Payment Sts
     C                     MOVEL*BLANK    WN0056           TH Bal to Kill
     C                     Z-ADD*ZERO     WN0057           TH Commission A
     C                     Z-ADD*ZERO     WN0058           TH Voucher Paym
     C                     MOVEL*BLANK    WN0059           TH User Error O
     C                     MOVEL*BLANK    WN0060           TH Held Over Re
     C                     MOVEL*BLANK    WN0061           TH Sex
     C                     Z-ADD*ZERO     WN0062           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0063           TH Commission P
     C                     Z-ADD*ZERO     WN0064           TH Actual Check
     C                     Z-ADD*ZERO     WN0065           TH Shipped Weig
     C                     Z-ADD*ZERO     WN0066           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0067           TH FFLI
     C                     Z-ADD*ZERO     WN0068           TH Kill Product
     C                     Z-ADD*ZERO     WN0069           TH Cut Product
     C                     Z-ADD*ZERO     WN0070           TH Render Produ
     C                     Z-ADD*ZERO     WN0071           TH Head Exclude
     C                     Z-ADD*ZERO     WN0072           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0073           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0074           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0075           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0076           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0077           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0078           TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0079           TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0080           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0081           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082           TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0083           TH CM Gross Car
     C                     MOVEL*BLANK    WN0084           TH Source Type
     C                     MOVEL*BLANK    WN0085           TH Scale Ticket
     C                     MOVEL*BLANK    WN0086           TH Payment Type
     C                     Z-ADD*ZERO     WN0087           TH HPS Movement
     C                     MOVEL*BLANK    WN0088           TH Source Code
     C                     MOVEL*BLANK    WN0089           TH Hog Class Ty
     C                     MOVEL*BLANK    WN0090           TH Posted to HP
     C                     MOVEL*BLANK    WN0091           TH Schedule Kil
     C                     MOVEL*BLANK    WN0092           TH Shift Held O
     C                     MOVEL*BLANK    WN0093           DF Defect Code
     C                     MOVEL*BLANK    WN0094           THP Process Cod
     C                     MOVEL*BLANK    WN0095           PD Producer Cod
     C                     MOVEL*BLANK    WN0096           PL Location Cod
     C                     MOVEL*BLANK    WN0097           HB Buyer Code
     C                     MOVEL*BLANK    WN0098           GN Genetic Code
     C                     MOVEL*BLANK    WN0099           HC Class Code
     C                     MOVEL*BLANK    WN0100           RS User Changed
     C                     Z-ADD*ZERO     WN0101           RS Date Changed
     C                     Z-ADD*ZERO     WN0102           RS Time Changed
     C                     MOVEL*BLANK    WN0103           RS Record Statu
     C                     MOVEL*BLANK    WN0104           RS Job
     C                     MOVEL*BLANK    WN0105           RS Program
     C                     MOVEL*BLANK    WN0106           RS User Added
     C                     Z-ADD*ZERO     WN0107           RS Date Added
     C                     Z-ADD*ZERO     WN0108           RS Time Added
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAWDT    WN0001           TH Purchase Dat
     C                     MOVELWBBICD    WN0002           TH Group Refere
     C                     MOVELWBCPST    WN0003           TH Live Purchas
     C                     Z-ADDWBACPR    WN0004           TH Live Purchas
     C                     Z-ADDWBB9PR    WN0005           TH Live Gross A
     C                     Z-ADDWBCAPR    WN0006           TH LIve Net Amt
     C                     MOVELWBC4ST    WN0007           TH Resale UOM
     C                     Z-ADDWBAIPR    WN0008           TH Recalc Live
     C                     Z-ADDWBA6DT    WN0009           TH Pricing Date
     C                     MOVELWBC2ST    WN0010           TH Resale Sprea
     C                     Z-ADDWBCXNB    WN0011           TH Dead On Arri
     C                     Z-ADDWBCWNB    WN0012           TH Head Receive
     C                     Z-ADDWBFCNB    WN0013           TH Yard Deads
     C                     Z-ADDWBH9NB    WN0014           TH Held Over
     C                     Z-ADDWBFDNB    WN0015           TH Head Condemn
     C                     Z-ADDWBFENB    WN0016           TH Head Killed
     C                     Z-ADDWBHENB    WN0017           TH Head Adds
     C                     Z-ADDWBHFNB    WN0018           TH Head Accepte
     C                     Z-ADDWBCYNB    WN0019           TH Live Wgt
     C                     Z-ADDWBLRNB    WN0020           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    WN0021           TH Hot Wgt
     C                     Z-ADDWBA5PC    WN0022           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    WN0023           TH Tot Backfat
     C                     Z-ADDWBA4PC    WN0024           TH Tot Light Re
     C                     Z-ADDWBF7NB    WN0025           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    WN0026           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    WN0027           TH Avg Light Re
     C                     Z-ADDWBF4NB    WN0028           TH Avg Lean Per
     C                     Z-ADDWBF3NB    WN0029           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    WN0030           TH Avg Backfat
     C                     Z-ADDWBAVPC    WN0031           TH Std Yield Pe
     C                     Z-ADDWBAWPC    WN0032           TH Actual Yield
     C                     Z-ADDWBCWPC    WN0033           TH Adj Actual Y
     C                     Z-ADDWBA8PC    WN0034           TH Yield Differ
     C                     Z-ADDWBA7PC    WN0035           TH Recalc Live
     C                     Z-ADDWBB8PR    WN0036           TH CM Market Pr
     C                     Z-ADDWBAMPR    WN0037           TH CM Base Mkt
     C                     Z-ADDWBANPR    WN0038           TH CM Base Mkt
     C                     Z-ADDWBAYVA    WN0039           TH CM Sort Disc
     C                     Z-ADDWBAWVA    WN0040           TH CM Yield Gai
     C                     Z-ADDWBAOPR    WN0041           TH CM Base Carc
     C                     Z-ADDWBAXVA    WN0042           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    WN0043           TH CM Carcass G
     C                     Z-ADDWBASPR    WN0044           TH Deduction Am
     C                     Z-ADDWBA4VA    WN0045           TH Total Net WO
     C                     Z-ADDWBATPR    WN0046           TH Carcass Net
     C                     Z-ADDWBA5VA    WN0047           TH Additions Am
     C                     Z-ADDWBCBPR    WN0048           TH Payment Gros
     C                     Z-ADDWBCCPR    WN0049           Th Payment Net
     C                     Z-ADDWBLPNB    WN0050           TH AP Voucher/D
     C                     Z-ADDWBCDPR    WN0051           TH Freight Amou
     C                     Z-ADDWBA7VA    WN0052           TH Accrual Amou
     C                     Z-ADDWBA2PR    WN0053           TH Fixed Cost A
     C                     MOVELWBJWST    WN0054           TH Calc Net Sts
     C                     MOVELWBCWST    WN0055           TH Payment Sts
     C                     MOVELWBD6ST    WN0056           TH Bal to Kill
     C                     Z-ADDWBGHNB    WN0057           TH Commission A
     C                     Z-ADDWBBYDT    WN0058           TH Voucher Paym
     C                     MOVELWBE0ST    WN0059           TH User Error O
     C                     MOVELWBE1ST    WN0060           TH Held Over Re
     C                     MOVELWBE2ST    WN0061           TH Sex
     C                     Z-ADDWBBSDT    WN0062           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    WN0063           TH Commission P
     C                     Z-ADDWBBUDT    WN0064           TH Actual Check
     C                     Z-ADDWBHGNB    WN0065           TH Shipped Weig
     C                     Z-ADDWBHHNB    WN0066           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    WN0067           TH FFLI
     C                     Z-ADDWBA3PR    WN0068           TH Kill Product
     C                     Z-ADDWBA4PR    WN0069           TH Cut Product
     C                     Z-ADDWBA6PR    WN0070           TH Render Produ
     C                     Z-ADDWBJ9NB    WN0071           TH Head Exclude
     C                     Z-ADDWBD6PR    WN0072           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    WN0073           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    WN0074           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    WN0075           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    WN0076           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    WN0077           TH CM Yld G/L C
     C                     Z-ADDWBECPR    WN0078           TH CM Crc Val L
     C                     Z-ADDWBEDPR    WN0079           TH CM Crc Val C
     C                     Z-ADDWBEEPR    WN0080           TH CM Lean Prem
     C                     Z-ADDWBEFPR    WN0081           TH CM Lean Prem
     C                     Z-ADDWBEGPR    WN0082           TH CM Gross Liv
     C                     Z-ADDWBEHPR    WN0083           TH CM Gross Car
     C                     MOVELWBKAST    WN0084           TH Source Type
     C                     MOVELWBJ7ST    WN0085           TH Scale Ticket
     C                     MOVELWBJ9ST    WN0086           TH Payment Type
     C                     Z-ADDWBOXNB    WN0087           TH HPS Movement
     C                     MOVELWBLKST    WN0088           TH Source Code
     C                     MOVELWBLLST    WN0089           TH Hog Class Ty
     C                     MOVELWBJ8ST    WN0090           TH Posted to HP
     C                     MOVELWBLIST    WN0091           TH Schedule Kil
     C                     MOVELWBLJST    WN0092           TH Shift Held O
     C                     MOVELWBBDCD    WN0093           DF Defect Code
     C                     MOVELWBCSCD    WN0094           THP Process Cod
     C                     MOVELWBABCD    WN0095           PD Producer Cod
     C                     MOVELWBAECD    WN0096           PL Location Cod
     C                     MOVELWBACCD    WN0097           HB Buyer Code
     C                     MOVELWBAGCD    WN0098           GN Genetic Code
     C                     MOVELWBBECD    WN0099           HC Class Code
     C                     MOVELWBAAVN    WN0100           RS User Changed
     C                     Z-ADDWBAADT    WN0101           RS Date Changed
     C                     Z-ADDWBAMTM    WN0102           RS Time Changed
     C                     MOVELWBAJST    WN0103           RS Record Statu
     C                     MOVELWBAHVN    WN0104           RS Job
     C                     MOVELWBAGVN    WN0105           RS Program
     C                     MOVELWBABVN    WN0106           RS User Added
     C                     Z-ADDWBABDT    WN0107           RS Date Added
     C                     Z-ADDWBABTM    WN0108           RS Time Added
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Balance Info      RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0033           TH PHA Add Type
     C                     MOVEL*BLANK    YL0034           TH PHA Average
     C                     MOVEL*BLANK    YL0035           TH PHA Add Reas
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WBBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WBB0DT           TH Kill Date
      * Establish starting position
     C           KRSSN     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBOQET    YL0033           TH PHA Add Type
     C                     MOVELWBURST    YL0034           TH PHA Average
     C                     MOVELWBUSST    YL0035           TH PHA Add Reas
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0037           PH Summary Type
     C                     Z-ADD*ZERO     YL0038           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0039           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0040           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0041           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0042           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0043           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0044           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0045           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0046           History Avail S
     C                     MOVEL'N'       YL0046           History Avail S
     C                     MOVEL'Y'       YL0047           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFY3A1    WQSO01           PH Company Numb
     C           *LIKE     DEFN WFABCD    WQSO02           PD Producer Cod
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           PH Company Numb
     C                     KFLD           WQSO02           PD Producer Cod
     C                     KFLD           WFDZDT           PH Week Ending
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           PH Company Numb
     C                     KFLD           WQSO02           PD Producer Cod
      * Setup key
     C                     Z-ADDWBHMNB    WQSO01           PH Company Numb
     C                     MOVELWBABCD    WQSO02           PD Producer Cod
     C                     Z-ADDWBAWDT    WFDZDT           PH Week Ending
      * Establish starting position
     C           KPSSO     SETLL@CGCPEJ                    *
     C           KRSSO     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0047    IFEQ 'Y'                        *IF
     C                     Z-ADDWFDZDT    YL0048           PH Week Ending
     C                     MOVEL'N'       YL0047           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           WFDZDT    IFNE YL0048                     *IF
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           WFUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           WFOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELWFUVST    YL0037           PH Summary Type
     C                     Z-ADDWFORMB    YL0038           PH GA Avg Live
     C                     Z-ADDWFG9PC    YL0039           PH GA Adjusted
     C                     Z-ADDWFHBPC    YL0040           PH GA Avg Lean%
     C                     Z-ADDWFUWOE    YL0041           PH GA Avg Backf
     C                     Z-ADDWFHEPC    YL0042           PH GA Avg Loin
     C                     Z-ADDWFHGPC    YL0043           PH GA Avg Light
     C                     Z-ADDWFTIPR    YL0044           PH GA Lean Prm
     C                     Z-ADDWFB8A1    YL0045           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0046           History Avail S
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           WFUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           WFOWUI    IFGT 0                          *IF
      * PAR = DB1 By name
     C                     MOVELWFUVST    YL0037           PH Summary Type
     C                     Z-ADDWFORMB    YL0038           PH GA Avg Live
     C                     Z-ADDWFG9PC    YL0039           PH GA Adjusted
     C                     Z-ADDWFHBPC    YL0040           PH GA Avg Lean%
     C                     Z-ADDWFUWOE    YL0041           PH GA Avg Backf
     C                     Z-ADDWFHEPC    YL0042           PH GA Avg Loin
     C                     Z-ADDWFHGPC    YL0043           PH GA Avg Light
     C                     Z-ADDWFTIPR    YL0044           PH GA Lean Prm
     C                     Z-ADDWFB8A1    YL0045           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0046           History Avail S
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Bal Held Over Tattoo  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSP01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSP02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSP03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSP04           TH Tattoo Numbe
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
     C                     KFLD           WQSP02           BOH Buy Order N
     C                     KFLD           WQSP03           BOL Load Number
     C                     KFLD           WQSP04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHMNB    WQSP01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSP02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSP03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSP04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSP     SETLL@A1CPC4                    *
     C           KRSSP     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Kill Date NE PAR.Kill Date 1 Usr
     C           WBB0DT    IFNE WBB0DT                     *IF
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
     C                     Z-ADDWBAWDT    PAAWDT           TH Purchase Dat
     C                     MOVELWBBICD    PABICD    P      TH Group Refere
     C                     MOVELWBCPST    PACPST    P      TH Live Purchas
     C                     Z-ADDWBACPR    PAACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    PAB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    PACAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWBAIPR    PAAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    PAA6DT           TH Pricing Date
     C                     MOVELWBC2ST    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWBCXNB    PACXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    PACWNB           TH Head Receive
     C                     Z-ADDWBFCNB    PAFCNB           TH Yard Deads
     C                     Z-ADDWBH9NB    PAH9NB           TH Held Over
     C                     Z-ADDWBFDNB    PAFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    PAFENB           TH Head Killed
     C                     Z-ADDWBHENB    PAHENB           TH Head Adds
     C                     Z-ADDWBHFNB    PAHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    PACYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    PAE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    PAFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    PAA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    PAF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    PAF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    PAAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    PACWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    PAA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    PAA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    PAB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    PAANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    PAAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    PAAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    PAASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    PAA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    PAATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    PAA5VA           TH Additions Am
     C                     Z-ADDWBCBPR    PACBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    PACCPR           Th Payment Net
     C                     Z-ADDWBLPNB    PALPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    PACDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    PAA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    PAA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    PAJWST    P      TH Calc Net Sts
     C                     MOVELWBCWST    PACWST    P      TH Payment Sts
     C                     MOVELWBD6ST    PAD6ST    P      TH Bal to Kill
     C                     Z-ADDWBGHNB    PAGHNB           TH Commission A
     C                     Z-ADDWBBYDT    PABYDT           TH Voucher Paym
     C                     MOVELWBE0ST    PAE0ST    P      TH User Error O
     C                     MOVELWBE1ST    PAE1ST    P      TH Held Over Re
     C                     MOVELWBE2ST    PAE2ST    P      TH Sex
     C                     Z-ADDWBBSDT    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    PABTDT           TH Commission P
     C                     Z-ADDWBBUDT    PABUDT           TH Actual Check
     C                     Z-ADDWBHGNB    PAHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    PAHINB           TH FFLI
     C                     Z-ADDWBA3PR    PAA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    PAA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    PAA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    PAJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    PAECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    PAEHPR           TH CM Gross Car
     C                     MOVELWBKAST    PAKAST    P      TH Source Type
     C                     MOVELWBJ7ST    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWBJ9ST    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWBOXNB    PAOXNB           TH HPS Movement
     C                     MOVELWBLKST    PALKST    P      TH Source Code
     C                     MOVELWBLLST    PALLST    P      TH Hog Class Ty
     C                     MOVELWBJ8ST    PAJ8ST    P      TH Posted to HP
     C                     MOVELWBLIST    PALIST    P      TH Schedule Kil
     C                     MOVELWBLJST    PALJST    P      TH Shift Held O
     C                     MOVELWBBDCD    PABDCD    P      DF Defect Code
     C                     MOVELWBCSCD    PACSCD    P      THP Process Cod
     C                     MOVELWBABCD    PAABCD    P      PD Producer Cod
     C                     MOVELWBAECD    PAAECD    P      PL Location Cod
     C                     MOVELWBACCD    PAACCD    P      HB Buyer Code
     C                     MOVELWBAGCD    PAAGCD    P      GN Genetic Code
     C                     MOVELWBBECD    PABECD    P      HC Class Code
     C                     MOVELWBAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    PAAADT           RS Date Changed
     C                     Z-ADDWBAMTM    PAAMTM           RS Time Changed
     C                     MOVELWBAJST    PAAJST    P      RS Record Statu
     C                     MOVELWBAHVN    PAAHVN    P      RS Job
     C                     MOVELWBAGVN    PAAGVN    P      RS Program
     C                     MOVELWBABVN    PAABVN    P      RS User Added
     C                     Z-ADDWBABDT    PAABDT           RS Date Added
     C                     Z-ADDWBABTM    PAABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM YL0001    WQ0121  71       Carcass Dbw Min
     C                     PARM YL0002    WQ0122  71       Carcass Dbw Max
     C                     PARM YL0003    WQ0123  71       Carcass Lgt Min
     C                     PARM YL0004    WQ0124  71       Carcass Lgt Max
     C                     PARM YL0005    WQ0125  71       %Lean High Min
     C                     PARM YL0006    WQ0126  71       %Lean High Max
     C                     PARM YL0007    WQ0127  71       %Lean Low Min
     C                     PARM YL0008    WQ0128  71       %Lean Low Max
     C                     PARM YL0009    WQ0129  71       High Yield Min
     C                     PARM YL0010    WQ0130  71       High Yield Max
     C                     PARM YL0011    WQ0131  71       Low Yield Min
     C                     PARM YL0012    WQ0132  71       Low Yield Max
     C                     PARM YL0013    WQ0133  71       Head < Percent
     C                     PARM YL0014    WQ0134  71       Head < Percent
     C                     PARM YL0015    WQ0135  71       Head > Percent
     C                     PARM YL0016    WQ0136  71       Head > Percent
     C                     PARM YL0017    WQ0137  71       BackFat High Mi
     C                     PARM YL0018    WQ0138  71       BackFat High Ma
     C                     PARM YL0019    WQ0139  71       BackFat Low Min
     C                     PARM YL0020    WQ0140  71       Backfat Low Max
     C                     PARM YL0021    WQ0141  71       LoinEye High Mi
     C                     PARM YL0022    WQ0142  71       LoinEye High Ma
     C                     PARM YL0023    WQ0143  71       LoinEye Low Min
     C                     PARM YL0024    WQ0144  71       LoinEye Low Max
     C                     PARM 'Y'       WQ0145  1        Requested by Us
     C                     PARM YL0036    WQ0146  1        Bal w/History
     C                     PARM YL0033    WQ0147  1        TH PHA Add Type
     C                     PARM YL0034    WQ0148  3        TH PHA Average
     C                     PARM YL0035    WQ0149  1        TH PHA Add Reas
     C                     PARM YL0038    WQ0150  51       PH GA Avg Live
     C                     PARM YL0039    WQ0151  52       PH GA Adjusted
     C                     PARM YL0040    WQ0152  31       PH GA Avg Lean%
     C                     PARM YL0041    WQ0153  31       PH GA Avg Backf
     C                     PARM YL0042    WQ0154  31       PH GA Avg Loin
     C                     PARM YL0043    WQ0155  31       PH GA Avg Light
     C                     PARM YL0044    WQ0156  52       PH GA Lean Prm
     C                     PARM YL0045    WQ0157  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0158  1        Undo MPR USR
     C           YL0049    PARM *BLANK    WQ0159  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSSP     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Check For Pay Err RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WGHRNB           KV Company Numb
     C                     KFLD           WGBPDT           KV Kill Date
     C                     KFLD           WGIRNB           KV TATTOO NUMBE
     C                     KFLD           WGBONM           KV Buy Order Nu
     C                     KFLD           WGLDNM           KV Load Number
     C                     KFLD           WGFPNB           KV Record Numbe
     C                     KFLD           WGDYST           KV Record Type
     C                     KFLD           WGDXST           KV Error Code
      * Setup key
     C                     Z-ADDWBHMNB    WGHRNB           KV Company Numb
     C                     Z-ADDWBB0DT    WGBPDT           KV Kill Date
     C                     Z-ADDWBCVNB    WGIRNB           KV TATTOO NUMBE
     C                     Z-ADDWBBNNB    WGBONM           KV Buy Order Nu
     C                     Z-ADDWBBONB    WGLDNM           KV Load Number
     C                     Z-ADD999999    WGFPNB           KV Record Numbe
     C                     MOVEL'H'       WGDYST           KV Record Type
     C                     MOVEL'HPC'     WGDXST           KV Error Code
      * Establish starting position
     C           KRSSQ     CHAIN@B6CPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0150' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWBHMNB    WHHRNB           KV Company Numb
     C                     Z-ADDWBB0DT    WHBPDT           KV Kill Date
     C                     Z-ADDWBCVNB    WHIRNB           KV TATTOO NUMBE
     C                     Z-ADDWBBNNB    WHBONM           KV Buy Order Nu
     C                     Z-ADDWBBONB    WHLDNM           KV Load Number
     C                     Z-ADD999999    WHFPNB           KV Record Numbe
     C                     MOVEL'H'       WHDYST           KV Record Type
     C                     MOVEL'HPC'     WHDXST           KV Error Code
     C                     MOVEL@CN,002   WHB7TX           KV Error Descri
     C                     MOVEL@CN,003   WHAAVN           RS User Changed
     C                     Z-ADD0         WHAADT           RS Date Changed
     C                     Z-ADD0         WHAMTM           RS Time Changed
     C                     MOVEL'A'       WHAJST           RS Record Statu
     C                     MOVEL##JOB     WHAHVN           RS Job
     C                     MOVEL##PGM     WHAGVN           RS Program
     C                     MOVEL##USR     WHABVN           RS User Added
     C                     Z-ADD##JDT     WHABDT           RS Date Added
     C                     Z-ADD##JTM     WHABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,002   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WHAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WHAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WHAJST           RS Record Statu
     C                     MOVEL##USR     WHABVN           RS User Added
     C                     Z-ADD##JDT     WHABDT           RS Date Added
     C                     Z-ADD##JTM     WHABTM           RS Time Added
     C                     MOVEL##PGM     WHAGVN           RS Program
     C                     MOVEL##JOB     WHAHVN           RS Job
     C           KLCRSR    KLIST
     C                     KFLD           WHHRNB           KV Company Numb
     C                     KFLD           WHBPDT           KV Kill Date
     C                     KFLD           WHIRNB           KV TATTOO NUMBE
     C                     KFLD           WHBONM           KV Buy Order Nu
     C                     KFLD           WHLDNM           KV Load Number
     C                     KFLD           WHFPNB           KV Record Numbe
     C                     KFLD           WHDYST           KV Record Type
     C                     KFLD           WHDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSR    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WABVCD           EV Validation C
      * Setup key
     C                     MOVEL'HPC'     WABVCD           EV Validation C
      * Establish starting position
     C           KRSSS     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWACBTX    WHB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Tattoo Hdr Bal Sts CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0109  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0110 10        TH Group Refere
     C                     MOVEL*BLANK    WN0111  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0112  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0113  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0114  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0115  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0116  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0117  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0118  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0119  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0120  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0121  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0122  50       TH Held Over
     C                     Z-ADD*ZERO     WN0123  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0124  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0125  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0126  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0127  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0128  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0129  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0130  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0131  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0132  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0133  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0134  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0135  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0136  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0137  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0138  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0139  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0140  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0141  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0142  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0143  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0144  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0145  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0146  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0147  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0148  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0149  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0150  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0151  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0152  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0153  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0154  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0155  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0156  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0157  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0158  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0159  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0160  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0161  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0162  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0163  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0164  1        TH Detail Error
     C                     MOVEL*BLANK    WN0165  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0166  80       TH Commission A
     C                     Z-ADD*ZERO     WN0167  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0168  1        TH User Error O
     C                     MOVEL*BLANK    WN0169  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0170  1        TH Sex
     C                     Z-ADD*ZERO     WN0171  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0172  70       TH Commission P
     C                     Z-ADD*ZERO     WN0173  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0174  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0175  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0176  31       TH FFLI
     C                     Z-ADD*ZERO     WN0177  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0178  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0179  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0180  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0181  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0182  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0183  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0184  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0185  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0186  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0187  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0188  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0189  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0190  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0191  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0192  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0193  1        TH Source Type
     C                     MOVEL*BLANK    WN0194  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0195  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0196  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0197  3        TH Source Code
     C                     MOVEL*BLANK    WN0198  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0199  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0200  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0201  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0202  3        TH State
     C                     MOVEL*BLANK    WN0203  3        TH Unused Code
     C                     MOVEL*BLANK    WN0204  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0205  1        TH Commission S
     C                     MOVEL*BLANK    WN0206  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0207  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0208  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0209  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0210  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0211  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0212  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0213  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0214  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0215  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0216  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0217  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0218  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0219  3        TH PHA Average
     C                     MOVEL*BLANK    WN0220  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0221  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0222  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0223  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0224  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0225  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0226  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0227  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0228  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0229  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0230  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0231  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0232  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0233 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0234 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0235 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0236 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0237  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0238  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0239  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0240  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0241  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0242  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0243  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0244  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0245  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0246  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0247  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0248  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0249  70       TH Unused Date
     C                     MOVEL*BLANK    WN0250  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0251  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0252  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0253  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0254  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0255  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0256  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0257  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0258  6        DF Defect Code
     C                     MOVEL*BLANK    WN0259  6        THP Process Cod
     C                     MOVEL*BLANK    WN0260  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0261  6        PL Location Cod
     C                     MOVEL*BLANK    WN0262  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0263  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0264  3        HC Class Code
     C                     MOVEL*BLANK    WN0265 10        RS User Changed
     C                     Z-ADD*ZERO     WN0266  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0267  60       RS Time Changed
     C                     MOVEL*BLANK    WN0268  1        RS Record Statu
     C                     MOVEL*BLANK    WN0269 10        RS Job
     C                     MOVEL*BLANK    WN0270 10        RS Program
     C                     MOVEL*BLANK    WN0271 10        RS User Added
     C                     Z-ADD*ZERO     WN0272  70       RS Date Added
     C                     Z-ADD*ZERO     WN0273  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WIBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WIB0DT           TH Kill Date
      *
     C           KLCHST    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C           KLCHST    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YARDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELYL0050    WID7ST    P      TH Header Error
     C                     MOVELYL0051    WIDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WIAAVN           RS User Changed
     C                     Z-ADD##JDT     WIAADT           RS Date Changed
     C                     Z-ADD##JTM     WIAMTM           RS Time Changed
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Adj lv Wgt/Adj Yld CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0274  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0275 10        TH Group Refere
     C                     MOVEL*BLANK    WN0276  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0277  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0278  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0279  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0280  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0281  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0282  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0283  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0284  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0285  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0286  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0287  50       TH Held Over
     C                     Z-ADD*ZERO     WN0288  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0289  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0290  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0291  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0292  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0293  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0294  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0295  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0296  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0297  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0298  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0299  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0300  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0301  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0302  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0303  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0304  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0305  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0306  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0307  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0308  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0309  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0310  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0311  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0312  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0313  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0314  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0315  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0316  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0317  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0318  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0319  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0320  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0321  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0322  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0323  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0324  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0325  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0326  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0327  1        TH Header Error
     C                     MOVEL*BLANK    WN0328  1        TH Detail Error
     C                     MOVEL*BLANK    WN0329  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0330  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0331  80       TH Commission A
     C                     Z-ADD*ZERO     WN0332  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0333  1        TH User Error O
     C                     MOVEL*BLANK    WN0334  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0335  1        TH Sex
     C                     Z-ADD*ZERO     WN0336  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0337  70       TH Commission P
     C                     Z-ADD*ZERO     WN0338  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0339  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0340  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0341  31       TH FFLI
     C                     Z-ADD*ZERO     WN0342  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0343  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0344  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0345  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0346  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0347  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0348  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0349  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0350  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0351  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0352  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0353  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0354  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0355  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0356  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0357  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0358  1        TH Source Type
     C                     MOVEL*BLANK    WN0359  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0360  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0361  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0362  3        TH Source Code
     C                     MOVEL*BLANK    WN0363  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0364  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0365  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0366  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0367  3        TH State
     C                     MOVEL*BLANK    WN0368  3        TH Unused Code
     C                     MOVEL*BLANK    WN0369  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0370  1        TH Commission S
     C                     MOVEL*BLANK    WN0371  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0372  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0373  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0374  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0375  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0376  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0377  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0378  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0379  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0380  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0381  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0382  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0383  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0384  3        TH PHA Average
     C                     MOVEL*BLANK    WN0385  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0386  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0387  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0388  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0389  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0390  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0391  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0392  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0393  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0394  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0395  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0396  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0397  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0398 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0399 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0400 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0401 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0402  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0403  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0404  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0405  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0406  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0407  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0408  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0409  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0410  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0411  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0412  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0413  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0414  70       TH Unused Date
     C                     MOVEL*BLANK    WN0415  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0416  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0417  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0418  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0419  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0420  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0421  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0422  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0423  6        DF Defect Code
     C                     MOVEL*BLANK    WN0424  6        THP Process Cod
     C                     MOVEL*BLANK    WN0425  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0426  6        PL Location Cod
     C                     MOVEL*BLANK    WN0427  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0428  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0429  3        HC Class Code
     C                     MOVEL*BLANK    WN0430 10        RS User Changed
     C                     Z-ADD*ZERO     WN0431  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0432  60       RS Time Changed
     C                     MOVEL*BLANK    WN0433  1        RS Record Statu
     C                     MOVEL*BLANK    WN0434 10        RS Job
     C                     MOVEL*BLANK    WN0435 10        RS Program
     C                     MOVEL*BLANK    WN0436 10        RS User Added
     C                     Z-ADD*ZERO     WN0437  70       RS Date Added
     C                     Z-ADD*ZERO     WN0438  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WIBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WIB0DT           TH Kill Date
      *
     C           KLCHSU    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C           KLCHSU    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWULRNB    WILRNB           TH Adj Live Wgt
     C                     Z-ADDWBCWPC    WICWPC           TH Adj Actual Y
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WIAAVN           RS User Changed
     C                     Z-ADD##JDT     WIAADT           RS Date Changed
     C                     Z-ADD##JTM     WIAMTM           RS Time Changed
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAFPC           EV Minimum
     C                     Z-ADD*ZERO     WAAGPC           EV Maximum
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WCA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WCFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WCHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WCLKNB           ET Lot
     C                     Z-ADD*ZERO     WCAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WCAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WCAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WCAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WCFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WCFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
     C                     Z-ADD*ZERO     WCB8DT           RU Date
     C                     Z-ADD*ZERO     WCAOTM           RU Time
      * Define work field ET Scale Sequence Number
     C                     Z-ADD*ZERO     WUFJNB  60
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFY3A1           PH Company Numb
     C                     Z-ADD*ZERO     WFDZDT           PH Week Ending
     C                     Z-ADD*ZERO     WFOJJF           PH ALL DOA
     C                     Z-ADD*ZERO     WFALHD           PH ALL Head Rec
     C                     Z-ADD*ZERO     WFKDUR           PH ALL Yard Dea
     C                     Z-ADD*ZERO     WFKJOQ           PH ALL Head Con
     C                     Z-ADD*ZERO     WFJOWR           PH ALL Head Kil
     C                     Z-ADD*ZERO     WFOIWE           PH ALL Live Wei
     C                     Z-ADD*ZERO     WFIOTR           PH ALL Avg Live
     C                     Z-ADD*ZERO     WFJOWK           PH ALL Hot Weig
     C                     Z-ADD*ZERO     WFUQWP           PH ALL Avg Hot
     C                     Z-ADD*ZERO     WFO6PC           PH ALL Actual Y
     C                     Z-ADD*ZERO     WFJKSE           PH ALL Adj Live
     C                     Z-ADD*ZERO     WFG8PC           PH ALL Adjusted
     C                     Z-ADD*ZERO     WFHAPC           PH ALL Avg Lean
     C                     Z-ADD*ZERO     WFORJG           PH ALL Avg Back
     C                     Z-ADD*ZERO     WFHDPC           PH ALL Avg Loin
     C                     Z-ADD*ZERO     WFHFPC           PH ALL Avg Ligh
     C                     Z-ADD*ZERO     WFS1PR           PH ALL Base /Li
     C                     Z-ADD*ZERO     WFTCPR           PH ALL Base /Ca
     C                     Z-ADD*ZERO     WFS3PR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WFTDPR           PH ALL Sort Dsc
     C                     Z-ADD*ZERO     WFS5PR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     WFTEPR           PH ALL Lean Prm
     C                     Z-ADD*ZERO     WFS7PR           PH ALL Gross /L
     C                     Z-ADD*ZERO     WFTFPR           PH ALL Gross /C
     C                     Z-ADD*ZERO     WFB6A1           PH ALL Avg Srt
     C                     Z-ADD*ZERO     WFJKOS           PH GA DOA
     C                     Z-ADD*ZERO     WFALRC           PH GA Head Rece
     C                     Z-ADD*ZERO     WFKDIE           PH GA Yard Dead
     C                     Z-ADD*ZERO     WFJOEW           PH GA Head Cond
     C                     Z-ADD*ZERO     WFOWUI           PH GA Head Kill
     C                     Z-ADD*ZERO     WFIOWN           PH GA Live Weig
     C                     Z-ADD*ZERO     WFORMB           PH GA Avg Live
     C                     Z-ADD*ZERO     WFJOQR           PH GA Hot Weigh
     C                     Z-ADD*ZERO     WFPRUR           PH GA Avg Hot W
     C                     Z-ADD*ZERO     WFG7PC           PH GA Actual Yi
     C                     Z-ADD*ZERO     WFIOOG           PH GA Adj Live
     C                     Z-ADD*ZERO     WFG9PC           PH GA Adjusted
     C                     Z-ADD*ZERO     WFHBPC           PH GA Avg Lean%
     C                     Z-ADD*ZERO     WFUWOE           PH GA Avg Backf
     C                     Z-ADD*ZERO     WFHEPC           PH GA Avg Loin
     C                     Z-ADD*ZERO     WFHGPC           PH GA Avg Light
     C                     Z-ADD*ZERO     WFS2PR           PH GA Base /Liv
     C                     Z-ADD*ZERO     WFTGPR           PH GA Base /Car
     C                     Z-ADD*ZERO     WFS4PR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     WFTHPR           PH GA Sort Dsc
     C                     Z-ADD*ZERO     WFS6PR           PH GA Lean Prm
     C                     Z-ADD*ZERO     WFTIPR           PH GA Lean Prm
     C                     Z-ADD*ZERO     WFS8PR           PH GA Gross /Li
     C                     Z-ADD*ZERO     WFTJPR           PH GA Gross /Ca
     C                     Z-ADD*ZERO     WFB8A1           PH GA Avg Srt D
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHRNB           KV Company Numb
     C                     Z-ADD*ZERO     WGBPDT           KV Kill Date
     C                     Z-ADD*ZERO     WGIRNB           KV TATTOO NUMBE
     C                     Z-ADD*ZERO     WGBONM           KV Buy Order Nu
     C                     Z-ADD*ZERO     WGLDNM           KV Load Number
     C                     Z-ADD*ZERO     WGFPNB           KV Record Numbe
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field Net Head Usr
     C                     Z-ADD*ZERO     WUF6NB  50
      * Define work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     WULRNB  71
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0001  71
      * Define local work field Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0002  71
      * Define local work field Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0003  71
      * Define local work field Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0004  71
      * Define local work field %Lean High Min
     C                     Z-ADD*ZERO     YL0005  71
      * Define local work field %Lean High Max
     C                     Z-ADD*ZERO     YL0006  71
      * Define local work field %Lean Low Min
     C                     Z-ADD*ZERO     YL0007  71
      * Define local work field %Lean Low Max
     C                     Z-ADD*ZERO     YL0008  71
      * Define local work field High Yield Min
     C                     Z-ADD*ZERO     YL0009  71
      * Define local work field High Yield Max
     C                     Z-ADD*ZERO     YL0010  71
      * Define local work field Low Yield Min
     C                     Z-ADD*ZERO     YL0011  71
      * Define local work field Low Yield Max
     C                     Z-ADD*ZERO     YL0012  71
      * Define local work field Head < Percent Min
     C                     Z-ADD*ZERO     YL0013  71
      * Define local work field Head < Percent Max
     C                     Z-ADD*ZERO     YL0014  71
      * Define local work field Head > Percent Min
     C                     Z-ADD*ZERO     YL0015  71
      * Define local work field Head > Percent Max
     C                     Z-ADD*ZERO     YL0016  71
      * Define local work field BackFat High Min
     C                     Z-ADD*ZERO     YL0017  71
      * Define local work field BackFat High Max
     C                     Z-ADD*ZERO     YL0018  71
      * Define local work field BackFat Low Min
     C                     Z-ADD*ZERO     YL0019  71
      * Define local work field Backfat Low Max
     C                     Z-ADD*ZERO     YL0020  71
      * Define local work field LoinEye High Min
     C                     Z-ADD*ZERO     YL0021  71
      * Define local work field LoinEye High Max
     C                     Z-ADD*ZERO     YL0022  71
      * Define local work field LoinEye Low Min
     C                     Z-ADD*ZERO     YL0023  71
      * Define local work field LoinEye Low Max
     C                     Z-ADD*ZERO     YL0024  71
      * Define local work field Auto Balance HldOvr USR
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field Net Head Usr
     C                     Z-ADD*ZERO     YL0027  50
      * Define local work field Transfer Carcasses    USR
     C                     Z-ADD*ZERO     YL0028  50
      * Define local work field TH Kill Date
     C                     Z-ADD*ZERO     YL0029  70
      * Define local work field Kill Date Usr
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field Balance First Day USR
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Balance First Day USR
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field TH PHA Add Type
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field TH PHA Average Type
     C                     MOVEL*BLANK    YL0034  3
      * Define local work field TH PHA Add Reason
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Bal w/History
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field PH Summary Type
     C                     MOVEL*BLANK    YL0037  3
      * Define local work field PH GA Avg Live Wgt
     C                     Z-ADD*ZERO     YL0038  51
      * Define local work field PH GA Adjusted Yield%
     C                     Z-ADD*ZERO     YL0039  52
      * Define local work field PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0040  31
      * Define local work field PH GA Avg Backfat
     C                     Z-ADD*ZERO     YL0041  31
      * Define local work field PH GA Avg Loin Eye
     C                     Z-ADD*ZERO     YL0042  31
      * Define local work field PH GA Avg Light Ref
     C                     Z-ADD*ZERO     YL0043  31
      * Define local work field PH GA Lean Prm /Carc CWT
     C                     Z-ADD*ZERO     YL0044  52
      * Define local work field PH GA Avg Srt Disc Fctr
     C                     Z-ADD*ZERO     YL0045  53
      * Define local work field History Avail STS USR
     C                     MOVEL*BLANK    YL0046  1
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0047  1
      * Define local work field PH Week Ending Date
     C                     Z-ADD*ZERO     YL0048  70
      * Define local work field Balance First Day USR
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field TH Header Error Sts
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    YL0051  1
      * Define local work field Date Alpha USR
     C                     MOVEL*BLANK    YL0052  7
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0053 40
      * Define local work field PRT Printer Device
     C                     MOVEL*BLANK    YL0054 10
      * Define local work field TH Schedule Kill Shift
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field Blank USR
     C                     MOVEL*BLANK    YL0056 80
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 BALHLDOVR
00002 Header Process Code Invld
00003 *BLANKS
00004 BALRPTPRT
