     H/TITLE CNV A/R Bal MTD CRT   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/23/10  Time  : 09:10:16
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FPDLDCPL1IF  E           K        DISK
      * RTV : A/R Balance File          Retrieval index
      *
     FARBDCPLAIF  E           K        DISK
      * RSQ : A/R Header                Co,Cust,PIF Date/IN,DM,C
      *
     FARBDCPLFIF  E           K        DISK
      * RSQ : A/R Header                RSQ Customer/All rec. NV
      *
     FARBECPL6IF  E           K        DISK
      * RSQ : A/R Detail                Co/Inv All Records
      *
     FOPBFCPNCIF  E           K        DISK
      * RSQ : Order Header TRG          ArCust/InvDt, sel
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBFCPNDIF  E           K        DISK
      * RSQ : Order Header TRG          ArCust/OrdDt, sel 'OR
      *
     FPDLDCPL0IF  E           K        DISK                      A
      * UPD : A/R Balance File          Update index
      *
     I@BBREWG
      * Customer                  Active Only
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
     I@LDCPMJ
      * A/R Balance File          Retrieval index
      * Renamed input format fields
     I              LDAIC3                          WBAIC3
     I              LDANC7                          WBANC7
     I              LDA1NB                          WBA1NB
     I              LDY4NB                          WBY4NB
     I              LDALVA                          WBALVA
     I              LDAIDT                          WBAIDT
     I              LDY5VA                          WBY5VA
     I              LDZAVA                          WBZAVA
     I              LDY7VA                          WBY7VA
     I              LDY8VA                          WBY8VA
     I              LDY9VA                          WBY9VA
     I              LDRTNX                          WBRTNX
     I              LDRUNX                          WBRUNX
     I              LDRVNX                          WBRVNX
     I              LDRWNX                          WBRWNX
     I              LDRXNX                          WBRXNX
     I              LDB4DY                          WBB4DY
     I              LDBSDY                          WBBSDY
     I              LDK2DT                          WBK2DT
     I              LDUNUS                          WBUNUS
     I              LDUNU2                          WBUNU2
     I              LDUVST                          WBUVST
     I              LDUWST                          WBUWST
     I              LDUXST                          WBUXST
     I              LDVSST                          WBVSST
     I              LDAATM                          WBAATM
     I              LDAYNA                          WBAYNA
     I              LDA0NA                          WBA0NA
     I              LDAXDT                          WBAXDT
      *
     I@BDCPML
      * A/R Header                Co,Cust,PIF Date/IN,DM,C
      * Renamed input format fields
     I              BDAIC3                          WCAIC3
     I              BDCONB                          WCCONB
     I              BDCEST                          WCCEST
     I              BDUHCD                          WCUHCD
     I              BDBSVA                          WCBSVA
     I              BDAIVA                          WCAIVA
     I              BDAOVA                          WCAOVA
     I              BDBGVA                          WCBGVA
     I              BDAJST                          WCAJST
     I              BDE3ST                          WCE3ST
     I              BDG4CD                          WCG4CD
     I              BDCKNB                          WCCKNB
     I              BDCAC7                          WCCAC7
     I              BDBKC7                          WCBKC7
     I              BDBCCD                          WCBCCD
     I              BDR4CD                          WCR4CD
     I              BDB4DT                          WCB4DT
     I              BDATDT                          WCATDT
     I              BDH0DT                          WCH0DT
     I              BDH3DT                          WCH3DT
     I              BDH4DT                          WCH4DT
     I              BDH5DT                          WCH5DT
     I              BDANC7                          WCANC7
     I              BDCPTX                          WCCPTX
     I              BDBSDY                          WCBSDY
     I              BDUVST                          WCUVST
     I              BDUWST                          WCUWST
     I              BDUXST                          WCUXST
     I              BDAATM                          WCAATM
     I              BDAYNA                          WCAYNA
     I              BDA0NA                          WCA0NA
     I              BDAXDT                          WCAXDT
      *
     I@BDCPIJ
      * A/R Header                RSQ Customer/All rec. NV
      * Renamed input format fields
     I              BDAIC3                          WDAIC3
     I              BDCONB                          WDCONB
     I              BDCEST                          WDCEST
     I              BDUHCD                          WDUHCD
     I              BDBSVA                          WDBSVA
     I              BDAOVA                          WDAOVA
     I              BDBGVA                          WDBGVA
     I              BDAJST                          WDAJST
     I              BDE3ST                          WDE3ST
     I              BDCAC7                          WDCAC7
     I              BDBKC7                          WDBKC7
     I              BDBCCD                          WDBCCD
     I              BDB4DT                          WDB4DT
     I              BDATDT                          WDATDT
     I              BDH0DT                          WDH0DT
     I              BDH3DT                          WDH3DT
     I              BDH4DT                          WDH4DT
     I              BDH5DT                          WDH5DT
     I              BDANC7                          WDANC7
     I              BDCPTX                          WDCPTX
     I              BDBSDY                          WDBSDY
     I              BDUVST                          WDUVST
     I              BDUWST                          WDUWST
     I              BDUXST                          WDUXST
     I              BDAATM                          WDAATM
     I              BDAYNA                          WDAYNA
     I              BDA0NA                          WDA0NA
     I              BDAXDT                          WDAXDT
      *
     I@BECPDS
      * A/R Detail                Co/Inv All Records
      * Renamed input format fields
     I              BFAIC3                          WEAIC3
     I              BFCONB                          WECONB
     I              BFCEST                          WECEST
     I              BFDXNB                          WEDXNB
     I              BFUHCD                          WEUHCD
     I              BFBSVA                          WEBSVA
     I              BFCPTX                          WECPTX
     I              BFNGNA                          WENGNA
     I              BFB4DT                          WEB4DT
     I              BFDVDT                          WEDVDT
     I              BFYXNX                          WEYXNX
     I              BFHYDT                          WEHYDT
     I              BFG4CD                          WEG4CD
     I              BFCKNB                          WECKNB
     I              BFA5ST                          WEA5ST
     I              BFAJST                          WEAJST
     I              BFB1VN                          WEB1VN
     I              BFEAZT                          WEEAZT
     I              BFC1NY                          WEC1NY
     I              BFIZTX                          WEIZTX
     I              BFETSX                          WEETSX
     I              BFW3SX                          WEW3SX
     I              BFW4SX                          WEW4SX
     I              BFW5SX                          WEW5SX
     I              BFW6SX                          WEW6SX
     I              BFW7SX                          WEW7SX
     I              BFW8SX                          WEW8SX
     I              BFQHDT                          WEQHDT
     I              BFQIDT                          WEQIDT
     I              BFQJDT                          WEQJDT
     I              BFQKDT                          WEQKDT
     I              BFQLDT                          WEQLDT
     I              BFGLVL                          WEGLVL
     I              BFGMVL                          WEGMVL
     I              BFGNVL                          WEGNVL
     I              BFGOVL                          WEGOVL
     I              BFGPVL                          WEGPVL
     I              BFUVST                          WEUVST
     I              BFUWST                          WEUWST
     I              BFUXST                          WEUXST
     I              BFAATM                          WEAATM
     I              BFAYNA                          WEAYNA
     I              BFA0NA                          WEA0NA
     I              BFAXDT                          WEAXDT
      *
     I@BFCPOR
      * Order Header TRG          ArCust/InvDt, sel
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WHAJCD
     I              ADF8NA                          WHF8NA
     I              ADACNA                          WHACNA
     I              ADADNA                          WHADNA
     I              ADAENA                          WHAENA
     I              ADAJNA                          WHAJNA
     I              ADBTTX                          WHBTTX
     I              ADAOCD                          WHAOCD
     I              ADBGCD                          WHBGCD
     I              ADVHST                          WHVHST
     I              ADMPNA                          WHMPNA
     I              ADWPST                          WHWPST
     I              ADXUST                          WHXUST
     I              ADT0ST                          WHT0ST
     I              ADT1ST                          WHT1ST
     I              ADDBNB                          WHDBNB
     I              ADT2ST                          WHT2ST
     I              ADT3ST                          WHT3ST
     I              ADT4ST                          WHT4ST
     I              ADT6ST                          WHT6ST
     I              ADBWC3                          WHBWC3
     I              ADBTC3                          WHBTC3
     I              ADBUC3                          WHBUC3
     I              ADBVC3                          WHBVC3
     I              ADFCAA                          WHFCAA
     I              ADRQSX                          WHRQSX
     I              ADRRSX                          WHRRSX
     I              ADRSSX                          WHRSSX
     I              ADRTSX                          WHRTSX
     I              ADT7ST                          WHT7ST
     I              ADT8ST                          WHT8ST
     I              ADRNSX                          WHRNSX
     I              ADROSX                          WHROSX
     I              ADRPSX                          WHRPSX
     I              ADUVST                          WHUVST
     I              ADUWST                          WHUWST
     I              ADUXST                          WHUXST
     I              ADVSST                          WHVSST
     I              ADAATM                          WHAATM
     I              ADAYNA                          WHAYNA
     I              ADA0NA                          WHA0NA
     I              ADAXDT                          WHAXDT
      *
     I@BFCPOS
      * Order Header TRG          ArCust/OrdDt, sel 'OR
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     I@LDCPMI
      * A/R Balance File          Update index
      * Renamed input format fields
     I              LDAIC3                          WJAIC3
     I              LDANC7                          WJANC7
     I              LDA1NB                          WJA1NB
     I              LDY4NB                          WJY4NB
     I              LDALVA                          WJALVA
     I              LDAIDT                          WJAIDT
     I              LDY5VA                          WJY5VA
     I              LDZAVA                          WJZAVA
     I              LDY7VA                          WJY7VA
     I              LDY8VA                          WJY8VA
     I              LDY9VA                          WJY9VA
     I              LDRTNX                          WJRTNX
     I              LDRUNX                          WJRUNX
     I              LDRVNX                          WJRVNX
     I              LDRWNX                          WJRWNX
     I              LDRXNX                          WJRXNX
     I              LDB4DY                          WJB4DY
     I              LDBSDY                          WJBSDY
     I              LDK2DT                          WJK2DT
     I              LDUNUS                          WJUNUS
     I              LDUNU2                          WJUNU2
     I              LDUVST                          WJUVST
     I              LDUWST                          WJUWST
     I              LDUXST                          WJUXST
     I              LDVSST                          WJVSST
     I              LDAATM                          WJAATM
     I              LDAYNA                          WJAYNA
     I              LDA0NA                          WJA0NA
     I              LDAXDT                          WJAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
     IQPDLD1    E DSPDLDCPL0
      * UPD : A/R Balance File          Update index
      * Renamed input format fields
     I              LDAIC3                          WJAIC3
     I              LDANC7                          WJANC7
     I              LDA1NB                          WJA1NB
     I              LDY4NB                          WJY4NB
     I              LDALVA                          WJALVA
     I              LDAIDT                          WJAIDT
     I              LDY5VA                          WJY5VA
     I              LDZAVA                          WJZAVA
     I              LDY7VA                          WJY7VA
     I              LDY8VA                          WJY8VA
     I              LDY9VA                          WJY9VA
     I              LDRTNX                          WJRTNX
     I              LDRUNX                          WJRUNX
     I              LDRVNX                          WJRVNX
     I              LDRWNX                          WJRWNX
     I              LDRXNX                          WJRXNX
     I              LDB4DY                          WJB4DY
     I              LDBSDY                          WJBSDY
     I              LDK2DT                          WJK2DT
     I              LDUNUS                          WJUNUS
     I              LDUNU2                          WJUNU2
     I              LDUVST                          WJUVST
     I              LDUWST                          WJUWST
     I              LDUXST                          WJUXST
     I              LDVSST                          WJVSST
     I              LDAATM                          WJAATM
     I              LDAYNA                          WJAYNA
     I              LDA0NA                          WJA0NA
     I              LDAXDT                          WJAXDT
      *
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * zzCNV A/R Bal MTD CRT  XF
      * RTV Create A/R Bal     RT - Customer  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Create A/R Bal     RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@BBREWG                    *
     C                     READ @BBREWG                  90*
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD2005      YL0001           A/R Balance Yea
     C                     Z-ADD2005      WUAYNX           Year Code
     C                     Z-ADD09        WUR4NX           Month 1 USR
      * DO WHILE: LCL.A/R Balance Year LE WRK.Year Code
     C           YL0001    DOWLEWUAYNX                     *DOW
     C                     Z-ADD1         YL0002           A/R Balance Mon
      * DO WHILE: LCL.A/R Balance Month LE WRK.Month 1 USR
     C           YL0002    DOWLEWUR4NX                     *DOW
      * zzCNV A/R Bal MTD CRT  RT - A/R Balance File  * 
     C                     EXSR SBRVGN
     C                     ADD  1         YL0002           A/R Balance Mon
     C                     END                             *ITR
     C                     ADD  1         YL0001           A/R Balance Yea
     C                     END                             *ITR
     C                     READ @BBREWG                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * zzCNV A/R Bal MTD CRT  RT - A/R Balance File  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
      * ** 9/11/2006 LJB L60906C
      * ** Populate new field: Days to Pay in A/R Balance from
      * ** A/R Header.
      * *****
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBANC7           A/R Customer Nu
     C                     KFLD           WBA1NB           A/R Balance Yea
     C                     KFLD           WBY4NB           A/R Balance Mon
      * Setup key
     C                     Z-ADD960       WBAIC3           Company Number
     C                     Z-ADDWAANC7    WBANC7           A/R Customer Nu
     C                     Z-ADDYL0001    WBA1NB           A/R Balance Yea
     C                     Z-ADDYL0002    WBY4NB           A/R Balance Mon
      * Establish starting position
     C           KRSSB     CHAIN@LDCPMJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2448' W0RTN   7
      * USER: Processing if Data record not found
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.A/R Balance Year is EQ 2002
      *   |- c2    : PAR.A/R Balance Month is EQ November
      *   |- c3    : PAR.A/R Balance Month is December
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 2002                       *IF
     C                     MOVEL'0'       Y0CX02  1
     C           YL0002    IFEQ 11                         *IF
     C           YL0002    OREQ 12                         *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * First day of the month
     C                     Z-ADDYL0001    WUI8NX           Year  NBR USR
     C                     MOVEL'1'       WUPFTX           Text 1 Length U
     C                     MOVEL'01'      WUT6TX           Day   (Char) US
     C                     MOVELWUI8NX    WUUATX           Year Alpha (YY)
     C                     MOVELYL0002    WUMONT           Month USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUPFTX    CAT  WUUATX:ZQ WUVETX    P      Day 1 3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVETX    CAT  WUMONT:ZQ WUY7TX    P      Text USR 5
     C                     Z-ADD*ZERO     ZQ      50
     C           WUY7TX    CAT  WUT6TX:ZQ WUR4TX    P      Date (Alpha) US
     C                     MOVE WUR4TX    WUH4DT           Paid in Full Da
      * Update A/R Balance at Month-end - new fields 11/15/02
      * RTV Days Paid MTD      RT - A/R Header  * 
     C                     EXSR SCRVGN
     C                     Z-ADD*ZERO     WUB4DY           Bal Avg Days to
      * CASE: WRK.Bal Nbr of Invoices Paid is Greater than zero
     C           WURXNX    IFGT *ZERO                      *IF
     C           WUBSDY    DIV  WURXNX    WUB4DY           Bal Avg Days to
     C                     END                             *FI
      * RTV Num. Paymnts p/Mo RT - A/R Header  * 
     C                     EXSR SDRVGN
     C                     MOVE WUR4TX    YL0003           Invoice Date
      * *
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) 960' defaulted for 'Company Number'.
      * Rtv f/A/R Bal MTD Upd RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * Rtv f/A/R Bal #OrdUpd RT - Order Header TRG  * 
     C                     EXSR SIRVGN
      * *
      * CRT A/R Balance File   CR - A/R Balance File  * 
     C                     EXSR SJCRRC
     C                     END                             *FI
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Days Paid MTD      RT - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  20       USR Job Year
     C                     Z-ADD*ZERO     WN0002  20       USR Job Month
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUBSDY           Days to Pay
     C                     Z-ADD*ZERO     WURXNX           MTD Invoices Pa
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCANC7    WQSC02           A/R Customer Nu
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           A/R Customer Nu
     C                     KFLD           WCH4DT           Paid in Full Da
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           A/R Customer Nu
      * Setup key
     C                     Z-ADD960       WQSC01           Company Number
     C                     Z-ADDWAANC7    WQSC02           A/R Customer Nu
     C                     Z-ADDWUH4DT    WCH4DT           Paid in Full Da
      * Establish starting position
     C           KPSSC     SETLL@BDCPML                    *
     C           KRSSC     READE@BDCPML                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Remaining Balance Due is equal to zero
      *   |- c2    : DB1.Invoice Suffix is Invoice or Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCBGVA    IFEQ *ZERO                      *IF
     C           WCCEST    IFEQ 'DM'                       *IF
     C           WCCEST    OREQ 'IN'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PAR.USR Job Year = DB1.Paid in Full Date *YEAR
     C           WCH4DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0001
      * PAR.USR Job Month = DB1.Paid in Full Date *MONTH
     C           WCH4DT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WN0002
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR Job Year EQ PAR.*Job year
      *   |- c2    : PAR.USR Job Month EQ PAR.USR Current Month
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0001    IFEQ WUI8NX                     *IF
     C           WN0002    IFEQ YL0002                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  WCBSDY    WUBSDY           Days to Pay
     C                     ADD  1         WURXNX           MTD Invoices Pa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@BDCPML                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Num. Paymnts p/Mo RT - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  20       USR Job Year
     C                     Z-ADD*ZERO     WN0004  50       USR Accum. Pay
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WURVNX           USR Number of P
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDANC7    WQSD01           A/R Customer Nu
     C           *LIKE     DEFN WDAIC3    WQSD02           Company Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           A/R Customer Nu
     C                     KFLD           WQSD02           Company Number
      * Setup key
     C                     Z-ADDWAANC7    WQSD01           A/R Customer Nu
     C                     Z-ADD960       WQSD02           Company Number
      * Establish starting position
     C           KRSSD     SETLL@BDCPIJ                    *
     C           KRSSD     READE@BDCPIJ                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR.USR Job Year = DB1.Last Payment Date *YEAR
     C           WDH0DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0003
     C                     Z-ADD*ZERO     WN0004           USR Accum. Pay
      * CASE: PAR.*Job year EQ PAR.USR Job Year
     C           WUI8NX    IFEQ WN0003                     *IF
      * RTV No of Paymnts p/mo RT - A/R Detail  * 
     C                     EXSR SERVGN
     C                     ADD  WN0004    WURVNX           USR Number of P
     C                     END                             *FI
     C           KRSSD     READE@BDCPIJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV No of Paymnts p/mo RT - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0004           USR Number of P
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WECONB    WQSE02           Invoice Number
     C           *LIKE     DEFN WECEST    WQSE03           Invoice Suffix
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Invoice Number
     C                     KFLD           WQSE03           Invoice Suffix
      * Setup key
     C                     Z-ADDWDAIC3    WQSE01           Company Number
     C                     Z-ADDWDCONB    WQSE02           Invoice Number
     C                     MOVELWDCEST    WQSE03           Invoice Suffix
      * Establish starting position
     C           KRSSE     SETLL@BECPDS                    *
     C           KRSSE     READE@BECPDS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0178' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SEEXIT                     *QUIT
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * WRK.Month                 USR = DB1.Transaction Date Code *MONTH
     C           WEB4DT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUXX45
      * WRK.USR Job Year = DB1.Transaction Date Code *YEAR
     C           WEB4DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUJBYR
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Month                 USR EQ PAR.A/R Summ-Curr M
      *   |- c2    : WRK.USR Job Year EQ PAR.USR Job Year
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUXX45    IFEQ YL0002                     *IF
     C           WUJBYR    IFEQ WN0003                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Cash/Adj is Cash Adjustment
     C           WEA5ST    IFEQ 'CSH'                      *IF
     C                     ADD  1         WN0004           USR Number of P
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@BECPDS                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv f/A/R Bal MTD Upd RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WURWNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WURUNX           Bal Nbr of Cred
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFANC7    WQSF02           A/R Customer Nu
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF02           A/R Customer Nu
     C                     KFLD           WFAWDT           Invoice Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           A/R Customer Nu
      * Setup key
     C                     Z-ADDWAANC7    WQSF02           A/R Customer Nu
     C                     Z-ADDYL0003    WFAWDT           Invoice Date
      * Establish starting position
     C           KPSSF     SETLL@BFCPOR                    *
     C           KRSSF     READE@BFCPOR                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * WRK.Month                 USR = DB1.Invoice Date *MONTH
     C           WFAWDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUXX45
      * WRK.Year Code = DB1.Invoice Date *YEAR
     C           WFAWDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
      * CASE:
      *  - c2ANDc1
      *   |- c2    : WRK.Year Code EQ PAR.Year Code
      *   |- c1    : WRK.Month                 USR EQ PAR.Month
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAYNX    IFEQ YL0001                     *IF
     C           WUXX45    IFEQ YL0002                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/07/06 PKD PK0040 Retrieve the Accounting Company Number for
      *              the Order and only accumulate if PAR.Company Number
      *              is equal to the Accounting Company Number.
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0001           Company Number
     C                     Z-ADDWFC4NB    WL0002           Order Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YN0001    P      Warehouse Code
     C                     Z-ADDWL0004    YL0004           Shipping Compan
     C                     Z-ADDWL0005    YL0005           Accounting Comp
      * CASE: LCL.Accounting Company EQ PAR.Company Number
     C           YL0005    IFEQ 960                        *IF
      * CASE: DB1.Billing Activity Type is Invoice
     C           WFOBST    IFEQ '1'                        *IF
     C                     ADD  1         WURWNX           Bal Nbr of Invo
     C                     ELSE
      * CASE: DB1.Billing Activity Type is Credit Memo
     C           WFOBST    IFEQ '2'                        *IF
     C                     ADD  1         WURUNX           Bal Nbr of Cred
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BFCPOR                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSG02           Order Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSG01           Company Number
     C                     Z-ADDWL0002    WQSG02           Order Number
      * Establish starting position
     C           KRSSG     SETLL@BGWKL1                    *
     C           KRSSG     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WGGMST    IFEQ 'L'                        *IF
     C           WGGMST    OREQ 'A'
     C           WGGMST    OREQ 'C'
     C           WGGMST    OREQ 'R'
     C           WGGMST    OREQ 'E'
     C           WGGMST    OREQ 'H'
     C           WGGMST    OREQ 'I'
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
     C                     EXSR SHRVGN
     C                     MOVELWGAJCD    WL0003           Warehouse Code
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVELWGAJCD    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Shipping Compan
     C                     Z-ADD*ZERO     WL0005           Accounting Comp
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHBWC3    WL0004           Shipping Compan
     C                     Z-ADDWHBTC3    WL0005           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv f/A/R Bal #OrdUpd RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WURTNX           Bal Nbr of Orde
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIANC7    WQSI02           A/R Customer Nu
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI02           A/R Customer Nu
     C                     KFLD           WIA0DT           Order Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           A/R Customer Nu
      * Setup key
     C                     Z-ADDWAANC7    WQSI02           A/R Customer Nu
     C                     Z-ADDYL0003    WIA0DT           Order Date
      * Establish starting position
     C           KPSSI     SETLL@BFCPOS                    *
     C           KRSSI     READE@BFCPOS                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * WRK.Month                 USR = DB1.Order Date *MONTH
     C           WIA0DT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUXX45
      * WRK.Year Code = DB1.Order Date *YEAR
     C           WIA0DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
      * CASE:
      *  - c2ANDc1
      *   |- c2    : WRK.Year Code EQ PAR.Year Code
      *   |- c1    : WRK.Month                 USR EQ PAR.Month
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAYNX    IFEQ YL0001                     *IF
     C           WUXX45    IFEQ YL0002                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 12/07/06 PKD PK0040 Retrieve the Accounting Company Number for
      *              the Order and only accumulate if PAR.Company Number
      *              is equal to the Accounting Company Number.
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIC3    WL0001           Company Number
     C                     Z-ADDWIC4NB    WL0002           Order Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YN0002    P      Warehouse Code
     C                     Z-ADDWL0004    YL0006           Shipping Compan
     C                     Z-ADDWL0005    YL0007           Accounting Comp
      * CASE: LCL.Accounting Company EQ PAR.Company Number
     C           YL0007    IFEQ 960                        *IF
     C                     ADD  1         WURTNX           Bal Nbr of Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSI     READE@BFCPOS                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * CRT A/R Balance File   CR - A/R Balance File  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  60       Job Time
     C                     MOVEL*BLANK    WN0006 10        User Id
     C                     MOVEL*BLANK    WN0007 10        Job Name
     C                     Z-ADD*ZERO     WN0008  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LDCPMI
     C                     Z-ADD960       WJAIC3           Company Number
     C                     Z-ADDWAANC7    WJANC7           A/R Customer Nu
     C                     Z-ADDYL0001    WJA1NB           A/R Balance Yea
     C                     Z-ADDYL0002    WJY4NB           A/R Balance Mon
     C                     Z-ADD*ZERO     WJALVA           Amount of Highe
     C                     Z-ADD*ZERO     WJAIDT           Date of Highest
     C                     Z-ADD*ZERO     WJY5VA           Beginning Balan
     C                     Z-ADD*ZERO     WJZAVA           A/R Balance Val
     C                     Z-ADD*ZERO     WJY7VA           A/R Balance Val
     C                     Z-ADD*ZERO     WJY8VA           A/R Balance Val
     C                     Z-ADD*ZERO     WJY9VA           A/R Balance Val
     C                     Z-ADDWURTNX    WJRTNX           Bal Nbr of Orde
     C                     Z-ADDWURUNX    WJRUNX           Bal Nbr of Cred
     C                     Z-ADDWURVNX    WJRVNX           Bal Nbr of Paym
     C                     Z-ADDWURWNX    WJRWNX           Bal Nbr of Invo
     C                     Z-ADDWURXNX    WJRXNX           Bal Nbr of Invo
     C                     Z-ADDWUB4DY    WJB4DY           Bal Avg Days to
     C                     Z-ADDWUBSDY    WJBSDY           Days to Pay
     C                     Z-ADD*ZERO     WJK2DT           Override Total
     C                     MOVELWUUNUS    WJUNUS           SSI Download Fl
     C                     MOVELWUUNU2    WJUNU2           unused status 2
     C                     MOVELWUUVST    WJUVST           EDI Status 1
     C                     MOVELWUUWST    WJUWST           EDI Status 2
     C                     MOVELWUUXST    WJUXST           EDI Status 3
     C                     MOVEL'A'       WJVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
     C           KLCRSJ    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJANC7           A/R Customer Nu
     C                     KFLD           WJA1NB           A/R Balance Yea
     C                     KFLD           WJY4NB           A/R Balance Mon
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@LDCPMI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2449' W0RTN   7
      * Send message 'A/R Balance File       EX'
     C                     MOVEL'USR2449' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@LDCPMI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D & B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Year Code
     C                     Z-ADD*ZERO     WUAYNX  40
      * Define work field Month 1 USR
     C                     Z-ADD*ZERO     WUR4NX  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBA1NB           A/R Balance Yea
     C                     Z-ADD*ZERO     WBY4NB           A/R Balance Mon
     C                     Z-ADD*ZERO     WBALVA           Amount of Highe
     C                     Z-ADD*ZERO     WBAIDT           Date of Highest
     C                     Z-ADD*ZERO     WBY5VA           Beginning Balan
     C                     Z-ADD*ZERO     WBZAVA           A/R Balance Val
     C                     Z-ADD*ZERO     WBY7VA           A/R Balance Val
     C                     Z-ADD*ZERO     WBY8VA           A/R Balance Val
     C                     Z-ADD*ZERO     WBY9VA           A/R Balance Val
     C                     Z-ADD*ZERO     WBRTNX           Bal Nbr of Orde
     C                     Z-ADD*ZERO     WBRUNX           Bal Nbr of Cred
     C                     Z-ADD*ZERO     WBRVNX           Bal Nbr of Paym
     C                     Z-ADD*ZERO     WBRWNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WBRXNX           Bal Nbr of Invo
     C                     Z-ADD*ZERO     WBB4DY           Bal Avg Days to
     C                     Z-ADD*ZERO     WBBSDY           Days to Pay
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Year  NBR USR
     C                     Z-ADD*ZERO     WUI8NX  20
      * Define work field Text 1 Length USR
     C                     MOVEL*BLANK    WUPFTX  1
      * Define work field Day   (Char) USR
     C                     MOVEL*BLANK    WUT6TX  2
      * Define work field Year Alpha (YY) USR
     C                     MOVEL*BLANK    WUUATX  2
      * Define work field Month USR
     C                     MOVEL*BLANK    WUMONT  2
      * Define work field Day 1 3A
     C                     MOVEL*BLANK    WUVETX  3
      * Define work field Text USR 5
     C                     MOVEL*BLANK    WUY7TX  5
      * Define work field Date (Alpha) USR
     C                     MOVEL*BLANK    WUR4TX  7
      * Define work field Paid in Full Date
     C                     Z-ADD*ZERO     WUH4DT  70
      * Define work field Days to Pay
     C                     Z-ADD*ZERO     WUBSDY  50
      * Define work field Bal Nbr of Invoices Paid
     C                     Z-ADD*ZERO     WURXNX  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WCAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WCAOVA           Amount Paid
     C                     Z-ADD*ZERO     WCBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WCCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WCCAC7           Order Number Re
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WCATDT           Due Date
     C                     Z-ADD*ZERO     WCH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WCH3DT           Unused Date Cod
     C                     Z-ADD*ZERO     WCH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WCH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBSDY           Days to Pay
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Bal Avg Days to Pay
     C                     Z-ADD*ZERO     WUB4DY  50
      * Define work field Bal Nbr of Payments
     C                     Z-ADD*ZERO     WURVNX  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEDXNB           Sequence Number
     C                     Z-ADD*ZERO     WEBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WEB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WEDVDT           Payment/Deposit
     C                     Z-ADD*ZERO     WEYXNX           Deposit Time
     C                     Z-ADD*ZERO     WEHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WECKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WEC1NY           G/L Posting Com
     C                     Z-ADD*ZERO     WEQHDT           TFS Adj Week-En
     C                     Z-ADD*ZERO     WEQIDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEQJDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEQKDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEQLDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WEGMVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGNVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGOVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGPVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Month                 USR
     C                     Z-ADD*ZERO     WUXX45  20
      * Define work field USR Job Year
     C                     Z-ADD*ZERO     WUJBYR  20
      * Define work field Bal Nbr of Invoices
     C                     Z-ADD*ZERO     WURWNX  50
      * Define work field Bal Nbr of Credits
     C                     Z-ADD*ZERO     WURUNX  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WFA0DT           Order Date
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFACDT           Cancel Date
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WFA1WG           Order Weight To
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WFRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WFT3NB           Attach to Order
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFAWDT           Invoice Date
     C                     Z-ADD*ZERO     WFVRVA           A/R order Value
     C                     Z-ADD*ZERO     WFB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WFNODT           OH Unused Date
     C                     Z-ADD*ZERO     WFNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WFNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WFNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WFNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WFBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WFBQTM           Time of Origina
     C                     Z-ADD*ZERO     WFBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WFBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WFBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WFH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WFH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WFH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WFH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WFH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WFC0C7           Claim Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WGMAVA           Billing Detail
     C                     Z-ADD*ZERO     WGKDVA           Billing Detail
     C                     Z-ADD*ZERO     WGL8VA           Billing Detail
     C                     Z-ADD*ZERO     WGL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGEXDT           Market Pricing
     C                     Z-ADD*ZERO     WGBZPR           Price Overage O
     C                     Z-ADD*ZERO     WGL6NB           Contract Number
     C                     Z-ADD*ZERO     WGGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WGD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WGCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WGAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WGCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WGATWG           Weight Shipped
     C                     Z-ADD*ZERO     WGAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WGAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WGAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WGA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WGB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WGA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WGNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WGNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WGBXTM           Substitution Li
     C                     Z-ADD*ZERO     WGBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WGH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WGH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WGH7NX           OD Item Target
     C                     Z-ADD*ZERO     WGH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WGH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WGDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WGDWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WGDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WGDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WGDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WGGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WGGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WGGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WGPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WGRINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WGTIDT           Production Ovr
     C                     Z-ADD*ZERO     WGTJDT           Production Ovr
     C                     Z-ADD*ZERO     WGTKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGTLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WHBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WHBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WHBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WHBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Bal Nbr of Orders
     C                     Z-ADD*ZERO     WURTNX  50
      * Define work field SSI Download Flag
     C                     MOVEL*BLANK    WUUNUS  1
      * Define work field unused status 2
     C                     MOVEL*BLANK    WUUNU2  1
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Clear all neither parameters
      * CRT A/R Balance File   CR - A/R Balance File  * 
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  30
      * Define local work field A/R Balance Year
     C                     Z-ADD*ZERO     YL0001  40
      * Define local work field A/R Balance Month
     C                     Z-ADD*ZERO     YL0002  20
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0001  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0005  30
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0002  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0007  30
      *================================================================
     CSR         ZZEXIT    ENDSR
