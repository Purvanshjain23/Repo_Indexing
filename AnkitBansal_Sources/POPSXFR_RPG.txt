     H/TITLE Prc AS Case Dtl UPL   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 05/10/06  Time  : 10:24:27
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOB0CPL2IF  E           K        DISK
      * RSQ : AS Case Detail UPL        Same RTV, but fifo
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : Application Profile       Retrieval index       NV
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAB7CPLZIF  E           K        DISK
      * RSQ : Item Transaction Detail   Co/Whse/LabelDate/Itm, R
      *
     FPOB2CPL1IF  E           K        DISK
      * RTV : Product Trace             Retrieval index
      *
     FPPAAREL3IF  E           K        DISK
      * RSQ : Product Trace Line Scale  Co/ScaleID/Dte(d)
      *
     FPPABREL1IF  E           K        DISK
      * RTV : Product Trace Line        Retrieval index
      *
     FPOB2CPL0UF  E           K        DISK                      A
      * UPD : Product Trace             Update index
      *
      * Long constants
     E                    @CN#    1   4  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@B0CPMY
      * AS Case Detail UPL        Same RTV, but fifo
      * Renamed input format fields
     I              B0BHT1                          WABHT1
     I              B0XDTX                          WAXDTX
     I              B0BJT1                          WABJT1
     I              B0MMSX                          WAMMSX
     I              B0BKT1                          WABKT1
     I              B0BLT1                          WABLT1
     I              B0ASPD                          WAASPD
     I              B0BMT1                          WABMT1
     I              B0XOCD                          WAXOCD
     I              B0UYCD                          WAUYCD
     I              B0ASON                          WAASON
     I              B0BNT1                          WABNT1
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WBAJVN
     I              DRAUNA                          WBAUNA
     I              DRB8NA                          WBB8NA
     I              DRAHVN                          WBAHVN
     I              DRI6ST                          WBI6ST
     I              DRI7ST                          WBI7ST
     I              DRXMST                          WBXMST
     I              DRXNST                          WBXNST
     I              DRI8ST                          WBI8ST
     I              DRNLNB                          WBNLNB
     I              DRMPNA                          WBMPNA
     I              DRBCCD                          WBBCCD
     I              DRAIC3                          WBAIC3
     I              DRDQCD                          WBDQCD
     I              DRDRCD                          WBDRCD
     I              DRAJCD                          WBAJCD
     I              DRBUVN                          WBBUVN
     I              DRUVST                          WBUVST
     I              DRUWST                          WBUWST
     I              DRUXST                          WBUXST
     I              DRAATM                          WBAATM
     I              DRAYNA                          WBAYNA
     I              DRA0NA                          WBA0NA
     I              DRAXDT                          WBAXDT
      *
     I@DTRETE
      * Application Profile       Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WCAJVN
     I              DTDNCD                          WCDNCD
     I              DTAIC3                          WCAIC3
     I              DTDQCD                          WCDQCD
     I              DTDRCD                          WCDRCD
     I              DTAJCD                          WCAJCD
     I              DTJFST                          WCJFST
     I              DTUVST                          WCUVST
     I              DTUWST                          WCUWST
     I              DTUXST                          WCUXST
     I              DTAATM                          WCAATM
     I              DTAYNA                          WCAYNA
     I              DTA0NA                          WCA0NA
     I              DTAXDT                          WCAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WDAIC3
     I              AFBCDT                          WDBCDT
     I              AFCQNB                          WDCQNB
     I              AFESNB                          WDESNB
     I              AFETNB                          WDETNB
     I              AFBZNB                          WDBZNB
     I              AFA9ST                          WDA9ST
     I              AFEINB                          WDEINB
     I              AFC5ST                          WDC5ST
     I              AFAQNB                          WDAQNB
     I              AFCMST                          WDCMST
     I              AFV9ST                          WDV9ST
     I              AFWAST                          WDWAST
     I              AFX2ST                          WDX2ST
     I              AFOJDT                          WDOJDT
     I              AFNQNX                          WDNQNX
     I              AFNRNX                          WDNRNX
     I              AFI9SX                          WDI9SX
     I              AFJASX                          WDJASX
     I              AFOKDT                          WDOKDT
     I              AFOLDT                          WDOLDT
     I              AFUVST                          WDUVST
     I              AFUWST                          WDUWST
     I              AFUXST                          WDUXST
     I              AFAATM                          WDAATM
     I              AFAYNA                          WDAYNA
     I              AFA0NA                          WDA0NA
     I              AFAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WFAIC3
     I              BZHGCD                          WFHGCD
     I              BZAVNA                          WFAVNA
     I              BZAWNA                          WFAWNA
     I              BZL7NA                          WFL7NA
     I              BZL8NA                          WFL8NA
     I              BZL6NA                          WFL6NA
     I              BZMFNA                          WFMFNA
     I              BZADCD                          WFADCD
     I              BZAWPC                          WFAWPC
     I              BZLXST                          WFLXST
     I              BZAECD                          WFAECD
     I              BZAXPC                          WFAXPC
     I              BZLYST                          WFLYST
     I              BZAFCD                          WFAFCD
     I              BZAICD                          WFAICD
     I              BZAIWG                          WFAIWG
     I              BZHICD                          WFHICD
     I              BZRBCD                          WFRBCD
     I              BZFZST                          WFFZST
     I              BZAVST                          WFAVST
     I              BZCZWG                          WFCZWG
     I              BZC0WG                          WFC0WG
     I              BZURTN                          WFURTN
     I              BZAJC8                          WFAJC8
     I              BZRINB                          WFRINB
     I              BZRHNB                          WFRHNB
     I              BZRGNB                          WFRGNB
     I              BZLNCD                          WFLNCD
     I              BZTFNB                          WFTFNB
     I              BZN0CD                          WFN0CD
     I              BZX4ST                          WFX4ST
     I              BZTMVA                          WFTMVA
     I              BZTNVA                          WFTNVA
     I              BZBLPR                          WFBLPR
     I              BZBMPR                          WFBMPR
     I              BZLRCD                          WFLRCD
     I              BZU9ST                          WFU9ST
     I              BZCMCO                          WFCMCO
     I              BZQ1CD                          WFQ1CD
     I              BZQ8CD                          WFQ8CD
     I              BZCHTM                          WFCHTM
     I              BZQZCD                          WFQZCD
     I              BZXWST                          WFXWST
     I              BZXXST                          WFXXST
     I              BZVMST                          WFVMST
     I              BZSWGH                          WFSWGH
     I              BZPPHE                          WFPPHE
     I              BZR3CD                          WFR3CD
     I              BZSDCD                          WFSDCD
     I              BZICN1                          WFICN1
     I              BZSVCD                          WFSVCD
     I              BZICN2                          WFICN2
     I              BZSWCD                          WFSWCD
     I              BZV2NB                          WFV2NB
     I              BZSXCD                          WFSXCD
     I              BZITCN                          WFITCN
     I              BZSYCD                          WFSYCD
     I              BZITC5                          WFITC5
     I              BZSZCD                          WFSZCD
     I              BZICN6                          WFICN6
     I              BZS0CD                          WFS0CD
     I              BZICN7                          WFICN7
     I              BZS1CD                          WFS1CD
     I              BZICN8                          WFICN8
     I              BZS2CD                          WFS2CD
     I              BZICN9                          WFICN9
     I              BZS3CD                          WFS3CD
     I              BZICN0                          WFICN0
     I              BZS4CD                          WFS4CD
     I              BZSFNB                          WFSFNB
     I              BZA3WG                          WFA3WG
     I              BZSJNB                          WFSJNB
     I              BZLLCD                          WFLLCD
     I              BZLMCD                          WFLMCD
     I              BZP3ST                          WFP3ST
     I              BZSKNB                          WFSKNB
     I              BZSLNB                          WFSLNB
     I              BZSMNB                          WFSMNB
     I              BZP4ST                          WFP4ST
     I              BZCFNB                          WFCFNB
     I              BZCGNB                          WFCGNB
     I              BZILNB                          WFILNB
     I              BZCHNB                          WFCHNB
     I              BZCINB                          WFCINB
     I              BZCJNB                          WFCJNB
     I              BZCMNB                          WFCMNB
     I              BZCNNB                          WFCNNB
     I              BZCRNB                          WFCRNB
     I              BZCSNB                          WFCSNB
     I              BZCVNB                          WFCVNB
     I              BZCWNB                          WFCWNB
     I              BZCXNB                          WFCXNB
     I              BZCZNB                          WFCZNB
     I              BZC0NB                          WFC0NB
     I              BZN1CD                          WFN1CD
     I              BZB4NB                          WFB4NB
     I              BZB5NB                          WFB5NB
     I              BZX5ST                          WFX5ST
     I              BZX6ST                          WFX6ST
     I              BZX7ST                          WFX7ST
     I              BZPCCT                          WFPCCT
     I              BZBDNB                          WFBDNB
     I              BZBJNB                          WFBJNB
     I              BZSUST                          WFSUST
     I              BZSVST                          WFSVST
     I              BZSYST                          WFSYST
     I              BZSZST                          WFSZST
     I              BZS1ST                          WFS1ST
     I              BZXRCD                          WFXRCD
     I              BZXTCD                          WFXTCD
     I              BZXUCD                          WFXUCD
     I              BZF5WG                          WFF5WG
     I              BZF6WG                          WFF6WG
     I              BZF7WG                          WFF7WG
     I              BZBLNB                          WFBLNB
     I              BZBNNB                          WFBNNB
     I              BZS2ST                          WFS2ST
     I              BZS4ST                          WFS4ST
     I              BZS5ST                          WFS5ST
     I              BZS6ST                          WFS6ST
     I              BZS8ST                          WFS8ST
     I              BZS9ST                          WFS9ST
     I              BZTCST                          WFTCST
     I              BZTDST                          WFTDST
     I              BZUVST                          WFUVST
     I              BZUWST                          WFUWST
     I              BZUXST                          WFUXST
     I              BZVSST                          WFVSST
     I              BZAATM                          WFAATM
     I              BZAYNA                          WFAYNA
     I              BZA0NA                          WFA0NA
     I              BZAXDT                          WFAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WGAJCD
     I              ADF8NA                          WGF8NA
     I              ADACNA                          WGACNA
     I              ADADNA                          WGADNA
     I              ADAENA                          WGAENA
     I              ADAJNA                          WGAJNA
     I              ADBTTX                          WGBTTX
     I              ADAOCD                          WGAOCD
     I              ADBGCD                          WGBGCD
     I              ADVHST                          WGVHST
     I              ADMPNA                          WGMPNA
     I              ADWPST                          WGWPST
     I              ADXUST                          WGXUST
     I              ADT0ST                          WGT0ST
     I              ADT1ST                          WGT1ST
     I              ADDBNB                          WGDBNB
     I              ADT2ST                          WGT2ST
     I              ADT3ST                          WGT3ST
     I              ADT4ST                          WGT4ST
     I              ADT6ST                          WGT6ST
     I              ADBWC3                          WGBWC3
     I              ADBTC3                          WGBTC3
     I              ADBUC3                          WGBUC3
     I              ADBVC3                          WGBVC3
     I              ADFCAA                          WGFCAA
     I              ADRQSX                          WGRQSX
     I              ADRRSX                          WGRRSX
     I              ADRSSX                          WGRSSX
     I              ADRTSX                          WGRTSX
     I              ADT7ST                          WGT7ST
     I              ADT8ST                          WGT8ST
     I              ADRNSX                          WGRNSX
     I              ADROSX                          WGROSX
     I              ADRPSX                          WGRPSX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     I@B7CPND
      * Item Transaction Detail   Co/Whse/LabelDate/Itm, R
      * Renamed input format fields
     I              B7AIC3                          WHAIC3
     I              B7HGCD                          WHHGCD
     I              B7AJCD                          WHAJCD
     I              B7W9ST                          WHW9ST
     I              B7BSST                          WHBSST
     I              B7B4DT                          WHB4DT
     I              B7C4NY                          WHC4NY
     I              B7DXNB                          WHDXNB
     I              B7ELDT                          WHELDT
     I              B7HVCD                          WHHVCD
     I              B7F1ST                          WHF1ST
     I              B7AUNA                          WHAUNA
     I              B7A5QT                          WHA5QT
     I              B7AHWG                          WHAHWG
     I              B7AKCS                          WHAKCS
     I              B7CGCD                          WHCGCD
     I              B7AYVA                          WHAYVA
     I              B7BJNA                          WHBJNA
     I              B7CKNB                          WHCKNB
     I              B7BMST                          WHBMST
     I              B7CQCD                          WHCQCD
     I              B7DTCD                          WHDTCD
     I              B7MGNA                          WHMGNA
     I              B7TRBN                          WHTRBN
     I              B7TRBS                          WHTRBS
     I              B7C4NB                          WHC4NB
     I              B7RINB                          WHRINB
     I              B7RHNB                          WHRHNB
     I              B7RGNB                          WHRGNB
     I              B7M3NA                          WHM3NA
     I              B7AWTM                          WHAWTM
     I              B7XLCD                          WHXLCD
     I              B7K7DT                          WHK7DT
     I              B7UVST                          WHUVST
     I              B7UWST                          WHUWST
     I              B7UXST                          WHUXST
     I              B7VSST                          WHVSST
     I              B7AATM                          WHAATM
     I              B7AYNA                          WHAYNA
     I              B7A0NA                          WHA0NA
     I              B7AXDT                          WHAXDT
      *
     I@B2CPMQ
      * Product Trace             Retrieval index
      * Renamed input format fields
     I              B2AIC3                          WIAIC3
     I              B2PFNX                          WIPFNX
     I              B2AADX                          WIAADX
     I              B2B9TM                          WIB9TM
     I              B2ADDX                          WIADDX
     I              B2ABDX                          WIABDX
     I              B2CATM                          WICATM
     I              B2MNSX                          WIMNSX
     I              B2JOWG                          WIJOWG
     I              B2JPWG                          WIJPWG
     I              B2MOSX                          WIMOSX
     I              B2DNAA                          WIDNAA
     I              B2PGNX                          WIPGNX
     I              B2BTT1                          WIBTT1
     I              B2D7C7                          WID7C7
     I              B2PYNA                          WIPYNA
     I              B2PZNA                          WIPZNA
     I              B2MPSX                          WIMPSX
     I              B2CCT1                          WICCT1
     I              B2PHNX                          WIPHNX
     I              B2MQSX                          WIMQSX
     I              B2DOAA                          WIDOAA
     I              B2BUT1                          WIBUT1
     I              B2DYAA                          WIDYAA
     I              B2BVT1                          WIBVT1
     I              B2DPAA                          WIDPAA
     I              B2DQAA                          WIDQAA
     I              B2BZT1                          WIBZT1
     I              B2BWT1                          WIBWT1
     I              B2DRAA                          WIDRAA
     I              B2B9T1                          WIB9T1
     I              B2DSAA                          WIDSAA
     I              B2B8T1                          WIB8T1
     I              B2D4AA                          WID4AA
     I              B2EPAA                          WIEPAA
     I              B2EQAA                          WIEQAA
     I              B2ERAA                          WIERAA
     I              B2ESAA                          WIESAA
     I              B2PNSX                          WIPNSX
     I              B2UFNX                          WIUFNX
     I              B2UGNX                          WIUGNX
     I              B2UHNX                          WIUHNX
     I              B2AGDX                          WIAGDX
     I              B2CGTM                          WICGTM
     I              B2POSX                          WIPOSX
     I              B2PPSX                          WIPPSX
     I              B2UINX                          WIUINX
     I              B2UJNX                          WIUJNX
     I              B2UKNX                          WIUKNX
     I              B2ULNX                          WIULNX
     I              B2PRSX                          WIPRSX
     I              B2PSSX                          WIPSSX
     I              B2AATM                          WIAATM
     I              B2AYNA                          WIAYNA
     I              B2A0NA                          WIA0NA
     I              B2AXDT                          WIAXDT
      *
     I@AARETD
      * Product Trace Line Scale  Co/ScaleID/Dte(d)
      * Renamed input format fields
     I              AAAIC3                          WJAIC3
     I              AAFAAA                          WJFAAA
     I              AAPUDT                          WJPUDT
     I              AAUXNX                          WJUXNX
     I              AAUVST                          WJUVST
     I              AAUWST                          WJUWST
     I              AAUXST                          WJUXST
     I              AAVSST                          WJVSST
     I              AAAATM                          WJAATM
     I              AAAYNA                          WJAYNA
     I              AAA0NA                          WJA0NA
     I              AAAXDT                          WJAXDT
      *
     I@ABRETA
      * Product Trace Line        Retrieval index
      * Renamed input format fields
     I              ABAIC3                          WKAIC3
     I              ABFAAA                          WKFAAA
     I              ABQQNA                          WKQQNA
     I              ABPINX                          WKPINX
     I              ABMUSX                          WKMUSX
     I              ABM9SX                          WKM9SX
     I              ABUVST                          WKUVST
     I              ABUWST                          WKUWST
     I              ABUXST                          WKUXST
     I              ABVSST                          WKVSST
     I              ABAATM                          WKAATM
     I              ABAYNA                          WKAYNA
     I              ABA0NA                          WKA0NA
     I              ABAXDT                          WKAXDT
      *
     I@B2CPMP
      * Product Trace             Update index
      * Renamed input format fields
     I              B2AIC3                          WLAIC3
     I              B2PFNX                          WLPFNX
     I              B2AADX                          WLAADX
     I              B2B9TM                          WLB9TM
     I              B2ADDX                          WLADDX
     I              B2ABDX                          WLABDX
     I              B2CATM                          WLCATM
     I              B2MNSX                          WLMNSX
     I              B2JOWG                          WLJOWG
     I              B2JPWG                          WLJPWG
     I              B2MOSX                          WLMOSX
     I              B2DNAA                          WLDNAA
     I              B2PGNX                          WLPGNX
     I              B2BTT1                          WLBTT1
     I              B2D7C7                          WLD7C7
     I              B2PYNA                          WLPYNA
     I              B2PZNA                          WLPZNA
     I              B2MPSX                          WLMPSX
     I              B2CCT1                          WLCCT1
     I              B2PHNX                          WLPHNX
     I              B2MQSX                          WLMQSX
     I              B2DOAA                          WLDOAA
     I              B2BUT1                          WLBUT1
     I              B2DYAA                          WLDYAA
     I              B2BVT1                          WLBVT1
     I              B2DPAA                          WLDPAA
     I              B2DQAA                          WLDQAA
     I              B2BZT1                          WLBZT1
     I              B2BWT1                          WLBWT1
     I              B2DRAA                          WLDRAA
     I              B2B9T1                          WLB9T1
     I              B2DSAA                          WLDSAA
     I              B2B8T1                          WLB8T1
     I              B2D4AA                          WLD4AA
     I              B2EPAA                          WLEPAA
     I              B2EQAA                          WLEQAA
     I              B2ERAA                          WLERAA
     I              B2ESAA                          WLESAA
     I              B2PNSX                          WLPNSX
     I              B2UFNX                          WLUFNX
     I              B2UGNX                          WLUGNX
     I              B2UHNX                          WLUHNX
     I              B2AGDX                          WLAGDX
     I              B2CGTM                          WLCGTM
     I              B2POSX                          WLPOSX
     I              B2PPSX                          WLPPSX
     I              B2UINX                          WLUINX
     I              B2UJNX                          WLUJNX
     I              B2UKNX                          WLUKNX
     I              B2ULNX                          WLULNX
     I              B2PRSX                          WLPRSX
     I              B2PSSX                          WLPSSX
     I              B2AATM                          WLAATM
     I              B2AYNA                          WLAYNA
     I              B2A0NA                          WLA0NA
     I              B2AXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
     IQPOB21    E DSPOB2CPL0
      * UPD : Product Trace             Update index
      * Renamed input format fields
     I              B2AIC3                          WLAIC3
     I              B2PFNX                          WLPFNX
     I              B2AADX                          WLAADX
     I              B2B9TM                          WLB9TM
     I              B2ADDX                          WLADDX
     I              B2ABDX                          WLABDX
     I              B2CATM                          WLCATM
     I              B2MNSX                          WLMNSX
     I              B2JOWG                          WLJOWG
     I              B2JPWG                          WLJPWG
     I              B2MOSX                          WLMOSX
     I              B2DNAA                          WLDNAA
     I              B2PGNX                          WLPGNX
     I              B2BTT1                          WLBTT1
     I              B2D7C7                          WLD7C7
     I              B2PYNA                          WLPYNA
     I              B2PZNA                          WLPZNA
     I              B2MPSX                          WLMPSX
     I              B2CCT1                          WLCCT1
     I              B2PHNX                          WLPHNX
     I              B2MQSX                          WLMQSX
     I              B2DOAA                          WLDOAA
     I              B2BUT1                          WLBUT1
     I              B2DYAA                          WLDYAA
     I              B2BVT1                          WLBVT1
     I              B2DPAA                          WLDPAA
     I              B2DQAA                          WLDQAA
     I              B2BZT1                          WLBZT1
     I              B2BWT1                          WLBWT1
     I              B2DRAA                          WLDRAA
     I              B2B9T1                          WLB9T1
     I              B2DSAA                          WLDSAA
     I              B2B8T1                          WLB8T1
     I              B2D4AA                          WLD4AA
     I              B2EPAA                          WLEPAA
     I              B2EQAA                          WLEQAA
     I              B2ERAA                          WLERAA
     I              B2ESAA                          WLESAA
     I              B2PNSX                          WLPNSX
     I              B2UFNX                          WLUFNX
     I              B2UGNX                          WLUGNX
     I              B2UHNX                          WLUHNX
     I              B2AGDX                          WLAGDX
     I              B2CGTM                          WLCGTM
     I              B2POSX                          WLPOSX
     I              B2PPSX                          WLPPSX
     I              B2UINX                          WLUINX
     I              B2UJNX                          WLUJNX
     I              B2UKNX                          WLUKNX
     I              B2ULNX                          WLULNX
     I              B2PRSX                          WLPRSX
     I              B2PSSX                          WLPSSX
     I              B2AATM                          WLAATM
     I              B2AYNA                          WLAYNA
     I              B2A0NA                          WLA0NA
     I              B2AXDT                          WLAXDT
      *
     IYARDCS      DS                            434
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc AS Case Dtl UPL   XF
      * Prc AS Case Dtl UPL   RT - AS Case Detail UPL  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Prc AS Case Dtl UPL   RT - AS Case Detail UPL  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Company Number
     C                     MOVEL*BLANK    WN0002  6        AS Data Collect
     C                     Z-ADD*ZERO     WN0003  70       AS Transaction
     C                     Z-ADD*ZERO     WN0004  60       AS Transaction
     C                     Z-ADD*ZERO     WN0005  70       AS Sequence Num
     C                     MOVEL*BLANK    WN0006110        AS Error Record
     C                     MOVEL*BLANK    WN0007 10        AS Error Log Co
     C                     MOVEL*BLANK    WN0008  1        AS Error Code
     C                     MOVEL*BLANK    WN0009 10        AS Notified Lis
     C                     MOVEL*BLANK    WN0010  1        Error Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      *
     C                     MOVEL*BLANK    WN0011 10        User Code Model
      *
      * RTV default Company    IF
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR SBRVGN
      * CASE: PAR.User Code Model is equal to blank
     C           WN0011    IFEQ *BLANK                     *IF
      * RTV Appl. Default Co   RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0001    P      User Profile Na
     C                     MOVEL'P/S'     WL0002    P      Application Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WN0001           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Default Co   RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0011    WL0001    P      User Profile Na
     C                     MOVEL'P/S'     WL0002    P      Application Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WN0001           Company Number
     C                     END                             *FI
      * *******
     C                     Z-ADD##JDT     WN0003           AS Transaction
     C                     Z-ADD##JTM     WN0004           AS Transaction
     C                     MOVEL*BLANK    WN0009           AS Notified Lis
     C                     MOVEL'ASCASUPL'WN0009           AS Notified Lis
     C                     MOVEL'N'       YL0001           Upload Error US
      * LCL.Date To               USR = JOB.*Job date + CON.1 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
      * ******* for testing only
      * Establish starting position
     C           *LOVAL    SETLL@B0CPMY                    *
     C                     READ @B0CPMY                  90*
      * Data record not found
     C   90                MOVEL'USR3140' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 10/26/02
      * Dont create product trace for product ' 2222' = Scale check recor
      *  Or if Scale is to be excluded per the flag.
      * 11/26/03  Upd 'Incl in Prd Trc Match' Sts from flag
      * 07/29/05 PKD Using Carlisle to create the Manifest.  The Producti
      *              Date and Time are not known by carlisle.
      * CASE:
      *  - c1ORc3
      *   |- c1    : DB1.AS Product Code is Scale Check
      *   |- c3    : DB1.AS Product Code is Scale Check 02222
      *   '-
     C           WAASPD    IFEQ ' 2222'                    *IF
     C           WAASPD    OREQ '02222'                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate fields before Validate product trace
     C                     EXSR UASUBR                     Validate fields
      * If no errors, process record
      * CASE: PAR.Error Status is no
     C           WN0010    IFEQ 'N'                        *IF
      * Item Code
     C                     EXSR UBSUBR                     Item Code
      * Rtv Prod Dt f/Lbl Dt   RT - Item Transaction Detail  * 
     C                     EXSR SHRVGN
      * WRK.Year Code = LCL.Production Date *YEAR
     C           YL0015    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
     C                     MOVELWUAYNX    YL0005           Year Alpha (YYY
      * LCL.Month/Year NBR        USR = LCL.Production Date
     C                     Z-ADDYL0015    YL0006           Month/Year NBR
     C                     MOVELYL0006    YL0007           Text USR 4
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0005    CAT  YL0007:ZQ YL0016    P      AS Prod Date YY
     C                     MOVE YL0016    YL0017           PT Prod Date YY
      * Check Product Trace for existence ----
      * Val Product Trace     RT - Product Trace  * 
     C                     EXSR SIRVGN
      * Check without time only for Manifested status    8/1/05
      * CASE: DB1.AS Inventory Status is Manifested
     C           WAMMSX    IFEQ '3'                        *IF
      * Check Product Trace Without Time.
      * CASE: LCL.*Return code is *Record does not exist
     C           YL0018    IFEQ 'Y2U0005'                  *IF
      * Val Prd Trace WO/Tme  RT - Product Trace  * 
     C                     EXSR SJRVGN
      * CASE: LCL.PT Production Time is Not Entered
     C           YL0010    IFEQ *ZERO                      *IF
     C                     Z-ADD235900    YL0010           PT Production T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Gather the data for a new record / else update existing record
      * CASE: LCL.*Return code is *Record does not exist
     C           YL0018    IFEQ 'Y2U0005'                  *IF
      * Calculate Offset Production Date and time
     C                     EXSR UCSUBR                     Calculate Offse
      * Validate fields if new product trace
     C                     EXSR UDSUBR                     Validate fields
      * Create new record if no errors
      * CASE: PAR.Error Status is no
     C           WN0010    IFEQ 'N'                        *IF
      * RTV Item Labels        RT - Company Item  * 
     C                     EXSR SMRVGN
      * Item Picture Key .. added 1st case for LOINT 4/11/03
      * CASE: LCL.Item Category Code 3 is Loint
     C           YL0033    IFEQ 'L61'                      *IF
     C                     MOVEL*BLANK    YL0035           PT Item Picture
     C                     MOVEL'LOINT'   YL0035           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * Item Picture Key              11/08/02
      * CASE: LCL.MTO Code is Entered
     C           YL0032    IFGT *BLANK                     *IF
      * PFN
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Item Category Code 1 is PFN
      *   |- c2    : LCL.Item Category Code 1 is IWG
      *   '-
     C           YL0032    IFEQ 'PFN'                      *IF
     C           YL0032    OREQ 'IWG'                      *OR
     C                     MOVEL*BLANK    YL0035           PT Item Picture
     C                     MOVEL'PFN'     YL0035           PT Item Picture
     C                     END                             *FI
      * PFT
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Item Category Code 1 is EHP
      *   |- c2    : LCL.Item Category Code 1 is KRG
      *   '-
     C           YL0032    IFEQ 'EHP'                      *IF
     C           YL0032    OREQ 'KRG'                      *OR
     C                     MOVEL*BLANK    YL0035           PT Item Picture
     C                     MOVEL'PFT'     YL0035           PT Item Picture
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : LCL.Primal Group Code is BUTT
      *   |- c2    : LCL.Primal Group Code is HAM
      *   |- c3    : LCL.Primal Group Code is LOIN
      *   |- c4    : LCL.Primal Group Code is PICNIC
      *   |- c5    : LCL.Primal Group Code is RIBS
      *   '-
     C           YL0034    IFEQ 'BUTT'                     *IF
     C           YL0034    OREQ 'HAM'                      *OR
     C           YL0034    OREQ 'LOIN'                     *OR
     C           YL0034    OREQ 'PICNIC'                   *OR
     C           YL0034    OREQ 'RIBS'                     *OR
     C                     MOVEL*BLANK    YL0035           PT Item Picture
     C                     MOVELYL0034    YL0035           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Primal Group Code is HAMC
     C           YL0034    IFEQ 'HAMC'                     *IF
     C                     MOVEL*BLANK    YL0035           PT Item Picture
     C                     MOVEL'HAM'     YL0035           PT Item Picture
     C                     ELSE
      * CASE: LCL.Primal Group Code is LOINC
     C           YL0034    IFEQ 'LOINC'                    *IF
     C                     MOVEL*BLANK    YL0035           PT Item Picture
     C                     MOVEL'LOIN'    YL0035           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0035           PT Item Picture
     C                     MOVEL'LOGO'    YL0035           PT Item Picture
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Crt Product Trace     CR - Product Trace  * 
     C                     EXSR SNCRRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WN0008           AS Error Code
     C                     MOVEL'Y'       YL0001           Upload Error US
      * Ntv Upd RTV AccPath   UP - AS Case Detail UPL  * 
     C                     CALL 'POP3UPR'              90  Ntv Upd RTV Acc
     C           WUH3TX    PARM WUH3TX    WQ0057  7        Return Code Usr
     C                     PARM WABHT1    WQ0058  8        AS Serial Numbe
     C                     PARM WAXDTX    WQ0059  8        AS Label Date Y
     C                     PARM WAMMSX    WQ0060  1        AS Inventory St
     C                     PARM WN0010    WQ0061  1        AS Null
     C                     PARM WAASON    WQ0062  7        AS Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP3UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Product Trc sts   CH - Product Trace  * 
     C                     EXSR SOCHRC
     C                     END                             *FI
      * -------------------------------------------
     C                     MOVEL*BLANK    WN0008           AS Error Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WN0008           AS Error Code
     C                     MOVEL'Y'       YL0001           Upload Error US
      * Ntv Upd RTV AccPath   UP - AS Case Detail UPL  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAXDTX' defaulted for 'AS Label Date YYYYMMDD'.
     C                     CALL 'POP3UPR'              90  Ntv Upd RTV Acc
     C           WUH3TX    PARM WUH3TX    WQ0063  7        Return Code Usr
     C                     PARM WABHT1    WQ0064  8        AS Serial Numbe
     C                     PARM WAXDTX    WQ0065  8        AS Label Date Y
     C                     PARM WAMMSX    WQ0066  1        AS Inventory St
     C                     PARM WN0010    WQ0067  1        AS Null
     C                     PARM WAASON    WQ0068  7        AS Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP3UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @B0CPMY                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     WBAJVN           User Profile Na
      * Establish starting position
     C           KRSSB     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0011           User Code Model
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBUVN    WN0011           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Appl. Default Co   RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJVN           User Profile Na
     C                     KFLD           WCDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    WCAJVN           User Profile Na
     C                     MOVELWL0002    WCDNCD           Application Cod
      * Establish starting position
     C           KRSSC     CHAIN@DTRETE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0767' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0003           Company Number
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAIC3    WL0003           Company Number
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * VAL Date               RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWN0001    WDAIC3           Company Number
     C                     Z-ADDWUK7DT    WDBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSD     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Val Order Hdr Exists   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0001    WEAIC3           Company Number
     C                     Z-ADDYL0011    WEC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Val Item/Rtv Whse,PDC  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0004    WFAIC3           Company Number
     C                     Z-ADDWL0005    WFHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Production Date
     C                     MOVEL*BLANK    WL0007           Default Warehou
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFFZST    WL0006           Production Date
     C                     MOVELWFQ1CD    WL0007           Default Warehou
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0008    WGAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           Warehouse Type
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGWPST    WL0009           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Prod Dt f/Lbl Dt   RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WHHGCD    WQSH02           Item Code
     C           *LIKE     DEFN WHAJCD    WQSH03           Warehouse Code
     C           *LIKE     DEFN WHK7DT    WQSH04           Label Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Item Code
     C                     KFLD           WQSH03           Warehouse Code
     C                     KFLD           WQSH04           Label Date
      * Setup key
     C                     Z-ADDWN0001    WQSH01           Company Number
     C                     Z-ADDYL0012    WQSH02           Item Code
     C                     MOVELWAUYCD    WQSH03           Warehouse Code
     C                     Z-ADDWUK7DT    WQSH04           Label Date
      * Establish starting position
     C           KRSSH     SETLL@B7CPND                    *
     C           KRSSH     READE@B7CPND                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Label Date GT JOB.*Job date
     C           WUK7DT    IFGT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0015           Production Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUK7DT    YL0015           Production Date
     C                     END                             *FI
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWHELDT    YL0015           Production Date
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@B7CPND                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Val Product Trace     RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIPFNX           PT Serial Numbe
     C                     KFLD           WIAADX           PT Prod Date YY
     C                     KFLD           WIB9TM           PT Production T
      * Setup key
     C                     Z-ADDWN0001    WIAIC3           Company Number
     C                     Z-ADDYL0003    WIPFNX           PT Serial Numbe
     C                     Z-ADDYL0017    WIAADX           PT Prod Date YY
     C                     Z-ADDYL0010    WIB9TM           PT Production T
      * Establish starting position
     C           KRSSI     CHAIN@B2CPMQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3144' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' YL0018           *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    YL0018           *Return code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Val Prd Trace WO/Tme  RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WIPFNX    WQSJ02           PT Serial Numbe
     C           *LIKE     DEFN WIAADX    WQSJ03           PT Prod Date YY
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           PT Serial Numbe
     C                     KFLD           WQSJ03           PT Prod Date YY
      * Setup key
     C                     Z-ADDWN0001    WQSJ01           Company Number
     C                     Z-ADDYL0003    WQSJ02           PT Serial Numbe
     C                     Z-ADDYL0017    WQSJ03           PT Prod Date YY
      * Establish starting position
     C           KRSSJ     SETLL@B2CPMQ                    *
     C           KRSSJ     READE@B2CPMQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3144' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' YL0018           *Return code
     C                     Z-ADD*ZERO     YL0010           PT Production T
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    YL0018           *Return code
     C                     Z-ADDWIB9TM    YL0010           PT Production T
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@B2CPMQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WJUXNX    WQSK02           Scale ID
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Scale ID
     C                     KFLD           WJPUDT           Effective Label
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Scale ID
      * Setup key
     C                     Z-ADDWN0001    WQSK01           Company Number
     C                     MOVELYL0019    WQSK02           Scale ID
     C                     Z-ADDWUK7DT    WJPUDT           Effective Label
      * Establish starting position
     C           KPSSK     SETLL@AARETD                    *
     C           KRSSK     READE@AARETD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3311' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     YL0020           CS Scale Offset
     C                     MOVEL'N'       YL0021           CS Include in P
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Prod Trace Offset RT - Product Trace Line  * 
     C                     EXSR SLRVGN
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@AARETD                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Prod Trace Offset RT - Product Trace Line  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKFAAA           Line Code
      * Setup key
     C                     Z-ADDWJAIC3    WKAIC3           Company Number
     C                     MOVELWJFAAA    WKFAAA           Line Code
      * Establish starting position
     C           KRSSL     CHAIN@ABRETA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3314' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0020           CS Scale Offset
     C                     MOVEL*BLANK    YL0021           CS Include in P
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKPINX    YL0020           CS Scale Offset
     C                     MOVELWKMUSX    YL0021           CS Include in P
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Item Labels        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWN0001    WFAIC3           Company Number
     C                     Z-ADDYL0012    WFHGCD           Item Code
      * Establish starting position
     C           KRSSM     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    YL0026           Item Label Line
     C                     MOVEL*BLANK    YL0027           Item Label Line
     C                     Z-ADD*ZERO     YL0028           Item Structure
     C                     Z-ADD*ZERO     YL0029           Item Structure
     C                     Z-ADD*ZERO     YL0030           Item Structure
     C                     MOVEL*BLANK    YL0031           Item Type Code
     C                     MOVEL*BLANK    YL0032           MTO Code
     C                     MOVEL*BLANK    YL0033           Item Category C
     C                     MOVEL*BLANK    YL0034           Primal Group Co
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAVNA    WUAVNA           Description Lin
     C                     MOVELWFL7NA    YL0026           Item Label Line
     C                     MOVELWFL8NA    YL0027           Item Label Line
     C                     Z-ADDWFRINB    YL0028           Item Structure
     C                     Z-ADDWFRHNB    YL0029           Item Structure
     C                     Z-ADDWFRGNB    YL0030           Item Structure
     C                     MOVELWFN0CD    YL0031           Item Type Code
     C                     MOVELWFSVCD    YL0032           MTO Code
     C                     MOVELWFSXCD    YL0033           Item Category C
     C                     MOVELWFXRCD    YL0034           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Crt Product Trace     CR - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B2CPMP
     C                     Z-ADDWN0001    WLAIC3           Company Number
     C                     Z-ADDYL0003    WLPFNX           PT Serial Numbe
     C                     Z-ADDYL0017    WLAADX           PT Prod Date YY
     C                     Z-ADDYL0010    WLB9TM           PT Production T
     C                     Z-ADDYL0009    WLADDX           PT Label Date Y
     C                     Z-ADDYL0022    WLABDX           PT Offset Prod
     C                     Z-ADDYL0023    WLCATM           PT Offset Prod
     C                     MOVELWAMMSX    WLMNSX           PT Inventory St
     C                     Z-ADDYL0024    WLJOWG           PT Net Weight
     C                     Z-ADDYL0025    WLJPWG           PT Gross Weight
     C                     MOVELWAXOCD    WLMOSX           PT Shift Number
     C                     MOVELYL0013    WLDNAA           PT Warehouse ID
     C                     Z-ADDYL0011    WLPGNX           PT Order Number
     C                     MOVELWABNT1    WLBTT1           PT Pallet Numbe
     C                     Z-ADDYL0012    WLD7C7           PT Product Code
     C                     MOVELYL0026    WLPYNA           PT Item Label L
     C                     MOVELYL0027    WLPZNA           PT Item Label L
     C                     MOVELYL0014    WLMPSX           PT Fresh/Frozen
     C                     MOVELYL0035    WLCCT1           PT Item Picture
     C                     Z-ADD*ZERO     WLPHNX           PT Tattoo Numbe
     C                     MOVELWUOTTX    WLMQSX           PT Source Type
     C                     MOVEL*BLANK    WLDOAA           PT Source Code
     C                     MOVEL*BLANK    WLBUT1           PT Source Code
     C                     MOVEL*BLANK    WLDYAA           PT Producer/Cel
     C                     MOVEL*BLANK    WLBVT1           PT Producer/Cel
     C                     MOVEL*BLANK    WLDPAA           PT Producer/Far
     C                     MOVEL*BLANK    WLDQAA           PT Producer Loc
     C                     MOVEL*BLANK    WLBZT1           PT Producer/Far
     C                     MOVEL*BLANK    WLBWT1           PT Producer/Far
     C                     MOVELWUOTTX    WLDRAA           PT Producer/Far
     C                     MOVEL*BLANK    WLB9T1           PT Producer/Far
     C                     MOVEL*BLANK    WLDSAA           PT Genetic Code
     C                     MOVEL*BLANK    WLB8T1           PT Genetic Desc
     C                     MOVELWUOTTX    WLD4AA           PT Gender Code
     C                     MOVEL*BLANK    WLEPAA           PT Producer/Far
     C                     MOVEL*BLANK    WLEQAA           PT Producer/Far
     C                     MOVEL*BLANK    WLERAA           PT Producer/Far
     C                     MOVEL*BLANK    WLESAA           PT Producer/Far
     C                     MOVELYL0031    WLPNSX           PT Item Type Co
     C                     Z-ADDYL0028    WLUFNX           PT Item Str Cla
     C                     Z-ADDYL0029    WLUGNX           PT Item Str Gro
     C                     Z-ADDYL0030    WLUHNX           PT Item Str Typ
     C                     Z-ADD*ZERO     WLAGDX           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WLCGTM           PT WIP Dump/Pro
     C                     MOVELWUXKTX    WLPOSX           PT WIP Dump/Pro
     C                     MOVELWUOTTX    WLPPSX           PT WIP Used/Not
     C                     Z-ADD*ZERO     WLUINX           PT From FG Seri
     C                     Z-ADD*ZERO     WLUJNX           PT To FG Serial
     C                     Z-ADD*ZERO     WLUKNX           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WLULNX           PT Unused Nbr 4
     C                     MOVELYL0021    WLPRSX           PT Incl in Prod
     C                     MOVELWUOTTX    WLPSSX           PT Unused Sts 4
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     MOVEL*BLANK    WLAYNA           User Id
     C                     MOVEL*BLANK    WLA0NA           Job Name
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
     C           KLCRSN    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLPFNX           PT Serial Numbe
     C                     KFLD           WLAADX           PT Prod Date YY
     C                     KFLD           WLB9TM           PT Production T
      * Check for duplicate primary key
     C           KLCRSN    SETLL@B2CPMP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3145' W0RTN   7
      * Send message 'Product Trace          EX'
     C                     MOVEL'USR3145' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@B2CPMP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg Product Trc sts   CH - Product Trace  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0012  80       PT Label Date Y
     C                     Z-ADD*ZERO     WN0013  80       PT Offset Prod
     C                     Z-ADD*ZERO     WN0014  60       PT Offset Prod
     C                     Z-ADD*ZERO     WN0015  51       PT Net Weight
     C                     Z-ADD*ZERO     WN0016  51       PT Gross Weight
     C                     MOVEL*BLANK    WN0017  1        PT Shift Number
     C                     MOVEL*BLANK    WN0018  3        PT Warehouse ID
     C                     MOVEL*BLANK    WN0019 10        PT Pallet Numbe
     C                     Z-ADD*ZERO     WN0020  70       PT Product Code
     C                     MOVEL*BLANK    WN0021 32        PT Item Label L
     C                     MOVEL*BLANK    WN0022 32        PT Item Label L
     C                     MOVEL*BLANK    WN0023  2        PT Fresh/Frozen
     C                     MOVEL*BLANK    WN0024  9        PT Item Picture
     C                     Z-ADD*ZERO     WN0025  50       PT Tattoo Numbe
     C                     MOVEL*BLANK    WN0026  1        PT Source Type
     C                     MOVEL*BLANK    WN0027  3        PT Source Code
     C                     MOVEL*BLANK    WN0028 25        PT Source Code
     C                     MOVEL*BLANK    WN0029  5        PT Producer/Cel
     C                     MOVEL*BLANK    WN0030 25        PT Producer/Cel
     C                     MOVEL*BLANK    WN0031  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0032  6        PT Producer Loc
     C                     MOVEL*BLANK    WN0033 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0034 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0035  2        PT Producer/Far
     C                     MOVEL*BLANK    WN0036 20        PT Producer/Far
     C                     MOVEL*BLANK    WN0037  5        PT Genetic Code
     C                     MOVEL*BLANK    WN0038 25        PT Genetic Desc
     C                     MOVEL*BLANK    WN0039  1        PT Gender Code
     C                     MOVEL*BLANK    WN0040  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0041  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0042  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0043  6        PT Producer/Far
     C                     MOVEL*BLANK    WN0044  3        PT Item Type Co
     C                     Z-ADD*ZERO     WN0045  30       PT Item Str Cla
     C                     Z-ADD*ZERO     WN0046  30       PT Item Str Gro
     C                     Z-ADD*ZERO     WN0047  30       PT Item Str Typ
     C                     Z-ADD*ZERO     WN0048  80       PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WN0049  60       PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0050  1        PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0051  1        PT WIP Used/Not
     C                     Z-ADD*ZERO     WN0052  80       PT From FG Seri
     C                     Z-ADD*ZERO     WN0053  80       PT To FG Serial
     C                     Z-ADD*ZERO     WN0054  80       PT Unused Nbr 3
     C                     Z-ADD*ZERO     WN0055  70       PT Unused Nbr 4
     C                     MOVEL*BLANK    WN0056  1        PT Incl in Prod
     C                     MOVEL*BLANK    WN0057  1        PT Unused Sts 4
     C                     Z-ADD*ZERO     WN0058  60       Job Time
     C                     MOVEL*BLANK    WN0059 10        User Id
     C                     MOVEL*BLANK    WN0060 10        Job Name
     C                     Z-ADD*ZERO     WN0061  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B2CPMP
     C                     Z-ADDWN0001    WLAIC3           Company Number
     C                     Z-ADDYL0003    WLPFNX           PT Serial Numbe
     C                     Z-ADDYL0017    WLAADX           PT Prod Date YY
     C                     Z-ADDYL0010    WLB9TM           PT Production T
      *
     C           KLCHSO    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLPFNX           PT Serial Numbe
     C                     KFLD           WLAADX           PT Prod Date YY
     C                     KFLD           WLB9TM           PT Production T
     C           KLCHSO    CHAIN@B2CPMP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB2CPL0'MDACP
     C                     MOVEL'@B2CPMP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB21    YARDCS
      * Move non-key fields to @B2CPMP
     C                     MOVELWAMMSX    WLMNSX    P      PT Inventory St
     C                     Z-ADDYL0011    WLPGNX           PT Order Number
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB21    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set PGM.*Record Data Changed flag
     C           QPOB21    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B2CPMP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Validate fields before Validate product trace
      *================================================================
     C                     MOVEL'N'       WN0010           Error Status
     C                     MOVELWABHT1    WUYMTX           Text USR 8
      * RPG TESTN for 8 pos.  US - /UT User Source  * 
     C                     TESTN          WUYMTX  8  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     YL0003           PT Serial Numbe
     C                     MOVEL'Y'       YL0004           Error Flag
     C                     MOVEL'Y'       WN0010           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0001    WQ0001  30       Company Number
     C                     PARM 'CASDTL'  WQ0002  6        AS Data Collect
     C                     PARM WN0003    WQ0003  70       AS Transaction
     C                     PARM WN0004    WQ0004  60       AS Transaction
     C                     PARM WABHT1    WQ0005110        AS Error Record
     C                     PARM @CN,01    WQ0006 10        AS Error Log Co
     C                     PARM WN0009    WQ0007 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WABHT1    YL0003           PT Serial Numbe
     C                     END                             *FI
     C                     MOVELWAXDTX    WUYMTX           Text USR 8
      * RPG TESTN for 8 pos.  US - /UT User Source  * 
     C                     TESTN          WUYMTX  8  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
      * Use job date if invalid
     C                     Z-ADD##JDT     WUK7DT           Label Date
      * WRK.Year Code = WRK.Label Date *YEAR
     C           WUK7DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
     C                     MOVELWUAYNX    YL0005           Year Alpha (YYY
      * LCL.Month/Year NBR        USR = WRK.Label Date
     C                     Z-ADDWUK7DT    YL0006           Month/Year NBR
     C                     MOVELYL0006    YL0007           Text USR 4
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0005    CAT  YL0007:ZQ YL0008    P      AS Label Date Y
     C                     MOVE YL0008    YL0009           PT Label Date Y
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WAXDTX    YL0009           PT Label Date Y
      * WRK.Label Date = LCL.PT Label Date YYYYMMDD
     C           YL0009    IFEQ *ZERO
     C                     Z-ADD*ZERO     WUK7DT
     C                     ELSE
     C           YL0009    SUB  19000000  WUK7DT           Label Date
     C                     END
      * Set Century.
      * CASE: WRK.Label Date is < 410101
     C           WUK7DT    IFLT 410101                     *IF
     C                     ADD  1000000   WUK7DT           Label Date
     C                     END                             *FI
      * VAL Date               RT - Calendar  * 
     C                     EXSR SDRVGN
      * Validate label date -  Use job date if invalid 7/08/02
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     Z-ADD##JDT     WUK7DT           Label Date
      * WRK.Year Code = WRK.Label Date *YEAR
     C           WUK7DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WUAYNX
     C                     MOVELWUAYNX    YL0005           Year Alpha (YYY
      * LCL.Month/Year NBR        USR = WRK.Label Date
     C                     Z-ADDWUK7DT    YL0006           Month/Year NBR
     C                     MOVELYL0006    YL0007           Text USR 4
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0005    CAT  YL0007:ZQ YL0008    P      AS Label Date Y
     C                     MOVE YL0008    YL0009           PT Label Date Y
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELWABJT1    WUXLTX           Text USR 6
      * RPG TESTN for 6 pos.  US - /UT User Source  * 
     C                     TESTN          WUXLTX  6  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     WUB9TM           PT Production T
     C                     MOVEL'Y'       YL0004           Error Flag
     C                     MOVEL'Y'       WN0010           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0001    WQ0008  30       Company Number
     C                     PARM 'CASDTL'  WQ0009  6        AS Data Collect
     C                     PARM WN0003    WQ0010  70       AS Transaction
     C                     PARM WN0004    WQ0011  60       AS Transaction
     C                     PARM WABJT1    WQ0012110        AS Error Record
     C                     PARM @CN,02    WQ0013 10        AS Error Log Co
     C                     PARM WN0009    WQ0014 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WABJT1    YL0010           PT Production T
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0011           PT Order Number
      * Order Number
      * CASE: DB1.AS Order Number is Not EQ to Zero
     C           WAASON    IFNE *BLANK                     *IF
     C                     MOVELWAASON    WUY8TX           Text USR 7
      * RPG TESTN for 7 pos.  US - /UT User Source  * 
     C                     TESTN          WUY8TX  7  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     YL0011           PT Order Number
     C                     MOVEL'Y'       YL0004           Error Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WAASON    YL0011           PT Order Number
     C                     END                             *FI
      * Val Order Hdr Exists   RT - Order Header TRG  * 
     C                     EXSR SERVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0001    WQ0015  30       Company Number
     C                     PARM 'CASDTL'  WQ0016  6        AS Data Collect
     C                     PARM WN0003    WQ0017  70       AS Transaction
     C                     PARM WN0004    WQ0018  60       AS Transaction
     C                     PARM WAASON    WQ0019110        AS Error Record
     C                     PARM 'ORDERNUM'WQ0020 10        AS Error Log Co
     C                     PARM WN0009    WQ0021 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Item Code
      *================================================================
     C                     MOVELWAASPD    WUY7TX           Text USR 5
      * RPG TESTN for 5 pos.  US - /UT User Source  * 
     C                     TESTN          WUY7TX  5  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     YL0012           PT Product Code
     C                     MOVEL'Y'       YL0004           Error Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0012           PT Product Code
     C                     MOVE WAASPD    YL0012           PT Product Code
     C                     END                             *FI
      * Val Item/Rtv Whse,PDC  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0001    WL0004           Company Number
     C                     Z-ADDYL0012    WL0005           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WUFZST    P      Production Date
     C                     MOVELWL0007    WUAJCD    P      Default Warehou
      * If item is not found error EQ yes
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0010           Error Status
     C                     MOVEL*BLANK    WN0006           AS Error Record
     C                     MOVELWAASPD    WN0006           AS Error Record
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0001    WQ0022  30       Company Number
     C                     PARM 'CASDTL'  WQ0023  6        AS Data Collect
     C                     PARM WN0003    WQ0024  70       AS Transaction
     C                     PARM WN0004    WQ0025  60       AS Transaction
     C                     PARM WN0006    WQ0026110        AS Error Record
     C                     PARM 'ITEMCODE'WQ0027 10        AS Error Log Co
     C                     PARM WN0009    WQ0028 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Fill in warehouse
      * CASE: DB1.AS Warehouse ID Code EQ WRK.BLANK
     C           WAUYCD    IFEQ WUGSTX                     *IF
      * default whse from company/item
     C                     MOVELWUAJCD    YL0013           PT Warehouse ID
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWAUYCD    YL0013           PT Warehouse ID
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0013    WL0008    P      Warehouse Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YL0014    P      Warehouse Type
      * If warehouse is not found error EQ yes
      * CASE: LCL.PT Fresh/Frozen Code is Equal blank
     C           YL0014    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WN0010           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0001    WQ0029  30       Company Number
     C                     PARM 'CASDTL'  WQ0030  6        AS Data Collect
     C                     PARM WN0003    WQ0031  70       AS Transaction
     C                     PARM WN0004    WQ0032  60       AS Transaction
     C                     PARM WAUYCD    WQ0033110        AS Error Record
     C                     PARM 'WHSCODE' WQ0034 10        AS Error Log Co
     C                     PARM WN0009    WQ0035 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Calculate Offset Production Date and time
      *================================================================
      * 10/27/03 Get Offset from new file
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWABHT1:ZQ YL0019    P  90  Scale ID
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
     C                     EXSR SKRVGN
     C                     Z-ADDYL0017    YL0022           PT Offset Prod
     C                     MULT -1        YL0020           CS Scale Offset
      * LCL.PT Offset Prod Time = LCL.PT Production Time + LCL.CS Scale O
     C                     Z-ADDYL0010    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           60        MULT YL0020    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     YL0023
      * CASE: LCL.PT Offset Prod Time GT LCL.PT Production Time
     C           YL0023    IFGT YL0010                     *IF
      * LCL.PT Offset Prod Date = LCL.PT Offset Prod Date + CON.-1 *DAYS
     C           YL0022    SUB  18000000  XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0022
     C                     ELSE
     C           XDINDT    ADD  18000000  YL0022
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Validate fields if new product trace
      *================================================================
     C                     MOVEL'N'       WN0010           Error Status
     C                     MOVELWABKT1    WUY7TX           Text USR 5
      * RPG TESTN for 5 pos.  US - /UT User Source  * 
     C                     TESTN          WUY7TX  5  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     YL0024           PT Net Weight
     C                     MOVEL'Y'       YL0004           Error Flag
     C                     MOVEL'Y'       WN0010           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0001    WQ0036  30       Company Number
     C                     PARM 'CASDTL'  WQ0037  6        AS Data Collect
     C                     PARM WN0003    WQ0038  70       AS Transaction
     C                     PARM WN0004    WQ0039  60       AS Transaction
     C                     PARM WABKT1    WQ0040110        AS Error Record
     C                     PARM @CN,03    WQ0041 10        AS Error Log Co
     C                     PARM WN0009    WQ0042 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WABKT1    YL0024           PT Net Weight
     C                     END                             *FI
     C                     MOVELWABLT1    WUY7TX           Text USR 5
      * RPG TESTN for 5 pos.  US - /UT User Source  * 
     C                     TESTN          WUY7TX  5  60
     C           *IN60     IFEQ '0'
     C                     MOVE 'DECERR ' WUH3TX
     C                     ELSE
     C                     MOVE '       ' WUH3TX
     C                     END
      * CASE: WRK.Return Code Usr is DECERR
     C           WUH3TX    IFEQ 'DECERR'                   *IF
     C                     Z-ADD*ZERO     YL0025           PT Gross Weight
     C                     MOVEL'Y'       YL0004           Error Flag
     C                     MOVEL'Y'       WN0010           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0001    WQ0043  30       Company Number
     C                     PARM 'CASDTL'  WQ0044  6        AS Data Collect
     C                     PARM WN0003    WQ0045  70       AS Transaction
     C                     PARM WN0004    WQ0046  60       AS Transaction
     C                     PARM WABLT1    WQ0047110        AS Error Record
     C                     PARM @CN,04    WQ0048 10        AS Error Log Co
     C                     PARM WN0009    WQ0049 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WABLT1    YL0025           PT Gross Weight
     C                     END                             *FI
      * Error if no shift entered
      * CASE: DB1.AS Shift Number is Not Entered
     C           WAXOCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WN0010           Error Status
      * Crt Upload Error Log  XF - AS Upload Error Log  * 
     C                     CALL 'POMKXFR'              90  Crt Upload Erro
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0001    WQ0050  30       Company Number
     C                     PARM 'CASDTL'  WQ0051  6        AS Data Collect
     C                     PARM WN0003    WQ0052  70       AS Transaction
     C                     PARM WN0004    WQ0053  60       AS Transaction
     C                     PARM WAXOCD    WQ0054110        AS Error Record
     C                     PARM 'SHIFT'   WQ0055 10        AS Error Log Co
     C                     PARM WN0009    WQ0056 10        AS Notified Lis
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XTAD1     BEGSR
      *================================================================
      * Add TME to absolute time (seconds)
      *================================================================
     C           XTHH      MULT 3600      XDWK1   80
     C                     ADD  XDWK1     XASC
     C           XTNN      MULT 60        XDWK1
     C                     ADD  XDWK1     XASC
     C                     ADD  XTSS      XASC
      *================================================================
     CSR         XTAD1E    ENDSR
      /EJECT
     CSR         XTCT1     BEGSR
      *================================================================
      * Convert absolute time (seconds) to TME
      *================================================================
     C                     EXSR XTFCT
     C           XASC      DIV  60        XASC
     C                     MVR            XTSS
     C           XASC      DIV  60        XASC
     C                     MVR            XTNN
     C                     Z-ADDXASC      XTHH
      *================================================================
     CSR         XTCT1E    ENDSR
      /EJECT
     CSR         XTFCT     BEGSR
      *================================================================
      * Factorize absolute date (seconds) by 24 hours
      *================================================================
     C           XASC      IFGE 86400
     C                     DIV  86400     XASC    80
     C                     MVR            XASC
     C                     ELSE
     C           XASC      IFLE *ZERO
     C                     DIV  86400     XASC
     C                     MVR            XASC
     C           XASC      IFNE *ZERO
     C                     ADD  86400     XASC
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         XTFCTE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBNLNB           Entity Number
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Text USR 8
     C                     MOVEL*BLANK    WUYMTX  8
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Define work field Label Date
     C                     Z-ADD*ZERO     WUK7DT  70
      * Define work field Year Code
     C                     Z-ADD*ZERO     WUAYNX  40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WDCQNB           Julian Date
     C                     Z-ADD*ZERO     WDESNB           Accounting Year
     C                     Z-ADD*ZERO     WDETNB           Accounting Peri
     C                     Z-ADD*ZERO     WDBZNB           OM Week
     C                     Z-ADD*ZERO     WDEINB           Week Number
     C                     Z-ADD*ZERO     WDAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WDOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WDNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WDNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WDOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WDOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Text USR 6
     C                     MOVEL*BLANK    WUXLTX  6
      * Define work field PT Production Time
     C                     Z-ADD*ZERO     WUB9TM  60
      * Define work field Text USR 7
     C                     MOVEL*BLANK    WUY8TX  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A/R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Unused Date
     C                     Z-ADD*ZERO     WENPDT           OH Unused Date
     C                     Z-ADD*ZERO     WENQDT           OH Unused Date
     C                     Z-ADD*ZERO     WENRDT           OH Unused Date
     C                     Z-ADD*ZERO     WENSDT           OH Unused Date
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WEH0NX           OH Unused Nbr 1
     C                     Z-ADD*ZERO     WEH1NX           OH Unused Nbr 2
     C                     Z-ADD*ZERO     WEH2NX           OH Unused Nbr 3
     C                     Z-ADD*ZERO     WEH3NX           OH Unused Nbr 4
     C                     Z-ADD*ZERO     WEH4NX           OH Unused Nbr 5
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Text USR 5
     C                     MOVEL*BLANK    WUY7TX  5
      * Define work field Production Date Control
     C                     MOVEL*BLANK    WUFZST  1
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAIWG           Unit Weight
     C                     Z-ADD*ZERO     WFCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WFC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WFURTN           Number Cases On
     C                     Z-ADD*ZERO     WFAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFTFNB           Transportation
     C                     Z-ADD*ZERO     WFTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WFTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WFBLPR           Market Overage
     C                     Z-ADD*ZERO     WFBMPR           Standard Overag
     C                     Z-ADD*ZERO     WFCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WFCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WFSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WFPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WFICN1           Item Category N
     C                     Z-ADD*ZERO     WFICN2           Item Category N
     C                     Z-ADD*ZERO     WFV2NB           Item Category N
     C                     Z-ADD*ZERO     WFITCN           Item Category N
     C                     Z-ADD*ZERO     WFITC5           Item Category N
     C                     Z-ADD*ZERO     WFICN6           Item Category N
     C                     Z-ADD*ZERO     WFICN7           Item Category N
     C                     Z-ADD*ZERO     WFICN8           Item Category N
     C                     Z-ADD*ZERO     WFICN9           Item Category N
     C                     Z-ADD*ZERO     WFICN0           Item Category N
     C                     Z-ADD*ZERO     WFSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WFA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WFSJNB           CI Unused Numbe
     C                     Z-ADD*ZERO     WFSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WFSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WFSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WFCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WFCGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WFILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WFCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WFCINB           PM Batch Size
     C                     Z-ADD*ZERO     WFCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WFCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WFCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WFCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WFCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WFCVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     WFCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WFCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WFCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WFC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WFB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WFB5NB           PM Line Number
     C                     Z-ADD*ZERO     WFBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WFBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WFF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WFF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WFF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WFBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WFBNNB           Production Qty
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WGBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WGBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WGBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WGBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WHC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WHDXNB           Sequence Number
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WHAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WHAKCS           USR Transaction
     C                     Z-ADD*ZERO     WHAYVA           Extended Amount
     C                     Z-ADD*ZERO     WHCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WHTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WHTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHAWTM           Production Time
     C                     Z-ADD*ZERO     WHK7DT           Label Date
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WIAADX           PT Prod Date YY
     C                     Z-ADD*ZERO     WIB9TM           PT Production T
     C                     Z-ADD*ZERO     WIADDX           PT Label Date Y
     C                     Z-ADD*ZERO     WIABDX           PT Offset Prod
     C                     Z-ADD*ZERO     WICATM           PT Offset Prod
     C                     Z-ADD*ZERO     WIJOWG           PT Net Weight
     C                     Z-ADD*ZERO     WIJPWG           PT Gross Weight
     C                     Z-ADD*ZERO     WIPGNX           PT Order Number
     C                     Z-ADD*ZERO     WID7C7           PT Product Code
     C                     Z-ADD*ZERO     WIPHNX           PT Tattoo Numbe
     C                     Z-ADD*ZERO     WIUFNX           PT Item Str Cla
     C                     Z-ADD*ZERO     WIUGNX           PT Item Str Gro
     C                     Z-ADD*ZERO     WIUHNX           PT Item Str Typ
     C                     Z-ADD*ZERO     WIAGDX           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WICGTM           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WIUINX           PT From FG Seri
     C                     Z-ADD*ZERO     WIUJNX           PT To FG Serial
     C                     Z-ADD*ZERO     WIUKNX           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WIULNX           PT Unused Nbr 4
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJPUDT           Effective Label
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKPINX           CS Scale Offset
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Blank 6 USR
     C                     MOVEL*BLANK    WUXKTX  6
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  3
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009  2
      * Define local work field Upload Error USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Date To               USR
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field PT Serial Number
     C                     Z-ADD*ZERO     YL0003  80
      * Define local work field Error Flag            USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Year Alpha (YYYY) USR
     C                     MOVEL*BLANK    YL0005  4
      * Define local work field Month/Year NBR        USR
     C                     Z-ADD*ZERO     YL0006  40
      * Define local work field Text USR 4
     C                     MOVEL*BLANK    YL0007  4
      * Define local work field AS Label Date YYYYMMDD
     C                     MOVEL*BLANK    YL0008  8
      * Define local work field PT Label Date YYYYMMDD
     C                     Z-ADD*ZERO     YL0009  80
      * Define local work field PT Production Time
     C                     Z-ADD*ZERO     YL0010  60
      * Define local work field PT Order Number
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field PT Product Code
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field PT Warehouse ID Code
     C                     MOVEL*BLANK    YL0013  3
      * Define local work field PT Fresh/Frozen Code
     C                     MOVEL*BLANK    YL0014  2
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field AS Prod Date YYYYMMDD
     C                     MOVEL*BLANK    YL0016  8
      * Define local work field PT Prod Date YYYYMMDD
     C                     Z-ADD*ZERO     YL0017  80
      * Define local work field *Return code
     C                     MOVEL*BLANK    YL0018  7
      * Define local work field Scale ID
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field CS Scale Offset Minutes
     C                     Z-ADD*ZERO     YL0020  30
      * Define local work field CS Include in PrdTr Match
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field PT Offset Prod Date
     C                     Z-ADD*ZERO     YL0022  80
      * Define local work field PT Offset Prod Time
     C                     Z-ADD*ZERO     YL0023  60
      * Define local work field PT Net Weight
     C                     Z-ADD*ZERO     YL0024  51
      * Define local work field PT Gross Weight
     C                     Z-ADD*ZERO     YL0025  51
      * Define local work field PT Item Label Line 1
     C                     MOVEL*BLANK    YL0026 32
      * Define local work field PT Item Label Line 2
     C                     MOVEL*BLANK    YL0027 32
      * Define local work field Item Structure Class Code
     C                     Z-ADD*ZERO     YL0028  30
      * Define local work field Item Structure Group Code
     C                     Z-ADD*ZERO     YL0029  30
      * Define local work field Item Structure Type Code
     C                     Z-ADD*ZERO     YL0030  30
      * Define local work field Item Type Code
     C                     MOVEL*BLANK    YL0031  3
      * Define local work field MTO Code
     C                     MOVEL*BLANK    YL0032  3
      * Define local work field Item Category Code 3
     C                     MOVEL*BLANK    YL0033  3
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0034  6
      * Define local work field PT Item Picture Key
     C                     MOVEL*BLANK    YL0035  9
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 SERNOTNUM
00002 PTMNOTNUM
00003 NETNOTNUM
00004 GRONOTNUM
