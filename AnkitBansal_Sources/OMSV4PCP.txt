/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - PRINT PROGRAM SALES VOLUME CURRENT VS PRIOR          */
/*                                                                  */
/*  COMPANY   - SEABOARD COPRORATION                                */
/*  SYSTEM    - ORDER MANAGEMENT                                    */
/*  USER NAME - DON MCINTYRE                                        */
/*  DATE      - 04/22/94                                            */
/*                                                                  */
/*  MODIFIED FOR GUYMON 10/12/95 - S. SCHERTZ                       */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/*          &PGM        - RPG PROGRAM TO SUBMIT                     */
/*          &OUTQ       -  OUTPUT QUEUE                             */
/*          &HOLD       -  HOLD STATUS                              */
/*          &SAVE       -  SAVE STATUS                              */
/*          &NIGHTQ     -  NIGHT JOB QUEUE                          */
/*          &COMPNYN    - COMPANY NUMBER (PASSED)                   */
/*          &PRIDATN    - PRIOR DATE     (PASSED)                   */
/*          &FRMDATN    - FROM DATE      (PASSED)                   */
/*          &THRDATN    - THRU DATE      (PASSED)                   */
/*          &SLSP       - SALESPERSON    (PASSED)                   */
/*          &SLSTYPN    - SALES TYPE     (PASSED)                   */
/*          &SLSGRPN    - SALES GROUP    (PASSED)                   */
/*          &ACTTYP     - ACTIVITY TYPE  (PASSED)                   */
/*          &SUMFLG     - SUMMARY FLAG   (PASSED)                   */
/*          &COPYN      - NO. OF COPIES  (PASSED)                   */
/*                                                                  */
/********************************************************************/

 OMSV4PCP:   PGM        PARM(&PGM &COMPNYN &PRIDATN &FRMDATN &THRDATN +
                          &SLSTYPN &SLSGRPN &SLSP &MGRLVL &VPLVL +
                          &SUMFLG &ACTTYP &OUTQ &HOLD &SAVE &COPYN +
                          &NIGHTQ)


        DCL    &COMPANY   *DEC    (3 0)           /*  COMPANY #     */
        DCL    &COMPNYN   *DEC                    /*  FOR PASSING   */

        DCL    &PRIDAT    *DEC    (7 0)          /*  FROM SHIP DT   */
        DCL    &PRIDATN   *DEC                   /*  FOR PASSING    */
        DCL    &FRMDAT    *DEC    (7 0)          /*  FROM SHIP DT   */
        DCL    &FRMDATN   *DEC                   /*  FOR PASSING    */
        DCL    &THRDAT    *DEC    (7 0)          /*  THRU SHIP DT   */
        DCL    &THRDATN   *DEC                   /*  FOR PASSING    */

        DCL    &SLSTYP    *DEC    (3 0)          /*  STR. TYPE      */
        DCL    &SLSTYPN   *DEC                   /*  FOR PASSING    */
        DCL    &SLSGRP    *DEC    (3 0)          /*  STR. GROUP     */
        DCL    &SLSGRPN   *DEC                   /*  FOR PASSING    */

        DCL    &SLSP      *CHAR    3
        DCL    &MGRLVL    *CHAR    2
        DCL    &VPLVL     *CHAR    3
        DCL    &SUMFLG    *CHAR    2             /*  SUMMARY FLAG   */
        DCL    &ACTTYP    *CHAR    2             /*  ACTIVITY LEVEL */

        DCL    &COPIES    *DEC    (3 0)           /*  # OF COPIES   */
        DCL    &COPYN     *DEC                    /*  FOR PASSING   */
        DCL    &OUTQ      *CHAR   10              /*  OUTPUT QUEUE  */
        DCL    &NIGHTQ    *CHAR   10              /*  NIGHT JOB QUEUE*/
        DCL    &FORMS     *CHAR   10              /*  FORMS NAME    */
        DCL    &SAVE      *CHAR   4              /*  SAVE SPOOL     */
        DCL    &HOLD      *CHAR   4              /*  HOLD SPOOL     */
        DCL    &PGM       *CHAR   10              /*  PGM NAME      */
        DCL    &COMPA     *CHAR   3               /*  COMPANY ALPHA */
        DCL    &FDATEA    *CHAR   7               /*  FROM DT ALPHA */
        DCL    &TDATEA    *CHAR   7               /*  TO DATE ALPHA */
        DCL    &PDATEA    *CHAR   7               /*  PRIOR DT ALPHA */
        DCL    &COMMAND    *CHAR   (512)

/* SEND PROGRAM MESSAGE PARAMETERS  */

        DCL    &PGMO      *CHAR   10              /*  PRINTER FILE  */
        DCL     &A        *CHAR   20              /* QRY FRM DATE   */
        DCL     &B        *CHAR   25              /* QRY TO DATE    */
        DCL     &C        *CHAR   25              /* QRY COMPANY    */
        DCL     &D        *CHAR   70              /* QRY ALL        */
        DCL     &DATA     *CHAR   10              /* DATA FILES     */
        DCL     &DATAH    *CHAR   10              /* HIST FILES     */

             CHGVAR    VAR(&COMPANY) VALUE(&COMPNYN) /* Change to length +
                          for print program */
             CHGVAR    VAR(&COMPA) VALUE(&COMPANY) /* Change to alpha +
                          for message data */
             CHGVAR    VAR(&PRIDAT) VALUE(&PRIDATN) /* Change to length +
                          for print program */
             CHGVAR    VAR(&PDATEA) VALUE(&PRIDAT) /* Change to alpha +
                          for query data */
             CHGVAR    VAR(&FRMDAT) VALUE(&FRMDATN) /* Change to length +
                          for print program */
             CHGVAR    VAR(&FDATEA) VALUE(&FRMDAT) /* Change to alpha +
                          for query data */
             CHGVAR    VAR(&THRDAT) VALUE(&THRDATN) /* Change to length +
                          for print program */
             CHGVAR     VAR(&TDATEA) VALUE(&THRDAT) /* Change to +
                          alpha for query data */
             CHGVAR    VAR(&SLSTYP) VALUE(&SLSTYPN) /* Change to length +
                          for print program */
             CHGVAR    VAR(&SLSGRP) VALUE(&SLSGRPN) /* Change to length +
                          for print program */
             CHGVAR    VAR(&COPIES) VALUE(&COPYN) /* change to +
                          length for print program */

/********************************************************************/
/* APPEND $ TO THE PROGRAM NAME                                     */
/********************************************************************/

             CHGVAR     VAR(&PGMO) VALUE(&PGM *TCAT '$')

/********************************************************************/
/* Retrieve Data Library name and Data History library name         */
/********************************************************************/

/******       COMMENTED OUT 8/27/96   MEA                      ******/
/******       THE REAL HISTORY FILE WILL BE UPDATED NIGHTLY    ******/

/******      CALL       PGM(CAQXXFR) PARM(' ' &DATA &DATAH)    ******/

/*********************************************************************/
/*   CREATE WORK FILES IN QTEMP                                      */
/*********************************************************************/

/******      RMVLIBLE   LIB(QTEMP)                                ****/
/******      MONMSG     MSGID(CPF0000)                            ****/
/******      ADDLIBLE   LIB(QTEMP)                                ****/
/******      MONMSG     MSGID(CPF0000)                            ****/

/******      CRTDUPOBJ  OBJ(OMHSTPP) FROMLIB(&DATA) OBJTYPE(*FILE)****/
/******                   TOLIB(QTEMP) DATA(*YES)                 ****/
/******      CRTDUPOBJ  OBJ(OMHSTPL0) FROMLIB(&DATA) OBJTYPE(*FILE)***/
/******                   TOLIB(QTEMP) DATA(*YES)                 ****/
/******      CRTDUPOBJ  OBJ(OMHSTPL1) FROMLIB(&DATA) +            ****/
/******                   OBJTYPE(*FILE) TOLIB(QTEMP)             ****/
/******      CRTDUPOBJ  OBJ(OMHSTPLC) FROMLIB(&DATA) OBJTYPE(*FILE)***/
/******                   TOLIB(QTEMP) DATA(*YES)                 ****/
/******      CRTDUPOBJ  OBJ(OMHSTPLS) FROMLIB(&DATA) +            ****/
/******                   OBJTYPE(*FILE) TOLIB(QTEMP)             ****/

/*********************************************************************/
/*   CREATE OPEN QUERY FILE TO BE USED FOR REPORT                    */
/*********************************************************************/

             CHGVAR     VAR(&A) VALUE('F4GNDT *GE ' *CAT +
                         &PDATEA)

             CHGVAR     VAR(&C) VALUE('*AND F4AIC3 *EQ ' *CAT +
                         &COMPA)

             CHGVAR     VAR(&D) VALUE(&A *BCAT &C)

             OVRDBF     FILE(OMHSTPLS) SHARE(*YES)
             OPNQRYF    FILE(OMHSTPLS) +
                        QRYSLT(&D) +
                        KEYFLD(*FILE)

/*           CPYFRMQRYF FROMOPNID(OMHSTPLS) TOFILE(*PRINT)        */
/*********************************************************************/
/*   UPDATE HISTORY FILE WITH CURRENT ITEM STRUCTURE CODES FROM      */
/*   ITEM FILE                                                       */
/*********************************************************************/

/******       COMMENTED OUT 8/27/96   MEA                      ******/
/******       THE REAL HISTORY FILE WILL BE UPDATED NIGHTLY    ******/

/******      CALL       PGM(PDVOXFR) PARM('')                  ******/

/********************************************************************/
/* Override printer file with user specified values                 */
/********************************************************************/

             SBDPRTOVR  CMDVAR(&COMMAND) FILE(&PGMO) OUTQ(&OUTQ) +
                          COPIES(&COPIES) HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)

/*********************************************************************/
/*   CALL LISTING PROGRAM                                            */
/*********************************************************************/

             CALL       PGM(&PGM) PARM('' &COMPANY &SLSP &MGRLVL +
                          &VPLVL &SLSTYP &SLSGRP &FRMDAT &THRDAT +
                          &SUMFLG &ACTTYP)

/*   DELETE WORK FILES IN QTEMP.  */

             CLOF       OPNID(OMHSTPLS)
             DLTOVR     FILE(OMHSTPLS)

/******       COMMENTED OUT 8/27/96   MEA                      ******/
/******       THE REAL HISTORY FILE WILL BE UPDATED NIGHTLY    ******/
/*   DELETE WORK FILES IN QTEMP.  */

/*****       DLTF       FILE(QTEMP/OMHSTPL0)                   ******/
/*****       DLTF       FILE(QTEMP/OMHSTPL1)                   ******/
/*****       DLTF       FILE(QTEMP/OMHSTPLC)                   ******/
/*****       DLTF       FILE(QTEMP/OMHSTPLS)                   ******/
/*****       DLTF       FILE(QTEMP/OMHSTPP)                    ******/

 END:        ENDPGM
