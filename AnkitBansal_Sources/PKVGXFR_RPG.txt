     H/TITLE Prg Voucher Hdr/Dtl   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:04:42
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKBKCPL8IF  E           K        DISK
      * RSQ : Hog Voucher Header        GL Date (D)
      *
     FPKBLCPL1IF  E           K        DISK
      * RTV : Hog Voucher Detail        Retrieval index
      *
     FPKCACPL1IF  E           K        DISK
      * RTV : Hog Voucher Split         Retrieval index
      *
     FPKBLCPL2IF  E           K        DISK                      A
      * UPD : Hog Voucher Detail        Update index for purge
      *
     FPKBLCPL0UF  E           K        DISK
      * UPD : Hog Voucher Detail        Update index
      *
     FPKCACPL3IF  E           K        DISK                      A
      * UPD : Hog Voucher Split         Update index for purge
      *
     FPKCACPL0UF  E           K        DISK
      * UPD : Hog Voucher Split         Update index
      *
     FPKBKCPL9IF  E           K        DISK                      A
      * UPD : Hog Voucher Header        Update index for purge
      *
     FPKBKCPL1UF  E           K        DISK
      * UPD : Hog Voucher Header        Update index
      *
     I@BKCPS9
      * Hog Voucher Header        GL Date (D)
      * Renamed input format fields
     I              BKHNNB                          WAHNNB
     I              BKLWNB                          WALWNB
     I              BKG9NB                          WAG9NB
     I              BKLXNB                          WALXNB
     I              BKLYNB                          WALYNB
     I              BKCSST                          WACSST
     I              BKDKNB                          WADKNB
     I              BKA2DT                          WAA2DT
     I              BKCIPR                          WACIPR
     I              BKCJPR                          WACJPR
     I              BKCKPR                          WACKPR
     I              BKCLPR                          WACLPR
     I              BKCMPR                          WACMPR
     I              BKAUVA                          WAAUVA
     I              BKAVVA                          WAAVVA
     I              BKCHPR                          WACHPR
     I              BKAJVA                          WAAJVA
     I              BKBUPC                          WABUPC
     I              BKJHST                          WAJHST
     I              BKC0ST                          WAC0ST
     I              BKA4DT                          WAA4DT
     I              BKCUST                          WACUST
     I              BKABCD                          WAABCD
     I              BKBNCD                          WABNCD
     I              BKCFCD                          WACFCD
     I              BKAAVN                          WAAAVN
     I              BKAADT                          WAAADT
     I              BKAMTM                          WAAMTM
     I              BKAJST                          WAAJST
     I              BKAHVN                          WAAHVN
     I              BKAGVN                          WAAGVN
     I              BKABVN                          WAABVN
     I              BKABDT                          WAABDT
     I              BKABTM                          WAABTM
      *
     I@BLCPEP
      * Hog Voucher Detail        Retrieval index
      * Renamed input format fields
     I              BLHNNB                          WBHNNB
     I              BLLWNB                          WBLWNB
     I              BLG9NB                          WBG9NB
     I              BLDLNB                          WBDLNB
     I              BLCNPR                          WBCNPR
     I              BLCOPR                          WBCOPR
     I              BLCPPR                          WBCPPR
     I              BLCQPR                          WBCQPR
     I              BLCRPR                          WBCRPR
     I              BLAKVA                          WBAKVA
     I              BLALVA                          WBALVA
     I              BLCVPR                          WBCVPR
     I              BLAMVA                          WBAMVA
     I              BLAEPC                          WBAEPC
     I              BLI6ST                          WBI6ST
     I              BLJIST                          WBJIST
     I              BLJPST                          WBJPST
     I              BLC2SS                          WBC2SS
     I              BLOTCD                          WBOTCD
     I              BLF5TX                          WBF5TX
     I              BLL5A1                          WBL5A1
     I              BLL6A1                          WBL6A1
     I              BLJQST                          WBJQST
     I              BLC4SS                          WBC4SS
     I              BLC5SS                          WBC5SS
     I              BLC3SS                          WBC3SS
     I              BLOKA1                          WBOKA1
     I              BLOLA1                          WBOLA1
     I              BLOMA1                          WBOMA1
     I              BLQ0CD                          WBQ0CD
     I              BLWSA1                          WBWSA1
     I              BLWOA1                          WBWOA1
     I              BLHFDT                          WBHFDT
     I              BLB2TM                          WBB2TM
     I              BLHMNB                          WBHMNB
     I              BLBNNB                          WBBNNB
     I              BLBONB                          WBBONB
     I              BLCVNB                          WBCVNB
     I              BLB0DT                          WBB0DT
     I              BLABCD                          WBABCD
     I              BLAECD                          WBAECD
     I              BLAAVN                          WBAAVN
     I              BLAADT                          WBAADT
     I              BLAMTM                          WBAMTM
     I              BLAJST                          WBAJST
     I              BLAHVN                          WBAHVN
     I              BLAGVN                          WBAGVN
     I              BLABVN                          WBABVN
     I              BLABDT                          WBABDT
     I              BLABTM                          WBABTM
      *
     I@BLCPOG
      * Hog Voucher Detail        Update index for purge
      * Renamed input format fields
     I              BLHNNB                          WCHNNB
     I              BLLWNB                          WCLWNB
     I              BLG9NB                          WCG9NB
     I              BLDLNB                          WCDLNB
     I              BLCNPR                          WCCNPR
     I              BLCOPR                          WCCOPR
     I              BLCPPR                          WCCPPR
     I              BLCQPR                          WCCQPR
     I              BLCRPR                          WCCRPR
     I              BLAKVA                          WCAKVA
     I              BLALVA                          WCALVA
     I              BLCVPR                          WCCVPR
     I              BLAMVA                          WCAMVA
     I              BLAEPC                          WCAEPC
     I              BLI6ST                          WCI6ST
     I              BLJIST                          WCJIST
     I              BLJPST                          WCJPST
     I              BLC2SS                          WCC2SS
     I              BLOTCD                          WCOTCD
     I              BLF5TX                          WCF5TX
     I              BLL5A1                          WCL5A1
     I              BLL6A1                          WCL6A1
     I              BLJQST                          WCJQST
     I              BLC4SS                          WCC4SS
     I              BLC5SS                          WCC5SS
     I              BLC3SS                          WCC3SS
     I              BLOKA1                          WCOKA1
     I              BLOLA1                          WCOLA1
     I              BLOMA1                          WCOMA1
     I              BLQ0CD                          WCQ0CD
     I              BLWSA1                          WCWSA1
     I              BLWOA1                          WCWOA1
     I              BLHFDT                          WCHFDT
     I              BLB2TM                          WCB2TM
     I              BLHMNB                          WCHMNB
     I              BLBNNB                          WCBNNB
     I              BLBONB                          WCBONB
     I              BLCVNB                          WCCVNB
     I              BLB0DT                          WCB0DT
     I              BLABCD                          WCABCD
     I              BLAECD                          WCAECD
     I              BLAAVN                          WCAAVN
     I              BLAADT                          WCAADT
     I              BLAMTM                          WCAMTM
     I              BLAJST                          WCAJST
     I              BLAHVN                          WCAHVN
     I              BLAGVN                          WCAGVN
     I              BLABVN                          WCABVN
     I              BLABDT                          WCABDT
     I              BLABTM                          WCABTM
      *
     I@BLCPEI
      * Hog Voucher Detail        Update index
      * Renamed input format fields
     I              BLHNNB                          WDHNNB
     I              BLLWNB                          WDLWNB
     I              BLG9NB                          WDG9NB
     I              BLDLNB                          WDDLNB
     I              BLCNPR                          WDCNPR
     I              BLCOPR                          WDCOPR
     I              BLCPPR                          WDCPPR
     I              BLCQPR                          WDCQPR
     I              BLCRPR                          WDCRPR
     I              BLAKVA                          WDAKVA
     I              BLALVA                          WDALVA
     I              BLCVPR                          WDCVPR
     I              BLAMVA                          WDAMVA
     I              BLAEPC                          WDAEPC
     I              BLI6ST                          WDI6ST
     I              BLJIST                          WDJIST
     I              BLJPST                          WDJPST
     I              BLC2SS                          WDC2SS
     I              BLOTCD                          WDOTCD
     I              BLF5TX                          WDF5TX
     I              BLL5A1                          WDL5A1
     I              BLL6A1                          WDL6A1
     I              BLJQST                          WDJQST
     I              BLC4SS                          WDC4SS
     I              BLC5SS                          WDC5SS
     I              BLC3SS                          WDC3SS
     I              BLOKA1                          WDOKA1
     I              BLOLA1                          WDOLA1
     I              BLOMA1                          WDOMA1
     I              BLQ0CD                          WDQ0CD
     I              BLWSA1                          WDWSA1
     I              BLWOA1                          WDWOA1
     I              BLHFDT                          WDHFDT
     I              BLB2TM                          WDB2TM
     I              BLHMNB                          WDHMNB
     I              BLBNNB                          WDBNNB
     I              BLBONB                          WDBONB
     I              BLCVNB                          WDCVNB
     I              BLB0DT                          WDB0DT
     I              BLABCD                          WDABCD
     I              BLAECD                          WDAECD
     I              BLAAVN                          WDAAVN
     I              BLAADT                          WDAADT
     I              BLAMTM                          WDAMTM
     I              BLAJST                          WDAJST
     I              BLAHVN                          WDAHVN
     I              BLAGVN                          WDAGVN
     I              BLABVN                          WDABVN
     I              BLABDT                          WDABDT
     I              BLABTM                          WDABTM
      *
     I@CACPII
      * Hog Voucher Split         Retrieval index
      * Renamed input format fields
     I              CAHNNB                          WEHNNB
     I              CALWNB                          WELWNB
     I              CAG9NB                          WEG9NB
     I              CABTCD                          WEBTCD
     I              CAABCD                          WEABCD
     I              CAA6PC                          WEA6PC
     I              CAAAVN                          WEAAVN
     I              CAAADT                          WEAADT
     I              CAAMTM                          WEAMTM
     I              CAAJST                          WEAJST
     I              CAAHVN                          WEAHVN
     I              CAAGVN                          WEAGVN
     I              CAABVN                          WEABVN
     I              CAABDT                          WEABDT
     I              CAABTM                          WEABTM
      *
     I@CACPOI
      * Hog Voucher Split         Update index for purge
      * Renamed input format fields
     I              CAHNNB                          WFHNNB
     I              CALWNB                          WFLWNB
     I              CAG9NB                          WFG9NB
     I              CABTCD                          WFBTCD
     I              CAABCD                          WFABCD
     I              CAA6PC                          WFA6PC
     I              CAAAVN                          WFAAVN
     I              CAAADT                          WFAADT
     I              CAAMTM                          WFAMTM
     I              CAAJST                          WFAJST
     I              CAAHVN                          WFAHVN
     I              CAAGVN                          WFAGVN
     I              CAABVN                          WFABVN
     I              CAABDT                          WFABDT
     I              CAABTM                          WFABTM
      *
     I@CACPIH
      * Hog Voucher Split         Update index
      * Renamed input format fields
     I              CAHNNB                          WGHNNB
     I              CALWNB                          WGLWNB
     I              CAG9NB                          WGG9NB
     I              CABTCD                          WGBTCD
     I              CAABCD                          WGABCD
     I              CAA6PC                          WGA6PC
     I              CAAAVN                          WGAAVN
     I              CAAADT                          WGAADT
     I              CAAMTM                          WGAMTM
     I              CAAJST                          WGAJST
     I              CAAHVN                          WGAHVN
     I              CAAGVN                          WGAGVN
     I              CAABVN                          WGABVN
     I              CAABDT                          WGABDT
     I              CAABTM                          WGABTM
      *
     I@BKCPOH
      * Hog Voucher Header        Update index for purge
      * Renamed input format fields
     I              BKHNNB                          WHHNNB
     I              BKLWNB                          WHLWNB
     I              BKG9NB                          WHG9NB
     I              BKLXNB                          WHLXNB
     I              BKLYNB                          WHLYNB
     I              BKCSST                          WHCSST
     I              BKDKNB                          WHDKNB
     I              BKA2DT                          WHA2DT
     I              BKCIPR                          WHCIPR
     I              BKCJPR                          WHCJPR
     I              BKCKPR                          WHCKPR
     I              BKCLPR                          WHCLPR
     I              BKCMPR                          WHCMPR
     I              BKAUVA                          WHAUVA
     I              BKAVVA                          WHAVVA
     I              BKCHPR                          WHCHPR
     I              BKAJVA                          WHAJVA
     I              BKBUPC                          WHBUPC
     I              BKJHST                          WHJHST
     I              BKC0ST                          WHC0ST
     I              BKA4DT                          WHA4DT
     I              BKCUST                          WHCUST
     I              BKABCD                          WHABCD
     I              BKBNCD                          WHBNCD
     I              BKCFCD                          WHCFCD
     I              BKAAVN                          WHAAVN
     I              BKAADT                          WHAADT
     I              BKAMTM                          WHAMTM
     I              BKAJST                          WHAJST
     I              BKAHVN                          WHAHVN
     I              BKAGVN                          WHAGVN
     I              BKABVN                          WHABVN
     I              BKABDT                          WHABDT
     I              BKABTM                          WHABTM
      *
     I@BKCPEK
      * Hog Voucher Header        Update index
      * Renamed input format fields
     I              BKHNNB                          WIHNNB
     I              BKLWNB                          WILWNB
     I              BKG9NB                          WIG9NB
     I              BKLXNB                          WILXNB
     I              BKLYNB                          WILYNB
     I              BKCSST                          WICSST
     I              BKDKNB                          WIDKNB
     I              BKA2DT                          WIA2DT
     I              BKCIPR                          WICIPR
     I              BKCJPR                          WICJPR
     I              BKCKPR                          WICKPR
     I              BKCLPR                          WICLPR
     I              BKCMPR                          WICMPR
     I              BKAUVA                          WIAUVA
     I              BKAVVA                          WIAVVA
     I              BKCHPR                          WICHPR
     I              BKAJVA                          WIAJVA
     I              BKBUPC                          WIBUPC
     I              BKJHST                          WIJHST
     I              BKC0ST                          WIC0ST
     I              BKA4DT                          WIA4DT
     I              BKCUST                          WICUST
     I              BKABCD                          WIABCD
     I              BKBNCD                          WIBNCD
     I              BKCFCD                          WICFCD
     I              BKAAVN                          WIAAVN
     I              BKAADT                          WIAADT
     I              BKAMTM                          WIAMTM
     I              BKAJST                          WIAJST
     I              BKAHVN                          WIAHVN
     I              BKAGVN                          WIAGVN
     I              BKABVN                          WIABVN
     I              BKABDT                          WIABDT
     I              BKABTM                          WIABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKBL1    E DSPKBLCPL2
      * UPD : Hog Voucher Detail        Update index for purge
      * Renamed input format fields
     I              BLHNNB                          WCHNNB
     I              BLLWNB                          WCLWNB
     I              BLG9NB                          WCG9NB
     I              BLDLNB                          WCDLNB
     I              BLCNPR                          WCCNPR
     I              BLCOPR                          WCCOPR
     I              BLCPPR                          WCCPPR
     I              BLCQPR                          WCCQPR
     I              BLCRPR                          WCCRPR
     I              BLAKVA                          WCAKVA
     I              BLALVA                          WCALVA
     I              BLCVPR                          WCCVPR
     I              BLAMVA                          WCAMVA
     I              BLAEPC                          WCAEPC
     I              BLI6ST                          WCI6ST
     I              BLJIST                          WCJIST
     I              BLJPST                          WCJPST
     I              BLC2SS                          WCC2SS
     I              BLOTCD                          WCOTCD
     I              BLF5TX                          WCF5TX
     I              BLL5A1                          WCL5A1
     I              BLL6A1                          WCL6A1
     I              BLJQST                          WCJQST
     I              BLC4SS                          WCC4SS
     I              BLC5SS                          WCC5SS
     I              BLC3SS                          WCC3SS
     I              BLOKA1                          WCOKA1
     I              BLOLA1                          WCOLA1
     I              BLOMA1                          WCOMA1
     I              BLQ0CD                          WCQ0CD
     I              BLWSA1                          WCWSA1
     I              BLWOA1                          WCWOA1
     I              BLHFDT                          WCHFDT
     I              BLB2TM                          WCB2TM
     I              BLHMNB                          WCHMNB
     I              BLBNNB                          WCBNNB
     I              BLBONB                          WCBONB
     I              BLCVNB                          WCCVNB
     I              BLB0DT                          WCB0DT
     I              BLABCD                          WCABCD
     I              BLAECD                          WCAECD
     I              BLAAVN                          WCAAVN
     I              BLAADT                          WCAADT
     I              BLAMTM                          WCAMTM
     I              BLAJST                          WCAJST
     I              BLAHVN                          WCAHVN
     I              BLAGVN                          WCAGVN
     I              BLABVN                          WCABVN
     I              BLABDT                          WCABDT
     I              BLABTM                          WCABTM
      *
     IQPKBL2    E DSPKBLCPL0
      * UPD : Hog Voucher Detail        Update index
      * Renamed input format fields
     I              BLHNNB                          WDHNNB
     I              BLLWNB                          WDLWNB
     I              BLG9NB                          WDG9NB
     I              BLDLNB                          WDDLNB
     I              BLCNPR                          WDCNPR
     I              BLCOPR                          WDCOPR
     I              BLCPPR                          WDCPPR
     I              BLCQPR                          WDCQPR
     I              BLCRPR                          WDCRPR
     I              BLAKVA                          WDAKVA
     I              BLALVA                          WDALVA
     I              BLCVPR                          WDCVPR
     I              BLAMVA                          WDAMVA
     I              BLAEPC                          WDAEPC
     I              BLI6ST                          WDI6ST
     I              BLJIST                          WDJIST
     I              BLJPST                          WDJPST
     I              BLC2SS                          WDC2SS
     I              BLOTCD                          WDOTCD
     I              BLF5TX                          WDF5TX
     I              BLL5A1                          WDL5A1
     I              BLL6A1                          WDL6A1
     I              BLJQST                          WDJQST
     I              BLC4SS                          WDC4SS
     I              BLC5SS                          WDC5SS
     I              BLC3SS                          WDC3SS
     I              BLOKA1                          WDOKA1
     I              BLOLA1                          WDOLA1
     I              BLOMA1                          WDOMA1
     I              BLQ0CD                          WDQ0CD
     I              BLWSA1                          WDWSA1
     I              BLWOA1                          WDWOA1
     I              BLHFDT                          WDHFDT
     I              BLB2TM                          WDB2TM
     I              BLHMNB                          WDHMNB
     I              BLBNNB                          WDBNNB
     I              BLBONB                          WDBONB
     I              BLCVNB                          WDCVNB
     I              BLB0DT                          WDB0DT
     I              BLABCD                          WDABCD
     I              BLAECD                          WDAECD
     I              BLAAVN                          WDAAVN
     I              BLAADT                          WDAADT
     I              BLAMTM                          WDAMTM
     I              BLAJST                          WDAJST
     I              BLAHVN                          WDAHVN
     I              BLAGVN                          WDAGVN
     I              BLABVN                          WDABVN
     I              BLABDT                          WDABDT
     I              BLABTM                          WDABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKCA1    E DSPKCACPL3
      * UPD : Hog Voucher Split         Update index for purge
      * Renamed input format fields
     I              CAHNNB                          WFHNNB
     I              CALWNB                          WFLWNB
     I              CAG9NB                          WFG9NB
     I              CABTCD                          WFBTCD
     I              CAABCD                          WFABCD
     I              CAA6PC                          WFA6PC
     I              CAAAVN                          WFAAVN
     I              CAAADT                          WFAADT
     I              CAAMTM                          WFAMTM
     I              CAAJST                          WFAJST
     I              CAAHVN                          WFAHVN
     I              CAAGVN                          WFAGVN
     I              CAABVN                          WFABVN
     I              CAABDT                          WFABDT
     I              CAABTM                          WFABTM
      *
     IQPKCA2    E DSPKCACPL0
      * UPD : Hog Voucher Split         Update index
      * Renamed input format fields
     I              CAHNNB                          WGHNNB
     I              CALWNB                          WGLWNB
     I              CAG9NB                          WGG9NB
     I              CABTCD                          WGBTCD
     I              CAABCD                          WGABCD
     I              CAA6PC                          WGA6PC
     I              CAAAVN                          WGAAVN
     I              CAAADT                          WGAADT
     I              CAAMTM                          WGAMTM
     I              CAAJST                          WGAJST
     I              CAAHVN                          WGAHVN
     I              CAAGVN                          WGAGVN
     I              CAABVN                          WGABVN
     I              CAABDT                          WGABDT
     I              CAABTM                          WGABTM
      *
     IQPKBK1    E DSPKBKCPL9
      * UPD : Hog Voucher Header        Update index for purge
      * Renamed input format fields
     I              BKHNNB                          WHHNNB
     I              BKLWNB                          WHLWNB
     I              BKG9NB                          WHG9NB
     I              BKLXNB                          WHLXNB
     I              BKLYNB                          WHLYNB
     I              BKCSST                          WHCSST
     I              BKDKNB                          WHDKNB
     I              BKA2DT                          WHA2DT
     I              BKCIPR                          WHCIPR
     I              BKCJPR                          WHCJPR
     I              BKCKPR                          WHCKPR
     I              BKCLPR                          WHCLPR
     I              BKCMPR                          WHCMPR
     I              BKAUVA                          WHAUVA
     I              BKAVVA                          WHAVVA
     I              BKCHPR                          WHCHPR
     I              BKAJVA                          WHAJVA
     I              BKBUPC                          WHBUPC
     I              BKJHST                          WHJHST
     I              BKC0ST                          WHC0ST
     I              BKA4DT                          WHA4DT
     I              BKCUST                          WHCUST
     I              BKABCD                          WHABCD
     I              BKBNCD                          WHBNCD
     I              BKCFCD                          WHCFCD
     I              BKAAVN                          WHAAVN
     I              BKAADT                          WHAADT
     I              BKAMTM                          WHAMTM
     I              BKAJST                          WHAJST
     I              BKAHVN                          WHAHVN
     I              BKAGVN                          WHAGVN
     I              BKABVN                          WHABVN
     I              BKABDT                          WHABDT
     I              BKABTM                          WHABTM
      *
     IQPKBK2    E DSPKBKCPL1
      * UPD : Hog Voucher Header        Update index
      * Renamed input format fields
     I              BKHNNB                          WIHNNB
     I              BKLWNB                          WILWNB
     I              BKG9NB                          WIG9NB
     I              BKLXNB                          WILXNB
     I              BKLYNB                          WILYNB
     I              BKCSST                          WICSST
     I              BKDKNB                          WIDKNB
     I              BKA2DT                          WIA2DT
     I              BKCIPR                          WICIPR
     I              BKCJPR                          WICJPR
     I              BKCKPR                          WICKPR
     I              BKCLPR                          WICLPR
     I              BKCMPR                          WICMPR
     I              BKAUVA                          WIAUVA
     I              BKAVVA                          WIAVVA
     I              BKCHPR                          WICHPR
     I              BKAJVA                          WIAJVA
     I              BKBUPC                          WIBUPC
     I              BKJHST                          WIJHST
     I              BKC0ST                          WIC0ST
     I              BKA4DT                          WIA4DT
     I              BKCUST                          WICUST
     I              BKABCD                          WIABCD
     I              BKBNCD                          WIBNCD
     I              BKCFCD                          WICFCD
     I              BKAAVN                          WIAAVN
     I              BKAADT                          WIAADT
     I              BKAMTM                          WIAMTM
     I              BKAJST                          WIAJST
     I              BKAHVN                          WIAHVN
     I              BKAGVN                          WIAGVN
     I              BKABVN                          WIABVN
     I              BKABDT                          WIABDT
     I              BKABTM                          WIABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Purge Date USR
     I                                    P   1   40P1EPDT
     IP2PARM      DS
      * FLD: *Arrays
      * I :  Purge Code
     I                                        1   3 P2N7CD
      * I :  Library
     I                                        4  13 P2LBNM
      * I :  Purge Application Code
     I                                       14  19 P2HWCD
      * I :  File
     I                                       20  29 P2A4VN
      * I :  Logical Name
     I                                       30  39 P2A8VN
      * I :  Tape Physical File
     I                                       40  49 P2A9VN
      * I :  Field Name
     I                                       50  55 P2A7VN
      * I :  Date Format
     I                                       56  65 P2VLTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1EPDT    PARM           WP0001  70       Purge Date USR
     C           P2N7CD    PARM           WP0002  3        Purge Code
     C           P2LBNM    PARM           WP0003 10        Library
     C           P2HWCD    PARM           WP0004  6        Purge Applicati
     C           P2A4VN    PARM           WP0005 10        File
     C           P2A8VN    PARM           WP0006 10        Logical Name
     C           P2A9VN    PARM           WP0007 10        Tape Physical F
     C           P2A7VN    PARM           WP0008  6        Field Name
     C           P2VLTX    PARM           WP0009 10        Date Format
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prg Voucher Hdr/Dtl   XF
      * ** Purge by G/L Date <= Purge date
      * Prg Voucher Hdr/Dtl   RT - Hog Voucher Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Prg Voucher Hdr/Dtl   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAA4DT           VCH G/L Date
      * Setup key
     C                     Z-ADDP1EPDT    WAA4DT           VCH G/L Date
      * Establish starting position
     C           KPSSA     SETLL@BKCPS9                    *
     C                     READ @BKCPS9                  90*
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.VCH G/L Date LT PAR.VCH G/L Date
     C           WAA4DT    IFLT P1EPDT                     *IF
      * ** Create tape physical file record and Delete Voucher Detail
      * Prg Voucher Detail    RT - Hog Voucher Detail  * 
     C                     EXSR SBRVGN
      * Prg Voucher Split     RT - Hog Voucher Split  * 
     C                     EXSR SERVGN
      * ** Don't replace chg date with purge date   C001078 LJB 11/2/10
      * ** Create tape physical file record and Delete Voucher Header
      * Prg Houg Voucher HeaderCR - Hog Voucher Header  * 
     C                     EXSR SHCRRC
      * Dlt Voucher Header    DL - Hog Voucher Header  * 
     C                     EXSR SIDLRC
     C                     END                             *FI
     C                     READ @BKCPS9                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Prg Voucher Detail    RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHNNB    WQSB01           VCH Company num
     C           *LIKE     DEFN WBLWNB    WQSB02           VCH Batch Numbe
     C           *LIKE     DEFN WBG9NB    WQSB03           VCH Header Numb
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           VCH Company num
     C                     KFLD           WQSB02           VCH Batch Numbe
     C                     KFLD           WQSB03           VCH Header Numb
      * Setup key
     C                     Z-ADDWAHNNB    WQSB01           VCH Company num
     C                     Z-ADDWALWNB    WQSB02           VCH Batch Numbe
     C                     Z-ADDWAG9NB    WQSB03           VCH Header Numb
      * Establish starting position
     C           KRSSB     SETLL@BLCPEP                    *
     C           KRSSB     READE@BLCPEP                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Prg Hog Voucher Detail CR - Hog Voucher Detail  * 
     C                     EXSR SCCRRC
      * Del Voucher Detail    DL - Hog Voucher Detail  * 
     C                     EXSR SDDLRC
     C           KRSSB     READE@BLCPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Prg Hog Voucher Detail CR - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLCPOG
     C                     Z-ADDWBHNNB    WCHNNB           VCH Company num
     C                     Z-ADDWBLWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWBG9NB    WCG9NB           VCH Header Numb
     C                     Z-ADDWBDLNB    WCDLNB           VCD Line
     C                     Z-ADDWBCNPR    WCCNPR           VCD Base Mkt Pr
     C                     Z-ADDWBCOPR    WCCOPR           VCD Sort Disc A
     C                     Z-ADDWBCPPR    WCCPPR           VCD Yield Gain/
     C                     Z-ADDWBCQPR    WCCQPR           VCD Base Carcas
     C                     Z-ADDWBCRPR    WCCRPR           VCD LN Add on/D
     C                     Z-ADDWBAKVA    WCAKVA           VCD Gross Amt
     C                     Z-ADDWBALVA    WCALVA           VCD Deduction A
     C                     Z-ADDWBCVPR    WCCVPR           VCD Less Split
     C                     Z-ADDWBAMVA    WCAMVA           VCD Net Amt
     C                     Z-ADDWBAEPC    WCAEPC           VCD Split Perce
     C                     MOVELWBI6ST    WCI6ST           VCD Payment Typ
     C                     MOVELWBJIST    WCJIST           VCD Hog Class T
     C                     MOVELWBJPST    WCJPST           VCD BO Type
     C                     MOVELWBC2SS    WCC2SS           VCD Source Cont
     C                     MOVELWBOTCD    WCOTCD           VCD Source Code
     C                     MOVELWBF5TX    WCF5TX           VCD Check Descr
     C                     Z-ADDWBL5A1    WCL5A1           VCD Received He
     C                     Z-ADDWBL6A1    WCL6A1           VCD Head Killed
     C                     MOVELWBJQST    WCJQST           VCD Push Paymen
     C                     MOVELWBC4SS    WCC4SS           VCD Repayment F
     C                     MOVELWBC5SS    WCC5SS           VCD Unused Stat
     C                     MOVELWBC3SS    WCC3SS           VCD Unused Stat
     C                     Z-ADDWBOKA1    WCOKA1           VCD Unused Head
     C                     Z-ADDWBOLA1    WCOLA1           VCD UnUsed Head
     C                     Z-ADDWBOMA1    WCOMA1           VCD UnUsed Head
     C                     MOVELWBQ0CD    WCQ0CD           MGL Supplier In
     C                     Z-ADDWBWSA1    WCWSA1           MGL Voucher Num
     C                     Z-ADDWBWOA1    WCWOA1           MGL Invoice Bat
     C                     Z-ADDWBHFDT    WCHFDT           MGL Process to
     C                     Z-ADDWBB2TM    WCB2TM           MGL Process to
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
     C                     MOVELWBABCD    WCABCD           PD Producer Cod
     C                     MOVELWBAECD    WCAECD           PL Location Cod
     C                     MOVELWBAAVN    WCAAVN           RS User Changed
     C                     Z-ADDWBAADT    WCAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WCAMTM           RS Time Changed
     C                     MOVELWBAJST    WCAJST           RS Record Statu
     C                     MOVELWBAHVN    WCAHVN           RS Job
     C                     MOVELWBAGVN    WCAGVN           RS Program
     C                     MOVELWBABVN    WCABVN           RS User Added
     C                     Z-ADDWBABDT    WCABDT           RS Date Added
     C                     Z-ADDWBABTM    WCABTM           RS Time Added
      *
     C           KLCRSC    KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
     C                     KFLD           WCDLNB           VCD Line
      * Check for duplicate primary key
     C           KLCRSC    SETLL@BLCPOG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0102' W0RTN   7
      * Send message 'Hog Voucher Detail     EX'
     C                     MOVEL'PRK0102' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@BLCPOG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Del Voucher Detail    DL - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BLCPEI
     C                     Z-ADDWBHNNB    WDHNNB           VCH Company num
     C                     Z-ADDWBLWNB    WDLWNB           VCH Batch Numbe
     C                     Z-ADDWBG9NB    WDG9NB           VCH Header Numb
     C                     Z-ADDWBDLNB    WDDLNB           VCD Line
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDHNNB           VCH Company num
     C                     KFLD           WDLWNB           VCH Batch Numbe
     C                     KFLD           WDG9NB           VCH Header Numb
     C                     KFLD           WDDLNB           VCD Line
     C           KLDLSD    CHAIN@BLCPEI              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBLCPL0'MDACP
     C                     MOVEL'@BLCPEI' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BLCPEI                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Prg Voucher Split     RT - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHNNB    WQSE01           VCH Company num
     C           *LIKE     DEFN WELWNB    WQSE02           VCH Batch Numbe
     C           *LIKE     DEFN WEG9NB    WQSE03           VCH Header Numb
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           VCH Company num
     C                     KFLD           WQSE02           VCH Batch Numbe
     C                     KFLD           WQSE03           VCH Header Numb
      * Setup key
     C                     Z-ADDWAHNNB    WQSE01           VCH Company num
     C                     Z-ADDWALWNB    WQSE02           VCH Batch Numbe
     C                     Z-ADDWAG9NB    WQSE03           VCH Header Numb
      * Establish starting position
     C           KRSSE     SETLL@CACPII                    *
     C           KRSSE     READE@CACPII                  90*
      * Data record not found
     C   90                MOVEL'PRK0168' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Prg Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR SFCRRC
      * Delete Hog Check Split - Hog Voucher Split  * 
     C                     EXSR SGDLRC
     C           KRSSE     READE@CACPII                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Prg Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPOI
     C                     Z-ADDWEHNNB    WFHNNB           VCH Company num
     C                     Z-ADDWELWNB    WFLWNB           VCH Batch Numbe
     C                     Z-ADDWEG9NB    WFG9NB           VCH Header Numb
     C                     MOVELWEBTCD    WFBTCD           BOS Split Produ
     C                     MOVELWEABCD    WFABCD           PD Producer Cod
     C                     Z-ADDWEA6PC    WFA6PC           BOS Split Perce
     C                     MOVELWEAAVN    WFAAVN           RS User Changed
     C                     Z-ADDWEAADT    WFAADT           RS Date Changed
     C                     Z-ADDWEAMTM    WFAMTM           RS Time Changed
     C                     MOVELWEAJST    WFAJST           RS Record Statu
     C                     MOVELWEAHVN    WFAHVN           RS Job
     C                     MOVELWEAGVN    WFAGVN           RS Program
     C                     MOVELWEABVN    WFABVN           RS User Added
     C                     Z-ADDWEABDT    WFABDT           RS Date Added
     C                     Z-ADDWEABTM    WFABTM           RS Time Added
      *
     C           KLCRSF    KLIST
     C                     KFLD           WFHNNB           VCH Company num
     C                     KFLD           WFLWNB           VCH Batch Numbe
     C                     KFLD           WFG9NB           VCH Header Numb
     C                     KFLD           WFBTCD           BOS Split Produ
     C                     KFLD           WFABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRSF    SETLL@CACPOI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPOI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * Delete Hog Check Split - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CACPIH
     C                     Z-ADDWEHNNB    WGHNNB           VCH Company num
     C                     Z-ADDWELWNB    WGLWNB           VCH Batch Numbe
     C                     Z-ADDWEG9NB    WGG9NB           VCH Header Numb
     C                     MOVELWEBTCD    WGBTCD           BOS Split Produ
     C                     MOVELWEABCD    WGABCD           PD Producer Cod
      *
     C           KLDLSG    KLIST
     C                     KFLD           WGHNNB           VCH Company num
     C                     KFLD           WGLWNB           VCH Batch Numbe
     C                     KFLD           WGG9NB           VCH Header Numb
     C                     KFLD           WGBTCD           BOS Split Produ
     C                     KFLD           WGABCD           PD Producer Cod
     C           KLDLSG    CHAIN@CACPIH              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCACPL0'MDACP
     C                     MOVEL'@CACPIH' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CACPIH                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Prg Houg Voucher HeaderCR - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BKCPOH
     C                     Z-ADDWAHNNB    WHHNNB           VCH Company num
     C                     Z-ADDWALWNB    WHLWNB           VCH Batch Numbe
     C                     Z-ADDWAG9NB    WHG9NB           VCH Header Numb
     C                     Z-ADDWALXNB    WHLXNB           VCH AP Address
     C                     Z-ADDWALYNB    WHLYNB           VCH AP Voucher
     C                     MOVELWACSST    WHCSST           VCH Payee Type
     C                     Z-ADDWADKNB    WHDKNB           VCH Manual Chec
     C                     Z-ADDWAA2DT    WHA2DT           VCH Manual Chec
     C                     Z-ADDWACIPR    WHCIPR           VCH Base Mkt Pr
     C                     Z-ADDWACJPR    WHCJPR           VCH Sort Disc A
     C                     Z-ADDWACKPR    WHCKPR           VCH Yield Gain/
     C                     Z-ADDWACLPR    WHCLPR           VCH Base Carcas
     C                     Z-ADDWACMPR    WHCMPR           VCH LN Add on/D
     C                     Z-ADDWAAUVA    WHAUVA           VCH Gross Amt
     C                     Z-ADDWAAVVA    WHAVVA           VCH Deduction A
     C                     Z-ADDWACHPR    WHCHPR           VCH Less Split
     C                     Z-ADDWAAJVA    WHAJVA           VCH Net Amt
     C                     Z-ADDWABUPC    WHBUPC           VCH Split %
     C                     MOVELWAJHST    WHJHST           VCH Split Check
     C                     MOVELWAC0ST    WHC0ST           VCH Process Sta
     C                     Z-ADDWAA4DT    WHA4DT           VCH G/L Date
     C                     MOVELWACUST    WHCUST           VCH Check Type
     C                     MOVELWAABCD    WHABCD           PD Producer Cod
     C                     MOVELWABNCD    WHBNCD           TRK Trucker Cod
     C                     MOVELWACFCD    WHCFCD           VR Reason Code
     C                     MOVELWAAAVN    WHAAVN           RS User Changed
     C                     Z-ADDWAAADT    WHAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WHAMTM           RS Time Changed
     C                     MOVELWAAJST    WHAJST           RS Record Statu
     C                     MOVELWAAHVN    WHAHVN           RS Job
     C                     MOVELWAAGVN    WHAGVN           RS Program
     C                     MOVELWAABVN    WHABVN           RS User Added
     C                     Z-ADDWAABDT    WHABDT           RS Date Added
     C                     Z-ADDWAABTM    WHABTM           RS Time Added
      *
      * USER: Processing before Data update
      * ** Don't replace chg date with purge date   C001078 LJB 11/2/10
     C           KLCRSH    KLIST
     C                     KFLD           WHHNNB           VCH Company num
     C                     KFLD           WHLWNB           VCH Batch Numbe
     C                     KFLD           WHG9NB           VCH Header Numb
      * Check for duplicate primary key
     C           KLCRSH    SETLL@BKCPOH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0100' W0RTN   7
      * Send message 'Hog Voucher Header     EX'
     C                     MOVEL'PRK0100' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@BKCPOH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * Dlt Voucher Header    DL - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BKCPEK
     C                     Z-ADDWAHNNB    WIHNNB           VCH Company num
     C                     Z-ADDWALWNB    WILWNB           VCH Batch Numbe
     C                     Z-ADDWAG9NB    WIG9NB           VCH Header Numb
      *
     C           KLDLSI    KLIST
     C                     KFLD           WIHNNB           VCH Company num
     C                     KFLD           WILWNB           VCH Batch Numbe
     C                     KFLD           WIG9NB           VCH Header Numb
     C           KLDLSI    CHAIN@BKCPEK              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBKCPL1'MDACP
     C                     MOVEL'@BKCPEK' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BKCPEK                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHNNB           VCH Company num
     C                     Z-ADD*ZERO     WALWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     WAG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     WALXNB           VCH AP Address
     C                     Z-ADD*ZERO     WALYNB           VCH AP Voucher
     C                     Z-ADD*ZERO     WADKNB           VCH Manual Chec
     C                     Z-ADD*ZERO     WAA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     WACIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WACJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WACKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WACLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WACMPR           VCH LN Add on/D
     C                     Z-ADD*ZERO     WAAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WAAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WACHPR           VCH Less Split
     C                     Z-ADD*ZERO     WAAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WABUPC           VCH Split %
     C                     Z-ADD*ZERO     WAA4DT           VCH G/L Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHNNB           VCH Company num
     C                     Z-ADD*ZERO     WBLWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     WBG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     WBDLNB           VCD Line
     C                     Z-ADD*ZERO     WBCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     WBCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     WBCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     WBCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     WBCRPR           VCD LN Add on/D
     C                     Z-ADD*ZERO     WBAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     WBALVA           VCD Deduction A
     C                     Z-ADD*ZERO     WBCVPR           VCD Less Split
     C                     Z-ADD*ZERO     WBAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     WBAEPC           VCD Split Perce
     C                     Z-ADD*ZERO     WBL5A1           VCD Received He
     C                     Z-ADD*ZERO     WBL6A1           VCD Head Killed
     C                     Z-ADD*ZERO     WBOKA1           VCD Unused Head
     C                     Z-ADD*ZERO     WBOLA1           VCD UnUsed Head
     C                     Z-ADD*ZERO     WBOMA1           VCD UnUsed Head
     C                     Z-ADD*ZERO     WBWSA1           MGL Voucher Num
     C                     Z-ADD*ZERO     WBWOA1           MGL Invoice Bat
     C                     Z-ADD*ZERO     WBHFDT           MGL Process to
     C                     Z-ADD*ZERO     WBB2TM           MGL Process to
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHNNB           VCH Company num
     C                     Z-ADD*ZERO     WELWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     WEG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     WEA6PC           BOS Split Perce
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
