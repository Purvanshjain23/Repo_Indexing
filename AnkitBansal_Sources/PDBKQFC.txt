PGM       PARM(&RTNCDE &FUNCTION)
/*T: Company/Item              Co/Itm */
/*Z: CRTCLPGM */

/*H: Generated by  : SYNON/2  Version:  1204 */
/*H: Company       : DWS Model V2.2 S3.1 Ship -Development- */
/*H: System        : DWS Version 2.2 Synon 3.1 Ship */
/*H: User name     : ISPPATE */
/*H: Date          : 10/30/95  Time  : 09:47:09 */
/*H: Copyright     : DWS Model V2.2 S3.1 Ship -Development- */
/*H:  */
/*============================================================*/
/*M: Maintenance   : */
/*============================================================*/
DCL       &RTNCDE        *CHAR     7    /* O: Return Code */
DCL       &FUNCTION      *CHAR     3    /* I: Requested function */
DCL       &MSGDTA        *CHAR     132
DCL       &MSGID         *CHAR     7
DCL       &MSGF          *CHAR     10
DCL       &MSGFLIB       *CHAR     10

          MONMSG MSGID(CPF0000) EXEC(GOTO ERROR)

          CHGVAR &RTNCDE ' '
          CHGVAR &MSGID  ' '

          IF   (&FUNCTION = OPN) +
          THEN(DO)
             OPNQRYF +
               FILE(CABZRELM) +
               OPTION(*INP) +
               FORMAT(CABZREQM) +
               KEYFLD( +
                      BZAIC3 +
                      BZHGCD +
                   ) +
               UNIQUEKEY(*NONE) +
               OPTIMIZE(*ALLIO  ) +
               SEQONLY(*NO) +
               TYPE(*PERM)
          ENDDO
          ELSE DO
             CLOF OPNID(CABZRELM)
          ENDDO

EXITPGM:
          IF (&MSGID¬= ' ') DO
             SNDPGMMSG MSGID(&MSGID) +
                       MSGF(&MSGFLIB/&MSGF) +
                       MSGDTA(&MSGDTA) +
                       MSGTYPE(*ESCAPE)
             MONMSG MSGID(CPF0000)
          ENDDO
          RMVMSG CLEAR(*ALL)
          MONMSG MSGID(CPF0000)
          RETURN

ERROR:
          CHGVAR &RTNCDE YYY9999
          RCVMSG MSGTYPE(*EXCP) +
                 MSGDTA(&MSGDTA) MSGID(&MSGID) +
                 MSGF(&MSGF) MSGFLIB(&MSGFLIB)
          MONMSG MSGID(CPF0000)

          GOTO EXITPGM
ENDPGM
