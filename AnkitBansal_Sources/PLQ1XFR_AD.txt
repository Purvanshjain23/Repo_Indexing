// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLQ1XFR
// ?Date: 14.08.2025 Time: 02:55:13
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modifications and Comments
DO;

//?P12827 JJH 04/04/18 - STF Gate Entry
//?- If Buy Order/Load, retrive data from Delivery by Buy Order/Load
//?E3503 JJH 11/29/14 - Authorized Gate Emtry Date/Time
//? Add new I-Parm: Truck Auth Entry Time USR which is required for
//? Edt DelivTrack Entry  ER - Delivery Tracking.
//?H16853 ISE 11/02/2020 CHANGE BUY ORDER NUMBER FIELD LENGTH FROM 5 TO 7
ENDDO;

//?P12827 JJH 04/05/18 - If Buy Order/Load, retrive data from Delivery
//?  by Buy Order/Load
CASE;

// IF PAR.BOH Buy Order Number is NE Zero
IF PAR.BOH_Buy_Order_Number <> *ZERO;

EXECUTE FUNCTION(Val DT per BOL        RT) TYPE(RTVOBJ) FILE(PLAFCPP)           AB1247617;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(PAR.DSH_Kill_Date);
PARAMETER(PAR.DT_Delivery_Date);
PARAMETER(PAR.DT_Delivery_Time);
PARAMETER(PAR.DT_Delivery_Time_Seq);
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(WRK.Return_Code_USR);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PAR.Return Code USR = CND.*Record does not exist
 PAR.Return_Code_USR = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 // PAR.Return Code USR = CND.*Normal
 PAR.Return_Code_USR = *BLANK;

}


// IF PAR.DT Movement Number is Entered
IF PAR.DT_Movement_Number <> *ZERO;

EXECUTE FUNCTION(Val DT per Movement   RT) TYPE(RTVOBJ) FILE(PLAFCPP)           AB1248715;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(PAR.DSH_Kill_Date);
PARAMETER(PAR.DT_Delivery_Date);
PARAMETER(PAR.DT_Delivery_Time);
PARAMETER(PAR.DT_Delivery_Time_Seq);
PARAMETER(PAR.DT_Movement_Number);
PARAMETER(WRK.Return_Code_USR);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PAR.Return Code USR = CND.*Record does not exist
 PAR.Return_Code_USR = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 // PAR.Return Code USR = CND.*Normal
 PAR.Return_Code_USR = *BLANK;

}


// IF *OTHERWISE
IF *OTHERWISE;

// Send error message - 'Delivery Tracking cannot be created.'
ERROR(PRK1078);

QUIT;

ENDIF;

// WRK.TRK Arrival Step Usr = CND.Trucker at Rec Doc
WRK.TRK_Arrival_Step_Usr = 'R';

// Call program Edt DelivTrack Entry  ER.
CALL PROGRAM(Edt DelivTrack Entry  ER) ('PLQLE1R');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(PAR.DSH_Kill_Date);
PARAMETER(PAR.DT_Delivery_Date);
PARAMETER(PAR.DT_Delivery_Time);
PARAMETER(PAR.DT_Delivery_Time_Seq);
PARAMETER(PAR.Status_1);
PARAMETER(WRK.TRK_Arrival_Step_Usr);
PARAMETER(PAR.Truck_Auth_Entry_Time_USR);

