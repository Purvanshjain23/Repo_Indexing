/*********************************************************************/
/* PROGRAM : PVHVUPC                                                 */
/* DESC    : CNV CRT IB&IBD SUFFIX CL  EXECUTE USER PROGRAM          */
/* DATE    : 10/16/2024                                              */
/* PROJECT : SR # 3021250                                            */
/* BY      : DANNY NGUYEN                                            */
/* PURPOSE : Create one time conversion process to create the WIM    */
/*           Item Balance & WIM Item Balance Detail suffix tables.   */
/*           WIB = PUCGCPP => PUCGCPPRST                             */
/*           WIBD = PUCHCPP => PUCHCPPRST                            */
/*                                                                   */
/*           ***MANUALLY SUBMIT PVHVUPC TO BATCH.                    */
/*                                                                   */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE     BY  CHANGE DESCRIPTION                                   */
/* -------- --- ---------------------------------------------------- */
/* MM/DD/YY                                                          */
/*                                                                   */
/*********************************************************************/

             PGM

             DCL        VAR(&DATA) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DATAH) TYPE(*CHAR) LEN(10)


/*-------------------------------------------------------------------*/
/* PROD OR TEST ENVIRONMENT?                                         */
/*-------------------------------------------------------------------*/
             CALL       PGM(CAQXXFR) PARM(' ' &DATA &DATAH)

/*-------------------------------------------------------------------*/
/* Recreate PPBNCPP in the Appropriate Library.                      */
/*-------------------------------------------------------------------*/
  /***********************************/
  /*TEST Environment Processing     */
  /***********************************/
             IF         COND(&DATA *NE 'PRKFLIB') THEN(DO)

             CHKOBJ     OBJ(&DATA/PUCGCPPRST) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)  /* NOT FOUND */

      /*‚FOR OMSDEVSQC ENV */
         /* WIM Item Balance */
             RUNSQL     SQL('CREATE TABLE +
                          OMSDEVSQC/WIM_ITEM_BALANCE_360 FOR +
                          SYSTEM NAME PUCGCPP360 LIKE +
                          OMSDEVSQC/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          OMSDEVSQC/WIM_ITEM_BALANCE_440 FOR +
                          SYSTEM NAME PUCGCPP440 LIKE +
                          OMSDEVSQC/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          OMSDEVSQC/WIM_ITEM_BALANCE_960 FOR +
                          SYSTEM NAME PUCGCPP960 LIKE +
                          OMSDEVSQC/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)

         /* WIM Item Balance Detail */
             RUNSQL     SQL('CREATE TABLE +
                          OMSDEVSQC/WIM_ITEM_BALANCE_DETAIL_360 FOR +
                          SYSTEM NAME PUCHCPP360 LIKE +
                          OMSDEVSQC/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          OMSDEVSQC/WIM_ITEM_BALANCE_DETAIL_440 FOR +
                          SYSTEM NAME PUCHCPP440 LIKE +
                          OMSDEVSQC/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          OMSDEVSQC/WIM_ITEM_BALANCE_DETAIL_960 FOR +
                          SYSTEM NAME PUCHCPP960 LIKE +
                          OMSDEVSQC/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - OMSDEVSQC -ˆDON'T NEED! TABLE +
          ˆCREATION AUTOMATICALLY APPLIES JOURNAL. */
        /*   STRJRNPF   FILE(OMSDEVSQC/PUCGCPPRST) +
                          JRN(TESTJRN/DEVJRN) IMAGES(*AFTER) */
        /*   STRJRNPF   FILE(OMSDEVSQC/PUCHCPPRST) +
                          JRN(TESTJRN/DEVJRN) IMAGES(*AFTER) */

      /*‚FOR PRKTESTF ENV */
         /* WIM Item Balance */
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/WIM_ITEM_BALANCE_360 FOR +
                          SYSTEM NAME PUCGCPP360 LIKE +
                          PRKTESTF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/WIM_ITEM_BALANCE_440 FOR +
                          SYSTEM NAME PUCGCPP440 LIKE +
                          PRKTESTF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/WIM_ITEM_BALANCE_960 FOR +
                          SYSTEM NAME PUCGCPP960 LIKE +
                          PRKTESTF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)

         /* WIM Item Balance Detail */
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/WIM_ITEM_BALANCE_DETAIL_360 FOR +
                          SYSTEM NAME PUCHCPP360 LIKE +
                          PRKTESTF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/WIM_ITEM_BALANCE_DETAIL_440 FOR +
                          SYSTEM NAME PUCHCPP440 LIKE +
                          PRKTESTF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/WIM_ITEM_BALANCE_DETAIL_960 FOR +
                          SYSTEM NAME PUCHCPP960 LIKE +
                          PRKTESTF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - PRKTESTF */
        /*   STRJRNPF   FILE(PRKTESTF/PUCGCPPRST) +
                          JRN(TESTJRN/QUAJRN) IMAGES(*AFTER) */
        /*   STRJRNPF   FILE(PRKTESTF/PUCHCPPRST) +
                          JRN(TESTJRN/QUAJRN) IMAGES(*AFTER) */

      /*‚FOR TPMTESTF ENV */
         /* WIM Item Balance */
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/WIM_ITEM_BALANCE_360 FOR +
                          SYSTEM NAME PUCGCPP360 LIKE +
                          TPMTESTF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/WIM_ITEM_BALANCE_440 FOR +
                          SYSTEM NAME PUCGCPP440 LIKE +
                          TPMTESTF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/WIM_ITEM_BALANCE_960 FOR +
                          SYSTEM NAME PUCGCPP960 LIKE +
                          TPMTESTF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)

         /* WIM Item Balance Detail */
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/WIM_ITEM_BALANCE_DETAIL_360 FOR +
                          SYSTEM NAME PUCHCPP360 LIKE +
                          TPMTESTF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/WIM_ITEM_BALANCE_DETAIL_440 FOR +
                          SYSTEM NAME PUCHCPP440 LIKE +
                          TPMTESTF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/WIM_ITEM_BALANCE_DETAIL_960 FOR +
                          SYSTEM NAME PUCHCPP960 LIKE +
                          TPMTESTF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - TPMTESTF */
        /*   STRJRNPF   FILE(TPMTESTF/PUCGCPPRST) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER) */
        /*   STRJRNPF   FILE(TPMTESTF/PUCHCPPRST) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER) */

      /*‚FOR PRKUATF ENV */
         /* WIM Item Balance */
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/WIM_ITEM_BALANCE_360 FOR +
                          SYSTEM NAME PUCGCPP360 LIKE +
                          PRKUATF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/WIM_ITEM_BALANCE_440 FOR +
                          SYSTEM NAME PUCGCPP440 LIKE +
                          PRKUATF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/WIM_ITEM_BALANCE_960 FOR +
                          SYSTEM NAME PUCGCPP960 LIKE +
                          PRKUATF/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)

         /* WIM Item Balance Detail */
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/WIM_ITEM_BALANCE_DETAIL_360 FOR +
                          SYSTEM NAME PUCHCPP360 LIKE +
                          PRKUATF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/WIM_ITEM_BALANCE_DETAIL_440 FOR +
                          SYSTEM NAME PUCHCPP440 LIKE +
                          PRKUATF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/WIM_ITEM_BALANCE_DETAIL_960 FOR +
                          SYSTEM NAME PUCHCPP960 LIKE +
                          PRKUATF/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - PRKUATF */
        /*   STRJRNPF   FILE(PRKUATF/PUCGCPPRST) +
                          JRN(TESTJRN/UATJRN) IMAGES(*AFTER) */
        /*   STRJRNPF   FILE(PRKUATF/PUCHCPPRST) +
                          JRN(TESTJRN/UATJRN) IMAGES(*AFTER) */

             ENDDO
             ENDDO      /* &DATA *NE 'PRKFLIB' */

  /***********************************/
  /*ˆPROD Environment Processing     */
  /***********************************/
             IF         COND(&DATA *EQ 'PRKFLIB') THEN(DO)
             CHKOBJ     OBJ(&DATA/PUCGCPPRST) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)  /* NOT FOUND */

      /* FOR PRKFLIB ENV */
         /* Item Balance */
             CRTDUPOBJ  OBJ(CAB0REP) FROMLIB(PRKFLIB) OBJTYPE(*FILE) +
                          NEWOBJ(CAB0REP360)
             CHGPF      FILE(PRKFLIB/CAB0REP360) SIZE(*NOMAX)
             CRTDUPOBJ  OBJ(CAB0REP) FROMLIB(PRKFLIB) OBJTYPE(*FILE) +
                          NEWOBJ(CAB0REP440)
             CHGPF      FILE(PRKFLIB/CAB0REP440) SIZE(*NOMAX)
             CRTDUPOBJ  OBJ(CAB0REP) FROMLIB(PRKFLIB) OBJTYPE(*FILE) +
                          NEWOBJ(CAB0REP960)
             CHGPF      FILE(PRKFLIB/CAB0REP960) SIZE(*NOMAX)

         /* Item Balance Detail */
             CRTDUPOBJ  OBJ(CAB1REP) FROMLIB(PRKFLIB) OBJTYPE(*FILE) +
                          NEWOBJ(CAB1REP360)
             RMVPFTRG   FILE(PRKFLIB/CAB1REP360)
             CHGPF      FILE(PRKFLIB/CAB1REP360) SIZE(*NOMAX)
             CRTDUPOBJ  OBJ(CAB1REP) FROMLIB(PRKFLIB) OBJTYPE(*FILE) +
                          NEWOBJ(CAB1REP440)
             RMVPFTRG   FILE(PRKFLIB/CAB1REP440)
             CHGPF      FILE(PRKFLIB/CAB1REP440) SIZE(*NOMAX)
             CRTDUPOBJ  OBJ(CAB1REP) FROMLIB(PRKFLIB) OBJTYPE(*FILE) +
                          NEWOBJ(CAB1REP960)
             RMVPFTRG   FILE(PRKFLIB/CAB1REP960)
             CHGPF      FILE(PRKFLIB/CAB1REP960) SIZE(*NOMAX)

         /* WIM Item Balance */
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/WIM_ITEM_BALANCE_360 FOR +
                          SYSTEM NAME PUCGCPP360 LIKE +
                          PRKFLIB/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/WIM_ITEM_BALANCE_440 FOR +
                          SYSTEM NAME PUCGCPP440 LIKE +
                          PRKFLIB/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/WIM_ITEM_BALANCE_960 FOR +
                          SYSTEM NAME PUCGCPP960 LIKE +
                          PRKFLIB/PUCGCPP RCDFMT @CGCPJ6') +
                          COMMIT(*NONE)

         /* WIM Item Balance Detail */
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/WIM_ITEM_BALANCE_DETAIL_360 FOR +
                          SYSTEM NAME PUCHCPP360 LIKE +
                          PRKFLIB/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/WIM_ITEM_BALANCE_DETAIL_440 FOR +
                          SYSTEM NAME PUCHCPP440 LIKE +
                          PRKFLIB/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/WIM_ITEM_BALANCE_DETAIL_960 FOR +
                          SYSTEM NAME PUCHCPP960 LIKE +
                          PRKFLIB/PUCHCPP RCDFMT @CHCPJ9') +
                          COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - PRKFLIB -ˆDON'T NEED! TABLE +
          ˆCREATION AUTOMATICALLY APPLIES JOURNAL. */
        /*   STRJRNPF   FILE(PRKFLIB/PUCGCPPRST) +
                          JRN(MIMIXPRK/PRKJRN) IMAGES(*AFTER) */
        /*   STRJRNPF   FILE(PRKFLIB/PUCHCPPRST) +
                          JRN(MIMIXPRK/PRKJRN) IMAGES(*AFTER) */

             ENDDO
             ENDDO      /* &DATA *EQ 'PRKFLIB' */

 ENDPGM:     ENDPGM
