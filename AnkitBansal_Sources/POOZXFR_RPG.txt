     H/TITLE BLD Yearly Claims DwnldXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/23/10  Time  : 09:08:21
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMKCPL1IF  E           K        DISK
      * RTV : A/R Claim                 Retrieval index
      *
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FPDMNCPL2IF  E           K        DISK
      * RTV : A/R Claim Explanation     Retrieval Index Expl Onl
      *
     FPPATREL1IF  E           K        DISK
      * RTV : A/R Claim Department      Retrieval index
      *
     FPDMPCPL1IF  E           K        DISK
      * RTV : A/R Claim Resale Product  Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDNACPL0IF  E           K        DISK                      A
      * UPD : WF A/R Claim Download     Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     E                    YK01       20 11  A            Claim Unique Re
      *
     E                    YDOW        7  1               *Days of week
     E                    YK02       20 11  A            Claim Unique De
      *
     I@MKCPWB
      * A/R Claim                 Retrieval index
      * Renamed input format fields
     I              MKC0C7                          WAC0C7
     I              MKZLCD                          WAZLCD
     I              MKBIC3                          WABIC3
     I              MKALNX                          WAALNX
     I              MKRMNB                          WARMNB
     I              MKC3C7                          WAC3C7
     I              MKRFTX                          WARFTX
     I              MKCHSX                          WACHSX
     I              MKCJSX                          WACJSX
     I              MKAYVL                          WAAYVL
     I              MKAZVL                          WAAZVL
     I              MKA0VL                          WAA0VL
     I              MKPQTX                          WAPQTX
     I              MKCNSX                          WACNSX
     I              MKPLTX                          WAPLTX
     I              MKCOSX                          WACOSX
     I              MKPMTX                          WAPMTX
     I              MKCPSX                          WACPSX
     I              MKA1VL                          WAA1VL
     I              MKPNTX                          WAPNTX
     I              MKPOTX                          WAPOTX
     I              MKMLDT                          WAMLDT
     I              MKEJDT                          WAEJDT
     I              MKCQSX                          WACQSX
     I              MKPPTX                          WAPPTX
     I              MKMMDT                          WAMMDT
     I              MKMNDT                          WAMNDT
     I              MKBGTM                          WABGTM
     I              MKCGVN                          WACGVN
     I              MKC4C7                          WAC4C7
     I              MKO2NA                          WAO2NA
     I              MKNFDT                          WANFDT
     I              MKBJTM                          WABJTM
     I              MKCQVN                          WACQVN
     I              MKMODT                          WAMODT
     I              MKBHTM                          WABHTM
     I              MKCHVN                          WACHVN
     I              MKCRSX                          WACRSX
     I              MKMPDT                          WAMPDT
     I              MKBITM                          WABITM
     I              MKCIVN                          WACIVN
     I              MKTBTX                          WATBTX
     I              MKEOVL                          WAEOVL
     I              MKEPVL                          WAEPVL
     I              MKP6DT                          WAP6DT
     I              MKCRTM                          WACRTM
     I              MKYSNX                          WAYSNX
     I              MKT5SX                          WAT5SX
     I              MKF7PC                          WAF7PC
     I              MKF8PC                          WAF8PC
     I              MKF9PC                          WAF9PC
     I              MKEQVL                          WAEQVL
     I              MKERVL                          WAERVL
     I              MKESVL                          WAESVL
     I              MKETVL                          WAETVL
     I              MKT7SX                          WAT7SX
     I              MKT8SX                          WAT8SX
     I              MKT9SX                          WAT9SX
     I              MKUASX                          WAUASX
     I              MKUBSX                          WAUBSX
     I              MKGAPC                          WAGAPC
     I              MKGBPC                          WAGBPC
     I              MKVSST                          WAVSST
     I              MKMJDT                          WAMJDT
     I              MKBETM                          WABETM
     I              MKCCVN                          WACCVN
     I              MKCDVN                          WACDVN
     I              MKMKDT                          WAMKDT
     I              MKBFTM                          WABFTM
     I              MKCEVN                          WACEVN
     I              MKCFVN                          WACFVN
      *
     I@FHSTD3
      * Sales History             Retrieval index
      * Renamed input format fields
     I              F4AIC3                          WCAIC3
     I              F4C4NB                          WCC4NB
     I              F4DPNB                          WCDPNB
     I              F4UENB                          WCUENB
     I              F4MONA                          WCMONA
     I              F4RJCD                          WCRJCD
     I              F4RKCD                          WCRKCD
     I              F4GPTX                          WCGPTX
     I              F4ABTX                          WCABTX
     I              F4KXCD                          WCKXCD
     I              F4BOCD                          WCBOCD
     I              F4BTC7                          WCBTC7
     I              F4ANC7                          WCANC7
     I              F4AQTX                          WCAQTX
     I              F4BKC7                          WCBKC7
     I              F4BRTX                          WCBRTX
     I              F4HNNA                          WCHNNA
     I              F4DBCD                          WCDBCD
     I              F4CKTX                          WCCKTX
     I              F4BCNA                          WCBCNA
     I              F4A0DT                          WCA0DT
     I              F4ACDT                          WCACDT
     I              F4R4CD                          WCR4CD
     I              F4R5CD                          WCR5CD
     I              F4BFCD                          WCBFCD
     I              F4Q4CD                          WCQ4CD
     I              F4AQCD                          WCAQCD
     I              F4TBNB                          WCTBNB
     I              F4BZNA                          WCBZNA
     I              F4RLCD                          WCRLCD
     I              F4JNCD                          WCJNCD
     I              F4Q2CD                          WCQ2CD
     I              F4U2ST                          WCU2ST
     I              F4ATIN                          WCATIN
     I              F4T3NB                          WCT3NB
     I              F4RSRN                          WCRSRN
     I              F4ORIT                          WCORIT
     I              F4AJCD                          WCAJCD
     I              F4AVQT                          WCAVQT
     I              F4D0WG                          WCD0WG
     I              F4CCQT                          WCCCQT
     I              F4AUWG                          WCAUWG
     I              F4AGCD                          WCAGCD
     I              F4AKPR                          WCAKPR
     I              F4AUPR                          WCAUPR
     I              F4CRCD                          WCCRCD
     I              F4A5DT                          WCA5DT
     I              F4AWDT                          WCAWDT
     I              F4HDDT                          WCHDDT
     I              F4AGCS                          WCAGCS
     I              F4AQCS                          WCAQCS
     I              F4AVWG                          WCAVWG
     I              F4AYVA                          WCAYVA
     I              F4AMST                          WCAMST
     I              F4ANST                          WCANST
     I              F4VAST                          WCVAST
     I              F4L6NB                          WCL6NB
     I              F4UMCD                          WCUMCD
     I              F4HCDT                          WCHCDT
     I              F4ESNB                          WCESNB
     I              F4ETNB                          WCETNB
     I              F4BZNB                          WCBZNB
     I              F4EXQT                          WCEXQT
     I              F4BYWG                          WCBYWG
     I              F4S5NB                          WCS5NB
     I              F4MAVA                          WCMAVA
     I              F4KDVA                          WCKDVA
     I              F4USVA                          WCUSVA
     I              F4UTVA                          WCUTVA
     I              F4A4WG                          WCA4WG
     I              F4CKNB                          WCCKNB
     I              F4BMST                          WCBMST
     I              F4R8NB                          WCR8NB
     I              F4RMCD                          WCRMCD
     I              F4BZPR                          WCBZPR
     I              F4RDCD                          WCRDCD
     I              F4Q7CD                          WCQ7CD
     I              F4EXDT                          WCEXDT
     I              F4LQCD                          WCLQCD
     I              F4HICD                          WCHICD
     I              F4RBCD                          WCRBCD
     I              F4RGNB                          WCRGNB
     I              F4RHNB                          WCRHNB
     I              F4RINB                          WCRINB
     I              F4R1NB                          WCR1NB
     I              F4CONB                          WCCONB
     I              F4CEST                          WCCEST
     I              F4GNDT                          WCGNDT
     I              F4RMNB                          WCRMNB
     I              F4AODT                          WCAODT
     I              F4LLCD                          WCLLCD
     I              F4LMCD                          WCLMCD
     I              F4SKNB                          WCSKNB
     I              F4SLNB                          WCSLNB
     I              F4SMNB                          WCSMNB
     I              F4G7NA                          WCG7NA
     I              F4ONVA                          WCONVA
     I              F4N0CD                          WCN0CD
     I              F4B4NB                          WCB4NB
     I              F4B5NB                          WCB5NB
     I              F4N1CD                          WCN1CD
     I              F4GIDT                          WCGIDT
     I              F4Z1ST                          WCZ1ST
     I              F4ULVA                          WCULVA
     I              F4UNVA                          WCUNVA
     I              F4UOVA                          WCUOVA
     I              F4UPVA                          WCUPVA
     I              F4UQVA                          WCUQVA
     I              F4SDCD                          WCSDCD
     I              F4QZCD                          WCQZCD
     I              F4XWST                          WCXWST
     I              F4T9CD                          WCT9CD
     I              F4UBCD                          WCUBCD
     I              F4CFC7                          WCCFC7
     I              F4X1CD                          WCX1CD
     I              F4GASX                          WCGASX
     I              F4DUPR                          WCDUPR
     I              F4B6VL                          WCB6VL
     I              F4IANX                          WCIANX
     I              F4IBNX                          WCIBNX
     I              F4RPCD                          WCRPCD
     I              F4NYDT                          WCNYDT
     I              F4BZTM                          WCBZTM
     I              F4Z4NB                          WCZ4NB
     I              F4XACD                          WCXACD
     I              F4OANA                          WCOANA
     I              F4OKTX                          WCOKTX
     I              F4K4TX                          WCK4TX
     I              F4NBBO                          WCNBBO
     I              F4OCFR                          WCOCFR
     I              F4C0C7                          WCC0C7
     I              F4A1AA                          WCA1AA
     I              F4VEST                          WCVEST
     I              F4A5PR                          WCA5PR
     I              F4CDPR                          WCCDPR
     I              F4D0PR                          WCD0PR
     I              F4D0VL                          WCD0VL
     I              F4IRSX                          WCIRSX
     I              F4CEVL                          WCCEVL
     I              F4ISSX                          WCISSX
     I              F4ITSX                          WCITSX
     I              F4IUSX                          WCIUSX
     I              F4OHDT                          WCOHDT
     I              F4D9PR                          WCD9PR
     I              F4CFVL                          WCCFVL
     I              F4UVST                          WCUVST
     I              F4UWST                          WCUWST
     I              F4UXST                          WCUXST
     I              F4AATM                          WCAATM
     I              F4AYNA                          WCAYNA
     I              F4A0NA                          WCA0NA
     I              F4AXDT                          WCAXDT
      *
     I@JEREWS
      * Sales Route               Active Records
      * Renamed input format fields
     I              JER4CD                          WDR4CD
     I              JEMZNA                          WDMZNA
     I              JEBCCD                          WDBCCD
     I              JEBFCD                          WDBFCD
     I              JEQ4CD                          WDQ4CD
     I              JEWOST                          WDWOST
     I              JER8CD                          WDR8CD
     I              JEUVST                          WDUVST
     I              JEUWST                          WDUWST
     I              JEUXST                          WDUXST
     I              JEVSST                          WDVSST
     I              JEAATM                          WDAATM
     I              JEAYNA                          WDAYNA
     I              JEA0NA                          WDA0NA
     I              JEAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@APREBU
      * Salesperson               Retrieval index       V
      * Renamed input format fields
     I              APBCCD                          WGBCCD
     I              APALTX                          WGALTX
     I              APACNA                          WGACNA
     I              APADNA                          WGADNA
     I              APAENA                          WGAENA
     I              APAJNA                          WGAJNA
     I              APBGCD                          WGBGCD
     I              APBTTX                          WGBTTX
     I              APBVTX                          WGBVTX
     I              APBWTX                          WGBWTX
     I              APDZTX                          WGDZTX
     I              APD0TX                          WGD0TX
     I              APD1TX                          WGD1TX
     I              APLVCD                          WGLVCD
     I              APKZCD                          WGKZCD
     I              APAIC3                          WGAIC3
     I              APAVNB                          WGAVNB
     I              APDSCD                          WGDSCD
     I              APUVST                          WGUVST
     I              APUWST                          WGUWST
     I              APUXST                          WGUXST
     I              APVSST                          WGVSST
     I              APAATM                          WGAATM
     I              APAYNA                          WGAYNA
     I              APA0NA                          WGA0NA
     I              APAXDT                          WGAXDT
      *
     I@MNCPSE
      * A/R Claim Explanation     Retrieval Index Expl Onl
      * Renamed input format fields
     I              MNC0C7                          WHC0C7
     I              MNAANX                          WHAANX
     I              MNPYTX                          WHPYTX
     I              MNLGNY                          WHLGNY
     I              MNRRDT                          WHRRDT
     I              MNL1TX                          WHL1TX
     I              MNN7T1                          WHN7T1
     I              MNRSDT                          WHRSDT
     I              MNC9TM                          WHC9TM
     I              MNL2TX                          WHL2TX
     I              MNVSST                          WHVSST
     I              MNMJDT                          WHMJDT
     I              MNBETM                          WHBETM
     I              MNCCVN                          WHCCVN
     I              MNCDVN                          WHCDVN
     I              MNMKDT                          WHMKDT
     I              MNBFTM                          WHBFTM
     I              MNCEVN                          WHCEVN
     I              MNCFVN                          WHCFVN
      *
     I@ATREW0
      * A/R Claim Department      Retrieval index
      * Renamed input format fields
     I              ATFUAA                          WJFUAA
     I              ATTXTX                          WJTXTX
     I              ATTNSX                          WJTNSX
     I              ATVSST                          WJVSST
     I              ATMJDT                          WJMJDT
     I              ATBETM                          WJBETM
     I              ATCCVN                          WJCCVN
     I              ATCDVN                          WJCDVN
     I              ATMKDT                          WJMKDT
     I              ATBFTM                          WJBFTM
     I              ATCEVN                          WJCEVN
     I              ATCFVN                          WJCFVN
      *
     I@MPCPWQ
      * A/R Claim Resale Product  Retrieval index
      * Renamed input format fields
     I              MPC0C7                          WKC0C7
     I              MPBKC7                          WKBKC7
     I              MPAKNX                          WKAKNX
     I              MPBHC3                          WKBHC3
     I              MPC5C7                          WKC5C7
     I              MPCQCD                          WKCQCD
     I              MPHHCD                          WKHHCD
     I              MPCISX                          WKCISX
     I              MPFUAA                          WKFUAA
     I              MPDPNB                          WKDPNB
     I              MPUENB                          WKUENB
     I              MPKVQT                          WKKVQT
     I              MPHIWG                          WKHIWG
     I              MPDJPR                          WKDJPR
     I              MPBOVL                          WKBOVL
     I              MPO2NA                          WKO2NA
     I              MPF0SX                          WKF0SX
     I              MPF1SX                          WKF1SX
     I              MPF2SX                          WKF2SX
     I              MPAMST                          WKAMST
     I              MPANST                          WKANST
     I              MPVAST                          WKVAST
     I              MPUFSX                          WKUFSX
     I              MPQVSX                          WKQVSX
     I              MPQWSX                          WKQWSX
     I              MPQXSX                          WKQXSX
     I              MPVSST                          WKVSST
     I              MPMJDT                          WKMJDT
     I              MPBETM                          WKBETM
     I              MPCCVN                          WKCCVN
     I              MPCDVN                          WKCDVN
     I              MPMKDT                          WKMKDT
     I              MPBFTM                          WKBFTM
     I              MPCEVN                          WKCEVN
     I              MPCFVN                          WKCFVN
      *
     I@NACPZ9
      * WF A/R Claim Download     Update index
      * Renamed input format fields
     I              NAINNX                          WLINNX
     I              NAG6SX                          WLG6SX
     I              NATTTX                          WLTTTX
     I              NATSTX                          WLTSTX
     I              NACHSX                          WLCHSX
     I              NAIONX                          WLIONX
     I              NAIPNX                          WLIPNX
     I              NATUTX                          WLTUTX
     I              NABIC3                          WLBIC3
     I              NAIQNX                          WLIQNX
     I              NATVTX                          WLTVTX
     I              NATYTX                          WLTYTX
     I              NATXTX                          WLTXTX
     I              NATWTX                          WLTWTX
     I              NAB8VL                          WLB8VL
     I              NADQVL                          WLDQVL
     I              NADRVL                          WLDRVL
     I              NAHJSX                          WLHJSX
     I              NAA4AA                          WLA4AA
     I              NACJSX                          WLCJSX
     I              NAPPTX                          WLPPTX
     I              NAAJCD                          WLAJCD
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WMAIC3
     I              OMC4NB                          WMC4NB
     I              OMDPNB                          WMDPNB
     I              OMUENB                          WMUENB
     I              OMHGCD                          WMHGCD
     I              OMAJCD                          WMAJCD
     I              OMBKC7                          WMBKC7
     I              OMCFC7                          WMCFC7
     I              OMGMST                          WMGMST
     I              OMGNST                          WMGNST
     I              OMMAVA                          WMMAVA
     I              OMKDVA                          WMKDVA
     I              OML8VA                          WML8VA
     I              OML9VA                          WML9VA
     I              OMGTST                          WMGTST
     I              OMGVST                          WMGVST
     I              OMGUST                          WMGUST
     I              OMQFST                          WMQFST
     I              OMAYVA                          WMAYVA
     I              OMEXDT                          WMEXDT
     I              OMLQCD                          WMLQCD
     I              OMRDCD                          WMRDCD
     I              OMQ7CD                          WMQ7CD
     I              OMBZPR                          WMBZPR
     I              OML6NB                          WML6NB
     I              OMU1ST                          WMU1ST
     I              OMGIDT                          WMGIDT
     I              OMCRCD                          WMCRCD
     I              OMAGCD                          WMAGCD
     I              OMRZST                          WMRZST
     I              OMR0ST                          WMR0ST
     I              OMR1ST                          WMR1ST
     I              OMG7NA                          WMG7NA
     I              OMG8NA                          WMG8NA
     I              OMRPCD                          WMRPCD
     I              OMVEST                          WMVEST
     I              OMVGST                          WMVGST
     I              OMAVST                          WMAVST
     I              OMU0ST                          WMU0ST
     I              OMRFCD                          WMRFCD
     I              OMFZST                          WMFZST
     I              OMR1NB                          WMR1NB
     I              OMAVQT                          WMAVQT
     I              OMD0WG                          WMD0WG
     I              OMCCQT                          WMCCQT
     I              OMAUWG                          WMAUWG
     I              OMCBQT                          WMCBQT
     I              OMATWG                          WMATWG
     I              OMAQCS                          WMAQCS
     I              OMAGCS                          WMAGCS
     I              OMAKPR                          WMAKPR
     I              OMALPR                          WMALPR
     I              OMAUPR                          WMAUPR
     I              OMAVWG                          WMAVWG
     I              OMA4WG                          WMA4WG
     I              OMA5DT                          WMA5DT
     I              OMAODT                          WMAODT
     I              OMGNDT                          WMGNDT
     I              OMAMST                          WMAMST
     I              OMANST                          WMANST
     I              OMVAST                          WMVAST
     I              OMRGNB                          WMRGNB
     I              OMRHNB                          WMRHNB
     I              OMRINB                          WMRINB
     I              OMRBCD                          WMRBCD
     I              OMHICD                          WMHICD
     I              OMRNCD                          WMRNCD
     I              OMROCD                          WMROCD
     I              OMCXDT                          WMCXDT
     I              OMAJVN                          WMAJVN
     I              OMKXCD                          WMKXCD
     I              OMJPCD                          WMJPCD
     I              OMCQCD                          WMCQCD
     I              OMR4CD                          WMR4CD
     I              OMZ1ST                          WMZ1ST
     I              OMZ3ST                          WMZ3ST
     I              OMZ4ST                          WMZ4ST
     I              OMDUPR                          WMDUPR
     I              OMB6VL                          WMB6VL
     I              OMA1AA                          WMA1AA
     I              OMFZSX                          WMFZSX
     I              OMF0SX                          WMF0SX
     I              OMF1SX                          WMF1SX
     I              OMF2SX                          WMF2SX
     I              OMF3SX                          WMF3SX
     I              OMF4SX                          WMF4SX
     I              OMF5SX                          WMF5SX
     I              OMF6SX                          WMF6SX
     I              OMF7SX                          WMF7SX
     I              OMNTDT                          WMNTDT
     I              OMNUDT                          WMNUDT
     I              OMNVDT                          WMNVDT
     I              OMNWDT                          WMNWDT
     I              OMNXDT                          WMNXDT
     I              OMBUTM                          WMBUTM
     I              OMBVTM                          WMBVTM
     I              OMBWTM                          WMBWTM
     I              OMBXTM                          WMBXTM
     I              OMBYTM                          WMBYTM
     I              OMH5NX                          WMH5NX
     I              OMH6NX                          WMH6NX
     I              OMH7NX                          WMH7NX
     I              OMH8NX                          WMH8NX
     I              OMH9NX                          WMH9NX
     I              OMDVPR                          WMDVPR
     I              OMDWPR                          WMDWPR
     I              OMDXPR                          WMDXPR
     I              OMDYPR                          WMDYPR
     I              OMDZPR                          WMDZPR
     I              OMGSPR                          WMGSPR
     I              OMGTPR                          WMGTPR
     I              OMGUPR                          WMGUPR
     I              OMHOST                          WMHOST
     I              OMHPST                          WMHPST
     I              OMIOST                          WMIOST
     I              OMPEWG                          WMPEWG
     I              OMRINY                          WMRINY
     I              OMTIDT                          WMTIDT
     I              OMTJDT                          WMTJDT
     I              OMH2ST                          WMH2ST
     I              OMH0ST                          WMH0ST
     I              OMH1ST                          WMH1ST
     I              OMTKDT                          WMTKDT
     I              OMTLDT                          WMTLDT
     I              OMTMDT                          WMTMDT
     I              OMUVST                          WMUVST
     I              OMUWST                          WMUWST
     I              OMUXST                          WMUXST
     I              OMAATM                          WMAATM
     I              OMAYNA                          WMAYNA
     I              OMA0NA                          WMA0NA
     I              OMAXDT                          WMAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WOAJCD
     I              ADF8NA                          WOF8NA
     I              ADACNA                          WOACNA
     I              ADADNA                          WOADNA
     I              ADAENA                          WOAENA
     I              ADAJNA                          WOAJNA
     I              ADBTTX                          WOBTTX
     I              ADAOCD                          WOAOCD
     I              ADBGCD                          WOBGCD
     I              ADVHST                          WOVHST
     I              ADMPNA                          WOMPNA
     I              ADWPST                          WOWPST
     I              ADXUST                          WOXUST
     I              ADT0ST                          WOT0ST
     I              ADT1ST                          WOT1ST
     I              ADDBNB                          WODBNB
     I              ADT2ST                          WOT2ST
     I              ADT3ST                          WOT3ST
     I              ADT4ST                          WOT4ST
     I              ADT6ST                          WOT6ST
     I              ADBWC3                          WOBWC3
     I              ADBTC3                          WOBTC3
     I              ADBUC3                          WOBUC3
     I              ADBVC3                          WOBVC3
     I              ADFCAA                          WOFCAA
     I              ADRQSX                          WORQSX
     I              ADRRSX                          WORRSX
     I              ADRSSX                          WORSSX
     I              ADRTSX                          WORTSX
     I              ADT7ST                          WOT7ST
     I              ADT8ST                          WOT8ST
     I              ADRNSX                          WORNSX
     I              ADROSX                          WOROSX
     I              ADRPSX                          WORPSX
     I              ADUVST                          WOUVST
     I              ADUWST                          WOUWST
     I              ADUXST                          WOUXST
     I              ADVSST                          WOVSST
     I              ADAATM                          WOAATM
     I              ADAYNA                          WOAYNA
     I              ADA0NA                          WOA0NA
     I              ADAXDT                          WOAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IYD01        DS
     I                                        1   30YI0101
     I                                        4   6 YI0102
     I                                        7  110YI01
      *
     IYM01        DS                         20
     I                                        1   30WBDXNB
     I                                        4   6 WBCQCD
      *
     IYW01        DS
     I                                        1   30XADXNB
     I                                        4   6 XACQCD
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYD02        DS
     I                                        1   30YI0201
     I                                        4   6 YI0202
     I                                        7  110YI02
      *
     IYM02        DS                         20
     I                                        1   30WIDXNB
     I                                        4   6 WIFUAA
      *
     IYW02        DS
     I                                        1   30XBDXNB
     I                                        4   6 XBFUAA
      *
     IQPDNA1    E DSPDNACPL0
      * UPD : WF A/R Claim Download     Update index
      * Renamed input format fields
     I              NAINNX                          WLINNX
     I              NAG6SX                          WLG6SX
     I              NATTTX                          WLTTTX
     I              NATSTX                          WLTSTX
     I              NACHSX                          WLCHSX
     I              NAIONX                          WLIONX
     I              NAIPNX                          WLIPNX
     I              NATUTX                          WLTUTX
     I              NABIC3                          WLBIC3
     I              NAIQNX                          WLIQNX
     I              NATVTX                          WLTVTX
     I              NATYTX                          WLTYTX
     I              NATXTX                          WLTXTX
     I              NATWTX                          WLTWTX
     I              NAB8VL                          WLB8VL
     I              NADQVL                          WLDQVL
     I              NADRVL                          WLDRVL
     I              NAHJSX                          WLHJSX
     I              NAA4AA                          WLA4AA
     I              NACJSX                          WLCJSX
     I              NAPPTX                          WLPPTX
     I              NAAJCD                          WLAJCD
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Claim Start Entry Date
     I                                    P   1   40P1NBDT
      * I :  Claim End Entry Date
     I                                    P   5   80P1NCDT
      * I :  Memo Posting Str Date Usr
     I                                    P   9  120P1QBDT
      * I :  Memo Posting End Date Usr
     I                                    P  13  160P1QCDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1NBDT    PARM           WP0001  70       Claim Start Ent
     C           P1NCDT    PARM           WP0002  70       Claim End Entry
     C           P1QBDT    PARM           WP0003  70       Memo Posting St
     C           P1QCDT    PARM           WP0004  70       Memo Posting En
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BLD Yearly Claims DwnldXF
      * *** Build Claim Download File ***
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1QBDT' defaulted for 'Memo Posting Str Date Usr'.
      * Field '(PAR) P1QCDT' defaulted for 'Memo Posting End Date Usr'.
      * CRT DNLD Claims Yearly RT - A/R Claim  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * CRT DNLD Claims Yearly RT - A/R Claim  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        *Record selecte
     C                     MOVEL*BLANK    WN0002  2        Claim Type
     C                     Z-ADD*ZERO     WN0003  70       Claim Number (u
     C                     MOVEL*BLANK    WN0004 11        Claim Reason Co
     C                     MOVEL*BLANK    WN0005 20        Claim Short Cus
     C                     Z-ADD*ZERO     WN0006  70       Claim Load ID (
     C                     Z-ADD*ZERO     WN0007  70       Claim Invoice (
     C                     MOVEL*BLANK    WN0008 10        Claim Act Shp D
     C                     Z-ADD*ZERO     WN0009  70       Claim Order # (
     C                     MOVEL*BLANK    WN0010 20        Claim Short Sal
     C                     MOVEL*BLANK    WN0011110        Claim Short Exp
     C                     MOVEL*BLANK    WN0012 20        Claim Departmen
     C                     Z-ADD*ZERO     WN0013 112       Claim Amount (u
     C                     MOVEL*BLANK    WN0014 10        Claim Entry Dat
     C                     MOVEL*BLANK    WN0015  3        Claim Reason Co
     C                     MOVEL*BLANK    WN0016  1        Claim Product/R
     C                     Z-ADD*ZERO     WN0017 112       Claim Resale Am
     C                     Z-ADD*ZERO     WN0018 112       Claim Net Loss
     C                     Z-ADD*ZERO     WN0019  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0020 112       Resale Item Amo
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@MKCPWB                    *
     C                     READ @MKCPWB                  90*
      * Data record not found
     C   90                MOVEL'USR2729' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0001           *Record selecte
      * SEL:  Entry Date
      * CASE: PAR.Claim Start Entry Date is Entered
     C           P1NBDT    IFNE *ZERO                      *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Claim Entry Date LT PAR.Claim Start Entry Date
      *   |- c2    : DB1.Claim Entry Date GT PAR.Claim End Entry Date
      *   '-
     C           WAMNDT    IFLT P1NBDT                     *IF
     C           WAMNDT    ORGT P1NCDT                     *OR
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.*Record selected is *YES
     C           WN0001    IFEQ 'Y'                        *IF
      * Build file based on Claim Products.        (CM/DM)
     C                     EXSR UASUBR                     Build file base
     C                     END                             *FI
     C                     READ @MKCPWB                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Claim Reason Codes RT - *Arrays  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0021  50       Count USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0001           Claim Reason Co
     C                     Z-ADD1         WN0021           Count USR
     C                     Z-ADD1         Y       50
     C           YL01      IFGT 0
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
     C                     ELSE
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
      * Sequence through qualified elements:
     C                     Z-ADDY         YR01    50
     C           YR01      DOWLEYL01
     C                     Z-ADDYR01      Y
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * USER: Process Data record
      * CASE: PAR.Count USR is LE 4
     C           WN0021    IFLE 4                          *IF
      * CASE: PAR.Claim Reason Code(s) is *Blank
     C           WL0001    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0001    CAT  WBCQCD:ZQ WL0001    P      Claim Reason Co
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0001    CAT  ',':ZQ    WL0001    P      Claim Reason Co
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0001    CAT  WBCQCD:ZQ WL0001    P      Claim Reason Co
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         WN0021           Count USR
     C                     ADD  1         YR01
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Claim Order Info   RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDWL0002    WQSC01           Company Number
     C                     Z-ADDWL0003    WQSC02           Order Number
      * Establish starting position
     C           KRSSC     SETLL@FHSTD3                    *
     C           KRSSC     READE@FHSTD3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1241' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Ship To Custome
     C                     MOVEL*BLANK    WL0005           Ship To Name
     C                     MOVEL*BLANK    WL0006           Customer Purcha
     C                     MOVEL*BLANK    WL0007           Carrier Code
     C                     MOVEL*BLANK    WL0008           Warehouse Code
     C                     Z-ADD*ZERO     WL0009           Invoice Date
     C                     Z-ADD*ZERO     WL0010           Invoice Number
     C                     MOVEL*BLANK    WL0011           Invoice Suffix
     C                     Z-ADD*ZERO     WL0012           Actual Shipped
     C                     Z-ADD*ZERO     WL0013           Load ID
     C                     MOVEL*BLANK    WL0014           Salesperson to
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCBKC7    WL0004           Ship To Custome
     C                     MOVELWCBRTX    WL0005           Ship To Name
     C                     MOVELWCBCNA    WL0006           Customer Purcha
     C                     MOVELWCBZNA    WL0007           Carrier Code
     C                     MOVELWCAJCD    WL0008           Warehouse Code
     C                     Z-ADDWCAWDT    WL0009           Invoice Date
     C                     Z-ADDWCCONB    WL0010           Invoice Number
     C                     MOVELWCCEST    WL0011           Invoice Suffix
     C                     Z-ADDWCGNDT    WL0012           Actual Shipped
     C                     Z-ADDWCRMNB    WL0013           Load ID
      * RTV Salesman Code      RT - Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWCR4CD    WL0015    P      Sales Route Cod
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    WL0014    P      Salesperson Cod
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@FHSTD3                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDR4CD           Sales Route Cod
      * Setup key
     C                     MOVELWL0015    WDR4CD           Sales Route Cod
      * Establish starting position
     C           KRSSD     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0016           Salesperson Cod
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDBCCD    WL0016           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Claim Order Info   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0017    WEAIC3           Company Number
     C                     Z-ADDWL0018    WEC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0019           Ship To Custome
     C                     MOVEL*BLANK    WL0020           Ship To Name
     C                     MOVEL*BLANK    WL0021           Customer Purcha
     C                     Z-ADD*ZERO     WL0022           Actual Shipped
     C                     MOVEL*BLANK    WL0023           Carrier Code
     C                     Z-ADD*ZERO     WL0024           Load ID
     C                     Z-ADD*ZERO     WL0025           Invoice Number
     C                     MOVEL*BLANK    WL0026           Invoice Suffix
     C                     Z-ADD*ZERO     WL0027           Invoice Date
     C                     MOVEL*BLANK    WL0028           Salesperson to
     C                     MOVEL*BLANK    WL0029           Warehouse Code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBKC7    WL0019           Ship To Custome
     C                     MOVELWEBRTX    WL0020           Ship To Name
     C                     MOVELWEBCNA    WL0021           Customer Purcha
     C                     Z-ADDWEGNDT    WL0022           Actual Shipped
     C                     MOVELWEBZNA    WL0023           Carrier Code
     C                     Z-ADDWERMNB    WL0024           Load ID
     C                     Z-ADDWECONB    WL0025           Invoice Number
     C                     MOVELWECEST    WL0026           Invoice Suffix
     C                     Z-ADDWEAWDT    WL0027           Invoice Date
      * RTV Whse/Non Cancelled RT - Order Detail  * 
     C                     EXSR SFRVGN
      * RTV Salesman Code      RT - PD Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWER4CD    WL0015    P      Sales Route Cod
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    WL0028    P      Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQSF01           Company Number
     C                     Z-ADDWEC4NB    WQSF02           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
      * Establish starting position
     C           KPSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0029           Warehouse Code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           WFGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELWFAJCD    WL0029           Warehouse Code
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Salesperson        RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGBCCD           Salesperson Cod
      * Setup key
     C                     MOVELWL0030    WGBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSG     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0031           Salesperson Nam
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGALTX    WL0031           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV First Expln Line RT - A/R Claim Explanation  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0028  50       Count USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0033           Claim Short Exp
     C                     Z-ADD1         WN0028           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHC0C7    WQSH01           Claim Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Claim Number
      * Setup key
     C                     Z-ADDWL0032    WQSH01           Claim Number
      * Establish starting position
     C           KRSSH     SETLL@MNCPSE                    *
     C           KRSSH     READE@MNCPSE                  90*
      * Data record not found
     C   90                MOVEL'USR2735' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Count USR is LE 2
     C           WN0028    IFLE 2                          *IF
     C                     Z-ADD1         ZQ      50
     C           WL0033    CAT  WHPYTX:ZQ WL0033    P      Claim Short Exp
     C                     ADD  1         WN0028           Count USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSH     READE@MNCPSE                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Claim Dept Codes RT - *Arrays  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0029 30        Department Desc
     C                     Z-ADD*ZERO     WN0030  50       Count USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0034           Claim Departmen
     C                     Z-ADD1         WN0030           Count USR
     C                     Z-ADD1         Y       50
     C           YL02      IFGT 0
     C                     MOVELYK02,Y    YD02
     C           YI02      OCUR YM02
     C                     ELSE
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
      * Sequence through qualified elements:
     C                     Z-ADDY         YR02    50
     C           YR02      DOWLEYL02
     C                     Z-ADDYR02      Y
     C                     MOVELYK02,Y    YD02
     C           YI02      OCUR YM02
      * USER: Process Data record
      * CASE: PAR.Count USR is LE 4
     C           WN0030    IFLE 4                          *IF
      * 051705 slm use the department description as is do not
      *            set condition for the description
      *            this process was using the responsibility department
      *            now we use the claim department
      * Rtv Claim Department   RT - A/R Claim Department  * 
     C                     EXSR SJRVGN
      * CASE: PAR.Department Description is equal to blank
     C           WN0029    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    WN0029           Department Desc
     C                     MOVEL@CN,01    WN0029           Department Desc
     C                     END                             *FI
      * CASE: PAR.Claim Department Desc is *Blank
     C           WL0034    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0034    CAT  WN0029:ZQ WL0034    P      Claim Departmen
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0034    CAT  ',':ZQ    WL0034    P      Claim Departmen
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0034    CAT  WN0029:ZQ WL0034    P      Claim Departmen
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         WN0030           Count USR
     C                     ADD  1         YR02
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Claim Department   RT - A/R Claim Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WJFUAA           Claim Departmen
      * Setup key
     C                     MOVELWIFUAA    WJFUAA           Claim Departmen
      * Establish starting position
     C           KRSSJ     CHAIN@ATREW0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3421' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0029           Claim Departmen
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJTXTX    WN0029           Claim Departmen
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Calc Resale Total  RT - A/R Claim Resale Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0002           Resale Total It
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKC0C7    WQSK01           Claim Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Claim Number
      * Setup key
     C                     Z-ADDWAC0C7    WQSK01           Claim Number
      * Establish starting position
     C           KRSSK     SETLL@MPCPWQ                    *
     C           KRSSK     READE@MPCPWQ                  90*
      * Data record not found
     C   90                MOVEL'USR2739' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WKBOVL    YL0002           Resale Total It
     C           KRSSK     READE@MPCPWQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * CRT A/R Claim Download CR - A/R Claim Download Wrkf  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0037  3        Warehouse Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NACPZ9
     C                     Z-ADDWL0035    WLINNX           Claim Number (u
     C                     MOVELWL0036    WLG6SX           Claim Product/R
     C                     MOVELWL0037    WLTTTX           Claim Short Cus
     C                     MOVELWL0038    WLTSTX           Claim Reason Co
     C                     MOVELWL0039    WLCHSX           Claim Type
     C                     Z-ADDWL0040    WLIONX           Claim Load ID (
     C                     Z-ADDWL0041    WLIPNX           Claim Invoice (
     C                     MOVELWL0042    WLTUTX           Claim Act Shp D
     C                     Z-ADDWL0043    WLBIC3           Claim Company N
     C                     Z-ADDWL0044    WLIQNX           Claim Order # (
     C                     MOVELWL0045    WLTVTX           Claim Short Sal
     C                     MOVELWL0046    WLTYTX           Claim Entry Dat
     C                     MOVELWL0047    WLTXTX           Claim Departmen
     C                     MOVELWL0048    WLTWTX           Claim Short Exp
     C                     Z-ADDWL0049    WLB8VL           Claim Amount (u
     C                     Z-ADDWL0050    WLDQVL           Claim Resale Am
     C                     Z-ADDWL0051    WLDRVL           Claim Net Loss
     C                     MOVELWL0052    WLHJSX           Claim Over 10 D
     C                     MOVELWL0053    WLA4AA           Claim Reason Co
     C                     MOVELWL0054    WLCJSX           Claim Status
     C                     MOVELWL0055    WLPPTX           Claim Called in
      *
      * USER: Processing before Data update
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SMRVGN
     C           KLCRSL    KLIST
     C                     KFLD           WLINNX           Claim Number (u
     C                     KFLD           WLG6SX           Claim Product/R
     C                     KFLD           WLTTTX           Claim Short Cus
      * Check for duplicate primary key
     C           KLCRSL    SETLL@NACPZ9                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2860' W0RTN   7
      * Send message 'WF A/R Claim Download  EX'
     C                     MOVEL'USR2860' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@NACPZ9                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WMC4NB    WQSM02           Order Number
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           WMDPNB           Order Sequence
     C                     KFLD           WMUENB           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADDWLBIC3    WQSM01           Company Number
     C                     Z-ADDWLIQNX    WQSM02           Order Number
     C                     Z-ADD*ZERO     WMDPNB           Order Sequence
     C                     Z-ADD*ZERO     WMUENB           Order Secondary
      * Establish starting position
     C           KPSSM     SETLL@BGWKAE                    *
     C           KRSSM     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WLAJCD           Warehouse Code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SNRVGN
      * PAR = DB1 By name
     C                     MOVELWMAJCD    WLAJCD           Warehouse Code
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WOAJCD           Warehouse Code
      * Setup key
     C                     MOVELWMAJCD    WOAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Build file based on Claim Products.        (CM/DM)
      *================================================================
      * CASE: PAR.*Record selected is *YES
     C           WN0001    IFEQ 'Y'                        *IF
      * Build & Create Download Record.
     C                     EXSR UBSUBR                     Build & Create
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Build & Create Download Record.
      *================================================================
     C                     Z-ADDWAC0C7    WN0003           Claim Number (u
     C                     MOVEL'P'       WN0016           Claim Product/R
      * RTV Claim Reason Codes RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0004    WL0001    P      Claim Reason Co
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0001    WN0004    P      Claim Reason Co
     C                     MOVELWARFTX    WN0005           Claim Short Cus
     C                     MOVELWACHSX    WN0002           Claim Type
      * Get Order Info.
     C                     EXSR UCSUBR                     Get Order Info.
     C                     Z-ADDWAALNX    WN0009           Claim Order # (
      * RTV Salesperson        RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAZLCD    WL0030    P      Salesperson Cod
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    YL0001    P      Salesperson Nam
      * CLC Find Last Name     UP - A/R Claim Download Wrkf  * 
     C                     CALL 'POAGUPC'              90  CLC Find Last N
     C                     PARM YL0001    WQ0001 30        Salesperson Nam
     C           WN0010    PARM *BLANK    WQ0002 20        Claim Short Sal
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POAGUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Load Short Explanation.
     C                     EXSR UDSUBR                     Load Short Expl
      * RTV Claim Dept Codes RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0034    P      Claim Departmen
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0034    WN0012    P      Claim Departmen
     C                     Z-ADDWAAYVL    WN0013           Claim Amount (u
      *
     C                     Z-ADD*ZERO     WN0031  40       YYYY numeric US
     C                     Z-ADD*ZERO     WN0032  20       MM   numeric US
     C                     Z-ADD*ZERO     WN0033  20       DD   numeric US
     C                     MOVEL*BLANK    WN0034  4        YYYY alpha   US
     C                     MOVEL*BLANK    WN0035  2        MM   alpha   US
     C                     MOVEL*BLANK    WN0036  2        DD   alpha   US
      *
      * Convert DTE to mm/dd/yyyy
      * Break apart date.
      * PAR.YYYY numeric USR = PAR.@Date - ATR *YEAR
     C           WAMNDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0031
      * PAR.MM   numeric USR = PAR.@Date - ATR *MONTH
     C           WAMNDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WN0032
      * PAR.DD   numeric USR = PAR.@Date - ATR *DAY OF MONTH
     C           WAMNDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WN0033
      * Convert to alpha.
     C                     MOVEL*BLANK    WN0034           YYYY alpha   US
     C                     MOVELWN0031    WN0034           YYYY alpha   US
     C                     MOVELWN0032    WN0035           MM   alpha   US
     C                     MOVELWN0033    WN0036           DD   alpha   US
      * Put back together.
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0035    CAT  '/':ZQ    WN0014    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0014    CAT  WN0036:ZQ WN0014    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0014    CAT  '/':ZQ    WN0014    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0014    CAT  WN0034:ZQ WN0014    P      Date mm/dd/yyyy
      * *-------------------------------------------------------*
      * * 10/26/01 PKD T960 Added Resale Amount and Net Loss to Download
      * RTV Calc Resale Total  RT - A/R Claim Resale Product  * 
     C                     EXSR SKRVGN
     C                     Z-ADDYL0002    WN0017           Claim Resale Am
     C                     Z-ADDWAAZVL    WN0018           Claim Net Loss
      * *-------------------------------------------------------*
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WABIC3' defaulted for 'Claim Company Number'.
      * CRT A/R Claim Download CR - A/R Claim Download Wrkf  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0003    WL0035           Claim Number (u
     C                     MOVELWN0016    WL0036    P      Claim Product/R
     C                     MOVELWN0005    WL0037    P      Claim Short Cus
     C                     MOVELWN0004    WL0038    P      Claim Reason Co
     C                     MOVELWN0002    WL0039    P      Claim Type
     C                     Z-ADDWN0006    WL0040           Claim Load ID (
     C                     Z-ADDWN0007    WL0041           Claim Invoice (
     C                     MOVELWN0008    WL0042    P      Claim Act Shp D
     C                     Z-ADDWABIC3    WL0043           Claim Company N
     C                     Z-ADDWN0009    WL0044           Claim Order # (
     C                     MOVELWN0010    WL0045    P      Claim Short Sal
     C                     MOVELWN0014    WL0046    P      Claim Entry Dat
     C                     MOVELWN0012    WL0047    P      Claim Departmen
     C                     MOVELWN0011    WL0048    P      Claim Short Exp
     C                     Z-ADDWN0013    WL0049           Claim Amount (u
     C                     Z-ADDWN0017    WL0050           Claim Resale Am
     C                     Z-ADDWN0018    WL0051           Claim Net Loss
     C                     MOVEL*BLANK    WL0052           Claim Over 10 D
     C                     MOVELWN0015    WL0053    P      Claim Reason Co
     C                     MOVELWACJSX    WL0054    P      Claim Status
     C                     MOVELWAPPTX    WL0055    P      Claim Called in
     C                     EXSR SLCRRC
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Get Order Info.
      *================================================================
      * RTV Claim Order Info   RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABIC3    WL0002           Company Number
     C                     Z-ADDWAALNX    WL0003           Order Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WUY4CD           Ship To Custome
     C                     MOVELWL0005    WUOSTX    P      Ship To Name
     C                     MOVELWL0006    WUOSTX    P      Customer Purcha
     C                     MOVELWL0007    WUOSTX    P      Carrier Code
     C                     MOVELWL0008    WUOSTX    P      Warehouse Code
     C                     Z-ADDWL0009    WUMTDT           Invoice Date
     C                     Z-ADDWL0010    WN0007           Invoice Number
     C                     MOVELWL0011    WUOSTX    P      Invoice Suffix
     C                     Z-ADDWL0012    WN0019           Actual Shipped
     C                     Z-ADDWL0013    WN0006           Load ID
     C                     MOVELWL0014    WUOSTX    P      Salesperson to
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Claim Order Info   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABIC3    WL0017           Company Number
     C                     Z-ADDWAALNX    WL0018           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0019    WUY4CD           Ship To Custome
     C                     MOVELWL0020    WUOSTX    P      Ship To Name
     C                     MOVELWL0021    WUOSTX    P      Customer Purcha
     C                     Z-ADDWL0022    WN0019           Actual Shipped
     C                     MOVELWL0023    WUOSTX    P      Carrier Code
     C                     Z-ADDWL0024    WN0006           Load ID
     C                     Z-ADDWL0025    WN0007           Invoice Number
     C                     MOVELWL0026    WUOSTX    P      Invoice Suffix
     C                     Z-ADDWL0027    WUMTDT           Invoice Date
     C                     MOVELWL0028    WUOSTX    P      Salesperson to
     C                     MOVELWL0029    WUOSTX    P      Warehouse Code
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0022  40       YYYY numeric US
     C                     Z-ADD*ZERO     WN0023  20       MM   numeric US
     C                     Z-ADD*ZERO     WN0024  20       DD   numeric US
     C                     MOVEL*BLANK    WN0025  4        YYYY alpha   US
     C                     MOVEL*BLANK    WN0026  2        MM   alpha   US
     C                     MOVEL*BLANK    WN0027  2        DD   alpha   US
      *
      * Convert DTE to mm/dd/yyyy
      * Break apart date.
      * PAR.YYYY numeric USR = PAR.@Date - ATR *YEAR
     C           WN0019    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0022
      * PAR.MM   numeric USR = PAR.@Date - ATR *MONTH
     C           WN0019    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WN0023
      * PAR.DD   numeric USR = PAR.@Date - ATR *DAY OF MONTH
     C           WN0019    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WN0024
      * Convert to alpha.
     C                     MOVEL*BLANK    WN0025           YYYY alpha   US
     C                     MOVELWN0022    WN0025           YYYY alpha   US
     C                     MOVELWN0023    WN0026           MM   alpha   US
     C                     MOVELWN0024    WN0027           DD   alpha   US
      * Put back together.
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0026    CAT  '/':ZQ    WN0008    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0008    CAT  WN0027:ZQ WN0008    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0008    CAT  '/':ZQ    WN0008    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0008    CAT  WN0025:ZQ WN0008    P      Date mm/dd/yyyy
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Load Short Explanation.
      *================================================================
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Claim Status is Denied
      *   |- c2    : DB1.Claim Status is Voided
      *   '-
     C           WACJSX    IFEQ 'D'                        *IF
     C           WACJSX    OREQ 'V'                        *OR
     C                     MOVEL*BLANK    WN0011           Claim Short Exp
     C                     MOVELWATBTX    WN0011           Claim Short Exp
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV First Expln Line RT - A/R Claim Explanation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAC0C7    WL0032           Claim Number
     C                     MOVELWN0011    WL0033    P      Claim Short Exp
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WN0011    P      Claim Short Exp
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WABIC3           Claim Company N
     C                     Z-ADD*ZERO     WAALNX           Claim Order Num
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAC3C7           Claim Ship to C
     C                     Z-ADD*ZERO     WAAYVL           Claim Amount
     C                     Z-ADD*ZERO     WAAZVL           Claim Net Loss
     C                     Z-ADD*ZERO     WAA0VL           Claim Approved
     C                     Z-ADD*ZERO     WAA1VL           Lab Fee
     C                     Z-ADD*ZERO     WAMLDT           Resolve Claim b
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAMMDT           Claim Called in
     C                     Z-ADD*ZERO     WAMNDT           Claim Entry Dat
     C                     Z-ADD*ZERO     WABGTM           Claim Entry Tim
     C                     Z-ADD*ZERO     WAC4C7           Resale Ship to
     C                     Z-ADD*ZERO     WANFDT           Sales Approved
     C                     Z-ADD*ZERO     WABJTM           Sales Approved
     C                     Z-ADD*ZERO     WAMODT           Approved/Denied
     C                     Z-ADD*ZERO     WABHTM           Approved/Denied
     C                     Z-ADD*ZERO     WAMPDT           Memo Created Da
     C                     Z-ADD*ZERO     WABITM           Memo Created Ti
     C                     Z-ADD*ZERO     WAEOVL           Approved Net Lo
     C                     Z-ADD*ZERO     WAEPVL           Total Expense A
     C                     Z-ADD*ZERO     WAP6DT           Memo Post Date
     C                     Z-ADD*ZERO     WACRTM           Memo Post Time
     C                     Z-ADD*ZERO     WAYSNX           TFS Batch Numbe
     C                     Z-ADD*ZERO     WAF7PC           Avg TF Responsi
     C                     Z-ADD*ZERO     WAF8PC           Avg SBF Respons
     C                     Z-ADD*ZERO     WAF9PC           Unused % field
     C                     Z-ADD*ZERO     WAEQVL           AC Unused Value
     C                     Z-ADD*ZERO     WAERVL           AC Unused Value
     C                     Z-ADD*ZERO     WAESVL           AC Unused Value
     C                     Z-ADD*ZERO     WAETVL           AC Unused Value
     C                     Z-ADD*ZERO     WAGAPC           AC Unused % 1
     C                     Z-ADD*ZERO     WAGBPC           AC Unused % 2
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01    50
     C                     Z-ADD1         Y       50
     C                     ENDIF
      *
      * Define work field Unused Parm - CD7     USR
     C                     Z-ADD*ZERO     WUY4CD  70
      * Define work field Unused Parm - Text    USR
     C                     MOVEL*BLANK    WUOSTX 25
      * Define work field Unused Parm - Date    USR
     C                     Z-ADD*ZERO     WUMTDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCBTC7           Parent Customer
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCORIT           Original Item
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WCESNB           Accounting Year
     C                     Z-ADD*ZERO     WCETNB           Accounting Peri
     C                     Z-ADD*ZERO     WCBZNB           OM Week
     C                     Z-ADD*ZERO     WCEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WCBYWG           Weight Billed
     C                     Z-ADD*ZERO     WCS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WCUTVA           Standard Overag
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WCR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WCSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WCSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WCONVA           Actual Freight
     C                     Z-ADD*ZERO     WCB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WCB5NB           PM Line Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WCUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WCUOVA           Commission Amou
     C                     Z-ADD*ZERO     WCUPVA           Financials Amou
     C                     Z-ADD*ZERO     WCUQVA           Financials Amou
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WCIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WCNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WCBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WCCDPR           Market Value
     C                     Z-ADD*ZERO     WCD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WCD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WCCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WCOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WCD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WCCFVL           HST Item Target
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A/R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Unused Date
     C                     Z-ADD*ZERO     WENPDT           OH Unused Date
     C                     Z-ADD*ZERO     WENQDT           OH Unused Date
     C                     Z-ADD*ZERO     WENRDT           OH Unused Date
     C                     Z-ADD*ZERO     WENSDT           OH Unused Date
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           Time of Origina
     C                     Z-ADD*ZERO     WEBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WEH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WEH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WEH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WEH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WEH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WFMAVA           Billing Detail
     C                     Z-ADD*ZERO     WFKDVA           Billing Detail
     C                     Z-ADD*ZERO     WFL8VA           Billing Detail
     C                     Z-ADD*ZERO     WFL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFEXDT           Market Pricing
     C                     Z-ADD*ZERO     WFBZPR           Price Overage O
     C                     Z-ADD*ZERO     WFL6NB           Contract Number
     C                     Z-ADD*ZERO     WFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WFCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WFATWG           Weight Shipped
     C                     Z-ADD*ZERO     WFAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAKPR           Unit Price
     C                     Z-ADD*ZERO     WFALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WFNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WFNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFBVTM           Price Code
     C                     Z-ADD*ZERO     WFBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WFBXTM           Substitution Li
     C                     Z-ADD*ZERO     WFBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WFH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WFH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WFH7NX           OD Item Target
     C                     Z-ADD*ZERO     WFH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WFH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WFDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WFDWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WFDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WFDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WFDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WFGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WFGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WFGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WFPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WFRINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WFTIDT           Production Ovr
     C                     Z-ADD*ZERO     WFTJDT           Production Ovr
     C                     Z-ADD*ZERO     WFTKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WFTLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WFTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHC0C7           Claim Number
     C                     Z-ADD*ZERO     WHAANX           Claim Explanati
     C                     Z-ADD*ZERO     WHLGNY           Claim Exp Usr S
     C                     Z-ADD*ZERO     WHRRDT           Claim Expl Note
     C                     Z-ADD*ZERO     WHRSDT           Claim Expl Acti
     C                     Z-ADD*ZERO     WHC9TM           Claim Expl Acti
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK02
      * Initialize last used element number
     C                     Z-ADD0         YL02    50
     C                     ENDIF
      *
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKC0C7           Claim Number
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKAKNX           Resale Item Lin
     C                     Z-ADD*ZERO     WKBHC3           Resale Company
     C                     Z-ADD*ZERO     WKC5C7           Resale Item Cod
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
     C                     Z-ADD*ZERO     WKKVQT           Resale Item Qua
     C                     Z-ADD*ZERO     WKHIWG           Resale Item Wei
     C                     Z-ADD*ZERO     WKDJPR           Resale Item Uni
     C                     Z-ADD*ZERO     WKBOVL           Resale Item Amo
     C                     Z-ADD*ZERO     WKMJDT           Create Date
     C                     Z-ADD*ZERO     WKBETM           Create Time
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLINNX           Claim Number (u
     C                     Z-ADD*ZERO     WLIONX           Claim Load ID (
     C                     Z-ADD*ZERO     WLIPNX           Claim Invoice (
     C                     Z-ADD*ZERO     WLBIC3           Claim Company N
     C                     Z-ADD*ZERO     WLIQNX           Claim Order # (
     C                     Z-ADD*ZERO     WLB8VL           Claim Amount (u
     C                     Z-ADD*ZERO     WLDQVL           Claim Resale Am
     C                     Z-ADD*ZERO     WLDRVL           Claim Net Loss
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WODBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WOBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WOBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WOBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WOBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001 11
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0002  30
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 15
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008  3
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  70
     C                     MOVEL*BLANK    WL0011  2
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014  3
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0015  3
     C                     MOVEL*BLANK    WL0016  3
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  70
     C                     MOVEL*BLANK    WL0020 30
     C                     MOVEL*BLANK    WL0021 15
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  3
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025  70
     C                     MOVEL*BLANK    WL0026  2
     C                     Z-ADD*ZERO     WL0027  70
     C                     MOVEL*BLANK    WL0028  3
     C                     MOVEL*BLANK    WL0029  3
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0030  3
     C                     MOVEL*BLANK    WL0031 30
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033110
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0034 20
      * Define local variables for subroutine SLCRRC.
     C                     Z-ADD*ZERO     WL0035  70
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037 20
     C                     MOVEL*BLANK    WL0038 11
     C                     MOVEL*BLANK    WL0039  2
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042 10
     C                     Z-ADD*ZERO     WL0043  30
     C                     Z-ADD*ZERO     WL0044  70
     C                     MOVEL*BLANK    WL0045 20
     C                     MOVEL*BLANK    WL0046 10
     C                     MOVEL*BLANK    WL0047 20
     C                     MOVEL*BLANK    WL0048110
     C                     Z-ADD*ZERO     WL0049 112
     C                     Z-ADD*ZERO     WL0050 112
     C                     Z-ADD*ZERO     WL0051 112
     C                     MOVEL*BLANK    WL0052  1
     C                     MOVEL*BLANK    WL0053  3
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055 25
      * Define local work field Salesperson Name
     C                     MOVEL*BLANK    YL0001 30
      * Define null work field Claim Responsibility
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0002  1
      * Define local work field Resale Total Item Amount
     C                     Z-ADD*ZERO     YL0002 112
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0003  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 ** Unknown **
