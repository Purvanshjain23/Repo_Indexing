/* CSTAR01 - ISASOPO - 06/25/2024 Converting ARBCREP from DDS to DDL*/
/*  CLP TO RUN THE A/R YEAR END PROGRAM TO CLEAR A/R SUMMARY FILE */
/*  */

             PGM        PARM(&COMP)
             DCL        VAR(&COMP) TYPE(*DEC)
             DCL        VAR(&COMPANY) TYPE(*DEC) LEN(3 0)
             CHGVAR     VAR(&COMPANY) VALUE(&COMP)
/*CSTAR01    CPYF       FROMFILE(ARBCREP) TOFILE(BKARBCREP)  +
                          MBROPT(*REPLACE) -- Backup the A/R +
                          Summary File */
/*CSTAR01    MONMSG     MSGID(CPF2817) EXEC(GOTO CMDLBL(RUN)) */
/*CSTAR01*/  DLTF       FILE(BKARBCREP)
/*CSTAR01*/  MONMSG     MSGID(CPF2105)
             RUNSQL     SQL('CREATE TABLE BKARBCREP AS (SELECT * +
                          FROM ARBCREP) WITH DATA') COMMIT(*NONE) +
                          /*CSTAR01*/
/*CSTAR01*/  MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(RUN))

             RUNQRY     QRY(ARSUMYREND)
  RUN:       CALL       PGM(PDINXFR) PARM(' ' &COMPANY)
             RUNQRY     QRY(ARSUMYREND)
  END:       ENDPGM
