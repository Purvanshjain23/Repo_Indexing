/********************************************************************/
/*  SYNOPSIS - THIS CALLS THE DAILY HOLDOVER REPORT FROM THE JOB    */
/*             SCHEDULER PER JEFF RUBY'S REQUEST                    */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PDKWUPC PRINT DAILY HOLDOVER FROM JOB SCHEDULER     */
/*  DATE      - 02/18/09                                            */
/*                                                                  */
/*  PARAMETERS RECEIVED: NONE                                       */
/*                                                                  */
/********************************************************************/
/* MODIFICATION:  COPIED FROM PDX9CLPJ    E2878  11/08/13           */
/* 12/31/13  LeAnne Ramsey (E2960)                                  */
/*           Jeff Ruby requested that we generate the #2 report     */
/*           instead of the #1 report from the Job Scheduler.       */
/*           So, I changed the hardcoded parm on the call to PDX9CLP*/
/* 05/05/2014 RMC E003072  PASS IN "TARGET DEILVERY DATE" FOR LJB   */
/* 03/26/2015 LJB E003914  PASS IN CARRIER CODE AS BLANK            */
/* 04/17/2015 LJB E004076  SEND Y/N AND EMAIL ADDRESS FIELDS        */
/*            ADDED. NOT USED HERE BUT NEEDED FOR THE CALL          */
/********************************************************************/
 PBKWUPC:   PGM

             DCL        VAR(&COMP) TYPE(*DEC) LEN(3) VALUE(360)
             DCL        &PDATE      *DEC
             DCL        &TDATE      *DEC
             DCL        &PDATE2     *DEC    7 0
             DCL        &TDATE2     *DEC    7 0
             DCL        &DAYS       *DEC    3 0
             DCL        &DAYS2      *DEC    8 0
             DCL        &DATE       *CHAR   7
             DCL        &JOBDTE     *CHAR   7
             DCL        &JOBDATE    *CHAR   6
             DCL        &CARRIER    *CHAR   3
             DCL        &SENDYN     *CHAR   1
             DCL        &EMAIL      *CHAR   50
             DCL        &EMAIL1     *CHAR   25
             DCL        &EMAIL2     *CHAR   25

             RTVJOBA    DATE(&JOBDATE)
             CVTDAT     DATE(&JOBDATE) TOVAR(&JOBDTE) FROMFMT(*MDY) +
                          TOFMT(*CYMD) TOSEP(*NONE)
             CHGVAR     VAR(&DATE) VALUE(&JOBDTE)
             MONMSG     MSGID(CPF0000)

             CHGVAR     VAR(&TDATE) VALUE(&DATE)
             CHGVAR     VAR(&DAYS) VALUE(1)
             CHGVAR     VAR(&TDATE2) VALUE(&TDATE)

             CALL       PGM(POE7XFR) PARM(' ' &COMP &TDATE2 &DAYS +
                          &PDATE2)
             CHGVAR     VAR(&DAYS2) VALUE(3)

             CALL       PGM(PDNKXFR) PARM(' ' &TDATE2 &COMP &PDATE2 +
                          &DAYS2)
/*------------------------------------------------------------------*/
/* DAILY HOLDOVER FOR PREVIOUS DAY WITH REPORT TYPE = 2             */
/*------------------------------------------------------------------*/
             CHGVAR     VAR(&PDATE) VALUE(&PDATE2)

             CALL       PGM(PDX9CLP) PARM(360.00000 &PDATE 0.00000 +
                          '2' 0.00000 0.00000 'QPRINT2' '*NO' '*NO' +
                          1.00000 '*JOBD' 'GP1' 'CF1' ' ' ' ' ' ' ' +
                          ' ' ' ' ' ' ' ' ' 'S' 0.00000 &CARRIER +
                          &SENDYN &EMAIL1 &EMAIL2)

             ESEND/ESNDMAIL RECIPIENT('prk hold over 360 RUBY') +
                          SUBJECT('360 Hold Over Report') +
                          ATTLIST((* *DFT *N PDX9PFR$))
             MONMSG     MSGID(CPF0000)

CLOF:        CLOF       OPNID(OMFJCPLF)
             MONMSG     MSGID(CPF0000)

 END:        ENDPGM
