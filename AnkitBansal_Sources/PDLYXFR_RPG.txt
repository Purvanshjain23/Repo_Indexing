     H/TITLE UPD Backin Spec'l Adj  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 09/27/24  Time  : 12:50:22
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAB7CPLMIF  E           K        DISK
      * RSQ : Item Transaction Detail   Co/TrnsDt/Whs Slct PhyAd
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCAB7CPLLIF  E           K        DISK
      * RSQ : Item Transaction Detail   Co/Itm/Whs/PrdDte/JobSt
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPUC6REL1IF  E           K        DISK
      * RTV : OMS Transformation Ctl    Retrieval index
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FCAB0REL0UF  E           K        DISK
      * UPD : Item Balance              Update index
      *
      * Long constants
     E                    @CN#    1  13  6   @CN    25
     I@B7CPJC
      * Item Transaction Detail   Co/TrnsDt/Whs Slct PhyAd
      * Renamed input format fields
     I              B7AIC3                          WAAIC3
     I              B7HGCD                          WAHGCD
     I              B7AJCD                          WAAJCD
     I              B7W9ST                          WAW9ST
     I              B7BSST                          WABSST
     I              B7B4DT                          WAB4DT
     I              B7C4NY                          WAC4NY
     I              B7DXNB                          WADXNB
     I              B7ELDT                          WAELDT
     I              B7HVCD                          WAHVCD
     I              B7F1ST                          WAF1ST
     I              B7AUNA                          WAAUNA
     I              B7A5QT                          WAA5QT
     I              B7AHWG                          WAAHWG
     I              B7AKCS                          WAAKCS
     I              B7CGCD                          WACGCD
     I              B7AYVA                          WAAYVA
     I              B7BJNA                          WABJNA
     I              B7CKNB                          WACKNB
     I              B7BMST                          WABMST
     I              B7CQCD                          WACQCD
     I              B7DTCD                          WADTCD
     I              B7MGNA                          WAMGNA
     I              B7TRBN                          WATRBN
     I              B7TRBS                          WATRBS
     I              B7C4NB                          WAC4NB
     I              B7RINB                          WARINB
     I              B7RHNB                          WARHNB
     I              B7RGNB                          WARGNB
     I              B7M3NA                          WAM3NA
     I              B7AWTM                          WAAWTM
     I              B7XLCD                          WAXLCD
     I              B7K7DT                          WAK7DT
     I              B7UVST                          WAUVST
     I              B7UWST                          WAUWST
     I              B7UXST                          WAUXST
     I              B7VSST                          WAVSST
     I              B7AATM                          WAAATM
     I              B7AYNA                          WAAYNA
     I              B7A0NA                          WAA0NA
     I              B7AXDT                          WAAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WBAIC3
     I              B0HGCD                          WBHGCD
     I              B0AJCD                          WBAJCD
     I              B0AGCS                          WBAGCS
     I              B0AECS                          WBAECS
     I              B0BACS                          WBBACS
     I              B0BBCS                          WBBBCS
     I              B0CBPR                          WBCBPR
     I              B0GUDT                          WBGUDT
     I              B0XYST                          WBXYST
     I              B0CTPR                          WBCTPR
     I              B0G4DT                          WBG4DT
     I              B0BOWG                          WBBOWG
     I              B0DDQT                          WBDDQT
     I              B0DEQT                          WBDEQT
     I              B0DFQT                          WBDFQT
     I              B0HDQT                          WBHDQT
     I              B0HEQT                          WBHEQT
     I              B0AJQT                          WBAJQT
     I              B0AQQT                          WBAQQT
     I              B0AUQT                          WBAUQT
     I              B0EMQT                          WBEMQT
     I              B0DOQT                          WBDOQT
     I              B0ATNA                          WBATNA
     I              B0AKDT                          WBAKDT
     I              B0ANDT                          WBANDT
     I              B0IDVA                          WBIDVA
     I              B0JVST                          WBJVST
     I              B0BZPC                          WBBZPC
     I              B0DGQT                          WBDGQT
     I              B0DIDT                          WBDIDT
     I              B0ALCD                          WBALCD
     I              B0BFDY                          WBBFDY
     I              B0DJDT                          WBDJDT
     I              B0BGDY                          WBBGDY
     I              B0DKDT                          WBDKDT
     I              B0J2ST                          WBJ2ST
     I              B0DJQT                          WBDJQT
     I              B0BNWG                          WBBNWG
     I              B0DLDT                          WBDLDT
     I              B0DPQT                          WBDPQT
     I              B0DQQT                          WBDQQT
     I              B0DMDT                          WBDMDT
     I              B0M0ST                          WBM0ST
     I              B0J9ST                          WBJ9ST
     I              B0KBST                          WBKBST
     I              B0AKC8                          WBAKC8
     I              B0RINB                          WBRINB
     I              B0RHNB                          WBRHNB
     I              B0RGNB                          WBRGNB
     I              B0UVST                          WBUVST
     I              B0UWST                          WBUWST
     I              B0UXST                          WBUXST
     I              B0VSST                          WBVSST
     I              B0AATM                          WBAATM
     I              B0AYNA                          WBAYNA
     I              B0A0NA                          WBA0NA
     I              B0AXDT                          WBAXDT
      *
     I@B7CPI8
      * Item Transaction Detail   Co/Itm/Whs/PrdDte/JobSt
      * Renamed input format fields
     I              B7AIC3                          WCAIC3
     I              B7HGCD                          WCHGCD
     I              B7AJCD                          WCAJCD
     I              B7W9ST                          WCW9ST
     I              B7BSST                          WCBSST
     I              B7B4DT                          WCB4DT
     I              B7C4NY                          WCC4NY
     I              B7DXNB                          WCDXNB
     I              B7ELDT                          WCELDT
     I              B7HVCD                          WCHVCD
     I              B7F1ST                          WCF1ST
     I              B7AUNA                          WCAUNA
     I              B7A5QT                          WCA5QT
     I              B7AHWG                          WCAHWG
     I              B7AKCS                          WCAKCS
     I              B7CGCD                          WCCGCD
     I              B7AYVA                          WCAYVA
     I              B7BJNA                          WCBJNA
     I              B7CKNB                          WCCKNB
     I              B7BMST                          WCBMST
     I              B7CQCD                          WCCQCD
     I              B7DTCD                          WCDTCD
     I              B7MGNA                          WCMGNA
     I              B7TRBN                          WCTRBN
     I              B7TRBS                          WCTRBS
     I              B7C4NB                          WCC4NB
     I              B7RINB                          WCRINB
     I              B7RHNB                          WCRHNB
     I              B7RGNB                          WCRGNB
     I              B7M3NA                          WCM3NA
     I              B7AWTM                          WCAWTM
     I              B7XLCD                          WCXLCD
     I              B7K7DT                          WCK7DT
     I              B7UVST                          WCUVST
     I              B7UWST                          WCUWST
     I              B7UXST                          WCUXST
     I              B7VSST                          WCVSST
     I              B7AATM                          WCAATM
     I              B7AYNA                          WCAYNA
     I              B7A0NA                          WCA0NA
     I              B7AXDT                          WCAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WDAIC3
     I              BZHGCD                          WDHGCD
     I              BZAVNA                          WDAVNA
     I              BZAWNA                          WDAWNA
     I              BZL7NA                          WDL7NA
     I              BZL8NA                          WDL8NA
     I              BZL6NA                          WDL6NA
     I              BZMFNA                          WDMFNA
     I              BZADCD                          WDADCD
     I              BZAWPC                          WDAWPC
     I              BZLXST                          WDLXST
     I              BZAECD                          WDAECD
     I              BZAXPC                          WDAXPC
     I              BZLYST                          WDLYST
     I              BZAFCD                          WDAFCD
     I              BZAICD                          WDAICD
     I              BZAIWG                          WDAIWG
     I              BZHICD                          WDHICD
     I              BZRBCD                          WDRBCD
     I              BZFZST                          WDFZST
     I              BZAVST                          WDAVST
     I              BZCZWG                          WDCZWG
     I              BZC0WG                          WDC0WG
     I              BZURTN                          WDURTN
     I              BZAJC8                          WDAJC8
     I              BZRINB                          WDRINB
     I              BZRHNB                          WDRHNB
     I              BZRGNB                          WDRGNB
     I              BZLNCD                          WDLNCD
     I              BZTFNB                          WDTFNB
     I              BZN0CD                          WDN0CD
     I              BZX4ST                          WDX4ST
     I              BZTMVA                          WDTMVA
     I              BZTNVA                          WDTNVA
     I              BZBLPR                          WDBLPR
     I              BZBMPR                          WDBMPR
     I              BZLRCD                          WDLRCD
     I              BZU9ST                          WDU9ST
     I              BZCMCO                          WDCMCO
     I              BZQ1CD                          WDQ1CD
     I              BZQ8CD                          WDQ8CD
     I              BZCHTM                          WDCHTM
     I              BZQZCD                          WDQZCD
     I              BZXWST                          WDXWST
     I              BZXXST                          WDXXST
     I              BZVMST                          WDVMST
     I              BZSWGH                          WDSWGH
     I              BZPPHE                          WDPPHE
     I              BZR3CD                          WDR3CD
     I              BZSDCD                          WDSDCD
     I              BZICN1                          WDICN1
     I              BZSVCD                          WDSVCD
     I              BZICN2                          WDICN2
     I              BZSWCD                          WDSWCD
     I              BZV2NB                          WDV2NB
     I              BZSXCD                          WDSXCD
     I              BZITCN                          WDITCN
     I              BZSYCD                          WDSYCD
     I              BZITC5                          WDITC5
     I              BZSZCD                          WDSZCD
     I              BZICN6                          WDICN6
     I              BZS0CD                          WDS0CD
     I              BZICN7                          WDICN7
     I              BZS1CD                          WDS1CD
     I              BZICN8                          WDICN8
     I              BZS2CD                          WDS2CD
     I              BZICN9                          WDICN9
     I              BZS3CD                          WDS3CD
     I              BZICN0                          WDICN0
     I              BZS4CD                          WDS4CD
     I              BZSFNB                          WDSFNB
     I              BZA3WG                          WDA3WG
     I              BZSJNB                          WDSJNB
     I              BZLLCD                          WDLLCD
     I              BZLMCD                          WDLMCD
     I              BZP3ST                          WDP3ST
     I              BZSKNB                          WDSKNB
     I              BZSLNB                          WDSLNB
     I              BZSMNB                          WDSMNB
     I              BZP4ST                          WDP4ST
     I              BZCFNB                          WDCFNB
     I              BZCGNB                          WDCGNB
     I              BZILNB                          WDILNB
     I              BZCHNB                          WDCHNB
     I              BZCINB                          WDCINB
     I              BZCJNB                          WDCJNB
     I              BZCMNB                          WDCMNB
     I              BZCNNB                          WDCNNB
     I              BZCRNB                          WDCRNB
     I              BZCSNB                          WDCSNB
     I              BZCVNB                          WDCVNB
     I              BZCWNB                          WDCWNB
     I              BZCXNB                          WDCXNB
     I              BZCZNB                          WDCZNB
     I              BZC0NB                          WDC0NB
     I              BZN1CD                          WDN1CD
     I              BZB4NB                          WDB4NB
     I              BZB5NB                          WDB5NB
     I              BZX5ST                          WDX5ST
     I              BZX6ST                          WDX6ST
     I              BZX7ST                          WDX7ST
     I              BZPCCT                          WDPCCT
     I              BZBDNB                          WDBDNB
     I              BZBJNB                          WDBJNB
     I              BZSUST                          WDSUST
     I              BZSVST                          WDSVST
     I              BZSYST                          WDSYST
     I              BZSZST                          WDSZST
     I              BZS1ST                          WDS1ST
     I              BZXRCD                          WDXRCD
     I              BZXTCD                          WDXTCD
     I              BZXUCD                          WDXUCD
     I              BZF5WG                          WDF5WG
     I              BZF6WG                          WDF6WG
     I              BZF7WG                          WDF7WG
     I              BZBLNB                          WDBLNB
     I              BZBNNB                          WDBNNB
     I              BZS2ST                          WDS2ST
     I              BZS4ST                          WDS4ST
     I              BZS5ST                          WDS5ST
     I              BZS6ST                          WDS6ST
     I              BZS8ST                          WDS8ST
     I              BZS9ST                          WDS9ST
     I              BZTCST                          WDTCST
     I              BZTDST                          WDTDST
     I              BZUVST                          WDUVST
     I              BZUWST                          WDUWST
     I              BZUXST                          WDUXST
     I              BZVSST                          WDVSST
     I              BZAATM                          WDAATM
     I              BZAYNA                          WDAYNA
     I              BZA0NA                          WDA0NA
     I              BZAXDT                          WDAXDT
      *
     I@C6REMK
      * OMS Transformation Ctl    Retrieval index
      * Renamed input format fields
     I              C6B3AB                          WEB3AB
     I              C6HUNZ                          WEHUNZ
     I              C6OCSC                          WEOCSC
     I              C6UNU1                          WEUNU1
     I              C6VSST                          WEVSST
     I              C6BGTS                          WEBGTS
     I              C6RUU1                          WERUU1
     I              C6RVU1                          WERVU1
     I              C6BHTS                          WEBHTS
     I              C6RWU1                          WERWU1
     I              C6RXU1                          WERXU1
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WFAIC3
     I              B7HGCD                          WFHGCD
     I              B7AJCD                          WFAJCD
     I              B7W9ST                          WFW9ST
     I              B7BSST                          WFBSST
     I              B7B4DT                          WFB4DT
     I              B7C4NY                          WFC4NY
     I              B7DXNB                          WFDXNB
     I              B7ELDT                          WFELDT
     I              B7HVCD                          WFHVCD
     I              B7F1ST                          WFF1ST
     I              B7AUNA                          WFAUNA
     I              B7A5QT                          WFA5QT
     I              B7AHWG                          WFAHWG
     I              B7AKCS                          WFAKCS
     I              B7CGCD                          WFCGCD
     I              B7AYVA                          WFAYVA
     I              B7BJNA                          WFBJNA
     I              B7CKNB                          WFCKNB
     I              B7BMST                          WFBMST
     I              B7CQCD                          WFCQCD
     I              B7DTCD                          WFDTCD
     I              B7MGNA                          WFMGNA
     I              B7TRBN                          WFTRBN
     I              B7TRBS                          WFTRBS
     I              B7C4NB                          WFC4NB
     I              B7RINB                          WFRINB
     I              B7RHNB                          WFRHNB
     I              B7RGNB                          WFRGNB
     I              B7M3NA                          WFM3NA
     I              B7AWTM                          WFAWTM
     I              B7XLCD                          WFXLCD
     I              B7K7DT                          WFK7DT
     I              B7UVST                          WFUVST
     I              B7UWST                          WFUWST
     I              B7UXST                          WFUXST
     I              B7VSST                          WFVSST
     I              B7AATM                          WFAATM
     I              B7AYNA                          WFAYNA
     I              B7A0NA                          WFA0NA
     I              B7AXDT                          WFAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WGAIC3
     I              B7HGCD                          WGHGCD
     I              B7AJCD                          WGAJCD
     I              B7W9ST                          WGW9ST
     I              B7BSST                          WGBSST
     I              B7B4DT                          WGB4DT
     I              B7C4NY                          WGC4NY
     I              B7DXNB                          WGDXNB
     I              B7ELDT                          WGELDT
     I              B7HVCD                          WGHVCD
     I              B7F1ST                          WGF1ST
     I              B7AUNA                          WGAUNA
     I              B7A5QT                          WGA5QT
     I              B7AHWG                          WGAHWG
     I              B7AKCS                          WGAKCS
     I              B7CGCD                          WGCGCD
     I              B7AYVA                          WGAYVA
     I              B7BJNA                          WGBJNA
     I              B7CKNB                          WGCKNB
     I              B7BMST                          WGBMST
     I              B7CQCD                          WGCQCD
     I              B7DTCD                          WGDTCD
     I              B7MGNA                          WGMGNA
     I              B7TRBN                          WGTRBN
     I              B7TRBS                          WGTRBS
     I              B7C4NB                          WGC4NB
     I              B7RINB                          WGRINB
     I              B7RHNB                          WGRHNB
     I              B7RGNB                          WGRGNB
     I              B7M3NA                          WGM3NA
     I              B7AWTM                          WGAWTM
     I              B7XLCD                          WGXLCD
     I              B7K7DT                          WGK7DT
     I              B7UVST                          WGUVST
     I              B7UWST                          WGUWST
     I              B7UXST                          WGUXST
     I              B7VSST                          WGVSST
     I              B7AATM                          WGAATM
     I              B7AYNA                          WGAYNA
     I              B7A0NA                          WGA0NA
     I              B7AXDT                          WGAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WJAIC3
     I              B1HGCD                          WJHGCD
     I              B1AJCD                          WJAJCD
     I              B1ELDT                          WJELDT
     I              B1ABWG                          WJABWG
     I              B1AGQT                          WJAGQT
     I              B1AHQT                          WJAHQT
     I              B1AIQT                          WJAIQT
     I              B1CTST                          WJCTST
     I              B1ACWG                          WJACWG
     I              B1ARQT                          WJARQT
     I              B1ASQT                          WJASQT
     I              B1ATQT                          WJATQT
     I              B1HDQT                          WJHDQT
     I              B1HEQT                          WJHEQT
     I              B1F6ST                          WJF6ST
     I              B1BMWG                          WJBMWG
     I              B1DSQT                          WJDSQT
     I              B1DTQT                          WJDTQT
     I              B1DUQT                          WJDUQT
     I              B1DHDT                          WJDHDT
     I              B1AGCS                          WJAGCS
     I              B1AECS                          WJAECS
     I              B1IDVA                          WJIDVA
     I              B1K7DT                          WJK7DT
     I              B1RINB                          WJRINB
     I              B1RHNB                          WJRHNB
     I              B1RGNB                          WJRGNB
     I              B1UVST                          WJUVST
     I              B1UWST                          WJUWST
     I              B1UXST                          WJUXST
     I              B1VSST                          WJVSST
     I              B1AATM                          WJAATM
     I              B1AYNA                          WJAYNA
     I              B1A0NA                          WJA0NA
     I              B1AXDT                          WJAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WKAIC3
     I              B0HGCD                          WKHGCD
     I              B0AJCD                          WKAJCD
     I              B0AGCS                          WKAGCS
     I              B0AECS                          WKAECS
     I              B0BACS                          WKBACS
     I              B0BBCS                          WKBBCS
     I              B0CBPR                          WKCBPR
     I              B0GUDT                          WKGUDT
     I              B0XYST                          WKXYST
     I              B0CTPR                          WKCTPR
     I              B0G4DT                          WKG4DT
     I              B0BOWG                          WKBOWG
     I              B0DDQT                          WKDDQT
     I              B0DEQT                          WKDEQT
     I              B0DFQT                          WKDFQT
     I              B0HDQT                          WKHDQT
     I              B0HEQT                          WKHEQT
     I              B0AJQT                          WKAJQT
     I              B0AQQT                          WKAQQT
     I              B0AUQT                          WKAUQT
     I              B0EMQT                          WKEMQT
     I              B0DOQT                          WKDOQT
     I              B0ATNA                          WKATNA
     I              B0AKDT                          WKAKDT
     I              B0ANDT                          WKANDT
     I              B0IDVA                          WKIDVA
     I              B0JVST                          WKJVST
     I              B0BZPC                          WKBZPC
     I              B0DGQT                          WKDGQT
     I              B0DIDT                          WKDIDT
     I              B0ALCD                          WKALCD
     I              B0BFDY                          WKBFDY
     I              B0DJDT                          WKDJDT
     I              B0BGDY                          WKBGDY
     I              B0DKDT                          WKDKDT
     I              B0J2ST                          WKJ2ST
     I              B0DJQT                          WKDJQT
     I              B0BNWG                          WKBNWG
     I              B0DLDT                          WKDLDT
     I              B0DPQT                          WKDPQT
     I              B0DQQT                          WKDQQT
     I              B0DMDT                          WKDMDT
     I              B0M0ST                          WKM0ST
     I              B0J9ST                          WKJ9ST
     I              B0KBST                          WKKBST
     I              B0AKC8                          WKAKC8
     I              B0RINB                          WKRINB
     I              B0RHNB                          WKRHNB
     I              B0RGNB                          WKRGNB
     I              B0UVST                          WKUVST
     I              B0UWST                          WKUWST
     I              B0UXST                          WKUXST
     I              B0VSST                          WKVSST
     I              B0AATM                          WKAATM
     I              B0AYNA                          WKAYNA
     I              B0A0NA                          WKA0NA
     I              B0AXDT                          WKAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WLAJCD
     I              L2YMCD                          WLYMCD
     I              L2YPCD                          WLYPCD
     I              L2LCBY                          WLLCBY
     I              L2LCCT                          WLLCCT
     I              L2WLUS                          WLWLUS
     I              L2WUSD                          WLWUSD
     I              L2WLUN                          WLWLUN
     I              L2AGSX                          WLAGSX
     I              L2UVST                          WLUVST
     I              L2UWST                          WLUWST
     I              L2UXST                          WLUXST
     I              L2VSST                          WLVSST
     I              L2AATM                          WLAATM
     I              L2AYNA                          WLAYNA
     I              L2A0NA                          WLA0NA
     I              L2AXDT                          WLAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WMAIC3
     I              BEC4NB                          WMC4NB
     I              BEJNCD                          WMJNCD
     I              BEANC7                          WMANC7
     I              BEBKC7                          WMBKC7
     I              BEBRTX                          WMBRTX
     I              BEHMNA                          WMHMNA
     I              BEHONA                          WMHONA
     I              BEHPNA                          WMHPNA
     I              BEHNNA                          WMHNNA
     I              BEDBCD                          WMDBCD
     I              BECKTX                          WMCKTX
     I              BEB0C7                          WMB0C7
     I              BEAETX                          WMAETX
     I              BEB1NA                          WMB1NA
     I              BEB3NA                          WMB3NA
     I              BEB4NA                          WMB4NA
     I              BEB2NA                          WMB2NA
     I              BEBHCD                          WMBHCD
     I              BEC8TX                          WMC8TX
     I              BEBCNA                          WMBCNA
     I              BEA0DT                          WMA0DT
     I              BEA5DT                          WMA5DT
     I              BEGNDT                          WMGNDT
     I              BEACDT                          WMACDT
     I              BEAQCD                          WMAQCD
     I              BEB6NA                          WMB6NA
     I              BEBYNA                          WMBYNA
     I              BEBZNA                          WMBZNA
     I              BEGTST                          WMGTST
     I              BEGVST                          WMGVST
     I              BEGUST                          WMGUST
     I              BEQFST                          WMQFST
     I              BECQCD                          WMCQCD
     I              BEGJST                          WMGJST
     I              BEGWST                          WMGWST
     I              BEGXST                          WMGXST
     I              BEGYST                          WMGYST
     I              BEAODT                          WMAODT
     I              BEAIVN                          WMAIVN
     I              BECXDT                          WMCXDT
     I              BEJZVA                          WMJZVA
     I              BEA1WG                          WMA1WG
     I              BEXIST                          WMXIST
     I              BEXJST                          WMXJST
     I              BEXKST                          WMXKST
     I              BEEIDT                          WMEIDT
     I              BEAFTM                          WMAFTM
     I              BEE8CD                          WME8CD
     I              BEE9CD                          WME9CD
     I              BERMNB                          WMRMNB
     I              BETBNB                          WMTBNB
     I              BER1NB                          WMR1NB
     I              BEPJST                          WMPJST
     I              BEU0ST                          WMU0ST
     I              BEU1ST                          WMU1ST
     I              BEQ2CD                          WMQ2CD
     I              BEU2ST                          WMU2ST
     I              BEVEST                          WMVEST
     I              BEVFST                          WMVFST
     I              BEVGST                          WMVGST
     I              BERPCD                          WMRPCD
     I              BERNNB                          WMRNNB
     I              BEVDST                          WMVDST
     I              BEATIN                          WMATIN
     I              BEU4ST                          WMU4ST
     I              BEU5ST                          WMU5ST
     I              BERSRN                          WMRSRN
     I              BEMHNA                          WMMHNA
     I              BEMINA                          WMMINA
     I              BEWBST                          WMWBST
     I              BER4CD                          WMR4CD
     I              BEBFCD                          WMBFCD
     I              BEQ4CD                          WMQ4CD
     I              BET3NB                          WMT3NB
     I              BESICD                          WMSICD
     I              BECONB                          WMCONB
     I              BECEST                          WMCEST
     I              BEAWDT                          WMAWDT
     I              BEJPCD                          WMJPCD
     I              BEXUST                          WMXUST
     I              BEZ1ST                          WMZ1ST
     I              BEVRVA                          WMVRVA
     I              BEOBST                          WMOBST
     I              BEBCST                          WMBCST
     I              BEBDST                          WMBDST
     I              BEB7VL                          WMB7VL
     I              BEGASX                          WMGASX
     I              BEGBSX                          WMGBSX
     I              BEGCSX                          WMGCSX
     I              BEGDSX                          WMGDSX
     I              BEFNSX                          WMFNSX
     I              BEFOSX                          WMFOSX
     I              BEFPSX                          WMFPSX
     I              BEFQSX                          WMFQSX
     I              BEFRSX                          WMFRSX
     I              BEFSSX                          WMFSSX
     I              BEFTSX                          WMFTSX
     I              BEFUSX                          WMFUSX
     I              BEFVSX                          WMFVSX
     I              BEFWSX                          WMFWSX
     I              BEFXSX                          WMFXSX
     I              BEFYSX                          WMFYSX
     I              BENODT                          WMNODT
     I              BENPDT                          WMNPDT
     I              BENQDT                          WMNQDT
     I              BENRDT                          WMNRDT
     I              BENSDT                          WMNSDT
     I              BEBPTM                          WMBPTM
     I              BEBQTM                          WMBQTM
     I              BEBRTM                          WMBRTM
     I              BEBSTM                          WMBSTM
     I              BEBTTM                          WMBTTM
     I              BEH0NX                          WMH0NX
     I              BEH1NX                          WMH1NX
     I              BEH2NX                          WMH2NX
     I              BEH3NX                          WMH3NX
     I              BEH4NX                          WMH4NX
     I              BEC0C7                          WMC0C7
     I              BEUVST                          WMUVST
     I              BEUWST                          WMUWST
     I              BEUXST                          WMUXST
     I              BEAATM                          WMAATM
     I              BEAYNA                          WMAYNA
     I              BEA0NA                          WMA0NA
     I              BEAXDT                          WMAXDT
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                          WODOCD
     I              DPAUNA                          WOAUNA
     I              DPI5ST                          WOI5ST
     I              DPBXTX                          WOBXTX
     I              DPM8NB                          WOM8NB
     I              DPUVST                          WOUVST
     I              DPUWST                          WOUWST
     I              DPUXST                          WOUXST
     I              DPVSST                          WOVSST
     I              DPAATM                          WOAATM
     I              DPAYNA                          WOAYNA
     I              DPA0NA                          WOA0NA
     I              DPAXDT                          WOAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WGAIC3
     I              B7HGCD                          WGHGCD
     I              B7AJCD                          WGAJCD
     I              B7W9ST                          WGW9ST
     I              B7BSST                          WGBSST
     I              B7B4DT                          WGB4DT
     I              B7C4NY                          WGC4NY
     I              B7DXNB                          WGDXNB
     I              B7ELDT                          WGELDT
     I              B7HVCD                          WGHVCD
     I              B7F1ST                          WGF1ST
     I              B7AUNA                          WGAUNA
     I              B7A5QT                          WGA5QT
     I              B7AHWG                          WGAHWG
     I              B7AKCS                          WGAKCS
     I              B7CGCD                          WGCGCD
     I              B7AYVA                          WGAYVA
     I              B7BJNA                          WGBJNA
     I              B7CKNB                          WGCKNB
     I              B7BMST                          WGBMST
     I              B7CQCD                          WGCQCD
     I              B7DTCD                          WGDTCD
     I              B7MGNA                          WGMGNA
     I              B7TRBN                          WGTRBN
     I              B7TRBS                          WGTRBS
     I              B7C4NB                          WGC4NB
     I              B7RINB                          WGRINB
     I              B7RHNB                          WGRHNB
     I              B7RGNB                          WGRGNB
     I              B7M3NA                          WGM3NA
     I              B7AWTM                          WGAWTM
     I              B7XLCD                          WGXLCD
     I              B7K7DT                          WGK7DT
     I              B7UVST                          WGUVST
     I              B7UWST                          WGUWST
     I              B7UXST                          WGUXST
     I              B7VSST                          WGVSST
     I              B7AATM                          WGAATM
     I              B7AYNA                          WGAYNA
     I              B7A0NA                          WGA0NA
     I              B7AXDT                          WGAXDT
      *
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     IYARDCS      DS                            163
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WKAIC3
     I              B0HGCD                          WKHGCD
     I              B0AJCD                          WKAJCD
     I              B0AGCS                          WKAGCS
     I              B0AECS                          WKAECS
     I              B0BACS                          WKBACS
     I              B0BBCS                          WKBBCS
     I              B0CBPR                          WKCBPR
     I              B0GUDT                          WKGUDT
     I              B0XYST                          WKXYST
     I              B0CTPR                          WKCTPR
     I              B0G4DT                          WKG4DT
     I              B0BOWG                          WKBOWG
     I              B0DDQT                          WKDDQT
     I              B0DEQT                          WKDEQT
     I              B0DFQT                          WKDFQT
     I              B0HDQT                          WKHDQT
     I              B0HEQT                          WKHEQT
     I              B0AJQT                          WKAJQT
     I              B0AQQT                          WKAQQT
     I              B0AUQT                          WKAUQT
     I              B0EMQT                          WKEMQT
     I              B0DOQT                          WKDOQT
     I              B0ATNA                          WKATNA
     I              B0AKDT                          WKAKDT
     I              B0ANDT                          WKANDT
     I              B0IDVA                          WKIDVA
     I              B0JVST                          WKJVST
     I              B0BZPC                          WKBZPC
     I              B0DGQT                          WKDGQT
     I              B0DIDT                          WKDIDT
     I              B0ALCD                          WKALCD
     I              B0BFDY                          WKBFDY
     I              B0DJDT                          WKDJDT
     I              B0BGDY                          WKBGDY
     I              B0DKDT                          WKDKDT
     I              B0J2ST                          WKJ2ST
     I              B0DJQT                          WKDJQT
     I              B0BNWG                          WKBNWG
     I              B0DLDT                          WKDLDT
     I              B0DPQT                          WKDPQT
     I              B0DQQT                          WKDQQT
     I              B0DMDT                          WKDMDT
     I              B0M0ST                          WKM0ST
     I              B0J9ST                          WKJ9ST
     I              B0KBST                          WKKBST
     I              B0AKC8                          WKAKC8
     I              B0RINB                          WKRINB
     I              B0RHNB                          WKRHNB
     I              B0RGNB                          WKRGNB
     I              B0UVST                          WKUVST
     I              B0UWST                          WKUWST
     I              B0UXST                          WKUXST
     I              B0VSST                          WKVSST
     I              B0AATM                          WKAATM
     I              B0AYNA                          WKAYNA
     I              B0A0NA                          WKA0NA
     I              B0AXDT                          WKAXDT
      *
     IYBRDCS      DS                            245
      * Outward parameters
     IPARC        DS                            157
      * RCD : PAR API WIM Inv Shipping2
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Item Code
     I                                    P   3   60PAHGCD
      * I :  Ship From Warehouse
     I                                        7   9 PAVPCD
      * I :  WIM Inventory Trans ID
     I                                       10  12 PANOSC
      * I :  WIM Inventory Trans Type
     I                                       13  15 PANPSC
      * I :  Transaction Date
     I                                    P  16  190PAA9DT
      * I :  Production Date
     I                                    P  20  230PAELDT
      * I :  Item Transaction Source
     I                                       24  25 PAF1ST
      * I :  Transaction Description
     I                                       26  55 PAVQNA
      * I :  Transaction Reason Code
     I                                       56  58 PAA1AB
      * I :  Order Number
     I                                    P  59  620PAC4NB
      * I :  Shift Number
     I                                       63  63 PAXLCD
      * I :  Ship To Warehouse
     I                                       64  66 PAL9AA
      * I :  Transaction Weight
     I                                    P  67  722PAAHWG
      * I :  Transaction Quantity
     I                                    P  73  782PAA5QT
      * I :  USR Unship Flag
     I                                       79  79 PAUSST
      * I :  Inter-Plant Transfer USR
     I                                       80  80 PAA5TX
      * O :  API EccResult-MsgId U
     I                                       81  87 PACLAB
      * O :  API EccResult-MsgDesc U
     I                                       88 137 PAVGU1
      * B :  API Request Key U
     I                                      138 147 PACKAB
      * I :  API Mode U
     I                                      148 157 PACJAB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Transaction Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Warehouse Code
     I                                        3   5 P1AJCD
      * I :  Transaction Date Code
     I                                    P   6   90P1B4DT
     IP2PARM      DS
      * FLD: Item Balance
      * I :  Cycle Count Code IB
     I                                        1   3 P2ATNA
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1AJCD    PARM           WP0002  3        Warehouse Code
     C           P1B4DT    PARM           WP0003  70       Transaction Dat
     C           P2ATNA    PARM           WP0004  3        Cycle Count Cod
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Backin Spec'l Adj  XF
      * WI517 DN 10/12/23-Setup Eradani's Environment Libraries.
      * Upd Setup Eradani Libs CL - /UT User Programs  * 
     C                     CALL 'PVBFUPC'              90  Upd Setup Erada
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVBFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/05/23-Added 'Called From Program' Input Parm.
      *   We will NOT send WIM API failed email here as this process is
      *   also used in a submitted batch process.
      * UPD Backin Spec'l Adj  RT - Item Transaction Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * UPD Backin Spec'l Adj  RT - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0002 112       Transaction Qty
     C                     Z-ADD*ZERO     WN0003 112       Transaction Wgt
     C                     MOVEL*BLANK    WN0004  2        UOM Primary
     C                     Z-ADD*ZERO     WN0005  94       Conversion Fact
     C                     MOVEL*BLANK    WN0006  1        Operation Facto
     C                     MOVEL*BLANK    WN0007  2        UOM Second
     C                     Z-ADD*ZERO     WN0008  94       Conversion Fact
     C                     MOVEL*BLANK    WN0009  1        Operation Facto
     C                     MOVEL*BLANK    WN0010  2        UOM Third
     C                     MOVEL*BLANK    WN0011  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0012 112       Unit Weight
     C                     MOVEL*BLANK    WN0013  1        Production Date
     C                     MOVEL*BLANK    WN0014  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0015  30       Item Structure
     C                     Z-ADD*ZERO     WN0016  30       Item Structure
     C                     Z-ADD*ZERO     WN0017  30       Item Structure
     C                     MOVEL*BLANK    WN0018  3        Cycle Count Cod
     C                     MOVEL*BLANK    WN0019  1        Record Selected
     C                     MOVEL*BLANK    WN0020  1        Shift Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'1'       WN0020           Shift Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAB4DT    WQSA02           Transaction Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Transaction Dat
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1B4DT    WQSA02           Transaction Dat
      * Establish starting position
     C           KRSSA     SETLL@B7CPJC                    *
     C           KRSSA     READE@B7CPJC                  90*
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0019           Record Selected
      * If physical was sent from accu-sort then dont process
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Reason Code is Accu-Sort Adj Phs Add
      *   |- c2    : DB1.Reason Code is Accu-Sort Adj Phs Delete
      *   '-
     C           WACQCD    IFEQ 'IAD'                      *IF
     C           WACQCD    OREQ 'IDL'                      *OR
     C                     MOVEL'N'       WN0019           Record Selected
     C                     END                             *FI
      * Rtv Cycle Code         RT - IC Item Balance  * 
     C                     EXSR SBRVGN
      * If cycle count code is entered then make sure is equal
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Cycle Count Code - IB is Entered
      *   |- c2    : PAR.Cycle Count Code NE PAR.Cycle Count Code - IB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2ATNA    IFNE *BLANK                     *IF
     C           WN0018    IFNE P2ATNA                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0019           Record Selected
     C                     END                             *FI
      * If warehouse is entered then make sure its equal
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Warehouse Code is Warehouse Code not Blank
      *   |- c2    : DB1.Warehouse Code NE PAR.Warehouse Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AJCD    IFNE *BLANK                     *IF
     C           WAAJCD    IFNE P1AJCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0019           Record Selected
     C                     END                             *FI
      * If record is selected then process
      * CASE: PAR.Record Selected       USR is yes
     C           WN0019    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     WN0002           Transaction Qty
     C                     Z-ADD*ZERO     WN0003           Transaction Wgt
      * RTV Backout Spec'l Adj RT - Item Transaction Detail  * 
     C                     EXSR SCRVGN
      * Update balance files if weight or quantity is not zeros
      * CASE: Backout Qty or Wgt <> 0
      *  - c1 OR c2
      *   |- c1    : PAR.Transaction Qty. Total NE WRK.ZERO
      *   |- c2    : PAR.Transaction Wgt. Total NE WRK.ZERO
      *   '-
     C           WN0002    IFNE WUW0NB                     *IF
     C           WN0003    ORNE WUW0NB                     *OR
      * Rtv Base Values        RT - Company/Item  * 
     C                     EXSR SDRVGN
      * RTV Unit Cost          RT - IC Item Balance  * 
     C                     EXSR SERVGN
      * ** FP1127 Update located on-hand inventory for external whse,
      * ** lot located, not carlisle controlled. (Lot number = zeros)
      * WI517 DN 09/29/23-Added Parms 'Inventory Updated USR',
      *   'Called From Program' & 'API was Called? U'.
      *
     C                     Z-ADD*ZERO     WN0022  30       Item Structure
     C                     Z-ADD*ZERO     WN0023  30       Item Structure
     C                     Z-ADD*ZERO     WN0024  30       Item Structure
     C                     Z-ADD*ZERO     WN0025  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0026  30       Sequence Number
     C                     Z-ADD*ZERO     WN0027 114       USR Transaction
     C                     Z-ADD*ZERO     WN0028 112       Extended Amount
     C                     Z-ADD*ZERO     WN0029 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0030 112       On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0031 112       Value of On Han
     C                     Z-ADD*ZERO     WN0032 112       Quantity based
     C                     Z-ADD*ZERO     WN0033 112       Quantity based
     C                     Z-ADD*ZERO     WN0034 112       Quantity based
     C                     Z-ADD*ZERO     WN0035 114       Cost based on U
     C                     Z-ADD*ZERO     WN0036 114       Cost based on U
     C                     Z-ADD*ZERO     WN0037 114       Cost based on U
     C                     Z-ADD*ZERO     WN0038 112       Quantity Total
     C                     Z-ADD*ZERO     WN0039 112       USR Transaction
     C                     MOVEL*BLANK    WN0040  3        USR Reason Code
      *
      * UPD Balances Issue/Adj IF
      * NOTES: WI517 DN 10/09/23-Per Business (Ace C./Ryan H.), we will N
      *        pass in the 'negative' Qty/Wgt when processing the WIM API
      *        WIM API logic will handle this scenario.
      * WI517 DN 07/05/23-Get WIM Module Release Status.
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
     C                     EXSR SFRVGN
     C                     MOVEL'N'       YN0001           Inventory Updat
     C                     MOVEL'N'       YN0002           API was Called?
      * 08/10/23 DN WI517-Call Existing Legacy Process.
      * CASE: *OTHERWISE
     C                     Z-ADDWN0002    WN0038           Quantity Total
     C                     Z-ADDWN0003    WN0039           USR Transaction
      * Adjust quantity, weight for trans type (make negative if issue)
      * CASE: PAR.Inventory Trans. Type is Issue types
     C           'OB'      IFEQ 'I'                        *IF
     C           'OB'      OREQ 'IO'
     C           'OB'      OREQ 'RW'
      * CASE: PAR.USR Unship Flag is yes
     C           'N'       IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Qty
      * CASE: PAR.Transaction Quantity GT WRK.ZERO
     C           WN0002    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  WN0002    WN0038           Quantity Total
     C                     END                             *FI
      * Wgt
      * CASE: PAR.Transaction Weight GT WRK.ZERO
     C           WN0003    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  WN0003    WN0039           USR Transaction
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      *
     C                     Z-ADD*ZERO     WN0041 112       Quantity based
     C                     Z-ADD*ZERO     WN0042 112       Quantity based
     C                     Z-ADD*ZERO     WN0043 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0032           USR Qty based o
     C                     Z-ADD*ZERO     WN0033           USR Qty based o
     C                     Z-ADD*ZERO     WN0034           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           WN0004    IFEQ WN0004                     *IF
     C                     Z-ADDWN0038    WN0032           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           WN0007    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0006    IFEQ 'M'                        *IF
     C           WN0038    MULT WN0005    WN0042    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0006    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0005    IFNE 0                          *IF
     C           WN0038    DIV  WN0005    WN0042    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0042    WN0033           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0010    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
     C           WN0042    MULT WN0008    WN0043    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0009    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0008    IFNE 0                          *IF
     C           WN0042    DIV  WN0008    WN0043    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0043    WN0034           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           WN0007    IFEQ WN0004                     *IF
     C                     Z-ADDWN0038    WN0033           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0006    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0005    IFNE 0                          *IF
     C           WN0038    DIV  WN0005    WN0032    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0006    IFEQ 'D'                        *IF
     C           WN0038    MULT WN0005    WN0032    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0010    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
     C           WN0038    MULT WN0008    WN0043    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0009    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0008    IFNE 0                          *IF
     C           WN0038    DIV  WN0008    WN0043    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0043    WN0034           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           WN0010    IFEQ WN0004                     *IF
     C                     Z-ADDWN0038    WN0034           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0008    IFNE 0                          *IF
     C           WN0038    DIV  WN0008    WN0042    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0009    IFEQ 'D'                        *IF
     C           WN0038    MULT WN0008    WN0042    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0042    WN0033           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0006    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0005    IFNE 0                          *IF
     C           WN0042    DIV  WN0005    WN0032    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0006    IFEQ 'D'                        *IF
     C           WN0042    MULT WN0005    WN0032    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0044 114       Cost based on U
     C                     Z-ADD*ZERO     WN0045 114       Cost based on U
     C                     Z-ADD*ZERO     WN0046 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0035           Cost based on U
     C                     Z-ADD*ZERO     WN0036           Cost based on U
     C                     Z-ADD*ZERO     WN0037           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           WN0004    IFEQ WN0004                     *IF
     C                     Z-ADDWN0001    WN0035           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           WN0007    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0006    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0005    IFNE 0                          *IF
     C           WN0001    DIV  WN0005    WN0045    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0006    IFEQ 'D'                        *IF
     C           WN0001    MULT WN0005    WN0045    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0045    WN0036           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0010    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0008    IFNE 0                          *IF
     C           WN0045    DIV  WN0008    WN0037    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0009    IFEQ 'D'                        *IF
     C           WN0045    MULT WN0008    WN0037    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           WN0007    IFEQ WN0004                     *IF
     C                     Z-ADDWN0001    WN0036           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0006    IFEQ 'M'                        *IF
     C           WN0001    MULT WN0005    WN0035    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0006    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0005    IFNE 0                          *IF
     C           WN0001    DIV  WN0005    WN0035    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0010    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0008    IFNE 0                          *IF
     C           WN0001    DIV  WN0008    WN0037    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0009    IFEQ 'D'                        *IF
     C           WN0001    MULT WN0008    WN0037    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           WN0010    IFEQ WN0004                     *IF
     C                     Z-ADDWN0001    WN0037           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
     C           WN0001    MULT WN0008    WN0045    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0009    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0008    IFNE 0                          *IF
     C           WN0001    DIV  WN0008    WN0045    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0045    WN0036           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0006    IFEQ 'M'                        *IF
     C           WN0045    MULT WN0005    WN0035    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0006    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0005    IFNE 0                          *IF
     C           WN0045    DIV  WN0005    WN0035    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           WN0001    MULT WN0039    WN0028           Extended Amount
     C                     MOVEL*BLANK    WN0040           USR Reason Code
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           WN0001    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0040           USR Reason Code
     C                     END                             *FI
      * 08/10/23 DN WI517-Call Legacy Process if Not Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0001    IFEQ 'N'                        *IF
     C           YL0001    OREQ 'P'                        *OR
      * 09/22/23 DN WI517-Set 'Inventory Updated USR' Flag.
     C                     MOVEL'Y'       YN0001           Inventory Updat
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAHGCD    WL0002           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WN0022           Item Structure
     C                     Z-ADDWL0004    WN0023           Item Structure
     C                     Z-ADDWL0005    WN0024           Item Structure
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0006           Company Number
     C                     Z-ADDWAHGCD    WL0007           Item Code
     C                     MOVELWAAJCD    WL0008    P      Warehouse Code
     C                     MOVEL'A'       WL0009    P      Inventory Trans
     C                     MOVEL'OB'      WL0010    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0011           Transaction Dat
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    WN0025           ITD Sequence Nu
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0013           Company Number
     C                     Z-ADDWAHGCD    WL0014           Item Code
     C                     MOVELWAAJCD    WL0015    P      Warehouse Code
     C                     MOVEL'A'       WL0016    P      Inventory Trans
     C                     MOVEL'OB'      WL0017    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0018           Transaction Dat
     C                     Z-ADDWN0025    WL0019           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0020           Sequence Number
     C                     Z-ADDWAELDT    WL0021           Production Date
     C                     MOVELWN0004    WL0022    P      UOM Transaction
     C                     MOVEL'SG'      WL0023    P      Item Transactio
     C                     MOVEL@CN,002   WL0024    P      Description
     C                     Z-ADDWN0038    WL0025           Transaction Qua
     C                     Z-ADDWN0039    WL0026           Transaction Wei
     C                     Z-ADD*ZERO     WL0027           USR Transaction
     C                     MOVELWN0004    WL0028    P      UOM Cost
     C                     Z-ADDWN0028    WL0029           Extended Amount
     C                     MOVEL*BLANK    WL0030           Ticket Number
     C                     Z-ADD*ZERO     WL0031           GL Document Num
     C                     MOVEL*BLANK    WL0032           GL Update Statu
     C                     MOVELWN0040    WL0033    P      Reason Code
     C                     MOVEL*BLANK    WL0034           Reference Numbe
     C                     MOVEL*BLANK    WL0035           Lot ID
     C                     Z-ADD*ZERO     WL0036           Transfer Batch
     C                     Z-ADD*ZERO     WL0037           Transfer Batch
     C                     Z-ADDWAC4NB    WL0038           Order Number
     C                     Z-ADDWN0022    WL0039           Item Structure
     C                     Z-ADDWN0023    WL0040           Item Structure
     C                     Z-ADDWN0024    WL0041           Item Structure
     C                     MOVEL*BLANK    WL0042           Employee Badge
     C                     Z-ADD*ZERO     WL0043           Production Time
     C                     MOVELWN0020    WL0044    P      Shift Number
     C                     Z-ADDWAK7DT    WL0045           Label Date
     C                     MOVEL*BLANK    WL0046           EDI Status 1
     C                     MOVEL*BLANK    WL0047           EDI Status 2
     C                     MOVEL*BLANK    WL0048           EDI Status 3
     C                     MOVEL'A'       WL0049    P      Record Status
     C                     EXSR SICRRC
      * ** This creates or updates Item Balance Detail
      * CHG Value/Qty/Wgt      CH - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0050           Company Number
     C                     Z-ADDWAHGCD    WL0051           Item Code
     C                     MOVELWAAJCD    WL0052    P      Warehouse Code
     C                     Z-ADDWAELDT    WL0053           Production Date
     C                     Z-ADDWN0022    WL0054           Item Structure
     C                     Z-ADDWN0023    WL0055           Item Structure
     C                     Z-ADDWN0024    WL0056           Item Structure
     C                     MOVELWN0004    WL0057    P      UOM Primary
     C                     Z-ADDWN0005    WL0058           Conversion Fact
     C                     MOVELWN0006    WL0059    P      Operation Facto
     C                     MOVELWN0007    WL0060    P      UOM Second
     C                     Z-ADDWN0008    WL0061           Conversion Fact
     C                     MOVELWN0009    WL0062    P      Operation Facto
     C                     MOVELWN0010    WL0063    P      UOM Third
     C                     MOVELWN0013    WL0064    P      Production Date
     C                     MOVELWN0014    WL0065    P      Catch Weight St
     C                     MOVEL'A'       WL0066    P      Inventory Trans
     C                     MOVEL'OB'      WL0067    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0068           Transaction Dat
     C                     MOVELWN0004    WL0069    P      UOM Transaction
     C                     Z-ADDWN0032    WL0070           Transaction Qua
     C                     Z-ADDWN0039    WL0071           Transaction Wei
     C                     Z-ADDWN0001    WL0072           USR Transaction
     C                     MOVELWN0004    WL0073    P      UOM Cost
     C                     Z-ADDWN0028    WL0074           Extended Amount
     C                     Z-ADDWAK7DT    WL0075           Label Date  USR
     C                     EXSR SJCHRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0076           Company Number
     C                     Z-ADDWAHGCD    WL0077           Item Code
     C                     MOVELWAAJCD    WL0078    P      Warehouse Code
     C                     Z-ADDWN0029    WL0079           Quantity on Han
     C                     Z-ADDWN0030    WL0080           Quantity on Han
     C                     Z-ADDWUNFNN    WL0081           Quantity on Han
     C                     Z-ADDWUNFNN    WL0082           Quantity on Han
     C                     Z-ADDWN0031    WL0083           Value of On Han
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    WN0029           Quantity on Han
     C                     Z-ADDWL0080    WN0030           Quantity on Han
     C                     Z-ADDWL0081    WUNFNN           Quantity on Han
     C                     Z-ADDWL0082    WUNFNN           Quantity on Han
     C                     Z-ADDWL0083    WN0031           Value of On Han
      * Chg Val/Qty/Wgt        Ch - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0084           Company Number
     C                     Z-ADDWAHGCD    WL0085           Item Code
     C                     MOVELWAAJCD    WL0086    P      Warehouse Code
     C                     Z-ADDWN0029    WL0087           On Hand Weight
     C                     Z-ADDWN0030    WL0088           On Hand UOM1 Su
     C                     Z-ADDWN0031    WL0089           Value of On Han
     C                     EXSR SOCHRC
      * ** Process Auto-Locate Whse inventory             FP1127
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0090    P      Warehouse Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0091    YN0003    P      Warehouse Descr
     C                     MOVELWL0092    YN0004    P      Address Line 1
     C                     MOVELWL0093    YN0005    P      Address Line 2
     C                     MOVELWL0094    YN0006    P      Address Line 3
     C                     MOVELWL0095    YN0007    P      City
     C                     MOVELWL0096    YN0008    P      Zip Postal Code
     C                     MOVELWL0097    YN0009    P      Production Ware
     C                     MOVELWL0098    YN0010    P      State Code
     C                     MOVELWL0099    YL0002    P      Lot Tracking Fl
     C                     MOVELWL0100    YN0011    P      Default Printer
     C                     MOVELWL0101    YN0012    P      Warehouse Type
     C                     MOVELWL0102    YN0013    P      Trans Contol AS
     C                     MOVELWL0103    YL0003    P      Warehouse Locat
     C                     MOVELWL0104    YN0014    P      Warehouse Std C
     C                     Z-ADDWL0105    YN0015           Warehouse Chill
     C                     MOVELWL0106    YN0016    P      Include in Auto
     C                     MOVELWL0107    YN0017    P      Default Manifes
     C                     MOVELWL0108    YN0018    P      Default Load Se
     C                     MOVELWL0109    YN0019    P      WHS Slotting Li
     C                     Z-ADDWL0110    YN0020           Shipping Compan
     C                     Z-ADDWL0111    YN0021           Accounting Comp
     C                     Z-ADDWL0112    YN0022           WHS Sched Prod
     C                     Z-ADDWL0113    YN0023           WHS Inventory C
     C                     MOVELWL0114    YN0024    P      Parent Warehous
     C                     MOVELWL0115    YN0025    P      Default Shippin
     C                     MOVELWL0116    YL0004    P      WHS Live with C
     C                     MOVELWL0117    YN0026    P      WHS PFS Interfa
     C                     MOVELWL0118    YN0027    P      WHS Req Meter R
     C                     MOVELWL0119    YN0028    P      WHS Default Loa
     C                     MOVELWL0120    YN0029    P      WHS TMS Plannin
     C                     MOVELWL0121    YN0030    P      Default Carrier
     C                     MOVELWL0122    YN0031    P      Inventory Logic
     C                     MOVELWL0123    YN0032    P      WHS Auto Inv Re
     C                     MOVELWL0124    YN0033    P      EDI Status 1
     C                     MOVELWL0125    YN0034    P      EDI Status 2
     C                     MOVELWL0126    YN0035    P      EDI Status 3
     C                     MOVELWL0127    YN0036    P      Record Status
     C                     Z-ADDWL0128    YN0037           Job Time
     C                     MOVELWL0129    YN0038    P      User Id
     C                     MOVELWL0130    YN0039    P      Job Name
     C                     Z-ADDWL0131    YN0040           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'E'                        *IF
     C           YL0004    IFEQ *BLANK                     *IF
     C           YL0004    OREQ 'N'
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** For External whses: level=0, lot=last 5 digits of Load ID (opt
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0132    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0133    WUYMCD    P      Location Code
     C                     MOVELWL0134    YL0005    P      Location Aisle
     C                     Z-ADDWL0135    YL0006           Location Bay
     C                     Z-ADDWL0136    YL0007           Loc Unused Chil
     C                     MOVEL*BLANK    YL0008           Order Type_Sale
      * RTV Order Type         RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0137           Company Number
     C                     Z-ADDWAC4NB    WL0138           Order Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0139    YL0008    P      Order Type_Sale
      * ** Upd/add lot info if Transfer, or Issue, but not for shipped or
      * CASE:
      *  - c1 OR c3
      *   |- c1    : LCL.Order Type - Sales is Not Regular Order
      *   |- c3    : PAR.Order Number is Equal to zeros
      *   '-
     C           YL0008    IFNE 'OR'                       *IF
     C           WAC4NB    OREQ 0                          *OR
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0056  30       Company Number
     C                     PARM WAHGCD    WQ0057  70       Item Code
     C                     PARM WAAJCD    WQ0058  3        Warehouse Code
     C                     PARM WAELDT    WQ0059  70       Production Date
     C                     PARM *ZERO     WQ0060  50       Lot Number
     C                     PARM WUYMCD    WQ0061  4        Location Code
     C                     PARM WUYNCD    WQ0062  20       Location Level
     C                     PARM WN0038    WQ0063  70       Quantity Loc Tr
     C                     PARM WAC4NB    WQ0064  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * 09/27/24 DN SR20410-Commented Out & Moved Below.
      * 09/27/24 DN SR20410-Commented Out & Moved Below.
      * 09/27/24 DN SR20410-Only Call if NOT from PDLYXFR Program.
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.Called From Program is UPD Backin Spec'l Adj  XF
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           @CN,001   IFEQ @CN,001                    *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 08/10/23 DN WI517-Call WIM API if Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Is Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0001    IFEQ 'Y'                        *IF
     C           YL0001    OREQ 'P'                        *OR
     C                     MOVEL'Y'       YN0002           API was Called?
     C                     MOVEL*BLANK    YL0009           API EccResult-M
     C                     MOVEL*BLANK    YL0010           API EccResult-M
     C                     MOVEL*BLANK    YL0011           API Request Key
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,004   CAT  'ry':ZQ   YL0012    P      API Name
      * RTV Numeric Value      RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL@CN,005   WL0140    P      System Value Co
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0141    YL0013           System Value Nu
      * Call API Wrapper Program for wim.ordershipping.inventory API.
      * 1/6/24 DN SR08283-Added 'API Request Key U' & 'API Mode U' Parms.
      * API WIM Inv Shipping   UP - WIM Item Trans Detail  * 
     C                     CLEARPARC
     C                     Z-ADDWAAIC3    PAAIC3           Company Number
     C                     Z-ADDWAHGCD    PAHGCD           Item Code
     C                     MOVELWAAJCD    PAVPCD    P      Ship From Wareh
     C                     MOVEL'A'       PANOSC    P      WIM Inventory T
     C                     MOVEL'OB'      PANPSC    P      WIM Inventory T
     C                     Z-ADDP1B4DT    PAA9DT           Transaction Dat
     C                     Z-ADDWAELDT    PAELDT           Production Date
     C                     MOVEL'SG'      PAF1ST    P      Item Transactio
     C                     MOVEL@CN,002   PAVQNA    P      Transaction Des
     C                     MOVEL*BLANK    PAA1AB    P      Transaction Rea
     C                     Z-ADDWAC4NB    PAC4NB           Order Number
     C                     MOVELWN0020    PAXLCD    P      Shift Number
     C                     MOVEL*BLANK    PAL9AA    P      Ship To Warehou
     C                     Z-ADDWN0003    PAAHWG           Transaction Wei
     C                     Z-ADDWN0002    PAA5QT           Transaction Qua
     C                     MOVEL'N'       PAUSST    P      USR Unship Flag
     C                     MOVEL'N'       PAA5TX    P      Inter-Plant Tra
     C                     MOVELYL0011    PACKAB    P      API Request Key
     C                     MOVEL'*SNDRCV' PACJAB    P      API Mode U
      *
     C                     CALL 'PVAYUPR'              90  API WIM Inv Shi
     C                     PARM YL0013    WQ0065  50       API Wait Time U
     C                     PARM           PARC             RCD: *Arrays
      *
     C                     MOVELPACLAB    YL0009           API EccResult-M
     C                     MOVELPAVGU1    YL0010           API EccResult-M
     C                     MOVELPACKAB    YL0011           API Request Key
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVAYUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * API Call Successful? If Not, Create Log & Send Email.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.API EccResult-MsgId U is Success
      *   |- c2    : LCL.API EccResult-MsgId U is Timeout
      *   '-
     C           YL0009    IFEQ @CN,006                    *IF
     C           YL0009    OREQ @CN,007                    *OR
     C                     MOVEL'Y'       YN0001           Inventory Updat
      * 01/06/24 DN SR08283-Create Log Record for Timeout Transaction.
      * CASE: LCL.API EccResult-MsgId U is Timeout
     C           YL0009    IFEQ @CN,007                    *IF
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Timeout Failur
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0012    WQ0066 45        API Name
     C                     PARM YL0009    WQ0067  7        API EccResult M
     C                     PARM YL0010    WQ0068 50        API EccResult-M
     C                     PARM YL0011    WQ0069 10        API Request Key
     C                     PARM @CN,001   WQ0070 10        Called From Pro
     C                     PARM WAAIC3    WQ0071  30       Company Number
     C                     PARM WAHGCD    WQ0072  70       Item Code
     C                     PARM WAAJCD    WQ0073  3        Ship From Wareh
     C                     PARM 'A'       WQ0074  3        WIM Inventory T
     C                     PARM 'OB'      WQ0075  3        WIM Inventory T
     C                     PARM P1B4DT    WQ0076  70       Transaction Dat
     C                     PARM WAELDT    WQ0077  70       Production Date
     C                     PARM 'SG'      WQ0078  2        Item Transactio
     C                     PARM @CN,002   WQ0079 30        Transaction Des
     C                     PARM *BLANK    WQ0080  3        Transaction Rea
     C                     PARM WAC4NB    WQ0081  70       Order Number
     C                     PARM WN0020    WQ0082  1        Shift Number
     C                     PARM *BLANK    WQ0083  3        Ship To Warehou
     C                     PARM WN0003    WQ0084 112       Transaction Wei
     C                     PARM WN0002    WQ0085 112       Transaction Qua
     C                     PARM 'N'       WQ0086  1        Unship Flag
     C                     PARM 'N'       WQ0087  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 12/21/23 DN SR07943-Added 'API EccResult-MsgId U is Entered' Cond
      * CASE: LCL.API EccResult-MsgId U is Entered
     C           YL0009    IFNE *BLANK                     *IF
     C                     MOVEL'N'       YN0001           Inventory Updat
      * 1/6/24 DN SR08283-Added 'API Request Key' as Input Parm.
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Hardstop Failu
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0012    WQ0088 45        API Name
     C                     PARM YL0009    WQ0089  7        API EccResult M
     C                     PARM YL0010    WQ0090 50        API EccResult-M
     C                     PARM YL0011    WQ0091 10        API Request Key
     C                     PARM @CN,001   WQ0092 10        Called From Pro
     C                     PARM WAAIC3    WQ0093  30       Company Number
     C                     PARM WAHGCD    WQ0094  70       Item Code
     C                     PARM WAAJCD    WQ0095  3        Ship From Wareh
     C                     PARM 'A'       WQ0096  3        WIM Inventory T
     C                     PARM 'OB'      WQ0097  3        WIM Inventory T
     C                     PARM P1B4DT    WQ0098  70       Transaction Dat
     C                     PARM WAELDT    WQ0099  70       Production Date
     C                     PARM 'SG'      WQ0100  2        Item Transactio
     C                     PARM @CN,002   WQ0101 30        Transaction Des
     C                     PARM *BLANK    WQ0102  3        Transaction Rea
     C                     PARM WAC4NB    WQ0103  70       Order Number
     C                     PARM WN0020    WQ0104  1        Shift Number
     C                     PARM *BLANK    WQ0105  3        Ship To Warehou
     C                     PARM WN0003    WQ0106 112       Transaction Wei
     C                     PARM WN0002    WQ0107 112       Transaction Qua
     C                     PARM 'N'       WQ0108  1        Unship Flag
     C                     PARM 'N'       WQ0109  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Keep Track of Batch Processing Functions so Email will NOT be Sen
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : PAR.Called From Program is Exc Proc 947 Whs InvAdjXF
      *   |- c2    : PAR.Called From Program is EDT Confirm Ship Detl  DF
      *   |- c3    : PAR.Called From Program is ADD Ready to Confirm  XL
      *   |- c4    : PAR.Called From Program is Exc Upd EDI 945 Trsn   XF
      *   |- c5    : PAR.Called From Program is PFS Reopen Order      XL
      *   |- c6    : PAR.Called From Program is WW Unship Orders       DF
      *   |- c7    : PAR.Called From Program is UPD Backin Spec'l Adj  XF
      *   '-
     C           @CN,001   IFEQ @CN,008                    *IF
     C           @CN,001   OREQ @CN,009                    *OR
     C           @CN,001   OREQ @CN,010                    *OR
     C           @CN,001   OREQ @CN,011                    *OR
     C           @CN,001   OREQ @CN,012                    *OR
     C           @CN,001   OREQ @CN,013                    *OR
     C           @CN,001   OREQ @CN,001                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Send Email to Business & IT.
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                     CALL 'PVA9XFR'              90  Prc Eml Shippin
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,001   WQ0110 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@B7CPJC                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Cycle Code         RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAHGCD    WBHGCD           Item Code
     C                     MOVELWAAJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0018           Cycle Count Cod
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWBATNA    WN0018           Cycle Count Cod
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Backout Spec'l Adj RT - Item Transaction Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0021  3        Reason Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCHGCD    WQSC02           Item Code
     C           *LIKE     DEFN WCAJCD    WQSC03           Warehouse Code
     C           *LIKE     DEFN WCELDT    WQSC04           Production Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Item Code
     C                     KFLD           WQSC03           Warehouse Code
     C                     KFLD           WQSC04           Production Date
      * Setup key
     C                     Z-ADDWAAIC3    WQSC01           Company Number
     C                     Z-ADDWAHGCD    WQSC02           Item Code
     C                     MOVELWAAJCD    WQSC03           Warehouse Code
     C                     Z-ADDWAELDT    WQSC04           Production Date
      * Establish starting position
     C           KRSSC     SETLL@B7CPI8                    *
     C           KRSSC     READE@B7CPI8                  90*
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'IAD'     WN0021           Reason Code
      * Special adjustment trans id and type are passed in as reference p
      * CASE: Special adjustment
      *  - c1 AND c2
      *   |- c1    : DB1.Inventory Trans. ID EQ PAR.Inventory Trans. ID
      *   |- c2    : DB1.Inventory Trans. Type EQ PAR.Inventory Trans. Ty
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCW9ST    IFEQ 'A'                        *IF
     C           WCBSST    IFEQ 'SA'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  WCA5QT    WN0002           Transaction Qty
     C                     ADD  WCAHWG    WN0003           Transaction Wgt
     C                     ELSE
      * CASE: Latest Physical Adjustment
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.Inventory Trans. ID is Adjustment
      *   |- c2    : DB1.Inventory Trans. Type is Adjustment Physical
      *   |- c3    : DB1.Reason Code EQ PAR.Reason Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCW9ST    IFEQ 'A'                        *IF
     C           WCBSST    IFEQ 'AP'                       *IF
     C           WCCQCD    IFEQ WN0021                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@B7CPI8                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     Z-ADDWAHGCD    WDHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     MOVEL*BLANK    WN0004           UOM Primary
     C                     Z-ADD*ZERO     WN0005           Conversion Fact
     C                     MOVEL*BLANK    WN0006           Operation Facto
     C                     MOVEL*BLANK    WN0007           UOM Second
     C                     Z-ADD*ZERO     WN0008           Conversion Fact
     C                     MOVEL*BLANK    WN0009           Operation Facto
     C                     MOVEL*BLANK    WN0010           UOM Third
     C                     MOVEL*BLANK    WN0011           UOM Pricing
     C                     Z-ADD*ZERO     WN0012           Unit Weight
     C                     MOVEL*BLANK    WN0013           Production Date
     C                     MOVEL*BLANK    WN0014           Catch Weight St
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAVNA    WUAVNA           Description Lin
     C                     MOVELWDAWNA    WUAWNA           Description Lin
     C                     MOVELWDADCD    WN0004           UOM Primary
     C                     Z-ADDWDAWPC    WN0005           Conversion Fact
     C                     MOVELWDLXST    WN0006           Operation Facto
     C                     MOVELWDAECD    WN0007           UOM Second
     C                     Z-ADDWDAXPC    WN0008           Conversion Fact
     C                     MOVELWDLYST    WN0009           Operation Facto
     C                     MOVELWDAFCD    WN0010           UOM Third
     C                     MOVELWDAICD    WN0011           UOM Pricing
     C                     Z-ADDWDAIWG    WN0012           Unit Weight
     C                     MOVELWDFZST    WN0013           Production Date
     C                     MOVELWDAVST    WN0014           Catch Weight St
     C                     Z-ADDWDCHTM    WUCHTM           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Unit Cost          RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAHGCD    WBHGCD           Item Code
     C                     MOVELWAAJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@B0REJX              90    *
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAGCS    WN0001           Unit Cost Per P
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Module Release
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEB3AB           Module ID
     C                     KFLD           WEHUNZ           Release Number
      * Setup key
     C                     MOVEL'WIM'     WEB3AB           Module ID
     C                     Z-ADD1         WEHUNZ           Release Number
      * Establish starting position
     C           KRSSF     CHAIN@C6REMK              90    *
      * Data record not found
     C   90                MOVEL'USR5307' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WEVSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELWEOCSC    YL0001           Module Release
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WDAIC3           Company Number
     C                     Z-ADDWL0002    WDHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDRINB    WL0003           Item Structure
     C                     Z-ADDWDRHNB    WL0004           Item Structure
     C                     Z-ADDWDRGNB    WL0005           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WFHGCD    WQSH02           Item Code
     C           *LIKE     DEFN WFAJCD    WQSH03           Warehouse Code
     C           *LIKE     DEFN WFW9ST    WQSH04           Inventory Trans
     C           *LIKE     DEFN WFBSST    WQSH05           Inventory Trans
     C           *LIKE     DEFN WFB4DT    WQSH06           Transaction Dat
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Item Code
     C                     KFLD           WQSH03           Warehouse Code
     C                     KFLD           WQSH04           Inventory Trans
     C                     KFLD           WQSH05           Inventory Trans
     C                     KFLD           WQSH06           Transaction Dat
      * Setup key
     C                     Z-ADDWL0006    WQSH01           Company Number
     C                     Z-ADDWL0007    WQSH02           Item Code
     C                     MOVELWL0008    WQSH03           Warehouse Code
     C                     MOVELWL0009    WQSH04           Inventory Trans
     C                     MOVELWL0010    WQSH05           Inventory Trans
     C                     Z-ADDWL0011    WQSH06           Transaction Dat
      * Establish starting position
     C           KRSSH     SETLL@B7CPZA                    *
     C           KRSSH     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0012           ITD Sequence Nu
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WFC4NY    ADD  1         WL0012           ITD Sequence Nu
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0047  60       Job Time
     C                     MOVEL*BLANK    WN0048 10        User Id
     C                     MOVEL*BLANK    WN0049 10        Job Name
     C                     Z-ADD*ZERO     WN0050  70       Job Date
     C                     Z-ADD*ZERO     WN0051  20       Production Hour
     C                     Z-ADD*ZERO     WN0052 112       Production Weig
     C                     Z-ADD*ZERO     WN0053  50       Production Quan
     C                     Z-ADD*ZERO     WN0054  70       Production Piec
     C                     MOVEL*BLANK    WN0055  1        Export_Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWL0013    WGAIC3           Company Number
     C                     Z-ADDWL0014    WGHGCD           Item Code
     C                     MOVELWL0015    WGAJCD           Warehouse Code
     C                     MOVELWL0016    WGW9ST           Inventory Trans
     C                     MOVELWL0017    WGBSST           Inventory Trans
     C                     Z-ADDWL0018    WGB4DT           Transaction Dat
     C                     Z-ADDWL0019    WGC4NY           ITD Sequence Nu
     C                     Z-ADDWL0020    WGDXNB           Sequence Number
     C                     Z-ADDWL0021    WGELDT           Production Date
     C                     MOVELWL0022    WGHVCD           UOM Transaction
     C                     MOVELWL0023    WGF1ST           Item Transactio
     C                     MOVELWL0024    WGAUNA           Description
     C                     Z-ADDWL0025    WGA5QT           Transaction Qua
     C                     Z-ADDWL0026    WGAHWG           Transaction Wei
     C                     Z-ADDWL0027    WGAKCS           USR Transaction
     C                     MOVELWL0028    WGCGCD           UOM Cost
     C                     Z-ADDWL0029    WGAYVA           Extended Amount
     C                     MOVELWL0030    WGBJNA           Ticket Number
     C                     Z-ADDWL0031    WGCKNB           GL Document Num
     C                     MOVELWL0032    WGBMST           GL Update Statu
     C                     MOVELWL0033    WGCQCD           Reason Code
     C                     MOVELWL0034    WGDTCD           Reference Numbe
     C                     MOVELWL0035    WGMGNA           Lot ID
     C                     Z-ADDWL0036    WGTRBN           Transfer Batch
     C                     Z-ADDWL0037    WGTRBS           Transfer Batch
     C                     Z-ADDWL0038    WGC4NB           Order Number
     C                     Z-ADDWL0039    WGRINB           Item Structure
     C                     Z-ADDWL0040    WGRHNB           Item Structure
     C                     Z-ADDWL0041    WGRGNB           Item Structure
     C                     MOVELWL0042    WGM3NA           Employee Badge
     C                     Z-ADDWL0043    WGAWTM           Production Time
     C                     MOVELWL0044    WGXLCD           Shift Number
     C                     Z-ADDWL0045    WGK7DT           Label Date
     C                     MOVELWL0046    WGUVST           EDI Status 1
     C                     MOVELWL0047    WGUWST           EDI Status 2
     C                     MOVELWL0048    WGUXST           EDI Status 3
     C                     MOVELWL0049    WGVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WGAXDT    PARM *ZERO     WQ0001 155       Current System
     C           WGAATM    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSI    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGW9ST           Inventory Trans
     C                     KFLD           WGBSST           Inventory Trans
     C                     KFLD           WGB4DT           Transaction Dat
     C                     KFLD           WGC4NY           ITD Sequence Nu
     C                     KFLD           WGDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSI    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0003  30       Company Number
     C                     PARM WGHGCD    WQ0004  70       Item Code
     C                     PARM WGAJCD    WQ0005  3        Warehouse Code
     C                     PARM WGW9ST    WQ0006  1        Inventory Trans
     C                     PARM WGBSST    WQ0007  2        Inventory Trans
     C                     PARM WGB4DT    WQ0008  70       Transaction Dat
     C                     PARM WGDXNB    WQ0009  30       Sequence Number
     C                     PARM WGELDT    WQ0010  70       Production Date
     C                     PARM WGHVCD    WQ0011  2        UOM Transaction
     C                     PARM WGF1ST    WQ0012  2        Item Transactio
     C                     PARM WGAUNA    WQ0013 30        Description
     C                     PARM WGA5QT    WQ0014 112       Transaction Qua
     C                     PARM WGAHWG    WQ0015 112       Transaction Wei
     C                     PARM WGAKCS    WQ0016 114       USR Transaction
     C                     PARM WGCGCD    WQ0017  2        UOM Cost
     C                     PARM WGAYVA    WQ0018 112       Extended Amount
     C                     PARM WGBJNA    WQ0019  6        Ticket Number
     C                     PARM WGCKNB    WQ0020  80       GL Document Num
     C                     PARM WGBMST    WQ0021  1        GL Update Statu
     C                     PARM WGCQCD    WQ0022  3        Reason Code
     C                     PARM WGDTCD    WQ0023 15        Reference Numbe
     C                     PARM WGMGNA    WQ0024 10        Lot ID
     C                     PARM WGTRBN    WQ0025  70       Transfer Batch
     C                     PARM WGTRBS    WQ0026  30       Transfer Batch
     C                     PARM WGC4NB    WQ0027  70       Order Number
     C                     PARM WGRINB    WQ0028  30       Item Structure
     C                     PARM WGRHNB    WQ0029  30       Item Structure
     C                     PARM WGRGNB    WQ0030  30       Item Structure
     C                     PARM WGM3NA    WQ0031 10        Employee Badge
     C                     PARM WGAWTM    WQ0032  60       Production Time
     C                     PARM WGXLCD    WQ0033  1        Shift Number
     C                     PARM WGK7DT    WQ0034  70       Label Date
     C                     PARM WGVSST    WQ0035  1        Record Status
     C                     PARM WGAATM    WQ0036  60       Job Time
     C                     PARM WGAXDT    WQ0037  70       Job Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * CHG Value/Qty/Wgt      CH - Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0056 112       Physical Count
     C                     Z-ADD*ZERO     WN0057 112       Physical Count
     C                     Z-ADD*ZERO     WN0058 112       Physical Count
     C                     Z-ADD*ZERO     WN0059 112       Physical Count
     C                     MOVEL*BLANK    WN0060  1        Physical Count
     C                     Z-ADD*ZERO     WN0061 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0062 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0063 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0064 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0065 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0066 112       Weight In Chill
     C                     MOVEL*BLANK    WN0067  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0068 112       Physical Start
     C                     Z-ADD*ZERO     WN0069 112       Physical Start
     C                     Z-ADD*ZERO     WN0070 112       Physical Start
     C                     Z-ADD*ZERO     WN0071 112       Physical Start
     C                     Z-ADD*ZERO     WN0072  70       Physical Start
     C                     Z-ADD*ZERO     WN0073 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0074 114       Last Cost
     C                     Z-ADD*ZERO     WN0075 112       Value of On Han
     C                     Z-ADD*ZERO     WN0076  70       Label Date
     C                     MOVEL*BLANK    WN0077  1        EDI Status 1
     C                     MOVEL*BLANK    WN0078  1        EDI Status 2
     C                     MOVEL*BLANK    WN0079  1        EDI Status 3
     C                     MOVEL*BLANK    WN0080  1        Record Status
     C                     Z-ADD*ZERO     WN0081  60       Job Time
     C                     MOVEL*BLANK    WN0082 10        User Id
     C                     MOVEL*BLANK    WN0083 10        Job Name
     C                     Z-ADD*ZERO     WN0084  70       Job Date
     C                     MOVEL*BLANK    WN0085  1        Shift Number
     C                     MOVEL*BLANK    WN0086  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL'1'       WN0085           Shift Number
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0050    WHAIC3           Company Number
     C                     Z-ADDWL0051    WHHGCD           Item Code
     C                     MOVELWL0052    WHAJCD    P      Warehouse Code
     C                     Z-ADDWL0053    WHELDT           Production Date
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLCHSJ    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     EXSR SKCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YARDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWL0054    WHRINB           Item Structure
     C                     Z-ADDWL0055    WHRHNB           Item Structure
     C                     Z-ADDWL0056    WHRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YARDC            *Record Data Ch
     C                     ADD  WL0070    WHARQT           Quantity on Han
     C                     ADD  WL0071    WHACWG           Quantity on Han
     C                     ADD  WL0074    WHIDVA           Value of On Han
      * If quantity is zero, so are weight, value of inventory
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WHARQT    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - Item Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHAIC3    WQ0040  30       Company Number
     C                     PARM WHHGCD    WQ0041  70       Item Code
     C                     PARM WHAJCD    WQ0042  3        Warehouse Code
     C                     PARM WL0068    WQ0043  70       Transaction Dat
     C                     PARM WHELDT    WQ0044  70       Production Date
     C                     PARM WL0069    WQ0045  2        UOM Transaction
     C                     PARM WHACWG    WQ0046 112       Transaction Wei
     C                     PARM WL0072    WQ0047 114       USR Transaction
     C                     PARM WL0073    WQ0048  2        UOM Cost
     C                     PARM WHRINB    WQ0049  30       Item Structure
     C                     PARM WHRHNB    WQ0050  30       Item Structure
     C                     PARM WHRGNB    WQ0051  30       Item Structure
     C                     PARM WN0085    WQ0052  1        Shift Number
     C                     PARM WHK7DT    WQ0053  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WHACWG           Quantity on Han
     C                     Z-ADD*ZERO     WHIDVA           Value of On Han
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WHAXDT    PARM *ZERO     WQ0054 155       Current System
     C           WHAATM    PARM *ZERO     WQ0055 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WHARQT    IFEQ WUW0NB                     *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
     C                     EXSR SLRVGN
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0086    IFEQ *BLANK                     *IF
     C           WN0086    OREQ 'N'
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
     C                     EXSR SMDLRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0087  60       Job Time
     C                     MOVEL*BLANK    WN0088 10        User Id
     C                     MOVEL*BLANK    WN0089 10        Job Name
     C                     Z-ADD*ZERO     WN0090  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0050    WHAIC3           Company Number
     C                     Z-ADDWL0051    WHHGCD           Item Code
     C                     MOVELWL0052    WHAJCD           Warehouse Code
     C                     Z-ADDWL0053    WHELDT           Production Date
     C                     Z-ADD*ZERO     WHABWG           Physical Count
     C                     Z-ADD*ZERO     WHAGQT           Physical Count
     C                     Z-ADD*ZERO     WHAHQT           Physical Count
     C                     Z-ADD*ZERO     WHAIQT           Physical Count
     C                     MOVEL*BLANK    WHCTST           Physical Count
     C                     Z-ADDWL0071    WHACWG           Quantity on Han
     C                     Z-ADDWL0070    WHARQT           Quantity on Han
     C                     Z-ADD*ZERO     WHASQT           Quantity on Han
     C                     Z-ADD*ZERO     WHATQT           Quantity on Han
     C                     Z-ADD*ZERO     WHHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WHHEQT           Weight In Chill
     C                     MOVEL'N'       WHF6ST           Update Exceptio
     C                     Z-ADD*ZERO     WHBMWG           Physical Start
     C                     Z-ADD*ZERO     WHDSQT           Physical Start
     C                     Z-ADD*ZERO     WHDTQT           Physical Start
     C                     Z-ADD*ZERO     WHDUQT           Physical Start
     C                     Z-ADD*ZERO     WHDHDT           Physical Start
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAECS           Last Cost
     C                     Z-ADDWL0074    WHIDVA           Value of On Han
     C                     Z-ADDWL0075    WHK7DT           Label Date
     C                     Z-ADDWL0054    WHRINB           Item Structure
     C                     Z-ADDWL0055    WHRHNB           Item Structure
     C                     Z-ADDWL0056    WHRGNB           Item Structure
     C                     MOVEL*BLANK    WHUVST           EDI Status 1
     C                     MOVEL*BLANK    WHUWST           EDI Status 2
     C                     MOVEL*BLANK    WHUXST           EDI Status 3
     C                     MOVEL'A'       WHVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WHAXDT    PARM *ZERO     WQ0038 155       Current System
     C           WHAATM    PARM *ZERO     WQ0039 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSK    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSK    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWHAJCD    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0086           Lot Tracking Fl
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIVHST    WN0086           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMDLRC    BEGSR
      *================================================================
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
      *
     C           KLDLSM    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLDLSM    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0079           Quantity on Han
     C                     Z-ADD*ZERO     WL0080           Quantity on Han
     C                     Z-ADD*ZERO     WL0081           Quantity on Han
     C                     Z-ADD*ZERO     WL0082           Quantity on Han
     C                     Z-ADD*ZERO     WL0083           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WJHGCD    WQSN02           Item Code
     C           *LIKE     DEFN WJAJCD    WQSN03           Warehouse Code
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Item Code
     C                     KFLD           WQSN03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0076    WQSN01           Company Number
     C                     Z-ADDWL0077    WQSN02           Item Code
     C                     MOVELWL0078    WQSN03           Warehouse Code
      * Establish starting position
     C           KRSSN     SETLLCAB1RL4                    *
     C           KRSSN     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WJACWG    WL0079           Quantity on Han
     C                     ADD  WJARQT    WL0080           Quantity on Han
     C                     ADD  WJASQT    WL0081           Quantity on Han
     C                     ADD  WJATQT    WL0082           Quantity on Han
     C                     ADD  WJIDVA    WL0083           Value of On Han
     C           KRSSN     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg Val/Qty/Wgt        Ch - Item Balance  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0091 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0092 114       Last Cost
     C                     Z-ADD*ZERO     WN0093 114       Cost per Primar
     C                     Z-ADD*ZERO     WN0094 114       Cost per Pricin
     C                     Z-ADD*ZERO     WN0095 114       Revaluation Cos
     C                     Z-ADD*ZERO     WN0096  70       Revaluation Eff
     C                     MOVEL*BLANK    WN0097  1        Revaluation Cos
     C                     Z-ADD*ZERO     WN0098 114       Last Revaluatio
     C                     Z-ADD*ZERO     WN0099  70       Last Revaluatio
     C                     Z-ADD*ZERO     WN0100 112       On Hand UOM2 Su
     C                     Z-ADD*ZERO     WN0101 112       On Hand UOM3 Su
     C                     Z-ADD*ZERO     WN0102 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0103 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0104 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0105 112       Quantity on Sal
     C                     Z-ADD*ZERO     WN0106 112       Quantity on Pur
     C                     Z-ADD*ZERO     WN0107 112       Quantity on Tra
     C                     Z-ADD*ZERO     WN0108 112       Quantity Avail
     C                     MOVEL*BLANK    WN0109  3        Cycle Count Cod
     C                     Z-ADD*ZERO     WN0110  70       Date of Last Or
     C                     Z-ADD*ZERO     WN0111  70       Date of Last Sh
     C                     MOVEL*BLANK    WN0112  1        Inventory Plann
     C                     Z-ADD*ZERO     WN0113  52       Safety Allowanc
     C                     Z-ADD*ZERO     WN0114 112       Safety Allowanc
     C                     Z-ADD*ZERO     WN0115  70       Stock Out Date
     C                     MOVEL*BLANK    WN0116  3        Buyer Code
     C                     Z-ADD*ZERO     WN0117  30       Lead Time Last
     C                     Z-ADD*ZERO     WN0118  70       Lead Time Date
     C                     Z-ADD*ZERO     WN0119  30       Lead Time Next
     C                     Z-ADD*ZERO     WN0120  70       Lead Time Date
     C                     MOVEL*BLANK    WN0121  1        Lead Time Excep
     C                     Z-ADD*ZERO     WN0122 112       Usage Qty per C
     C                     Z-ADD*ZERO     WN0123 112       Usage Weight pe
     C                     Z-ADD*ZERO     WN0124  70       Inventory Manag
     C                     Z-ADD*ZERO     WN0125 112       Minimum Quantit
     C                     Z-ADD*ZERO     WN0126 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0127  70       Last Physical C
     C                     MOVEL*BLANK    WN0128  1        Requisition Mod
     C                     MOVEL*BLANK    WN0129  1        Cost Update Pen
     C                     MOVEL*BLANK    WN0130  1        Post GL Status
     C                     Z-ADD*ZERO     WN0131  80       Vendor Item_Whs
     C                     Z-ADD*ZERO     WN0132  30       Item Structure
     C                     Z-ADD*ZERO     WN0133  30       Item Structure
     C                     Z-ADD*ZERO     WN0134  30       Item Structure
     C                     MOVEL*BLANK    WN0135  1        EDI Status 1
     C                     MOVEL*BLANK    WN0136  1        EDI Status 2
     C                     MOVEL*BLANK    WN0137  1        EDI Status 3
     C                     MOVEL*BLANK    WN0138  1        Record Status
     C                     Z-ADD*ZERO     WN0139  60       Job Time
     C                     MOVEL*BLANK    WN0140 10        User Id
     C                     MOVEL*BLANK    WN0141 10        Job Name
     C                     Z-ADD*ZERO     WN0142  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWL0084    WKAIC3           Company Number
     C                     Z-ADDWL0085    WKHGCD           Item Code
     C                     MOVELWL0086    WKAJCD    P      Warehouse Code
      *
     C           KLCHSO    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKAJCD           Warehouse Code
     C           KLCHSO    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YBRDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWL0087    WKBOWG           On Hand Weight
     C                     Z-ADDWL0088    WKDDQT           On Hand UOM1 Su
     C                     Z-ADDWL0089    WKIDVA           Value of On Han
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
      * Refresh the available to sell quantity
     C                     Z-ADDWKDDQT    WKDOQT           Quantity Avail
     C                     SUB  WKAQQT    WKDOQT           Quantity Avail
     C                     SUB  WKAUQT    WKDOQT           Quantity Avail
     C                     SUB  WKEMQT    WKDOQT           Quantity Avail
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Warehouse Info     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0090    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0091           Warehouse Descr
     C                     MOVEL*BLANK    WL0092           Address Line 1
     C                     MOVEL*BLANK    WL0093           Address Line 2
     C                     MOVEL*BLANK    WL0094           Address Line 3
     C                     MOVEL*BLANK    WL0095           City
     C                     MOVEL*BLANK    WL0096           Zip Postal Code
     C                     MOVEL*BLANK    WL0097           Production Ware
     C                     MOVEL*BLANK    WL0098           State Code
     C                     MOVEL*BLANK    WL0099           Lot Tracking Fl
     C                     MOVEL*BLANK    WL0100           Default Printer
     C                     MOVEL*BLANK    WL0101           Warehouse Type
     C                     MOVEL*BLANK    WL0102           Trans Contol AS
     C                     MOVEL*BLANK    WL0103           Warehouse Locat
     C                     MOVEL*BLANK    WL0104           Warehouse Std C
     C                     Z-ADD*ZERO     WL0105           Warehouse Chill
     C                     MOVEL*BLANK    WL0106           Include in Auto
     C                     MOVEL*BLANK    WL0107           Default Manifes
     C                     MOVEL*BLANK    WL0108           Default Load Se
     C                     MOVEL*BLANK    WL0109           WHS Slotting Li
     C                     Z-ADD*ZERO     WL0110           Shipping Compan
     C                     Z-ADD*ZERO     WL0111           Accounting Comp
     C                     Z-ADD*ZERO     WL0112           WHS Sched Prod
     C                     Z-ADD*ZERO     WL0113           WHS Inventory C
     C                     MOVEL*BLANK    WL0114           Parent Warehous
     C                     MOVEL*BLANK    WL0115           Default Shippin
     C                     MOVEL*BLANK    WL0116           WHS Live with C
     C                     MOVEL*BLANK    WL0117           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0118           WHS Req Meter R
     C                     MOVEL*BLANK    WL0119           WHS Default Loa
     C                     MOVEL*BLANK    WL0120           WHS TMS Plannin
     C                     MOVEL*BLANK    WL0121           Default Carrier
     C                     MOVEL*BLANK    WL0122           Inventory Logic
     C                     MOVEL*BLANK    WL0123           WHS Auto Inv Re
     C                     MOVEL*BLANK    WL0124           EDI Status 1
     C                     MOVEL*BLANK    WL0125           EDI Status 2
     C                     MOVEL*BLANK    WL0126           EDI Status 3
     C                     MOVEL*BLANK    WL0127           Record Status
     C                     Z-ADD*ZERO     WL0128           Job Time
     C                     MOVEL*BLANK    WL0129           User Id
     C                     MOVEL*BLANK    WL0130           Job Name
     C                     Z-ADD*ZERO     WL0131           Job Date
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIF8NA    WL0091           Warehouse Descr
     C                     MOVELWIACNA    WL0092           Address Line 1
     C                     MOVELWIADNA    WL0093           Address Line 2
     C                     MOVELWIAENA    WL0094           Address Line 3
     C                     MOVELWIAJNA    WL0095           City
     C                     MOVELWIBTTX    WL0096           Zip Postal Code
     C                     MOVELWIAOCD    WL0097           Production Ware
     C                     MOVELWIBGCD    WL0098           State Code
     C                     MOVELWIVHST    WL0099           Lot Tracking Fl
     C                     MOVELWIMPNA    WL0100           Default Printer
     C                     MOVELWIWPST    WL0101           Warehouse Type
     C                     MOVELWIXUST    WL0102           Trans Contol AS
     C                     MOVELWIT0ST    WL0103           Warehouse Locat
     C                     MOVELWIT1ST    WL0104           Warehouse Std C
     C                     Z-ADDWIDBNB    WL0105           Warehouse Chill
     C                     MOVELWIT2ST    WL0106           Include in Auto
     C                     MOVELWIT3ST    WL0107           Default Manifes
     C                     MOVELWIT4ST    WL0108           Default Load Se
     C                     MOVELWIT6ST    WL0109           WHS Slotting Li
     C                     Z-ADDWIBWC3    WL0110           Shipping Compan
     C                     Z-ADDWIBTC3    WL0111           Accounting Comp
     C                     Z-ADDWIBUC3    WL0112           WHS Sched Prod
     C                     Z-ADDWIBVC3    WL0113           WHS Inventory C
     C                     MOVELWIFCAA    WL0114           Parent Warehous
     C                     MOVELWIRQSX    WL0115           Default Shippin
     C                     MOVELWIRRSX    WL0116           WHS Live with C
     C                     MOVELWIRSSX    WL0117           WHS PFS Interfa
     C                     MOVELWIRTSX    WL0118           WHS Req Meter R
     C                     MOVELWIT7ST    WL0119           WHS Default Loa
     C                     MOVELWIT8ST    WL0120           WHS TMS Plannin
     C                     MOVELWIRNSX    WL0121           Default Carrier
     C                     MOVELWIROSX    WL0122           Inventory Logic
     C                     MOVELWIRPSX    WL0123           WHS Auto Inv Re
     C                     MOVELWIUVST    WL0124           EDI Status 1
     C                     MOVELWIUWST    WL0125           EDI Status 2
     C                     MOVELWIUXST    WL0126           EDI Status 3
     C                     MOVELWIVSST    WL0127           Record Status
     C                     Z-ADDWIAATM    WL0128           Job Time
     C                     MOVELWIAYNA    WL0129           User Id
     C                     MOVELWIA0NA    WL0130           Job Name
     C                     Z-ADDWIAXDT    WL0131           Job Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Whse Location Info RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAJCD    WQSQ01           Warehouse Code
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Warehouse Code
      * Setup key
     C                     MOVELWL0132    WQSQ01           Warehouse Code
      * Establish starting position
     C           KRSSQ     SETLL@L2RESM                    *
     C           KRSSQ     READE@L2RESM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0133           Location Code
     C                     MOVEL*BLANK    WL0134           Location Aisle
     C                     Z-ADD*ZERO     WL0135           Location Bay
     C                     Z-ADD*ZERO     WL0136           Loc Unused Chil
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLYMCD    WL0133           Location Code
     C                     MOVELWLYPCD    WL0134           Location Aisle
     C                     Z-ADDWLLCBY    WL0135           Location Bay
     C                     Z-ADDWLLCCT    WL0136           Loc Unused Chil
     C                     GOTO SQEXIT                     *QUIT
     C           KRSSQ     READE@L2RESM                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Order Type         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0137    WMAIC3           Company Number
     C                     Z-ADDWL0138    WMC4NB           Order Number
      * Establish starting position
     C           KRSSR     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWMJNCD    WL0139           Order Type_Sale
     C                     GOTO SREXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WODOCD           System Value Co
      * Setup key
     C                     MOVELWL0140    WODOCD           System Value Co
      * Establish starting position
     C           KRSSS     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWOM8NB    WL0141           System Value Nu
     C                     GOTO SSEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WAC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WAA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WAAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WAAKCS           USR Transaction
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WACKNB           GL Document Num
     C                     Z-ADD*ZERO     WATRBN           Transfer Batch
     C                     Z-ADD*ZERO     WATRBS           Transfer Batch
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WAAWTM           Production Time
     C                     Z-ADD*ZERO     WAK7DT           Label Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAECS           Last Cost
     C                     Z-ADD*ZERO     WBBACS           Cost per Primar
     C                     Z-ADD*ZERO     WBBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WBCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WBGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WBCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WBG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WBBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WBDDQT           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WBDEQT           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WBDFQT           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WBAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WBAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WBEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WBDOQT           Quantity Avail
     C                     Z-ADD*ZERO     WBAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WBANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WBIDVA           Value of On Han
     C                     Z-ADD*ZERO     WBBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WBDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WBDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WBBFDY           Lead Time Last
     C                     Z-ADD*ZERO     WBDJDT           Lead Time Date
     C                     Z-ADD*ZERO     WBBGDY           Lead Time Next
     C                     Z-ADD*ZERO     WBDKDT           Lead Time Date
     C                     Z-ADD*ZERO     WBDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WBBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WBDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WBDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WBDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WBDMDT           Last Physical C
     C                     Z-ADD*ZERO     WBAKC8           Vendor Item_Whs
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAIWG           Unit Weight
     C                     Z-ADD*ZERO     WDCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WDC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WDURTN           Number Cases On
     C                     Z-ADD*ZERO     WDAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDTFNB           Transportation
     C                     Z-ADD*ZERO     WDTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WDTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WDBLPR           Market Overage
     C                     Z-ADD*ZERO     WDBMPR           Standard Overag
     C                     Z-ADD*ZERO     WDCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WDCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WDSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WDPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WDICN1           Item Category N
     C                     Z-ADD*ZERO     WDICN2           Item Category N
     C                     Z-ADD*ZERO     WDV2NB           Item Category N
     C                     Z-ADD*ZERO     WDITCN           Item Category N
     C                     Z-ADD*ZERO     WDITC5           Item Category N
     C                     Z-ADD*ZERO     WDICN6           Item Category N
     C                     Z-ADD*ZERO     WDICN7           Item Category N
     C                     Z-ADD*ZERO     WDICN8           Item Category N
     C                     Z-ADD*ZERO     WDICN9           Item Category N
     C                     Z-ADD*ZERO     WDICN0           Item Category N
     C                     Z-ADD*ZERO     WDSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WDA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WDSJNB           Production Lead
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WDCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WDILNB           Packages per ca
     C                     Z-ADD*ZERO     WDCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WDCINB           PM Batch Size
     C                     Z-ADD*ZERO     WDCJNB           Package Level s
     C                     Z-ADD*ZERO     WDCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WDCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WDCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WDCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WDCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WDCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WDCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WDCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WDC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WDB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WDBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WDF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WDF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WDF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WDBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WDBNNB           Production Qty
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHUNZ           Release Number
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,003   XDTSDL
     C                     MOVELXDTSDL    WEBGTS           Create Date Tim
     C                     MOVELXDTSDL    WEBHTS           Update Date Tim
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Clear all neither parameters
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHABWG           Physical Count
     C                     Z-ADD*ZERO     WHAGQT           Physical Count
     C                     Z-ADD*ZERO     WHAHQT           Physical Count
     C                     Z-ADD*ZERO     WHAIQT           Physical Count
     C                     Z-ADD*ZERO     WHACWG           Quantity on Han
     C                     Z-ADD*ZERO     WHARQT           Quantity on Han
     C                     Z-ADD*ZERO     WHASQT           Quantity on Han
     C                     Z-ADD*ZERO     WHATQT           Quantity on Han
     C                     Z-ADD*ZERO     WHHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WHHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WHBMWG           Physical Start
     C                     Z-ADD*ZERO     WHDSQT           Physical Start
     C                     Z-ADD*ZERO     WHDTQT           Physical Start
     C                     Z-ADD*ZERO     WHDUQT           Physical Start
     C                     Z-ADD*ZERO     WHDHDT           Physical Start
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAECS           Last Cost
     C                     Z-ADD*ZERO     WHIDVA           Value of On Han
     C                     Z-ADD*ZERO     WHK7DT           Label Date
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WIBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WIBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WIBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WIBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Location Code
     C                     MOVEL*BLANK    WUYMCD  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLLCBY           Location Bay
     C                     Z-ADD*ZERO     WLLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMANC7           AR Customer Num
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WMA0DT           Order Date
     C                     Z-ADD*ZERO     WMA5DT           Requested Ship
     C                     Z-ADD*ZERO     WMGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WMACDT           Cancel Date
     C                     Z-ADD*ZERO     WMAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WMCXDT           Date of Origina
     C                     Z-ADD*ZERO     WMJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WMA1WG           Order Weight To
     C                     Z-ADD*ZERO     WMEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WMAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WMRMNB           Load ID
     C                     Z-ADD*ZERO     WMTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WMR1NB           Rated Freight
     C                     Z-ADD*ZERO     WMRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WMATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WMRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WMT3NB           Attach to Order
     C                     Z-ADD*ZERO     WMCONB           Invoice Number
     C                     Z-ADD*ZERO     WMAWDT           Invoice Date
     C                     Z-ADD*ZERO     WMVRVA           A_R order Value
     C                     Z-ADD*ZERO     WMB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WMNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WMNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WMNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WMNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WMNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WMBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WMBQTM           Time of Origina
     C                     Z-ADD*ZERO     WMBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WMBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WMBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WMH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WMH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WMH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WMH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WMH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WMC0C7           Claim Number
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Location Level
     C                     Z-ADD*ZERO     WUYNCD  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOM8NB           System Value Nu
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  30
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  2
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  50
      * Define local variables for subroutine SICRRC.
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  3
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  2
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  50
     C                     Z-ADD*ZERO     WL0020  30
     C                     Z-ADD*ZERO     WL0021  70
     C                     MOVEL*BLANK    WL0022  2
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024 30
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027 114
     C                     MOVEL*BLANK    WL0028  2
     C                     Z-ADD*ZERO     WL0029 112
     C                     MOVEL*BLANK    WL0030  6
     C                     Z-ADD*ZERO     WL0031  80
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  3
     C                     MOVEL*BLANK    WL0034 15
     C                     MOVEL*BLANK    WL0035 10
     C                     Z-ADD*ZERO     WL0036  70
     C                     Z-ADD*ZERO     WL0037  30
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  30
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  30
     C                     MOVEL*BLANK    WL0042 10
     C                     Z-ADD*ZERO     WL0043  60
     C                     MOVEL*BLANK    WL0044  1
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
      * Define local variables for subroutine SJCHRC.
     C                     Z-ADD*ZERO     WL0050  30
     C                     Z-ADD*ZERO     WL0051  70
     C                     MOVEL*BLANK    WL0052  3
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  30
     C                     Z-ADD*ZERO     WL0055  30
     C                     Z-ADD*ZERO     WL0056  30
     C                     MOVEL*BLANK    WL0057  2
     C                     Z-ADD*ZERO     WL0058  94
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  2
     C                     Z-ADD*ZERO     WL0061  94
     C                     MOVEL*BLANK    WL0062  1
     C                     MOVEL*BLANK    WL0063  2
     C                     MOVEL*BLANK    WL0064  1
     C                     MOVEL*BLANK    WL0065  1
     C                     MOVEL*BLANK    WL0066  1
     C                     MOVEL*BLANK    WL0067  2
     C                     Z-ADD*ZERO     WL0068  70
     C                     MOVEL*BLANK    WL0069  2
     C                     Z-ADD*ZERO     WL0070 112
     C                     Z-ADD*ZERO     WL0071 112
     C                     Z-ADD*ZERO     WL0072 114
     C                     MOVEL*BLANK    WL0073  2
     C                     Z-ADD*ZERO     WL0074 112
     C                     Z-ADD*ZERO     WL0075  70
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0076  30
     C                     Z-ADD*ZERO     WL0077  70
     C                     MOVEL*BLANK    WL0078  3
     C                     Z-ADD*ZERO     WL0079 112
     C                     Z-ADD*ZERO     WL0080 112
     C                     Z-ADD*ZERO     WL0081 112
     C                     Z-ADD*ZERO     WL0082 112
     C                     Z-ADD*ZERO     WL0083 112
      * Define local variables for subroutine SOCHRC.
     C                     Z-ADD*ZERO     WL0084  30
     C                     Z-ADD*ZERO     WL0085  70
     C                     MOVEL*BLANK    WL0086  3
     C                     Z-ADD*ZERO     WL0087 112
     C                     Z-ADD*ZERO     WL0088 112
     C                     Z-ADD*ZERO     WL0089 112
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0090  3
     C                     MOVEL*BLANK    WL0091 30
     C                     MOVEL*BLANK    WL0092 30
     C                     MOVEL*BLANK    WL0093 30
     C                     MOVEL*BLANK    WL0094 30
     C                     MOVEL*BLANK    WL0095 20
     C                     MOVEL*BLANK    WL0096 11
     C                     MOVEL*BLANK    WL0097  3
     C                     MOVEL*BLANK    WL0098  2
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100 10
     C                     MOVEL*BLANK    WL0101  2
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103  1
     C                     MOVEL*BLANK    WL0104  1
     C                     Z-ADD*ZERO     WL0105  52
     C                     MOVEL*BLANK    WL0106  1
     C                     MOVEL*BLANK    WL0107  1
     C                     MOVEL*BLANK    WL0108  1
     C                     MOVEL*BLANK    WL0109  1
     C                     Z-ADD*ZERO     WL0110  30
     C                     Z-ADD*ZERO     WL0111  30
     C                     Z-ADD*ZERO     WL0112  30
     C                     Z-ADD*ZERO     WL0113  30
     C                     MOVEL*BLANK    WL0114  3
     C                     MOVEL*BLANK    WL0115  1
     C                     MOVEL*BLANK    WL0116  1
     C                     MOVEL*BLANK    WL0117  1
     C                     MOVEL*BLANK    WL0118  1
     C                     MOVEL*BLANK    WL0119  2
     C                     MOVEL*BLANK    WL0120  2
     C                     MOVEL*BLANK    WL0121  3
     C                     MOVEL*BLANK    WL0122  3
     C                     MOVEL*BLANK    WL0123  3
     C                     MOVEL*BLANK    WL0124  1
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  1
     C                     MOVEL*BLANK    WL0127  1
     C                     Z-ADD*ZERO     WL0128  60
     C                     MOVEL*BLANK    WL0129 10
     C                     MOVEL*BLANK    WL0130 10
     C                     Z-ADD*ZERO     WL0131  70
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0132  3
     C                     MOVEL*BLANK    WL0133  4
     C                     MOVEL*BLANK    WL0134  2
     C                     Z-ADD*ZERO     WL0135  20
     C                     Z-ADD*ZERO     WL0136  52
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0137  30
     C                     Z-ADD*ZERO     WL0138  70
     C                     MOVEL*BLANK    WL0139  2
      * Define local variables for subroutine SSRVGN.
     C                     MOVEL*BLANK    WL0140 10
     C                     Z-ADD*ZERO     WL0141 155
      * Define null work field Inventory Updated USR
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field API was Called? U
     C                     MOVEL*BLANK    YN0002  1
      * Define local work field Module Release Status
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0006 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0007 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0008 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0009  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0010  2
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0011 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0012  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0013  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0003  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0015  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0020  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0021  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0022  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0023  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0024  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0025  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0004  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0027  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0028  2
      * Define null work field WHS TMS Planning Region
     C                     MOVEL*BLANK    YN0029  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field Inventory Logic Version
     C                     MOVEL*BLANK    YN0031  3
      * Define null work field WHS Auto Inv Restoration
     C                     MOVEL*BLANK    YN0032  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0037  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0038 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0039 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0040  70
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0006  20
      * Define local work field Loc Unused Chill Time
     C                     Z-ADD*ZERO     YL0007  52
      * Define local work field Order Type_Sales
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field API EccResult-MsgId U
     C                     MOVEL*BLANK    YL0009  7
      * Define local work field API EccResult-MsgDesc U
     C                     MOVEL*BLANK    YL0010 50
      * Define local work field API Request Key U
     C                     MOVEL*BLANK    YL0011 10
      * Define local work field API Name
     C                     MOVEL*BLANK    YL0012 45
      * Define local work field API Wait Time U
     C                     Z-ADD*ZERO     YL0013  50
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PDLYXFR
00002 Backin Special Adjustmts
00003 0001-01-01-00.00.00.00000
00004 wim.ordershipping.invento
00005 APIWAITTME
00006 ECC0000
00007 TIMEOUT
00008 PUGDXFR
00009 PDL8DFR
00010 PNTKXFR
00011 PUEJXFR
00012 PNTWXFR
00013 PDMLDFR
